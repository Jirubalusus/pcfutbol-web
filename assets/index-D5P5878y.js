const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/playGamesPlugin-B4Oz_TGJ.js","assets/index-oZ3m2Ggg.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();function f8(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var VL={exports:{}},Ob={};var DV;function iue(){if(DV)return Ob;DV=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,s,r){var o=null;if(r!==void 0&&(o=""+r),s.key!==void 0&&(o=""+s.key),"key"in s){r={};for(var l in s)l!=="key"&&(r[l]=s[l])}else r=s;return s=r.ref,{$$typeof:a,type:i,key:o,ref:s!==void 0?s:null,props:r}}return Ob.Fragment=e,Ob.jsx=n,Ob.jsxs=n,Ob}var kV;function sue(){return kV||(kV=1,VL.exports=iue()),VL.exports}var d=sue(),zL={exports:{}},Ma={};var OV;function rue(){if(OV)return Ma;OV=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),m=Symbol.iterator;function A(oe){return oe===null||typeof oe!="object"?null:(oe=m&&oe[m]||oe["@@iterator"],typeof oe=="function"?oe:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,E={};function M(oe,Ae,be){this.props=oe,this.context=Ae,this.refs=E,this.updater=be||x}M.prototype.isReactComponent={},M.prototype.setState=function(oe,Ae){if(typeof oe!="object"&&typeof oe!="function"&&oe!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,oe,Ae,"setState")},M.prototype.forceUpdate=function(oe){this.updater.enqueueForceUpdate(this,oe,"forceUpdate")};function N(){}N.prototype=M.prototype;function I(oe,Ae,be){this.props=oe,this.context=Ae,this.refs=E,this.updater=be||x}var F=I.prototype=new N;F.constructor=I,T(F,M.prototype),F.isPureReactComponent=!0;var G=Array.isArray;function O(){}var D={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function L(oe,Ae,be){var Ce=be.ref;return{$$typeof:a,type:oe,key:Ae,ref:Ce!==void 0?Ce:null,props:be}}function U(oe,Ae){return L(oe.type,Ae,oe.props)}function q(oe){return typeof oe=="object"&&oe!==null&&oe.$$typeof===a}function K(oe){var Ae={"=":"=0",":":"=2"};return"$"+oe.replace(/[=:]/g,function(be){return Ae[be]})}var H=/\/+/g;function X(oe,Ae){return typeof oe=="object"&&oe!==null&&oe.key!=null?K(""+oe.key):Ae.toString(36)}function ne(oe){switch(oe.status){case"fulfilled":return oe.value;case"rejected":throw oe.reason;default:switch(typeof oe.status=="string"?oe.then(O,O):(oe.status="pending",oe.then(function(Ae){oe.status==="pending"&&(oe.status="fulfilled",oe.value=Ae)},function(Ae){oe.status==="pending"&&(oe.status="rejected",oe.reason=Ae)})),oe.status){case"fulfilled":return oe.value;case"rejected":throw oe.reason}}throw oe}function Q(oe,Ae,be,Ce,ce){var te=typeof oe;(te==="undefined"||te==="boolean")&&(oe=null);var fe=!1;if(oe===null)fe=!0;else switch(te){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(oe.$$typeof){case a:case e:fe=!0;break;case h:return fe=oe._init,Q(fe(oe._payload),Ae,be,Ce,ce)}}if(fe)return ce=ce(oe),fe=Ce===""?"."+X(oe,0):Ce,G(ce)?(be="",fe!=null&&(be=fe.replace(H,"$&/")+"/"),Q(ce,Ae,be,"",function(Ie){return Ie})):ce!=null&&(q(ce)&&(ce=U(ce,be+(ce.key==null||oe&&oe.key===ce.key?"":(""+ce.key).replace(H,"$&/")+"/")+fe)),Ae.push(ce)),1;fe=0;var Le=Ce===""?".":Ce+":";if(G(oe))for(var Fe=0;Fe<oe.length;Fe++)Ce=oe[Fe],te=Le+X(Ce,Fe),fe+=Q(Ce,Ae,be,te,ce);else if(Fe=A(oe),typeof Fe=="function")for(oe=Fe.call(oe),Fe=0;!(Ce=oe.next()).done;)Ce=Ce.value,te=Le+X(Ce,Fe++),fe+=Q(Ce,Ae,be,te,ce);else if(te==="object"){if(typeof oe.then=="function")return Q(ne(oe),Ae,be,Ce,ce);throw Ae=String(oe),Error("Objects are not valid as a React child (found: "+(Ae==="[object Object]"?"object with keys {"+Object.keys(oe).join(", ")+"}":Ae)+"). If you meant to render a collection of children, use an array instead.")}return fe}function Y(oe,Ae,be){if(oe==null)return oe;var Ce=[],ce=0;return Q(oe,Ce,"","",function(te){return Ae.call(be,te,ce++)}),Ce}function ue(oe){if(oe._status===-1){var Ae=oe._result;Ae=Ae(),Ae.then(function(be){(oe._status===0||oe._status===-1)&&(oe._status=1,oe._result=be)},function(be){(oe._status===0||oe._status===-1)&&(oe._status=2,oe._result=be)}),oe._status===-1&&(oe._status=0,oe._result=Ae)}if(oe._status===1)return oe._result.default;throw oe._result}var pe=typeof reportError=="function"?reportError:function(oe){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ae=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof oe=="object"&&oe!==null&&typeof oe.message=="string"?String(oe.message):String(oe),error:oe});if(!window.dispatchEvent(Ae))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",oe);return}console.error(oe)},Ee={map:Y,forEach:function(oe,Ae,be){Y(oe,function(){Ae.apply(this,arguments)},be)},count:function(oe){var Ae=0;return Y(oe,function(){Ae++}),Ae},toArray:function(oe){return Y(oe,function(Ae){return Ae})||[]},only:function(oe){if(!q(oe))throw Error("React.Children.only expected to receive a single React element child.");return oe}};return Ma.Activity=f,Ma.Children=Ee,Ma.Component=M,Ma.Fragment=n,Ma.Profiler=s,Ma.PureComponent=I,Ma.StrictMode=i,Ma.Suspense=c,Ma.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Ma.__COMPILER_RUNTIME={__proto__:null,c:function(oe){return D.H.useMemoCache(oe)}},Ma.cache=function(oe){return function(){return oe.apply(null,arguments)}},Ma.cacheSignal=function(){return null},Ma.cloneElement=function(oe,Ae,be){if(oe==null)throw Error("The argument must be a React element, but you passed "+oe+".");var Ce=T({},oe.props),ce=oe.key;if(Ae!=null)for(te in Ae.key!==void 0&&(ce=""+Ae.key),Ae)!j.call(Ae,te)||te==="key"||te==="__self"||te==="__source"||te==="ref"&&Ae.ref===void 0||(Ce[te]=Ae[te]);var te=arguments.length-2;if(te===1)Ce.children=be;else if(1<te){for(var fe=Array(te),Le=0;Le<te;Le++)fe[Le]=arguments[Le+2];Ce.children=fe}return L(oe.type,ce,Ce)},Ma.createContext=function(oe){return oe={$$typeof:o,_currentValue:oe,_currentValue2:oe,_threadCount:0,Provider:null,Consumer:null},oe.Provider=oe,oe.Consumer={$$typeof:r,_context:oe},oe},Ma.createElement=function(oe,Ae,be){var Ce,ce={},te=null;if(Ae!=null)for(Ce in Ae.key!==void 0&&(te=""+Ae.key),Ae)j.call(Ae,Ce)&&Ce!=="key"&&Ce!=="__self"&&Ce!=="__source"&&(ce[Ce]=Ae[Ce]);var fe=arguments.length-2;if(fe===1)ce.children=be;else if(1<fe){for(var Le=Array(fe),Fe=0;Fe<fe;Fe++)Le[Fe]=arguments[Fe+2];ce.children=Le}if(oe&&oe.defaultProps)for(Ce in fe=oe.defaultProps,fe)ce[Ce]===void 0&&(ce[Ce]=fe[Ce]);return L(oe,te,ce)},Ma.createRef=function(){return{current:null}},Ma.forwardRef=function(oe){return{$$typeof:l,render:oe}},Ma.isValidElement=q,Ma.lazy=function(oe){return{$$typeof:h,_payload:{_status:-1,_result:oe},_init:ue}},Ma.memo=function(oe,Ae){return{$$typeof:u,type:oe,compare:Ae===void 0?null:Ae}},Ma.startTransition=function(oe){var Ae=D.T,be={};D.T=be;try{var Ce=oe(),ce=D.S;ce!==null&&ce(be,Ce),typeof Ce=="object"&&Ce!==null&&typeof Ce.then=="function"&&Ce.then(O,pe)}catch(te){pe(te)}finally{Ae!==null&&be.types!==null&&(Ae.types=be.types),D.T=Ae}},Ma.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Ma.use=function(oe){return D.H.use(oe)},Ma.useActionState=function(oe,Ae,be){return D.H.useActionState(oe,Ae,be)},Ma.useCallback=function(oe,Ae){return D.H.useCallback(oe,Ae)},Ma.useContext=function(oe){return D.H.useContext(oe)},Ma.useDebugValue=function(){},Ma.useDeferredValue=function(oe,Ae){return D.H.useDeferredValue(oe,Ae)},Ma.useEffect=function(oe,Ae){return D.H.useEffect(oe,Ae)},Ma.useEffectEvent=function(oe){return D.H.useEffectEvent(oe)},Ma.useId=function(){return D.H.useId()},Ma.useImperativeHandle=function(oe,Ae,be){return D.H.useImperativeHandle(oe,Ae,be)},Ma.useInsertionEffect=function(oe,Ae){return D.H.useInsertionEffect(oe,Ae)},Ma.useLayoutEffect=function(oe,Ae){return D.H.useLayoutEffect(oe,Ae)},Ma.useMemo=function(oe,Ae){return D.H.useMemo(oe,Ae)},Ma.useOptimistic=function(oe,Ae){return D.H.useOptimistic(oe,Ae)},Ma.useReducer=function(oe,Ae,be){return D.H.useReducer(oe,Ae,be)},Ma.useRef=function(oe){return D.H.useRef(oe)},Ma.useState=function(oe){return D.H.useState(oe)},Ma.useSyncExternalStore=function(oe,Ae,be){return D.H.useSyncExternalStore(oe,Ae,be)},Ma.useTransition=function(){return D.H.useTransition()},Ma.version="19.2.3",Ma}var FV;function BR(){return FV||(FV=1,zL.exports=rue()),zL.exports}var ge=BR();const p8=f8(ge);var GL={exports:{}},Fb={},qL={exports:{}},HL={};var jV;function oue(){return jV||(jV=1,(function(a){function e(Q,Y){var ue=Q.length;Q.push(Y);e:for(;0<ue;){var pe=ue-1>>>1,Ee=Q[pe];if(0<s(Ee,Y))Q[pe]=Y,Q[ue]=Ee,ue=pe;else break e}}function n(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var Y=Q[0],ue=Q.pop();if(ue!==Y){Q[0]=ue;e:for(var pe=0,Ee=Q.length,oe=Ee>>>1;pe<oe;){var Ae=2*(pe+1)-1,be=Q[Ae],Ce=Ae+1,ce=Q[Ce];if(0>s(be,ue))Ce<Ee&&0>s(ce,be)?(Q[pe]=ce,Q[Ce]=ue,pe=Ce):(Q[pe]=be,Q[Ae]=ue,pe=Ae);else if(Ce<Ee&&0>s(ce,ue))Q[pe]=ce,Q[Ce]=ue,pe=Ce;else break e}}return Y}function s(Q,Y){var ue=Q.sortIndex-Y.sortIndex;return ue!==0?ue:Q.id-Y.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;a.unstable_now=function(){return r.now()}}else{var o=Date,l=o.now();a.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,f=null,m=3,A=!1,x=!1,T=!1,E=!1,M=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function F(Q){for(var Y=n(u);Y!==null;){if(Y.callback===null)i(u);else if(Y.startTime<=Q)i(u),Y.sortIndex=Y.expirationTime,e(c,Y);else break;Y=n(u)}}function G(Q){if(T=!1,F(Q),!x)if(n(c)!==null)x=!0,O||(O=!0,K());else{var Y=n(u);Y!==null&&ne(G,Y.startTime-Q)}}var O=!1,D=-1,j=5,L=-1;function U(){return E?!0:!(a.unstable_now()-L<j)}function q(){if(E=!1,O){var Q=a.unstable_now();L=Q;var Y=!0;try{e:{x=!1,T&&(T=!1,N(D),D=-1),A=!0;var ue=m;try{t:{for(F(Q),f=n(c);f!==null&&!(f.expirationTime>Q&&U());){var pe=f.callback;if(typeof pe=="function"){f.callback=null,m=f.priorityLevel;var Ee=pe(f.expirationTime<=Q);if(Q=a.unstable_now(),typeof Ee=="function"){f.callback=Ee,F(Q),Y=!0;break t}f===n(c)&&i(c),F(Q)}else i(c);f=n(c)}if(f!==null)Y=!0;else{var oe=n(u);oe!==null&&ne(G,oe.startTime-Q),Y=!1}}break e}finally{f=null,m=ue,A=!1}Y=void 0}}finally{Y?K():O=!1}}}var K;if(typeof I=="function")K=function(){I(q)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,X=H.port2;H.port1.onmessage=q,K=function(){X.postMessage(null)}}else K=function(){M(q,0)};function ne(Q,Y){D=M(function(){Q(a.unstable_now())},Y)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(Q){Q.callback=null},a.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<Q?Math.floor(1e3/Q):5},a.unstable_getCurrentPriorityLevel=function(){return m},a.unstable_next=function(Q){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var ue=m;m=Y;try{return Q()}finally{m=ue}},a.unstable_requestPaint=function(){E=!0},a.unstable_runWithPriority=function(Q,Y){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ue=m;m=Q;try{return Y()}finally{m=ue}},a.unstable_scheduleCallback=function(Q,Y,ue){var pe=a.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?pe+ue:pe):ue=pe,Q){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=ue+Ee,Q={id:h++,callback:Y,priorityLevel:Q,startTime:ue,expirationTime:Ee,sortIndex:-1},ue>pe?(Q.sortIndex=ue,e(u,Q),n(c)===null&&Q===n(u)&&(T?(N(D),D=-1):T=!0,ne(G,ue-pe))):(Q.sortIndex=Ee,e(c,Q),x||A||(x=!0,O||(O=!0,K()))),Q},a.unstable_shouldYield=U,a.unstable_wrapCallback=function(Q){var Y=m;return function(){var ue=m;m=Y;try{return Q.apply(this,arguments)}finally{m=ue}}}})(HL)),HL}var BV;function lue(){return BV||(BV=1,qL.exports=oue()),qL.exports}var WL={exports:{}},Yo={};var UV;function cue(){if(UV)return Yo;UV=1;var a=BR();function e(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function r(c,u,h){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:f==null?null:""+f,children:c,containerInfo:u,implementation:h}}var o=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Yo.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Yo.createPortal=function(c,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return r(c,u,null,h)},Yo.flushSync=function(c){var u=o.T,h=i.p;try{if(o.T=null,i.p=2,c)return c()}finally{o.T=u,i.p=h,i.d.f()}},Yo.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,i.d.C(c,u))},Yo.prefetchDNS=function(c){typeof c=="string"&&i.d.D(c)},Yo.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var h=u.as,f=l(h,u.crossOrigin),m=typeof u.integrity=="string"?u.integrity:void 0,A=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?i.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:f,integrity:m,fetchPriority:A}):h==="script"&&i.d.X(c,{crossOrigin:f,integrity:m,fetchPriority:A,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Yo.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=l(u.as,u.crossOrigin);i.d.M(c,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&i.d.M(c)},Yo.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,f=l(h,u.crossOrigin);i.d.L(c,h,{crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Yo.preloadModule=function(c,u){if(typeof c=="string")if(u){var h=l(u.as,u.crossOrigin);i.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else i.d.m(c)},Yo.requestFormReset=function(c){i.d.r(c)},Yo.unstable_batchedUpdates=function(c,u){return c(u)},Yo.useFormState=function(c,u,h){return o.H.useFormState(c,u,h)},Yo.useFormStatus=function(){return o.H.useHostTransitionStatus()},Yo.version="19.2.3",Yo}var VV;function uue(){if(VV)return WL.exports;VV=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),WL.exports=cue(),WL.exports}var zV;function due(){if(zV)return Fb;zV=1;var a=lue(),e=BR(),n=uue();function i(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)g+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function r(p){var g=p,S=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,(g.flags&4098)!==0&&(S=g.return),p=g.return;while(p)}return g.tag===3?S:null}function o(p){if(p.tag===13){var g=p.memoizedState;if(g===null&&(p=p.alternate,p!==null&&(g=p.memoizedState)),g!==null)return g.dehydrated}return null}function l(p){if(p.tag===31){var g=p.memoizedState;if(g===null&&(p=p.alternate,p!==null&&(g=p.memoizedState)),g!==null)return g.dehydrated}return null}function c(p){if(r(p)!==p)throw Error(i(188))}function u(p){var g=p.alternate;if(!g){if(g=r(p),g===null)throw Error(i(188));return g!==p?null:p}for(var S=p,R=g;;){var z=S.return;if(z===null)break;var W=z.alternate;if(W===null){if(R=z.return,R!==null){S=R;continue}break}if(z.child===W.child){for(W=z.child;W;){if(W===S)return c(z),p;if(W===R)return c(z),g;W=W.sibling}throw Error(i(188))}if(S.return!==R.return)S=z,R=W;else{for(var re=!1,we=z.child;we;){if(we===S){re=!0,S=z,R=W;break}if(we===R){re=!0,R=z,S=W;break}we=we.sibling}if(!re){for(we=W.child;we;){if(we===S){re=!0,S=W,R=z;break}if(we===R){re=!0,R=W,S=z;break}we=we.sibling}if(!re)throw Error(i(189))}}if(S.alternate!==R)throw Error(i(190))}if(S.tag!==3)throw Error(i(188));return S.stateNode.current===S?p:g}function h(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p;for(p=p.child;p!==null;){if(g=h(p),g!==null)return g;p=p.sibling}return null}var f=Object.assign,m=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),I=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function K(p){return p===null||typeof p!="object"?null:(p=q&&p[q]||p["@@iterator"],typeof p=="function"?p:null)}var H=Symbol.for("react.client.reference");function X(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===H?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case T:return"Fragment";case M:return"Profiler";case E:return"StrictMode";case G:return"Suspense";case O:return"SuspenseList";case L:return"Activity"}if(typeof p=="object")switch(p.$$typeof){case x:return"Portal";case I:return p.displayName||"Context";case N:return(p._context.displayName||"Context")+".Consumer";case F:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case D:return g=p.displayName||null,g!==null?g:X(p.type)||"Memo";case j:g=p._payload,p=p._init;try{return X(p(g))}catch{}}return null}var ne=Array.isArray,Q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue={pending:!1,data:null,method:null,action:null},pe=[],Ee=-1;function oe(p){return{current:p}}function Ae(p){0>Ee||(p.current=pe[Ee],pe[Ee]=null,Ee--)}function be(p,g){Ee++,pe[Ee]=p.current,p.current=g}var Ce=oe(null),ce=oe(null),te=oe(null),fe=oe(null);function Le(p,g){switch(be(te,g),be(ce,p),be(Ce,null),g.nodeType){case 9:case 11:p=(p=g.documentElement)&&(p=p.namespaceURI)?aV(p):0;break;default:if(p=g.tagName,g=g.namespaceURI)g=aV(g),p=iV(g,p);else switch(p){case"svg":p=1;break;case"math":p=2;break;default:p=0}}Ae(Ce),be(Ce,p)}function Fe(){Ae(Ce),Ae(ce),Ae(te)}function Ie(p){p.memoizedState!==null&&be(fe,p);var g=Ce.current,S=iV(g,p.type);g!==S&&(be(ce,p),be(Ce,S))}function at(p){ce.current===p&&(Ae(Ce),Ae(ce)),fe.current===p&&(Ae(fe),Ib._currentValue=ue)}var je,Ve;function Me(p){if(je===void 0)try{throw Error()}catch(S){var g=S.stack.trim().match(/\n( *(at )?)/);je=g&&g[1]||"",Ve=-1<S.stack.indexOf(`
    at`)?" (<anonymous>)":-1<S.stack.indexOf("@")?"@unknown:0:0":""}return`
`+je+p+Ve}var ze=!1;function Je(p,g){if(!p||ze)return"";ze=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var R={DetermineComponentFrameRoot:function(){try{if(g){var Wt=function(){throw Error()};if(Object.defineProperty(Wt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Wt,[])}catch(It){var Et=It}Reflect.construct(p,[],Wt)}else{try{Wt.call()}catch(It){Et=It}p.call(Wt.prototype)}}else{try{throw Error()}catch(It){Et=It}(Wt=p())&&typeof Wt.catch=="function"&&Wt.catch(function(){})}}catch(It){if(It&&Et&&typeof It.stack=="string")return[It.stack,Et.stack]}return[null,null]}};R.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var z=Object.getOwnPropertyDescriptor(R.DetermineComponentFrameRoot,"name");z&&z.configurable&&Object.defineProperty(R.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var W=R.DetermineComponentFrameRoot(),re=W[0],we=W[1];if(re&&we){var He=re.split(`
`),xt=we.split(`
`);for(z=R=0;R<He.length&&!He[R].includes("DetermineComponentFrameRoot");)R++;for(;z<xt.length&&!xt[z].includes("DetermineComponentFrameRoot");)z++;if(R===He.length||z===xt.length)for(R=He.length-1,z=xt.length-1;1<=R&&0<=z&&He[R]!==xt[z];)z--;for(;1<=R&&0<=z;R--,z--)if(He[R]!==xt[z]){if(R!==1||z!==1)do if(R--,z--,0>z||He[R]!==xt[z]){var Ft=`
`+He[R].replace(" at new "," at ");return p.displayName&&Ft.includes("<anonymous>")&&(Ft=Ft.replace("<anonymous>",p.displayName)),Ft}while(1<=R&&0<=z);break}}}finally{ze=!1,Error.prepareStackTrace=S}return(S=p?p.displayName||p.name:"")?Me(S):""}function rt(p,g){switch(p.tag){case 26:case 27:case 5:return Me(p.type);case 16:return Me("Lazy");case 13:return p.child!==g&&g!==null?Me("Suspense Fallback"):Me("Suspense");case 19:return Me("SuspenseList");case 0:case 15:return Je(p.type,!1);case 11:return Je(p.type.render,!1);case 1:return Je(p.type,!0);case 31:return Me("Activity");default:return""}}function ve(p){try{var g="",S=null;do g+=rt(p,S),S=p,p=p.return;while(p);return g}catch(R){return`
Error generating stack: `+R.message+`
`+R.stack}}var Ue=Object.prototype.hasOwnProperty,it=a.unstable_scheduleCallback,wt=a.unstable_cancelCallback,Mt=a.unstable_shouldYield,_e=a.unstable_requestPaint,le=a.unstable_now,Ge=a.unstable_getCurrentPriorityLevel,tt=a.unstable_ImmediatePriority,pt=a.unstable_UserBlockingPriority,Te=a.unstable_NormalPriority,st=a.unstable_LowPriority,mt=a.unstable_IdlePriority,ht=a.log,Qe=a.unstable_setDisableYieldValue,Xe=null,ct=null;function Tt(p){if(typeof ht=="function"&&Qe(p),ct&&typeof ct.setStrictMode=="function")try{ct.setStrictMode(Xe,p)}catch{}}var kt=Math.clz32?Math.clz32:Ne,vt=Math.log,Tn=Math.LN2;function Ne(p){return p>>>=0,p===0?32:31-(vt(p)/Tn|0)|0}var Xt=256,Ht=262144,$t=4194304;function zt(p){var g=p&42;if(g!==0)return g;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return p&261888;case 262144:case 524288:case 1048576:case 2097152:return p&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function Ot(p,g,S){var R=p.pendingLanes;if(R===0)return 0;var z=0,W=p.suspendedLanes,re=p.pingedLanes;p=p.warmLanes;var we=R&134217727;return we!==0?(R=we&~W,R!==0?z=zt(R):(re&=we,re!==0?z=zt(re):S||(S=we&~p,S!==0&&(z=zt(S))))):(we=R&~W,we!==0?z=zt(we):re!==0?z=zt(re):S||(S=R&~p,S!==0&&(z=zt(S)))),z===0?0:g!==0&&g!==z&&(g&W)===0&&(W=z&-z,S=g&-g,W>=S||W===32&&(S&4194048)!==0)?g:z}function an(p,g){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&g)===0}function jn(p,g){switch(p){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ai(){var p=$t;return $t<<=1,($t&62914560)===0&&($t=4194304),p}function Ta(p){for(var g=[],S=0;31>S;S++)g.push(p);return g}function Gs(p,g){p.pendingLanes|=g,g!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function dr(p,g,S,R,z,W){var re=p.pendingLanes;p.pendingLanes=S,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=S,p.entangledLanes&=S,p.errorRecoveryDisabledLanes&=S,p.shellSuspendCounter=0;var we=p.entanglements,He=p.expirationTimes,xt=p.hiddenUpdates;for(S=re&~S;0<S;){var Ft=31-kt(S),Wt=1<<Ft;we[Ft]=0,He[Ft]=-1;var Et=xt[Ft];if(Et!==null)for(xt[Ft]=null,Ft=0;Ft<Et.length;Ft++){var It=Et[Ft];It!==null&&(It.lane&=-536870913)}S&=~Wt}R!==0&&bt(p,R,0),W!==0&&z===0&&p.tag!==0&&(p.suspendedLanes|=W&~(re&~g))}function bt(p,g,S){p.pendingLanes|=g,p.suspendedLanes&=~g;var R=31-kt(g);p.entangledLanes|=g,p.entanglements[R]=p.entanglements[R]|1073741824|S&261930}function Bt(p,g){var S=p.entangledLanes|=g;for(p=p.entanglements;S;){var R=31-kt(S),z=1<<R;z&g|p[R]&g&&(p[R]|=g),S&=~z}}function ln(p,g){var S=g&-g;return S=(S&42)!==0?1:Ut(S),(S&(p.suspendedLanes|g))!==0?0:S}function Ut(p){switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=128;break;case 268435456:p=134217728;break;default:p=0}return p}function _(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function me(){var p=Y.p;return p!==0?p:(p=window.event,p===void 0?32:MV(p.type))}function Yn(p,g){var S=Y.p;try{return Y.p=p,g()}finally{Y.p=S}}var va=Math.random().toString(36).slice(2),Pa="__reactFiber$"+va,Ln="__reactProps$"+va,oa="__reactContainer$"+va,Kr="__reactEvents$"+va,ka="__reactListeners$"+va,la="__reactHandles$"+va,hr="__reactResources$"+va,yo="__reactMarker$"+va;function ah(p){delete p[Pa],delete p[Ln],delete p[Kr],delete p[ka],delete p[la]}function Uo(p){var g=p[Pa];if(g)return g;for(var S=p.parentNode;S;){if(g=S[oa]||S[Pa]){if(S=g.alternate,g.child!==null||S!==null&&S.child!==null)for(p=dV(p);p!==null;){if(S=p[Pa])return S;p=dV(p)}return g}p=S,S=p.parentNode}return null}function ts(p){if(p=p[Pa]||p[oa]){var g=p.tag;if(g===5||g===6||g===13||g===31||g===26||g===27||g===3)return p}return null}function qs(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p.stateNode;throw Error(i(33))}function Ps(p){var g=p[hr];return g||(g=p[hr]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function Se(p){p[yo]=!0}var ot=new Set,St={};function Ze(p,g){se(p,g),se(p+"Capture",g)}function se(p,g){for(St[p]=g,p=0;p<g.length;p++)ot.add(g[p])}var Dt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gn={},dn={};function bn(p){return Ue.call(dn,p)?!0:Ue.call(gn,p)?!1:Dt.test(p)?dn[p]=!0:(gn[p]=!0,!1)}function Mn(p,g,S){if(bn(g))if(S===null)p.removeAttribute(g);else{switch(typeof S){case"undefined":case"function":case"symbol":p.removeAttribute(g);return;case"boolean":var R=g.toLowerCase().slice(0,5);if(R!=="data-"&&R!=="aria-"){p.removeAttribute(g);return}}p.setAttribute(g,""+S)}}function Dn(p,g,S){if(S===null)p.removeAttribute(g);else{switch(typeof S){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(g);return}p.setAttribute(g,""+S)}}function de(p,g,S,R){if(R===null)p.removeAttribute(S);else{switch(typeof R){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(S);return}p.setAttributeNS(g,S,""+R)}}function Bn(p){switch(typeof p){case"bigint":case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function ja(p){var g=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function ki(p,g,S){var R=Object.getOwnPropertyDescriptor(p.constructor.prototype,g);if(!p.hasOwnProperty(g)&&typeof R<"u"&&typeof R.get=="function"&&typeof R.set=="function"){var z=R.get,W=R.set;return Object.defineProperty(p,g,{configurable:!0,get:function(){return z.call(this)},set:function(re){S=""+re,W.call(this,re)}}),Object.defineProperty(p,g,{enumerable:R.enumerable}),{getValue:function(){return S},setValue:function(re){S=""+re},stopTracking:function(){p._valueTracker=null,delete p[g]}}}}function Xn(p){if(!p._valueTracker){var g=ja(p)?"checked":"value";p._valueTracker=ki(p,g,""+p[g])}}function Ya(p){if(!p)return!1;var g=p._valueTracker;if(!g)return!0;var S=g.getValue(),R="";return p&&(R=ja(p)?p.checked?"true":"false":p.value),p=R,p!==S?(g.setValue(p),!0):!1}function Pn(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}var Fa=/[\n"\\]/g;function ca(p){return p.replace(Fa,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function Is(p,g,S,R,z,W,re,we){p.name="",re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"?p.type=re:p.removeAttribute("type"),g!=null?re==="number"?(g===0&&p.value===""||p.value!=g)&&(p.value=""+Bn(g)):p.value!==""+Bn(g)&&(p.value=""+Bn(g)):re!=="submit"&&re!=="reset"||p.removeAttribute("value"),g!=null?za(p,re,Bn(g)):S!=null?za(p,re,Bn(S)):R!=null&&p.removeAttribute("value"),z==null&&W!=null&&(p.defaultChecked=!!W),z!=null&&(p.checked=z&&typeof z!="function"&&typeof z!="symbol"),we!=null&&typeof we!="function"&&typeof we!="symbol"&&typeof we!="boolean"?p.name=""+Bn(we):p.removeAttribute("name")}function Hs(p,g,S,R,z,W,re,we){if(W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"&&(p.type=W),g!=null||S!=null){if(!(W!=="submit"&&W!=="reset"||g!=null)){Xn(p);return}S=S!=null?""+Bn(S):"",g=g!=null?""+Bn(g):S,we||g===p.value||(p.value=g),p.defaultValue=g}R=R??z,R=typeof R!="function"&&typeof R!="symbol"&&!!R,p.checked=we?p.checked:!!R,p.defaultChecked=!!R,re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"&&(p.name=re),Xn(p)}function za(p,g,S){g==="number"&&Pn(p.ownerDocument)===p||p.defaultValue===""+S||(p.defaultValue=""+S)}function Vo(p,g,S,R){if(p=p.options,g){g={};for(var z=0;z<S.length;z++)g["$"+S[z]]=!0;for(S=0;S<p.length;S++)z=g.hasOwnProperty("$"+p[S].value),p[S].selected!==z&&(p[S].selected=z),z&&R&&(p[S].defaultSelected=!0)}else{for(S=""+Bn(S),g=null,z=0;z<p.length;z++){if(p[z].value===S){p[z].selected=!0,R&&(p[z].defaultSelected=!0);return}g!==null||p[z].disabled||(g=p[z])}g!==null&&(g.selected=!0)}}function pi(p,g,S){if(g!=null&&(g=""+Bn(g),g!==p.value&&(p.value=g),S==null)){p.defaultValue!==g&&(p.defaultValue=g);return}p.defaultValue=S!=null?""+Bn(S):""}function ps(p,g,S,R){if(g==null){if(R!=null){if(S!=null)throw Error(i(92));if(ne(R)){if(1<R.length)throw Error(i(93));R=R[0]}S=R}S==null&&(S=""),g=S}S=Bn(g),p.defaultValue=S,R=p.textContent,R===S&&R!==""&&R!==null&&(p.value=R),Xn(p)}function Ci(p,g){if(g){var S=p.firstChild;if(S&&S===p.lastChild&&S.nodeType===3){S.nodeValue=g;return}}p.textContent=g}var Ws=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ls(p,g,S){var R=g.indexOf("--")===0;S==null||typeof S=="boolean"||S===""?R?p.setProperty(g,""):g==="float"?p.cssFloat="":p[g]="":R?p.setProperty(g,S):typeof S!="number"||S===0||Ws.has(g)?g==="float"?p.cssFloat=S:p[g]=(""+S).trim():p[g]=S+"px"}function id(p,g,S){if(g!=null&&typeof g!="object")throw Error(i(62));if(p=p.style,S!=null){for(var R in S)!S.hasOwnProperty(R)||g!=null&&g.hasOwnProperty(R)||(R.indexOf("--")===0?p.setProperty(R,""):R==="float"?p.cssFloat="":p[R]="");for(var z in g)R=g[z],g.hasOwnProperty(z)&&S[z]!==R&&Ls(p,z,R)}else for(var W in g)g.hasOwnProperty(W)&&Ls(p,W,g[W])}function zo(p){if(p.indexOf("-")===-1)return!1;switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _1=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),mi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ih(p){return mi.test(""+p)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":p}function Vl(){}var B0=null;function zl(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var sh=null,Pc=null;function sd(p){var g=ts(p);if(g&&(p=g.stateNode)){var S=p[Ln]||null;e:switch(p=g.stateNode,g.type){case"input":if(Is(p,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name),g=S.name,S.type==="radio"&&g!=null){for(S=p;S.parentNode;)S=S.parentNode;for(S=S.querySelectorAll('input[name="'+ca(""+g)+'"][type="radio"]'),g=0;g<S.length;g++){var R=S[g];if(R!==p&&R.form===p.form){var z=R[Ln]||null;if(!z)throw Error(i(90));Is(R,z.value,z.defaultValue,z.defaultValue,z.checked,z.defaultChecked,z.type,z.name)}}for(g=0;g<S.length;g++)R=S[g],R.form===p.form&&Ya(R)}break e;case"textarea":pi(p,S.value,S.defaultValue);break e;case"select":g=S.value,g!=null&&Vo(p,!!S.multiple,g,!1)}}}var rh=!1;function oh(p,g,S){if(rh)return p(g,S);rh=!0;try{var R=p(g);return R}finally{if(rh=!1,(sh!==null||Pc!==null)&&(aE(),sh&&(g=sh,p=Pc,Pc=sh=null,sd(g),p)))for(g=0;g<p.length;g++)sd(p[g])}}function Ic(p,g){var S=p.stateNode;if(S===null)return null;var R=S[Ln]||null;if(R===null)return null;S=R[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(R=!R.disabled)||(p=p.type,R=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!R;break e;default:p=!1}if(p)return null;if(S&&typeof S!="function")throw Error(i(231,g,typeof S));return S}var Gl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lh=!1;if(Gl)try{var Oi={};Object.defineProperty(Oi,"passive",{get:function(){lh=!0}}),window.addEventListener("test",Oi,Oi),window.removeEventListener("test",Oi,Oi)}catch{lh=!1}var ql=null,Jf=null,Zf=null;function Om(){if(Zf)return Zf;var p,g=Jf,S=g.length,R,z="value"in ql?ql.value:ql.textContent,W=z.length;for(p=0;p<S&&g[p]===z[p];p++);var re=S-p;for(R=1;R<=re&&g[S-R]===z[W-R];R++);return Zf=z.slice(p,1<R?1-R:void 0)}function ch(p){var g=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&g===13&&(p=13)):p=g,p===10&&(p=13),32<=p||p===13?p:0}function xu(){return!0}function Lc(){return!1}function Pr(p){function g(S,R,z,W,re){this._reactName=S,this._targetInst=z,this.type=R,this.nativeEvent=W,this.target=re,this.currentTarget=null;for(var we in p)p.hasOwnProperty(we)&&(S=p[we],this[we]=S?S(W):W[we]);return this.isDefaultPrevented=(W.defaultPrevented!=null?W.defaultPrevented:W.returnValue===!1)?xu:Lc,this.isPropagationStopped=Lc,this}return f(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var S=this.nativeEvent;S&&(S.preventDefault?S.preventDefault():typeof S.returnValue!="unknown"&&(S.returnValue=!1),this.isDefaultPrevented=xu)},stopPropagation:function(){var S=this.nativeEvent;S&&(S.stopPropagation?S.stopPropagation():typeof S.cancelBubble!="unknown"&&(S.cancelBubble=!0),this.isPropagationStopped=xu)},persist:function(){},isPersistent:xu}),g}var rd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bu=Pr(rd),ms=f({},rd,{view:0,detail:0}),Dc=Pr(ms),bs,uh,kc,od=f({},ms,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dh,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==kc&&(kc&&p.type==="mousemove"?(bs=p.screenX-kc.screenX,uh=p.screenY-kc.screenY):uh=bs=0,kc=p),bs)},movementY:function(p){return"movementY"in p?p.movementY:uh}}),U0=Pr(od),ep=f({},od,{dataTransfer:0}),x1=Pr(ep),V0=f({},ms,{relatedTarget:0}),Su=Pr(V0),Oc=f({},rd,{animationName:0,elapsedTime:0,pseudoElement:0}),z0=Pr(Oc),tp=f({},rd,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),np=Pr(tp),Tu=f({},rd,{data:0}),Ir=Pr(Tu),G0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function b1(p){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(p):(p=Fm[p])?!!g[p]:!1}function dh(){return b1}var Yr=f({},ms,{key:function(p){if(p.key){var g=G0[p.key]||p.key;if(g!=="Unidentified")return g}return p.type==="keypress"?(p=ch(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?q0[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dh,charCode:function(p){return p.type==="keypress"?ch(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?ch(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),S1=Pr(Yr),T1=f({},od,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ld=Pr(T1),B=f({},ms,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dh}),ee=Pr(B),he=f({},rd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pe=Pr(he),gt=f({},od,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),Ct=Pr(gt),cn=f({},rd,{newState:0,oldState:0}),Ea=Pr(cn),Ds=[9,13,27,32],Xa=Gl&&"CompositionEvent"in window,us=null;Gl&&"documentMode"in document&&(us=document.documentMode);var Go=Gl&&"TextEvent"in window&&!us,Fc=Gl&&(!Xa||us&&8<us&&11>=us),Xr=" ",jc=!1;function cd(p,g){switch(p){case"keyup":return Ds.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ap(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var jm=!1;function Sw(p,g){switch(p){case"compositionend":return ap(g);case"keypress":return g.which!==32?null:(jc=!0,Xr);case"textInput":return p=g.data,p===Xr&&jc?null:p;default:return null}}function gI(p,g){if(jm)return p==="compositionend"||!Xa&&cd(p,g)?(p=Om(),Zf=Jf=ql=null,jm=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return Fc&&g.locale!=="ko"?null:g.data;default:return null}}var AI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function w1(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g==="input"?!!AI[p.type]:g==="textarea"}function Tw(p,g,S,R){sh?Pc?Pc.push(R):Pc=[R]:sh=R,g=uE(g,"onChange"),0<g.length&&(S=new bu("onChange","change",null,S,R),p.push({event:S,listeners:g}))}var ip=null,sp=null;function H0(p){Q9(p,0)}function yi(p){var g=qs(p);if(Ya(g))return p}function ww(p,g){if(p==="change")return g}var Qx=!1;if(Gl){var E1;if(Gl){var Jx="oninput"in document;if(!Jx){var Ew=document.createElement("div");Ew.setAttribute("oninput","return;"),Jx=typeof Ew.oninput=="function"}E1=Jx}else E1=!1;Qx=E1&&(!document.documentMode||9<document.documentMode)}function Mw(){ip&&(ip.detachEvent("onpropertychange",Cw),sp=ip=null)}function Cw(p){if(p.propertyName==="value"&&yi(sp)){var g=[];Tw(g,sp,p,zl(p)),oh(H0,g)}}function qo(p,g,S){p==="focusin"?(Mw(),ip=g,sp=S,ip.attachEvent("onpropertychange",Cw)):p==="focusout"&&Mw()}function Zx(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return yi(sp)}function rp(p,g){if(p==="click")return yi(g)}function yI(p,g){if(p==="input"||p==="change")return yi(g)}function eb(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var Al=typeof Object.is=="function"?Object.is:eb;function Qr(p,g){if(Al(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var S=Object.keys(p),R=Object.keys(g);if(S.length!==R.length)return!1;for(R=0;R<S.length;R++){var z=S[R];if(!Ue.call(g,z)||!Al(p[z],g[z]))return!1}return!0}function M1(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function C1(p,g){var S=M1(p);p=0;for(var R;S;){if(S.nodeType===3){if(R=p+S.textContent.length,p<=g&&R>=g)return{node:S,offset:g-p};p=R}e:{for(;S;){if(S.nextSibling){S=S.nextSibling;break e}S=S.parentNode}S=void 0}S=M1(S)}}function op(p,g){return p&&g?p===g?!0:p&&p.nodeType===3?!1:g&&g.nodeType===3?op(p,g.parentNode):"contains"in p?p.contains(g):p.compareDocumentPosition?!!(p.compareDocumentPosition(g)&16):!1:!1}function hh(p){p=p!=null&&p.ownerDocument!=null&&p.ownerDocument.defaultView!=null?p.ownerDocument.defaultView:window;for(var g=Pn(p.document);g instanceof p.HTMLIFrameElement;){try{var S=typeof g.contentWindow.location.href=="string"}catch{S=!1}if(S)p=g.contentWindow;else break;g=Pn(p.document)}return g}function fh(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g&&(g==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||g==="textarea"||p.contentEditable==="true")}var vI=Gl&&"documentMode"in document&&11>=document.documentMode,lp=null,tb=null,cp=null,nb=!1;function Nw(p,g,S){var R=S.window===S?S.document:S.nodeType===9?S:S.ownerDocument;nb||lp==null||lp!==Pn(R)||(R=lp,"selectionStart"in R&&fh(R)?R={start:R.selectionStart,end:R.selectionEnd}:(R=(R.ownerDocument&&R.ownerDocument.defaultView||window).getSelection(),R={anchorNode:R.anchorNode,anchorOffset:R.anchorOffset,focusNode:R.focusNode,focusOffset:R.focusOffset}),cp&&Qr(cp,R)||(cp=R,R=uE(tb,"onSelect"),0<R.length&&(g=new bu("onSelect","select",null,g,S),p.push({event:g,listeners:R}),g.target=lp)))}function ud(p,g){var S={};return S[p.toLowerCase()]=g.toLowerCase(),S["Webkit"+p]="webkit"+g,S["Moz"+p]="moz"+g,S}var up={animationend:ud("Animation","AnimationEnd"),animationiteration:ud("Animation","AnimationIteration"),animationstart:ud("Animation","AnimationStart"),transitionrun:ud("Transition","TransitionRun"),transitionstart:ud("Transition","TransitionStart"),transitioncancel:ud("Transition","TransitionCancel"),transitionend:ud("Transition","TransitionEnd")},W0={},Bm={};Gl&&(Bm=document.createElement("div").style,"AnimationEvent"in window||(delete up.animationend.animation,delete up.animationiteration.animation,delete up.animationstart.animation),"TransitionEvent"in window||delete up.transitionend.transition);function Hl(p){if(W0[p])return W0[p];if(!up[p])return p;var g=up[p],S;for(S in g)if(g.hasOwnProperty(S)&&S in Bm)return W0[p]=g[S];return p}var Ho=Hl("animationend"),Rw=Hl("animationiteration"),Um=Hl("animationstart"),_I=Hl("transitionrun"),xI=Hl("transitionstart"),bI=Hl("transitioncancel"),ab=Hl("transitionend"),Pw=new Map,ib="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ib.push("scrollEnd");function Bc(p,g){Pw.set(p,g),Ze(g,[p])}var dp=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",p);return}console.error(p)},yl=[],ph=0,sb=0;function N1(){for(var p=ph,g=sb=ph=0;g<p;){var S=yl[g];yl[g++]=null;var R=yl[g];yl[g++]=null;var z=yl[g];yl[g++]=null;var W=yl[g];if(yl[g++]=null,R!==null&&z!==null){var re=R.pending;re===null?z.next=z:(z.next=re.next,re.next=z),R.pending=z}W!==0&&Iw(S,z,W)}}function R1(p,g,S,R){yl[ph++]=p,yl[ph++]=g,yl[ph++]=S,yl[ph++]=R,sb|=R,p.lanes|=R,p=p.alternate,p!==null&&(p.lanes|=R)}function rb(p,g,S,R){return R1(p,g,S,R),P1(p)}function hp(p,g){return R1(p,null,null,g),P1(p)}function Iw(p,g,S){p.lanes|=S;var R=p.alternate;R!==null&&(R.lanes|=S);for(var z=!1,W=p.return;W!==null;)W.childLanes|=S,R=W.alternate,R!==null&&(R.childLanes|=S),W.tag===22&&(p=W.stateNode,p===null||p._visibility&1||(z=!0)),p=W,W=W.return;return p.tag===3?(W=p.stateNode,z&&g!==null&&(z=31-kt(S),p=W.hiddenUpdates,R=p[z],R===null?p[z]=[g]:R.push(g),g.lane=S|536870912),W):null}function P1(p){if(50<wb)throw wb=0,dL=null,Error(i(185));for(var g=p.return;g!==null;)p=g,g=p.return;return p.tag===3?p.stateNode:null}var fp={};function SI(p,g,S,R){this.tag=p,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=R,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wo(p,g,S,R){return new SI(p,g,S,R)}function Uc(p){return p=p.prototype,!(!p||!p.isReactComponent)}function wu(p,g){var S=p.alternate;return S===null?(S=Wo(p.tag,g,p.key,p.mode),S.elementType=p.elementType,S.type=p.type,S.stateNode=p.stateNode,S.alternate=p,p.alternate=S):(S.pendingProps=g,S.type=p.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=p.flags&65011712,S.childLanes=p.childLanes,S.lanes=p.lanes,S.child=p.child,S.memoizedProps=p.memoizedProps,S.memoizedState=p.memoizedState,S.updateQueue=p.updateQueue,g=p.dependencies,S.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},S.sibling=p.sibling,S.index=p.index,S.ref=p.ref,S.refCleanup=p.refCleanup,S}function Lw(p,g){p.flags&=65011714;var S=p.alternate;return S===null?(p.childLanes=0,p.lanes=g,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=S.childLanes,p.lanes=S.lanes,p.child=S.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=S.memoizedProps,p.memoizedState=S.memoizedState,p.updateQueue=S.updateQueue,p.type=S.type,g=S.dependencies,p.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),p}function I1(p,g,S,R,z,W){var re=0;if(R=p,typeof p=="function")Uc(p)&&(re=1);else if(typeof p=="string")re=Wce(p,S,Ce.current)?26:p==="html"||p==="head"||p==="body"?27:5;else e:switch(p){case L:return p=Wo(31,S,g,z),p.elementType=L,p.lanes=W,p;case T:return pp(S.children,z,W,g);case E:re=8,z|=24;break;case M:return p=Wo(12,S,g,z|2),p.elementType=M,p.lanes=W,p;case G:return p=Wo(13,S,g,z),p.elementType=G,p.lanes=W,p;case O:return p=Wo(19,S,g,z),p.elementType=O,p.lanes=W,p;default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case I:re=10;break e;case N:re=9;break e;case F:re=11;break e;case D:re=14;break e;case j:re=16,R=null;break e}re=29,S=Error(i(130,p===null?"null":typeof p,"")),R=null}return g=Wo(re,S,g,z),g.elementType=p,g.type=R,g.lanes=W,g}function pp(p,g,S,R){return p=Wo(7,p,R,g),p.lanes=S,p}function ob(p,g,S){return p=Wo(6,p,null,g),p.lanes=S,p}function Dw(p){var g=Wo(18,null,null,0);return g.stateNode=p,g}function Eu(p,g,S){return g=Wo(4,p.children!==null?p.children:[],p.key,g),g.lanes=S,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}var L1=new WeakMap;function Wl(p,g){if(typeof p=="object"&&p!==null){var S=L1.get(p);return S!==void 0?S:(g={value:p,source:g,stack:ve(g)},L1.set(p,g),g)}return{value:p,source:g,stack:ve(g)}}var dd=[],mp=0,D1=null,$0=0,Jr=[],vl=0,$l=null,Kl=1,Yl="";function Mu(p,g){dd[mp++]=$0,dd[mp++]=D1,D1=p,$0=g}function K0(p,g,S){Jr[vl++]=Kl,Jr[vl++]=Yl,Jr[vl++]=$l,$l=p;var R=Kl;p=Yl;var z=32-kt(R)-1;R&=~(1<<z),S+=1;var W=32-kt(g)+z;if(30<W){var re=z-z%5;W=(R&(1<<re)-1).toString(32),R>>=re,z-=re,Kl=1<<32-kt(g)+z|S<<z|R,Yl=W+p}else Kl=1<<W|S<<z|R,Yl=p}function k1(p){p.return!==null&&(Mu(p,1),K0(p,1,0))}function lb(p){for(;p===D1;)D1=dd[--mp],dd[mp]=null,$0=dd[--mp],dd[mp]=null;for(;p===$l;)$l=Jr[--vl],Jr[vl]=null,Yl=Jr[--vl],Jr[vl]=null,Kl=Jr[--vl],Jr[vl]=null}function kw(p,g){Jr[vl++]=Kl,Jr[vl++]=Yl,Jr[vl++]=$l,Kl=g.id,Yl=g.overflow,$l=p}var Lr=null,ns=null,Qa=!1,mh=null,Xl=!1,cb=Error(i(519));function gh(p){var g=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hd(Wl(g,p)),cb}function ub(p){var g=p.stateNode,S=p.type,R=p.memoizedProps;switch(g[Pa]=p,g[Ln]=R,S){case"dialog":Za("cancel",g),Za("close",g);break;case"iframe":case"object":case"embed":Za("load",g);break;case"video":case"audio":for(S=0;S<Mb.length;S++)Za(Mb[S],g);break;case"source":Za("error",g);break;case"img":case"image":case"link":Za("error",g),Za("load",g);break;case"details":Za("toggle",g);break;case"input":Za("invalid",g),Hs(g,R.value,R.defaultValue,R.checked,R.defaultChecked,R.type,R.name,!0);break;case"select":Za("invalid",g);break;case"textarea":Za("invalid",g),ps(g,R.value,R.defaultValue,R.children)}S=R.children,typeof S!="string"&&typeof S!="number"&&typeof S!="bigint"||g.textContent===""+S||R.suppressHydrationWarning===!0||tV(g.textContent,S)?(R.popover!=null&&(Za("beforetoggle",g),Za("toggle",g)),R.onScroll!=null&&Za("scroll",g),R.onScrollEnd!=null&&Za("scrollend",g),R.onClick!=null&&(g.onclick=Vl),g=!0):g=!1,g||gh(p,!0)}function db(p){for(Lr=p.return;Lr;)switch(Lr.tag){case 5:case 31:case 13:Xl=!1;return;case 27:case 3:Xl=!0;return;default:Lr=Lr.return}}function as(p){if(p!==Lr)return!1;if(!Qa)return db(p),Qa=!0,!1;var g=p.tag,S;if((S=g!==3&&g!==27)&&((S=g===5)&&(S=p.type,S=!(S!=="form"&&S!=="button")||EL(p.type,p.memoizedProps)),S=!S),S&&ns&&gh(p),db(p),g===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));ns=uV(p)}else if(g===31){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));ns=uV(p)}else g===27?(g=ns,Qm(p.type)?(p=PL,PL=null,ns=p):ns=g):ns=Lr?Pu(p.stateNode.nextSibling):null;return!0}function gp(){ns=Lr=null,Qa=!1}function hb(){var p=mh;return p!==null&&(ec===null?ec=p:ec.push.apply(ec,p),mh=null),p}function hd(p){mh===null?mh=[p]:mh.push(p)}var $o=oe(null),Ap=null,fd=null;function pd(p,g,S){be($o,g._currentValue),g._currentValue=S}function Cu(p){p._currentValue=$o.current,Ae($o)}function O1(p,g,S){for(;p!==null;){var R=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,R!==null&&(R.childLanes|=g)):R!==null&&(R.childLanes&g)!==g&&(R.childLanes|=g),p===S)break;p=p.return}}function F1(p,g,S,R){var z=p.child;for(z!==null&&(z.return=p);z!==null;){var W=z.dependencies;if(W!==null){var re=z.child;W=W.firstContext;e:for(;W!==null;){var we=W;W=z;for(var He=0;He<g.length;He++)if(we.context===g[He]){W.lanes|=S,we=W.alternate,we!==null&&(we.lanes|=S),O1(W.return,S,p),R||(re=null);break e}W=we.next}}else if(z.tag===18){if(re=z.return,re===null)throw Error(i(341));re.lanes|=S,W=re.alternate,W!==null&&(W.lanes|=S),O1(re,S,p),re=null}else re=z.child;if(re!==null)re.return=z;else for(re=z;re!==null;){if(re===p){re=null;break}if(z=re.sibling,z!==null){z.return=re.return,re=z;break}re=re.return}z=re}}function yp(p,g,S,R){p=null;for(var z=g,W=!1;z!==null;){if(!W){if((z.flags&524288)!==0)W=!0;else if((z.flags&262144)!==0)break}if(z.tag===10){var re=z.alternate;if(re===null)throw Error(i(387));if(re=re.memoizedProps,re!==null){var we=z.type;Al(z.pendingProps.value,re.value)||(p!==null?p.push(we):p=[we])}}else if(z===fe.current){if(re=z.alternate,re===null)throw Error(i(387));re.memoizedState.memoizedState!==z.memoizedState.memoizedState&&(p!==null?p.push(Ib):p=[Ib])}z=z.return}p!==null&&F1(g,p,S,R),g.flags|=262144}function j1(p){for(p=p.firstContext;p!==null;){if(!Al(p.context._currentValue,p.memoizedValue))return!0;p=p.next}return!1}function vp(p){Ap=p,fd=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function Dr(p){return md(Ap,p)}function B1(p,g){return Ap===null&&vp(p),md(p,g)}function md(p,g){var S=g._currentValue;if(g={context:g,memoizedValue:S,next:null},fd===null){if(p===null)throw Error(i(308));fd=g,p.dependencies={lanes:0,firstContext:g},p.flags|=524288}else fd=fd.next=g;return S}var Nu=typeof AbortController<"u"?AbortController:function(){var p=[],g=this.signal={aborted:!1,addEventListener:function(S,R){p.push(R)}};this.abort=function(){g.aborted=!0,p.forEach(function(S){return S()})}},Un=a.unstable_scheduleCallback,Ko=a.unstable_NormalPriority,fn={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $s(){return{controller:new Nu,data:new Map,refCount:0}}function Vm(p){p.refCount--,p.refCount===0&&Un(Ko,function(){p.controller.abort()})}var _p=null,Ru=0,zm=0,gs=null;function Gm(p,g){if(_p===null){var S=_p=[];Ru=0,zm=AL(),gs={status:"pending",value:void 0,then:function(R){S.push(R)}}}return Ru++,g.then(xp,xp),g}function xp(){if(--Ru===0&&_p!==null){gs!==null&&(gs.status="fulfilled");var p=_p;_p=null,zm=0,gs=null;for(var g=0;g<p.length;g++)(0,p[g])()}}function Ow(p,g){var S=[],R={status:"pending",value:null,reason:null,then:function(z){S.push(z)}};return p.then(function(){R.status="fulfilled",R.value=g;for(var z=0;z<S.length;z++)(0,S[z])(g)},function(z){for(R.status="rejected",R.reason=z,z=0;z<S.length;z++)(0,S[z])(void 0)}),R}var Gt=Q.S;Q.S=function(p,g){w9=le(),typeof g=="object"&&g!==null&&typeof g.then=="function"&&Gm(p,g),Gt!==null&&Gt(p,g)};var Jt=oe(null);function Y0(){var p=Jt.current;return p!==null?p:is.pooledCache}function X0(p,g){g===null?be(Jt,Jt.current):be(Jt,g.pool)}function Q0(){var p=Y0();return p===null?null:{parent:fn._currentValue,pool:p}}var gd=Error(i(460)),Ah=Error(i(474)),Vc=Error(i(542)),J0={then:function(){}};function Ad(p){return p=p.status,p==="fulfilled"||p==="rejected"}function v(p,g,S){switch(S=p[S],S===void 0?p.push(g):S!==g&&(g.then(Vl,Vl),g=S),g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,C(p),p;default:if(typeof g.status=="string")g.then(Vl,Vl);else{if(p=is,p!==null&&100<p.shellSuspendCounter)throw Error(i(482));p=g,p.status="pending",p.then(function(R){if(g.status==="pending"){var z=g;z.status="fulfilled",z.value=R}},function(R){if(g.status==="pending"){var z=g;z.status="rejected",z.reason=R}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,C(p),p}throw b=g,gd}}function y(p){try{var g=p._init;return g(p._payload)}catch(S){throw S!==null&&typeof S=="object"&&typeof S.then=="function"?(b=S,gd):S}}var b=null;function w(){if(b===null)throw Error(i(459));var p=b;return b=null,p}function C(p){if(p===gd||p===Vc)throw Error(i(483))}var P=null,k=0;function V(p){var g=k;return k+=1,P===null&&(P=[]),v(P,p,g)}function $(p,g){g=g.props.ref,p.ref=g!==void 0?g:null}function J(p,g){throw g.$$typeof===m?Error(i(525)):(p=Object.prototype.toString.call(g),Error(i(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p)))}function ae(p){function g(dt,et){if(p){var _t=dt.deletions;_t===null?(dt.deletions=[et],dt.flags|=16):_t.push(et)}}function S(dt,et){if(!p)return null;for(;et!==null;)g(dt,et),et=et.sibling;return null}function R(dt){for(var et=new Map;dt!==null;)dt.key!==null?et.set(dt.key,dt):et.set(dt.index,dt),dt=dt.sibling;return et}function z(dt,et){return dt=wu(dt,et),dt.index=0,dt.sibling=null,dt}function W(dt,et,_t){return dt.index=_t,p?(_t=dt.alternate,_t!==null?(_t=_t.index,_t<et?(dt.flags|=67108866,et):_t):(dt.flags|=67108866,et)):(dt.flags|=1048576,et)}function re(dt){return p&&dt.alternate===null&&(dt.flags|=67108866),dt}function we(dt,et,_t,Vt){return et===null||et.tag!==6?(et=ob(_t,dt.mode,Vt),et.return=dt,et):(et=z(et,_t),et.return=dt,et)}function He(dt,et,_t,Vt){var $n=_t.type;return $n===T?Ft(dt,et,_t.props.children,Vt,_t.key):et!==null&&(et.elementType===$n||typeof $n=="object"&&$n!==null&&$n.$$typeof===j&&y($n)===et.type)?(et=z(et,_t.props),$(et,_t),et.return=dt,et):(et=I1(_t.type,_t.key,_t.props,null,dt.mode,Vt),$(et,_t),et.return=dt,et)}function xt(dt,et,_t,Vt){return et===null||et.tag!==4||et.stateNode.containerInfo!==_t.containerInfo||et.stateNode.implementation!==_t.implementation?(et=Eu(_t,dt.mode,Vt),et.return=dt,et):(et=z(et,_t.children||[]),et.return=dt,et)}function Ft(dt,et,_t,Vt,$n){return et===null||et.tag!==7?(et=pp(_t,dt.mode,Vt,$n),et.return=dt,et):(et=z(et,_t),et.return=dt,et)}function Wt(dt,et,_t){if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return et=ob(""+et,dt.mode,_t),et.return=dt,et;if(typeof et=="object"&&et!==null){switch(et.$$typeof){case A:return _t=I1(et.type,et.key,et.props,null,dt.mode,_t),$(_t,et),_t.return=dt,_t;case x:return et=Eu(et,dt.mode,_t),et.return=dt,et;case j:return et=y(et),Wt(dt,et,_t)}if(ne(et)||K(et))return et=pp(et,dt.mode,_t,null),et.return=dt,et;if(typeof et.then=="function")return Wt(dt,V(et),_t);if(et.$$typeof===I)return Wt(dt,B1(dt,et),_t);J(dt,et)}return null}function Et(dt,et,_t,Vt){var $n=et!==null?et.key:null;if(typeof _t=="string"&&_t!==""||typeof _t=="number"||typeof _t=="bigint")return $n!==null?null:we(dt,et,""+_t,Vt);if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case A:return _t.key===$n?He(dt,et,_t,Vt):null;case x:return _t.key===$n?xt(dt,et,_t,Vt):null;case j:return _t=y(_t),Et(dt,et,_t,Vt)}if(ne(_t)||K(_t))return $n!==null?null:Ft(dt,et,_t,Vt,null);if(typeof _t.then=="function")return Et(dt,et,V(_t),Vt);if(_t.$$typeof===I)return Et(dt,et,B1(dt,_t),Vt);J(dt,_t)}return null}function It(dt,et,_t,Vt,$n){if(typeof Vt=="string"&&Vt!==""||typeof Vt=="number"||typeof Vt=="bigint")return dt=dt.get(_t)||null,we(et,dt,""+Vt,$n);if(typeof Vt=="object"&&Vt!==null){switch(Vt.$$typeof){case A:return dt=dt.get(Vt.key===null?_t:Vt.key)||null,He(et,dt,Vt,$n);case x:return dt=dt.get(Vt.key===null?_t:Vt.key)||null,xt(et,dt,Vt,$n);case j:return Vt=y(Vt),It(dt,et,_t,Vt,$n)}if(ne(Vt)||K(Vt))return dt=dt.get(_t)||null,Ft(et,dt,Vt,$n,null);if(typeof Vt.then=="function")return It(dt,et,_t,V(Vt),$n);if(Vt.$$typeof===I)return It(dt,et,_t,B1(et,Vt),$n);J(et,Vt)}return null}function In(dt,et,_t,Vt){for(var $n=null,Ti=null,Fn=et,Oa=et=0,si=null;Fn!==null&&Oa<_t.length;Oa++){Fn.index>Oa?(si=Fn,Fn=null):si=Fn.sibling;var wi=Et(dt,Fn,_t[Oa],Vt);if(wi===null){Fn===null&&(Fn=si);break}p&&Fn&&wi.alternate===null&&g(dt,Fn),et=W(wi,et,Oa),Ti===null?$n=wi:Ti.sibling=wi,Ti=wi,Fn=si}if(Oa===_t.length)return S(dt,Fn),Qa&&Mu(dt,Oa),$n;if(Fn===null){for(;Oa<_t.length;Oa++)Fn=Wt(dt,_t[Oa],Vt),Fn!==null&&(et=W(Fn,et,Oa),Ti===null?$n=Fn:Ti.sibling=Fn,Ti=Fn);return Qa&&Mu(dt,Oa),$n}for(Fn=R(Fn);Oa<_t.length;Oa++)si=It(Fn,dt,Oa,_t[Oa],Vt),si!==null&&(p&&si.alternate!==null&&Fn.delete(si.key===null?Oa:si.key),et=W(si,et,Oa),Ti===null?$n=si:Ti.sibling=si,Ti=si);return p&&Fn.forEach(function(ng){return g(dt,ng)}),Qa&&Mu(dt,Oa),$n}function ra(dt,et,_t,Vt){if(_t==null)throw Error(i(151));for(var $n=null,Ti=null,Fn=et,Oa=et=0,si=null,wi=_t.next();Fn!==null&&!wi.done;Oa++,wi=_t.next()){Fn.index>Oa?(si=Fn,Fn=null):si=Fn.sibling;var ng=Et(dt,Fn,wi.value,Vt);if(ng===null){Fn===null&&(Fn=si);break}p&&Fn&&ng.alternate===null&&g(dt,Fn),et=W(ng,et,Oa),Ti===null?$n=ng:Ti.sibling=ng,Ti=ng,Fn=si}if(wi.done)return S(dt,Fn),Qa&&Mu(dt,Oa),$n;if(Fn===null){for(;!wi.done;Oa++,wi=_t.next())wi=Wt(dt,wi.value,Vt),wi!==null&&(et=W(wi,et,Oa),Ti===null?$n=wi:Ti.sibling=wi,Ti=wi);return Qa&&Mu(dt,Oa),$n}for(Fn=R(Fn);!wi.done;Oa++,wi=_t.next())wi=It(Fn,dt,Oa,wi.value,Vt),wi!==null&&(p&&wi.alternate!==null&&Fn.delete(wi.key===null?Oa:wi.key),et=W(wi,et,Oa),Ti===null?$n=wi:Ti.sibling=wi,Ti=wi);return p&&Fn.forEach(function(aue){return g(dt,aue)}),Qa&&Mu(dt,Oa),$n}function Yi(dt,et,_t,Vt){if(typeof _t=="object"&&_t!==null&&_t.type===T&&_t.key===null&&(_t=_t.props.children),typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case A:e:{for(var $n=_t.key;et!==null;){if(et.key===$n){if($n=_t.type,$n===T){if(et.tag===7){S(dt,et.sibling),Vt=z(et,_t.props.children),Vt.return=dt,dt=Vt;break e}}else if(et.elementType===$n||typeof $n=="object"&&$n!==null&&$n.$$typeof===j&&y($n)===et.type){S(dt,et.sibling),Vt=z(et,_t.props),$(Vt,_t),Vt.return=dt,dt=Vt;break e}S(dt,et);break}else g(dt,et);et=et.sibling}_t.type===T?(Vt=pp(_t.props.children,dt.mode,Vt,_t.key),Vt.return=dt,dt=Vt):(Vt=I1(_t.type,_t.key,_t.props,null,dt.mode,Vt),$(Vt,_t),Vt.return=dt,dt=Vt)}return re(dt);case x:e:{for($n=_t.key;et!==null;){if(et.key===$n)if(et.tag===4&&et.stateNode.containerInfo===_t.containerInfo&&et.stateNode.implementation===_t.implementation){S(dt,et.sibling),Vt=z(et,_t.children||[]),Vt.return=dt,dt=Vt;break e}else{S(dt,et);break}else g(dt,et);et=et.sibling}Vt=Eu(_t,dt.mode,Vt),Vt.return=dt,dt=Vt}return re(dt);case j:return _t=y(_t),Yi(dt,et,_t,Vt)}if(ne(_t))return In(dt,et,_t,Vt);if(K(_t)){if($n=K(_t),typeof $n!="function")throw Error(i(150));return _t=$n.call(_t),ra(dt,et,_t,Vt)}if(typeof _t.then=="function")return Yi(dt,et,V(_t),Vt);if(_t.$$typeof===I)return Yi(dt,et,B1(dt,_t),Vt);J(dt,_t)}return typeof _t=="string"&&_t!==""||typeof _t=="number"||typeof _t=="bigint"?(_t=""+_t,et!==null&&et.tag===6?(S(dt,et.sibling),Vt=z(et,_t),Vt.return=dt,dt=Vt):(S(dt,et),Vt=ob(_t,dt.mode,Vt),Vt.return=dt,dt=Vt),re(dt)):S(dt,et)}return function(dt,et,_t,Vt){try{k=0;var $n=Yi(dt,et,_t,Vt);return P=null,$n}catch(Fn){if(Fn===gd||Fn===Vc)throw Fn;var Ti=Wo(29,Fn,null,dt.mode);return Ti.lanes=Vt,Ti.return=dt,Ti}}}var xe=ae(!0),ke=ae(!1),De=!1;function Oe(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $e(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function nt(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function At(p,g,S){var R=p.updateQueue;if(R===null)return null;if(R=R.shared,(Ni&2)!==0){var z=R.pending;return z===null?g.next=g:(g.next=z.next,z.next=g),R.pending=g,g=P1(p),Iw(p,null,S),g}return R1(p,R,g,S),P1(p)}function ut(p,g,S){if(g=g.updateQueue,g!==null&&(g=g.shared,(S&4194048)!==0)){var R=g.lanes;R&=p.pendingLanes,S|=R,g.lanes=S,Bt(p,S)}}function lt(p,g){var S=p.updateQueue,R=p.alternate;if(R!==null&&(R=R.updateQueue,S===R)){var z=null,W=null;if(S=S.firstBaseUpdate,S!==null){do{var re={lane:S.lane,tag:S.tag,payload:S.payload,callback:null,next:null};W===null?z=W=re:W=W.next=re,S=S.next}while(S!==null);W===null?z=W=g:W=W.next=g}else z=W=g;S={baseState:R.baseState,firstBaseUpdate:z,lastBaseUpdate:W,shared:R.shared,callbacks:R.callbacks},p.updateQueue=S;return}p=S.lastBaseUpdate,p===null?S.firstBaseUpdate=g:p.next=g,S.lastBaseUpdate=g}var Ke=!1;function en(){if(Ke){var p=gs;if(p!==null)throw p}}function wn(p,g,S,R){Ke=!1;var z=p.updateQueue;De=!1;var W=z.firstBaseUpdate,re=z.lastBaseUpdate,we=z.shared.pending;if(we!==null){z.shared.pending=null;var He=we,xt=He.next;He.next=null,re===null?W=xt:re.next=xt,re=He;var Ft=p.alternate;Ft!==null&&(Ft=Ft.updateQueue,we=Ft.lastBaseUpdate,we!==re&&(we===null?Ft.firstBaseUpdate=xt:we.next=xt,Ft.lastBaseUpdate=He))}if(W!==null){var Wt=z.baseState;re=0,Ft=xt=He=null,we=W;do{var Et=we.lane&-536870913,It=Et!==we.lane;if(It?(ii&Et)===Et:(R&Et)===Et){Et!==0&&Et===zm&&(Ke=!0),Ft!==null&&(Ft=Ft.next={lane:0,tag:we.tag,payload:we.payload,callback:null,next:null});e:{var In=p,ra=we;Et=g;var Yi=S;switch(ra.tag){case 1:if(In=ra.payload,typeof In=="function"){Wt=In.call(Yi,Wt,Et);break e}Wt=In;break e;case 3:In.flags=In.flags&-65537|128;case 0:if(In=ra.payload,Et=typeof In=="function"?In.call(Yi,Wt,Et):In,Et==null)break e;Wt=f({},Wt,Et);break e;case 2:De=!0}}Et=we.callback,Et!==null&&(p.flags|=64,It&&(p.flags|=8192),It=z.callbacks,It===null?z.callbacks=[Et]:It.push(Et))}else It={lane:Et,tag:we.tag,payload:we.payload,callback:we.callback,next:null},Ft===null?(xt=Ft=It,He=Wt):Ft=Ft.next=It,re|=Et;if(we=we.next,we===null){if(we=z.shared.pending,we===null)break;It=we,we=It.next,It.next=null,z.lastBaseUpdate=It,z.shared.pending=null}}while(!0);Ft===null&&(He=Wt),z.baseState=He,z.firstBaseUpdate=xt,z.lastBaseUpdate=Ft,W===null&&(z.shared.lanes=0),Wm|=re,p.lanes=re,p.memoizedState=Wt}}function vn(p,g){if(typeof p!="function")throw Error(i(191,p));p.call(g)}function ua(p,g){var S=p.callbacks;if(S!==null)for(p.callbacks=null,p=0;p<S.length;p++)vn(S[p],g)}var ea=oe(null),wa=oe(0);function Qn(p,g){p=Rp,be(wa,p),be(ea,g),Rp=p|g.baseLanes}function Cn(){be(wa,Rp),be(ea,ea.current)}function tn(){Rp=wa.current,Ae(ea),Ae(wa)}var Gn=oe(null),Ia=null;function Jn(p){var g=p.alternate;be(ar,ar.current&1),be(Gn,p),Ia===null&&(g===null||ea.current!==null||g.memoizedState!==null)&&(Ia=p)}function vi(p){be(ar,ar.current),be(Gn,p),Ia===null&&(Ia=p)}function Zr(p){p.tag===22?(be(ar,ar.current),be(Gn,p),Ia===null&&(Ia=p)):yd()}function yd(){be(ar,ar.current),be(Gn,Gn.current)}function zc(p){Ae(Gn),Ia===p&&(Ia=null),Ae(ar)}var ar=oe(0);function Fw(p){for(var g=p;g!==null;){if(g.tag===13){var S=g.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||NL(S)||RL(S)))return g}else if(g.tag===19&&(g.memoizedProps.revealOrder==="forwards"||g.memoizedProps.revealOrder==="backwards"||g.memoizedProps.revealOrder==="unstable_legacy-backwards"||g.memoizedProps.revealOrder==="together")){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var bp=0,La=null,$i=null,fr=null,jw=!1,U1=!1,Z0=!1,Bw=0,fb=0,V1=null,$le=0;function Ks(){throw Error(i(321))}function TI(p,g){if(g===null)return!1;for(var S=0;S<g.length&&S<p.length;S++)if(!Al(p[S],g[S]))return!1;return!0}function wI(p,g,S,R,z,W){return bp=W,La=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Q.H=p===null||p.memoizedState===null?OU:UI,Z0=!1,W=S(R,z),Z0=!1,U1&&(W=tU(g,S,R,z)),eU(p),W}function eU(p){Q.H=gb;var g=$i!==null&&$i.next!==null;if(bp=0,fr=$i=La=null,jw=!1,fb=0,V1=null,g)throw Error(i(300));p===null||pr||(p=p.dependencies,p!==null&&j1(p)&&(pr=!0))}function tU(p,g,S,R){La=p;var z=0;do{if(U1&&(V1=null),fb=0,U1=!1,25<=z)throw Error(i(301));if(z+=1,fr=$i=null,p.updateQueue!=null){var W=p.updateQueue;W.lastEffect=null,W.events=null,W.stores=null,W.memoCache!=null&&(W.memoCache.index=0)}Q.H=FU,W=g(S,R)}while(U1);return W}function Kle(){var p=Q.H,g=p.useState()[0];return g=typeof g.then=="function"?pb(g):g,p=p.useState()[0],($i!==null?$i.memoizedState:null)!==p&&(La.flags|=1024),g}function EI(){var p=Bw!==0;return Bw=0,p}function MI(p,g,S){g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~S}function CI(p){if(jw){for(p=p.memoizedState;p!==null;){var g=p.queue;g!==null&&(g.pending=null),p=p.next}jw=!1}bp=0,fr=$i=La=null,U1=!1,fb=Bw=0,V1=null}function _l(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fr===null?La.memoizedState=fr=p:fr=fr.next=p,fr}function ir(){if($i===null){var p=La.alternate;p=p!==null?p.memoizedState:null}else p=$i.next;var g=fr===null?La.memoizedState:fr.next;if(g!==null)fr=g,$i=p;else{if(p===null)throw La.alternate===null?Error(i(467)):Error(i(310));$i=p,p={memoizedState:$i.memoizedState,baseState:$i.baseState,baseQueue:$i.baseQueue,queue:$i.queue,next:null},fr===null?La.memoizedState=fr=p:fr=fr.next=p}return fr}function Uw(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function pb(p){var g=fb;return fb+=1,V1===null&&(V1=[]),p=v(V1,p,g),g=La,(fr===null?g.memoizedState:fr.next)===null&&(g=g.alternate,Q.H=g===null||g.memoizedState===null?OU:UI),p}function Vw(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return pb(p);if(p.$$typeof===I)return Dr(p)}throw Error(i(438,String(p)))}function NI(p){var g=null,S=La.updateQueue;if(S!==null&&(g=S.memoCache),g==null){var R=La.alternate;R!==null&&(R=R.updateQueue,R!==null&&(R=R.memoCache,R!=null&&(g={data:R.data.map(function(z){return z.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),S===null&&(S=Uw(),La.updateQueue=S),S.memoCache=g,S=g.data[g.index],S===void 0)for(S=g.data[g.index]=Array(p),R=0;R<p;R++)S[R]=U;return g.index++,S}function Sp(p,g){return typeof g=="function"?g(p):g}function zw(p){var g=ir();return RI(g,$i,p)}function RI(p,g,S){var R=p.queue;if(R===null)throw Error(i(311));R.lastRenderedReducer=S;var z=p.baseQueue,W=R.pending;if(W!==null){if(z!==null){var re=z.next;z.next=W.next,W.next=re}g.baseQueue=z=W,R.pending=null}if(W=p.baseState,z===null)p.memoizedState=W;else{g=z.next;var we=re=null,He=null,xt=g,Ft=!1;do{var Wt=xt.lane&-536870913;if(Wt!==xt.lane?(ii&Wt)===Wt:(bp&Wt)===Wt){var Et=xt.revertLane;if(Et===0)He!==null&&(He=He.next={lane:0,revertLane:0,gesture:null,action:xt.action,hasEagerState:xt.hasEagerState,eagerState:xt.eagerState,next:null}),Wt===zm&&(Ft=!0);else if((bp&Et)===Et){xt=xt.next,Et===zm&&(Ft=!0);continue}else Wt={lane:0,revertLane:xt.revertLane,gesture:null,action:xt.action,hasEagerState:xt.hasEagerState,eagerState:xt.eagerState,next:null},He===null?(we=He=Wt,re=W):He=He.next=Wt,La.lanes|=Et,Wm|=Et;Wt=xt.action,Z0&&S(W,Wt),W=xt.hasEagerState?xt.eagerState:S(W,Wt)}else Et={lane:Wt,revertLane:xt.revertLane,gesture:xt.gesture,action:xt.action,hasEagerState:xt.hasEagerState,eagerState:xt.eagerState,next:null},He===null?(we=He=Et,re=W):He=He.next=Et,La.lanes|=Wt,Wm|=Wt;xt=xt.next}while(xt!==null&&xt!==g);if(He===null?re=W:He.next=we,!Al(W,p.memoizedState)&&(pr=!0,Ft&&(S=gs,S!==null)))throw S;p.memoizedState=W,p.baseState=re,p.baseQueue=He,R.lastRenderedState=W}return z===null&&(R.lanes=0),[p.memoizedState,R.dispatch]}function PI(p){var g=ir(),S=g.queue;if(S===null)throw Error(i(311));S.lastRenderedReducer=p;var R=S.dispatch,z=S.pending,W=g.memoizedState;if(z!==null){S.pending=null;var re=z=z.next;do W=p(W,re.action),re=re.next;while(re!==z);Al(W,g.memoizedState)||(pr=!0),g.memoizedState=W,g.baseQueue===null&&(g.baseState=W),S.lastRenderedState=W}return[W,R]}function nU(p,g,S){var R=La,z=ir(),W=Qa;if(W){if(S===void 0)throw Error(i(407));S=S()}else S=g();var re=!Al(($i||z).memoizedState,S);if(re&&(z.memoizedState=S,pr=!0),z=z.queue,DI(sU.bind(null,R,z,p),[p]),z.getSnapshot!==g||re||fr!==null&&fr.memoizedState.tag&1){if(R.flags|=2048,z1(9,{destroy:void 0},iU.bind(null,R,z,S,g),null),is===null)throw Error(i(349));W||(bp&127)!==0||aU(R,g,S)}return S}function aU(p,g,S){p.flags|=16384,p={getSnapshot:g,value:S},g=La.updateQueue,g===null?(g=Uw(),La.updateQueue=g,g.stores=[p]):(S=g.stores,S===null?g.stores=[p]:S.push(p))}function iU(p,g,S,R){g.value=S,g.getSnapshot=R,rU(g)&&oU(p)}function sU(p,g,S){return S(function(){rU(g)&&oU(p)})}function rU(p){var g=p.getSnapshot;p=p.value;try{var S=g();return!Al(p,S)}catch{return!0}}function oU(p){var g=hp(p,2);g!==null&&tc(g,p,2)}function II(p){var g=_l();if(typeof p=="function"){var S=p;if(p=S(),Z0){Tt(!0);try{S()}finally{Tt(!1)}}}return g.memoizedState=g.baseState=p,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sp,lastRenderedState:p},g}function lU(p,g,S,R){return p.baseState=S,RI(p,$i,typeof R=="function"?R:Sp)}function Yle(p,g,S,R,z){if(Hw(p))throw Error(i(485));if(p=g.action,p!==null){var W={payload:z,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(re){W.listeners.push(re)}};Q.T!==null?S(!0):W.isTransition=!1,R(W),S=g.pending,S===null?(W.next=g.pending=W,cU(g,W)):(W.next=S.next,g.pending=S.next=W)}}function cU(p,g){var S=g.action,R=g.payload,z=p.state;if(g.isTransition){var W=Q.T,re={};Q.T=re;try{var we=S(z,R),He=Q.S;He!==null&&He(re,we),uU(p,g,we)}catch(xt){LI(p,g,xt)}finally{W!==null&&re.types!==null&&(W.types=re.types),Q.T=W}}else try{W=S(z,R),uU(p,g,W)}catch(xt){LI(p,g,xt)}}function uU(p,g,S){S!==null&&typeof S=="object"&&typeof S.then=="function"?S.then(function(R){dU(p,g,R)},function(R){return LI(p,g,R)}):dU(p,g,S)}function dU(p,g,S){g.status="fulfilled",g.value=S,hU(g),p.state=S,g=p.pending,g!==null&&(S=g.next,S===g?p.pending=null:(S=S.next,g.next=S,cU(p,S)))}function LI(p,g,S){var R=p.pending;if(p.pending=null,R!==null){R=R.next;do g.status="rejected",g.reason=S,hU(g),g=g.next;while(g!==R)}p.action=null}function hU(p){p=p.listeners;for(var g=0;g<p.length;g++)(0,p[g])()}function fU(p,g){return g}function pU(p,g){if(Qa){var S=is.formState;if(S!==null){e:{var R=La;if(Qa){if(ns){t:{for(var z=ns,W=Xl;z.nodeType!==8;){if(!W){z=null;break t}if(z=Pu(z.nextSibling),z===null){z=null;break t}}W=z.data,z=W==="F!"||W==="F"?z:null}if(z){ns=Pu(z.nextSibling),R=z.data==="F!";break e}}gh(R)}R=!1}R&&(g=S[0])}}return S=_l(),S.memoizedState=S.baseState=g,R={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fU,lastRenderedState:g},S.queue=R,S=LU.bind(null,La,R),R.dispatch=S,R=II(!1),W=BI.bind(null,La,!1,R.queue),R=_l(),z={state:g,dispatch:null,action:p,pending:null},R.queue=z,S=Yle.bind(null,La,z,W,S),z.dispatch=S,R.memoizedState=p,[g,S,!1]}function mU(p){var g=ir();return gU(g,$i,p)}function gU(p,g,S){if(g=RI(p,g,fU)[0],p=zw(Sp)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var R=pb(g)}catch(re){throw re===gd?Vc:re}else R=g;g=ir();var z=g.queue,W=z.dispatch;return S!==g.memoizedState&&(La.flags|=2048,z1(9,{destroy:void 0},Xle.bind(null,z,S),null)),[R,W,p]}function Xle(p,g){p.action=g}function AU(p){var g=ir(),S=$i;if(S!==null)return gU(g,S,p);ir(),g=g.memoizedState,S=ir();var R=S.queue.dispatch;return S.memoizedState=p,[g,R,!1]}function z1(p,g,S,R){return p={tag:p,create:S,deps:R,inst:g,next:null},g=La.updateQueue,g===null&&(g=Uw(),La.updateQueue=g),S=g.lastEffect,S===null?g.lastEffect=p.next=p:(R=S.next,S.next=p,p.next=R,g.lastEffect=p),p}function yU(){return ir().memoizedState}function Gw(p,g,S,R){var z=_l();La.flags|=p,z.memoizedState=z1(1|g,{destroy:void 0},S,R===void 0?null:R)}function qw(p,g,S,R){var z=ir();R=R===void 0?null:R;var W=z.memoizedState.inst;$i!==null&&R!==null&&TI(R,$i.memoizedState.deps)?z.memoizedState=z1(g,W,S,R):(La.flags|=p,z.memoizedState=z1(1|g,W,S,R))}function vU(p,g){Gw(8390656,8,p,g)}function DI(p,g){qw(2048,8,p,g)}function Qle(p){La.flags|=4;var g=La.updateQueue;if(g===null)g=Uw(),La.updateQueue=g,g.events=[p];else{var S=g.events;S===null?g.events=[p]:S.push(p)}}function _U(p){var g=ir().memoizedState;return Qle({ref:g,nextImpl:p}),function(){if((Ni&2)!==0)throw Error(i(440));return g.impl.apply(void 0,arguments)}}function xU(p,g){return qw(4,2,p,g)}function bU(p,g){return qw(4,4,p,g)}function SU(p,g){if(typeof g=="function"){p=p();var S=g(p);return function(){typeof S=="function"?S():g(null)}}if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function TU(p,g,S){S=S!=null?S.concat([p]):null,qw(4,4,SU.bind(null,g,p),S)}function kI(){}function wU(p,g){var S=ir();g=g===void 0?null:g;var R=S.memoizedState;return g!==null&&TI(g,R[1])?R[0]:(S.memoizedState=[p,g],p)}function EU(p,g){var S=ir();g=g===void 0?null:g;var R=S.memoizedState;if(g!==null&&TI(g,R[1]))return R[0];if(R=p(),Z0){Tt(!0);try{p()}finally{Tt(!1)}}return S.memoizedState=[R,g],R}function OI(p,g,S){return S===void 0||(bp&1073741824)!==0&&(ii&261930)===0?p.memoizedState=g:(p.memoizedState=S,p=M9(),La.lanes|=p,Wm|=p,S)}function MU(p,g,S,R){return Al(S,g)?S:ea.current!==null?(p=OI(p,S,R),Al(p,g)||(pr=!0),p):(bp&42)===0||(bp&1073741824)!==0&&(ii&261930)===0?(pr=!0,p.memoizedState=S):(p=M9(),La.lanes|=p,Wm|=p,g)}function CU(p,g,S,R,z){var W=Y.p;Y.p=W!==0&&8>W?W:8;var re=Q.T,we={};Q.T=we,BI(p,!1,g,S);try{var He=z(),xt=Q.S;if(xt!==null&&xt(we,He),He!==null&&typeof He=="object"&&typeof He.then=="function"){var Ft=Ow(He,R);mb(p,g,Ft,Hc(p))}else mb(p,g,R,Hc(p))}catch(Wt){mb(p,g,{then:function(){},status:"rejected",reason:Wt},Hc())}finally{Y.p=W,re!==null&&we.types!==null&&(re.types=we.types),Q.T=re}}function Jle(){}function FI(p,g,S,R){if(p.tag!==5)throw Error(i(476));var z=NU(p).queue;CU(p,z,g,ue,S===null?Jle:function(){return RU(p),S(R)})}function NU(p){var g=p.memoizedState;if(g!==null)return g;g={memoizedState:ue,baseState:ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sp,lastRenderedState:ue},next:null};var S={};return g.next={memoizedState:S,baseState:S,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sp,lastRenderedState:S},next:null},p.memoizedState=g,p=p.alternate,p!==null&&(p.memoizedState=g),g}function RU(p){var g=NU(p);g.next===null&&(g=p.alternate.memoizedState),mb(p,g.next.queue,{},Hc())}function jI(){return Dr(Ib)}function PU(){return ir().memoizedState}function IU(){return ir().memoizedState}function Zle(p){for(var g=p.return;g!==null;){switch(g.tag){case 24:case 3:var S=Hc();p=nt(S);var R=At(g,p,S);R!==null&&(tc(R,g,S),ut(R,g,S)),g={cache:$s()},p.payload=g;return}g=g.return}}function ece(p,g,S){var R=Hc();S={lane:R,revertLane:0,gesture:null,action:S,hasEagerState:!1,eagerState:null,next:null},Hw(p)?DU(g,S):(S=rb(p,g,S,R),S!==null&&(tc(S,p,R),kU(S,g,R)))}function LU(p,g,S){var R=Hc();mb(p,g,S,R)}function mb(p,g,S,R){var z={lane:R,revertLane:0,gesture:null,action:S,hasEagerState:!1,eagerState:null,next:null};if(Hw(p))DU(g,z);else{var W=p.alternate;if(p.lanes===0&&(W===null||W.lanes===0)&&(W=g.lastRenderedReducer,W!==null))try{var re=g.lastRenderedState,we=W(re,S);if(z.hasEagerState=!0,z.eagerState=we,Al(we,re))return R1(p,g,z,0),is===null&&N1(),!1}catch{}if(S=rb(p,g,z,R),S!==null)return tc(S,p,R),kU(S,g,R),!0}return!1}function BI(p,g,S,R){if(R={lane:2,revertLane:AL(),gesture:null,action:R,hasEagerState:!1,eagerState:null,next:null},Hw(p)){if(g)throw Error(i(479))}else g=rb(p,S,R,2),g!==null&&tc(g,p,2)}function Hw(p){var g=p.alternate;return p===La||g!==null&&g===La}function DU(p,g){U1=jw=!0;var S=p.pending;S===null?g.next=g:(g.next=S.next,S.next=g),p.pending=g}function kU(p,g,S){if((S&4194048)!==0){var R=g.lanes;R&=p.pendingLanes,S|=R,g.lanes=S,Bt(p,S)}}var gb={readContext:Dr,use:Vw,useCallback:Ks,useContext:Ks,useEffect:Ks,useImperativeHandle:Ks,useLayoutEffect:Ks,useInsertionEffect:Ks,useMemo:Ks,useReducer:Ks,useRef:Ks,useState:Ks,useDebugValue:Ks,useDeferredValue:Ks,useTransition:Ks,useSyncExternalStore:Ks,useId:Ks,useHostTransitionStatus:Ks,useFormState:Ks,useActionState:Ks,useOptimistic:Ks,useMemoCache:Ks,useCacheRefresh:Ks};gb.useEffectEvent=Ks;var OU={readContext:Dr,use:Vw,useCallback:function(p,g){return _l().memoizedState=[p,g===void 0?null:g],p},useContext:Dr,useEffect:vU,useImperativeHandle:function(p,g,S){S=S!=null?S.concat([p]):null,Gw(4194308,4,SU.bind(null,g,p),S)},useLayoutEffect:function(p,g){return Gw(4194308,4,p,g)},useInsertionEffect:function(p,g){Gw(4,2,p,g)},useMemo:function(p,g){var S=_l();g=g===void 0?null:g;var R=p();if(Z0){Tt(!0);try{p()}finally{Tt(!1)}}return S.memoizedState=[R,g],R},useReducer:function(p,g,S){var R=_l();if(S!==void 0){var z=S(g);if(Z0){Tt(!0);try{S(g)}finally{Tt(!1)}}}else z=g;return R.memoizedState=R.baseState=z,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:z},R.queue=p,p=p.dispatch=ece.bind(null,La,p),[R.memoizedState,p]},useRef:function(p){var g=_l();return p={current:p},g.memoizedState=p},useState:function(p){p=II(p);var g=p.queue,S=LU.bind(null,La,g);return g.dispatch=S,[p.memoizedState,S]},useDebugValue:kI,useDeferredValue:function(p,g){var S=_l();return OI(S,p,g)},useTransition:function(){var p=II(!1);return p=CU.bind(null,La,p.queue,!0,!1),_l().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,g,S){var R=La,z=_l();if(Qa){if(S===void 0)throw Error(i(407));S=S()}else{if(S=g(),is===null)throw Error(i(349));(ii&127)!==0||aU(R,g,S)}z.memoizedState=S;var W={value:S,getSnapshot:g};return z.queue=W,vU(sU.bind(null,R,W,p),[p]),R.flags|=2048,z1(9,{destroy:void 0},iU.bind(null,R,W,S,g),null),S},useId:function(){var p=_l(),g=is.identifierPrefix;if(Qa){var S=Yl,R=Kl;S=(R&~(1<<32-kt(R)-1)).toString(32)+S,g="_"+g+"R_"+S,S=Bw++,0<S&&(g+="H"+S.toString(32)),g+="_"}else S=$le++,g="_"+g+"r_"+S.toString(32)+"_";return p.memoizedState=g},useHostTransitionStatus:jI,useFormState:pU,useActionState:pU,useOptimistic:function(p){var g=_l();g.memoizedState=g.baseState=p;var S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=S,g=BI.bind(null,La,!0,S),S.dispatch=g,[p,g]},useMemoCache:NI,useCacheRefresh:function(){return _l().memoizedState=Zle.bind(null,La)},useEffectEvent:function(p){var g=_l(),S={impl:p};return g.memoizedState=S,function(){if((Ni&2)!==0)throw Error(i(440));return S.impl.apply(void 0,arguments)}}},UI={readContext:Dr,use:Vw,useCallback:wU,useContext:Dr,useEffect:DI,useImperativeHandle:TU,useInsertionEffect:xU,useLayoutEffect:bU,useMemo:EU,useReducer:zw,useRef:yU,useState:function(){return zw(Sp)},useDebugValue:kI,useDeferredValue:function(p,g){var S=ir();return MU(S,$i.memoizedState,p,g)},useTransition:function(){var p=zw(Sp)[0],g=ir().memoizedState;return[typeof p=="boolean"?p:pb(p),g]},useSyncExternalStore:nU,useId:PU,useHostTransitionStatus:jI,useFormState:mU,useActionState:mU,useOptimistic:function(p,g){var S=ir();return lU(S,$i,p,g)},useMemoCache:NI,useCacheRefresh:IU};UI.useEffectEvent=_U;var FU={readContext:Dr,use:Vw,useCallback:wU,useContext:Dr,useEffect:DI,useImperativeHandle:TU,useInsertionEffect:xU,useLayoutEffect:bU,useMemo:EU,useReducer:PI,useRef:yU,useState:function(){return PI(Sp)},useDebugValue:kI,useDeferredValue:function(p,g){var S=ir();return $i===null?OI(S,p,g):MU(S,$i.memoizedState,p,g)},useTransition:function(){var p=PI(Sp)[0],g=ir().memoizedState;return[typeof p=="boolean"?p:pb(p),g]},useSyncExternalStore:nU,useId:PU,useHostTransitionStatus:jI,useFormState:AU,useActionState:AU,useOptimistic:function(p,g){var S=ir();return $i!==null?lU(S,$i,p,g):(S.baseState=p,[p,S.queue.dispatch])},useMemoCache:NI,useCacheRefresh:IU};FU.useEffectEvent=_U;function VI(p,g,S,R){g=p.memoizedState,S=S(R,g),S=S==null?g:f({},g,S),p.memoizedState=S,p.lanes===0&&(p.updateQueue.baseState=S)}var zI={enqueueSetState:function(p,g,S){p=p._reactInternals;var R=Hc(),z=nt(R);z.payload=g,S!=null&&(z.callback=S),g=At(p,z,R),g!==null&&(tc(g,p,R),ut(g,p,R))},enqueueReplaceState:function(p,g,S){p=p._reactInternals;var R=Hc(),z=nt(R);z.tag=1,z.payload=g,S!=null&&(z.callback=S),g=At(p,z,R),g!==null&&(tc(g,p,R),ut(g,p,R))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var S=Hc(),R=nt(S);R.tag=2,g!=null&&(R.callback=g),g=At(p,R,S),g!==null&&(tc(g,p,S),ut(g,p,S))}};function jU(p,g,S,R,z,W,re){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(R,W,re):g.prototype&&g.prototype.isPureReactComponent?!Qr(S,R)||!Qr(z,W):!0}function BU(p,g,S,R){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(S,R),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(S,R),g.state!==p&&zI.enqueueReplaceState(g,g.state,null)}function eA(p,g){var S=g;if("ref"in g){S={};for(var R in g)R!=="ref"&&(S[R]=g[R])}if(p=p.defaultProps){S===g&&(S=f({},S));for(var z in p)S[z]===void 0&&(S[z]=p[z])}return S}function UU(p){dp(p)}function VU(p){console.error(p)}function zU(p){dp(p)}function Ww(p,g){try{var S=p.onUncaughtError;S(g.value,{componentStack:g.stack})}catch(R){setTimeout(function(){throw R})}}function GU(p,g,S){try{var R=p.onCaughtError;R(S.value,{componentStack:S.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(z){setTimeout(function(){throw z})}}function GI(p,g,S){return S=nt(S),S.tag=3,S.payload={element:null},S.callback=function(){Ww(p,g)},S}function qU(p){return p=nt(p),p.tag=3,p}function HU(p,g,S,R){var z=S.type.getDerivedStateFromError;if(typeof z=="function"){var W=R.value;p.payload=function(){return z(W)},p.callback=function(){GU(g,S,R)}}var re=S.stateNode;re!==null&&typeof re.componentDidCatch=="function"&&(p.callback=function(){GU(g,S,R),typeof z!="function"&&($m===null?$m=new Set([this]):$m.add(this));var we=R.stack;this.componentDidCatch(R.value,{componentStack:we!==null?we:""})})}function tce(p,g,S,R,z){if(S.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){if(g=S.alternate,g!==null&&yp(g,S,z,!0),S=Gn.current,S!==null){switch(S.tag){case 31:case 13:return Ia===null?iE():S.alternate===null&&Ys===0&&(Ys=3),S.flags&=-257,S.flags|=65536,S.lanes=z,R===J0?S.flags|=16384:(g=S.updateQueue,g===null?S.updateQueue=new Set([R]):g.add(R),pL(p,R,z)),!1;case 22:return S.flags|=65536,R===J0?S.flags|=16384:(g=S.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([R])},S.updateQueue=g):(S=g.retryQueue,S===null?g.retryQueue=new Set([R]):S.add(R)),pL(p,R,z)),!1}throw Error(i(435,S.tag))}return pL(p,R,z),iE(),!1}if(Qa)return g=Gn.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=z,R!==cb&&(p=Error(i(422),{cause:R}),hd(Wl(p,S)))):(R!==cb&&(g=Error(i(423),{cause:R}),hd(Wl(g,S))),p=p.current.alternate,p.flags|=65536,z&=-z,p.lanes|=z,R=Wl(R,S),z=GI(p.stateNode,R,z),lt(p,z),Ys!==4&&(Ys=2)),!1;var W=Error(i(520),{cause:R});if(W=Wl(W,S),Tb===null?Tb=[W]:Tb.push(W),Ys!==4&&(Ys=2),g===null)return!0;R=Wl(R,S),S=g;do{switch(S.tag){case 3:return S.flags|=65536,p=z&-z,S.lanes|=p,p=GI(S.stateNode,R,p),lt(S,p),!1;case 1:if(g=S.type,W=S.stateNode,(S.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||W!==null&&typeof W.componentDidCatch=="function"&&($m===null||!$m.has(W))))return S.flags|=65536,z&=-z,S.lanes|=z,z=qU(z),HU(z,p,S,R),lt(S,z),!1}S=S.return}while(S!==null);return!1}var qI=Error(i(461)),pr=!1;function vo(p,g,S,R){g.child=p===null?ke(g,null,S,R):xe(g,p.child,S,R)}function WU(p,g,S,R,z){S=S.render;var W=g.ref;if("ref"in R){var re={};for(var we in R)we!=="ref"&&(re[we]=R[we])}else re=R;return vp(g),R=wI(p,g,S,re,W,z),we=EI(),p!==null&&!pr?(MI(p,g,z),Tp(p,g,z)):(Qa&&we&&k1(g),g.flags|=1,vo(p,g,R,z),g.child)}function $U(p,g,S,R,z){if(p===null){var W=S.type;return typeof W=="function"&&!Uc(W)&&W.defaultProps===void 0&&S.compare===null?(g.tag=15,g.type=W,KU(p,g,W,R,z)):(p=I1(S.type,null,R,g,g.mode,z),p.ref=g.ref,p.return=g,g.child=p)}if(W=p.child,!JI(p,z)){var re=W.memoizedProps;if(S=S.compare,S=S!==null?S:Qr,S(re,R)&&p.ref===g.ref)return Tp(p,g,z)}return g.flags|=1,p=wu(W,R),p.ref=g.ref,p.return=g,g.child=p}function KU(p,g,S,R,z){if(p!==null){var W=p.memoizedProps;if(Qr(W,R)&&p.ref===g.ref)if(pr=!1,g.pendingProps=R=W,JI(p,z))(p.flags&131072)!==0&&(pr=!0);else return g.lanes=p.lanes,Tp(p,g,z)}return HI(p,g,S,R,z)}function YU(p,g,S,R){var z=R.children,W=p!==null?p.memoizedState:null;if(p===null&&g.stateNode===null&&(g.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),R.mode==="hidden"){if((g.flags&128)!==0){if(W=W!==null?W.baseLanes|S:S,p!==null){for(R=g.child=p.child,z=0;R!==null;)z=z|R.lanes|R.childLanes,R=R.sibling;R=z&~W}else R=0,g.child=null;return XU(p,g,W,S,R)}if((S&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},p!==null&&X0(g,W!==null?W.cachePool:null),W!==null?Qn(g,W):Cn(),Zr(g);else return R=g.lanes=536870912,XU(p,g,W!==null?W.baseLanes|S:S,S,R)}else W!==null?(X0(g,W.cachePool),Qn(g,W),yd(),g.memoizedState=null):(p!==null&&X0(g,null),Cn(),yd());return vo(p,g,z,S),g.child}function Ab(p,g){return p!==null&&p.tag===22||g.stateNode!==null||(g.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.sibling}function XU(p,g,S,R,z){var W=Y0();return W=W===null?null:{parent:fn._currentValue,pool:W},g.memoizedState={baseLanes:S,cachePool:W},p!==null&&X0(g,null),Cn(),Zr(g),p!==null&&yp(p,g,R,!0),g.childLanes=z,null}function $w(p,g){return g=Yw({mode:g.mode,children:g.children},p.mode),g.ref=p.ref,p.child=g,g.return=p,g}function QU(p,g,S){return xe(g,p.child,null,S),p=$w(g,g.pendingProps),p.flags|=2,zc(g),g.memoizedState=null,p}function nce(p,g,S){var R=g.pendingProps,z=(g.flags&128)!==0;if(g.flags&=-129,p===null){if(Qa){if(R.mode==="hidden")return p=$w(g,R),g.lanes=536870912,Ab(null,p);if(vi(g),(p=ns)?(p=cV(p,Xl),p=p!==null&&p.data==="&"?p:null,p!==null&&(g.memoizedState={dehydrated:p,treeContext:$l!==null?{id:Kl,overflow:Yl}:null,retryLane:536870912,hydrationErrors:null},S=Dw(p),S.return=g,g.child=S,Lr=g,ns=null)):p=null,p===null)throw gh(g);return g.lanes=536870912,null}return $w(g,R)}var W=p.memoizedState;if(W!==null){var re=W.dehydrated;if(vi(g),z)if(g.flags&256)g.flags&=-257,g=QU(p,g,S);else if(g.memoizedState!==null)g.child=p.child,g.flags|=128,g=null;else throw Error(i(558));else if(pr||yp(p,g,S,!1),z=(S&p.childLanes)!==0,pr||z){if(R=is,R!==null&&(re=ln(R,S),re!==0&&re!==W.retryLane))throw W.retryLane=re,hp(p,re),tc(R,p,re),qI;iE(),g=QU(p,g,S)}else p=W.treeContext,ns=Pu(re.nextSibling),Lr=g,Qa=!0,mh=null,Xl=!1,p!==null&&kw(g,p),g=$w(g,R),g.flags|=4096;return g}return p=wu(p.child,{mode:R.mode,children:R.children}),p.ref=g.ref,g.child=p,p.return=g,p}function Kw(p,g){var S=g.ref;if(S===null)p!==null&&p.ref!==null&&(g.flags|=4194816);else{if(typeof S!="function"&&typeof S!="object")throw Error(i(284));(p===null||p.ref!==S)&&(g.flags|=4194816)}}function HI(p,g,S,R,z){return vp(g),S=wI(p,g,S,R,void 0,z),R=EI(),p!==null&&!pr?(MI(p,g,z),Tp(p,g,z)):(Qa&&R&&k1(g),g.flags|=1,vo(p,g,S,z),g.child)}function JU(p,g,S,R,z,W){return vp(g),g.updateQueue=null,S=tU(g,R,S,z),eU(p),R=EI(),p!==null&&!pr?(MI(p,g,W),Tp(p,g,W)):(Qa&&R&&k1(g),g.flags|=1,vo(p,g,S,W),g.child)}function ZU(p,g,S,R,z){if(vp(g),g.stateNode===null){var W=fp,re=S.contextType;typeof re=="object"&&re!==null&&(W=Dr(re)),W=new S(R,W),g.memoizedState=W.state!==null&&W.state!==void 0?W.state:null,W.updater=zI,g.stateNode=W,W._reactInternals=g,W=g.stateNode,W.props=R,W.state=g.memoizedState,W.refs={},Oe(g),re=S.contextType,W.context=typeof re=="object"&&re!==null?Dr(re):fp,W.state=g.memoizedState,re=S.getDerivedStateFromProps,typeof re=="function"&&(VI(g,S,re,R),W.state=g.memoizedState),typeof S.getDerivedStateFromProps=="function"||typeof W.getSnapshotBeforeUpdate=="function"||typeof W.UNSAFE_componentWillMount!="function"&&typeof W.componentWillMount!="function"||(re=W.state,typeof W.componentWillMount=="function"&&W.componentWillMount(),typeof W.UNSAFE_componentWillMount=="function"&&W.UNSAFE_componentWillMount(),re!==W.state&&zI.enqueueReplaceState(W,W.state,null),wn(g,R,W,z),en(),W.state=g.memoizedState),typeof W.componentDidMount=="function"&&(g.flags|=4194308),R=!0}else if(p===null){W=g.stateNode;var we=g.memoizedProps,He=eA(S,we);W.props=He;var xt=W.context,Ft=S.contextType;re=fp,typeof Ft=="object"&&Ft!==null&&(re=Dr(Ft));var Wt=S.getDerivedStateFromProps;Ft=typeof Wt=="function"||typeof W.getSnapshotBeforeUpdate=="function",we=g.pendingProps!==we,Ft||typeof W.UNSAFE_componentWillReceiveProps!="function"&&typeof W.componentWillReceiveProps!="function"||(we||xt!==re)&&BU(g,W,R,re),De=!1;var Et=g.memoizedState;W.state=Et,wn(g,R,W,z),en(),xt=g.memoizedState,we||Et!==xt||De?(typeof Wt=="function"&&(VI(g,S,Wt,R),xt=g.memoizedState),(He=De||jU(g,S,He,R,Et,xt,re))?(Ft||typeof W.UNSAFE_componentWillMount!="function"&&typeof W.componentWillMount!="function"||(typeof W.componentWillMount=="function"&&W.componentWillMount(),typeof W.UNSAFE_componentWillMount=="function"&&W.UNSAFE_componentWillMount()),typeof W.componentDidMount=="function"&&(g.flags|=4194308)):(typeof W.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=R,g.memoizedState=xt),W.props=R,W.state=xt,W.context=re,R=He):(typeof W.componentDidMount=="function"&&(g.flags|=4194308),R=!1)}else{W=g.stateNode,$e(p,g),re=g.memoizedProps,Ft=eA(S,re),W.props=Ft,Wt=g.pendingProps,Et=W.context,xt=S.contextType,He=fp,typeof xt=="object"&&xt!==null&&(He=Dr(xt)),we=S.getDerivedStateFromProps,(xt=typeof we=="function"||typeof W.getSnapshotBeforeUpdate=="function")||typeof W.UNSAFE_componentWillReceiveProps!="function"&&typeof W.componentWillReceiveProps!="function"||(re!==Wt||Et!==He)&&BU(g,W,R,He),De=!1,Et=g.memoizedState,W.state=Et,wn(g,R,W,z),en();var It=g.memoizedState;re!==Wt||Et!==It||De||p!==null&&p.dependencies!==null&&j1(p.dependencies)?(typeof we=="function"&&(VI(g,S,we,R),It=g.memoizedState),(Ft=De||jU(g,S,Ft,R,Et,It,He)||p!==null&&p.dependencies!==null&&j1(p.dependencies))?(xt||typeof W.UNSAFE_componentWillUpdate!="function"&&typeof W.componentWillUpdate!="function"||(typeof W.componentWillUpdate=="function"&&W.componentWillUpdate(R,It,He),typeof W.UNSAFE_componentWillUpdate=="function"&&W.UNSAFE_componentWillUpdate(R,It,He)),typeof W.componentDidUpdate=="function"&&(g.flags|=4),typeof W.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof W.componentDidUpdate!="function"||re===p.memoizedProps&&Et===p.memoizedState||(g.flags|=4),typeof W.getSnapshotBeforeUpdate!="function"||re===p.memoizedProps&&Et===p.memoizedState||(g.flags|=1024),g.memoizedProps=R,g.memoizedState=It),W.props=R,W.state=It,W.context=He,R=Ft):(typeof W.componentDidUpdate!="function"||re===p.memoizedProps&&Et===p.memoizedState||(g.flags|=4),typeof W.getSnapshotBeforeUpdate!="function"||re===p.memoizedProps&&Et===p.memoizedState||(g.flags|=1024),R=!1)}return W=R,Kw(p,g),R=(g.flags&128)!==0,W||R?(W=g.stateNode,S=R&&typeof S.getDerivedStateFromError!="function"?null:W.render(),g.flags|=1,p!==null&&R?(g.child=xe(g,p.child,null,z),g.child=xe(g,null,S,z)):vo(p,g,S,z),g.memoizedState=W.state,p=g.child):p=Tp(p,g,z),p}function e9(p,g,S,R){return gp(),g.flags|=256,vo(p,g,S,R),g.child}var WI={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $I(p){return{baseLanes:p,cachePool:Q0()}}function KI(p,g,S){return p=p!==null?p.childLanes&~S:0,g&&(p|=qc),p}function t9(p,g,S){var R=g.pendingProps,z=!1,W=(g.flags&128)!==0,re;if((re=W)||(re=p!==null&&p.memoizedState===null?!1:(ar.current&2)!==0),re&&(z=!0,g.flags&=-129),re=(g.flags&32)!==0,g.flags&=-33,p===null){if(Qa){if(z?Jn(g):yd(),(p=ns)?(p=cV(p,Xl),p=p!==null&&p.data!=="&"?p:null,p!==null&&(g.memoizedState={dehydrated:p,treeContext:$l!==null?{id:Kl,overflow:Yl}:null,retryLane:536870912,hydrationErrors:null},S=Dw(p),S.return=g,g.child=S,Lr=g,ns=null)):p=null,p===null)throw gh(g);return RL(p)?g.lanes=32:g.lanes=536870912,null}var we=R.children;return R=R.fallback,z?(yd(),z=g.mode,we=Yw({mode:"hidden",children:we},z),R=pp(R,z,S,null),we.return=g,R.return=g,we.sibling=R,g.child=we,R=g.child,R.memoizedState=$I(S),R.childLanes=KI(p,re,S),g.memoizedState=WI,Ab(null,R)):(Jn(g),YI(g,we))}var He=p.memoizedState;if(He!==null&&(we=He.dehydrated,we!==null)){if(W)g.flags&256?(Jn(g),g.flags&=-257,g=XI(p,g,S)):g.memoizedState!==null?(yd(),g.child=p.child,g.flags|=128,g=null):(yd(),we=R.fallback,z=g.mode,R=Yw({mode:"visible",children:R.children},z),we=pp(we,z,S,null),we.flags|=2,R.return=g,we.return=g,R.sibling=we,g.child=R,xe(g,p.child,null,S),R=g.child,R.memoizedState=$I(S),R.childLanes=KI(p,re,S),g.memoizedState=WI,g=Ab(null,R));else if(Jn(g),RL(we)){if(re=we.nextSibling&&we.nextSibling.dataset,re)var xt=re.dgst;re=xt,R=Error(i(419)),R.stack="",R.digest=re,hd({value:R,source:null,stack:null}),g=XI(p,g,S)}else if(pr||yp(p,g,S,!1),re=(S&p.childLanes)!==0,pr||re){if(re=is,re!==null&&(R=ln(re,S),R!==0&&R!==He.retryLane))throw He.retryLane=R,hp(p,R),tc(re,p,R),qI;NL(we)||iE(),g=XI(p,g,S)}else NL(we)?(g.flags|=192,g.child=p.child,g=null):(p=He.treeContext,ns=Pu(we.nextSibling),Lr=g,Qa=!0,mh=null,Xl=!1,p!==null&&kw(g,p),g=YI(g,R.children),g.flags|=4096);return g}return z?(yd(),we=R.fallback,z=g.mode,He=p.child,xt=He.sibling,R=wu(He,{mode:"hidden",children:R.children}),R.subtreeFlags=He.subtreeFlags&65011712,xt!==null?we=wu(xt,we):(we=pp(we,z,S,null),we.flags|=2),we.return=g,R.return=g,R.sibling=we,g.child=R,Ab(null,R),R=g.child,we=p.child.memoizedState,we===null?we=$I(S):(z=we.cachePool,z!==null?(He=fn._currentValue,z=z.parent!==He?{parent:He,pool:He}:z):z=Q0(),we={baseLanes:we.baseLanes|S,cachePool:z}),R.memoizedState=we,R.childLanes=KI(p,re,S),g.memoizedState=WI,Ab(p.child,R)):(Jn(g),S=p.child,p=S.sibling,S=wu(S,{mode:"visible",children:R.children}),S.return=g,S.sibling=null,p!==null&&(re=g.deletions,re===null?(g.deletions=[p],g.flags|=16):re.push(p)),g.child=S,g.memoizedState=null,S)}function YI(p,g){return g=Yw({mode:"visible",children:g},p.mode),g.return=p,p.child=g}function Yw(p,g){return p=Wo(22,p,null,g),p.lanes=0,p}function XI(p,g,S){return xe(g,p.child,null,S),p=YI(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function n9(p,g,S){p.lanes|=g;var R=p.alternate;R!==null&&(R.lanes|=g),O1(p.return,g,S)}function QI(p,g,S,R,z,W){var re=p.memoizedState;re===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:R,tail:S,tailMode:z,treeForkCount:W}:(re.isBackwards=g,re.rendering=null,re.renderingStartTime=0,re.last=R,re.tail=S,re.tailMode=z,re.treeForkCount=W)}function a9(p,g,S){var R=g.pendingProps,z=R.revealOrder,W=R.tail;R=R.children;var re=ar.current,we=(re&2)!==0;if(we?(re=re&1|2,g.flags|=128):re&=1,be(ar,re),vo(p,g,R,S),R=Qa?$0:0,!we&&p!==null&&(p.flags&128)!==0)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&n9(p,S,g);else if(p.tag===19)n9(p,S,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}switch(z){case"forwards":for(S=g.child,z=null;S!==null;)p=S.alternate,p!==null&&Fw(p)===null&&(z=S),S=S.sibling;S=z,S===null?(z=g.child,g.child=null):(z=S.sibling,S.sibling=null),QI(g,!1,z,S,W,R);break;case"backwards":case"unstable_legacy-backwards":for(S=null,z=g.child,g.child=null;z!==null;){if(p=z.alternate,p!==null&&Fw(p)===null){g.child=z;break}p=z.sibling,z.sibling=S,S=z,z=p}QI(g,!0,S,null,W,R);break;case"together":QI(g,!1,null,null,void 0,R);break;default:g.memoizedState=null}return g.child}function Tp(p,g,S){if(p!==null&&(g.dependencies=p.dependencies),Wm|=g.lanes,(S&g.childLanes)===0)if(p!==null){if(yp(p,g,S,!1),(S&g.childLanes)===0)return null}else return null;if(p!==null&&g.child!==p.child)throw Error(i(153));if(g.child!==null){for(p=g.child,S=wu(p,p.pendingProps),g.child=S,S.return=g;p.sibling!==null;)p=p.sibling,S=S.sibling=wu(p,p.pendingProps),S.return=g;S.sibling=null}return g.child}function JI(p,g){return(p.lanes&g)!==0?!0:(p=p.dependencies,!!(p!==null&&j1(p)))}function ace(p,g,S){switch(g.tag){case 3:Le(g,g.stateNode.containerInfo),pd(g,fn,p.memoizedState.cache),gp();break;case 27:case 5:Ie(g);break;case 4:Le(g,g.stateNode.containerInfo);break;case 10:pd(g,g.type,g.memoizedProps.value);break;case 31:if(g.memoizedState!==null)return g.flags|=128,vi(g),null;break;case 13:var R=g.memoizedState;if(R!==null)return R.dehydrated!==null?(Jn(g),g.flags|=128,null):(S&g.child.childLanes)!==0?t9(p,g,S):(Jn(g),p=Tp(p,g,S),p!==null?p.sibling:null);Jn(g);break;case 19:var z=(p.flags&128)!==0;if(R=(S&g.childLanes)!==0,R||(yp(p,g,S,!1),R=(S&g.childLanes)!==0),z){if(R)return a9(p,g,S);g.flags|=128}if(z=g.memoizedState,z!==null&&(z.rendering=null,z.tail=null,z.lastEffect=null),be(ar,ar.current),R)break;return null;case 22:return g.lanes=0,YU(p,g,S,g.pendingProps);case 24:pd(g,fn,p.memoizedState.cache)}return Tp(p,g,S)}function i9(p,g,S){if(p!==null)if(p.memoizedProps!==g.pendingProps)pr=!0;else{if(!JI(p,S)&&(g.flags&128)===0)return pr=!1,ace(p,g,S);pr=(p.flags&131072)!==0}else pr=!1,Qa&&(g.flags&1048576)!==0&&K0(g,$0,g.index);switch(g.lanes=0,g.tag){case 16:e:{var R=g.pendingProps;if(p=y(g.elementType),g.type=p,typeof p=="function")Uc(p)?(R=eA(p,R),g.tag=1,g=ZU(null,g,p,R,S)):(g.tag=0,g=HI(null,g,p,R,S));else{if(p!=null){var z=p.$$typeof;if(z===F){g.tag=11,g=WU(null,g,p,R,S);break e}else if(z===D){g.tag=14,g=$U(null,g,p,R,S);break e}}throw g=X(p)||p,Error(i(306,g,""))}}return g;case 0:return HI(p,g,g.type,g.pendingProps,S);case 1:return R=g.type,z=eA(R,g.pendingProps),ZU(p,g,R,z,S);case 3:e:{if(Le(g,g.stateNode.containerInfo),p===null)throw Error(i(387));R=g.pendingProps;var W=g.memoizedState;z=W.element,$e(p,g),wn(g,R,null,S);var re=g.memoizedState;if(R=re.cache,pd(g,fn,R),R!==W.cache&&F1(g,[fn],S,!0),en(),R=re.element,W.isDehydrated)if(W={element:R,isDehydrated:!1,cache:re.cache},g.updateQueue.baseState=W,g.memoizedState=W,g.flags&256){g=e9(p,g,R,S);break e}else if(R!==z){z=Wl(Error(i(424)),g),hd(z),g=e9(p,g,R,S);break e}else for(p=g.stateNode.containerInfo,p.nodeType===9?p=p.body:p=p.nodeName==="HTML"?p.ownerDocument.body:p,ns=Pu(p.firstChild),Lr=g,Qa=!0,mh=null,Xl=!0,S=ke(g,null,R,S),g.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if(gp(),R===z){g=Tp(p,g,S);break e}vo(p,g,R,S)}g=g.child}return g;case 26:return Kw(p,g),p===null?(S=mV(g.type,null,g.pendingProps,null))?g.memoizedState=S:Qa||(S=g.type,p=g.pendingProps,R=dE(te.current).createElement(S),R[Pa]=g,R[Ln]=p,_o(R,S,p),Se(R),g.stateNode=R):g.memoizedState=mV(g.type,p.memoizedProps,g.pendingProps,p.memoizedState),null;case 27:return Ie(g),p===null&&Qa&&(R=g.stateNode=hV(g.type,g.pendingProps,te.current),Lr=g,Xl=!0,z=ns,Qm(g.type)?(PL=z,ns=Pu(R.firstChild)):ns=z),vo(p,g,g.pendingProps.children,S),Kw(p,g),p===null&&(g.flags|=4194304),g.child;case 5:return p===null&&Qa&&((z=R=ns)&&(R=Lce(R,g.type,g.pendingProps,Xl),R!==null?(g.stateNode=R,Lr=g,ns=Pu(R.firstChild),Xl=!1,z=!0):z=!1),z||gh(g)),Ie(g),z=g.type,W=g.pendingProps,re=p!==null?p.memoizedProps:null,R=W.children,EL(z,W)?R=null:re!==null&&EL(z,re)&&(g.flags|=32),g.memoizedState!==null&&(z=wI(p,g,Kle,null,null,S),Ib._currentValue=z),Kw(p,g),vo(p,g,R,S),g.child;case 6:return p===null&&Qa&&((p=S=ns)&&(S=Dce(S,g.pendingProps,Xl),S!==null?(g.stateNode=S,Lr=g,ns=null,p=!0):p=!1),p||gh(g)),null;case 13:return t9(p,g,S);case 4:return Le(g,g.stateNode.containerInfo),R=g.pendingProps,p===null?g.child=xe(g,null,R,S):vo(p,g,R,S),g.child;case 11:return WU(p,g,g.type,g.pendingProps,S);case 7:return vo(p,g,g.pendingProps,S),g.child;case 8:return vo(p,g,g.pendingProps.children,S),g.child;case 12:return vo(p,g,g.pendingProps.children,S),g.child;case 10:return R=g.pendingProps,pd(g,g.type,R.value),vo(p,g,R.children,S),g.child;case 9:return z=g.type._context,R=g.pendingProps.children,vp(g),z=Dr(z),R=R(z),g.flags|=1,vo(p,g,R,S),g.child;case 14:return $U(p,g,g.type,g.pendingProps,S);case 15:return KU(p,g,g.type,g.pendingProps,S);case 19:return a9(p,g,S);case 31:return nce(p,g,S);case 22:return YU(p,g,S,g.pendingProps);case 24:return vp(g),R=Dr(fn),p===null?(z=Y0(),z===null&&(z=is,W=$s(),z.pooledCache=W,W.refCount++,W!==null&&(z.pooledCacheLanes|=S),z=W),g.memoizedState={parent:R,cache:z},Oe(g),pd(g,fn,z)):((p.lanes&S)!==0&&($e(p,g),wn(g,null,null,S),en()),z=p.memoizedState,W=g.memoizedState,z.parent!==R?(z={parent:R,cache:R},g.memoizedState=z,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=z),pd(g,fn,R)):(R=W.cache,pd(g,fn,R),R!==z.cache&&F1(g,[fn],S,!0))),vo(p,g,g.pendingProps.children,S),g.child;case 29:throw g.pendingProps}throw Error(i(156,g.tag))}function wp(p){p.flags|=4}function ZI(p,g,S,R,z){if((g=(p.mode&32)!==0)&&(g=!1),g){if(p.flags|=16777216,(z&335544128)===z)if(p.stateNode.complete)p.flags|=8192;else if(P9())p.flags|=8192;else throw b=J0,Ah}else p.flags&=-16777217}function s9(p,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)p.flags&=-16777217;else if(p.flags|=16777216,!_V(g))if(P9())p.flags|=8192;else throw b=J0,Ah}function Xw(p,g){g!==null&&(p.flags|=4),p.flags&16384&&(g=p.tag!==22?ai():536870912,p.lanes|=g,W1|=g)}function yb(p,g){if(!Qa)switch(p.tailMode){case"hidden":g=p.tail;for(var S=null;g!==null;)g.alternate!==null&&(S=g),g=g.sibling;S===null?p.tail=null:S.sibling=null;break;case"collapsed":S=p.tail;for(var R=null;S!==null;)S.alternate!==null&&(R=S),S=S.sibling;R===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:R.sibling=null}}function As(p){var g=p.alternate!==null&&p.alternate.child===p.child,S=0,R=0;if(g)for(var z=p.child;z!==null;)S|=z.lanes|z.childLanes,R|=z.subtreeFlags&65011712,R|=z.flags&65011712,z.return=p,z=z.sibling;else for(z=p.child;z!==null;)S|=z.lanes|z.childLanes,R|=z.subtreeFlags,R|=z.flags,z.return=p,z=z.sibling;return p.subtreeFlags|=R,p.childLanes=S,g}function ice(p,g,S){var R=g.pendingProps;switch(lb(g),g.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return As(g),null;case 1:return As(g),null;case 3:return S=g.stateNode,R=null,p!==null&&(R=p.memoizedState.cache),g.memoizedState.cache!==R&&(g.flags|=2048),Cu(fn),Fe(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(p===null||p.child===null)&&(as(g)?wp(g):p===null||p.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,hb())),As(g),null;case 26:var z=g.type,W=g.memoizedState;return p===null?(wp(g),W!==null?(As(g),s9(g,W)):(As(g),ZI(g,z,null,R,S))):W?W!==p.memoizedState?(wp(g),As(g),s9(g,W)):(As(g),g.flags&=-16777217):(p=p.memoizedProps,p!==R&&wp(g),As(g),ZI(g,z,p,R,S)),null;case 27:if(at(g),S=te.current,z=g.type,p!==null&&g.stateNode!=null)p.memoizedProps!==R&&wp(g);else{if(!R){if(g.stateNode===null)throw Error(i(166));return As(g),null}p=Ce.current,as(g)?ub(g):(p=hV(z,R,S),g.stateNode=p,wp(g))}return As(g),null;case 5:if(at(g),z=g.type,p!==null&&g.stateNode!=null)p.memoizedProps!==R&&wp(g);else{if(!R){if(g.stateNode===null)throw Error(i(166));return As(g),null}if(W=Ce.current,as(g))ub(g);else{var re=dE(te.current);switch(W){case 1:W=re.createElementNS("http://www.w3.org/2000/svg",z);break;case 2:W=re.createElementNS("http://www.w3.org/1998/Math/MathML",z);break;default:switch(z){case"svg":W=re.createElementNS("http://www.w3.org/2000/svg",z);break;case"math":W=re.createElementNS("http://www.w3.org/1998/Math/MathML",z);break;case"script":W=re.createElement("div"),W.innerHTML="<script><\/script>",W=W.removeChild(W.firstChild);break;case"select":W=typeof R.is=="string"?re.createElement("select",{is:R.is}):re.createElement("select"),R.multiple?W.multiple=!0:R.size&&(W.size=R.size);break;default:W=typeof R.is=="string"?re.createElement(z,{is:R.is}):re.createElement(z)}}W[Pa]=g,W[Ln]=R;e:for(re=g.child;re!==null;){if(re.tag===5||re.tag===6)W.appendChild(re.stateNode);else if(re.tag!==4&&re.tag!==27&&re.child!==null){re.child.return=re,re=re.child;continue}if(re===g)break e;for(;re.sibling===null;){if(re.return===null||re.return===g)break e;re=re.return}re.sibling.return=re.return,re=re.sibling}g.stateNode=W;e:switch(_o(W,z,R),z){case"button":case"input":case"select":case"textarea":R=!!R.autoFocus;break e;case"img":R=!0;break e;default:R=!1}R&&wp(g)}}return As(g),ZI(g,g.type,p===null?null:p.memoizedProps,g.pendingProps,S),null;case 6:if(p&&g.stateNode!=null)p.memoizedProps!==R&&wp(g);else{if(typeof R!="string"&&g.stateNode===null)throw Error(i(166));if(p=te.current,as(g)){if(p=g.stateNode,S=g.memoizedProps,R=null,z=Lr,z!==null)switch(z.tag){case 27:case 5:R=z.memoizedProps}p[Pa]=g,p=!!(p.nodeValue===S||R!==null&&R.suppressHydrationWarning===!0||tV(p.nodeValue,S)),p||gh(g,!0)}else p=dE(p).createTextNode(R),p[Pa]=g,g.stateNode=p}return As(g),null;case 31:if(S=g.memoizedState,p===null||p.memoizedState!==null){if(R=as(g),S!==null){if(p===null){if(!R)throw Error(i(318));if(p=g.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(557));p[Pa]=g}else gp(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;As(g),p=!1}else S=hb(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=S),p=!0;if(!p)return g.flags&256?(zc(g),g):(zc(g),null);if((g.flags&128)!==0)throw Error(i(558))}return As(g),null;case 13:if(R=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(z=as(g),R!==null&&R.dehydrated!==null){if(p===null){if(!z)throw Error(i(318));if(z=g.memoizedState,z=z!==null?z.dehydrated:null,!z)throw Error(i(317));z[Pa]=g}else gp(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;As(g),z=!1}else z=hb(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=z),z=!0;if(!z)return g.flags&256?(zc(g),g):(zc(g),null)}return zc(g),(g.flags&128)!==0?(g.lanes=S,g):(S=R!==null,p=p!==null&&p.memoizedState!==null,S&&(R=g.child,z=null,R.alternate!==null&&R.alternate.memoizedState!==null&&R.alternate.memoizedState.cachePool!==null&&(z=R.alternate.memoizedState.cachePool.pool),W=null,R.memoizedState!==null&&R.memoizedState.cachePool!==null&&(W=R.memoizedState.cachePool.pool),W!==z&&(R.flags|=2048)),S!==p&&S&&(g.child.flags|=8192),Xw(g,g.updateQueue),As(g),null);case 4:return Fe(),p===null&&xL(g.stateNode.containerInfo),As(g),null;case 10:return Cu(g.type),As(g),null;case 19:if(Ae(ar),R=g.memoizedState,R===null)return As(g),null;if(z=(g.flags&128)!==0,W=R.rendering,W===null)if(z)yb(R,!1);else{if(Ys!==0||p!==null&&(p.flags&128)!==0)for(p=g.child;p!==null;){if(W=Fw(p),W!==null){for(g.flags|=128,yb(R,!1),p=W.updateQueue,g.updateQueue=p,Xw(g,p),g.subtreeFlags=0,p=S,S=g.child;S!==null;)Lw(S,p),S=S.sibling;return be(ar,ar.current&1|2),Qa&&Mu(g,R.treeForkCount),g.child}p=p.sibling}R.tail!==null&&le()>tE&&(g.flags|=128,z=!0,yb(R,!1),g.lanes=4194304)}else{if(!z)if(p=Fw(W),p!==null){if(g.flags|=128,z=!0,p=p.updateQueue,g.updateQueue=p,Xw(g,p),yb(R,!0),R.tail===null&&R.tailMode==="hidden"&&!W.alternate&&!Qa)return As(g),null}else 2*le()-R.renderingStartTime>tE&&S!==536870912&&(g.flags|=128,z=!0,yb(R,!1),g.lanes=4194304);R.isBackwards?(W.sibling=g.child,g.child=W):(p=R.last,p!==null?p.sibling=W:g.child=W,R.last=W)}return R.tail!==null?(p=R.tail,R.rendering=p,R.tail=p.sibling,R.renderingStartTime=le(),p.sibling=null,S=ar.current,be(ar,z?S&1|2:S&1),Qa&&Mu(g,R.treeForkCount),p):(As(g),null);case 22:case 23:return zc(g),tn(),R=g.memoizedState!==null,p!==null?p.memoizedState!==null!==R&&(g.flags|=8192):R&&(g.flags|=8192),R?(S&536870912)!==0&&(g.flags&128)===0&&(As(g),g.subtreeFlags&6&&(g.flags|=8192)):As(g),S=g.updateQueue,S!==null&&Xw(g,S.retryQueue),S=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),R=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(R=g.memoizedState.cachePool.pool),R!==S&&(g.flags|=2048),p!==null&&Ae(Jt),null;case 24:return S=null,p!==null&&(S=p.memoizedState.cache),g.memoizedState.cache!==S&&(g.flags|=2048),Cu(fn),As(g),null;case 25:return null;case 30:return null}throw Error(i(156,g.tag))}function sce(p,g){switch(lb(g),g.tag){case 1:return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return Cu(fn),Fe(),p=g.flags,(p&65536)!==0&&(p&128)===0?(g.flags=p&-65537|128,g):null;case 26:case 27:case 5:return at(g),null;case 31:if(g.memoizedState!==null){if(zc(g),g.alternate===null)throw Error(i(340));gp()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 13:if(zc(g),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(i(340));gp()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return Ae(ar),null;case 4:return Fe(),null;case 10:return Cu(g.type),null;case 22:case 23:return zc(g),tn(),p!==null&&Ae(Jt),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 24:return Cu(fn),null;case 25:return null;default:return null}}function r9(p,g){switch(lb(g),g.tag){case 3:Cu(fn),Fe();break;case 26:case 27:case 5:at(g);break;case 4:Fe();break;case 31:g.memoizedState!==null&&zc(g);break;case 13:zc(g);break;case 19:Ae(ar);break;case 10:Cu(g.type);break;case 22:case 23:zc(g),tn(),p!==null&&Ae(Jt);break;case 24:Cu(fn)}}function vb(p,g){try{var S=g.updateQueue,R=S!==null?S.lastEffect:null;if(R!==null){var z=R.next;S=z;do{if((S.tag&p)===p){R=void 0;var W=S.create,re=S.inst;R=W(),re.destroy=R}S=S.next}while(S!==z)}}catch(we){Gi(g,g.return,we)}}function qm(p,g,S){try{var R=g.updateQueue,z=R!==null?R.lastEffect:null;if(z!==null){var W=z.next;R=W;do{if((R.tag&p)===p){var re=R.inst,we=re.destroy;if(we!==void 0){re.destroy=void 0,z=g;var He=S,xt=we;try{xt()}catch(Ft){Gi(z,He,Ft)}}}R=R.next}while(R!==W)}}catch(Ft){Gi(g,g.return,Ft)}}function o9(p){var g=p.updateQueue;if(g!==null){var S=p.stateNode;try{ua(g,S)}catch(R){Gi(p,p.return,R)}}}function l9(p,g,S){S.props=eA(p.type,p.memoizedProps),S.state=p.memoizedState;try{S.componentWillUnmount()}catch(R){Gi(p,g,R)}}function _b(p,g){try{var S=p.ref;if(S!==null){switch(p.tag){case 26:case 27:case 5:var R=p.stateNode;break;case 30:R=p.stateNode;break;default:R=p.stateNode}typeof S=="function"?p.refCleanup=S(R):S.current=R}}catch(z){Gi(p,g,z)}}function yh(p,g){var S=p.ref,R=p.refCleanup;if(S!==null)if(typeof R=="function")try{R()}catch(z){Gi(p,g,z)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof S=="function")try{S(null)}catch(z){Gi(p,g,z)}else S.current=null}function c9(p){var g=p.type,S=p.memoizedProps,R=p.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":S.autoFocus&&R.focus();break e;case"img":S.src?R.src=S.src:S.srcSet&&(R.srcset=S.srcSet)}}catch(z){Gi(p,p.return,z)}}function eL(p,g,S){try{var R=p.stateNode;Mce(R,p.type,S,g),R[Ln]=g}catch(z){Gi(p,p.return,z)}}function u9(p){return p.tag===5||p.tag===3||p.tag===26||p.tag===27&&Qm(p.type)||p.tag===4}function tL(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||u9(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.tag===27&&Qm(p.type)||p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function nL(p,g,S){var R=p.tag;if(R===5||R===6)p=p.stateNode,g?(S.nodeType===9?S.body:S.nodeName==="HTML"?S.ownerDocument.body:S).insertBefore(p,g):(g=S.nodeType===9?S.body:S.nodeName==="HTML"?S.ownerDocument.body:S,g.appendChild(p),S=S._reactRootContainer,S!=null||g.onclick!==null||(g.onclick=Vl));else if(R!==4&&(R===27&&Qm(p.type)&&(S=p.stateNode,g=null),p=p.child,p!==null))for(nL(p,g,S),p=p.sibling;p!==null;)nL(p,g,S),p=p.sibling}function Qw(p,g,S){var R=p.tag;if(R===5||R===6)p=p.stateNode,g?S.insertBefore(p,g):S.appendChild(p);else if(R!==4&&(R===27&&Qm(p.type)&&(S=p.stateNode),p=p.child,p!==null))for(Qw(p,g,S),p=p.sibling;p!==null;)Qw(p,g,S),p=p.sibling}function d9(p){var g=p.stateNode,S=p.memoizedProps;try{for(var R=p.type,z=g.attributes;z.length;)g.removeAttributeNode(z[0]);_o(g,R,S),g[Pa]=p,g[Ln]=S}catch(W){Gi(p,p.return,W)}}var Ep=!1,mr=!1,aL=!1,h9=typeof WeakSet=="function"?WeakSet:Set,eo=null;function rce(p,g){if(p=p.containerInfo,TL=yE,p=hh(p),fh(p)){if("selectionStart"in p)var S={start:p.selectionStart,end:p.selectionEnd};else e:{S=(S=p.ownerDocument)&&S.defaultView||window;var R=S.getSelection&&S.getSelection();if(R&&R.rangeCount!==0){S=R.anchorNode;var z=R.anchorOffset,W=R.focusNode;R=R.focusOffset;try{S.nodeType,W.nodeType}catch{S=null;break e}var re=0,we=-1,He=-1,xt=0,Ft=0,Wt=p,Et=null;t:for(;;){for(var It;Wt!==S||z!==0&&Wt.nodeType!==3||(we=re+z),Wt!==W||R!==0&&Wt.nodeType!==3||(He=re+R),Wt.nodeType===3&&(re+=Wt.nodeValue.length),(It=Wt.firstChild)!==null;)Et=Wt,Wt=It;for(;;){if(Wt===p)break t;if(Et===S&&++xt===z&&(we=re),Et===W&&++Ft===R&&(He=re),(It=Wt.nextSibling)!==null)break;Wt=Et,Et=Wt.parentNode}Wt=It}S=we===-1||He===-1?null:{start:we,end:He}}else S=null}S=S||{start:0,end:0}}else S=null;for(wL={focusedElem:p,selectionRange:S},yE=!1,eo=g;eo!==null;)if(g=eo,p=g.child,(g.subtreeFlags&1028)!==0&&p!==null)p.return=g,eo=p;else for(;eo!==null;){switch(g=eo,W=g.alternate,p=g.flags,g.tag){case 0:if((p&4)!==0&&(p=g.updateQueue,p=p!==null?p.events:null,p!==null))for(S=0;S<p.length;S++)z=p[S],z.ref.impl=z.nextImpl;break;case 11:case 15:break;case 1:if((p&1024)!==0&&W!==null){p=void 0,S=g,z=W.memoizedProps,W=W.memoizedState,R=S.stateNode;try{var In=eA(S.type,z);p=R.getSnapshotBeforeUpdate(In,W),R.__reactInternalSnapshotBeforeUpdate=p}catch(ra){Gi(S,S.return,ra)}}break;case 3:if((p&1024)!==0){if(p=g.stateNode.containerInfo,S=p.nodeType,S===9)CL(p);else if(S===1)switch(p.nodeName){case"HEAD":case"HTML":case"BODY":CL(p);break;default:p.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((p&1024)!==0)throw Error(i(163))}if(p=g.sibling,p!==null){p.return=g.return,eo=p;break}eo=g.return}}function f9(p,g,S){var R=S.flags;switch(S.tag){case 0:case 11:case 15:Cp(p,S),R&4&&vb(5,S);break;case 1:if(Cp(p,S),R&4)if(p=S.stateNode,g===null)try{p.componentDidMount()}catch(re){Gi(S,S.return,re)}else{var z=eA(S.type,g.memoizedProps);g=g.memoizedState;try{p.componentDidUpdate(z,g,p.__reactInternalSnapshotBeforeUpdate)}catch(re){Gi(S,S.return,re)}}R&64&&o9(S),R&512&&_b(S,S.return);break;case 3:if(Cp(p,S),R&64&&(p=S.updateQueue,p!==null)){if(g=null,S.child!==null)switch(S.child.tag){case 27:case 5:g=S.child.stateNode;break;case 1:g=S.child.stateNode}try{ua(p,g)}catch(re){Gi(S,S.return,re)}}break;case 27:g===null&&R&4&&d9(S);case 26:case 5:Cp(p,S),g===null&&R&4&&c9(S),R&512&&_b(S,S.return);break;case 12:Cp(p,S);break;case 31:Cp(p,S),R&4&&g9(p,S);break;case 13:Cp(p,S),R&4&&A9(p,S),R&64&&(p=S.memoizedState,p!==null&&(p=p.dehydrated,p!==null&&(S=mce.bind(null,S),kce(p,S))));break;case 22:if(R=S.memoizedState!==null||Ep,!R){g=g!==null&&g.memoizedState!==null||mr,z=Ep;var W=mr;Ep=R,(mr=g)&&!W?Np(p,S,(S.subtreeFlags&8772)!==0):Cp(p,S),Ep=z,mr=W}break;case 30:break;default:Cp(p,S)}}function p9(p){var g=p.alternate;g!==null&&(p.alternate=null,p9(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&ah(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}var Ss=null,Ql=!1;function Mp(p,g,S){for(S=S.child;S!==null;)m9(p,g,S),S=S.sibling}function m9(p,g,S){if(ct&&typeof ct.onCommitFiberUnmount=="function")try{ct.onCommitFiberUnmount(Xe,S)}catch{}switch(S.tag){case 26:mr||yh(S,g),Mp(p,g,S),S.memoizedState?S.memoizedState.count--:S.stateNode&&(S=S.stateNode,S.parentNode.removeChild(S));break;case 27:mr||yh(S,g);var R=Ss,z=Ql;Qm(S.type)&&(Ss=S.stateNode,Ql=!1),Mp(p,g,S),Nb(S.stateNode),Ss=R,Ql=z;break;case 5:mr||yh(S,g);case 6:if(R=Ss,z=Ql,Ss=null,Mp(p,g,S),Ss=R,Ql=z,Ss!==null)if(Ql)try{(Ss.nodeType===9?Ss.body:Ss.nodeName==="HTML"?Ss.ownerDocument.body:Ss).removeChild(S.stateNode)}catch(W){Gi(S,g,W)}else try{Ss.removeChild(S.stateNode)}catch(W){Gi(S,g,W)}break;case 18:Ss!==null&&(Ql?(p=Ss,oV(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,S.stateNode),ev(p)):oV(Ss,S.stateNode));break;case 4:R=Ss,z=Ql,Ss=S.stateNode.containerInfo,Ql=!0,Mp(p,g,S),Ss=R,Ql=z;break;case 0:case 11:case 14:case 15:qm(2,S,g),mr||qm(4,S,g),Mp(p,g,S);break;case 1:mr||(yh(S,g),R=S.stateNode,typeof R.componentWillUnmount=="function"&&l9(S,g,R)),Mp(p,g,S);break;case 21:Mp(p,g,S);break;case 22:mr=(R=mr)||S.memoizedState!==null,Mp(p,g,S),mr=R;break;default:Mp(p,g,S)}}function g9(p,g){if(g.memoizedState===null&&(p=g.alternate,p!==null&&(p=p.memoizedState,p!==null))){p=p.dehydrated;try{ev(p)}catch(S){Gi(g,g.return,S)}}}function A9(p,g){if(g.memoizedState===null&&(p=g.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{ev(p)}catch(S){Gi(g,g.return,S)}}function oce(p){switch(p.tag){case 31:case 13:case 19:var g=p.stateNode;return g===null&&(g=p.stateNode=new h9),g;case 22:return p=p.stateNode,g=p._retryCache,g===null&&(g=p._retryCache=new h9),g;default:throw Error(i(435,p.tag))}}function Jw(p,g){var S=oce(p);g.forEach(function(R){if(!S.has(R)){S.add(R);var z=gce.bind(null,p,R);R.then(z,z)}})}function Jl(p,g){var S=g.deletions;if(S!==null)for(var R=0;R<S.length;R++){var z=S[R],W=p,re=g,we=re;e:for(;we!==null;){switch(we.tag){case 27:if(Qm(we.type)){Ss=we.stateNode,Ql=!1;break e}break;case 5:Ss=we.stateNode,Ql=!1;break e;case 3:case 4:Ss=we.stateNode.containerInfo,Ql=!0;break e}we=we.return}if(Ss===null)throw Error(i(160));m9(W,re,z),Ss=null,Ql=!1,W=z.alternate,W!==null&&(W.return=null),z.return=null}if(g.subtreeFlags&13886)for(g=g.child;g!==null;)y9(g,p),g=g.sibling}var vd=null;function y9(p,g){var S=p.alternate,R=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:Jl(g,p),Zl(p),R&4&&(qm(3,p,p.return),vb(3,p),qm(5,p,p.return));break;case 1:Jl(g,p),Zl(p),R&512&&(mr||S===null||yh(S,S.return)),R&64&&Ep&&(p=p.updateQueue,p!==null&&(R=p.callbacks,R!==null&&(S=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=S===null?R:S.concat(R))));break;case 26:var z=vd;if(Jl(g,p),Zl(p),R&512&&(mr||S===null||yh(S,S.return)),R&4){var W=S!==null?S.memoizedState:null;if(R=p.memoizedState,S===null)if(R===null)if(p.stateNode===null){e:{R=p.type,S=p.memoizedProps,z=z.ownerDocument||z;t:switch(R){case"title":W=z.getElementsByTagName("title")[0],(!W||W[yo]||W[Pa]||W.namespaceURI==="http://www.w3.org/2000/svg"||W.hasAttribute("itemprop"))&&(W=z.createElement(R),z.head.insertBefore(W,z.querySelector("head > title"))),_o(W,R,S),W[Pa]=p,Se(W),R=W;break e;case"link":var re=yV("link","href",z).get(R+(S.href||""));if(re){for(var we=0;we<re.length;we++)if(W=re[we],W.getAttribute("href")===(S.href==null||S.href===""?null:S.href)&&W.getAttribute("rel")===(S.rel==null?null:S.rel)&&W.getAttribute("title")===(S.title==null?null:S.title)&&W.getAttribute("crossorigin")===(S.crossOrigin==null?null:S.crossOrigin)){re.splice(we,1);break t}}W=z.createElement(R),_o(W,R,S),z.head.appendChild(W);break;case"meta":if(re=yV("meta","content",z).get(R+(S.content||""))){for(we=0;we<re.length;we++)if(W=re[we],W.getAttribute("content")===(S.content==null?null:""+S.content)&&W.getAttribute("name")===(S.name==null?null:S.name)&&W.getAttribute("property")===(S.property==null?null:S.property)&&W.getAttribute("http-equiv")===(S.httpEquiv==null?null:S.httpEquiv)&&W.getAttribute("charset")===(S.charSet==null?null:S.charSet)){re.splice(we,1);break t}}W=z.createElement(R),_o(W,R,S),z.head.appendChild(W);break;default:throw Error(i(468,R))}W[Pa]=p,Se(W),R=W}p.stateNode=R}else vV(z,p.type,p.stateNode);else p.stateNode=AV(z,R,p.memoizedProps);else W!==R?(W===null?S.stateNode!==null&&(S=S.stateNode,S.parentNode.removeChild(S)):W.count--,R===null?vV(z,p.type,p.stateNode):AV(z,R,p.memoizedProps)):R===null&&p.stateNode!==null&&eL(p,p.memoizedProps,S.memoizedProps)}break;case 27:Jl(g,p),Zl(p),R&512&&(mr||S===null||yh(S,S.return)),S!==null&&R&4&&eL(p,p.memoizedProps,S.memoizedProps);break;case 5:if(Jl(g,p),Zl(p),R&512&&(mr||S===null||yh(S,S.return)),p.flags&32){z=p.stateNode;try{Ci(z,"")}catch(In){Gi(p,p.return,In)}}R&4&&p.stateNode!=null&&(z=p.memoizedProps,eL(p,z,S!==null?S.memoizedProps:z)),R&1024&&(aL=!0);break;case 6:if(Jl(g,p),Zl(p),R&4){if(p.stateNode===null)throw Error(i(162));R=p.memoizedProps,S=p.stateNode;try{S.nodeValue=R}catch(In){Gi(p,p.return,In)}}break;case 3:if(pE=null,z=vd,vd=hE(g.containerInfo),Jl(g,p),vd=z,Zl(p),R&4&&S!==null&&S.memoizedState.isDehydrated)try{ev(g.containerInfo)}catch(In){Gi(p,p.return,In)}aL&&(aL=!1,v9(p));break;case 4:R=vd,vd=hE(p.stateNode.containerInfo),Jl(g,p),Zl(p),vd=R;break;case 12:Jl(g,p),Zl(p);break;case 31:Jl(g,p),Zl(p),R&4&&(R=p.updateQueue,R!==null&&(p.updateQueue=null,Jw(p,R)));break;case 13:Jl(g,p),Zl(p),p.child.flags&8192&&p.memoizedState!==null!=(S!==null&&S.memoizedState!==null)&&(eE=le()),R&4&&(R=p.updateQueue,R!==null&&(p.updateQueue=null,Jw(p,R)));break;case 22:z=p.memoizedState!==null;var He=S!==null&&S.memoizedState!==null,xt=Ep,Ft=mr;if(Ep=xt||z,mr=Ft||He,Jl(g,p),mr=Ft,Ep=xt,Zl(p),R&8192)e:for(g=p.stateNode,g._visibility=z?g._visibility&-2:g._visibility|1,z&&(S===null||He||Ep||mr||tA(p)),S=null,g=p;;){if(g.tag===5||g.tag===26){if(S===null){He=S=g;try{if(W=He.stateNode,z)re=W.style,typeof re.setProperty=="function"?re.setProperty("display","none","important"):re.display="none";else{we=He.stateNode;var Wt=He.memoizedProps.style,Et=Wt!=null&&Wt.hasOwnProperty("display")?Wt.display:null;we.style.display=Et==null||typeof Et=="boolean"?"":(""+Et).trim()}}catch(In){Gi(He,He.return,In)}}}else if(g.tag===6){if(S===null){He=g;try{He.stateNode.nodeValue=z?"":He.memoizedProps}catch(In){Gi(He,He.return,In)}}}else if(g.tag===18){if(S===null){He=g;try{var It=He.stateNode;z?lV(It,!0):lV(He.stateNode,!1)}catch(In){Gi(He,He.return,In)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;S===g&&(S=null),g=g.return}S===g&&(S=null),g.sibling.return=g.return,g=g.sibling}R&4&&(R=p.updateQueue,R!==null&&(S=R.retryQueue,S!==null&&(R.retryQueue=null,Jw(p,S))));break;case 19:Jl(g,p),Zl(p),R&4&&(R=p.updateQueue,R!==null&&(p.updateQueue=null,Jw(p,R)));break;case 30:break;case 21:break;default:Jl(g,p),Zl(p)}}function Zl(p){var g=p.flags;if(g&2){try{for(var S,R=p.return;R!==null;){if(u9(R)){S=R;break}R=R.return}if(S==null)throw Error(i(160));switch(S.tag){case 27:var z=S.stateNode,W=tL(p);Qw(p,W,z);break;case 5:var re=S.stateNode;S.flags&32&&(Ci(re,""),S.flags&=-33);var we=tL(p);Qw(p,we,re);break;case 3:case 4:var He=S.stateNode.containerInfo,xt=tL(p);nL(p,xt,He);break;default:throw Error(i(161))}}catch(Ft){Gi(p,p.return,Ft)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function v9(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var g=p;v9(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),p=p.sibling}}function Cp(p,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)f9(p,g.alternate,g),g=g.sibling}function tA(p){for(p=p.child;p!==null;){var g=p;switch(g.tag){case 0:case 11:case 14:case 15:qm(4,g,g.return),tA(g);break;case 1:yh(g,g.return);var S=g.stateNode;typeof S.componentWillUnmount=="function"&&l9(g,g.return,S),tA(g);break;case 27:Nb(g.stateNode);case 26:case 5:yh(g,g.return),tA(g);break;case 22:g.memoizedState===null&&tA(g);break;case 30:tA(g);break;default:tA(g)}p=p.sibling}}function Np(p,g,S){for(S=S&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var R=g.alternate,z=p,W=g,re=W.flags;switch(W.tag){case 0:case 11:case 15:Np(z,W,S),vb(4,W);break;case 1:if(Np(z,W,S),R=W,z=R.stateNode,typeof z.componentDidMount=="function")try{z.componentDidMount()}catch(xt){Gi(R,R.return,xt)}if(R=W,z=R.updateQueue,z!==null){var we=R.stateNode;try{var He=z.shared.hiddenCallbacks;if(He!==null)for(z.shared.hiddenCallbacks=null,z=0;z<He.length;z++)vn(He[z],we)}catch(xt){Gi(R,R.return,xt)}}S&&re&64&&o9(W),_b(W,W.return);break;case 27:d9(W);case 26:case 5:Np(z,W,S),S&&R===null&&re&4&&c9(W),_b(W,W.return);break;case 12:Np(z,W,S);break;case 31:Np(z,W,S),S&&re&4&&g9(z,W);break;case 13:Np(z,W,S),S&&re&4&&A9(z,W);break;case 22:W.memoizedState===null&&Np(z,W,S),_b(W,W.return);break;case 30:break;default:Np(z,W,S)}g=g.sibling}}function iL(p,g){var S=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),p=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(p=g.memoizedState.cachePool.pool),p!==S&&(p!=null&&p.refCount++,S!=null&&Vm(S))}function sL(p,g){p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&Vm(p))}function _d(p,g,S,R){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)_9(p,g,S,R),g=g.sibling}function _9(p,g,S,R){var z=g.flags;switch(g.tag){case 0:case 11:case 15:_d(p,g,S,R),z&2048&&vb(9,g);break;case 1:_d(p,g,S,R);break;case 3:_d(p,g,S,R),z&2048&&(p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&Vm(p)));break;case 12:if(z&2048){_d(p,g,S,R),p=g.stateNode;try{var W=g.memoizedProps,re=W.id,we=W.onPostCommit;typeof we=="function"&&we(re,g.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(He){Gi(g,g.return,He)}}else _d(p,g,S,R);break;case 31:_d(p,g,S,R);break;case 13:_d(p,g,S,R);break;case 23:break;case 22:W=g.stateNode,re=g.alternate,g.memoizedState!==null?W._visibility&2?_d(p,g,S,R):xb(p,g):W._visibility&2?_d(p,g,S,R):(W._visibility|=2,G1(p,g,S,R,(g.subtreeFlags&10256)!==0||!1)),z&2048&&iL(re,g);break;case 24:_d(p,g,S,R),z&2048&&sL(g.alternate,g);break;default:_d(p,g,S,R)}}function G1(p,g,S,R,z){for(z=z&&((g.subtreeFlags&10256)!==0||!1),g=g.child;g!==null;){var W=p,re=g,we=S,He=R,xt=re.flags;switch(re.tag){case 0:case 11:case 15:G1(W,re,we,He,z),vb(8,re);break;case 23:break;case 22:var Ft=re.stateNode;re.memoizedState!==null?Ft._visibility&2?G1(W,re,we,He,z):xb(W,re):(Ft._visibility|=2,G1(W,re,we,He,z)),z&&xt&2048&&iL(re.alternate,re);break;case 24:G1(W,re,we,He,z),z&&xt&2048&&sL(re.alternate,re);break;default:G1(W,re,we,He,z)}g=g.sibling}}function xb(p,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var S=p,R=g,z=R.flags;switch(R.tag){case 22:xb(S,R),z&2048&&iL(R.alternate,R);break;case 24:xb(S,R),z&2048&&sL(R.alternate,R);break;default:xb(S,R)}g=g.sibling}}var bb=8192;function q1(p,g,S){if(p.subtreeFlags&bb)for(p=p.child;p!==null;)x9(p,g,S),p=p.sibling}function x9(p,g,S){switch(p.tag){case 26:q1(p,g,S),p.flags&bb&&p.memoizedState!==null&&$ce(S,vd,p.memoizedState,p.memoizedProps);break;case 5:q1(p,g,S);break;case 3:case 4:var R=vd;vd=hE(p.stateNode.containerInfo),q1(p,g,S),vd=R;break;case 22:p.memoizedState===null&&(R=p.alternate,R!==null&&R.memoizedState!==null?(R=bb,bb=16777216,q1(p,g,S),bb=R):q1(p,g,S));break;default:q1(p,g,S)}}function b9(p){var g=p.alternate;if(g!==null&&(p=g.child,p!==null)){g.child=null;do g=p.sibling,p.sibling=null,p=g;while(p!==null)}}function Sb(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var S=0;S<g.length;S++){var R=g[S];eo=R,T9(R,p)}b9(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)S9(p),p=p.sibling}function S9(p){switch(p.tag){case 0:case 11:case 15:Sb(p),p.flags&2048&&qm(9,p,p.return);break;case 3:Sb(p);break;case 12:Sb(p);break;case 22:var g=p.stateNode;p.memoizedState!==null&&g._visibility&2&&(p.return===null||p.return.tag!==13)?(g._visibility&=-3,Zw(p)):Sb(p);break;default:Sb(p)}}function Zw(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var S=0;S<g.length;S++){var R=g[S];eo=R,T9(R,p)}b9(p)}for(p=p.child;p!==null;){switch(g=p,g.tag){case 0:case 11:case 15:qm(8,g,g.return),Zw(g);break;case 22:S=g.stateNode,S._visibility&2&&(S._visibility&=-3,Zw(g));break;default:Zw(g)}p=p.sibling}}function T9(p,g){for(;eo!==null;){var S=eo;switch(S.tag){case 0:case 11:case 15:qm(8,S,g);break;case 23:case 22:if(S.memoizedState!==null&&S.memoizedState.cachePool!==null){var R=S.memoizedState.cachePool.pool;R!=null&&R.refCount++}break;case 24:Vm(S.memoizedState.cache)}if(R=S.child,R!==null)R.return=S,eo=R;else e:for(S=p;eo!==null;){R=eo;var z=R.sibling,W=R.return;if(p9(R),R===S){eo=null;break e}if(z!==null){z.return=W,eo=z;break e}eo=W}}}var lce={getCacheForType:function(p){var g=Dr(fn),S=g.data.get(p);return S===void 0&&(S=p(),g.data.set(p,S)),S},cacheSignal:function(){return Dr(fn).controller.signal}},cce=typeof WeakMap=="function"?WeakMap:Map,Ni=0,is=null,Ja=null,ii=0,zi=0,Gc=null,Hm=!1,H1=!1,rL=!1,Rp=0,Ys=0,Wm=0,nA=0,oL=0,qc=0,W1=0,Tb=null,ec=null,lL=!1,eE=0,w9=0,tE=1/0,nE=null,$m=null,kr=0,Km=null,$1=null,Pp=0,cL=0,uL=null,E9=null,wb=0,dL=null;function Hc(){return(Ni&2)!==0&&ii!==0?ii&-ii:Q.T!==null?AL():me()}function M9(){if(qc===0)if((ii&536870912)===0||Qa){var p=Ht;Ht<<=1,(Ht&3932160)===0&&(Ht=262144),qc=p}else qc=536870912;return p=Gn.current,p!==null&&(p.flags|=32),qc}function tc(p,g,S){(p===is&&(zi===2||zi===9)||p.cancelPendingCommit!==null)&&(K1(p,0),Ym(p,ii,qc,!1)),Gs(p,S),((Ni&2)===0||p!==is)&&(p===is&&((Ni&2)===0&&(nA|=S),Ys===4&&Ym(p,ii,qc,!1)),vh(p))}function C9(p,g,S){if((Ni&6)!==0)throw Error(i(327));var R=!S&&(g&127)===0&&(g&p.expiredLanes)===0||an(p,g),z=R?hce(p,g):fL(p,g,!0),W=R;do{if(z===0){H1&&!R&&Ym(p,g,0,!1);break}else{if(S=p.current.alternate,W&&!uce(S)){z=fL(p,g,!1),W=!1;continue}if(z===2){if(W=g,p.errorRecoveryDisabledLanes&W)var re=0;else re=p.pendingLanes&-536870913,re=re!==0?re:re&536870912?536870912:0;if(re!==0){g=re;e:{var we=p;z=Tb;var He=we.current.memoizedState.isDehydrated;if(He&&(K1(we,re).flags|=256),re=fL(we,re,!1),re!==2){if(rL&&!He){we.errorRecoveryDisabledLanes|=W,nA|=W,z=4;break e}W=ec,ec=z,W!==null&&(ec===null?ec=W:ec.push.apply(ec,W))}z=re}if(W=!1,z!==2)continue}}if(z===1){K1(p,0),Ym(p,g,0,!0);break}e:{switch(R=p,W=z,W){case 0:case 1:throw Error(i(345));case 4:if((g&4194048)!==g)break;case 6:Ym(R,g,qc,!Hm);break e;case 2:ec=null;break;case 3:case 5:break;default:throw Error(i(329))}if((g&62914560)===g&&(z=eE+300-le(),10<z)){if(Ym(R,g,qc,!Hm),Ot(R,0,!0)!==0)break e;Pp=g,R.timeoutHandle=sV(N9.bind(null,R,S,ec,nE,lL,g,qc,nA,W1,Hm,W,"Throttled",-0,0),z);break e}N9(R,S,ec,nE,lL,g,qc,nA,W1,Hm,W,null,-0,0)}}break}while(!0);vh(p)}function N9(p,g,S,R,z,W,re,we,He,xt,Ft,Wt,Et,It){if(p.timeoutHandle=-1,Wt=g.subtreeFlags,Wt&8192||(Wt&16785408)===16785408){Wt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Vl},x9(g,W,Wt);var In=(W&62914560)===W?eE-le():(W&4194048)===W?w9-le():0;if(In=Kce(Wt,In),In!==null){Pp=W,p.cancelPendingCommit=In(F9.bind(null,p,g,W,S,R,z,re,we,He,Ft,Wt,null,Et,It)),Ym(p,W,re,!xt);return}}F9(p,g,W,S,R,z,re,we,He)}function uce(p){for(var g=p;;){var S=g.tag;if((S===0||S===11||S===15)&&g.flags&16384&&(S=g.updateQueue,S!==null&&(S=S.stores,S!==null)))for(var R=0;R<S.length;R++){var z=S[R],W=z.getSnapshot;z=z.value;try{if(!Al(W(),z))return!1}catch{return!1}}if(S=g.child,g.subtreeFlags&16384&&S!==null)S.return=g,g=S;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Ym(p,g,S,R){g&=~oL,g&=~nA,p.suspendedLanes|=g,p.pingedLanes&=~g,R&&(p.warmLanes|=g),R=p.expirationTimes;for(var z=g;0<z;){var W=31-kt(z),re=1<<W;R[W]=-1,z&=~re}S!==0&&bt(p,S,g)}function aE(){return(Ni&6)===0?(Eb(0),!1):!0}function hL(){if(Ja!==null){if(zi===0)var p=Ja.return;else p=Ja,fd=Ap=null,CI(p),P=null,k=0,p=Ja;for(;p!==null;)r9(p.alternate,p),p=p.return;Ja=null}}function K1(p,g){var S=p.timeoutHandle;S!==-1&&(p.timeoutHandle=-1,Rce(S)),S=p.cancelPendingCommit,S!==null&&(p.cancelPendingCommit=null,S()),Pp=0,hL(),is=p,Ja=S=wu(p.current,null),ii=g,zi=0,Gc=null,Hm=!1,H1=an(p,g),rL=!1,W1=qc=oL=nA=Wm=Ys=0,ec=Tb=null,lL=!1,(g&8)!==0&&(g|=g&32);var R=p.entangledLanes;if(R!==0)for(p=p.entanglements,R&=g;0<R;){var z=31-kt(R),W=1<<z;g|=p[z],R&=~W}return Rp=g,N1(),S}function R9(p,g){La=null,Q.H=gb,g===gd||g===Vc?(g=w(),zi=3):g===Ah?(g=w(),zi=4):zi=g===qI?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Gc=g,Ja===null&&(Ys=1,Ww(p,Wl(g,p.current)))}function P9(){var p=Gn.current;return p===null?!0:(ii&4194048)===ii?Ia===null:(ii&62914560)===ii||(ii&536870912)!==0?p===Ia:!1}function I9(){var p=Q.H;return Q.H=gb,p===null?gb:p}function L9(){var p=Q.A;return Q.A=lce,p}function iE(){Ys=4,Hm||(ii&4194048)!==ii&&Gn.current!==null||(H1=!0),(Wm&134217727)===0&&(nA&134217727)===0||is===null||Ym(is,ii,qc,!1)}function fL(p,g,S){var R=Ni;Ni|=2;var z=I9(),W=L9();(is!==p||ii!==g)&&(nE=null,K1(p,g)),g=!1;var re=Ys;e:do try{if(zi!==0&&Ja!==null){var we=Ja,He=Gc;switch(zi){case 8:hL(),re=6;break e;case 3:case 2:case 9:case 6:Gn.current===null&&(g=!0);var xt=zi;if(zi=0,Gc=null,Y1(p,we,He,xt),S&&H1){re=0;break e}break;default:xt=zi,zi=0,Gc=null,Y1(p,we,He,xt)}}dce(),re=Ys;break}catch(Ft){R9(p,Ft)}while(!0);return g&&p.shellSuspendCounter++,fd=Ap=null,Ni=R,Q.H=z,Q.A=W,Ja===null&&(is=null,ii=0,N1()),re}function dce(){for(;Ja!==null;)D9(Ja)}function hce(p,g){var S=Ni;Ni|=2;var R=I9(),z=L9();is!==p||ii!==g?(nE=null,tE=le()+500,K1(p,g)):H1=an(p,g);e:do try{if(zi!==0&&Ja!==null){g=Ja;var W=Gc;t:switch(zi){case 1:zi=0,Gc=null,Y1(p,g,W,1);break;case 2:case 9:if(Ad(W)){zi=0,Gc=null,k9(g);break}g=function(){zi!==2&&zi!==9||is!==p||(zi=7),vh(p)},W.then(g,g);break e;case 3:zi=7;break e;case 4:zi=5;break e;case 7:Ad(W)?(zi=0,Gc=null,k9(g)):(zi=0,Gc=null,Y1(p,g,W,7));break;case 5:var re=null;switch(Ja.tag){case 26:re=Ja.memoizedState;case 5:case 27:var we=Ja;if(re?_V(re):we.stateNode.complete){zi=0,Gc=null;var He=we.sibling;if(He!==null)Ja=He;else{var xt=we.return;xt!==null?(Ja=xt,sE(xt)):Ja=null}break t}}zi=0,Gc=null,Y1(p,g,W,5);break;case 6:zi=0,Gc=null,Y1(p,g,W,6);break;case 8:hL(),Ys=6;break e;default:throw Error(i(462))}}fce();break}catch(Ft){R9(p,Ft)}while(!0);return fd=Ap=null,Q.H=R,Q.A=z,Ni=S,Ja!==null?0:(is=null,ii=0,N1(),Ys)}function fce(){for(;Ja!==null&&!Mt();)D9(Ja)}function D9(p){var g=i9(p.alternate,p,Rp);p.memoizedProps=p.pendingProps,g===null?sE(p):Ja=g}function k9(p){var g=p,S=g.alternate;switch(g.tag){case 15:case 0:g=JU(S,g,g.pendingProps,g.type,void 0,ii);break;case 11:g=JU(S,g,g.pendingProps,g.type.render,g.ref,ii);break;case 5:CI(g);default:r9(S,g),g=Ja=Lw(g,Rp),g=i9(S,g,Rp)}p.memoizedProps=p.pendingProps,g===null?sE(p):Ja=g}function Y1(p,g,S,R){fd=Ap=null,CI(g),P=null,k=0;var z=g.return;try{if(tce(p,z,g,S,ii)){Ys=1,Ww(p,Wl(S,p.current)),Ja=null;return}}catch(W){if(z!==null)throw Ja=z,W;Ys=1,Ww(p,Wl(S,p.current)),Ja=null;return}g.flags&32768?(Qa||R===1?p=!0:H1||(ii&536870912)!==0?p=!1:(Hm=p=!0,(R===2||R===9||R===3||R===6)&&(R=Gn.current,R!==null&&R.tag===13&&(R.flags|=16384))),O9(g,p)):sE(g)}function sE(p){var g=p;do{if((g.flags&32768)!==0){O9(g,Hm);return}p=g.return;var S=ice(g.alternate,g,Rp);if(S!==null){Ja=S;return}if(g=g.sibling,g!==null){Ja=g;return}Ja=g=p}while(g!==null);Ys===0&&(Ys=5)}function O9(p,g){do{var S=sce(p.alternate,p);if(S!==null){S.flags&=32767,Ja=S;return}if(S=p.return,S!==null&&(S.flags|=32768,S.subtreeFlags=0,S.deletions=null),!g&&(p=p.sibling,p!==null)){Ja=p;return}Ja=p=S}while(p!==null);Ys=6,Ja=null}function F9(p,g,S,R,z,W,re,we,He){p.cancelPendingCommit=null;do rE();while(kr!==0);if((Ni&6)!==0)throw Error(i(327));if(g!==null){if(g===p.current)throw Error(i(177));if(W=g.lanes|g.childLanes,W|=sb,dr(p,S,W,re,we,He),p===is&&(Ja=is=null,ii=0),$1=g,Km=p,Pp=S,cL=W,uL=z,E9=R,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(p.callbackNode=null,p.callbackPriority=0,Ace(Te,function(){return z9(),null})):(p.callbackNode=null,p.callbackPriority=0),R=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||R){R=Q.T,Q.T=null,z=Y.p,Y.p=2,re=Ni,Ni|=4;try{rce(p,g,S)}finally{Ni=re,Y.p=z,Q.T=R}}kr=1,j9(),B9(),U9()}}function j9(){if(kr===1){kr=0;var p=Km,g=$1,S=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||S){S=Q.T,Q.T=null;var R=Y.p;Y.p=2;var z=Ni;Ni|=4;try{y9(g,p);var W=wL,re=hh(p.containerInfo),we=W.focusedElem,He=W.selectionRange;if(re!==we&&we&&we.ownerDocument&&op(we.ownerDocument.documentElement,we)){if(He!==null&&fh(we)){var xt=He.start,Ft=He.end;if(Ft===void 0&&(Ft=xt),"selectionStart"in we)we.selectionStart=xt,we.selectionEnd=Math.min(Ft,we.value.length);else{var Wt=we.ownerDocument||document,Et=Wt&&Wt.defaultView||window;if(Et.getSelection){var It=Et.getSelection(),In=we.textContent.length,ra=Math.min(He.start,In),Yi=He.end===void 0?ra:Math.min(He.end,In);!It.extend&&ra>Yi&&(re=Yi,Yi=ra,ra=re);var dt=C1(we,ra),et=C1(we,Yi);if(dt&&et&&(It.rangeCount!==1||It.anchorNode!==dt.node||It.anchorOffset!==dt.offset||It.focusNode!==et.node||It.focusOffset!==et.offset)){var _t=Wt.createRange();_t.setStart(dt.node,dt.offset),It.removeAllRanges(),ra>Yi?(It.addRange(_t),It.extend(et.node,et.offset)):(_t.setEnd(et.node,et.offset),It.addRange(_t))}}}}for(Wt=[],It=we;It=It.parentNode;)It.nodeType===1&&Wt.push({element:It,left:It.scrollLeft,top:It.scrollTop});for(typeof we.focus=="function"&&we.focus(),we=0;we<Wt.length;we++){var Vt=Wt[we];Vt.element.scrollLeft=Vt.left,Vt.element.scrollTop=Vt.top}}yE=!!TL,wL=TL=null}finally{Ni=z,Y.p=R,Q.T=S}}p.current=g,kr=2}}function B9(){if(kr===2){kr=0;var p=Km,g=$1,S=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||S){S=Q.T,Q.T=null;var R=Y.p;Y.p=2;var z=Ni;Ni|=4;try{f9(p,g.alternate,g)}finally{Ni=z,Y.p=R,Q.T=S}}kr=3}}function U9(){if(kr===4||kr===3){kr=0,_e();var p=Km,g=$1,S=Pp,R=E9;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?kr=5:(kr=0,$1=Km=null,V9(p,p.pendingLanes));var z=p.pendingLanes;if(z===0&&($m=null),_(S),g=g.stateNode,ct&&typeof ct.onCommitFiberRoot=="function")try{ct.onCommitFiberRoot(Xe,g,void 0,(g.current.flags&128)===128)}catch{}if(R!==null){g=Q.T,z=Y.p,Y.p=2,Q.T=null;try{for(var W=p.onRecoverableError,re=0;re<R.length;re++){var we=R[re];W(we.value,{componentStack:we.stack})}}finally{Q.T=g,Y.p=z}}(Pp&3)!==0&&rE(),vh(p),z=p.pendingLanes,(S&261930)!==0&&(z&42)!==0?p===dL?wb++:(wb=0,dL=p):wb=0,Eb(0)}}function V9(p,g){(p.pooledCacheLanes&=g)===0&&(g=p.pooledCache,g!=null&&(p.pooledCache=null,Vm(g)))}function rE(){return j9(),B9(),U9(),z9()}function z9(){if(kr!==5)return!1;var p=Km,g=cL;cL=0;var S=_(Pp),R=Q.T,z=Y.p;try{Y.p=32>S?32:S,Q.T=null,S=uL,uL=null;var W=Km,re=Pp;if(kr=0,$1=Km=null,Pp=0,(Ni&6)!==0)throw Error(i(331));var we=Ni;if(Ni|=4,S9(W.current),_9(W,W.current,re,S),Ni=we,Eb(0,!1),ct&&typeof ct.onPostCommitFiberRoot=="function")try{ct.onPostCommitFiberRoot(Xe,W)}catch{}return!0}finally{Y.p=z,Q.T=R,V9(p,g)}}function G9(p,g,S){g=Wl(S,g),g=GI(p.stateNode,g,2),p=At(p,g,2),p!==null&&(Gs(p,2),vh(p))}function Gi(p,g,S){if(p.tag===3)G9(p,p,S);else for(;g!==null;){if(g.tag===3){G9(g,p,S);break}else if(g.tag===1){var R=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof R.componentDidCatch=="function"&&($m===null||!$m.has(R))){p=Wl(S,p),S=qU(2),R=At(g,S,2),R!==null&&(HU(S,R,g,p),Gs(R,2),vh(R));break}}g=g.return}}function pL(p,g,S){var R=p.pingCache;if(R===null){R=p.pingCache=new cce;var z=new Set;R.set(g,z)}else z=R.get(g),z===void 0&&(z=new Set,R.set(g,z));z.has(S)||(rL=!0,z.add(S),p=pce.bind(null,p,g,S),g.then(p,p))}function pce(p,g,S){var R=p.pingCache;R!==null&&R.delete(g),p.pingedLanes|=p.suspendedLanes&S,p.warmLanes&=~S,is===p&&(ii&S)===S&&(Ys===4||Ys===3&&(ii&62914560)===ii&&300>le()-eE?(Ni&2)===0&&K1(p,0):oL|=S,W1===ii&&(W1=0)),vh(p)}function q9(p,g){g===0&&(g=ai()),p=hp(p,g),p!==null&&(Gs(p,g),vh(p))}function mce(p){var g=p.memoizedState,S=0;g!==null&&(S=g.retryLane),q9(p,S)}function gce(p,g){var S=0;switch(p.tag){case 31:case 13:var R=p.stateNode,z=p.memoizedState;z!==null&&(S=z.retryLane);break;case 19:R=p.stateNode;break;case 22:R=p.stateNode._retryCache;break;default:throw Error(i(314))}R!==null&&R.delete(g),q9(p,S)}function Ace(p,g){return it(p,g)}var oE=null,X1=null,mL=!1,lE=!1,gL=!1,Xm=0;function vh(p){p!==X1&&p.next===null&&(X1===null?oE=X1=p:X1=X1.next=p),lE=!0,mL||(mL=!0,vce())}function Eb(p,g){if(!gL&&lE){gL=!0;do for(var S=!1,R=oE;R!==null;){if(p!==0){var z=R.pendingLanes;if(z===0)var W=0;else{var re=R.suspendedLanes,we=R.pingedLanes;W=(1<<31-kt(42|p)+1)-1,W&=z&~(re&~we),W=W&201326741?W&201326741|1:W?W|2:0}W!==0&&(S=!0,K9(R,W))}else W=ii,W=Ot(R,R===is?W:0,R.cancelPendingCommit!==null||R.timeoutHandle!==-1),(W&3)===0||an(R,W)||(S=!0,K9(R,W));R=R.next}while(S);gL=!1}}function yce(){H9()}function H9(){lE=mL=!1;var p=0;Xm!==0&&Nce()&&(p=Xm);for(var g=le(),S=null,R=oE;R!==null;){var z=R.next,W=W9(R,g);W===0?(R.next=null,S===null?oE=z:S.next=z,z===null&&(X1=S)):(S=R,(p!==0||(W&3)!==0)&&(lE=!0)),R=z}kr!==0&&kr!==5||Eb(p),Xm!==0&&(Xm=0)}function W9(p,g){for(var S=p.suspendedLanes,R=p.pingedLanes,z=p.expirationTimes,W=p.pendingLanes&-62914561;0<W;){var re=31-kt(W),we=1<<re,He=z[re];He===-1?((we&S)===0||(we&R)!==0)&&(z[re]=jn(we,g)):He<=g&&(p.expiredLanes|=we),W&=~we}if(g=is,S=ii,S=Ot(p,p===g?S:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),R=p.callbackNode,S===0||p===g&&(zi===2||zi===9)||p.cancelPendingCommit!==null)return R!==null&&R!==null&&wt(R),p.callbackNode=null,p.callbackPriority=0;if((S&3)===0||an(p,S)){if(g=S&-S,g===p.callbackPriority)return g;switch(R!==null&&wt(R),_(S)){case 2:case 8:S=pt;break;case 32:S=Te;break;case 268435456:S=mt;break;default:S=Te}return R=$9.bind(null,p),S=it(S,R),p.callbackPriority=g,p.callbackNode=S,g}return R!==null&&R!==null&&wt(R),p.callbackPriority=2,p.callbackNode=null,2}function $9(p,g){if(kr!==0&&kr!==5)return p.callbackNode=null,p.callbackPriority=0,null;var S=p.callbackNode;if(rE()&&p.callbackNode!==S)return null;var R=ii;return R=Ot(p,p===is?R:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),R===0?null:(C9(p,R,g),W9(p,le()),p.callbackNode!=null&&p.callbackNode===S?$9.bind(null,p):null)}function K9(p,g){if(rE())return null;C9(p,g,!0)}function vce(){Pce(function(){(Ni&6)!==0?it(tt,yce):H9()})}function AL(){if(Xm===0){var p=zm;p===0&&(p=Xt,Xt<<=1,(Xt&261888)===0&&(Xt=256)),Xm=p}return Xm}function Y9(p){return p==null||typeof p=="symbol"||typeof p=="boolean"?null:typeof p=="function"?p:ih(""+p)}function X9(p,g){var S=g.ownerDocument.createElement("input");return S.name=g.name,S.value=g.value,p.id&&S.setAttribute("form",p.id),g.parentNode.insertBefore(S,g),p=new FormData(p),S.parentNode.removeChild(S),p}function _ce(p,g,S,R,z){if(g==="submit"&&S&&S.stateNode===z){var W=Y9((z[Ln]||null).action),re=R.submitter;re&&(g=(g=re[Ln]||null)?Y9(g.formAction):re.getAttribute("formAction"),g!==null&&(W=g,re=null));var we=new bu("action","action",null,R,z);p.push({event:we,listeners:[{instance:null,listener:function(){if(R.defaultPrevented){if(Xm!==0){var He=re?X9(z,re):new FormData(z);FI(S,{pending:!0,data:He,method:z.method,action:W},null,He)}}else typeof W=="function"&&(we.preventDefault(),He=re?X9(z,re):new FormData(z),FI(S,{pending:!0,data:He,method:z.method,action:W},W,He))},currentTarget:z}]})}}for(var yL=0;yL<ib.length;yL++){var vL=ib[yL],xce=vL.toLowerCase(),bce=vL[0].toUpperCase()+vL.slice(1);Bc(xce,"on"+bce)}Bc(Ho,"onAnimationEnd"),Bc(Rw,"onAnimationIteration"),Bc(Um,"onAnimationStart"),Bc("dblclick","onDoubleClick"),Bc("focusin","onFocus"),Bc("focusout","onBlur"),Bc(_I,"onTransitionRun"),Bc(xI,"onTransitionStart"),Bc(bI,"onTransitionCancel"),Bc(ab,"onTransitionEnd"),se("onMouseEnter",["mouseout","mouseover"]),se("onMouseLeave",["mouseout","mouseover"]),se("onPointerEnter",["pointerout","pointerover"]),se("onPointerLeave",["pointerout","pointerover"]),Ze("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ze("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ze("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ze("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ze("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ze("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sce=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Mb));function Q9(p,g){g=(g&4)!==0;for(var S=0;S<p.length;S++){var R=p[S],z=R.event;R=R.listeners;e:{var W=void 0;if(g)for(var re=R.length-1;0<=re;re--){var we=R[re],He=we.instance,xt=we.currentTarget;if(we=we.listener,He!==W&&z.isPropagationStopped())break e;W=we,z.currentTarget=xt;try{W(z)}catch(Ft){dp(Ft)}z.currentTarget=null,W=He}else for(re=0;re<R.length;re++){if(we=R[re],He=we.instance,xt=we.currentTarget,we=we.listener,He!==W&&z.isPropagationStopped())break e;W=we,z.currentTarget=xt;try{W(z)}catch(Ft){dp(Ft)}z.currentTarget=null,W=He}}}}function Za(p,g){var S=g[Kr];S===void 0&&(S=g[Kr]=new Set);var R=p+"__bubble";S.has(R)||(J9(g,p,2,!1),S.add(R))}function _L(p,g,S){var R=0;g&&(R|=4),J9(S,p,R,g)}var cE="_reactListening"+Math.random().toString(36).slice(2);function xL(p){if(!p[cE]){p[cE]=!0,ot.forEach(function(S){S!=="selectionchange"&&(Sce.has(S)||_L(S,!1,p),_L(S,!0,p))});var g=p.nodeType===9?p:p.ownerDocument;g===null||g[cE]||(g[cE]=!0,_L("selectionchange",!1,g))}}function J9(p,g,S,R){switch(MV(g)){case 2:var z=Qce;break;case 8:z=Jce;break;default:z=OL}S=z.bind(null,g,S,p),z=void 0,!lh||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(z=!0),R?z!==void 0?p.addEventListener(g,S,{capture:!0,passive:z}):p.addEventListener(g,S,!0):z!==void 0?p.addEventListener(g,S,{passive:z}):p.addEventListener(g,S,!1)}function bL(p,g,S,R,z){var W=R;if((g&1)===0&&(g&2)===0&&R!==null)e:for(;;){if(R===null)return;var re=R.tag;if(re===3||re===4){var we=R.stateNode.containerInfo;if(we===z)break;if(re===4)for(re=R.return;re!==null;){var He=re.tag;if((He===3||He===4)&&re.stateNode.containerInfo===z)return;re=re.return}for(;we!==null;){if(re=Uo(we),re===null)return;if(He=re.tag,He===5||He===6||He===26||He===27){R=W=re;continue e}we=we.parentNode}}R=R.return}oh(function(){var xt=W,Ft=zl(S),Wt=[];e:{var Et=Pw.get(p);if(Et!==void 0){var It=bu,In=p;switch(p){case"keypress":if(ch(S)===0)break e;case"keydown":case"keyup":It=S1;break;case"focusin":In="focus",It=Su;break;case"focusout":In="blur",It=Su;break;case"beforeblur":case"afterblur":It=Su;break;case"click":if(S.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":It=U0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":It=x1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":It=ee;break;case Ho:case Rw:case Um:It=z0;break;case ab:It=Pe;break;case"scroll":case"scrollend":It=Dc;break;case"wheel":It=Ct;break;case"copy":case"cut":case"paste":It=np;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":It=ld;break;case"toggle":case"beforetoggle":It=Ea}var ra=(g&4)!==0,Yi=!ra&&(p==="scroll"||p==="scrollend"),dt=ra?Et!==null?Et+"Capture":null:Et;ra=[];for(var et=xt,_t;et!==null;){var Vt=et;if(_t=Vt.stateNode,Vt=Vt.tag,Vt!==5&&Vt!==26&&Vt!==27||_t===null||dt===null||(Vt=Ic(et,dt),Vt!=null&&ra.push(Cb(et,Vt,_t))),Yi)break;et=et.return}0<ra.length&&(Et=new It(Et,In,null,S,Ft),Wt.push({event:Et,listeners:ra}))}}if((g&7)===0){e:{if(Et=p==="mouseover"||p==="pointerover",It=p==="mouseout"||p==="pointerout",Et&&S!==B0&&(In=S.relatedTarget||S.fromElement)&&(Uo(In)||In[oa]))break e;if((It||Et)&&(Et=Ft.window===Ft?Ft:(Et=Ft.ownerDocument)?Et.defaultView||Et.parentWindow:window,It?(In=S.relatedTarget||S.toElement,It=xt,In=In?Uo(In):null,In!==null&&(Yi=r(In),ra=In.tag,In!==Yi||ra!==5&&ra!==27&&ra!==6)&&(In=null)):(It=null,In=xt),It!==In)){if(ra=U0,Vt="onMouseLeave",dt="onMouseEnter",et="mouse",(p==="pointerout"||p==="pointerover")&&(ra=ld,Vt="onPointerLeave",dt="onPointerEnter",et="pointer"),Yi=It==null?Et:qs(It),_t=In==null?Et:qs(In),Et=new ra(Vt,et+"leave",It,S,Ft),Et.target=Yi,Et.relatedTarget=_t,Vt=null,Uo(Ft)===xt&&(ra=new ra(dt,et+"enter",In,S,Ft),ra.target=_t,ra.relatedTarget=Yi,Vt=ra),Yi=Vt,It&&In)t:{for(ra=Tce,dt=It,et=In,_t=0,Vt=dt;Vt;Vt=ra(Vt))_t++;Vt=0;for(var $n=et;$n;$n=ra($n))Vt++;for(;0<_t-Vt;)dt=ra(dt),_t--;for(;0<Vt-_t;)et=ra(et),Vt--;for(;_t--;){if(dt===et||et!==null&&dt===et.alternate){ra=dt;break t}dt=ra(dt),et=ra(et)}ra=null}else ra=null;It!==null&&Z9(Wt,Et,It,ra,!1),In!==null&&Yi!==null&&Z9(Wt,Yi,In,ra,!0)}}e:{if(Et=xt?qs(xt):window,It=Et.nodeName&&Et.nodeName.toLowerCase(),It==="select"||It==="input"&&Et.type==="file")var Ti=ww;else if(w1(Et))if(Qx)Ti=yI;else{Ti=Zx;var Fn=qo}else It=Et.nodeName,!It||It.toLowerCase()!=="input"||Et.type!=="checkbox"&&Et.type!=="radio"?xt&&zo(xt.elementType)&&(Ti=ww):Ti=rp;if(Ti&&(Ti=Ti(p,xt))){Tw(Wt,Ti,S,Ft);break e}Fn&&Fn(p,Et,xt),p==="focusout"&&xt&&Et.type==="number"&&xt.memoizedProps.value!=null&&za(Et,"number",Et.value)}switch(Fn=xt?qs(xt):window,p){case"focusin":(w1(Fn)||Fn.contentEditable==="true")&&(lp=Fn,tb=xt,cp=null);break;case"focusout":cp=tb=lp=null;break;case"mousedown":nb=!0;break;case"contextmenu":case"mouseup":case"dragend":nb=!1,Nw(Wt,S,Ft);break;case"selectionchange":if(vI)break;case"keydown":case"keyup":Nw(Wt,S,Ft)}var Oa;if(Xa)e:{switch(p){case"compositionstart":var si="onCompositionStart";break e;case"compositionend":si="onCompositionEnd";break e;case"compositionupdate":si="onCompositionUpdate";break e}si=void 0}else jm?cd(p,S)&&(si="onCompositionEnd"):p==="keydown"&&S.keyCode===229&&(si="onCompositionStart");si&&(Fc&&S.locale!=="ko"&&(jm||si!=="onCompositionStart"?si==="onCompositionEnd"&&jm&&(Oa=Om()):(ql=Ft,Jf="value"in ql?ql.value:ql.textContent,jm=!0)),Fn=uE(xt,si),0<Fn.length&&(si=new Ir(si,p,null,S,Ft),Wt.push({event:si,listeners:Fn}),Oa?si.data=Oa:(Oa=ap(S),Oa!==null&&(si.data=Oa)))),(Oa=Go?Sw(p,S):gI(p,S))&&(si=uE(xt,"onBeforeInput"),0<si.length&&(Fn=new Ir("onBeforeInput","beforeinput",null,S,Ft),Wt.push({event:Fn,listeners:si}),Fn.data=Oa)),_ce(Wt,p,xt,S,Ft)}Q9(Wt,g)})}function Cb(p,g,S){return{instance:p,listener:g,currentTarget:S}}function uE(p,g){for(var S=g+"Capture",R=[];p!==null;){var z=p,W=z.stateNode;if(z=z.tag,z!==5&&z!==26&&z!==27||W===null||(z=Ic(p,S),z!=null&&R.unshift(Cb(p,z,W)),z=Ic(p,g),z!=null&&R.push(Cb(p,z,W))),p.tag===3)return R;p=p.return}return[]}function Tce(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5&&p.tag!==27);return p||null}function Z9(p,g,S,R,z){for(var W=g._reactName,re=[];S!==null&&S!==R;){var we=S,He=we.alternate,xt=we.stateNode;if(we=we.tag,He!==null&&He===R)break;we!==5&&we!==26&&we!==27||xt===null||(He=xt,z?(xt=Ic(S,W),xt!=null&&re.unshift(Cb(S,xt,He))):z||(xt=Ic(S,W),xt!=null&&re.push(Cb(S,xt,He)))),S=S.return}re.length!==0&&p.push({event:g,listeners:re})}var wce=/\r\n?/g,Ece=/\u0000|\uFFFD/g;function eV(p){return(typeof p=="string"?p:""+p).replace(wce,`
`).replace(Ece,"")}function tV(p,g){return g=eV(g),eV(p)===g}function Ki(p,g,S,R,z,W){switch(S){case"children":typeof R=="string"?g==="body"||g==="textarea"&&R===""||Ci(p,R):(typeof R=="number"||typeof R=="bigint")&&g!=="body"&&Ci(p,""+R);break;case"className":Dn(p,"class",R);break;case"tabIndex":Dn(p,"tabindex",R);break;case"dir":case"role":case"viewBox":case"width":case"height":Dn(p,S,R);break;case"style":id(p,R,W);break;case"data":if(g!=="object"){Dn(p,"data",R);break}case"src":case"href":if(R===""&&(g!=="a"||S!=="href")){p.removeAttribute(S);break}if(R==null||typeof R=="function"||typeof R=="symbol"||typeof R=="boolean"){p.removeAttribute(S);break}R=ih(""+R),p.setAttribute(S,R);break;case"action":case"formAction":if(typeof R=="function"){p.setAttribute(S,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof W=="function"&&(S==="formAction"?(g!=="input"&&Ki(p,g,"name",z.name,z,null),Ki(p,g,"formEncType",z.formEncType,z,null),Ki(p,g,"formMethod",z.formMethod,z,null),Ki(p,g,"formTarget",z.formTarget,z,null)):(Ki(p,g,"encType",z.encType,z,null),Ki(p,g,"method",z.method,z,null),Ki(p,g,"target",z.target,z,null)));if(R==null||typeof R=="symbol"||typeof R=="boolean"){p.removeAttribute(S);break}R=ih(""+R),p.setAttribute(S,R);break;case"onClick":R!=null&&(p.onclick=Vl);break;case"onScroll":R!=null&&Za("scroll",p);break;case"onScrollEnd":R!=null&&Za("scrollend",p);break;case"dangerouslySetInnerHTML":if(R!=null){if(typeof R!="object"||!("__html"in R))throw Error(i(61));if(S=R.__html,S!=null){if(z.children!=null)throw Error(i(60));p.innerHTML=S}}break;case"multiple":p.multiple=R&&typeof R!="function"&&typeof R!="symbol";break;case"muted":p.muted=R&&typeof R!="function"&&typeof R!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(R==null||typeof R=="function"||typeof R=="boolean"||typeof R=="symbol"){p.removeAttribute("xlink:href");break}S=ih(""+R),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",S);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":R!=null&&typeof R!="function"&&typeof R!="symbol"?p.setAttribute(S,""+R):p.removeAttribute(S);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":R&&typeof R!="function"&&typeof R!="symbol"?p.setAttribute(S,""):p.removeAttribute(S);break;case"capture":case"download":R===!0?p.setAttribute(S,""):R!==!1&&R!=null&&typeof R!="function"&&typeof R!="symbol"?p.setAttribute(S,R):p.removeAttribute(S);break;case"cols":case"rows":case"size":case"span":R!=null&&typeof R!="function"&&typeof R!="symbol"&&!isNaN(R)&&1<=R?p.setAttribute(S,R):p.removeAttribute(S);break;case"rowSpan":case"start":R==null||typeof R=="function"||typeof R=="symbol"||isNaN(R)?p.removeAttribute(S):p.setAttribute(S,R);break;case"popover":Za("beforetoggle",p),Za("toggle",p),Mn(p,"popover",R);break;case"xlinkActuate":de(p,"http://www.w3.org/1999/xlink","xlink:actuate",R);break;case"xlinkArcrole":de(p,"http://www.w3.org/1999/xlink","xlink:arcrole",R);break;case"xlinkRole":de(p,"http://www.w3.org/1999/xlink","xlink:role",R);break;case"xlinkShow":de(p,"http://www.w3.org/1999/xlink","xlink:show",R);break;case"xlinkTitle":de(p,"http://www.w3.org/1999/xlink","xlink:title",R);break;case"xlinkType":de(p,"http://www.w3.org/1999/xlink","xlink:type",R);break;case"xmlBase":de(p,"http://www.w3.org/XML/1998/namespace","xml:base",R);break;case"xmlLang":de(p,"http://www.w3.org/XML/1998/namespace","xml:lang",R);break;case"xmlSpace":de(p,"http://www.w3.org/XML/1998/namespace","xml:space",R);break;case"is":Mn(p,"is",R);break;case"innerText":case"textContent":break;default:(!(2<S.length)||S[0]!=="o"&&S[0]!=="O"||S[1]!=="n"&&S[1]!=="N")&&(S=_1.get(S)||S,Mn(p,S,R))}}function SL(p,g,S,R,z,W){switch(S){case"style":id(p,R,W);break;case"dangerouslySetInnerHTML":if(R!=null){if(typeof R!="object"||!("__html"in R))throw Error(i(61));if(S=R.__html,S!=null){if(z.children!=null)throw Error(i(60));p.innerHTML=S}}break;case"children":typeof R=="string"?Ci(p,R):(typeof R=="number"||typeof R=="bigint")&&Ci(p,""+R);break;case"onScroll":R!=null&&Za("scroll",p);break;case"onScrollEnd":R!=null&&Za("scrollend",p);break;case"onClick":R!=null&&(p.onclick=Vl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!St.hasOwnProperty(S))e:{if(S[0]==="o"&&S[1]==="n"&&(z=S.endsWith("Capture"),g=S.slice(2,z?S.length-7:void 0),W=p[Ln]||null,W=W!=null?W[S]:null,typeof W=="function"&&p.removeEventListener(g,W,z),typeof R=="function")){typeof W!="function"&&W!==null&&(S in p?p[S]=null:p.hasAttribute(S)&&p.removeAttribute(S)),p.addEventListener(g,R,z);break e}S in p?p[S]=R:R===!0?p.setAttribute(S,""):Mn(p,S,R)}}}function _o(p,g,S){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Za("error",p),Za("load",p);var R=!1,z=!1,W;for(W in S)if(S.hasOwnProperty(W)){var re=S[W];if(re!=null)switch(W){case"src":R=!0;break;case"srcSet":z=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,g));default:Ki(p,g,W,re,S,null)}}z&&Ki(p,g,"srcSet",S.srcSet,S,null),R&&Ki(p,g,"src",S.src,S,null);return;case"input":Za("invalid",p);var we=W=re=z=null,He=null,xt=null;for(R in S)if(S.hasOwnProperty(R)){var Ft=S[R];if(Ft!=null)switch(R){case"name":z=Ft;break;case"type":re=Ft;break;case"checked":He=Ft;break;case"defaultChecked":xt=Ft;break;case"value":W=Ft;break;case"defaultValue":we=Ft;break;case"children":case"dangerouslySetInnerHTML":if(Ft!=null)throw Error(i(137,g));break;default:Ki(p,g,R,Ft,S,null)}}Hs(p,W,we,He,xt,re,z,!1);return;case"select":Za("invalid",p),R=re=W=null;for(z in S)if(S.hasOwnProperty(z)&&(we=S[z],we!=null))switch(z){case"value":W=we;break;case"defaultValue":re=we;break;case"multiple":R=we;default:Ki(p,g,z,we,S,null)}g=W,S=re,p.multiple=!!R,g!=null?Vo(p,!!R,g,!1):S!=null&&Vo(p,!!R,S,!0);return;case"textarea":Za("invalid",p),W=z=R=null;for(re in S)if(S.hasOwnProperty(re)&&(we=S[re],we!=null))switch(re){case"value":R=we;break;case"defaultValue":z=we;break;case"children":W=we;break;case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(91));break;default:Ki(p,g,re,we,S,null)}ps(p,R,z,W);return;case"option":for(He in S)S.hasOwnProperty(He)&&(R=S[He],R!=null)&&(He==="selected"?p.selected=R&&typeof R!="function"&&typeof R!="symbol":Ki(p,g,He,R,S,null));return;case"dialog":Za("beforetoggle",p),Za("toggle",p),Za("cancel",p),Za("close",p);break;case"iframe":case"object":Za("load",p);break;case"video":case"audio":for(R=0;R<Mb.length;R++)Za(Mb[R],p);break;case"image":Za("error",p),Za("load",p);break;case"details":Za("toggle",p);break;case"embed":case"source":case"link":Za("error",p),Za("load",p);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(xt in S)if(S.hasOwnProperty(xt)&&(R=S[xt],R!=null))switch(xt){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,g));default:Ki(p,g,xt,R,S,null)}return;default:if(zo(g)){for(Ft in S)S.hasOwnProperty(Ft)&&(R=S[Ft],R!==void 0&&SL(p,g,Ft,R,S,void 0));return}}for(we in S)S.hasOwnProperty(we)&&(R=S[we],R!=null&&Ki(p,g,we,R,S,null))}function Mce(p,g,S,R){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var z=null,W=null,re=null,we=null,He=null,xt=null,Ft=null;for(It in S){var Wt=S[It];if(S.hasOwnProperty(It)&&Wt!=null)switch(It){case"checked":break;case"value":break;case"defaultValue":He=Wt;default:R.hasOwnProperty(It)||Ki(p,g,It,null,R,Wt)}}for(var Et in R){var It=R[Et];if(Wt=S[Et],R.hasOwnProperty(Et)&&(It!=null||Wt!=null))switch(Et){case"type":W=It;break;case"name":z=It;break;case"checked":xt=It;break;case"defaultChecked":Ft=It;break;case"value":re=It;break;case"defaultValue":we=It;break;case"children":case"dangerouslySetInnerHTML":if(It!=null)throw Error(i(137,g));break;default:It!==Wt&&Ki(p,g,Et,It,R,Wt)}}Is(p,re,we,He,xt,Ft,W,z);return;case"select":It=re=we=Et=null;for(W in S)if(He=S[W],S.hasOwnProperty(W)&&He!=null)switch(W){case"value":break;case"multiple":It=He;default:R.hasOwnProperty(W)||Ki(p,g,W,null,R,He)}for(z in R)if(W=R[z],He=S[z],R.hasOwnProperty(z)&&(W!=null||He!=null))switch(z){case"value":Et=W;break;case"defaultValue":we=W;break;case"multiple":re=W;default:W!==He&&Ki(p,g,z,W,R,He)}g=we,S=re,R=It,Et!=null?Vo(p,!!S,Et,!1):!!R!=!!S&&(g!=null?Vo(p,!!S,g,!0):Vo(p,!!S,S?[]:"",!1));return;case"textarea":It=Et=null;for(we in S)if(z=S[we],S.hasOwnProperty(we)&&z!=null&&!R.hasOwnProperty(we))switch(we){case"value":break;case"children":break;default:Ki(p,g,we,null,R,z)}for(re in R)if(z=R[re],W=S[re],R.hasOwnProperty(re)&&(z!=null||W!=null))switch(re){case"value":Et=z;break;case"defaultValue":It=z;break;case"children":break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(i(91));break;default:z!==W&&Ki(p,g,re,z,R,W)}pi(p,Et,It);return;case"option":for(var In in S)Et=S[In],S.hasOwnProperty(In)&&Et!=null&&!R.hasOwnProperty(In)&&(In==="selected"?p.selected=!1:Ki(p,g,In,null,R,Et));for(He in R)Et=R[He],It=S[He],R.hasOwnProperty(He)&&Et!==It&&(Et!=null||It!=null)&&(He==="selected"?p.selected=Et&&typeof Et!="function"&&typeof Et!="symbol":Ki(p,g,He,Et,R,It));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ra in S)Et=S[ra],S.hasOwnProperty(ra)&&Et!=null&&!R.hasOwnProperty(ra)&&Ki(p,g,ra,null,R,Et);for(xt in R)if(Et=R[xt],It=S[xt],R.hasOwnProperty(xt)&&Et!==It&&(Et!=null||It!=null))switch(xt){case"children":case"dangerouslySetInnerHTML":if(Et!=null)throw Error(i(137,g));break;default:Ki(p,g,xt,Et,R,It)}return;default:if(zo(g)){for(var Yi in S)Et=S[Yi],S.hasOwnProperty(Yi)&&Et!==void 0&&!R.hasOwnProperty(Yi)&&SL(p,g,Yi,void 0,R,Et);for(Ft in R)Et=R[Ft],It=S[Ft],!R.hasOwnProperty(Ft)||Et===It||Et===void 0&&It===void 0||SL(p,g,Ft,Et,R,It);return}}for(var dt in S)Et=S[dt],S.hasOwnProperty(dt)&&Et!=null&&!R.hasOwnProperty(dt)&&Ki(p,g,dt,null,R,Et);for(Wt in R)Et=R[Wt],It=S[Wt],!R.hasOwnProperty(Wt)||Et===It||Et==null&&It==null||Ki(p,g,Wt,Et,R,It)}function nV(p){switch(p){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Cce(){if(typeof performance.getEntriesByType=="function"){for(var p=0,g=0,S=performance.getEntriesByType("resource"),R=0;R<S.length;R++){var z=S[R],W=z.transferSize,re=z.initiatorType,we=z.duration;if(W&&we&&nV(re)){for(re=0,we=z.responseEnd,R+=1;R<S.length;R++){var He=S[R],xt=He.startTime;if(xt>we)break;var Ft=He.transferSize,Wt=He.initiatorType;Ft&&nV(Wt)&&(He=He.responseEnd,re+=Ft*(He<we?1:(we-xt)/(He-xt)))}if(--R,g+=8*(W+re)/(z.duration/1e3),p++,10<p)break}}if(0<p)return g/p/1e6}return navigator.connection&&(p=navigator.connection.downlink,typeof p=="number")?p:5}var TL=null,wL=null;function dE(p){return p.nodeType===9?p:p.ownerDocument}function aV(p){switch(p){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function iV(p,g){if(p===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return p===1&&g==="foreignObject"?0:p}function EL(p,g){return p==="textarea"||p==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var ML=null;function Nce(){var p=window.event;return p&&p.type==="popstate"?p===ML?!1:(ML=p,!0):(ML=null,!1)}var sV=typeof setTimeout=="function"?setTimeout:void 0,Rce=typeof clearTimeout=="function"?clearTimeout:void 0,rV=typeof Promise=="function"?Promise:void 0,Pce=typeof queueMicrotask=="function"?queueMicrotask:typeof rV<"u"?function(p){return rV.resolve(null).then(p).catch(Ice)}:sV;function Ice(p){setTimeout(function(){throw p})}function Qm(p){return p==="head"}function oV(p,g){var S=g,R=0;do{var z=S.nextSibling;if(p.removeChild(S),z&&z.nodeType===8)if(S=z.data,S==="/$"||S==="/&"){if(R===0){p.removeChild(z),ev(g);return}R--}else if(S==="$"||S==="$?"||S==="$~"||S==="$!"||S==="&")R++;else if(S==="html")Nb(p.ownerDocument.documentElement);else if(S==="head"){S=p.ownerDocument.head,Nb(S);for(var W=S.firstChild;W;){var re=W.nextSibling,we=W.nodeName;W[yo]||we==="SCRIPT"||we==="STYLE"||we==="LINK"&&W.rel.toLowerCase()==="stylesheet"||S.removeChild(W),W=re}}else S==="body"&&Nb(p.ownerDocument.body);S=z}while(S);ev(g)}function lV(p,g){var S=p;p=0;do{var R=S.nextSibling;if(S.nodeType===1?g?(S._stashedDisplay=S.style.display,S.style.display="none"):(S.style.display=S._stashedDisplay||"",S.getAttribute("style")===""&&S.removeAttribute("style")):S.nodeType===3&&(g?(S._stashedText=S.nodeValue,S.nodeValue=""):S.nodeValue=S._stashedText||""),R&&R.nodeType===8)if(S=R.data,S==="/$"){if(p===0)break;p--}else S!=="$"&&S!=="$?"&&S!=="$~"&&S!=="$!"||p++;S=R}while(S)}function CL(p){var g=p.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var S=g;switch(g=g.nextSibling,S.nodeName){case"HTML":case"HEAD":case"BODY":CL(S),ah(S);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(S.rel.toLowerCase()==="stylesheet")continue}p.removeChild(S)}}function Lce(p,g,S,R){for(;p.nodeType===1;){var z=S;if(p.nodeName.toLowerCase()!==g.toLowerCase()){if(!R&&(p.nodeName!=="INPUT"||p.type!=="hidden"))break}else if(R){if(!p[yo])switch(g){case"meta":if(!p.hasAttribute("itemprop"))break;return p;case"link":if(W=p.getAttribute("rel"),W==="stylesheet"&&p.hasAttribute("data-precedence"))break;if(W!==z.rel||p.getAttribute("href")!==(z.href==null||z.href===""?null:z.href)||p.getAttribute("crossorigin")!==(z.crossOrigin==null?null:z.crossOrigin)||p.getAttribute("title")!==(z.title==null?null:z.title))break;return p;case"style":if(p.hasAttribute("data-precedence"))break;return p;case"script":if(W=p.getAttribute("src"),(W!==(z.src==null?null:z.src)||p.getAttribute("type")!==(z.type==null?null:z.type)||p.getAttribute("crossorigin")!==(z.crossOrigin==null?null:z.crossOrigin))&&W&&p.hasAttribute("async")&&!p.hasAttribute("itemprop"))break;return p;default:return p}}else if(g==="input"&&p.type==="hidden"){var W=z.name==null?null:""+z.name;if(z.type==="hidden"&&p.getAttribute("name")===W)return p}else return p;if(p=Pu(p.nextSibling),p===null)break}return null}function Dce(p,g,S){if(g==="")return null;for(;p.nodeType!==3;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!S||(p=Pu(p.nextSibling),p===null))return null;return p}function cV(p,g){for(;p.nodeType!==8;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!g||(p=Pu(p.nextSibling),p===null))return null;return p}function NL(p){return p.data==="$?"||p.data==="$~"}function RL(p){return p.data==="$!"||p.data==="$?"&&p.ownerDocument.readyState!=="loading"}function kce(p,g){var S=p.ownerDocument;if(p.data==="$~")p._reactRetry=g;else if(p.data!=="$?"||S.readyState!=="loading")g();else{var R=function(){g(),S.removeEventListener("DOMContentLoaded",R)};S.addEventListener("DOMContentLoaded",R),p._reactRetry=R}}function Pu(p){for(;p!=null;p=p.nextSibling){var g=p.nodeType;if(g===1||g===3)break;if(g===8){if(g=p.data,g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"||g==="F!"||g==="F")break;if(g==="/$"||g==="/&")return null}}return p}var PL=null;function uV(p){p=p.nextSibling;for(var g=0;p;){if(p.nodeType===8){var S=p.data;if(S==="/$"||S==="/&"){if(g===0)return Pu(p.nextSibling);g--}else S!=="$"&&S!=="$!"&&S!=="$?"&&S!=="$~"&&S!=="&"||g++}p=p.nextSibling}return null}function dV(p){p=p.previousSibling;for(var g=0;p;){if(p.nodeType===8){var S=p.data;if(S==="$"||S==="$!"||S==="$?"||S==="$~"||S==="&"){if(g===0)return p;g--}else S!=="/$"&&S!=="/&"||g++}p=p.previousSibling}return null}function hV(p,g,S){switch(g=dE(S),p){case"html":if(p=g.documentElement,!p)throw Error(i(452));return p;case"head":if(p=g.head,!p)throw Error(i(453));return p;case"body":if(p=g.body,!p)throw Error(i(454));return p;default:throw Error(i(451))}}function Nb(p){for(var g=p.attributes;g.length;)p.removeAttributeNode(g[0]);ah(p)}var Iu=new Map,fV=new Set;function hE(p){return typeof p.getRootNode=="function"?p.getRootNode():p.nodeType===9?p:p.ownerDocument}var Ip=Y.d;Y.d={f:Oce,r:Fce,D:jce,C:Bce,L:Uce,m:Vce,X:Gce,S:zce,M:qce};function Oce(){var p=Ip.f(),g=aE();return p||g}function Fce(p){var g=ts(p);g!==null&&g.tag===5&&g.type==="form"?RU(g):Ip.r(p)}var Q1=typeof document>"u"?null:document;function pV(p,g,S){var R=Q1;if(R&&typeof g=="string"&&g){var z=ca(g);z='link[rel="'+p+'"][href="'+z+'"]',typeof S=="string"&&(z+='[crossorigin="'+S+'"]'),fV.has(z)||(fV.add(z),p={rel:p,crossOrigin:S,href:g},R.querySelector(z)===null&&(g=R.createElement("link"),_o(g,"link",p),Se(g),R.head.appendChild(g)))}}function jce(p){Ip.D(p),pV("dns-prefetch",p,null)}function Bce(p,g){Ip.C(p,g),pV("preconnect",p,g)}function Uce(p,g,S){Ip.L(p,g,S);var R=Q1;if(R&&p&&g){var z='link[rel="preload"][as="'+ca(g)+'"]';g==="image"&&S&&S.imageSrcSet?(z+='[imagesrcset="'+ca(S.imageSrcSet)+'"]',typeof S.imageSizes=="string"&&(z+='[imagesizes="'+ca(S.imageSizes)+'"]')):z+='[href="'+ca(p)+'"]';var W=z;switch(g){case"style":W=J1(p);break;case"script":W=Z1(p)}Iu.has(W)||(p=f({rel:"preload",href:g==="image"&&S&&S.imageSrcSet?void 0:p,as:g},S),Iu.set(W,p),R.querySelector(z)!==null||g==="style"&&R.querySelector(Rb(W))||g==="script"&&R.querySelector(Pb(W))||(g=R.createElement("link"),_o(g,"link",p),Se(g),R.head.appendChild(g)))}}function Vce(p,g){Ip.m(p,g);var S=Q1;if(S&&p){var R=g&&typeof g.as=="string"?g.as:"script",z='link[rel="modulepreload"][as="'+ca(R)+'"][href="'+ca(p)+'"]',W=z;switch(R){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":W=Z1(p)}if(!Iu.has(W)&&(p=f({rel:"modulepreload",href:p},g),Iu.set(W,p),S.querySelector(z)===null)){switch(R){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(S.querySelector(Pb(W)))return}R=S.createElement("link"),_o(R,"link",p),Se(R),S.head.appendChild(R)}}}function zce(p,g,S){Ip.S(p,g,S);var R=Q1;if(R&&p){var z=Ps(R).hoistableStyles,W=J1(p);g=g||"default";var re=z.get(W);if(!re){var we={loading:0,preload:null};if(re=R.querySelector(Rb(W)))we.loading=5;else{p=f({rel:"stylesheet",href:p,"data-precedence":g},S),(S=Iu.get(W))&&IL(p,S);var He=re=R.createElement("link");Se(He),_o(He,"link",p),He._p=new Promise(function(xt,Ft){He.onload=xt,He.onerror=Ft}),He.addEventListener("load",function(){we.loading|=1}),He.addEventListener("error",function(){we.loading|=2}),we.loading|=4,fE(re,g,R)}re={type:"stylesheet",instance:re,count:1,state:we},z.set(W,re)}}}function Gce(p,g){Ip.X(p,g);var S=Q1;if(S&&p){var R=Ps(S).hoistableScripts,z=Z1(p),W=R.get(z);W||(W=S.querySelector(Pb(z)),W||(p=f({src:p,async:!0},g),(g=Iu.get(z))&&LL(p,g),W=S.createElement("script"),Se(W),_o(W,"link",p),S.head.appendChild(W)),W={type:"script",instance:W,count:1,state:null},R.set(z,W))}}function qce(p,g){Ip.M(p,g);var S=Q1;if(S&&p){var R=Ps(S).hoistableScripts,z=Z1(p),W=R.get(z);W||(W=S.querySelector(Pb(z)),W||(p=f({src:p,async:!0,type:"module"},g),(g=Iu.get(z))&&LL(p,g),W=S.createElement("script"),Se(W),_o(W,"link",p),S.head.appendChild(W)),W={type:"script",instance:W,count:1,state:null},R.set(z,W))}}function mV(p,g,S,R){var z=(z=te.current)?hE(z):null;if(!z)throw Error(i(446));switch(p){case"meta":case"title":return null;case"style":return typeof S.precedence=="string"&&typeof S.href=="string"?(g=J1(S.href),S=Ps(z).hoistableStyles,R=S.get(g),R||(R={type:"style",instance:null,count:0,state:null},S.set(g,R)),R):{type:"void",instance:null,count:0,state:null};case"link":if(S.rel==="stylesheet"&&typeof S.href=="string"&&typeof S.precedence=="string"){p=J1(S.href);var W=Ps(z).hoistableStyles,re=W.get(p);if(re||(z=z.ownerDocument||z,re={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},W.set(p,re),(W=z.querySelector(Rb(p)))&&!W._p&&(re.instance=W,re.state.loading=5),Iu.has(p)||(S={rel:"preload",as:"style",href:S.href,crossOrigin:S.crossOrigin,integrity:S.integrity,media:S.media,hrefLang:S.hrefLang,referrerPolicy:S.referrerPolicy},Iu.set(p,S),W||Hce(z,p,S,re.state))),g&&R===null)throw Error(i(528,""));return re}if(g&&R!==null)throw Error(i(529,""));return null;case"script":return g=S.async,S=S.src,typeof S=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=Z1(S),S=Ps(z).hoistableScripts,R=S.get(g),R||(R={type:"script",instance:null,count:0,state:null},S.set(g,R)),R):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,p))}}function J1(p){return'href="'+ca(p)+'"'}function Rb(p){return'link[rel="stylesheet"]['+p+"]"}function gV(p){return f({},p,{"data-precedence":p.precedence,precedence:null})}function Hce(p,g,S,R){p.querySelector('link[rel="preload"][as="style"]['+g+"]")?R.loading=1:(g=p.createElement("link"),R.preload=g,g.addEventListener("load",function(){return R.loading|=1}),g.addEventListener("error",function(){return R.loading|=2}),_o(g,"link",S),Se(g),p.head.appendChild(g))}function Z1(p){return'[src="'+ca(p)+'"]'}function Pb(p){return"script[async]"+p}function AV(p,g,S){if(g.count++,g.instance===null)switch(g.type){case"style":var R=p.querySelector('style[data-href~="'+ca(S.href)+'"]');if(R)return g.instance=R,Se(R),R;var z=f({},S,{"data-href":S.href,"data-precedence":S.precedence,href:null,precedence:null});return R=(p.ownerDocument||p).createElement("style"),Se(R),_o(R,"style",z),fE(R,S.precedence,p),g.instance=R;case"stylesheet":z=J1(S.href);var W=p.querySelector(Rb(z));if(W)return g.state.loading|=4,g.instance=W,Se(W),W;R=gV(S),(z=Iu.get(z))&&IL(R,z),W=(p.ownerDocument||p).createElement("link"),Se(W);var re=W;return re._p=new Promise(function(we,He){re.onload=we,re.onerror=He}),_o(W,"link",R),g.state.loading|=4,fE(W,S.precedence,p),g.instance=W;case"script":return W=Z1(S.src),(z=p.querySelector(Pb(W)))?(g.instance=z,Se(z),z):(R=S,(z=Iu.get(W))&&(R=f({},S),LL(R,z)),p=p.ownerDocument||p,z=p.createElement("script"),Se(z),_o(z,"link",R),p.head.appendChild(z),g.instance=z);case"void":return null;default:throw Error(i(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(R=g.instance,g.state.loading|=4,fE(R,S.precedence,p));return g.instance}function fE(p,g,S){for(var R=S.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),z=R.length?R[R.length-1]:null,W=z,re=0;re<R.length;re++){var we=R[re];if(we.dataset.precedence===g)W=we;else if(W!==z)break}W?W.parentNode.insertBefore(p,W.nextSibling):(g=S.nodeType===9?S.head:S,g.insertBefore(p,g.firstChild))}function IL(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.title==null&&(p.title=g.title)}function LL(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.integrity==null&&(p.integrity=g.integrity)}var pE=null;function yV(p,g,S){if(pE===null){var R=new Map,z=pE=new Map;z.set(S,R)}else z=pE,R=z.get(S),R||(R=new Map,z.set(S,R));if(R.has(p))return R;for(R.set(p,null),S=S.getElementsByTagName(p),z=0;z<S.length;z++){var W=S[z];if(!(W[yo]||W[Pa]||p==="link"&&W.getAttribute("rel")==="stylesheet")&&W.namespaceURI!=="http://www.w3.org/2000/svg"){var re=W.getAttribute(g)||"";re=p+re;var we=R.get(re);we?we.push(W):R.set(re,[W])}}return R}function vV(p,g,S){p=p.ownerDocument||p,p.head.insertBefore(S,g==="title"?p.querySelector("head > title"):null)}function Wce(p,g,S){if(S===1||g.itemProp!=null)return!1;switch(p){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;return g.rel==="stylesheet"?(p=g.disabled,typeof g.precedence=="string"&&p==null):!0;case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function _V(p){return!(p.type==="stylesheet"&&(p.state.loading&3)===0)}function $ce(p,g,S,R){if(S.type==="stylesheet"&&(typeof R.media!="string"||matchMedia(R.media).matches!==!1)&&(S.state.loading&4)===0){if(S.instance===null){var z=J1(R.href),W=g.querySelector(Rb(z));if(W){g=W._p,g!==null&&typeof g=="object"&&typeof g.then=="function"&&(p.count++,p=mE.bind(p),g.then(p,p)),S.state.loading|=4,S.instance=W,Se(W);return}W=g.ownerDocument||g,R=gV(R),(z=Iu.get(z))&&IL(R,z),W=W.createElement("link"),Se(W);var re=W;re._p=new Promise(function(we,He){re.onload=we,re.onerror=He}),_o(W,"link",R),S.instance=W}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(S,g),(g=S.state.preload)&&(S.state.loading&3)===0&&(p.count++,S=mE.bind(p),g.addEventListener("load",S),g.addEventListener("error",S))}}var DL=0;function Kce(p,g){return p.stylesheets&&p.count===0&&AE(p,p.stylesheets),0<p.count||0<p.imgCount?function(S){var R=setTimeout(function(){if(p.stylesheets&&AE(p,p.stylesheets),p.unsuspend){var W=p.unsuspend;p.unsuspend=null,W()}},6e4+g);0<p.imgBytes&&DL===0&&(DL=62500*Cce());var z=setTimeout(function(){if(p.waitingForImages=!1,p.count===0&&(p.stylesheets&&AE(p,p.stylesheets),p.unsuspend)){var W=p.unsuspend;p.unsuspend=null,W()}},(p.imgBytes>DL?50:800)+g);return p.unsuspend=S,function(){p.unsuspend=null,clearTimeout(R),clearTimeout(z)}}:null}function mE(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)AE(this,this.stylesheets);else if(this.unsuspend){var p=this.unsuspend;this.unsuspend=null,p()}}}var gE=null;function AE(p,g){p.stylesheets=null,p.unsuspend!==null&&(p.count++,gE=new Map,g.forEach(Yce,p),gE=null,mE.call(p))}function Yce(p,g){if(!(g.state.loading&4)){var S=gE.get(p);if(S)var R=S.get(null);else{S=new Map,gE.set(p,S);for(var z=p.querySelectorAll("link[data-precedence],style[data-precedence]"),W=0;W<z.length;W++){var re=z[W];(re.nodeName==="LINK"||re.getAttribute("media")!=="not all")&&(S.set(re.dataset.precedence,re),R=re)}R&&S.set(null,R)}z=g.instance,re=z.getAttribute("data-precedence"),W=S.get(re)||R,W===R&&S.set(null,z),S.set(re,z),this.count++,R=mE.bind(this),z.addEventListener("load",R),z.addEventListener("error",R),W?W.parentNode.insertBefore(z,W.nextSibling):(p=p.nodeType===9?p.head:p,p.insertBefore(z,p.firstChild)),g.state.loading|=4}}var Ib={$$typeof:I,Provider:null,Consumer:null,_currentValue:ue,_currentValue2:ue,_threadCount:0};function Xce(p,g,S,R,z,W,re,we,He){this.tag=1,this.containerInfo=p,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ta(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ta(0),this.hiddenUpdates=Ta(null),this.identifierPrefix=R,this.onUncaughtError=z,this.onCaughtError=W,this.onRecoverableError=re,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=He,this.incompleteTransitions=new Map}function xV(p,g,S,R,z,W,re,we,He,xt,Ft,Wt){return p=new Xce(p,g,S,re,He,xt,Ft,Wt,we),g=1,W===!0&&(g|=24),W=Wo(3,null,null,g),p.current=W,W.stateNode=p,g=$s(),g.refCount++,p.pooledCache=g,g.refCount++,W.memoizedState={element:R,isDehydrated:S,cache:g},Oe(W),p}function bV(p){return p?(p=fp,p):fp}function SV(p,g,S,R,z,W){z=bV(z),R.context===null?R.context=z:R.pendingContext=z,R=nt(g),R.payload={element:S},W=W===void 0?null:W,W!==null&&(R.callback=W),S=At(p,R,g),S!==null&&(tc(S,p,g),ut(S,p,g))}function TV(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var S=p.retryLane;p.retryLane=S!==0&&S<g?S:g}}function kL(p,g){TV(p,g),(p=p.alternate)&&TV(p,g)}function wV(p){if(p.tag===13||p.tag===31){var g=hp(p,67108864);g!==null&&tc(g,p,67108864),kL(p,67108864)}}function EV(p){if(p.tag===13||p.tag===31){var g=Hc();g=Ut(g);var S=hp(p,g);S!==null&&tc(S,p,g),kL(p,g)}}var yE=!0;function Qce(p,g,S,R){var z=Q.T;Q.T=null;var W=Y.p;try{Y.p=2,OL(p,g,S,R)}finally{Y.p=W,Q.T=z}}function Jce(p,g,S,R){var z=Q.T;Q.T=null;var W=Y.p;try{Y.p=8,OL(p,g,S,R)}finally{Y.p=W,Q.T=z}}function OL(p,g,S,R){if(yE){var z=FL(R);if(z===null)bL(p,g,R,vE,S),CV(p,R);else if(eue(z,p,g,S,R))R.stopPropagation();else if(CV(p,R),g&4&&-1<Zce.indexOf(p)){for(;z!==null;){var W=ts(z);if(W!==null)switch(W.tag){case 3:if(W=W.stateNode,W.current.memoizedState.isDehydrated){var re=zt(W.pendingLanes);if(re!==0){var we=W;for(we.pendingLanes|=2,we.entangledLanes|=2;re;){var He=1<<31-kt(re);we.entanglements[1]|=He,re&=~He}vh(W),(Ni&6)===0&&(tE=le()+500,Eb(0))}}break;case 31:case 13:we=hp(W,2),we!==null&&tc(we,W,2),aE(),kL(W,2)}if(W=FL(R),W===null&&bL(p,g,R,vE,S),W===z)break;z=W}z!==null&&R.stopPropagation()}else bL(p,g,R,null,S)}}function FL(p){return p=zl(p),jL(p)}var vE=null;function jL(p){if(vE=null,p=Uo(p),p!==null){var g=r(p);if(g===null)p=null;else{var S=g.tag;if(S===13){if(p=o(g),p!==null)return p;p=null}else if(S===31){if(p=l(g),p!==null)return p;p=null}else if(S===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;p=null}else g!==p&&(p=null)}}return vE=p,null}function MV(p){switch(p){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ge()){case tt:return 2;case pt:return 8;case Te:case st:return 32;case mt:return 268435456;default:return 32}default:return 32}}var BL=!1,Jm=null,Zm=null,eg=null,Lb=new Map,Db=new Map,tg=[],Zce="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function CV(p,g){switch(p){case"focusin":case"focusout":Jm=null;break;case"dragenter":case"dragleave":Zm=null;break;case"mouseover":case"mouseout":eg=null;break;case"pointerover":case"pointerout":Lb.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Db.delete(g.pointerId)}}function kb(p,g,S,R,z,W){return p===null||p.nativeEvent!==W?(p={blockedOn:g,domEventName:S,eventSystemFlags:R,nativeEvent:W,targetContainers:[z]},g!==null&&(g=ts(g),g!==null&&wV(g)),p):(p.eventSystemFlags|=R,g=p.targetContainers,z!==null&&g.indexOf(z)===-1&&g.push(z),p)}function eue(p,g,S,R,z){switch(g){case"focusin":return Jm=kb(Jm,p,g,S,R,z),!0;case"dragenter":return Zm=kb(Zm,p,g,S,R,z),!0;case"mouseover":return eg=kb(eg,p,g,S,R,z),!0;case"pointerover":var W=z.pointerId;return Lb.set(W,kb(Lb.get(W)||null,p,g,S,R,z)),!0;case"gotpointercapture":return W=z.pointerId,Db.set(W,kb(Db.get(W)||null,p,g,S,R,z)),!0}return!1}function NV(p){var g=Uo(p.target);if(g!==null){var S=r(g);if(S!==null){if(g=S.tag,g===13){if(g=o(S),g!==null){p.blockedOn=g,Yn(p.priority,function(){EV(S)});return}}else if(g===31){if(g=l(S),g!==null){p.blockedOn=g,Yn(p.priority,function(){EV(S)});return}}else if(g===3&&S.stateNode.current.memoizedState.isDehydrated){p.blockedOn=S.tag===3?S.stateNode.containerInfo:null;return}}}p.blockedOn=null}function _E(p){if(p.blockedOn!==null)return!1;for(var g=p.targetContainers;0<g.length;){var S=FL(p.nativeEvent);if(S===null){S=p.nativeEvent;var R=new S.constructor(S.type,S);B0=R,S.target.dispatchEvent(R),B0=null}else return g=ts(S),g!==null&&wV(g),p.blockedOn=S,!1;g.shift()}return!0}function RV(p,g,S){_E(p)&&S.delete(g)}function tue(){BL=!1,Jm!==null&&_E(Jm)&&(Jm=null),Zm!==null&&_E(Zm)&&(Zm=null),eg!==null&&_E(eg)&&(eg=null),Lb.forEach(RV),Db.forEach(RV)}function xE(p,g){p.blockedOn===g&&(p.blockedOn=null,BL||(BL=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,tue)))}var bE=null;function PV(p){bE!==p&&(bE=p,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){bE===p&&(bE=null);for(var g=0;g<p.length;g+=3){var S=p[g],R=p[g+1],z=p[g+2];if(typeof R!="function"){if(jL(R||S)===null)continue;break}var W=ts(S);W!==null&&(p.splice(g,3),g-=3,FI(W,{pending:!0,data:z,method:S.method,action:R},R,z))}}))}function ev(p){function g(He){return xE(He,p)}Jm!==null&&xE(Jm,p),Zm!==null&&xE(Zm,p),eg!==null&&xE(eg,p),Lb.forEach(g),Db.forEach(g);for(var S=0;S<tg.length;S++){var R=tg[S];R.blockedOn===p&&(R.blockedOn=null)}for(;0<tg.length&&(S=tg[0],S.blockedOn===null);)NV(S),S.blockedOn===null&&tg.shift();if(S=(p.ownerDocument||p).$$reactFormReplay,S!=null)for(R=0;R<S.length;R+=3){var z=S[R],W=S[R+1],re=z[Ln]||null;if(typeof W=="function")re||PV(S);else if(re){var we=null;if(W&&W.hasAttribute("formAction")){if(z=W,re=W[Ln]||null)we=re.formAction;else if(jL(z)!==null)continue}else we=re.action;typeof we=="function"?S[R+1]=we:(S.splice(R,3),R-=3),PV(S)}}}function IV(){function p(W){W.canIntercept&&W.info==="react-transition"&&W.intercept({handler:function(){return new Promise(function(re){return z=re})},focusReset:"manual",scroll:"manual"})}function g(){z!==null&&(z(),z=null),R||setTimeout(S,20)}function S(){if(!R&&!navigation.transition){var W=navigation.currentEntry;W&&W.url!=null&&navigation.navigate(W.url,{state:W.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var R=!1,z=null;return navigation.addEventListener("navigate",p),navigation.addEventListener("navigatesuccess",g),navigation.addEventListener("navigateerror",g),setTimeout(S,100),function(){R=!0,navigation.removeEventListener("navigate",p),navigation.removeEventListener("navigatesuccess",g),navigation.removeEventListener("navigateerror",g),z!==null&&(z(),z=null)}}}function UL(p){this._internalRoot=p}SE.prototype.render=UL.prototype.render=function(p){var g=this._internalRoot;if(g===null)throw Error(i(409));var S=g.current,R=Hc();SV(S,R,p,g,null,null)},SE.prototype.unmount=UL.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var g=p.containerInfo;SV(p.current,2,null,p,null,null),aE(),g[oa]=null}};function SE(p){this._internalRoot=p}SE.prototype.unstable_scheduleHydration=function(p){if(p){var g=me();p={blockedOn:null,target:p,priority:g};for(var S=0;S<tg.length&&g!==0&&g<tg[S].priority;S++);tg.splice(S,0,p),S===0&&NV(p)}};var LV=e.version;if(LV!=="19.2.3")throw Error(i(527,LV,"19.2.3"));Y.findDOMNode=function(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(i(188)):(p=Object.keys(p).join(","),Error(i(268,p)));return p=u(g),p=p!==null?h(p):null,p=p===null?null:p.stateNode,p};var nue={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var TE=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!TE.isDisabled&&TE.supportsFiber)try{Xe=TE.inject(nue),ct=TE}catch{}}return Fb.createRoot=function(p,g){if(!s(p))throw Error(i(299));var S=!1,R="",z=UU,W=VU,re=zU;return g!=null&&(g.unstable_strictMode===!0&&(S=!0),g.identifierPrefix!==void 0&&(R=g.identifierPrefix),g.onUncaughtError!==void 0&&(z=g.onUncaughtError),g.onCaughtError!==void 0&&(W=g.onCaughtError),g.onRecoverableError!==void 0&&(re=g.onRecoverableError)),g=xV(p,1,!1,null,null,S,R,null,z,W,re,IV),p[oa]=g.current,xL(p),new UL(g)},Fb.hydrateRoot=function(p,g,S){if(!s(p))throw Error(i(299));var R=!1,z="",W=UU,re=VU,we=zU,He=null;return S!=null&&(S.unstable_strictMode===!0&&(R=!0),S.identifierPrefix!==void 0&&(z=S.identifierPrefix),S.onUncaughtError!==void 0&&(W=S.onUncaughtError),S.onCaughtError!==void 0&&(re=S.onCaughtError),S.onRecoverableError!==void 0&&(we=S.onRecoverableError),S.formState!==void 0&&(He=S.formState)),g=xV(p,1,!0,g,S??null,R,z,He,W,re,we,IV),g.context=bV(null),S=g.current,R=Hc(),R=Ut(R),z=nt(R),z.callback=null,At(S,z,R),S=R,g.current.lanes=S,Gs(g,S),vh(g),p[oa]=g.current,xL(p),new SE(g)},Fb.version="19.2.3",Fb}var GV;function hue(){if(GV)return GL.exports;GV=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),GL.exports=due(),GL.exports}var fue=hue();const pue="modulepreload",mue=function(a){return"/pcfutbol-web/"+a},qV={},Yh=function(e,n,i){let s=Promise.resolve();if(n&&n.length>0){let c=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");s=c(n.map(u=>{if(u=mue(u),u in qV)return;qV[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":pue,h||(m.as="script"),m.crossOrigin="",m.href=u,l&&m.setAttribute("nonce",l),document.head.appendChild(m),h)return new Promise((A,x)=>{m.addEventListener("load",A),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function r(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&r(l.reason);return e().catch(r)})},gue=()=>{};var HV={};const sX=function(a){const e=[];let n=0;for(let i=0;i<a.length;i++){let s=a.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&i+1<a.length&&(a.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(a.charCodeAt(++i)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Aue=function(a){const e=[];let n=0,i=0;for(;n<a.length;){const s=a[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=a[n++];e[i++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=a[n++],o=a[n++],l=a[n++],c=((s&7)<<18|(r&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const r=a[n++],o=a[n++];e[i++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return e.join("")},rX={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(a,e){if(!Array.isArray(a))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<a.length;s+=3){const r=a[s],o=s+1<a.length,l=o?a[s+1]:0,c=s+2<a.length,u=c?a[s+2]:0,h=r>>2,f=(r&3)<<4|l>>4;let m=(l&15)<<2|u>>6,A=u&63;c||(A=64,o||(m=64)),i.push(n[h],n[f],n[m],n[A])}return i.join("")},encodeString(a,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(a):this.encodeByteArray(sX(a),e)},decodeString(a,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(a):Aue(this.decodeStringToByteArray(a,e))},decodeStringToByteArray(a,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<a.length;){const r=n[a.charAt(s++)],l=s<a.length?n[a.charAt(s)]:0;++s;const u=s<a.length?n[a.charAt(s)]:64;++s;const f=s<a.length?n[a.charAt(s)]:64;if(++s,r==null||l==null||u==null||f==null)throw new yue;const m=r<<2|l>>4;if(i.push(m),u!==64){const A=l<<4&240|u>>2;if(i.push(A),f!==64){const x=u<<6&192|f;i.push(x)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let a=0;a<this.ENCODED_VALS.length;a++)this.byteToCharMap_[a]=this.ENCODED_VALS.charAt(a),this.charToByteMap_[this.byteToCharMap_[a]]=a,this.byteToCharMapWebSafe_[a]=this.ENCODED_VALS_WEBSAFE.charAt(a),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[a]]=a,a>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(a)]=a,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(a)]=a)}}};class yue extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vue=function(a){const e=sX(a);return rX.encodeByteArray(e,!0)},m3=function(a){return vue(a).replace(/\./g,"")},oX=function(a){try{return rX.decodeString(a,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function _ue(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const xue=()=>_ue().__FIREBASE_DEFAULTS__,bue=()=>{if(typeof process>"u"||typeof HV>"u")return;const a=HV.__FIREBASE_DEFAULTS__;if(a)return JSON.parse(a)},Sue=()=>{if(typeof document>"u")return;let a;try{a=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=a&&oX(a[1]);return e&&JSON.parse(e)},UR=()=>{try{return gue()||xue()||bue()||Sue()}catch(a){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${a}`);return}},lX=a=>UR()?.emulatorHosts?.[a],Tue=a=>{const e=lX(a);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},cX=()=>UR()?.config,uX=a=>UR()?.[`_${a}`];class wue{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function Tx(a){try{return(a.startsWith("http://")||a.startsWith("https://")?new URL(a).hostname:a).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dX(a){return(await fetch(a,{credentials:"include"})).ok}function Eue(a,e){if(a.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",s=a.iat||0,r=a.sub||a.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...a};return[m3(JSON.stringify(n)),m3(JSON.stringify(o)),""].join(".")}const Y2={};function Mue(){const a={prod:[],emulator:[]};for(const e of Object.keys(Y2))Y2[e]?a.emulator.push(e):a.prod.push(e);return a}function Cue(a){let e=document.getElementById(a),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",a),n=!0),{created:n,element:e}}let WV=!1;function hX(a,e){if(typeof window>"u"||typeof document>"u"||!Tx(window.location.host)||Y2[a]===e||Y2[a]||WV)return;Y2[a]=e;function n(m){return`__firebase__banner__${m}`}const i="__firebase__banner",r=Mue().prod.length>0;function o(){const m=document.getElementById(i);m&&m.remove()}function l(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,A){m.setAttribute("width","24"),m.setAttribute("id",A),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function u(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{WV=!0,o()},m}function h(m,A){m.setAttribute("id",A),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=Cue(i),A=n("text"),x=document.getElementById(A)||document.createElement("span"),T=n("learnmore"),E=document.getElementById(T)||document.createElement("a"),M=n("preprendIcon"),N=document.getElementById(M)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const I=m.element;l(I),h(E,T);const F=u();c(N,M),I.append(N,x,E,F),document.body.appendChild(I)}r?(x.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function ml(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Nue(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ml())}function Rue(){const a=UR()?.forceEnvironment;if(a==="node")return!0;if(a==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Pue(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Iue(){const a=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof a=="object"&&a.id!==void 0}function Lue(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Due(){const a=ml();return a.indexOf("MSIE ")>=0||a.indexOf("Trident/")>=0}function kue(){return!Rue()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Oue(){try{return typeof indexedDB=="object"}catch{return!1}}function Fue(){return new Promise((a,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),a(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(n){e(n)}})}const jue="FirebaseError";class Rm extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=jue,Object.setPrototypeOf(this,Rm.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_T.prototype.create)}}class _T{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},s=`${this.service}/${e}`,r=this.errors[e],o=r?Bue(r,i):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Rm(s,l,i)}}function Bue(a,e){return a.replace(Uue,(n,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const Uue=/\{\$([^}]+)}/g;function Vue(a){for(const e in a)if(Object.prototype.hasOwnProperty.call(a,e))return!1;return!0}function a0(a,e){if(a===e)return!0;const n=Object.keys(a),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const r=a[s],o=e[s];if($V(r)&&$V(o)){if(!a0(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!n.includes(s))return!1;return!0}function $V(a){return a!==null&&typeof a=="object"}function xT(a){const e=[];for(const[n,i]of Object.entries(a))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function M2(a){const e={};return a.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,r]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(r)}}),e}function C2(a){const e=a.indexOf("?");if(!e)return"";const n=a.indexOf("#",e);return a.substring(e,n>0?n:void 0)}function zue(a,e){const n=new Gue(a,e);return n.subscribe.bind(n)}class Gue{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let s;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");que(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:i},s.next===void 0&&(s.next=$L),s.error===void 0&&(s.error=$L),s.complete===void 0&&(s.complete=$L);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function que(a,e){if(typeof a!="object"||a===null)return!1;for(const n of e)if(n in a&&typeof a[n]=="function")return!0;return!1}function $L(){}function nr(a){return a&&a._delegate?a._delegate:a}class sy{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const MA="[DEFAULT]";class Hue{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new wue;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($ue(e))try{this.getOrInitializeService({instanceIdentifier:MA})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(e=MA){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=MA){return this.instances.has(e)}getOptions(e=MA){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[r,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(r);i===l&&o.resolve(s)}return s}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(i)??new Set;s.add(e),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&e(r,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const s of i)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Wue(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=MA){return this.component?this.component.multipleInstances?e:MA:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Wue(a){return a===MA?void 0:a}function $ue(a){return a.instantiationMode==="EAGER"}class Kue{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Hue(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var ri;(function(a){a[a.DEBUG=0]="DEBUG",a[a.VERBOSE=1]="VERBOSE",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.SILENT=5]="SILENT"})(ri||(ri={}));const Yue={debug:ri.DEBUG,verbose:ri.VERBOSE,info:ri.INFO,warn:ri.WARN,error:ri.ERROR,silent:ri.SILENT},Xue=ri.INFO,Que={[ri.DEBUG]:"log",[ri.VERBOSE]:"log",[ri.INFO]:"info",[ri.WARN]:"warn",[ri.ERROR]:"error"},Jue=(a,e,...n)=>{if(e<a.logLevel)return;const i=new Date().toISOString(),s=Que[e];if(s)console[s](`[${i}]  ${a.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let m8=class{constructor(e){this.name=e,this._logLevel=Xue,this._logHandler=Jue,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ri))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Yue[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ri.DEBUG,...e),this._logHandler(this,ri.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ri.VERBOSE,...e),this._logHandler(this,ri.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ri.INFO,...e),this._logHandler(this,ri.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ri.WARN,...e),this._logHandler(this,ri.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ri.ERROR,...e),this._logHandler(this,ri.ERROR,...e)}};const Zue=(a,e)=>e.some(n=>a instanceof n);let KV,YV;function ede(){return KV||(KV=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tde(){return YV||(YV=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const fX=new WeakMap,b6=new WeakMap,pX=new WeakMap,KL=new WeakMap,g8=new WeakMap;function nde(a){const e=new Promise((n,i)=>{const s=()=>{a.removeEventListener("success",r),a.removeEventListener("error",o)},r=()=>{n(qg(a.result)),s()},o=()=>{i(a.error),s()};a.addEventListener("success",r),a.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&fX.set(n,a)}).catch(()=>{}),g8.set(e,a),e}function ade(a){if(b6.has(a))return;const e=new Promise((n,i)=>{const s=()=>{a.removeEventListener("complete",r),a.removeEventListener("error",o),a.removeEventListener("abort",o)},r=()=>{n(),s()},o=()=>{i(a.error||new DOMException("AbortError","AbortError")),s()};a.addEventListener("complete",r),a.addEventListener("error",o),a.addEventListener("abort",o)});b6.set(a,e)}let S6={get(a,e,n){if(a instanceof IDBTransaction){if(e==="done")return b6.get(a);if(e==="objectStoreNames")return a.objectStoreNames||pX.get(a);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return qg(a[e])},set(a,e,n){return a[e]=n,!0},has(a,e){return a instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in a}};function ide(a){S6=a(S6)}function sde(a){return a===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=a.call(YL(this),e,...n);return pX.set(i,e.sort?e.sort():[e]),qg(i)}:tde().includes(a)?function(...e){return a.apply(YL(this),e),qg(fX.get(this))}:function(...e){return qg(a.apply(YL(this),e))}}function rde(a){return typeof a=="function"?sde(a):(a instanceof IDBTransaction&&ade(a),Zue(a,ede())?new Proxy(a,S6):a)}function qg(a){if(a instanceof IDBRequest)return nde(a);if(KL.has(a))return KL.get(a);const e=rde(a);return e!==a&&(KL.set(a,e),g8.set(e,a)),e}const YL=a=>g8.get(a);function ode(a,e,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(a,e),l=qg(o);return i&&o.addEventListener("upgradeneeded",c=>{i(qg(o.result),c.oldVersion,c.newVersion,qg(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{r&&c.addEventListener("close",()=>r()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const lde=["get","getKey","getAll","getAllKeys","count"],cde=["put","add","delete","clear"],XL=new Map;function XV(a,e){if(!(a instanceof IDBDatabase&&!(e in a)&&typeof e=="string"))return;if(XL.get(e))return XL.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=cde.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(s||lde.includes(n)))return;const r=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return i&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return XL.set(e,r),r}ide(a=>({...a,get:(e,n,i)=>XV(e,n)||a.get(e,n,i),has:(e,n)=>!!XV(e,n)||a.has(e,n)}));class ude{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(dde(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function dde(a){return a.getComponent()?.type==="VERSION"}const T6="@firebase/app",QV="0.14.7";const cm=new m8("@firebase/app"),hde="@firebase/app-compat",fde="@firebase/analytics-compat",pde="@firebase/analytics",mde="@firebase/app-check-compat",gde="@firebase/app-check",Ade="@firebase/auth",yde="@firebase/auth-compat",vde="@firebase/database",_de="@firebase/data-connect",xde="@firebase/database-compat",bde="@firebase/functions",Sde="@firebase/functions-compat",Tde="@firebase/installations",wde="@firebase/installations-compat",Ede="@firebase/messaging",Mde="@firebase/messaging-compat",Cde="@firebase/performance",Nde="@firebase/performance-compat",Rde="@firebase/remote-config",Pde="@firebase/remote-config-compat",Ide="@firebase/storage",Lde="@firebase/storage-compat",Dde="@firebase/firestore",kde="@firebase/ai",Ode="@firebase/firestore-compat",Fde="firebase",jde="12.8.0";const w6="[DEFAULT]",Bde={[T6]:"fire-core",[hde]:"fire-core-compat",[pde]:"fire-analytics",[fde]:"fire-analytics-compat",[gde]:"fire-app-check",[mde]:"fire-app-check-compat",[Ade]:"fire-auth",[yde]:"fire-auth-compat",[vde]:"fire-rtdb",[_de]:"fire-data-connect",[xde]:"fire-rtdb-compat",[bde]:"fire-fn",[Sde]:"fire-fn-compat",[Tde]:"fire-iid",[wde]:"fire-iid-compat",[Ede]:"fire-fcm",[Mde]:"fire-fcm-compat",[Cde]:"fire-perf",[Nde]:"fire-perf-compat",[Rde]:"fire-rc",[Pde]:"fire-rc-compat",[Ide]:"fire-gcs",[Lde]:"fire-gcs-compat",[Dde]:"fire-fst",[Ode]:"fire-fst-compat",[kde]:"fire-vertex","fire-js":"fire-js",[Fde]:"fire-js-all"};const g3=new Map,Ude=new Map,E6=new Map;function JV(a,e){try{a.container.addComponent(e)}catch(n){cm.debug(`Component ${e.name} failed to register with FirebaseApp ${a.name}`,n)}}function L_(a){const e=a.name;if(E6.has(e))return cm.debug(`There were multiple attempts to register component ${e}.`),!1;E6.set(e,a);for(const n of g3.values())JV(n,a);for(const n of Ude.values())JV(n,a);return!0}function A8(a,e){const n=a.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),a.container.getProvider(e)}function cc(a){return a==null?!1:a.settings!==void 0}const Vde={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Hg=new _T("app","Firebase",Vde);class zde{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new sy("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Hg.create("app-deleted",{appName:this._name})}}const wx=jde;function mX(a,e={}){let n=a;typeof e!="object"&&(e={name:e});const i={name:w6,automaticDataCollectionEnabled:!0,...e},s=i.name;if(typeof s!="string"||!s)throw Hg.create("bad-app-name",{appName:String(s)});if(n||(n=cX()),!n)throw Hg.create("no-options");const r=g3.get(s);if(r){if(a0(n,r.options)&&a0(i,r.config))return r;throw Hg.create("duplicate-app",{appName:s})}const o=new Kue(s);for(const c of E6.values())o.addComponent(c);const l=new zde(n,i,o);return g3.set(s,l),l}function gX(a=w6){const e=g3.get(a);if(!e&&a===w6&&cX())return mX();if(!e)throw Hg.create("no-app",{appName:a});return e}function Wg(a,e,n){let i=Bde[a]??a;n&&(i+=`-${n}`);const s=i.match(/\s|\//),r=e.match(/\s|\//);if(s||r){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&r&&o.push("and"),r&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),cm.warn(o.join(" "));return}L_(new sy(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const Gde="firebase-heartbeat-database",qde=1,SS="firebase-heartbeat-store";let QL=null;function AX(){return QL||(QL=ode(Gde,qde,{upgrade:(a,e)=>{switch(e){case 0:try{a.createObjectStore(SS)}catch(n){console.warn(n)}}}}).catch(a=>{throw Hg.create("idb-open",{originalErrorMessage:a.message})})),QL}async function Hde(a){try{const n=(await AX()).transaction(SS),i=await n.objectStore(SS).get(yX(a));return await n.done,i}catch(e){if(e instanceof Rm)cm.warn(e.message);else{const n=Hg.create("idb-get",{originalErrorMessage:e?.message});cm.warn(n.message)}}}async function ZV(a,e){try{const i=(await AX()).transaction(SS,"readwrite");await i.objectStore(SS).put(e,yX(a)),await i.done}catch(n){if(n instanceof Rm)cm.warn(n.message);else{const i=Hg.create("idb-set",{originalErrorMessage:n?.message});cm.warn(i.message)}}}function yX(a){return`${a.name}!${a.options.appId}`}const Wde=1024,$de=30;class Kde{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Xde(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ez();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(s=>s.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>$de){const s=Qde(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){cm.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=ez(),{heartbeatsToSend:n,unsentEntries:i}=Yde(this._heartbeatsCache.heartbeats),s=m3(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return cm.warn(e),""}}}function ez(){return new Date().toISOString().substring(0,10)}function Yde(a,e=Wde){const n=[];let i=a.slice();for(const s of a){const r=n.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),tz(n)>e){r.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),tz(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class Xde{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Oue()?Fue().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Hde(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return ZV(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return ZV(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function tz(a){return m3(JSON.stringify({version:2,heartbeats:a})).length}function Qde(a){if(a.length===0)return-1;let e=0,n=a[0].date;for(let i=1;i<a.length;i++)a[i].date<n&&(n=a[i].date,e=i);return e}function Jde(a){L_(new sy("platform-logger",e=>new ude(e),"PRIVATE")),L_(new sy("heartbeat",e=>new Kde(e),"PRIVATE")),Wg(T6,QV,a),Wg(T6,QV,"esm2020"),Wg("fire-js","")}Jde("");var Zde="firebase",ehe="12.8.0";Wg(Zde,ehe,"app");var nz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var $g,vX;(function(){var a;function e(D,j){function L(){}L.prototype=j.prototype,D.F=j.prototype,D.prototype=new L,D.prototype.constructor=D,D.D=function(U,q,K){for(var H=Array(arguments.length-2),X=2;X<arguments.length;X++)H[X-2]=arguments[X];return j.prototype[q].apply(U,H)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(D,j,L){L||(L=0);const U=Array(16);if(typeof j=="string")for(var q=0;q<16;++q)U[q]=j.charCodeAt(L++)|j.charCodeAt(L++)<<8|j.charCodeAt(L++)<<16|j.charCodeAt(L++)<<24;else for(q=0;q<16;++q)U[q]=j[L++]|j[L++]<<8|j[L++]<<16|j[L++]<<24;j=D.g[0],L=D.g[1],q=D.g[2];let K=D.g[3],H;H=j+(K^L&(q^K))+U[0]+3614090360&4294967295,j=L+(H<<7&4294967295|H>>>25),H=K+(q^j&(L^q))+U[1]+3905402710&4294967295,K=j+(H<<12&4294967295|H>>>20),H=q+(L^K&(j^L))+U[2]+606105819&4294967295,q=K+(H<<17&4294967295|H>>>15),H=L+(j^q&(K^j))+U[3]+3250441966&4294967295,L=q+(H<<22&4294967295|H>>>10),H=j+(K^L&(q^K))+U[4]+4118548399&4294967295,j=L+(H<<7&4294967295|H>>>25),H=K+(q^j&(L^q))+U[5]+1200080426&4294967295,K=j+(H<<12&4294967295|H>>>20),H=q+(L^K&(j^L))+U[6]+2821735955&4294967295,q=K+(H<<17&4294967295|H>>>15),H=L+(j^q&(K^j))+U[7]+4249261313&4294967295,L=q+(H<<22&4294967295|H>>>10),H=j+(K^L&(q^K))+U[8]+1770035416&4294967295,j=L+(H<<7&4294967295|H>>>25),H=K+(q^j&(L^q))+U[9]+2336552879&4294967295,K=j+(H<<12&4294967295|H>>>20),H=q+(L^K&(j^L))+U[10]+4294925233&4294967295,q=K+(H<<17&4294967295|H>>>15),H=L+(j^q&(K^j))+U[11]+2304563134&4294967295,L=q+(H<<22&4294967295|H>>>10),H=j+(K^L&(q^K))+U[12]+1804603682&4294967295,j=L+(H<<7&4294967295|H>>>25),H=K+(q^j&(L^q))+U[13]+4254626195&4294967295,K=j+(H<<12&4294967295|H>>>20),H=q+(L^K&(j^L))+U[14]+2792965006&4294967295,q=K+(H<<17&4294967295|H>>>15),H=L+(j^q&(K^j))+U[15]+1236535329&4294967295,L=q+(H<<22&4294967295|H>>>10),H=j+(q^K&(L^q))+U[1]+4129170786&4294967295,j=L+(H<<5&4294967295|H>>>27),H=K+(L^q&(j^L))+U[6]+3225465664&4294967295,K=j+(H<<9&4294967295|H>>>23),H=q+(j^L&(K^j))+U[11]+643717713&4294967295,q=K+(H<<14&4294967295|H>>>18),H=L+(K^j&(q^K))+U[0]+3921069994&4294967295,L=q+(H<<20&4294967295|H>>>12),H=j+(q^K&(L^q))+U[5]+3593408605&4294967295,j=L+(H<<5&4294967295|H>>>27),H=K+(L^q&(j^L))+U[10]+38016083&4294967295,K=j+(H<<9&4294967295|H>>>23),H=q+(j^L&(K^j))+U[15]+3634488961&4294967295,q=K+(H<<14&4294967295|H>>>18),H=L+(K^j&(q^K))+U[4]+3889429448&4294967295,L=q+(H<<20&4294967295|H>>>12),H=j+(q^K&(L^q))+U[9]+568446438&4294967295,j=L+(H<<5&4294967295|H>>>27),H=K+(L^q&(j^L))+U[14]+3275163606&4294967295,K=j+(H<<9&4294967295|H>>>23),H=q+(j^L&(K^j))+U[3]+4107603335&4294967295,q=K+(H<<14&4294967295|H>>>18),H=L+(K^j&(q^K))+U[8]+1163531501&4294967295,L=q+(H<<20&4294967295|H>>>12),H=j+(q^K&(L^q))+U[13]+2850285829&4294967295,j=L+(H<<5&4294967295|H>>>27),H=K+(L^q&(j^L))+U[2]+4243563512&4294967295,K=j+(H<<9&4294967295|H>>>23),H=q+(j^L&(K^j))+U[7]+1735328473&4294967295,q=K+(H<<14&4294967295|H>>>18),H=L+(K^j&(q^K))+U[12]+2368359562&4294967295,L=q+(H<<20&4294967295|H>>>12),H=j+(L^q^K)+U[5]+4294588738&4294967295,j=L+(H<<4&4294967295|H>>>28),H=K+(j^L^q)+U[8]+2272392833&4294967295,K=j+(H<<11&4294967295|H>>>21),H=q+(K^j^L)+U[11]+1839030562&4294967295,q=K+(H<<16&4294967295|H>>>16),H=L+(q^K^j)+U[14]+4259657740&4294967295,L=q+(H<<23&4294967295|H>>>9),H=j+(L^q^K)+U[1]+2763975236&4294967295,j=L+(H<<4&4294967295|H>>>28),H=K+(j^L^q)+U[4]+1272893353&4294967295,K=j+(H<<11&4294967295|H>>>21),H=q+(K^j^L)+U[7]+4139469664&4294967295,q=K+(H<<16&4294967295|H>>>16),H=L+(q^K^j)+U[10]+3200236656&4294967295,L=q+(H<<23&4294967295|H>>>9),H=j+(L^q^K)+U[13]+681279174&4294967295,j=L+(H<<4&4294967295|H>>>28),H=K+(j^L^q)+U[0]+3936430074&4294967295,K=j+(H<<11&4294967295|H>>>21),H=q+(K^j^L)+U[3]+3572445317&4294967295,q=K+(H<<16&4294967295|H>>>16),H=L+(q^K^j)+U[6]+76029189&4294967295,L=q+(H<<23&4294967295|H>>>9),H=j+(L^q^K)+U[9]+3654602809&4294967295,j=L+(H<<4&4294967295|H>>>28),H=K+(j^L^q)+U[12]+3873151461&4294967295,K=j+(H<<11&4294967295|H>>>21),H=q+(K^j^L)+U[15]+530742520&4294967295,q=K+(H<<16&4294967295|H>>>16),H=L+(q^K^j)+U[2]+3299628645&4294967295,L=q+(H<<23&4294967295|H>>>9),H=j+(q^(L|~K))+U[0]+4096336452&4294967295,j=L+(H<<6&4294967295|H>>>26),H=K+(L^(j|~q))+U[7]+1126891415&4294967295,K=j+(H<<10&4294967295|H>>>22),H=q+(j^(K|~L))+U[14]+2878612391&4294967295,q=K+(H<<15&4294967295|H>>>17),H=L+(K^(q|~j))+U[5]+4237533241&4294967295,L=q+(H<<21&4294967295|H>>>11),H=j+(q^(L|~K))+U[12]+1700485571&4294967295,j=L+(H<<6&4294967295|H>>>26),H=K+(L^(j|~q))+U[3]+2399980690&4294967295,K=j+(H<<10&4294967295|H>>>22),H=q+(j^(K|~L))+U[10]+4293915773&4294967295,q=K+(H<<15&4294967295|H>>>17),H=L+(K^(q|~j))+U[1]+2240044497&4294967295,L=q+(H<<21&4294967295|H>>>11),H=j+(q^(L|~K))+U[8]+1873313359&4294967295,j=L+(H<<6&4294967295|H>>>26),H=K+(L^(j|~q))+U[15]+4264355552&4294967295,K=j+(H<<10&4294967295|H>>>22),H=q+(j^(K|~L))+U[6]+2734768916&4294967295,q=K+(H<<15&4294967295|H>>>17),H=L+(K^(q|~j))+U[13]+1309151649&4294967295,L=q+(H<<21&4294967295|H>>>11),H=j+(q^(L|~K))+U[4]+4149444226&4294967295,j=L+(H<<6&4294967295|H>>>26),H=K+(L^(j|~q))+U[11]+3174756917&4294967295,K=j+(H<<10&4294967295|H>>>22),H=q+(j^(K|~L))+U[2]+718787259&4294967295,q=K+(H<<15&4294967295|H>>>17),H=L+(K^(q|~j))+U[9]+3951481745&4294967295,D.g[0]=D.g[0]+j&4294967295,D.g[1]=D.g[1]+(q+(H<<21&4294967295|H>>>11))&4294967295,D.g[2]=D.g[2]+q&4294967295,D.g[3]=D.g[3]+K&4294967295}i.prototype.v=function(D,j){j===void 0&&(j=D.length);const L=j-this.blockSize,U=this.C;let q=this.h,K=0;for(;K<j;){if(q==0)for(;K<=L;)s(this,D,K),K+=this.blockSize;if(typeof D=="string"){for(;K<j;)if(U[q++]=D.charCodeAt(K++),q==this.blockSize){s(this,U),q=0;break}}else for(;K<j;)if(U[q++]=D[K++],q==this.blockSize){s(this,U),q=0;break}}this.h=q,this.o+=j},i.prototype.A=function(){var D=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);D[0]=128;for(var j=1;j<D.length-8;++j)D[j]=0;j=this.o*8;for(var L=D.length-8;L<D.length;++L)D[L]=j&255,j/=256;for(this.v(D),D=Array(16),j=0,L=0;L<4;++L)for(let U=0;U<32;U+=8)D[j++]=this.g[L]>>>U&255;return D};function r(D,j){var L=l;return Object.prototype.hasOwnProperty.call(L,D)?L[D]:L[D]=j(D)}function o(D,j){this.h=j;const L=[];let U=!0;for(let q=D.length-1;q>=0;q--){const K=D[q]|0;U&&K==j||(L[q]=K,U=!1)}this.g=L}var l={};function c(D){return-128<=D&&D<128?r(D,function(j){return new o([j|0],j<0?-1:0)}):new o([D|0],D<0?-1:0)}function u(D){if(isNaN(D)||!isFinite(D))return f;if(D<0)return E(u(-D));const j=[];let L=1;for(let U=0;D>=L;U++)j[U]=D/L|0,L*=4294967296;return new o(j,0)}function h(D,j){if(D.length==0)throw Error("number format error: empty string");if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(D.charAt(0)=="-")return E(h(D.substring(1),j));if(D.indexOf("-")>=0)throw Error('number format error: interior "-" character');const L=u(Math.pow(j,8));let U=f;for(let K=0;K<D.length;K+=8){var q=Math.min(8,D.length-K);const H=parseInt(D.substring(K,K+q),j);q<8?(q=u(Math.pow(j,q)),U=U.j(q).add(u(H))):(U=U.j(L),U=U.add(u(H)))}return U}var f=c(0),m=c(1),A=c(16777216);a=o.prototype,a.m=function(){if(T(this))return-E(this).m();let D=0,j=1;for(let L=0;L<this.g.length;L++){const U=this.i(L);D+=(U>=0?U:4294967296+U)*j,j*=4294967296}return D},a.toString=function(D){if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(x(this))return"0";if(T(this))return"-"+E(this).toString(D);const j=u(Math.pow(D,6));var L=this;let U="";for(;;){const q=F(L,j).g;L=M(L,q.j(j));let K=((L.g.length>0?L.g[0]:L.h)>>>0).toString(D);if(L=q,x(L))return K+U;for(;K.length<6;)K="0"+K;U=K+U}},a.i=function(D){return D<0?0:D<this.g.length?this.g[D]:this.h};function x(D){if(D.h!=0)return!1;for(let j=0;j<D.g.length;j++)if(D.g[j]!=0)return!1;return!0}function T(D){return D.h==-1}a.l=function(D){return D=M(this,D),T(D)?-1:x(D)?0:1};function E(D){const j=D.g.length,L=[];for(let U=0;U<j;U++)L[U]=~D.g[U];return new o(L,~D.h).add(m)}a.abs=function(){return T(this)?E(this):this},a.add=function(D){const j=Math.max(this.g.length,D.g.length),L=[];let U=0;for(let q=0;q<=j;q++){let K=U+(this.i(q)&65535)+(D.i(q)&65535),H=(K>>>16)+(this.i(q)>>>16)+(D.i(q)>>>16);U=H>>>16,K&=65535,H&=65535,L[q]=H<<16|K}return new o(L,L[L.length-1]&-2147483648?-1:0)};function M(D,j){return D.add(E(j))}a.j=function(D){if(x(this)||x(D))return f;if(T(this))return T(D)?E(this).j(E(D)):E(E(this).j(D));if(T(D))return E(this.j(E(D)));if(this.l(A)<0&&D.l(A)<0)return u(this.m()*D.m());const j=this.g.length+D.g.length,L=[];for(var U=0;U<2*j;U++)L[U]=0;for(U=0;U<this.g.length;U++)for(let q=0;q<D.g.length;q++){const K=this.i(U)>>>16,H=this.i(U)&65535,X=D.i(q)>>>16,ne=D.i(q)&65535;L[2*U+2*q]+=H*ne,N(L,2*U+2*q),L[2*U+2*q+1]+=K*ne,N(L,2*U+2*q+1),L[2*U+2*q+1]+=H*X,N(L,2*U+2*q+1),L[2*U+2*q+2]+=K*X,N(L,2*U+2*q+2)}for(D=0;D<j;D++)L[D]=L[2*D+1]<<16|L[2*D];for(D=j;D<2*j;D++)L[D]=0;return new o(L,0)};function N(D,j){for(;(D[j]&65535)!=D[j];)D[j+1]+=D[j]>>>16,D[j]&=65535,j++}function I(D,j){this.g=D,this.h=j}function F(D,j){if(x(j))throw Error("division by zero");if(x(D))return new I(f,f);if(T(D))return j=F(E(D),j),new I(E(j.g),E(j.h));if(T(j))return j=F(D,E(j)),new I(E(j.g),j.h);if(D.g.length>30){if(T(D)||T(j))throw Error("slowDivide_ only works with positive integers.");for(var L=m,U=j;U.l(D)<=0;)L=G(L),U=G(U);var q=O(L,1),K=O(U,1);for(U=O(U,2),L=O(L,2);!x(U);){var H=K.add(U);H.l(D)<=0&&(q=q.add(L),K=H),U=O(U,1),L=O(L,1)}return j=M(D,q.j(j)),new I(q,j)}for(q=f;D.l(j)>=0;){for(L=Math.max(1,Math.floor(D.m()/j.m())),U=Math.ceil(Math.log(L)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),K=u(L),H=K.j(j);T(H)||H.l(D)>0;)L-=U,K=u(L),H=K.j(j);x(K)&&(K=m),q=q.add(K),D=M(D,H)}return new I(q,D)}a.B=function(D){return F(this,D).h},a.and=function(D){const j=Math.max(this.g.length,D.g.length),L=[];for(let U=0;U<j;U++)L[U]=this.i(U)&D.i(U);return new o(L,this.h&D.h)},a.or=function(D){const j=Math.max(this.g.length,D.g.length),L=[];for(let U=0;U<j;U++)L[U]=this.i(U)|D.i(U);return new o(L,this.h|D.h)},a.xor=function(D){const j=Math.max(this.g.length,D.g.length),L=[];for(let U=0;U<j;U++)L[U]=this.i(U)^D.i(U);return new o(L,this.h^D.h)};function G(D){const j=D.g.length+1,L=[];for(let U=0;U<j;U++)L[U]=D.i(U)<<1|D.i(U-1)>>>31;return new o(L,D.h)}function O(D,j){const L=j>>5;j%=32;const U=D.g.length-L,q=[];for(let K=0;K<U;K++)q[K]=j>0?D.i(K+L)>>>j|D.i(K+L+1)<<32-j:D.i(K+L);return new o(q,D.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,vX=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,$g=o}).apply(typeof nz<"u"?nz:typeof self<"u"?self:typeof window<"u"?window:{});var wE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var _X,N2,xX,DC,M6,bX,SX,TX;(function(){var a,e=Object.defineProperty;function n(B){B=[typeof globalThis=="object"&&globalThis,B,typeof window=="object"&&window,typeof self=="object"&&self,typeof wE=="object"&&wE];for(var ee=0;ee<B.length;++ee){var he=B[ee];if(he&&he.Math==Math)return he}throw Error("Cannot find global object")}var i=n(this);function s(B,ee){if(ee)e:{var he=i;B=B.split(".");for(var Pe=0;Pe<B.length-1;Pe++){var gt=B[Pe];if(!(gt in he))break e;he=he[gt]}B=B[B.length-1],Pe=he[B],ee=ee(Pe),ee!=Pe&&ee!=null&&e(he,B,{configurable:!0,writable:!0,value:ee})}}s("Symbol.dispose",function(B){return B||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(B){return B||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(B){return B||function(ee){var he=[],Pe;for(Pe in ee)Object.prototype.hasOwnProperty.call(ee,Pe)&&he.push([Pe,ee[Pe]]);return he}});var r=r||{},o=this||self;function l(B){var ee=typeof B;return ee=="object"&&B!=null||ee=="function"}function c(B,ee,he){return B.call.apply(B.bind,arguments)}function u(B,ee,he){return u=c,u.apply(null,arguments)}function h(B,ee){var he=Array.prototype.slice.call(arguments,1);return function(){var Pe=he.slice();return Pe.push.apply(Pe,arguments),B.apply(this,Pe)}}function f(B,ee){function he(){}he.prototype=ee.prototype,B.Z=ee.prototype,B.prototype=new he,B.prototype.constructor=B,B.Ob=function(Pe,gt,Ct){for(var cn=Array(arguments.length-2),Ea=2;Ea<arguments.length;Ea++)cn[Ea-2]=arguments[Ea];return ee.prototype[gt].apply(Pe,cn)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?B=>B&&AsyncContext.Snapshot.wrap(B):B=>B;function A(B){const ee=B.length;if(ee>0){const he=Array(ee);for(let Pe=0;Pe<ee;Pe++)he[Pe]=B[Pe];return he}return[]}function x(B,ee){for(let Pe=1;Pe<arguments.length;Pe++){const gt=arguments[Pe];var he=typeof gt;if(he=he!="object"?he:gt?Array.isArray(gt)?"array":he:"null",he=="array"||he=="object"&&typeof gt.length=="number"){he=B.length||0;const Ct=gt.length||0;B.length=he+Ct;for(let cn=0;cn<Ct;cn++)B[he+cn]=gt[cn]}else B.push(gt)}}class T{constructor(ee,he){this.i=ee,this.j=he,this.h=0,this.g=null}get(){let ee;return this.h>0?(this.h--,ee=this.g,this.g=ee.next,ee.next=null):ee=this.i(),ee}}function E(B){o.setTimeout(()=>{throw B},0)}function M(){var B=D;let ee=null;return B.g&&(ee=B.g,B.g=B.g.next,B.g||(B.h=null),ee.next=null),ee}class N{constructor(){this.h=this.g=null}add(ee,he){const Pe=I.get();Pe.set(ee,he),this.h?this.h.next=Pe:this.g=Pe,this.h=Pe}}var I=new T(()=>new F,B=>B.reset());class F{constructor(){this.next=this.g=this.h=null}set(ee,he){this.h=ee,this.g=he,this.next=null}reset(){this.next=this.g=this.h=null}}let G,O=!1,D=new N,j=()=>{const B=Promise.resolve(void 0);G=()=>{B.then(L)}};function L(){for(var B;B=M();){try{B.h.call(B.g)}catch(he){E(he)}var ee=I;ee.j(B),ee.h<100&&(ee.h++,B.next=ee.g,ee.g=B)}O=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(B,ee){this.type=B,this.g=this.target=ee,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var K=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var B=!1,ee=Object.defineProperty({},"passive",{get:function(){B=!0}});try{const he=()=>{};o.addEventListener("test",he,ee),o.removeEventListener("test",he,ee)}catch{}return B})();function H(B){return/^[\s\xa0]*$/.test(B)}function X(B,ee){q.call(this,B?B.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,B&&this.init(B,ee)}f(X,q),X.prototype.init=function(B,ee){const he=this.type=B.type,Pe=B.changedTouches&&B.changedTouches.length?B.changedTouches[0]:null;this.target=B.target||B.srcElement,this.g=ee,ee=B.relatedTarget,ee||(he=="mouseover"?ee=B.fromElement:he=="mouseout"&&(ee=B.toElement)),this.relatedTarget=ee,Pe?(this.clientX=Pe.clientX!==void 0?Pe.clientX:Pe.pageX,this.clientY=Pe.clientY!==void 0?Pe.clientY:Pe.pageY,this.screenX=Pe.screenX||0,this.screenY=Pe.screenY||0):(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0),this.button=B.button,this.key=B.key||"",this.ctrlKey=B.ctrlKey,this.altKey=B.altKey,this.shiftKey=B.shiftKey,this.metaKey=B.metaKey,this.pointerId=B.pointerId||0,this.pointerType=B.pointerType,this.state=B.state,this.i=B,B.defaultPrevented&&X.Z.h.call(this)},X.prototype.h=function(){X.Z.h.call(this);const B=this.i;B.preventDefault?B.preventDefault():B.returnValue=!1};var ne="closure_listenable_"+(Math.random()*1e6|0),Q=0;function Y(B,ee,he,Pe,gt){this.listener=B,this.proxy=null,this.src=ee,this.type=he,this.capture=!!Pe,this.ha=gt,this.key=++Q,this.da=this.fa=!1}function ue(B){B.da=!0,B.listener=null,B.proxy=null,B.src=null,B.ha=null}function pe(B,ee,he){for(const Pe in B)ee.call(he,B[Pe],Pe,B)}function Ee(B,ee){for(const he in B)ee.call(void 0,B[he],he,B)}function oe(B){const ee={};for(const he in B)ee[he]=B[he];return ee}const Ae="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function be(B,ee){let he,Pe;for(let gt=1;gt<arguments.length;gt++){Pe=arguments[gt];for(he in Pe)B[he]=Pe[he];for(let Ct=0;Ct<Ae.length;Ct++)he=Ae[Ct],Object.prototype.hasOwnProperty.call(Pe,he)&&(B[he]=Pe[he])}}function Ce(B){this.src=B,this.g={},this.h=0}Ce.prototype.add=function(B,ee,he,Pe,gt){const Ct=B.toString();B=this.g[Ct],B||(B=this.g[Ct]=[],this.h++);const cn=te(B,ee,Pe,gt);return cn>-1?(ee=B[cn],he||(ee.fa=!1)):(ee=new Y(ee,this.src,Ct,!!Pe,gt),ee.fa=he,B.push(ee)),ee};function ce(B,ee){const he=ee.type;if(he in B.g){var Pe=B.g[he],gt=Array.prototype.indexOf.call(Pe,ee,void 0),Ct;(Ct=gt>=0)&&Array.prototype.splice.call(Pe,gt,1),Ct&&(ue(ee),B.g[he].length==0&&(delete B.g[he],B.h--))}}function te(B,ee,he,Pe){for(let gt=0;gt<B.length;++gt){const Ct=B[gt];if(!Ct.da&&Ct.listener==ee&&Ct.capture==!!he&&Ct.ha==Pe)return gt}return-1}var fe="closure_lm_"+(Math.random()*1e6|0),Le={};function Fe(B,ee,he,Pe,gt){if(Array.isArray(ee)){for(let Ct=0;Ct<ee.length;Ct++)Fe(B,ee[Ct],he,Pe,gt);return null}return he=ve(he),B&&B[ne]?B.J(ee,he,l(Pe)?!!Pe.capture:!1,gt):Ie(B,ee,he,!1,Pe,gt)}function Ie(B,ee,he,Pe,gt,Ct){if(!ee)throw Error("Invalid event type");const cn=l(gt)?!!gt.capture:!!gt;let Ea=Je(B);if(Ea||(B[fe]=Ea=new Ce(B)),he=Ea.add(ee,he,Pe,cn,Ct),he.proxy)return he;if(Pe=at(),he.proxy=Pe,Pe.src=B,Pe.listener=he,B.addEventListener)K||(gt=cn),gt===void 0&&(gt=!1),B.addEventListener(ee.toString(),Pe,gt);else if(B.attachEvent)B.attachEvent(Me(ee.toString()),Pe);else if(B.addListener&&B.removeListener)B.addListener(Pe);else throw Error("addEventListener and attachEvent are unavailable.");return he}function at(){function B(he){return ee.call(B.src,B.listener,he)}const ee=ze;return B}function je(B,ee,he,Pe,gt){if(Array.isArray(ee))for(var Ct=0;Ct<ee.length;Ct++)je(B,ee[Ct],he,Pe,gt);else Pe=l(Pe)?!!Pe.capture:!!Pe,he=ve(he),B&&B[ne]?(B=B.i,Ct=String(ee).toString(),Ct in B.g&&(ee=B.g[Ct],he=te(ee,he,Pe,gt),he>-1&&(ue(ee[he]),Array.prototype.splice.call(ee,he,1),ee.length==0&&(delete B.g[Ct],B.h--)))):B&&(B=Je(B))&&(ee=B.g[ee.toString()],B=-1,ee&&(B=te(ee,he,Pe,gt)),(he=B>-1?ee[B]:null)&&Ve(he))}function Ve(B){if(typeof B!="number"&&B&&!B.da){var ee=B.src;if(ee&&ee[ne])ce(ee.i,B);else{var he=B.type,Pe=B.proxy;ee.removeEventListener?ee.removeEventListener(he,Pe,B.capture):ee.detachEvent?ee.detachEvent(Me(he),Pe):ee.addListener&&ee.removeListener&&ee.removeListener(Pe),(he=Je(ee))?(ce(he,B),he.h==0&&(he.src=null,ee[fe]=null)):ue(B)}}}function Me(B){return B in Le?Le[B]:Le[B]="on"+B}function ze(B,ee){if(B.da)B=!0;else{ee=new X(ee,this);const he=B.listener,Pe=B.ha||B.src;B.fa&&Ve(B),B=he.call(Pe,ee)}return B}function Je(B){return B=B[fe],B instanceof Ce?B:null}var rt="__closure_events_fn_"+(Math.random()*1e9>>>0);function ve(B){return typeof B=="function"?B:(B[rt]||(B[rt]=function(ee){return B.handleEvent(ee)}),B[rt])}function Ue(){U.call(this),this.i=new Ce(this),this.M=this,this.G=null}f(Ue,U),Ue.prototype[ne]=!0,Ue.prototype.removeEventListener=function(B,ee,he,Pe){je(this,B,ee,he,Pe)};function it(B,ee){var he,Pe=B.G;if(Pe)for(he=[];Pe;Pe=Pe.G)he.push(Pe);if(B=B.M,Pe=ee.type||ee,typeof ee=="string")ee=new q(ee,B);else if(ee instanceof q)ee.target=ee.target||B;else{var gt=ee;ee=new q(Pe,B),be(ee,gt)}gt=!0;let Ct,cn;if(he)for(cn=he.length-1;cn>=0;cn--)Ct=ee.g=he[cn],gt=wt(Ct,Pe,!0,ee)&&gt;if(Ct=ee.g=B,gt=wt(Ct,Pe,!0,ee)&&gt,gt=wt(Ct,Pe,!1,ee)&&gt,he)for(cn=0;cn<he.length;cn++)Ct=ee.g=he[cn],gt=wt(Ct,Pe,!1,ee)&&gt}Ue.prototype.N=function(){if(Ue.Z.N.call(this),this.i){var B=this.i;for(const ee in B.g){const he=B.g[ee];for(let Pe=0;Pe<he.length;Pe++)ue(he[Pe]);delete B.g[ee],B.h--}}this.G=null},Ue.prototype.J=function(B,ee,he,Pe){return this.i.add(String(B),ee,!1,he,Pe)},Ue.prototype.K=function(B,ee,he,Pe){return this.i.add(String(B),ee,!0,he,Pe)};function wt(B,ee,he,Pe){if(ee=B.i.g[String(ee)],!ee)return!0;ee=ee.concat();let gt=!0;for(let Ct=0;Ct<ee.length;++Ct){const cn=ee[Ct];if(cn&&!cn.da&&cn.capture==he){const Ea=cn.listener,Ds=cn.ha||cn.src;cn.fa&&ce(B.i,cn),gt=Ea.call(Ds,Pe)!==!1&&gt}}return gt&&!Pe.defaultPrevented}function Mt(B,ee){if(typeof B!="function")if(B&&typeof B.handleEvent=="function")B=u(B.handleEvent,B);else throw Error("Invalid listener argument");return Number(ee)>2147483647?-1:o.setTimeout(B,ee||0)}function _e(B){B.g=Mt(()=>{B.g=null,B.i&&(B.i=!1,_e(B))},B.l);const ee=B.h;B.h=null,B.m.apply(null,ee)}class le extends U{constructor(ee,he){super(),this.m=ee,this.l=he,this.h=null,this.i=!1,this.g=null}j(ee){this.h=arguments,this.g?this.i=!0:_e(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ge(B){U.call(this),this.h=B,this.g={}}f(Ge,U);var tt=[];function pt(B){pe(B.g,function(ee,he){this.g.hasOwnProperty(he)&&Ve(ee)},B),B.g={}}Ge.prototype.N=function(){Ge.Z.N.call(this),pt(this)},Ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Te=o.JSON.stringify,st=o.JSON.parse,mt=class{stringify(B){return o.JSON.stringify(B,void 0)}parse(B){return o.JSON.parse(B,void 0)}};function ht(){}function Qe(){}var Xe={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ct(){q.call(this,"d")}f(ct,q);function Tt(){q.call(this,"c")}f(Tt,q);var kt={},vt=null;function Tn(){return vt=vt||new Ue}kt.Ia="serverreachability";function Ne(B){q.call(this,kt.Ia,B)}f(Ne,q);function Xt(B){const ee=Tn();it(ee,new Ne(ee))}kt.STAT_EVENT="statevent";function Ht(B,ee){q.call(this,kt.STAT_EVENT,B),this.stat=ee}f(Ht,q);function $t(B){const ee=Tn();it(ee,new Ht(ee,B))}kt.Ja="timingevent";function zt(B,ee){q.call(this,kt.Ja,B),this.size=ee}f(zt,q);function Ot(B,ee){if(typeof B!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){B()},ee)}function an(){this.g=!0}an.prototype.ua=function(){this.g=!1};function jn(B,ee,he,Pe,gt,Ct){B.info(function(){if(B.g)if(Ct){var cn="",Ea=Ct.split("&");for(let Xa=0;Xa<Ea.length;Xa++){var Ds=Ea[Xa].split("=");if(Ds.length>1){const us=Ds[0];Ds=Ds[1];const Go=us.split("_");cn=Go.length>=2&&Go[1]=="type"?cn+(us+"="+Ds+"&"):cn+(us+"=redacted&")}}}else cn=null;else cn=Ct;return"XMLHTTP REQ ("+Pe+") [attempt "+gt+"]: "+ee+`
`+he+`
`+cn})}function ai(B,ee,he,Pe,gt,Ct,cn){B.info(function(){return"XMLHTTP RESP ("+Pe+") [ attempt "+gt+"]: "+ee+`
`+he+`
`+Ct+" "+cn})}function Ta(B,ee,he,Pe){B.info(function(){return"XMLHTTP TEXT ("+ee+"): "+dr(B,he)+(Pe?" "+Pe:"")})}function Gs(B,ee){B.info(function(){return"TIMEOUT: "+ee})}an.prototype.info=function(){};function dr(B,ee){if(!B.g)return ee;if(!ee)return null;try{const Ct=JSON.parse(ee);if(Ct){for(B=0;B<Ct.length;B++)if(Array.isArray(Ct[B])){var he=Ct[B];if(!(he.length<2)){var Pe=he[1];if(Array.isArray(Pe)&&!(Pe.length<1)){var gt=Pe[0];if(gt!="noop"&&gt!="stop"&&gt!="close")for(let cn=1;cn<Pe.length;cn++)Pe[cn]=""}}}}return Te(Ct)}catch{return ee}}var bt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Bt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ln;function Ut(){}f(Ut,ht),Ut.prototype.g=function(){return new XMLHttpRequest},ln=new Ut;function _(B){return encodeURIComponent(String(B))}function me(B){var ee=1;B=B.split(":");const he=[];for(;ee>0&&B.length;)he.push(B.shift()),ee--;return B.length&&he.push(B.join(":")),he}function Yn(B,ee,he,Pe){this.j=B,this.i=ee,this.l=he,this.S=Pe||1,this.V=new Ge(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new va}function va(){this.i=null,this.g="",this.h=!1}var Pa={},Ln={};function oa(B,ee,he){B.M=1,B.A=Ya(de(ee)),B.u=he,B.R=!0,Kr(B,null)}function Kr(B,ee){B.F=Date.now(),yo(B),B.B=de(B.A);var he=B.B,Pe=B.S;Array.isArray(Pe)||(Pe=[String(Pe)]),zo(he.i,"t",Pe),B.C=0,he=B.j.L,B.h=new va,B.g=Fm(B.j,he?ee:null,!B.u),B.P>0&&(B.O=new le(u(B.Y,B,B.g),B.P)),ee=B.V,he=B.g,Pe=B.ba;var gt="readystatechange";Array.isArray(gt)||(gt&&(tt[0]=gt.toString()),gt=tt);for(let Ct=0;Ct<gt.length;Ct++){const cn=Fe(he,gt[Ct],Pe||ee.handleEvent,!1,ee.h||ee);if(!cn)break;ee.g[cn.key]=cn}ee=B.J?oe(B.J):{},B.u?(B.v||(B.v="POST"),ee["Content-Type"]="application/x-www-form-urlencoded",B.g.ea(B.B,B.v,B.u,ee)):(B.v="GET",B.g.ea(B.B,B.v,null,ee)),Xt(),jn(B.i,B.v,B.B,B.l,B.S,B.u)}Yn.prototype.ba=function(B){B=B.target;const ee=this.O;ee&&Lc(B)==3?ee.j():this.Y(B)},Yn.prototype.Y=function(B){try{if(B==this.g)e:{const Ea=Lc(this.g),Ds=this.g.ya(),Xa=this.g.ca();if(!(Ea<3)&&(Ea!=3||this.g&&(this.h.h||this.g.la()||Pr(this.g)))){this.K||Ea!=4||Ds==7||(Ds==8||Xa<=0?Xt(3):Xt(2)),Uo(this);var ee=this.g.ca();this.X=ee;var he=ka(this);if(this.o=ee==200,ai(this.i,this.v,this.B,this.l,this.S,Ea,ee),this.o){if(this.U&&!this.L){t:{if(this.g){var Pe,gt=this.g;if((Pe=gt.g?gt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Pe)){var Ct=Pe;break t}}Ct=null}if(B=Ct)Ta(this.i,this.l,B,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ps(this,B);else{this.o=!1,this.m=3,$t(12),qs(this),ts(this);break e}}if(this.R){B=!0;let us;for(;!this.K&&this.C<he.length;)if(us=hr(this,he),us==Ln){Ea==4&&(this.m=4,$t(14),B=!1),Ta(this.i,this.l,null,"[Incomplete Response]");break}else if(us==Pa){this.m=4,$t(15),Ta(this.i,this.l,he,"[Invalid Chunk]"),B=!1;break}else Ta(this.i,this.l,us,null),Ps(this,us);if(la(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ea!=4||he.length!=0||this.h.h||(this.m=1,$t(16),B=!1),this.o=this.o&&B,!B)Ta(this.i,this.l,he,"[Invalid Chunked Response]"),qs(this),ts(this);else if(he.length>0&&!this.W){this.W=!0;var cn=this.j;cn.g==this&&cn.aa&&!cn.P&&(cn.j.info("Great, no buffering proxy detected. Bytes received: "+he.length),Oc(cn),cn.P=!0,$t(11))}}else Ta(this.i,this.l,he,null),Ps(this,he);Ea==4&&qs(this),this.o&&!this.K&&(Ea==4?np(this.j,this):(this.o=!1,yo(this)))}else rd(this.g),ee==400&&he.indexOf("Unknown SID")>0?(this.m=3,$t(12)):(this.m=0,$t(13)),qs(this),ts(this)}}}catch{}};function ka(B){if(!la(B))return B.g.la();const ee=Pr(B.g);if(ee==="")return"";let he="";const Pe=ee.length,gt=Lc(B.g)==4;if(!B.h.i){if(typeof TextDecoder>"u")return qs(B),ts(B),"";B.h.i=new o.TextDecoder}for(let Ct=0;Ct<Pe;Ct++)B.h.h=!0,he+=B.h.i.decode(ee[Ct],{stream:!(gt&&Ct==Pe-1)});return ee.length=0,B.h.g+=he,B.C=0,B.h.g}function la(B){return B.g?B.v=="GET"&&B.M!=2&&B.j.Aa:!1}function hr(B,ee){var he=B.C,Pe=ee.indexOf(`
`,he);return Pe==-1?Ln:(he=Number(ee.substring(he,Pe)),isNaN(he)?Pa:(Pe+=1,Pe+he>ee.length?Ln:(ee=ee.slice(Pe,Pe+he),B.C=Pe+he,ee)))}Yn.prototype.cancel=function(){this.K=!0,qs(this)};function yo(B){B.T=Date.now()+B.H,ah(B,B.H)}function ah(B,ee){if(B.D!=null)throw Error("WatchDog timer not null");B.D=Ot(u(B.aa,B),ee)}function Uo(B){B.D&&(o.clearTimeout(B.D),B.D=null)}Yn.prototype.aa=function(){this.D=null;const B=Date.now();B-this.T>=0?(Gs(this.i,this.B),this.M!=2&&(Xt(),$t(17)),qs(this),this.m=2,ts(this)):ah(this,this.T-B)};function ts(B){B.j.I==0||B.K||np(B.j,B)}function qs(B){Uo(B);var ee=B.O;ee&&typeof ee.dispose=="function"&&ee.dispose(),B.O=null,pt(B.V),B.g&&(ee=B.g,B.g=null,ee.abort(),ee.dispose())}function Ps(B,ee){try{var he=B.j;if(he.I!=0&&(he.g==B||se(he.h,B))){if(!B.L&&se(he.h,B)&&he.I==3){try{var Pe=he.Ba.g.parse(ee)}catch{Pe=null}if(Array.isArray(Pe)&&Pe.length==3){var gt=Pe;if(gt[0]==0){e:if(!he.v){if(he.g)if(he.g.F+3e3<B.F)tp(he),bs(he);else break e;Su(he),$t(18)}}else he.xa=gt[1],0<he.xa-he.K&&gt[2]<37500&&he.F&&he.A==0&&!he.C&&(he.C=Ot(u(he.Va,he),6e3));Ze(he.h)<=1&&he.ta&&(he.ta=void 0)}else Ir(he,11)}else if((B.L||he.g==B)&&tp(he),!H(ee))for(gt=he.Ba.g.parse(ee),ee=0;ee<gt.length;ee++){let Xa=gt[ee];const us=Xa[0];if(!(us<=he.K))if(he.K=us,Xa=Xa[1],he.I==2)if(Xa[0]=="c"){he.M=Xa[1],he.ba=Xa[2];const Go=Xa[3];Go!=null&&(he.ka=Go,he.j.info("VER="+he.ka));const Fc=Xa[4];Fc!=null&&(he.za=Fc,he.j.info("SVER="+he.za));const Xr=Xa[5];Xr!=null&&typeof Xr=="number"&&Xr>0&&(Pe=1.5*Xr,he.O=Pe,he.j.info("backChannelRequestTimeoutMs_="+Pe)),Pe=he;const jc=B.g;if(jc){const cd=jc.g?jc.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(cd){var Ct=Pe.h;Ct.g||cd.indexOf("spdy")==-1&&cd.indexOf("quic")==-1&&cd.indexOf("h2")==-1||(Ct.j=Ct.l,Ct.g=new Set,Ct.h&&(Dt(Ct,Ct.h),Ct.h=null))}if(Pe.G){const ap=jc.g?jc.g.getResponseHeader("X-HTTP-Session-Id"):null;ap&&(Pe.wa=ap,Xn(Pe.J,Pe.G,ap))}}he.I=3,he.l&&he.l.ra(),he.aa&&(he.T=Date.now()-B.F,he.j.info("Handshake RTT: "+he.T+"ms")),Pe=he;var cn=B;if(Pe.na=q0(Pe,Pe.L?Pe.ba:null,Pe.W),cn.L){gn(Pe.h,cn);var Ea=cn,Ds=Pe.O;Ds&&(Ea.H=Ds),Ea.D&&(Uo(Ea),yo(Ea)),Pe.g=cn}else V0(Pe);he.i.length>0&&kc(he)}else Xa[0]!="stop"&&Xa[0]!="close"||Ir(he,7);else he.I==3&&(Xa[0]=="stop"||Xa[0]=="close"?Xa[0]=="stop"?Ir(he,7):Dc(he):Xa[0]!="noop"&&he.l&&he.l.qa(Xa),he.A=0)}}Xt(4)}catch{}}var Se=class{constructor(B,ee){this.g=B,this.map=ee}};function ot(B){this.l=B||10,o.PerformanceNavigationTiming?(B=o.performance.getEntriesByType("navigation"),B=B.length>0&&(B[0].nextHopProtocol=="hq"||B[0].nextHopProtocol=="h2")):B=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=B?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function St(B){return B.h?!0:B.g?B.g.size>=B.j:!1}function Ze(B){return B.h?1:B.g?B.g.size:0}function se(B,ee){return B.h?B.h==ee:B.g?B.g.has(ee):!1}function Dt(B,ee){B.g?B.g.add(ee):B.h=ee}function gn(B,ee){B.h&&B.h==ee?B.h=null:B.g&&B.g.has(ee)&&B.g.delete(ee)}ot.prototype.cancel=function(){if(this.i=dn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const B of this.g.values())B.cancel();this.g.clear()}};function dn(B){if(B.h!=null)return B.i.concat(B.h.G);if(B.g!=null&&B.g.size!==0){let ee=B.i;for(const he of B.g.values())ee=ee.concat(he.G);return ee}return A(B.i)}var bn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mn(B,ee){if(B){B=B.split("&");for(let he=0;he<B.length;he++){const Pe=B[he].indexOf("=");let gt,Ct=null;Pe>=0?(gt=B[he].substring(0,Pe),Ct=B[he].substring(Pe+1)):gt=B[he],ee(gt,Ct?decodeURIComponent(Ct.replace(/\+/g," ")):"")}}}function Dn(B){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let ee;B instanceof Dn?(this.l=B.l,Bn(this,B.j),this.o=B.o,this.g=B.g,ja(this,B.u),this.h=B.h,ki(this,_1(B.i)),this.m=B.m):B&&(ee=String(B).match(bn))?(this.l=!1,Bn(this,ee[1]||"",!0),this.o=Pn(ee[2]||""),this.g=Pn(ee[3]||"",!0),ja(this,ee[4]),this.h=Pn(ee[5]||"",!0),ki(this,ee[6]||"",!0),this.m=Pn(ee[7]||"")):(this.l=!1,this.i=new ps(null,this.l))}Dn.prototype.toString=function(){const B=[];var ee=this.j;ee&&B.push(Fa(ee,Is,!0),":");var he=this.g;return(he||ee=="file")&&(B.push("//"),(ee=this.o)&&B.push(Fa(ee,Is,!0),"@"),B.push(_(he).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),he=this.u,he!=null&&B.push(":",String(he))),(he=this.h)&&(this.g&&he.charAt(0)!="/"&&B.push("/"),B.push(Fa(he,he.charAt(0)=="/"?za:Hs,!0))),(he=this.i.toString())&&B.push("?",he),(he=this.m)&&B.push("#",Fa(he,pi)),B.join("")},Dn.prototype.resolve=function(B){const ee=de(this);let he=!!B.j;he?Bn(ee,B.j):he=!!B.o,he?ee.o=B.o:he=!!B.g,he?ee.g=B.g:he=B.u!=null;var Pe=B.h;if(he)ja(ee,B.u);else if(he=!!B.h){if(Pe.charAt(0)!="/")if(this.g&&!this.h)Pe="/"+Pe;else{var gt=ee.h.lastIndexOf("/");gt!=-1&&(Pe=ee.h.slice(0,gt+1)+Pe)}if(gt=Pe,gt==".."||gt==".")Pe="";else if(gt.indexOf("./")!=-1||gt.indexOf("/.")!=-1){Pe=gt.lastIndexOf("/",0)==0,gt=gt.split("/");const Ct=[];for(let cn=0;cn<gt.length;){const Ea=gt[cn++];Ea=="."?Pe&&cn==gt.length&&Ct.push(""):Ea==".."?((Ct.length>1||Ct.length==1&&Ct[0]!="")&&Ct.pop(),Pe&&cn==gt.length&&Ct.push("")):(Ct.push(Ea),Pe=!0)}Pe=Ct.join("/")}else Pe=gt}return he?ee.h=Pe:he=B.i.toString()!=="",he?ki(ee,_1(B.i)):he=!!B.m,he&&(ee.m=B.m),ee};function de(B){return new Dn(B)}function Bn(B,ee,he){B.j=he?Pn(ee,!0):ee,B.j&&(B.j=B.j.replace(/:$/,""))}function ja(B,ee){if(ee){if(ee=Number(ee),isNaN(ee)||ee<0)throw Error("Bad port number "+ee);B.u=ee}else B.u=null}function ki(B,ee,he){ee instanceof ps?(B.i=ee,ih(B.i,B.l)):(he||(ee=Fa(ee,Vo)),B.i=new ps(ee,B.l))}function Xn(B,ee,he){B.i.set(ee,he)}function Ya(B){return Xn(B,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),B}function Pn(B,ee){return B?ee?decodeURI(B.replace(/%25/g,"%2525")):decodeURIComponent(B):""}function Fa(B,ee,he){return typeof B=="string"?(B=encodeURI(B).replace(ee,ca),he&&(B=B.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),B):null}function ca(B){return B=B.charCodeAt(0),"%"+(B>>4&15).toString(16)+(B&15).toString(16)}var Is=/[#\/\?@]/g,Hs=/[#\?:]/g,za=/[#\?]/g,Vo=/[#\?@]/g,pi=/#/g;function ps(B,ee){this.h=this.g=null,this.i=B||null,this.j=!!ee}function Ci(B){B.g||(B.g=new Map,B.h=0,B.i&&Mn(B.i,function(ee,he){B.add(decodeURIComponent(ee.replace(/\+/g," ")),he)}))}a=ps.prototype,a.add=function(B,ee){Ci(this),this.i=null,B=mi(this,B);let he=this.g.get(B);return he||this.g.set(B,he=[]),he.push(ee),this.h+=1,this};function Ws(B,ee){Ci(B),ee=mi(B,ee),B.g.has(ee)&&(B.i=null,B.h-=B.g.get(ee).length,B.g.delete(ee))}function Ls(B,ee){return Ci(B),ee=mi(B,ee),B.g.has(ee)}a.forEach=function(B,ee){Ci(this),this.g.forEach(function(he,Pe){he.forEach(function(gt){B.call(ee,gt,Pe,this)},this)},this)};function id(B,ee){Ci(B);let he=[];if(typeof ee=="string")Ls(B,ee)&&(he=he.concat(B.g.get(mi(B,ee))));else for(B=Array.from(B.g.values()),ee=0;ee<B.length;ee++)he=he.concat(B[ee]);return he}a.set=function(B,ee){return Ci(this),this.i=null,B=mi(this,B),Ls(this,B)&&(this.h-=this.g.get(B).length),this.g.set(B,[ee]),this.h+=1,this},a.get=function(B,ee){return B?(B=id(this,B),B.length>0?String(B[0]):ee):ee};function zo(B,ee,he){Ws(B,ee),he.length>0&&(B.i=null,B.g.set(mi(B,ee),A(he)),B.h+=he.length)}a.toString=function(){if(this.i)return this.i;if(!this.g)return"";const B=[],ee=Array.from(this.g.keys());for(let Pe=0;Pe<ee.length;Pe++){var he=ee[Pe];const gt=_(he);he=id(this,he);for(let Ct=0;Ct<he.length;Ct++){let cn=gt;he[Ct]!==""&&(cn+="="+_(he[Ct])),B.push(cn)}}return this.i=B.join("&")};function _1(B){const ee=new ps;return ee.i=B.i,B.g&&(ee.g=new Map(B.g),ee.h=B.h),ee}function mi(B,ee){return ee=String(ee),B.j&&(ee=ee.toLowerCase()),ee}function ih(B,ee){ee&&!B.j&&(Ci(B),B.i=null,B.g.forEach(function(he,Pe){const gt=Pe.toLowerCase();Pe!=gt&&(Ws(this,Pe),zo(this,gt,he))},B)),B.j=ee}function Vl(B,ee){const he=new an;if(o.Image){const Pe=new Image;Pe.onload=h(zl,he,"TestLoadImage: loaded",!0,ee,Pe),Pe.onerror=h(zl,he,"TestLoadImage: error",!1,ee,Pe),Pe.onabort=h(zl,he,"TestLoadImage: abort",!1,ee,Pe),Pe.ontimeout=h(zl,he,"TestLoadImage: timeout",!1,ee,Pe),o.setTimeout(function(){Pe.ontimeout&&Pe.ontimeout()},1e4),Pe.src=B}else ee(!1)}function B0(B,ee){const he=new an,Pe=new AbortController,gt=setTimeout(()=>{Pe.abort(),zl(he,"TestPingServer: timeout",!1,ee)},1e4);fetch(B,{signal:Pe.signal}).then(Ct=>{clearTimeout(gt),Ct.ok?zl(he,"TestPingServer: ok",!0,ee):zl(he,"TestPingServer: server error",!1,ee)}).catch(()=>{clearTimeout(gt),zl(he,"TestPingServer: error",!1,ee)})}function zl(B,ee,he,Pe,gt){try{gt&&(gt.onload=null,gt.onerror=null,gt.onabort=null,gt.ontimeout=null),Pe(he)}catch{}}function sh(){this.g=new mt}function Pc(B){this.i=B.Sb||null,this.h=B.ab||!1}f(Pc,ht),Pc.prototype.g=function(){return new sd(this.i,this.h)};function sd(B,ee){Ue.call(this),this.H=B,this.o=ee,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(sd,Ue),a=sd.prototype,a.open=function(B,ee){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=B,this.D=ee,this.readyState=1,Ic(this)},a.send=function(B){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const ee={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};B&&(ee.body=B),(this.H||o).fetch(new Request(this.D,ee)).then(this.Pa.bind(this),this.ga.bind(this))},a.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,oh(this)),this.readyState=0},a.Pa=function(B){if(this.g&&(this.l=B,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=B.headers,this.readyState=2,Ic(this)),this.g&&(this.readyState=3,Ic(this),this.g)))if(this.responseType==="arraybuffer")B.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in B){if(this.j=B.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;rh(this)}else B.text().then(this.Oa.bind(this),this.ga.bind(this))};function rh(B){B.j.read().then(B.Ma.bind(B)).catch(B.ga.bind(B))}a.Ma=function(B){if(this.g){if(this.o&&B.value)this.response.push(B.value);else if(!this.o){var ee=B.value?B.value:new Uint8Array(0);(ee=this.B.decode(ee,{stream:!B.done}))&&(this.response=this.responseText+=ee)}B.done?oh(this):Ic(this),this.readyState==3&&rh(this)}},a.Oa=function(B){this.g&&(this.response=this.responseText=B,oh(this))},a.Na=function(B){this.g&&(this.response=B,oh(this))},a.ga=function(){this.g&&oh(this)};function oh(B){B.readyState=4,B.l=null,B.j=null,B.B=null,Ic(B)}a.setRequestHeader=function(B,ee){this.A.append(B,ee)},a.getResponseHeader=function(B){return this.h&&this.h.get(B.toLowerCase())||""},a.getAllResponseHeaders=function(){if(!this.h)return"";const B=[],ee=this.h.entries();for(var he=ee.next();!he.done;)he=he.value,B.push(he[0]+": "+he[1]),he=ee.next();return B.join(`\r
`)};function Ic(B){B.onreadystatechange&&B.onreadystatechange.call(B)}Object.defineProperty(sd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(B){this.m=B?"include":"same-origin"}});function Gl(B){let ee="";return pe(B,function(he,Pe){ee+=Pe,ee+=":",ee+=he,ee+=`\r
`}),ee}function lh(B,ee,he){e:{for(Pe in he){var Pe=!1;break e}Pe=!0}Pe||(he=Gl(he),typeof B=="string"?he!=null&&_(he):Xn(B,ee,he))}function Oi(B){Ue.call(this),this.headers=new Map,this.L=B||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Oi,Ue);var ql=/^https?$/i,Jf=["POST","PUT"];a=Oi.prototype,a.Fa=function(B){this.H=B},a.ea=function(B,ee,he,Pe){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+B);ee=ee?ee.toUpperCase():"GET",this.D=B,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ln.g(),this.g.onreadystatechange=m(u(this.Ca,this));try{this.B=!0,this.g.open(ee,String(B),!0),this.B=!1}catch(Ct){Zf(this,Ct);return}if(B=he||"",he=new Map(this.headers),Pe)if(Object.getPrototypeOf(Pe)===Object.prototype)for(var gt in Pe)he.set(gt,Pe[gt]);else if(typeof Pe.keys=="function"&&typeof Pe.get=="function")for(const Ct of Pe.keys())he.set(Ct,Pe.get(Ct));else throw Error("Unknown input type for opt_headers: "+String(Pe));Pe=Array.from(he.keys()).find(Ct=>Ct.toLowerCase()=="content-type"),gt=o.FormData&&B instanceof o.FormData,!(Array.prototype.indexOf.call(Jf,ee,void 0)>=0)||Pe||gt||he.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ct,cn]of he)this.g.setRequestHeader(Ct,cn);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(B),this.v=!1}catch(Ct){Zf(this,Ct)}};function Zf(B,ee){B.h=!1,B.g&&(B.j=!0,B.g.abort(),B.j=!1),B.l=ee,B.o=5,Om(B),xu(B)}function Om(B){B.A||(B.A=!0,it(B,"complete"),it(B,"error"))}a.abort=function(B){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=B||7,it(this,"complete"),it(this,"abort"),xu(this))},a.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xu(this,!0)),Oi.Z.N.call(this)},a.Ca=function(){this.u||(this.B||this.v||this.j?ch(this):this.Xa())},a.Xa=function(){ch(this)};function ch(B){if(B.h&&typeof r<"u"){if(B.v&&Lc(B)==4)setTimeout(B.Ca.bind(B),0);else if(it(B,"readystatechange"),Lc(B)==4){B.h=!1;try{const Ct=B.ca();e:switch(Ct){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var ee=!0;break e;default:ee=!1}var he;if(!(he=ee)){var Pe;if(Pe=Ct===0){let cn=String(B.D).match(bn)[1]||null;!cn&&o.self&&o.self.location&&(cn=o.self.location.protocol.slice(0,-1)),Pe=!ql.test(cn?cn.toLowerCase():"")}he=Pe}if(he)it(B,"complete"),it(B,"success");else{B.o=6;try{var gt=Lc(B)>2?B.g.statusText:""}catch{gt=""}B.l=gt+" ["+B.ca()+"]",Om(B)}}finally{xu(B)}}}}function xu(B,ee){if(B.g){B.m&&(clearTimeout(B.m),B.m=null);const he=B.g;B.g=null,ee||it(B,"ready");try{he.onreadystatechange=null}catch{}}}a.isActive=function(){return!!this.g};function Lc(B){return B.g?B.g.readyState:0}a.ca=function(){try{return Lc(this)>2?this.g.status:-1}catch{return-1}},a.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},a.La=function(B){if(this.g){var ee=this.g.responseText;return B&&ee.indexOf(B)==0&&(ee=ee.substring(B.length)),st(ee)}};function Pr(B){try{if(!B.g)return null;if("response"in B.g)return B.g.response;switch(B.F){case"":case"text":return B.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in B.g)return B.g.mozResponseArrayBuffer}return null}catch{return null}}function rd(B){const ee={};B=(B.g&&Lc(B)>=2&&B.g.getAllResponseHeaders()||"").split(`\r
`);for(let Pe=0;Pe<B.length;Pe++){if(H(B[Pe]))continue;var he=me(B[Pe]);const gt=he[0];if(he=he[1],typeof he!="string")continue;he=he.trim();const Ct=ee[gt]||[];ee[gt]=Ct,Ct.push(he)}Ee(ee,function(Pe){return Pe.join(", ")})}a.ya=function(){return this.o},a.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function bu(B,ee,he){return he&&he.internalChannelParams&&he.internalChannelParams[B]||ee}function ms(B){this.za=0,this.i=[],this.j=new an,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=bu("failFast",!1,B),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=bu("baseRetryDelayMs",5e3,B),this.Za=bu("retryDelaySeedMs",1e4,B),this.Ta=bu("forwardChannelMaxRetries",2,B),this.va=bu("forwardChannelRequestTimeoutMs",2e4,B),this.ma=B&&B.xmlHttpFactory||void 0,this.Ua=B&&B.Rb||void 0,this.Aa=B&&B.useFetchStreams||!1,this.O=void 0,this.L=B&&B.supportsCrossDomainXhr||!1,this.M="",this.h=new ot(B&&B.concurrentRequestLimit),this.Ba=new sh,this.S=B&&B.fastHandshake||!1,this.R=B&&B.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=B&&B.Pb||!1,B&&B.ua&&this.j.ua(),B&&B.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&B&&B.detectBufferingProxy||!1,this.ia=void 0,B&&B.longPollingTimeout&&B.longPollingTimeout>0&&(this.ia=B.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}a=ms.prototype,a.ka=8,a.I=1,a.connect=function(B,ee,he,Pe){$t(0),this.W=B,this.H=ee||{},he&&Pe!==void 0&&(this.H.OSID=he,this.H.OAID=Pe),this.F=this.X,this.J=q0(this,null,this.W),kc(this)};function Dc(B){if(uh(B),B.I==3){var ee=B.V++,he=de(B.J);if(Xn(he,"SID",B.M),Xn(he,"RID",ee),Xn(he,"TYPE","terminate"),ep(B,he),ee=new Yn(B,B.j,ee),ee.M=2,ee.A=Ya(de(he)),he=!1,o.navigator&&o.navigator.sendBeacon)try{he=o.navigator.sendBeacon(ee.A.toString(),"")}catch{}!he&&o.Image&&(new Image().src=ee.A,he=!0),he||(ee.g=Fm(ee.j,null),ee.g.ea(ee.A)),ee.F=Date.now(),yo(ee)}G0(B)}function bs(B){B.g&&(Oc(B),B.g.cancel(),B.g=null)}function uh(B){bs(B),B.v&&(o.clearTimeout(B.v),B.v=null),tp(B),B.h.cancel(),B.m&&(typeof B.m=="number"&&o.clearTimeout(B.m),B.m=null)}function kc(B){if(!St(B.h)&&!B.m){B.m=!0;var ee=B.Ea;G||j(),O||(G(),O=!0),D.add(ee,B),B.D=0}}function od(B,ee){return Ze(B.h)>=B.h.j-(B.m?1:0)?!1:B.m?(B.i=ee.G.concat(B.i),!0):B.I==1||B.I==2||B.D>=(B.Sa?0:B.Ta)?!1:(B.m=Ot(u(B.Ea,B,ee),Tu(B,B.D)),B.D++,!0)}a.Ea=function(B){if(this.m)if(this.m=null,this.I==1){if(!B){this.V=Math.floor(Math.random()*1e5),B=this.V++;const gt=new Yn(this,this.j,B);let Ct=this.o;if(this.U&&(Ct?(Ct=oe(Ct),be(Ct,this.U)):Ct=this.U),this.u!==null||this.R||(gt.J=Ct,Ct=null),this.S)e:{for(var ee=0,he=0;he<this.i.length;he++){t:{var Pe=this.i[he];if("__data__"in Pe.map&&(Pe=Pe.map.__data__,typeof Pe=="string")){Pe=Pe.length;break t}Pe=void 0}if(Pe===void 0)break;if(ee+=Pe,ee>4096){ee=he;break e}if(ee===4096||he===this.i.length-1){ee=he+1;break e}}ee=1e3}else ee=1e3;ee=x1(this,gt,ee),he=de(this.J),Xn(he,"RID",B),Xn(he,"CVER",22),this.G&&Xn(he,"X-HTTP-Session-Id",this.G),ep(this,he),Ct&&(this.R?ee="headers="+_(Gl(Ct))+"&"+ee:this.u&&lh(he,this.u,Ct)),Dt(this.h,gt),this.Ra&&Xn(he,"TYPE","init"),this.S?(Xn(he,"$req",ee),Xn(he,"SID","null"),gt.U=!0,oa(gt,he,null)):oa(gt,he,ee),this.I=2}}else this.I==3&&(B?U0(this,B):this.i.length==0||St(this.h)||U0(this))};function U0(B,ee){var he;ee?he=ee.l:he=B.V++;const Pe=de(B.J);Xn(Pe,"SID",B.M),Xn(Pe,"RID",he),Xn(Pe,"AID",B.K),ep(B,Pe),B.u&&B.o&&lh(Pe,B.u,B.o),he=new Yn(B,B.j,he,B.D+1),B.u===null&&(he.J=B.o),ee&&(B.i=ee.G.concat(B.i)),ee=x1(B,he,1e3),he.H=Math.round(B.va*.5)+Math.round(B.va*.5*Math.random()),Dt(B.h,he),oa(he,Pe,ee)}function ep(B,ee){B.H&&pe(B.H,function(he,Pe){Xn(ee,Pe,he)}),B.l&&pe({},function(he,Pe){Xn(ee,Pe,he)})}function x1(B,ee,he){he=Math.min(B.i.length,he);const Pe=B.l?u(B.l.Ka,B.l,B):null;e:{var gt=B.i;let Ea=-1;for(;;){const Ds=["count="+he];Ea==-1?he>0?(Ea=gt[0].g,Ds.push("ofs="+Ea)):Ea=0:Ds.push("ofs="+Ea);let Xa=!0;for(let us=0;us<he;us++){var Ct=gt[us].g;const Go=gt[us].map;if(Ct-=Ea,Ct<0)Ea=Math.max(0,gt[us].g-100),Xa=!1;else try{Ct="req"+Ct+"_"||"";try{var cn=Go instanceof Map?Go:Object.entries(Go);for(const[Fc,Xr]of cn){let jc=Xr;l(Xr)&&(jc=Te(Xr)),Ds.push(Ct+Fc+"="+encodeURIComponent(jc))}}catch(Fc){throw Ds.push(Ct+"type="+encodeURIComponent("_badmap")),Fc}}catch{Pe&&Pe(Go)}}if(Xa){cn=Ds.join("&");break e}}cn=void 0}return B=B.i.splice(0,he),ee.G=B,cn}function V0(B){if(!B.g&&!B.v){B.Y=1;var ee=B.Da;G||j(),O||(G(),O=!0),D.add(ee,B),B.A=0}}function Su(B){return B.g||B.v||B.A>=3?!1:(B.Y++,B.v=Ot(u(B.Da,B),Tu(B,B.A)),B.A++,!0)}a.Da=function(){if(this.v=null,z0(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var B=4*this.T;this.j.info("BP detection timer enabled: "+B),this.B=Ot(u(this.Wa,this),B)}},a.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,$t(10),bs(this),z0(this))};function Oc(B){B.B!=null&&(o.clearTimeout(B.B),B.B=null)}function z0(B){B.g=new Yn(B,B.j,"rpc",B.Y),B.u===null&&(B.g.J=B.o),B.g.P=0;var ee=de(B.na);Xn(ee,"RID","rpc"),Xn(ee,"SID",B.M),Xn(ee,"AID",B.K),Xn(ee,"CI",B.F?"0":"1"),!B.F&&B.ia&&Xn(ee,"TO",B.ia),Xn(ee,"TYPE","xmlhttp"),ep(B,ee),B.u&&B.o&&lh(ee,B.u,B.o),B.O&&(B.g.H=B.O);var he=B.g;B=B.ba,he.M=1,he.A=Ya(de(ee)),he.u=null,he.R=!0,Kr(he,B)}a.Va=function(){this.C!=null&&(this.C=null,bs(this),Su(this),$t(19))};function tp(B){B.C!=null&&(o.clearTimeout(B.C),B.C=null)}function np(B,ee){var he=null;if(B.g==ee){tp(B),Oc(B),B.g=null;var Pe=2}else if(se(B.h,ee))he=ee.G,gn(B.h,ee),Pe=1;else return;if(B.I!=0){if(ee.o)if(Pe==1){he=ee.u?ee.u.length:0,ee=Date.now()-ee.F;var gt=B.D;Pe=Tn(),it(Pe,new zt(Pe,he)),kc(B)}else V0(B);else if(gt=ee.m,gt==3||gt==0&&ee.X>0||!(Pe==1&&od(B,ee)||Pe==2&&Su(B)))switch(he&&he.length>0&&(ee=B.h,ee.i=ee.i.concat(he)),gt){case 1:Ir(B,5);break;case 4:Ir(B,10);break;case 3:Ir(B,6);break;default:Ir(B,2)}}}function Tu(B,ee){let he=B.Qa+Math.floor(Math.random()*B.Za);return B.isActive()||(he*=2),he*ee}function Ir(B,ee){if(B.j.info("Error code "+ee),ee==2){var he=u(B.bb,B),Pe=B.Ua;const gt=!Pe;Pe=new Dn(Pe||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Bn(Pe,"https"),Ya(Pe),gt?Vl(Pe.toString(),he):B0(Pe.toString(),he)}else $t(2);B.I=0,B.l&&B.l.pa(ee),G0(B),uh(B)}a.bb=function(B){B?(this.j.info("Successfully pinged google.com"),$t(2)):(this.j.info("Failed to ping google.com"),$t(1))};function G0(B){if(B.I=0,B.ja=[],B.l){const ee=dn(B.h);(ee.length!=0||B.i.length!=0)&&(x(B.ja,ee),x(B.ja,B.i),B.h.i.length=0,A(B.i),B.i.length=0),B.l.oa()}}function q0(B,ee,he){var Pe=he instanceof Dn?de(he):new Dn(he);if(Pe.g!="")ee&&(Pe.g=ee+"."+Pe.g),ja(Pe,Pe.u);else{var gt=o.location;Pe=gt.protocol,ee=ee?ee+"."+gt.hostname:gt.hostname,gt=+gt.port;const Ct=new Dn(null);Pe&&Bn(Ct,Pe),ee&&(Ct.g=ee),gt&&ja(Ct,gt),he&&(Ct.h=he),Pe=Ct}return he=B.G,ee=B.wa,he&&ee&&Xn(Pe,he,ee),Xn(Pe,"VER",B.ka),ep(B,Pe),Pe}function Fm(B,ee,he){if(ee&&!B.L)throw Error("Can't create secondary domain capable XhrIo object.");return ee=B.Aa&&!B.ma?new Oi(new Pc({ab:he})):new Oi(B.ma),ee.Fa(B.L),ee}a.isActive=function(){return!!this.l&&this.l.isActive(this)};function b1(){}a=b1.prototype,a.ra=function(){},a.qa=function(){},a.pa=function(){},a.oa=function(){},a.isActive=function(){return!0},a.Ka=function(){};function dh(){}dh.prototype.g=function(B,ee){return new Yr(B,ee)};function Yr(B,ee){Ue.call(this),this.g=new ms(ee),this.l=B,this.h=ee&&ee.messageUrlParams||null,B=ee&&ee.messageHeaders||null,ee&&ee.clientProtocolHeaderRequired&&(B?B["X-Client-Protocol"]="webchannel":B={"X-Client-Protocol":"webchannel"}),this.g.o=B,B=ee&&ee.initMessageHeaders||null,ee&&ee.messageContentType&&(B?B["X-WebChannel-Content-Type"]=ee.messageContentType:B={"X-WebChannel-Content-Type":ee.messageContentType}),ee&&ee.sa&&(B?B["X-WebChannel-Client-Profile"]=ee.sa:B={"X-WebChannel-Client-Profile":ee.sa}),this.g.U=B,(B=ee&&ee.Qb)&&!H(B)&&(this.g.u=B),this.A=ee&&ee.supportsCrossDomainXhr||!1,this.v=ee&&ee.sendRawJson||!1,(ee=ee&&ee.httpSessionIdParam)&&!H(ee)&&(this.g.G=ee,B=this.h,B!==null&&ee in B&&(B=this.h,ee in B&&delete B[ee])),this.j=new ld(this)}f(Yr,Ue),Yr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Yr.prototype.close=function(){Dc(this.g)},Yr.prototype.o=function(B){var ee=this.g;if(typeof B=="string"){var he={};he.__data__=B,B=he}else this.v&&(he={},he.__data__=Te(B),B=he);ee.i.push(new Se(ee.Ya++,B)),ee.I==3&&kc(ee)},Yr.prototype.N=function(){this.g.l=null,delete this.j,Dc(this.g),delete this.g,Yr.Z.N.call(this)};function S1(B){ct.call(this),B.__headers__&&(this.headers=B.__headers__,this.statusCode=B.__status__,delete B.__headers__,delete B.__status__);var ee=B.__sm__;if(ee){e:{for(const he in ee){B=he;break e}B=void 0}(this.i=B)&&(B=this.i,ee=ee!==null&&B in ee?ee[B]:void 0),this.data=ee}else this.data=B}f(S1,ct);function T1(){Tt.call(this),this.status=1}f(T1,Tt);function ld(B){this.g=B}f(ld,b1),ld.prototype.ra=function(){it(this.g,"a")},ld.prototype.qa=function(B){it(this.g,new S1(B))},ld.prototype.pa=function(B){it(this.g,new T1)},ld.prototype.oa=function(){it(this.g,"b")},dh.prototype.createWebChannel=dh.prototype.g,Yr.prototype.send=Yr.prototype.o,Yr.prototype.open=Yr.prototype.m,Yr.prototype.close=Yr.prototype.close,TX=function(){return new dh},SX=function(){return Tn()},bX=kt,M6={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},bt.NO_ERROR=0,bt.TIMEOUT=8,bt.HTTP_ERROR=6,DC=bt,Bt.COMPLETE="complete",xX=Bt,Qe.EventType=Xe,Xe.OPEN="a",Xe.CLOSE="b",Xe.ERROR="c",Xe.MESSAGE="d",Ue.prototype.listen=Ue.prototype.J,N2=Qe,Oi.prototype.listenOnce=Oi.prototype.K,Oi.prototype.getLastError=Oi.prototype.Ha,Oi.prototype.getLastErrorCode=Oi.prototype.ya,Oi.prototype.getStatus=Oi.prototype.ca,Oi.prototype.getResponseJson=Oi.prototype.La,Oi.prototype.getResponseText=Oi.prototype.la,Oi.prototype.send=Oi.prototype.ea,Oi.prototype.setWithCredentials=Oi.prototype.Fa,_X=Oi}).apply(typeof wE<"u"?wE:typeof self<"u"?self:typeof window<"u"?window:{});let nl=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};nl.UNAUTHENTICATED=new nl(null),nl.GOOGLE_CREDENTIALS=new nl("google-credentials-uid"),nl.FIRST_PARTY=new nl("first-party-uid"),nl.MOCK_USER=new nl("mock-user");let Ex="12.8.0";function the(a){Ex=a}const ry=new m8("@firebase/firestore");function Yv(){return ry.logLevel}function En(a,...e){if(ry.logLevel<=ri.DEBUG){const n=e.map(y8);ry.debug(`Firestore (${Ex}): ${a}`,...n)}}function um(a,...e){if(ry.logLevel<=ri.ERROR){const n=e.map(y8);ry.error(`Firestore (${Ex}): ${a}`,...n)}}function D_(a,...e){if(ry.logLevel<=ri.WARN){const n=e.map(y8);ry.warn(`Firestore (${Ex}): ${a}`,...n)}}function y8(a){if(typeof a=="string")return a;try{return(function(n){return JSON.stringify(n)})(a)}catch{return a}}function na(a,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,wX(a,i,n)}function wX(a,e,n){let i=`FIRESTORE (${Ex}) INTERNAL ASSERTION FAILED: ${e} (ID: ${a.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw um(i),new Error(i)}function fi(a,e,n,i){let s="Unexpected state";typeof n=="string"?s=n:i=n,a||wX(e,s,i)}function ya(a,e){return a}const jt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pn extends Rm{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Vd{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class EX{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class nhe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(nl.UNAUTHENTICATED)))}shutdown(){}}class ahe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class ihe{constructor(e){this.t=e,this.currentUser=nl.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){fi(this.o===void 0,42304);let i=this.i;const s=c=>this.i!==i?(i=this.i,n(c)):Promise.resolve();let r=new Vd;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Vd,e.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const c=r;e.enqueueRetryable((async()=>{await c.promise,await s(this.currentUser)}))},l=c=>{En("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>l(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(En("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Vd)}}),0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(En("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(fi(typeof i.accessToken=="string",31837,{l:i}),new EX(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return fi(e===null||typeof e=="string",2055,{h:e}),new nl(e)}}class she{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=nl.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class rhe{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new she(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(nl.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class az{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ohe{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,cc(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){fi(this.o===void 0,3512);const i=r=>{r.error!=null&&En("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.m;return this.m=r.token,En("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable((()=>i(r)))};const s=r=>{En("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((r=>s(r))),setTimeout((()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?s(r):En("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new az(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(fi(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new az(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function lhe(a){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(a);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<a;i++)n[i]=Math.floor(256*Math.random());return n}class v8{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=lhe(40);for(let r=0;r<s.length;++r)i.length<20&&s[r]<n&&(i+=e.charAt(s[r]%62))}return i}}function li(a,e){return a<e?-1:a>e?1:0}function C6(a,e){const n=Math.min(a.length,e.length);for(let i=0;i<n;i++){const s=a.charAt(i),r=e.charAt(i);if(s!==r)return JL(s)===JL(r)?li(s,r):JL(s)?1:-1}return li(a.length,e.length)}const che=55296,uhe=57343;function JL(a){const e=a.charCodeAt(0);return e>=che&&e<=uhe}function k_(a,e,n){return a.length===e.length&&a.every(((i,s)=>n(i,e[s])))}const iz="__name__";class Dh{constructor(e,n,i){n===void 0?n=0:n>e.length&&na(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&na(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return Dh.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Dh?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let s=0;s<i;s++){const r=Dh.compareSegments(e.get(s),n.get(s));if(r!==0)return r}return li(e.length,n.length)}static compareSegments(e,n){const i=Dh.isNumericId(e),s=Dh.isNumericId(n);return i&&!s?-1:!i&&s?1:i&&s?Dh.extractNumericId(e).compare(Dh.extractNumericId(n)):C6(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $g.fromString(e.substring(4,e.length-2))}}class Qi extends Dh{construct(e,n,i){return new Qi(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new pn(jt.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((s=>s.length>0)))}return new Qi(n)}static emptyPath(){return new Qi([])}}const dhe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Eo extends Dh{construct(e,n,i){return new Eo(e,n,i)}static isValidIdentifier(e){return dhe.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Eo.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===iz}static keyField(){return new Eo([iz])}static fromServerFormat(e){const n=[];let i="",s=0;const r=()=>{if(i.length===0)throw new pn(jt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new pn(jt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new pn(jt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(i+=l,s++):(r(),s++)}if(r(),o)throw new pn(jt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Eo(n)}static emptyPath(){return new Eo([])}}class Wn{constructor(e){this.path=e}static fromPath(e){return new Wn(Qi.fromString(e))}static fromName(e){return new Wn(Qi.fromString(e).popFirst(5))}static empty(){return new Wn(Qi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Qi.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Qi.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Wn(new Qi(e.slice()))}}function MX(a,e,n){if(!n)throw new pn(jt.INVALID_ARGUMENT,`Function ${a}() cannot be called with an empty ${e}.`)}function hhe(a,e,n,i){if(e===!0&&i===!0)throw new pn(jt.INVALID_ARGUMENT,`${a} and ${n} cannot be used together.`)}function sz(a){if(!Wn.isDocumentKey(a))throw new pn(jt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${a} has ${a.length}.`)}function rz(a){if(Wn.isDocumentKey(a))throw new pn(jt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${a} has ${a.length}.`)}function CX(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}function VR(a){if(a===void 0)return"undefined";if(a===null)return"null";if(typeof a=="string")return a.length>20&&(a=`${a.substring(0,20)}...`),JSON.stringify(a);if(typeof a=="number"||typeof a=="boolean")return""+a;if(typeof a=="object"){if(a instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(a);return e?`a custom ${e} object`:"an object"}}return typeof a=="function"?"a function":na(12329,{type:typeof a})}function ul(a,e){if("_delegate"in a&&(a=a._delegate),!(a instanceof e)){if(e.name===a.constructor.name)throw new pn(jt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=VR(a);throw new pn(jt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return a}function fhe(a,e){if(e<=0)throw new pn(jt.INVALID_ARGUMENT,`Function ${a}() requires a positive number, but it was: ${e}.`)}function br(a,e){const n={typeString:a};return e&&(n.value=e),n}function bT(a,e){if(!CX(a))throw new pn(jt.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const s=e[i].typeString,r="value"in e[i]?{value:e[i].value}:void 0;if(!(i in a)){n=`JSON missing required field: '${i}'`;break}const o=a[i];if(s&&typeof o!==s){n=`JSON field '${i}' must be a ${s}.`;break}if(r!==void 0&&o!==r.value){n=`Expected '${i}' field to equal '${r.value}'`;break}}if(n)throw new pn(jt.INVALID_ARGUMENT,n);return!0}const oz=-62135596800,lz=1e6;class bi{static now(){return bi.fromMillis(Date.now())}static fromDate(e){return bi.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*lz);return new bi(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new pn(jt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new pn(jt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<oz)throw new pn(jt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pn(jt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/lz}_compareTo(e){return this.seconds===e.seconds?li(this.nanoseconds,e.nanoseconds):li(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:bi._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(bT(e,bi._jsonSchema))return new bi(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-oz;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}bi._jsonSchemaVersion="firestore/timestamp/1.0",bi._jsonSchema={type:br("string",bi._jsonSchemaVersion),seconds:br("number"),nanoseconds:br("number")};class pa{static fromTimestamp(e){return new pa(e)}static min(){return new pa(new bi(0,0))}static max(){return new pa(new bi(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const TS=-1;function phe(a,e){const n=a.toTimestamp().seconds,i=a.toTimestamp().nanoseconds+1,s=pa.fromTimestamp(i===1e9?new bi(n+1,0):new bi(n,i));return new i0(s,Wn.empty(),e)}function mhe(a){return new i0(a.readTime,a.key,TS)}class i0{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new i0(pa.min(),Wn.empty(),TS)}static max(){return new i0(pa.max(),Wn.empty(),TS)}}function ghe(a,e){let n=a.readTime.compareTo(e.readTime);return n!==0?n:(n=Wn.comparator(a.documentKey,e.documentKey),n!==0?n:li(a.largestBatchId,e.largestBatchId))}const Ahe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yhe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Mx(a){if(a.code!==jt.FAILED_PRECONDITION||a.message!==Ahe)throw a;En("LocalStore","Unexpectedly lost primary lease")}class Kt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&na(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Kt(((i,s)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(i,s)},this.catchCallback=r=>{this.wrapFailure(n,r).next(i,s)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof Kt?n:Kt.resolve(n)}catch(n){return Kt.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):Kt.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):Kt.reject(n)}static resolve(e){return new Kt(((n,i)=>{n(e)}))}static reject(e){return new Kt(((n,i)=>{i(e)}))}static waitFor(e){return new Kt(((n,i)=>{let s=0,r=0,o=!1;e.forEach((l=>{++s,l.next((()=>{++r,o&&r===s&&n()}),(c=>i(c)))})),o=!0,r===s&&n()}))}static or(e){let n=Kt.resolve(!1);for(const i of e)n=n.next((s=>s?Kt.resolve(s):i()));return n}static forEach(e,n){const i=[];return e.forEach(((s,r)=>{i.push(n.call(this,s,r))})),this.waitFor(i)}static mapArray(e,n){return new Kt(((i,s)=>{const r=e.length,o=new Array(r);let l=0;for(let c=0;c<r;c++){const u=c;n(e[u]).next((h=>{o[u]=h,++l,l===r&&i(o)}),(h=>s(h)))}}))}static doWhile(e,n){return new Kt(((i,s)=>{const r=()=>{e()===!0?n().next((()=>{r()}),s):i()};r()}))}}function vhe(a){const e=a.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Cx(a){return a.name==="IndexedDbTransactionError"}class zR{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}zR.ce=-1;const _8=-1;function ST(a){return a==null}function A3(a){return a===0&&1/a==-1/0}function _he(a){return typeof a=="number"&&Number.isInteger(a)&&!A3(a)&&a<=Number.MAX_SAFE_INTEGER&&a>=Number.MIN_SAFE_INTEGER}const NX="";function xhe(a){let e="";for(let n=0;n<a.length;n++)e.length>0&&(e=cz(e)),e=bhe(a.get(n),e);return cz(e)}function bhe(a,e){let n=e;const i=a.length;for(let s=0;s<i;s++){const r=a.charAt(s);switch(r){case"\0":n+="";break;case NX:n+="";break;default:n+=r}}return n}function cz(a){return a+NX+""}function uz(a){let e=0;for(const n in a)Object.prototype.hasOwnProperty.call(a,n)&&e++;return e}function x0(a,e){for(const n in a)Object.prototype.hasOwnProperty.call(a,n)&&e(n,a[n])}function She(a,e){const n=[];for(const i in a)Object.prototype.hasOwnProperty.call(a,i)&&n.push(e(a[i],i,a));return n}function RX(a){for(const e in a)if(Object.prototype.hasOwnProperty.call(a,e))return!1;return!0}class Vs{constructor(e,n){this.comparator=e,this.root=n||wo.EMPTY}insert(e,n){return new Vs(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,wo.BLACK,null,null))}remove(e){return new Vs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wo.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return n+i.left.size;s<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new EE(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new EE(this.root,e,this.comparator,!1)}getReverseIterator(){return new EE(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new EE(this.root,e,this.comparator,!0)}}class EE{constructor(e,n,i,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=n?i(e.key,n):1,n&&s&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class wo{constructor(e,n,i,s,r){this.key=e,this.value=n,this.color=i??wo.RED,this.left=s??wo.EMPTY,this.right=r??wo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,s,r){return new wo(e??this.key,n??this.value,i??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let s=this;const r=i(e,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(e,n,i),null):r===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return wo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return wo.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw na(43730,{key:this.key,value:this.value});if(this.right.isRed())throw na(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw na(27949);return e+(this.isRed()?0:1)}}wo.EMPTY=null,wo.RED=!0,wo.BLACK=!1;wo.EMPTY=new class{constructor(){this.size=0}get key(){throw na(57766)}get value(){throw na(16141)}get color(){throw na(16727)}get left(){throw na(29726)}get right(){throw na(36894)}copy(e,n,i,s,r){return this}insert(e,n,i){return new wo(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Vr{constructor(e){this.comparator=e,this.data=new Vs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new dz(this.data.getIterator())}getIteratorFrom(e){return new dz(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof Vr)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,r=i.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Vr(this.comparator);return n.data=e,n}}class dz{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class au{constructor(e){this.fields=e,e.sort(Eo.comparator)}static empty(){return new au([])}unionWith(e){let n=new Vr(Eo.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new au(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return k_(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class PX extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ko{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new PX("Invalid base64 string: "+r):r}})(e);return new ko(n)}static fromUint8Array(e){const n=(function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r})(e);return new ko(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return li(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ko.EMPTY_BYTE_STRING=new ko("");const The=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function s0(a){if(fi(!!a,39018),typeof a=="string"){let e=0;const n=The.exec(a);if(fi(!!n,46558,{timestamp:a}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(a);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:rr(a.seconds),nanos:rr(a.nanos)}}function rr(a){return typeof a=="number"?a:typeof a=="string"?Number(a):0}function r0(a){return typeof a=="string"?ko.fromBase64String(a):ko.fromUint8Array(a)}const IX="server_timestamp",LX="__type__",DX="__previous_value__",kX="__local_write_time__";function x8(a){return(a?.mapValue?.fields||{})[LX]?.stringValue===IX}function GR(a){const e=a.mapValue.fields[DX];return x8(e)?GR(e):e}function wS(a){const e=s0(a.mapValue.fields[kX].timestampValue);return new bi(e.seconds,e.nanos)}class whe{constructor(e,n,i,s,r,o,l,c,u,h,f){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h,this.apiKey=f}}const y3="(default)";class ES{constructor(e,n){this.projectId=e,this.database=n||y3}static empty(){return new ES("","")}get isDefaultDatabase(){return this.database===y3}isEqual(e){return e instanceof ES&&e.projectId===this.projectId&&e.database===this.database}}function Ehe(a,e){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new pn(jt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ES(a.options.projectId,e)}const OX="__type__",Mhe="__max__",ME={mapValue:{}},FX="__vector__",v3="value";function o0(a){return"nullValue"in a?0:"booleanValue"in a?1:"integerValue"in a||"doubleValue"in a?2:"timestampValue"in a?3:"stringValue"in a?5:"bytesValue"in a?6:"referenceValue"in a?7:"geoPointValue"in a?8:"arrayValue"in a?9:"mapValue"in a?x8(a)?4:Nhe(a)?9007199254740991:Che(a)?10:11:na(28295,{value:a})}function df(a,e){if(a===e)return!0;const n=o0(a);if(n!==o0(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return a.booleanValue===e.booleanValue;case 4:return wS(a).isEqual(wS(e));case 3:return(function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=s0(s.timestampValue),l=s0(r.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(a,e);case 5:return a.stringValue===e.stringValue;case 6:return(function(s,r){return r0(s.bytesValue).isEqual(r0(r.bytesValue))})(a,e);case 7:return a.referenceValue===e.referenceValue;case 8:return(function(s,r){return rr(s.geoPointValue.latitude)===rr(r.geoPointValue.latitude)&&rr(s.geoPointValue.longitude)===rr(r.geoPointValue.longitude)})(a,e);case 2:return(function(s,r){if("integerValue"in s&&"integerValue"in r)return rr(s.integerValue)===rr(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=rr(s.doubleValue),l=rr(r.doubleValue);return o===l?A3(o)===A3(l):isNaN(o)&&isNaN(l)}return!1})(a,e);case 9:return k_(a.arrayValue.values||[],e.arrayValue.values||[],df);case 10:case 11:return(function(s,r){const o=s.mapValue.fields||{},l=r.mapValue.fields||{};if(uz(o)!==uz(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!df(o[c],l[c])))return!1;return!0})(a,e);default:return na(52216,{left:a})}}function MS(a,e){return(a.values||[]).find((n=>df(n,e)))!==void 0}function O_(a,e){if(a===e)return 0;const n=o0(a),i=o0(e);if(n!==i)return li(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return li(a.booleanValue,e.booleanValue);case 2:return(function(r,o){const l=rr(r.integerValue||r.doubleValue),c=rr(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1})(a,e);case 3:return hz(a.timestampValue,e.timestampValue);case 4:return hz(wS(a),wS(e));case 5:return C6(a.stringValue,e.stringValue);case 6:return(function(r,o){const l=r0(r),c=r0(o);return l.compareTo(c)})(a.bytesValue,e.bytesValue);case 7:return(function(r,o){const l=r.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const h=li(l[u],c[u]);if(h!==0)return h}return li(l.length,c.length)})(a.referenceValue,e.referenceValue);case 8:return(function(r,o){const l=li(rr(r.latitude),rr(o.latitude));return l!==0?l:li(rr(r.longitude),rr(o.longitude))})(a.geoPointValue,e.geoPointValue);case 9:return fz(a.arrayValue,e.arrayValue);case 10:return(function(r,o){const l=r.fields||{},c=o.fields||{},u=l[v3]?.arrayValue,h=c[v3]?.arrayValue,f=li(u?.values?.length||0,h?.values?.length||0);return f!==0?f:fz(u,h)})(a.mapValue,e.mapValue);case 11:return(function(r,o){if(r===ME.mapValue&&o===ME.mapValue)return 0;if(r===ME.mapValue)return 1;if(o===ME.mapValue)return-1;const l=r.fields||{},c=Object.keys(l),u=o.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){const m=C6(c[f],h[f]);if(m!==0)return m;const A=O_(l[c[f]],u[h[f]]);if(A!==0)return A}return li(c.length,h.length)})(a.mapValue,e.mapValue);default:throw na(23264,{he:n})}}function hz(a,e){if(typeof a=="string"&&typeof e=="string"&&a.length===e.length)return li(a,e);const n=s0(a),i=s0(e),s=li(n.seconds,i.seconds);return s!==0?s:li(n.nanos,i.nanos)}function fz(a,e){const n=a.values||[],i=e.values||[];for(let s=0;s<n.length&&s<i.length;++s){const r=O_(n[s],i[s]);if(r)return r}return li(n.length,i.length)}function F_(a){return N6(a)}function N6(a){return"nullValue"in a?"null":"booleanValue"in a?""+a.booleanValue:"integerValue"in a?""+a.integerValue:"doubleValue"in a?""+a.doubleValue:"timestampValue"in a?(function(n){const i=s0(n);return`time(${i.seconds},${i.nanos})`})(a.timestampValue):"stringValue"in a?a.stringValue:"bytesValue"in a?(function(n){return r0(n).toBase64()})(a.bytesValue):"referenceValue"in a?(function(n){return Wn.fromName(n).toString()})(a.referenceValue):"geoPointValue"in a?(function(n){return`geo(${n.latitude},${n.longitude})`})(a.geoPointValue):"arrayValue"in a?(function(n){let i="[",s=!0;for(const r of n.values||[])s?s=!1:i+=",",i+=N6(r);return i+"]"})(a.arrayValue):"mapValue"in a?(function(n){const i=Object.keys(n.fields||{}).sort();let s="{",r=!0;for(const o of i)r?r=!1:s+=",",s+=`${o}:${N6(n.fields[o])}`;return s+"}"})(a.mapValue):na(61005,{value:a})}function kC(a){switch(o0(a)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=GR(a);return e?16+kC(e):16;case 5:return 2*a.stringValue.length;case 6:return r0(a.bytesValue).approximateByteSize();case 7:return a.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((s,r)=>s+kC(r)),0)})(a.arrayValue);case 10:case 11:return(function(i){let s=0;return x0(i.fields,((r,o)=>{s+=r.length+kC(o)})),s})(a.mapValue);default:throw na(13486,{value:a})}}function pz(a,e){return{referenceValue:`projects/${a.projectId}/databases/${a.database}/documents/${e.path.canonicalString()}`}}function R6(a){return!!a&&"integerValue"in a}function b8(a){return!!a&&"arrayValue"in a}function mz(a){return!!a&&"nullValue"in a}function gz(a){return!!a&&"doubleValue"in a&&isNaN(Number(a.doubleValue))}function OC(a){return!!a&&"mapValue"in a}function Che(a){return(a?.mapValue?.fields||{})[OX]?.stringValue===FX}function X2(a){if(a.geoPointValue)return{geoPointValue:{...a.geoPointValue}};if(a.timestampValue&&typeof a.timestampValue=="object")return{timestampValue:{...a.timestampValue}};if(a.mapValue){const e={mapValue:{fields:{}}};return x0(a.mapValue.fields,((n,i)=>e.mapValue.fields[n]=X2(i))),e}if(a.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(a.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=X2(a.arrayValue.values[n]);return e}return{...a}}function Nhe(a){return(((a.mapValue||{}).fields||{}).__type__||{}).stringValue===Mhe}class al{constructor(e){this.value=e}static empty(){return new al({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!OC(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=X2(n)}setAll(e){let n=Eo.emptyPath(),i={},s=[];e.forEach(((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,i,s),i={},s=[],n=l.popLast()}o?i[l.lastSegment()]=X2(o):s.push(l.lastSegment())}));const r=this.getFieldsMap(n);this.applyChanges(r,i,s)}delete(e){const n=this.field(e.popLast());OC(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return df(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=n.mapValue.fields[e.get(i)];OC(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,i){x0(n,((s,r)=>e[s]=r));for(const s of i)delete e[s]}clone(){return new al(X2(this.value))}}function jX(a){const e=[];return x0(a.fields,((n,i)=>{const s=new Eo([n]);if(OC(i)){const r=jX(i.mapValue).fields;if(r.length===0)e.push(s);else for(const o of r)e.push(s.child(o))}else e.push(s)})),new au(e)}class ro{constructor(e,n,i,s,r,o,l){this.key=e,this.documentType=n,this.version=i,this.readTime=s,this.createTime=r,this.data=o,this.documentState=l}static newInvalidDocument(e){return new ro(e,0,pa.min(),pa.min(),pa.min(),al.empty(),0)}static newFoundDocument(e,n,i,s){return new ro(e,1,n,pa.min(),i,s,0)}static newNoDocument(e,n){return new ro(e,2,n,pa.min(),pa.min(),al.empty(),0)}static newUnknownDocument(e,n){return new ro(e,3,n,pa.min(),pa.min(),al.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pa.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=al.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=al.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pa.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ro&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ro(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class _3{constructor(e,n){this.position=e,this.inclusive=n}}function Az(a,e,n){let i=0;for(let s=0;s<a.position.length;s++){const r=e[s],o=a.position[s];if(r.field.isKeyField()?i=Wn.comparator(Wn.fromName(o.referenceValue),n.key):i=O_(o,n.data.field(r.field)),r.dir==="desc"&&(i*=-1),i!==0)break}return i}function yz(a,e){if(a===null)return e===null;if(e===null||a.inclusive!==e.inclusive||a.position.length!==e.position.length)return!1;for(let n=0;n<a.position.length;n++)if(!df(a.position[n],e.position[n]))return!1;return!0}class CS{constructor(e,n="asc"){this.field=e,this.dir=n}}function Rhe(a,e){return a.dir===e.dir&&a.field.isEqual(e.field)}class BX{}class xr extends BX{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new Ihe(e,n,i):n==="array-contains"?new khe(e,i):n==="in"?new Ohe(e,i):n==="not-in"?new Fhe(e,i):n==="array-contains-any"?new jhe(e,i):new xr(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new Lhe(e,i):new Dhe(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(O_(n,this.value)):n!==null&&o0(this.value)===o0(n)&&this.matchesComparison(O_(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return na(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Wd extends BX{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Wd(e,n)}matches(e){return UX(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function UX(a){return a.op==="and"}function VX(a){return Phe(a)&&UX(a)}function Phe(a){for(const e of a.filters)if(e instanceof Wd)return!1;return!0}function P6(a){if(a instanceof xr)return a.field.canonicalString()+a.op.toString()+F_(a.value);if(VX(a))return a.filters.map((e=>P6(e))).join(",");{const e=a.filters.map((n=>P6(n))).join(",");return`${a.op}(${e})`}}function zX(a,e){return a instanceof xr?(function(i,s){return s instanceof xr&&i.op===s.op&&i.field.isEqual(s.field)&&df(i.value,s.value)})(a,e):a instanceof Wd?(function(i,s){return s instanceof Wd&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((r,o,l)=>r&&zX(o,s.filters[l])),!0):!1})(a,e):void na(19439)}function GX(a){return a instanceof xr?(function(n){return`${n.field.canonicalString()} ${n.op} ${F_(n.value)}`})(a):a instanceof Wd?(function(n){return n.op.toString()+" {"+n.getFilters().map(GX).join(" ,")+"}"})(a):"Filter"}class Ihe extends xr{constructor(e,n,i){super(e,n,i),this.key=Wn.fromName(i.referenceValue)}matches(e){const n=Wn.comparator(e.key,this.key);return this.matchesComparison(n)}}class Lhe extends xr{constructor(e,n){super(e,"in",n),this.keys=qX("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class Dhe extends xr{constructor(e,n){super(e,"not-in",n),this.keys=qX("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function qX(a,e){return(e.arrayValue?.values||[]).map((n=>Wn.fromName(n.referenceValue)))}class khe extends xr{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return b8(n)&&MS(n.arrayValue,this.value)}}class Ohe extends xr{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&MS(this.value.arrayValue,n)}}class Fhe extends xr{constructor(e,n){super(e,"not-in",n)}matches(e){if(MS(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!MS(this.value.arrayValue,n)}}class jhe extends xr{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!b8(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>MS(this.value.arrayValue,i)))}}class Bhe{constructor(e,n=null,i=[],s=[],r=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=s,this.limit=r,this.startAt=o,this.endAt=l,this.Te=null}}function vz(a,e=null,n=[],i=[],s=null,r=null,o=null){return new Bhe(a,e,n,i,s,r,o)}function S8(a){const e=ya(a);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>P6(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(r){return r.field.canonicalString()+r.dir})(i))).join(","),ST(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>F_(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>F_(i))).join(",")),e.Te=n}return e.Te}function T8(a,e){if(a.limit!==e.limit||a.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<a.orderBy.length;n++)if(!Rhe(a.orderBy[n],e.orderBy[n]))return!1;if(a.filters.length!==e.filters.length)return!1;for(let n=0;n<a.filters.length;n++)if(!zX(a.filters[n],e.filters[n]))return!1;return a.collectionGroup===e.collectionGroup&&!!a.path.isEqual(e.path)&&!!yz(a.startAt,e.startAt)&&yz(a.endAt,e.endAt)}function I6(a){return Wn.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}class Nx{constructor(e,n=null,i=[],s=[],r=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=s,this.limit=r,this.limitType=o,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function Uhe(a,e,n,i,s,r,o,l){return new Nx(a,e,n,i,s,r,o,l)}function qR(a){return new Nx(a)}function _z(a){return a.filters.length===0&&a.limit===null&&a.startAt==null&&a.endAt==null&&(a.explicitOrderBy.length===0||a.explicitOrderBy.length===1&&a.explicitOrderBy[0].field.isKeyField())}function Vhe(a){return Wn.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}function HX(a){return a.collectionGroup!==null}function Q2(a){const e=ya(a);if(e.Ie===null){e.Ie=[];const n=new Set;for(const r of e.explicitOrderBy)e.Ie.push(r),n.add(r.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Vr(Eo.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((u=>{u.isInequality()&&(l=l.add(u.field))}))})),l})(e).forEach((r=>{n.has(r.canonicalString())||r.isKeyField()||e.Ie.push(new CS(r,i))})),n.has(Eo.keyField().canonicalString())||e.Ie.push(new CS(Eo.keyField(),i))}return e.Ie}function Xh(a){const e=ya(a);return e.Ee||(e.Ee=WX(e,Q2(a))),e.Ee}function zhe(a){const e=ya(a);return e.Re||(e.Re=WX(e,a.explicitOrderBy)),e.Re}function WX(a,e){if(a.limitType==="F")return vz(a.path,a.collectionGroup,e,a.filters,a.limit,a.startAt,a.endAt);{e=e.map((s=>{const r=s.dir==="desc"?"asc":"desc";return new CS(s.field,r)}));const n=a.endAt?new _3(a.endAt.position,a.endAt.inclusive):null,i=a.startAt?new _3(a.startAt.position,a.startAt.inclusive):null;return vz(a.path,a.collectionGroup,e,a.filters,a.limit,n,i)}}function L6(a,e){const n=a.filters.concat([e]);return new Nx(a.path,a.collectionGroup,a.explicitOrderBy.slice(),n,a.limit,a.limitType,a.startAt,a.endAt)}function Ghe(a,e){const n=a.explicitOrderBy.concat([e]);return new Nx(a.path,a.collectionGroup,n,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}function x3(a,e,n){return new Nx(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),e,n,a.startAt,a.endAt)}function HR(a,e){return T8(Xh(a),Xh(e))&&a.limitType===e.limitType}function $X(a){return`${S8(Xh(a))}|lt:${a.limitType}`}function Xv(a){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((s=>GX(s))).join(", ")}]`),ST(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((s=>F_(s))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((s=>F_(s))).join(",")),`Target(${i})`})(Xh(a))}; limitType=${a.limitType})`}function WR(a,e){return e.isFoundDocument()&&(function(i,s){const r=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(r):Wn.isDocumentKey(i.path)?i.path.isEqual(r):i.path.isImmediateParentOf(r)})(a,e)&&(function(i,s){for(const r of Q2(i))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0})(a,e)&&(function(i,s){for(const r of i.filters)if(!r.matches(s))return!1;return!0})(a,e)&&(function(i,s){return!(i.startAt&&!(function(o,l,c){const u=Az(o,l,c);return o.inclusive?u<=0:u<0})(i.startAt,Q2(i),s)||i.endAt&&!(function(o,l,c){const u=Az(o,l,c);return o.inclusive?u>=0:u>0})(i.endAt,Q2(i),s))})(a,e)}function qhe(a){return a.collectionGroup||(a.path.length%2==1?a.path.lastSegment():a.path.get(a.path.length-2))}function KX(a){return(e,n)=>{let i=!1;for(const s of Q2(a)){const r=Hhe(s,e,n);if(r!==0)return r;i=i||s.field.isKeyField()}return 0}}function Hhe(a,e,n){const i=a.field.isKeyField()?Wn.comparator(e.key,n.key):(function(r,o,l){const c=o.data.field(r),u=l.data.field(r);return c!==null&&u!==null?O_(c,u):na(42886)})(a.field,e,n);switch(a.dir){case"asc":return i;case"desc":return-1*i;default:return na(19790,{direction:a.dir})}}class a1{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[s,r]of i)if(this.equalsFn(s,e))return r}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return void(s[r]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[n]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){x0(this.inner,((n,i)=>{for(const[s,r]of i)e(s,r)}))}isEmpty(){return RX(this.inner)}size(){return this.innerSize}}const Whe=new Vs(Wn.comparator);function dm(){return Whe}const YX=new Vs(Wn.comparator);function R2(...a){let e=YX;for(const n of a)e=e.insert(n.key,n);return e}function XX(a){let e=YX;return a.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function jA(){return J2()}function QX(){return J2()}function J2(){return new a1((a=>a.toString()),((a,e)=>a.isEqual(e)))}const $he=new Vs(Wn.comparator),Khe=new Vr(Wn.comparator);function ui(...a){let e=Khe;for(const n of a)e=e.add(n);return e}const Yhe=new Vr(li);function Xhe(){return Yhe}function w8(a,e){if(a.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:A3(e)?"-0":e}}function JX(a){return{integerValue:""+a}}function ZX(a,e){return _he(e)?JX(e):w8(a,e)}class $R{constructor(){this._=void 0}}function Qhe(a,e,n){return a instanceof NS?(function(s,r){const o={fields:{[LX]:{stringValue:IX},[kX]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&x8(r)&&(r=GR(r)),r&&(o.fields[DX]=r),{mapValue:o}})(n,e):a instanceof j_?tQ(a,e):a instanceof RS?nQ(a,e):(function(s,r){const o=eQ(s,r),l=xz(o)+xz(s.Ae);return R6(o)&&R6(s.Ae)?JX(l):w8(s.serializer,l)})(a,e)}function Jhe(a,e,n){return a instanceof j_?tQ(a,e):a instanceof RS?nQ(a,e):n}function eQ(a,e){return a instanceof PS?(function(i){return R6(i)||(function(r){return!!r&&"doubleValue"in r})(i)})(e)?e:{integerValue:0}:null}class NS extends $R{}class j_ extends $R{constructor(e){super(),this.elements=e}}function tQ(a,e){const n=aQ(e);for(const i of a.elements)n.some((s=>df(s,i)))||n.push(i);return{arrayValue:{values:n}}}class RS extends $R{constructor(e){super(),this.elements=e}}function nQ(a,e){let n=aQ(e);for(const i of a.elements)n=n.filter((s=>!df(s,i)));return{arrayValue:{values:n}}}class PS extends $R{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function xz(a){return rr(a.integerValue||a.doubleValue)}function aQ(a){return b8(a)&&a.arrayValue.values?a.arrayValue.values.slice():[]}class E8{constructor(e,n){this.field=e,this.transform=n}}function Zhe(a,e){return a.field.isEqual(e.field)&&(function(i,s){return i instanceof j_&&s instanceof j_||i instanceof RS&&s instanceof RS?k_(i.elements,s.elements,df):i instanceof PS&&s instanceof PS?df(i.Ae,s.Ae):i instanceof NS&&s instanceof NS})(a.transform,e.transform)}class efe{constructor(e,n){this.version=e,this.transformResults=n}}class Mo{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Mo}static exists(e){return new Mo(void 0,e)}static updateTime(e){return new Mo(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function FC(a,e){return a.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(a.updateTime):a.exists===void 0||a.exists===e.isFoundDocument()}class KR{}function iQ(a,e){if(!a.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return a.isNoDocument()?new YR(a.key,Mo.none()):new TT(a.key,a.data,Mo.none());{const n=a.data,i=al.empty();let s=new Vr(Eo.comparator);for(let r of e.fields)if(!s.has(r)){let o=n.field(r);o===null&&r.length>1&&(r=r.popLast(),o=n.field(r)),o===null?i.delete(r):i.set(r,o),s=s.add(r)}return new b0(a.key,i,new au(s.toArray()),Mo.none())}}function tfe(a,e,n){a instanceof TT?(function(s,r,o){const l=s.value.clone(),c=Sz(s.fieldTransforms,r,o.transformResults);l.setAll(c),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(a,e,n):a instanceof b0?(function(s,r,o){if(!FC(s.precondition,r))return void r.convertToUnknownDocument(o.version);const l=Sz(s.fieldTransforms,r,o.transformResults),c=r.data;c.setAll(sQ(s)),c.setAll(l),r.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(a,e,n):(function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,n)}function Z2(a,e,n,i){return a instanceof TT?(function(r,o,l,c){if(!FC(r.precondition,o))return l;const u=r.value.clone(),h=Tz(r.fieldTransforms,c,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null})(a,e,n,i):a instanceof b0?(function(r,o,l,c){if(!FC(r.precondition,o))return l;const u=Tz(r.fieldTransforms,c,o),h=o.data;return h.setAll(sQ(r)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map((f=>f.field)))})(a,e,n,i):(function(r,o,l){return FC(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(a,e,n)}function nfe(a,e){let n=null;for(const i of a.fieldTransforms){const s=e.data.field(i.field),r=eQ(i.transform,s||null);r!=null&&(n===null&&(n=al.empty()),n.set(i.field,r))}return n||null}function bz(a,e){return a.type===e.type&&!!a.key.isEqual(e.key)&&!!a.precondition.isEqual(e.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&k_(i,s,((r,o)=>Zhe(r,o)))})(a.fieldTransforms,e.fieldTransforms)&&(a.type===0?a.value.isEqual(e.value):a.type!==1||a.data.isEqual(e.data)&&a.fieldMask.isEqual(e.fieldMask))}class TT extends KR{constructor(e,n,i,s=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class b0 extends KR{constructor(e,n,i,s,r=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function sQ(a){const e=new Map;return a.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=a.data.field(n);e.set(n,i)}})),e}function Sz(a,e,n){const i=new Map;fi(a.length===n.length,32656,{Ve:n.length,de:a.length});for(let s=0;s<n.length;s++){const r=a[s],o=r.transform,l=e.data.field(r.field);i.set(r.field,Jhe(o,l,n[s]))}return i}function Tz(a,e,n){const i=new Map;for(const s of a){const r=s.transform,o=n.data.field(s.field);i.set(s.field,Qhe(r,o,e))}return i}class YR extends KR{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class rQ extends KR{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class afe{constructor(e,n,i,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(e.key)&&tfe(r,e,i[s])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=Z2(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=Z2(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=QX();return this.mutations.forEach((s=>{const r=e.get(s.key),o=r.overlayedDocument;let l=this.applyToLocalView(o,r.mutatedFields);l=n.has(s.key)?null:l;const c=iQ(o,l);c!==null&&i.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(pa.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),ui())}isEqual(e){return this.batchId===e.batchId&&k_(this.mutations,e.mutations,((n,i)=>bz(n,i)))&&k_(this.baseMutations,e.baseMutations,((n,i)=>bz(n,i)))}}class M8{constructor(e,n,i,s){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=s}static from(e,n,i){fi(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let s=(function(){return $he})();const r=e.mutations;for(let o=0;o<r.length;o++)s=s.insert(r[o].key,i[o].version);return new M8(e,n,i,s)}}class ife{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class sfe{constructor(e,n,i){this.alias=e,this.aggregateType=n,this.fieldPath=i}}class rfe{constructor(e,n){this.count=e,this.unchangedNames=n}}var Ar,gi;function oQ(a){switch(a){case jt.OK:return na(64938);case jt.CANCELLED:case jt.UNKNOWN:case jt.DEADLINE_EXCEEDED:case jt.RESOURCE_EXHAUSTED:case jt.INTERNAL:case jt.UNAVAILABLE:case jt.UNAUTHENTICATED:return!1;case jt.INVALID_ARGUMENT:case jt.NOT_FOUND:case jt.ALREADY_EXISTS:case jt.PERMISSION_DENIED:case jt.FAILED_PRECONDITION:case jt.ABORTED:case jt.OUT_OF_RANGE:case jt.UNIMPLEMENTED:case jt.DATA_LOSS:return!0;default:return na(15467,{code:a})}}function lQ(a){if(a===void 0)return um("GRPC error has no .code"),jt.UNKNOWN;switch(a){case Ar.OK:return jt.OK;case Ar.CANCELLED:return jt.CANCELLED;case Ar.UNKNOWN:return jt.UNKNOWN;case Ar.DEADLINE_EXCEEDED:return jt.DEADLINE_EXCEEDED;case Ar.RESOURCE_EXHAUSTED:return jt.RESOURCE_EXHAUSTED;case Ar.INTERNAL:return jt.INTERNAL;case Ar.UNAVAILABLE:return jt.UNAVAILABLE;case Ar.UNAUTHENTICATED:return jt.UNAUTHENTICATED;case Ar.INVALID_ARGUMENT:return jt.INVALID_ARGUMENT;case Ar.NOT_FOUND:return jt.NOT_FOUND;case Ar.ALREADY_EXISTS:return jt.ALREADY_EXISTS;case Ar.PERMISSION_DENIED:return jt.PERMISSION_DENIED;case Ar.FAILED_PRECONDITION:return jt.FAILED_PRECONDITION;case Ar.ABORTED:return jt.ABORTED;case Ar.OUT_OF_RANGE:return jt.OUT_OF_RANGE;case Ar.UNIMPLEMENTED:return jt.UNIMPLEMENTED;case Ar.DATA_LOSS:return jt.DATA_LOSS;default:return na(39323,{code:a})}}(gi=Ar||(Ar={}))[gi.OK=0]="OK",gi[gi.CANCELLED=1]="CANCELLED",gi[gi.UNKNOWN=2]="UNKNOWN",gi[gi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gi[gi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gi[gi.NOT_FOUND=5]="NOT_FOUND",gi[gi.ALREADY_EXISTS=6]="ALREADY_EXISTS",gi[gi.PERMISSION_DENIED=7]="PERMISSION_DENIED",gi[gi.UNAUTHENTICATED=16]="UNAUTHENTICATED",gi[gi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gi[gi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gi[gi.ABORTED=10]="ABORTED",gi[gi.OUT_OF_RANGE=11]="OUT_OF_RANGE",gi[gi.UNIMPLEMENTED=12]="UNIMPLEMENTED",gi[gi.INTERNAL=13]="INTERNAL",gi[gi.UNAVAILABLE=14]="UNAVAILABLE",gi[gi.DATA_LOSS=15]="DATA_LOSS";function ofe(){return new TextEncoder}const lfe=new $g([4294967295,4294967295],0);function wz(a){const e=ofe().encode(a),n=new vX;return n.update(e),new Uint8Array(n.digest())}function Ez(a){const e=new DataView(a.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new $g([n,i],0),new $g([s,r],0)]}class C8{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new P2(`Invalid padding: ${n}`);if(i<0)throw new P2(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new P2(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new P2(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=$g.fromNumber(this.ge)}ye(e,n,i){let s=e.add(n.multiply($g.fromNumber(i)));return s.compare(lfe)===1&&(s=new $g([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=wz(e),[i,s]=Ez(n);for(let r=0;r<this.hashCount;r++){const o=this.ye(i,s,r);if(!this.we(o))return!1}return!0}static create(e,n,i){const s=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new C8(r,s,n);return i.forEach((l=>o.insert(l))),o}insert(e){if(this.ge===0)return;const n=wz(e),[i,s]=Ez(n);for(let r=0;r<this.hashCount;r++){const o=this.ye(i,s,r);this.be(o)}}be(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class P2 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class XR{constructor(e,n,i,s,r){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const s=new Map;return s.set(e,wT.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new XR(pa.min(),s,new Vs(li),dm(),ui())}}class wT{constructor(e,n,i,s,r){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new wT(i,n,ui(),ui(),ui())}}class jC{constructor(e,n,i,s){this.Se=e,this.removedTargetIds=n,this.key=i,this.De=s}}class cQ{constructor(e,n){this.targetId=e,this.Ce=n}}class uQ{constructor(e,n,i=ko.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=s}}class Mz{constructor(){this.ve=0,this.Fe=Cz(),this.Me=ko.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ui(),n=ui(),i=ui();return this.Fe.forEach(((s,r)=>{switch(r){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:i=i.add(s);break;default:na(38017,{changeType:r})}})),new wT(this.Me,this.xe,e,n,i)}Ke(){this.Oe=!1,this.Fe=Cz()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,fi(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class cfe{constructor(e){this.Ge=e,this.ze=new Map,this.je=dm(),this.He=CE(),this.Je=CE(),this.Ze=new Vs(li)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:na(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,s)=>{this.rt(s)&&n(s)}))}st(e){const n=e.targetId,i=e.Ce.count,s=this.ot(n);if(s){const r=s.target;if(I6(r))if(i===0){const o=new Wn(r.path);this.et(n,o,ro.newNoDocument(o,pa.min()))}else fi(i===1,20013,{expectedCount:i});else{const o=this._t(n);if(o!==i){const l=this.ut(e),c=l?this.ct(l,e,o):1;if(c!==0){this.it(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:r=0}=n;let o,l;try{o=r0(i).toUint8Array()}catch(c){if(c instanceof PX)return D_("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new C8(o,s,r)}catch(c){return D_(c instanceof P2?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let s=0;return i.forEach((r=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;e.mightContain(l)||(this.et(n,r,null),s++)})),s}Tt(e){const n=new Map;this.ze.forEach(((r,o)=>{const l=this.ot(o);if(l){if(r.current&&I6(l.target)){const c=new Wn(l.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,ro.newNoDocument(c,e))}r.Be&&(n.set(o,r.ke()),r.Ke())}}));let i=ui();this.Je.forEach(((r,o)=>{let l=!0;o.forEachWhile((c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(i=i.add(r))})),this.je.forEach(((r,o)=>o.setReadTime(e)));const s=new XR(e,n,this.Ze,this.je,i);return this.je=dm(),this.He=CE(),this.Je=CE(),this.Ze=new Vs(li),s}Ye(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,i),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.qe(n,1):s.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new Mz,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new Vr(li),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new Vr(li),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||En("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Mz),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function CE(){return new Vs(Wn.comparator)}function Cz(){return new Vs(Wn.comparator)}const ufe={asc:"ASCENDING",desc:"DESCENDING"},dfe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},hfe={and:"AND",or:"OR"};class ffe{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function D6(a,e){return a.useProto3Json||ST(e)?e:{value:e}}function b3(a,e){return a.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dQ(a,e){return a.useProto3Json?e.toBase64():e.toUint8Array()}function pfe(a,e){return b3(a,e.toTimestamp())}function iu(a){return fi(!!a,49232),pa.fromTimestamp((function(n){const i=s0(n);return new bi(i.seconds,i.nanos)})(a))}function N8(a,e){return k6(a,e).canonicalString()}function k6(a,e){const n=(function(s){return new Qi(["projects",s.projectId,"databases",s.database])})(a).child("documents");return e===void 0?n:n.child(e)}function hQ(a){const e=Qi.fromString(a);return fi(vQ(e),10190,{key:e.toString()}),e}function S3(a,e){return N8(a.databaseId,e.path)}function eS(a,e){const n=hQ(e);if(n.get(1)!==a.databaseId.projectId)throw new pn(jt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+a.databaseId.projectId);if(n.get(3)!==a.databaseId.database)throw new pn(jt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+a.databaseId.database);return new Wn(pQ(n))}function fQ(a,e){return N8(a.databaseId,e)}function mfe(a){const e=hQ(a);return e.length===4?Qi.emptyPath():pQ(e)}function O6(a){return new Qi(["projects",a.databaseId.projectId,"databases",a.databaseId.database]).canonicalString()}function pQ(a){return fi(a.length>4&&a.get(4)==="documents",29091,{key:a.toString()}),a.popFirst(5)}function Nz(a,e,n){return{name:S3(a,e),fields:n.value.mapValue.fields}}function gfe(a,e){return"found"in e?(function(i,s){fi(!!s.found,43571),s.found.name,s.found.updateTime;const r=eS(i,s.found.name),o=iu(s.found.updateTime),l=s.found.createTime?iu(s.found.createTime):pa.min(),c=new al({mapValue:{fields:s.found.fields}});return ro.newFoundDocument(r,o,l,c)})(a,e):"missing"in e?(function(i,s){fi(!!s.missing,3894),fi(!!s.readTime,22933);const r=eS(i,s.missing),o=iu(s.readTime);return ro.newNoDocument(r,o)})(a,e):na(7234,{result:e})}function Afe(a,e){let n;if("targetChange"in e){e.targetChange;const i=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:na(39313,{state:u})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],r=(function(u,h){return u.useProto3Json?(fi(h===void 0||typeof h=="string",58123),ko.fromBase64String(h||"")):(fi(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),ko.fromUint8Array(h||new Uint8Array))})(a,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&(function(u){const h=u.code===void 0?jt.UNKNOWN:lQ(u.code);return new pn(h,u.message||"")})(o);n=new uQ(i,s,r,l||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=eS(a,i.document.name),r=iu(i.document.updateTime),o=i.document.createTime?iu(i.document.createTime):pa.min(),l=new al({mapValue:{fields:i.document.fields}}),c=ro.newFoundDocument(s,r,o,l),u=i.targetIds||[],h=i.removedTargetIds||[];n=new jC(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=eS(a,i.document),r=i.readTime?iu(i.readTime):pa.min(),o=ro.newNoDocument(s,r),l=i.removedTargetIds||[];n=new jC([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=eS(a,i.document),r=i.removedTargetIds||[];n=new jC([],r,s,null)}else{if(!("filter"in e))return na(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:r}=i,o=new rfe(s,r),l=i.targetId;n=new cQ(l,o)}}return n}function mQ(a,e){let n;if(e instanceof TT)n={update:Nz(a,e.key,e.value)};else if(e instanceof YR)n={delete:S3(a,e.key)};else if(e instanceof b0)n={update:Nz(a,e.key,e.data),updateMask:Efe(e.fieldMask)};else{if(!(e instanceof rQ))return na(16599,{dt:e.type});n={verify:S3(a,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(r,o){const l=o.transform;if(l instanceof NS)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof j_)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof RS)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof PS)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw na(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(s,r){return r.updateTime!==void 0?{updateTime:pfe(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:na(27497)})(a,e.precondition)),n}function yfe(a,e){return a&&a.length>0?(fi(e!==void 0,14353),a.map((n=>(function(s,r){let o=s.updateTime?iu(s.updateTime):iu(r);return o.isEqual(pa.min())&&(o=iu(r)),new efe(o,s.transformResults||[])})(n,e)))):[]}function vfe(a,e){return{documents:[fQ(a,e.path)]}}function gQ(a,e){const n={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=fQ(a,s);const r=(function(u){if(u.length!==0)return yQ(Wd.create(u,"and"))})(e.filters);r&&(n.structuredQuery.where=r);const o=(function(u){if(u.length!==0)return u.map((h=>(function(m){return{field:Mg(m.field),direction:Sfe(m.dir)}})(h)))})(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=D6(a,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:n,parent:s}}function _fe(a,e,n,i){const{ft:s,parent:r}=gQ(a,e),o={},l=[];let c=0;return n.forEach((u=>{const h="aggregate_"+c++;o[h]=u.alias,u.aggregateType==="count"?l.push({alias:h,count:{}}):u.aggregateType==="avg"?l.push({alias:h,avg:{field:Mg(u.fieldPath)}}):u.aggregateType==="sum"&&l.push({alias:h,sum:{field:Mg(u.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:r}}function xfe(a){let e=mfe(a.parent);const n=a.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){fi(i===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let r=[];n.where&&(r=(function(f){const m=AQ(f);return m instanceof Wd&&VX(m)?m.getFilters():[m]})(n.where));let o=[];n.orderBy&&(o=(function(f){return f.map((m=>(function(x){return new CS(Qv(x.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(x.direction))})(m)))})(n.orderBy));let l=null;n.limit&&(l=(function(f){let m;return m=typeof f=="object"?f.value:f,ST(m)?null:m})(n.limit));let c=null;n.startAt&&(c=(function(f){const m=!!f.before,A=f.values||[];return new _3(A,m)})(n.startAt));let u=null;return n.endAt&&(u=(function(f){const m=!f.before,A=f.values||[];return new _3(A,m)})(n.endAt)),Uhe(e,s,o,r,l,"F",c,u)}function bfe(a,e){const n=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return na(28987,{purpose:s})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function AQ(a){return a.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Qv(n.unaryFilter.field);return xr.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=Qv(n.unaryFilter.field);return xr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Qv(n.unaryFilter.field);return xr.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Qv(n.unaryFilter.field);return xr.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return na(61313);default:return na(60726)}})(a):a.fieldFilter!==void 0?(function(n){return xr.create(Qv(n.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return na(58110);default:return na(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(a):a.compositeFilter!==void 0?(function(n){return Wd.create(n.compositeFilter.filters.map((i=>AQ(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return na(1026)}})(n.compositeFilter.op))})(a):na(30097,{filter:a})}function Sfe(a){return ufe[a]}function Tfe(a){return dfe[a]}function wfe(a){return hfe[a]}function Mg(a){return{fieldPath:a.canonicalString()}}function Qv(a){return Eo.fromServerFormat(a.fieldPath)}function yQ(a){return a instanceof xr?(function(n){if(n.op==="=="){if(gz(n.value))return{unaryFilter:{field:Mg(n.field),op:"IS_NAN"}};if(mz(n.value))return{unaryFilter:{field:Mg(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(gz(n.value))return{unaryFilter:{field:Mg(n.field),op:"IS_NOT_NAN"}};if(mz(n.value))return{unaryFilter:{field:Mg(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mg(n.field),op:Tfe(n.op),value:n.value}}})(a):a instanceof Wd?(function(n){const i=n.getFilters().map((s=>yQ(s)));return i.length===1?i[0]:{compositeFilter:{op:wfe(n.op),filters:i}}})(a):na(54877,{filter:a})}function Efe(a){const e=[];return a.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function vQ(a){return a.length>=4&&a.get(0)==="projects"&&a.get(2)==="databases"}function _Q(a){return!!a&&typeof a._toProto=="function"&&a._protoValueType==="ProtoValue"}class Og{constructor(e,n,i,s,r=pa.min(),o=pa.min(),l=ko.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Og(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Og(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Og(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Og(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Mfe{constructor(e){this.yt=e}}function Cfe(a){const e=xfe({parent:a.parent,structuredQuery:a.structuredQuery});return a.limitType==="LAST"?x3(e,e.limit,"L"):e}class Nfe{constructor(){this.Sn=new Rfe}addToCollectionParentIndex(e,n){return this.Sn.add(n),Kt.resolve()}getCollectionParents(e,n){return Kt.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return Kt.resolve()}deleteFieldIndex(e,n){return Kt.resolve()}deleteAllFieldIndexes(e){return Kt.resolve()}createTargetIndexes(e,n){return Kt.resolve()}getDocumentsMatchingTarget(e,n){return Kt.resolve(null)}getIndexType(e,n){return Kt.resolve(0)}getFieldIndexes(e,n){return Kt.resolve([])}getNextCollectionGroupToUpdate(e){return Kt.resolve(null)}getMinOffset(e,n){return Kt.resolve(i0.min())}getMinOffsetFromCollectionGroup(e,n){return Kt.resolve(i0.min())}updateCollectionGroup(e,n,i){return Kt.resolve()}updateIndexEntries(e,n){return Kt.resolve()}}class Rfe{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),s=this.index[n]||new Vr(Qi.comparator),r=!s.has(i);return this.index[n]=s.add(i),r}has(e){const n=e.lastSegment(),i=e.popLast(),s=this.index[n];return s&&s.has(i)}getEntries(e){return(this.index[e]||new Vr(Qi.comparator)).toArray()}}const Rz={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xQ=41943040;class oc{static withCacheSize(e){return new oc(e,oc.DEFAULT_COLLECTION_PERCENTILE,oc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}oc.DEFAULT_COLLECTION_PERCENTILE=10,oc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oc.DEFAULT=new oc(xQ,oc.DEFAULT_COLLECTION_PERCENTILE,oc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oc.DISABLED=new oc(-1,0,0);class B_{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new B_(0)}static ar(){return new B_(-1)}}const Pz="LruGarbageCollector",Pfe=1048576;function Iz([a,e],[n,i]){const s=li(a,n);return s===0?li(e,i):s}class Ife{constructor(e){this.Pr=e,this.buffer=new Vr(Iz),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Iz(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Lfe{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){En(Pz,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Cx(n)?En(Pz,"Ignoring IndexedDB error during garbage collection: ",n):await Mx(n)}await this.Ar(3e5)}))}}class Dfe{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return Kt.resolve(zR.ce);const i=new Ife(n);return this.Vr.forEachTarget(e,(s=>i.Er(s.sequenceNumber))).next((()=>this.Vr.mr(e,(s=>i.Er(s))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.Vr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(En("LruGarbageCollector","Garbage collection skipped; disabled"),Kt.resolve(Rz)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(En("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Rz):this.gr(e,n)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let i,s,r,o,l,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((f=>(f>this.params.maximumSequenceNumbersToCollect?(En("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s)))).next((f=>(i=f,l=Date.now(),this.removeTargets(e,i,n)))).next((f=>(r=f,c=Date.now(),this.removeOrphanedDocuments(e,i)))).next((f=>(u=Date.now(),Yv()<=ri.DEBUG&&En("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${r} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),Kt.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:f}))))}}function kfe(a,e){return new Dfe(a,e)}class Ofe{constructor(){this.changes=new a1((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ro.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?Kt.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ffe{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class jfe{constructor(e,n,i,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((s=>(i=s,this.remoteDocumentCache.getEntry(e,n)))).next((s=>(i!==null&&Z2(i.mutation,s,au.empty(),bi.now()),s)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,ui()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=ui()){const s=jA();return this.populateOverlays(e,s,n).next((()=>this.computeViews(e,n,s,i).next((r=>{let o=R2();return r.forEach(((l,c)=>{o=o.insert(l,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,n){const i=jA();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,ui())))}populateOverlays(e,n,i){const s=[];return i.forEach((r=>{n.has(r)||s.push(r)})),this.documentOverlayCache.getOverlays(e,s).next((r=>{r.forEach(((o,l)=>{n.set(o,l)}))}))}computeViews(e,n,i,s){let r=dm();const o=J2(),l=(function(){return J2()})();return n.forEach(((c,u)=>{const h=i.get(u.key);s.has(u.key)&&(h===void 0||h.mutation instanceof b0)?r=r.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Z2(h.mutation,u,h.mutation.getFieldMask(),bi.now())):o.set(u.key,au.empty())})),this.recalculateAndSaveOverlays(e,r).next((c=>(c.forEach(((u,h)=>o.set(u,h))),n.forEach(((u,h)=>l.set(u,new Ffe(h,o.get(u)??null)))),l)))}recalculateAndSaveOverlays(e,n){const i=J2();let s=new Vs(((o,l)=>o-l)),r=ui();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((o=>{for(const l of o)l.keys().forEach((c=>{const u=n.get(c);if(u===null)return;let h=i.get(c)||au.empty();h=l.applyToLocalView(u,h),i.set(c,h);const f=(s.get(l.batchId)||ui()).add(c);s=s.insert(l.batchId,f)}))})).next((()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,h=c.value,f=QX();h.forEach((m=>{if(!r.has(m)){const A=iQ(n.get(m),i.get(m));A!==null&&f.set(m,A),r=r.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return Kt.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,s){return Vhe(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):HX(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,s):this.getDocumentsMatchingCollectionQuery(e,n,i,s)}getNextDocuments(e,n,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,s).next((r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,s-r.size):Kt.resolve(jA());let l=TS,c=r;return o.next((u=>Kt.forEach(u,((h,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),r.get(h)?Kt.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{c=c.insert(h,m)}))))).next((()=>this.populateOverlays(e,u,r))).next((()=>this.computeViews(e,c,u,ui()))).next((h=>({batchId:l,changes:XX(h)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Wn(n)).next((i=>{let s=R2();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,s){const r=n.collectionGroup;let o=R2();return this.indexManager.getCollectionParents(e,r).next((l=>Kt.forEach(l,(c=>{const u=(function(f,m){return new Nx(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(n,c.child(r));return this.getDocumentsMatchingCollectionQuery(e,u,i,s).next((h=>{h.forEach(((f,m)=>{o=o.insert(f,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,n,i,s){let r;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,r,s)))).next((o=>{r.forEach(((c,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,ro.newInvalidDocument(h)))}));let l=R2();return o.forEach(((c,u)=>{const h=r.get(c);h!==void 0&&Z2(h.mutation,u,au.empty(),bi.now()),WR(n,u)&&(l=l.insert(c,u))})),l}))}}class Bfe{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return Kt.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,(function(s){return{id:s.id,version:s.version,createTime:iu(s.createTime)}})(n)),Kt.resolve()}getNamedQuery(e,n){return Kt.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,(function(s){return{name:s.name,query:Cfe(s.bundledQuery),readTime:iu(s.readTime)}})(n)),Kt.resolve()}}class Ufe{constructor(){this.overlays=new Vs(Wn.comparator),this.Lr=new Map}getOverlay(e,n){return Kt.resolve(this.overlays.get(n))}getOverlays(e,n){const i=jA();return Kt.forEach(n,(s=>this.getOverlay(e,s).next((r=>{r!==null&&i.set(s,r)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((s,r)=>{this.bt(e,n,r)})),Kt.resolve()}removeOverlaysForBatchId(e,n,i){const s=this.Lr.get(i);return s!==void 0&&(s.forEach((r=>this.overlays=this.overlays.remove(r))),this.Lr.delete(i)),Kt.resolve()}getOverlaysForCollection(e,n,i){const s=jA(),r=n.length+1,o=new Wn(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===r&&c.largestBatchId>i&&s.set(c.getKey(),c)}return Kt.resolve(s)}getOverlaysForCollectionGroup(e,n,i,s){let r=new Vs(((u,h)=>u-h));const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>i){let h=r.get(u.largestBatchId);h===null&&(h=jA(),r=r.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=jA(),c=r.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((u,h)=>l.set(u,h))),!(l.size()>=s)););return Kt.resolve(l)}bt(e,n,i){const s=this.overlays.get(i.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(i.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new ife(n,i));let r=this.Lr.get(n);r===void 0&&(r=ui(),this.Lr.set(n,r)),this.Lr.set(n,r.add(i.key))}}class Vfe{constructor(){this.sessionToken=ko.EMPTY_BYTE_STRING}getSessionToken(e){return Kt.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Kt.resolve()}}class R8{constructor(){this.kr=new Vr(io.Kr),this.qr=new Vr(io.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const i=new io(e,n);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Wr(new io(e,n))}Qr(e,n){e.forEach((i=>this.removeReference(i,n)))}Gr(e){const n=new Wn(new Qi([])),i=new io(n,e),s=new io(n,e+1),r=[];return this.qr.forEachInRange([i,s],(o=>{this.Wr(o),r.push(o.key)})),r}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new Wn(new Qi([])),i=new io(n,e),s=new io(n,e+1);let r=ui();return this.qr.forEachInRange([i,s],(o=>{r=r.add(o.key)})),r}containsKey(e){const n=new io(e,0),i=this.kr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class io{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return Wn.comparator(e.key,n.key)||li(e.Hr,n.Hr)}static Ur(e,n){return li(e.Hr,n.Hr)||Wn.comparator(e.key,n.key)}}class zfe{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new Vr(io.Kr)}checkEmpty(e){return Kt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,s){const r=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new afe(r,n,i,s);this.mutationQueue.push(o);for(const l of s)this.Jr=this.Jr.add(new io(l.key,r)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Kt.resolve(o)}lookupMutationBatch(e,n){return Kt.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,s=this.Xr(i),r=s<0?0:s;return Kt.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Kt.resolve(this.mutationQueue.length===0?_8:this.Yn-1)}getAllMutationBatches(e){return Kt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new io(n,0),s=new io(n,Number.POSITIVE_INFINITY),r=[];return this.Jr.forEachInRange([i,s],(o=>{const l=this.Zr(o.Hr);r.push(l)})),Kt.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new Vr(li);return n.forEach((s=>{const r=new io(s,0),o=new io(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([r,o],(l=>{i=i.add(l.Hr)}))})),Kt.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,s=i.length+1;let r=i;Wn.isDocumentKey(r)||(r=r.child(""));const o=new io(new Wn(r),0);let l=new Vr(li);return this.Jr.forEachWhile((c=>{const u=c.key.path;return!!i.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Hr)),!0)}),o),Kt.resolve(this.Yr(l))}Yr(e){const n=[];return e.forEach((i=>{const s=this.Zr(i);s!==null&&n.push(s)})),n}removeMutationBatch(e,n){fi(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Kt.forEach(n.mutations,(s=>{const r=new io(s.key,n.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,n){const i=new io(n,0),s=this.Jr.firstAfterOrEqual(i);return Kt.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Kt.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class Gfe{constructor(e){this.ti=e,this.docs=(function(){return new Vs(Wn.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,s=this.docs.get(i),r=s?s.size:0,o=this.ti(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return Kt.resolve(i?i.document.mutableCopy():ro.newInvalidDocument(n))}getEntries(e,n){let i=dm();return n.forEach((s=>{const r=this.docs.get(s);i=i.insert(s,r?r.document.mutableCopy():ro.newInvalidDocument(s))})),Kt.resolve(i)}getDocumentsMatchingQuery(e,n,i,s){let r=dm();const o=n.path,l=new Wn(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||ghe(mhe(h),i)<=0||(s.has(h.key)||WR(n,h))&&(r=r.insert(h.key,h.mutableCopy()))}return Kt.resolve(r)}getAllFromCollectionGroup(e,n,i,s){na(9500)}ni(e,n){return Kt.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new qfe(this)}getSize(e){return Kt.resolve(this.size)}}class qfe extends Ofe{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?n.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(i)})),Kt.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}class Hfe{constructor(e){this.persistence=e,this.ri=new a1((n=>S8(n)),T8),this.lastRemoteSnapshotVersion=pa.min(),this.highestTargetId=0,this.ii=0,this.si=new R8,this.targetCount=0,this.oi=B_._r()}forEachTarget(e,n){return this.ri.forEach(((i,s)=>n(s))),Kt.resolve()}getLastRemoteSnapshotVersion(e){return Kt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Kt.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Kt.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.ii&&(this.ii=n),Kt.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new B_(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,Kt.resolve()}updateTargetData(e,n){return this.lr(n),Kt.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,Kt.resolve()}removeTargets(e,n,i){let s=0;const r=[];return this.ri.forEach(((o,l)=>{l.sequenceNumber<=n&&i.get(l.targetId)===null&&(this.ri.delete(o),r.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)})),Kt.waitFor(r).next((()=>s))}getTargetCount(e){return Kt.resolve(this.targetCount)}getTargetData(e,n){const i=this.ri.get(n)||null;return Kt.resolve(i)}addMatchingKeys(e,n,i){return this.si.$r(n,i),Kt.resolve()}removeMatchingKeys(e,n,i){this.si.Qr(n,i);const s=this.persistence.referenceDelegate,r=[];return s&&n.forEach((o=>{r.push(s.markPotentiallyOrphaned(e,o))})),Kt.waitFor(r)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),Kt.resolve()}getMatchingKeysForTargetId(e,n){const i=this.si.jr(n);return Kt.resolve(i)}containsKey(e,n){return Kt.resolve(this.si.containsKey(n))}}class bQ{constructor(e,n){this._i={},this.overlays={},this.ai=new zR(0),this.ui=!1,this.ui=!0,this.ci=new Vfe,this.referenceDelegate=e(this),this.li=new Hfe(this),this.indexManager=new Nfe,this.remoteDocumentCache=(function(s){return new Gfe(s)})((i=>this.referenceDelegate.hi(i))),this.serializer=new Mfe(n),this.Pi=new Bfe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Ufe,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this._i[e.toKey()];return i||(i=new zfe(n,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,i){En("MemoryPersistence","Starting transaction:",e);const s=new Wfe(this.ai.next());return this.referenceDelegate.Ti(),i(s).next((r=>this.referenceDelegate.Ii(s).next((()=>r)))).toPromise().then((r=>(s.raiseOnCommittedEvent(),r)))}Ei(e,n){return Kt.or(Object.values(this._i).map((i=>()=>i.containsKey(e,n))))}}class Wfe extends yhe{constructor(e){super(),this.currentSequenceNumber=e}}class P8{constructor(e){this.persistence=e,this.Ri=new R8,this.Ai=null}static Vi(e){return new P8(e)}get di(){if(this.Ai)return this.Ai;throw na(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.di.delete(i.toString()),Kt.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.di.add(i.toString()),Kt.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),Kt.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach((s=>this.di.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((s=>{s.forEach((r=>this.di.add(r.toString())))})).next((()=>i.removeTargetData(e,n)))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Kt.forEach(this.di,(i=>{const s=Wn.fromPath(i);return this.mi(e,s).next((r=>{r||n.removeEntry(s,pa.min())}))})).next((()=>(this.Ai=null,n.apply(e))))}updateLimboDocument(e,n){return this.mi(e,n).next((i=>{i?this.di.delete(n.toString()):this.di.add(n.toString())}))}hi(e){return 0}mi(e,n){return Kt.or([()=>Kt.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class T3{constructor(e,n){this.persistence=e,this.fi=new a1((i=>xhe(i.path)),((i,s)=>i.isEqual(s))),this.garbageCollector=kfe(this,n)}static Vi(e,n){return new T3(e,n)}Ti(){}Ii(e){return Kt.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((s=>i+s))))}pr(e){let n=0;return this.mr(e,(i=>{n++})).next((()=>n))}mr(e,n){return Kt.forEach(this.fi,((i,s)=>this.wr(e,i,s).next((r=>r?Kt.resolve():n(s)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.ni(e,(o=>this.wr(e,o,n).next((l=>{l||(i++,r.removeEntry(o,pa.min()))})))).next((()=>r.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),Kt.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.fi.set(i,e.currentSequenceNumber),Kt.resolve()}removeReference(e,n,i){return this.fi.set(i,e.currentSequenceNumber),Kt.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),Kt.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=kC(e.data.value)),n}wr(e,n,i){return Kt.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.fi.get(n);return Kt.resolve(s!==void 0&&s>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class I8{constructor(e,n,i,s){this.targetId=e,this.fromCache=n,this.Ts=i,this.Is=s}static Es(e,n){let i=ui(),s=ui();for(const r of n.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new I8(e,n.fromCache,i,s)}}class $fe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Kfe{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return kue()?8:vhe(ml())>0?6:4})()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,s){const r={result:null};return this.gs(e,n).next((o=>{r.result=o})).next((()=>{if(!r.result)return this.ps(e,n,s,i).next((o=>{r.result=o}))})).next((()=>{if(r.result)return;const o=new $fe;return this.ys(e,n,o).next((l=>{if(r.result=l,this.As)return this.ws(e,n,o,l.size)}))})).next((()=>r.result))}ws(e,n,i,s){return i.documentReadCount<this.Vs?(Yv()<=ri.DEBUG&&En("QueryEngine","SDK will not create cache indexes for query:",Xv(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Kt.resolve()):(Yv()<=ri.DEBUG&&En("QueryEngine","Query:",Xv(n),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.ds*s?(Yv()<=ri.DEBUG&&En("QueryEngine","The SDK decides to create cache indexes for query:",Xv(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xh(n))):Kt.resolve())}gs(e,n){if(_z(n))return Kt.resolve(null);let i=Xh(n);return this.indexManager.getIndexType(e,i).next((s=>s===0?null:(n.limit!==null&&s===1&&(n=x3(n,null,"F"),i=Xh(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((r=>{const o=ui(...r);return this.fs.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((c=>{const u=this.bs(n,l);return this.Ss(n,u,o,c.readTime)?this.gs(e,x3(n,null,"F")):this.Ds(e,u,n,c)}))))})))))}ps(e,n,i,s){return _z(n)||s.isEqual(pa.min())?Kt.resolve(null):this.fs.getDocuments(e,i).next((r=>{const o=this.bs(n,r);return this.Ss(n,o,i,s)?Kt.resolve(null):(Yv()<=ri.DEBUG&&En("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Xv(n)),this.Ds(e,o,n,phe(s,TS)).next((l=>l)))}))}bs(e,n){let i=new Vr(KX(e));return n.forEach(((s,r)=>{WR(e,r)&&(i=i.add(r))})),i}Ss(e,n,i,s){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const r=e.limitType==="F"?n.last():n.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}ys(e,n,i){return Yv()<=ri.DEBUG&&En("QueryEngine","Using full collection scan to execute query:",Xv(n)),this.fs.getDocumentsMatchingQuery(e,n,i0.min(),i)}Ds(e,n,i,s){return this.fs.getDocumentsMatchingQuery(e,i,s).next((r=>(n.forEach((o=>{r=r.insert(o.key,o)})),r)))}}const L8="LocalStore",Yfe=3e8;class Xfe{constructor(e,n,i,s){this.persistence=e,this.Cs=n,this.serializer=s,this.vs=new Vs(li),this.Fs=new a1((r=>S8(r)),T8),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jfe(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.vs)))}}function Qfe(a,e,n,i){return new Xfe(a,e,n,i)}async function SQ(a,e){const n=ya(a);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return n.mutationQueue.getAllMutationBatches(i).next((r=>(s=r,n.Os(e),n.mutationQueue.getAllMutationBatches(i)))).next((r=>{const o=[],l=[];let c=ui();for(const u of s){o.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of r){l.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(i,c).next((u=>({Ns:u,removedBatchIds:o,addedBatchIds:l})))}))}))}function Jfe(a,e){const n=ya(a);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=e.batch.keys(),r=n.xs.newChangeBuffer({trackRemovals:!0});return(function(l,c,u,h){const f=u.batch,m=f.keys();let A=Kt.resolve();return m.forEach((x=>{A=A.next((()=>h.getEntry(c,x))).next((T=>{const E=u.docVersions.get(x);fi(E!==null,48541),T.version.compareTo(E)<0&&(f.applyToRemoteDocument(T,u),T.isValidDocument()&&(T.setReadTime(u.commitVersion),h.addEntry(T)))}))})),A.next((()=>l.mutationQueue.removeMutationBatch(c,f)))})(n,i,e,r).next((()=>r.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let c=ui();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c})(e)))).next((()=>n.localDocuments.getDocuments(i,s)))}))}function TQ(a){const e=ya(a);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.li.getLastRemoteSnapshotVersion(n)))}function Zfe(a,e){const n=ya(a),i=e.snapshotVersion;let s=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(r=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});s=n.vs;const l=[];e.targetChanges.forEach(((h,f)=>{const m=s.get(f);if(!m)return;l.push(n.li.removeMatchingKeys(r,h.removedDocuments,f).next((()=>n.li.addMatchingKeys(r,h.addedDocuments,f))));let A=m.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(f)!==null?A=A.withResumeToken(ko.EMPTY_BYTE_STRING,pa.min()).withLastLimboFreeSnapshotVersion(pa.min()):h.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(h.resumeToken,i)),s=s.insert(f,A),(function(T,E,M){return T.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=Yfe?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0})(m,A,h)&&l.push(n.li.updateTargetData(r,A))}));let c=dm(),u=ui();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(r,h))})),l.push(epe(r,o,e.documentUpdates).next((h=>{c=h.Bs,u=h.Ls}))),!i.isEqual(pa.min())){const h=n.li.getLastRemoteSnapshotVersion(r).next((f=>n.li.setTargetsMetadata(r,r.currentSequenceNumber,i)));l.push(h)}return Kt.waitFor(l).next((()=>o.apply(r))).next((()=>n.localDocuments.getLocalViewOfDocuments(r,c,u))).next((()=>c))})).then((r=>(n.vs=s,r)))}function epe(a,e,n){let i=ui(),s=ui();return n.forEach((r=>i=i.add(r))),e.getEntries(a,i).next((r=>{let o=dm();return n.forEach(((l,c)=>{const u=r.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(pa.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):En(L8,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)})),{Bs:o,Ls:s}}))}function tpe(a,e){const n=ya(a);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=_8),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function npe(a,e){const n=ya(a);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return n.li.getTargetData(i,e).next((r=>r?(s=r,Kt.resolve(s)):n.li.allocateTargetId(i).next((o=>(s=new Og(e,o,"TargetPurposeListen",i.currentSequenceNumber),n.li.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=n.vs.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.vs=n.vs.insert(i.targetId,i),n.Fs.set(e,i.targetId)),i}))}async function F6(a,e,n){const i=ya(a),s=i.vs.get(e),r=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",r,(o=>i.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!Cx(o))throw o;En(L8,`Failed to update sequence numbers for target ${e}: ${o}`)}i.vs=i.vs.remove(e),i.Fs.delete(s.target)}function Lz(a,e,n){const i=ya(a);let s=pa.min(),r=ui();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(c,u,h){const f=ya(c),m=f.Fs.get(h);return m!==void 0?Kt.resolve(f.vs.get(m)):f.li.getTargetData(u,h)})(i,o,Xh(e)).next((l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(o,l.targetId).next((c=>{r=c}))})).next((()=>i.Cs.getDocumentsMatchingQuery(o,e,n?s:pa.min(),n?r:ui()))).next((l=>(ape(i,qhe(e),l),{documents:l,ks:r})))))}function ape(a,e,n){let i=a.Ms.get(e)||pa.min();n.forEach(((s,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)})),a.Ms.set(e,i)}class Dz{constructor(){this.activeTargetIds=Xhe()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ipe{constructor(){this.vo=new Dz,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,i){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Dz,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class spe{Mo(e){}shutdown(){}}const kz="ConnectivityMonitor";class Oz{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){En(kz,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){En(kz,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let NE=null;function j6(){return NE===null?NE=(function(){return 268435456+Math.round(2147483648*Math.random())})():NE++,"0x"+NE.toString(16)}const ZL="RestConnection",rpe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class ope{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${i}/databases/${s}`,this.$o=this.databaseId.database===y3?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Wo(e,n,i,s,r){const o=j6(),l=this.Qo(e,n.toUriEncodedString());En(ZL,`Sending RPC '${e}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,s,r);const{host:u}=new URL(l),h=Tx(u);return this.zo(e,l,c,i,h).then((f=>(En(ZL,`Received RPC '${e}' ${o}: `,f),f)),(f=>{throw D_(ZL,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",i),f}))}jo(e,n,i,s,r,o){return this.Wo(e,n,i,s,r)}Go(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ex})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((s,r)=>e[r]=s)),i&&i.headers.forEach(((s,r)=>e[r]=s))}Qo(e,n){const i=rpe[e];let s=`${this.qo}/v1/${n}:${i}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}class lpe{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Xo="WebChannelConnection",jb=(a,e,n)=>{a.listen(e,(i=>{try{n(i)}catch(s){setTimeout((()=>{throw s}),0)}}))};class h_ extends ope{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!h_.c_){const e=SX();jb(e,bX.STAT_EVENT,(n=>{n.stat===M6.PROXY?En(Xo,"STAT_EVENT: detected buffering proxy"):n.stat===M6.NOPROXY&&En(Xo,"STAT_EVENT: detected no buffering proxy")})),h_.c_=!0}}zo(e,n,i,s,r){const o=j6();return new Promise(((l,c)=>{const u=new _X;u.setWithCredentials(!0),u.listenOnce(xX.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case DC.NO_ERROR:const f=u.getResponseJson();En(Xo,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case DC.TIMEOUT:En(Xo,`RPC '${e}' ${o} timed out`),c(new pn(jt.DEADLINE_EXCEEDED,"Request time out"));break;case DC.HTTP_ERROR:const m=u.getStatus();if(En(Xo,`RPC '${e}' ${o} failed with status:`,m,"response text:",u.getResponseText()),m>0){let A=u.getResponseJson();Array.isArray(A)&&(A=A[0]);const x=A?.error;if(x&&x.status&&x.message){const T=(function(M){const N=M.toLowerCase().replace(/_/g,"-");return Object.values(jt).indexOf(N)>=0?N:jt.UNKNOWN})(x.status);c(new pn(T,x.message))}else c(new pn(jt.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new pn(jt.UNAVAILABLE,"Connection failed."));break;default:na(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{En(Xo,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(s);En(Xo,`RPC '${e}' ${o} sending request:`,s),u.send(n,"POST",h,i,15)}))}T_(e,n,i){const s=j6(),r=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Go(l.initMessageHeaders,n,i),l.encodeInitMessageHeaders=!0;const u=r.join("");En(Xo,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=o.createWebChannel(u,l);this.I_(h);let f=!1,m=!1;const A=new lpe({Ho:x=>{m?En(Xo,`Not sending because RPC '${e}' stream ${s} is closed:`,x):(f||(En(Xo,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),En(Xo,`RPC '${e}' stream ${s} sending:`,x),h.send(x))},Jo:()=>h.close()});return jb(h,N2.EventType.OPEN,(()=>{m||(En(Xo,`RPC '${e}' stream ${s} transport opened.`),A.i_())})),jb(h,N2.EventType.CLOSE,(()=>{m||(m=!0,En(Xo,`RPC '${e}' stream ${s} transport closed`),A.o_(),this.E_(h))})),jb(h,N2.EventType.ERROR,(x=>{m||(m=!0,D_(Xo,`RPC '${e}' stream ${s} transport errored. Name:`,x.name,"Message:",x.message),A.o_(new pn(jt.UNAVAILABLE,"The operation could not be completed")))})),jb(h,N2.EventType.MESSAGE,(x=>{if(!m){const T=x.data[0];fi(!!T,16349);const E=T,M=E?.error||E[0]?.error;if(M){En(Xo,`RPC '${e}' stream ${s} received error:`,M);const N=M.status;let I=(function(O){const D=Ar[O];if(D!==void 0)return lQ(D)})(N),F=M.message;I===void 0&&(I=jt.INTERNAL,F="Unknown error status: "+N+" with message "+M.message),m=!0,A.o_(new pn(I,F)),h.close()}else En(Xo,`RPC '${e}' stream ${s} received:`,T),A.__(T)}})),h_.u_(),setTimeout((()=>{A.s_()}),0),A}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((n=>n===e))}Go(e,n,i){super.Go(e,n,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return TX()}}function cpe(a){return new h_(a)}function eD(){return typeof document<"u"?document:null}function QR(a){return new ffe(a,!0)}h_.c_=!1;class D8{constructor(e,n,i=1e3,s=1.5,r=6e4){this.Ci=e,this.timerId=n,this.R_=i,this.A_=s,this.V_=r,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-i);s>0&&En("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Fz="PersistentStream";class wQ{constructor(e,n,i,s,r,o,l,c){this.Ci=e,this.b_=i,this.S_=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new D8(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===jt.RESOURCE_EXHAUSTED?(um(n.toString()),um("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===jt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.D_===n&&this.G_(i,s)}),(i=>{e((()=>{const s=new pn(jt.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(s)}))}))}G_(e,n){const i=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((s=>{i((()=>this.z_(s)))})),this.stream.onMessage((s=>{i((()=>++this.F_==1?this.H_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return En(Fz,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget((()=>this.D_===e?n():(En(Fz,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class upe extends wQ{constructor(e,n,i,s,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,s,o),this.serializer=r}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=Afe(this.serializer,e),i=(function(r){if(!("targetChange"in r))return pa.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?pa.min():o.readTime?iu(o.readTime):pa.min()})(e);return this.listener.J_(n,i)}Z_(e){const n={};n.database=O6(this.serializer),n.addTarget=(function(r,o){let l;const c=o.target;if(l=I6(c)?{documents:vfe(r,c)}:{query:gQ(r,c).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=dQ(r,o.resumeToken);const u=D6(r,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(pa.min())>0){l.readTime=b3(r,o.snapshotVersion.toTimestamp());const u=D6(r,o.expectedCount);u!==null&&(l.expectedCount=u)}return l})(this.serializer,e);const i=bfe(this.serializer,e);i&&(n.labels=i),this.K_(n)}X_(e){const n={};n.database=O6(this.serializer),n.removeTarget=e,this.K_(n)}}class dpe extends wQ{constructor(e,n,i,s,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,s,o),this.serializer=r}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return fi(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,fi(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){fi(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=yfe(e.writeResults,e.commitTime),i=iu(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=O6(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>mQ(this.serializer,i)))};this.K_(n)}}class hpe{}class fpe extends hpe{constructor(e,n,i,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new pn(jt.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,o])=>this.connection.Wo(e,k6(n,i),s,r,o))).catch((r=>{throw r.name==="FirebaseError"?(r.code===jt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new pn(jt.UNKNOWN,r.toString())}))}jo(e,n,i,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.jo(e,k6(n,i),s,o,l,r))).catch((o=>{throw o.name==="FirebaseError"?(o.code===jt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new pn(jt.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function ppe(a,e,n,i){return new fpe(a,e,n,i)}class mpe{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(um(n),this.aa=!1):En("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const oy="RemoteStore";class gpe{constructor(e,n,i,s,r){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=r,this.Aa.Mo((o=>{i.enqueueAndForget((async()=>{i1(this)&&(En(oy,"Restarting streams for network reachability change."),await(async function(c){const u=ya(c);u.Ea.add(4),await ET(u),u.Va.set("Unknown"),u.Ea.delete(4),await JR(u)})(this))}))})),this.Va=new mpe(i,s)}}async function JR(a){if(i1(a))for(const e of a.Ra)await e(!0)}async function ET(a){for(const e of a.Ra)await e(!1)}function EQ(a,e){const n=ya(a);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),j8(n)?F8(n):Rx(n).O_()&&O8(n,e))}function k8(a,e){const n=ya(a),i=Rx(n);n.Ia.delete(e),i.O_()&&MQ(n,e),n.Ia.size===0&&(i.O_()?i.L_():i1(n)&&n.Va.set("Unknown"))}function O8(a,e){if(a.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pa.min())>0){const n=a.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Rx(a).Z_(e)}function MQ(a,e){a.da.$e(e),Rx(a).X_(e)}function F8(a){a.da=new cfe({getRemoteKeysForTarget:e=>a.remoteSyncer.getRemoteKeysForTarget(e),At:e=>a.Ia.get(e)||null,ht:()=>a.datastore.serializer.databaseId}),Rx(a).start(),a.Va.ua()}function j8(a){return i1(a)&&!Rx(a).x_()&&a.Ia.size>0}function i1(a){return ya(a).Ea.size===0}function CQ(a){a.da=void 0}async function Ape(a){a.Va.set("Online")}async function ype(a){a.Ia.forEach(((e,n)=>{O8(a,e)}))}async function vpe(a,e){CQ(a),j8(a)?(a.Va.ha(e),F8(a)):a.Va.set("Unknown")}async function _pe(a,e,n){if(a.Va.set("Online"),e instanceof uQ&&e.state===2&&e.cause)try{await(async function(s,r){const o=r.cause;for(const l of r.targetIds)s.Ia.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Ia.delete(l),s.da.removeTarget(l))})(a,e)}catch(i){En(oy,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await w3(a,i)}else if(e instanceof jC?a.da.Xe(e):e instanceof cQ?a.da.st(e):a.da.tt(e),!n.isEqual(pa.min()))try{const i=await TQ(a.localStore);n.compareTo(i)>=0&&await(function(r,o){const l=r.da.Tt(o);return l.targetChanges.forEach(((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=r.Ia.get(u);h&&r.Ia.set(u,h.withResumeToken(c.resumeToken,o))}})),l.targetMismatches.forEach(((c,u)=>{const h=r.Ia.get(c);if(!h)return;r.Ia.set(c,h.withResumeToken(ko.EMPTY_BYTE_STRING,h.snapshotVersion)),MQ(r,c);const f=new Og(h.target,c,u,h.sequenceNumber);O8(r,f)})),r.remoteSyncer.applyRemoteEvent(l)})(a,n)}catch(i){En(oy,"Failed to raise snapshot:",i),await w3(a,i)}}async function w3(a,e,n){if(!Cx(e))throw e;a.Ea.add(1),await ET(a),a.Va.set("Offline"),n||(n=()=>TQ(a.localStore)),a.asyncQueue.enqueueRetryable((async()=>{En(oy,"Retrying IndexedDB access"),await n(),a.Ea.delete(1),await JR(a)}))}function NQ(a,e){return e().catch((n=>w3(a,n,e)))}async function ZR(a){const e=ya(a),n=l0(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:_8;for(;xpe(e);)try{const s=await tpe(e.localStore,i);if(s===null){e.Ta.length===0&&n.L_();break}i=s.batchId,bpe(e,s)}catch(s){await w3(e,s)}RQ(e)&&PQ(e)}function xpe(a){return i1(a)&&a.Ta.length<10}function bpe(a,e){a.Ta.push(e);const n=l0(a);n.O_()&&n.Y_&&n.ea(e.mutations)}function RQ(a){return i1(a)&&!l0(a).x_()&&a.Ta.length>0}function PQ(a){l0(a).start()}async function Spe(a){l0(a).ra()}async function Tpe(a){const e=l0(a);for(const n of a.Ta)e.ea(n.mutations)}async function wpe(a,e,n){const i=a.Ta.shift(),s=M8.from(i,e,n);await NQ(a,(()=>a.remoteSyncer.applySuccessfulWrite(s))),await ZR(a)}async function Epe(a,e){e&&l0(a).Y_&&await(async function(i,s){if((function(o){return oQ(o)&&o!==jt.ABORTED})(s.code)){const r=i.Ta.shift();l0(i).B_(),await NQ(i,(()=>i.remoteSyncer.rejectFailedWrite(r.batchId,s))),await ZR(i)}})(a,e),RQ(a)&&PQ(a)}async function jz(a,e){const n=ya(a);n.asyncQueue.verifyOperationInProgress(),En(oy,"RemoteStore received new credentials");const i=i1(n);n.Ea.add(3),await ET(n),i&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await JR(n)}async function Mpe(a,e){const n=ya(a);e?(n.Ea.delete(2),await JR(n)):e||(n.Ea.add(2),await ET(n),n.Va.set("Unknown"))}function Rx(a){return a.ma||(a.ma=(function(n,i,s){const r=ya(n);return r.sa(),new upe(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(a.datastore,a.asyncQueue,{Zo:Ape.bind(null,a),Yo:ype.bind(null,a),t_:vpe.bind(null,a),J_:_pe.bind(null,a)}),a.Ra.push((async e=>{e?(a.ma.B_(),j8(a)?F8(a):a.Va.set("Unknown")):(await a.ma.stop(),CQ(a))}))),a.ma}function l0(a){return a.fa||(a.fa=(function(n,i,s){const r=ya(n);return r.sa(),new dpe(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(a.datastore,a.asyncQueue,{Zo:()=>Promise.resolve(),Yo:Spe.bind(null,a),t_:Epe.bind(null,a),ta:Tpe.bind(null,a),na:wpe.bind(null,a)}),a.Ra.push((async e=>{e?(a.fa.B_(),await ZR(a)):(await a.fa.stop(),a.Ta.length>0&&(En(oy,`Stopping write stream with ${a.Ta.length} pending writes`),a.Ta=[]))}))),a.fa}class B8{constructor(e,n,i,s,r){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=s,this.removalCallback=r,this.deferred=new Vd,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,s,r){const o=Date.now()+i,l=new B8(e,n,o,s,r);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pn(jt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function U8(a,e){if(um("AsyncQueue",`${e}: ${a}`),Cx(a))return new pn(jt.UNAVAILABLE,`${e}: ${a}`);throw a}class f_{static emptySet(e){return new f_(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||Wn.comparator(n.key,i.key):(n,i)=>Wn.comparator(n.key,i.key),this.keyedMap=R2(),this.sortedSet=new Vs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof f_)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,r=i.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new f_;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class Bz{constructor(){this.ga=new Vs(Wn.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):na(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class U_{constructor(e,n,i,s,r,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,i,s,r){const o=[];return n.forEach((l=>{o.push({type:0,doc:l})})),new U_(e,n,f_.emptySet(n),o,i,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&HR(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==i[s].type||!n[s].doc.isEqual(i[s].doc))return!1;return!0}}class Cpe{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class Npe{constructor(){this.queries=Uz(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const s=ya(n),r=s.queries;s.queries=Uz(),r.forEach(((o,l)=>{for(const c of l.ba)c.onError(i)}))})(this,new pn(jt.ABORTED,"Firestore shutting down"))}}function Uz(){return new a1((a=>$X(a)),HR)}async function V8(a,e){const n=ya(a);let i=3;const s=e.query;let r=n.queries.get(s);r?!r.Sa()&&e.Da()&&(i=2):(r=new Cpe,i=e.Da()?0:1);try{switch(i){case 0:r.wa=await n.onListen(s,!0);break;case 1:r.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=U8(o,`Initialization of query '${Xv(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,r),r.ba.push(e),e.va(n.onlineState),r.wa&&e.Fa(r.wa)&&G8(n)}async function z8(a,e){const n=ya(a),i=e.query;let s=3;const r=n.queries.get(i);if(r){const o=r.ba.indexOf(e);o>=0&&(r.ba.splice(o,1),r.ba.length===0?s=e.Da()?0:1:!r.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function Rpe(a,e){const n=ya(a);let i=!1;for(const s of e){const r=s.query,o=n.queries.get(r);if(o){for(const l of o.ba)l.Fa(s)&&(i=!0);o.wa=s}}i&&G8(n)}function Ppe(a,e,n){const i=ya(a),s=i.queries.get(e);if(s)for(const r of s.ba)r.onError(n);i.queries.delete(e)}function G8(a){a.Ca.forEach((e=>{e.next()}))}var B6,Vz;(Vz=B6||(B6={})).Ma="default",Vz.Cache="cache";class q8{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new U_(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=U_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==B6.Cache}}class IQ{constructor(e){this.key=e}}class LQ{constructor(e){this.key=e}}class Ipe{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ui(),this.mutatedKeys=ui(),this.eu=KX(e),this.tu=new f_(this.eu)}get nu(){return this.Za}ru(e,n){const i=n?n.iu:new Bz,s=n?n.tu:this.tu;let r=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((h,f)=>{const m=s.get(h),A=WR(this.query,f)?f:null,x=!!m&&this.mutatedKeys.has(m.key),T=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let E=!1;m&&A?m.data.isEqual(A.data)?x!==T&&(i.track({type:3,doc:A}),E=!0):this.su(m,A)||(i.track({type:2,doc:A}),E=!0,(c&&this.eu(A,c)>0||u&&this.eu(A,u)<0)&&(l=!0)):!m&&A?(i.track({type:0,doc:A}),E=!0):m&&!A&&(i.track({type:1,doc:m}),E=!0,(c||u)&&(l=!0)),E&&(A?(o=o.add(A),r=T?r.add(h):r.delete(h)):(o=o.delete(h),r=r.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),r=r.delete(h.key),i.track({type:1,doc:h})}return{tu:o,iu:i,Ss:l,mutatedKeys:r}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,s){const r=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,f)=>(function(A,x){const T=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return na(20277,{Vt:E})}};return T(A)-T(x)})(h.type,f.type)||this.eu(h.doc,f.doc))),this.ou(i),s=s??!1;const l=n&&!s?this._u():[],c=this.Ya.size===0&&this.current&&!s?1:0,u=c!==this.Xa;return this.Xa=c,o.length!==0||u?{snapshot:new U_(this.query,e.tu,r,o,e.mutatedKeys,c===0,u,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Bz,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Za=this.Za.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Za=this.Za.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=ui(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const n=[];return e.forEach((i=>{this.Ya.has(i)||n.push(new LQ(i))})),this.Ya.forEach((i=>{e.has(i)||n.push(new IQ(i))})),n}cu(e){this.Za=e.ks,this.Ya=ui();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return U_.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const H8="SyncEngine";class Lpe{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class Dpe{constructor(e){this.key=e,this.hu=!1}}class kpe{constructor(e,n,i,s,r,o){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new a1((l=>$X(l)),HR),this.Iu=new Map,this.Eu=new Set,this.Ru=new Vs(Wn.comparator),this.Au=new Map,this.Vu=new R8,this.du={},this.mu=new Map,this.fu=B_.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Ope(a,e,n=!0){const i=BQ(a);let s;const r=i.Tu.get(e);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.lu()):s=await DQ(i,e,n,!0),s}async function Fpe(a,e){const n=BQ(a);await DQ(n,e,!0,!1)}async function DQ(a,e,n,i){const s=await npe(a.localStore,Xh(e)),r=s.targetId,o=a.sharedClientState.addLocalQueryTarget(r,n);let l;return i&&(l=await jpe(a,e,r,o==="current",s.resumeToken)),a.isPrimaryClient&&n&&EQ(a.remoteStore,s),l}async function jpe(a,e,n,i,s){a.pu=(f,m,A)=>(async function(T,E,M,N){let I=E.view.ru(M);I.Ss&&(I=await Lz(T.localStore,E.query,!1).then((({documents:D})=>E.view.ru(D,I))));const F=N&&N.targetChanges.get(E.targetId),G=N&&N.targetMismatches.get(E.targetId)!=null,O=E.view.applyChanges(I,T.isPrimaryClient,F,G);return Gz(T,E.targetId,O.au),O.snapshot})(a,f,m,A);const r=await Lz(a.localStore,e,!0),o=new Ipe(e,r.ks),l=o.ru(r.documents),c=wT.createSynthesizedTargetChangeForCurrentChange(n,i&&a.onlineState!=="Offline",s),u=o.applyChanges(l,a.isPrimaryClient,c);Gz(a,n,u.au);const h=new Lpe(e,n,o);return a.Tu.set(e,h),a.Iu.has(n)?a.Iu.get(n).push(e):a.Iu.set(n,[e]),u.snapshot}async function Bpe(a,e,n){const i=ya(a),s=i.Tu.get(e),r=i.Iu.get(s.targetId);if(r.length>1)return i.Iu.set(s.targetId,r.filter((o=>!HR(o,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await F6(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),n&&k8(i.remoteStore,s.targetId),U6(i,s.targetId)})).catch(Mx)):(U6(i,s.targetId),await F6(i.localStore,s.targetId,!0))}async function Upe(a,e){const n=ya(a),i=n.Tu.get(e),s=n.Iu.get(i.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),k8(n.remoteStore,i.targetId))}async function Vpe(a,e,n){const i=Kpe(a);try{const s=await(function(o,l){const c=ya(o),u=bi.now(),h=l.reduce(((A,x)=>A.add(x.key)),ui());let f,m;return c.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let x=dm(),T=ui();return c.xs.getEntries(A,h).next((E=>{x=E,x.forEach(((M,N)=>{N.isValidDocument()||(T=T.add(M))}))})).next((()=>c.localDocuments.getOverlayedDocuments(A,x))).next((E=>{f=E;const M=[];for(const N of l){const I=nfe(N,f.get(N.key).overlayedDocument);I!=null&&M.push(new b0(N.key,I,jX(I.value.mapValue),Mo.exists(!0)))}return c.mutationQueue.addMutationBatch(A,u,M,l)})).next((E=>{m=E;const M=E.applyToLocalDocumentSet(f,T);return c.documentOverlayCache.saveOverlays(A,E.batchId,M)}))})).then((()=>({batchId:m.batchId,changes:XX(f)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),(function(o,l,c){let u=o.du[o.currentUser.toKey()];u||(u=new Vs(li)),u=u.insert(l,c),o.du[o.currentUser.toKey()]=u})(i,s.batchId,n),await MT(i,s.changes),await ZR(i.remoteStore)}catch(s){const r=U8(s,"Failed to persist write");n.reject(r)}}async function kQ(a,e){const n=ya(a);try{const i=await Zfe(n.localStore,e);e.targetChanges.forEach(((s,r)=>{const o=n.Au.get(r);o&&(fi(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?fi(o.hu,14607):s.removedDocuments.size>0&&(fi(o.hu,42227),o.hu=!1))})),await MT(n,i,e)}catch(i){await Mx(i)}}function zz(a,e,n){const i=ya(a);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const s=[];i.Tu.forEach(((r,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)})),(function(o,l){const c=ya(o);c.onlineState=l;let u=!1;c.queries.forEach(((h,f)=>{for(const m of f.ba)m.va(l)&&(u=!0)})),u&&G8(c)})(i.eventManager,e),s.length&&i.Pu.J_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function zpe(a,e,n){const i=ya(a);i.sharedClientState.updateQueryState(e,"rejected",n);const s=i.Au.get(e),r=s&&s.key;if(r){let o=new Vs(Wn.comparator);o=o.insert(r,ro.newNoDocument(r,pa.min()));const l=ui().add(r),c=new XR(pa.min(),new Map,new Vs(li),o,l);await kQ(i,c),i.Ru=i.Ru.remove(r),i.Au.delete(e),W8(i)}else await F6(i.localStore,e,!1).then((()=>U6(i,e,n))).catch(Mx)}async function Gpe(a,e){const n=ya(a),i=e.batch.batchId;try{const s=await Jfe(n.localStore,e);FQ(n,i,null),OQ(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await MT(n,s)}catch(s){await Mx(s)}}async function qpe(a,e,n){const i=ya(a);try{const s=await(function(o,l){const c=ya(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let h;return c.mutationQueue.lookupMutationBatch(u,l).next((f=>(fi(f!==null,37113),h=f.keys(),c.mutationQueue.removeMutationBatch(u,f)))).next((()=>c.mutationQueue.performConsistencyCheck(u))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,l))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h))).next((()=>c.localDocuments.getDocuments(u,h)))}))})(i.localStore,e);FQ(i,e,n),OQ(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await MT(i,s)}catch(s){await Mx(s)}}function OQ(a,e){(a.mu.get(e)||[]).forEach((n=>{n.resolve()})),a.mu.delete(e)}function FQ(a,e,n){const i=ya(a);let s=i.du[i.currentUser.toKey()];if(s){const r=s.get(e);r&&(n?r.reject(n):r.resolve(),s=s.remove(e)),i.du[i.currentUser.toKey()]=s}}function U6(a,e,n=null){a.sharedClientState.removeLocalQueryTarget(e);for(const i of a.Iu.get(e))a.Tu.delete(i),n&&a.Pu.yu(i,n);a.Iu.delete(e),a.isPrimaryClient&&a.Vu.Gr(e).forEach((i=>{a.Vu.containsKey(i)||jQ(a,i)}))}function jQ(a,e){a.Eu.delete(e.path.canonicalString());const n=a.Ru.get(e);n!==null&&(k8(a.remoteStore,n),a.Ru=a.Ru.remove(e),a.Au.delete(n),W8(a))}function Gz(a,e,n){for(const i of n)i instanceof IQ?(a.Vu.addReference(i.key,e),Hpe(a,i)):i instanceof LQ?(En(H8,"Document no longer in limbo: "+i.key),a.Vu.removeReference(i.key,e),a.Vu.containsKey(i.key)||jQ(a,i.key)):na(19791,{wu:i})}function Hpe(a,e){const n=e.key,i=n.path.canonicalString();a.Ru.get(n)||a.Eu.has(i)||(En(H8,"New document in limbo: "+n),a.Eu.add(i),W8(a))}function W8(a){for(;a.Eu.size>0&&a.Ru.size<a.maxConcurrentLimboResolutions;){const e=a.Eu.values().next().value;a.Eu.delete(e);const n=new Wn(Qi.fromString(e)),i=a.fu.next();a.Au.set(i,new Dpe(n)),a.Ru=a.Ru.insert(n,i),EQ(a.remoteStore,new Og(Xh(qR(n.path)),i,"TargetPurposeLimboResolution",zR.ce))}}async function MT(a,e,n){const i=ya(a),s=[],r=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,c)=>{o.push(i.pu(c,e,n).then((u=>{if((u||n)&&i.isPrimaryClient){const h=u?!u.fromCache:n?.targetChanges.get(c.targetId)?.current;i.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=I8.Es(c.targetId,u);r.push(h)}})))})),await Promise.all(o),i.Pu.J_(s),await(async function(c,u){const h=ya(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(f=>Kt.forEach(u,(m=>Kt.forEach(m.Ts,(A=>h.persistence.referenceDelegate.addReference(f,m.targetId,A))).next((()=>Kt.forEach(m.Is,(A=>h.persistence.referenceDelegate.removeReference(f,m.targetId,A)))))))))}catch(f){if(!Cx(f))throw f;En(L8,"Failed to update sequence numbers: "+f)}for(const f of u){const m=f.targetId;if(!f.fromCache){const A=h.vs.get(m),x=A.snapshotVersion,T=A.withLastLimboFreeSnapshotVersion(x);h.vs=h.vs.insert(m,T)}}})(i.localStore,r))}async function Wpe(a,e){const n=ya(a);if(!n.currentUser.isEqual(e)){En(H8,"User change. New user:",e.toKey());const i=await SQ(n.localStore,e);n.currentUser=e,(function(r,o){r.mu.forEach((l=>{l.forEach((c=>{c.reject(new pn(jt.CANCELLED,o))}))})),r.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await MT(n,i.Ns)}}function $pe(a,e){const n=ya(a),i=n.Au.get(e);if(i&&i.hu)return ui().add(i.key);{let s=ui();const r=n.Iu.get(e);if(!r)return s;for(const o of r){const l=n.Tu.get(o);s=s.unionWith(l.view.nu)}return s}}function BQ(a){const e=ya(a);return e.remoteStore.remoteSyncer.applyRemoteEvent=kQ.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$pe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=zpe.bind(null,e),e.Pu.J_=Rpe.bind(null,e.eventManager),e.Pu.yu=Ppe.bind(null,e.eventManager),e}function Kpe(a){const e=ya(a);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Gpe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qpe.bind(null,e),e}class E3{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=QR(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return Qfe(this.persistence,new Kfe,e.initialUser,this.serializer)}Cu(e){return new bQ(P8.Vi,this.serializer)}Du(e){return new ipe}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}E3.provider={build:()=>new E3};class Ype extends E3{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){fi(this.persistence.referenceDelegate instanceof T3,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new Lfe(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?oc.withCacheSize(this.cacheSizeBytes):oc.DEFAULT;return new bQ((i=>T3.Vi(i,n)),this.serializer)}}class V6{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>zz(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=Wpe.bind(null,this.syncEngine),await Mpe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Npe})()}createDatastore(e){const n=QR(e.databaseInfo.databaseId),i=cpe(e.databaseInfo);return ppe(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,s,r,o,l){return new gpe(i,s,r,o,l)})(this.localStore,this.datastore,e.asyncQueue,(n=>zz(this.syncEngine,n,0)),(function(){return Oz.v()?new Oz:new spe})())}createSyncEngine(e,n){return(function(s,r,o,l,c,u,h){const f=new kpe(s,r,o,l,c,u);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=ya(n);En(oy,"RemoteStore shutting down."),i.Ea.add(5),await ET(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}V6.provider={build:()=>new V6};class $8{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):um("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}let Xpe=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new pn(jt.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await(async function(s,r){const o=ya(s),l={documents:r.map((f=>S3(o.serializer,f)))},c=await o.jo("BatchGetDocuments",o.serializer.databaseId,Qi.emptyPath(),l,r.length),u=new Map;c.forEach((f=>{const m=gfe(o.serializer,f);u.set(m.key.toString(),m)}));const h=[];return r.forEach((f=>{const m=u.get(f.toString());fi(!!m,55234,{key:f}),h.push(m)})),h})(this.datastore,e);return n.forEach((i=>this.recordVersion(i))),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new YR(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((n=>{e.delete(n.key.toString())})),e.forEach(((n,i)=>{const s=Wn.fromPath(i);this.mutations.push(new rQ(s,this.precondition(s)))})),await(async function(i,s){const r=ya(i),o={writes:s.map((l=>mQ(r.serializer,l)))};await r.Wo("Commit",r.serializer.databaseId,Qi.emptyPath(),o)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw na(50498,{Gu:e.constructor.name});n=pa.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!n.isEqual(i))throw new pn(jt.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(pa.min())?Mo.exists(!1):Mo.updateTime(n):Mo.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(pa.min()))throw new pn(jt.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Mo.updateTime(n)}return Mo.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};class Qpe{constructor(e,n,i,s,r){this.asyncQueue=e,this.datastore=n,this.options=i,this.updateFunction=s,this.deferred=r,this.zu=i.maxAttempts,this.M_=new D8(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new Xpe(this.datastore),n=this.Ju(e);n&&n.then((i=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(i)})).catch((s=>{this.Zu(s)}))))})).catch((i=>{this.Zu(i)}))}))}Ju(e){try{const n=this.updateFunction(e);return!ST(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if(e?.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!oQ(n)}return!1}}const c0="FirestoreClient";class Jpe{constructor(e,n,i,s,r){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this._databaseInfo=s,this.user=nl.UNAUTHENTICATED,this.clientId=v8.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(i,(async o=>{En(c0,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(En(c0,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Vd;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=U8(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function tD(a,e){a.asyncQueue.verifyOperationInProgress(),En(c0,"Initializing OfflineComponentProvider");const n=a.configuration;await e.initialize(n);let i=n.initialUser;a.setCredentialChangeListener((async s=>{i.isEqual(s)||(await SQ(e.localStore,s),i=s)})),e.persistence.setDatabaseDeletedListener((()=>a.terminate())),a._offlineComponents=e}async function qz(a,e){a.asyncQueue.verifyOperationInProgress();const n=await Zpe(a);En(c0,"Initializing OnlineComponentProvider"),await e.initialize(n,a.configuration),a.setCredentialChangeListener((i=>jz(e.remoteStore,i))),a.setAppCheckTokenChangeListener(((i,s)=>jz(e.remoteStore,s))),a._onlineComponents=e}async function Zpe(a){if(!a._offlineComponents)if(a._uninitializedComponentsProvider){En(c0,"Using user provided OfflineComponentProvider");try{await tD(a,a._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(s){return s.name==="FirebaseError"?s.code===jt.FAILED_PRECONDITION||s.code===jt.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(n))throw n;D_("Error using user provided cache. Falling back to memory cache: "+n),await tD(a,new E3)}}else En(c0,"Using default OfflineComponentProvider"),await tD(a,new Ype(void 0));return a._offlineComponents}async function K8(a){return a._onlineComponents||(a._uninitializedComponentsProvider?(En(c0,"Using user provided OnlineComponentProvider"),await qz(a,a._uninitializedComponentsProvider._online)):(En(c0,"Using default OnlineComponentProvider"),await qz(a,new V6))),a._onlineComponents}function eme(a){return K8(a).then((e=>e.syncEngine))}function UQ(a){return K8(a).then((e=>e.datastore))}async function M3(a){const e=await K8(a),n=e.eventManager;return n.onListen=Ope.bind(null,e.syncEngine),n.onUnlisten=Bpe.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Fpe.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Upe.bind(null,e.syncEngine),n}function tme(a,e,n,i){const s=new $8(i),r=new q8(e,s,n);return a.asyncQueue.enqueueAndForget((async()=>V8(await M3(a),r))),()=>{s.Nu(),a.asyncQueue.enqueueAndForget((async()=>z8(await M3(a),r)))}}function nme(a,e,n={}){const i=new Vd;return a.asyncQueue.enqueueAndForget((async()=>(function(r,o,l,c,u){const h=new $8({next:m=>{h.Nu(),o.enqueueAndForget((()=>z8(r,f)));const A=m.docs.has(l);!A&&m.fromCache?u.reject(new pn(jt.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&m.fromCache&&c&&c.source==="server"?u.reject(new pn(jt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new q8(qR(l.path),h,{includeMetadataChanges:!0,Ka:!0});return V8(r,f)})(await M3(a),a.asyncQueue,e,n,i))),i.promise}function ame(a,e,n={}){const i=new Vd;return a.asyncQueue.enqueueAndForget((async()=>(function(r,o,l,c,u){const h=new $8({next:m=>{h.Nu(),o.enqueueAndForget((()=>z8(r,f))),m.fromCache&&c.source==="server"?u.reject(new pn(jt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new q8(l,h,{includeMetadataChanges:!0,Ka:!0});return V8(r,f)})(await M3(a),a.asyncQueue,e,n,i))),i.promise}function ime(a,e,n){const i=new Vd;return a.asyncQueue.enqueueAndForget((async()=>{try{const s=await UQ(a);i.resolve((async function(o,l,c){const u=ya(o),{request:h,gt:f,parent:m}=_fe(u.serializer,zhe(l),c);u.connection.Ko||delete h.parent;const A=(await u.jo("RunAggregationQuery",u.serializer.databaseId,m,h,1)).filter((T=>!!T.result));fi(A.length===1,64727);const x=A[0].result?.aggregateFields;return Object.keys(x).reduce(((T,E)=>(T[f[E]]=x[E],T)),{})})(s,e,n))}catch(s){i.reject(s)}})),i.promise}function sme(a,e){const n=new Vd;return a.asyncQueue.enqueueAndForget((async()=>Vpe(await eme(a),e,n))),n.promise}function rme(a,e,n){const i=new Vd;return a.asyncQueue.enqueueAndForget((async()=>{const s=await UQ(a);new Qpe(a.asyncQueue,s,n,e,i).ju()})),i.promise}function VQ(a){const e={};return a.timeoutSeconds!==void 0&&(e.timeoutSeconds=a.timeoutSeconds),e}const ome="ComponentProvider",Hz=new Map;function lme(a,e,n,i,s){return new whe(a,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,VQ(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,i)}const zQ="firestore.googleapis.com",Wz=!0;class $z{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new pn(jt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=zQ,this.ssl=Wz}else this.host=e.host,this.ssl=e.ssl??Wz;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=xQ;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Pfe)throw new pn(jt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hhe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=VQ(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new pn(jt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new pn(jt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new pn(jt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class eP{constructor(e,n,i,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $z({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pn(jt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new pn(jt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $z(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new nhe;switch(i.type){case"firstParty":return new rhe(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new pn(jt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=Hz.get(n);i&&(En(ome,"Removing Datastore"),Hz.delete(n),i.terminate())})(this),Promise.resolve()}}function cme(a,e,n,i={}){a=ul(a,eP);const s=Tx(e),r=a._getSettings(),o={...r,emulatorOptions:a._getEmulatorOptions()},l=`${e}:${n}`;s&&(dX(`https://${l}`),hX("Firestore",!0)),r.host!==zQ&&r.host!==l&&D_("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...r,host:l,ssl:s,emulatorOptions:i};if(!a0(c,o)&&(a._setSettings(c),i.mockUserToken)){let u,h;if(typeof i.mockUserToken=="string")u=i.mockUserToken,h=nl.MOCK_USER;else{u=Eue(i.mockUserToken,a._app?.options.projectId);const f=i.mockUserToken.sub||i.mockUserToken.user_id;if(!f)throw new pn(jt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new nl(f)}a._authCredentials=new ahe(new EX(u,h))}}class Pm{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Pm(this.firestore,e,this._query)}}class Us{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Us(this.firestore,e,this._key)}toJSON(){return{type:Us._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(bT(n,Us._jsonSchema))return new Us(e,i||null,new Wn(Qi.fromString(n.referencePath)))}}Us._jsonSchemaVersion="firestore/documentReference/1.0",Us._jsonSchema={type:br("string",Us._jsonSchemaVersion),referencePath:br("string")};class Kg extends Pm{constructor(e,n,i){super(e,n,qR(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Us(this.firestore,null,new Wn(e))}withConverter(e){return new Kg(this.firestore,e,this._path)}}function du(a,e,...n){if(a=nr(a),MX("collection","path",e),a instanceof eP){const i=Qi.fromString(e,...n);return rz(i),new Kg(a,null,i)}{if(!(a instanceof Us||a instanceof Kg))throw new pn(jt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=a._path.child(Qi.fromString(e,...n));return rz(i),new Kg(a.firestore,null,i)}}function Ra(a,e,...n){if(a=nr(a),arguments.length===1&&(e=v8.newId()),MX("doc","path",e),a instanceof eP){const i=Qi.fromString(e,...n);return sz(i),new Us(a,null,new Wn(i))}{if(!(a instanceof Us||a instanceof Kg))throw new pn(jt.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=a._path.child(Qi.fromString(e,...n));return sz(i),new Us(a.firestore,a instanceof Kg?a.converter:null,new Wn(i))}}const Kz="AsyncQueue";class Yz{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new D8(this,"async_queue_retry"),this._c=()=>{const i=eD();i&&En(Kz,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=eD();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=eD();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Vd;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Cx(e))throw e;En(Kz,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,um("INTERNAL UNHANDLED ERROR: ",Xz(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=B8.createAndSchedule(this,e,n,i,(r=>this.hc(r)));return this.tc.push(s),s}uc(){this.nc&&na(47125,{Pc:Xz(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Xz(a){let e=a.message||"";return a.stack&&(e=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),e}class $d extends eP{constructor(e,n,i,s){super(e,n,i,s),this.type="firestore",this._queue=new Yz,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Yz(e),this._firestoreClient=void 0,await e}}}function ume(a,e){const n=typeof a=="object"?a:gX(),i=typeof a=="string"?a:y3,s=A8(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const r=Tue("firestore");r&&cme(s,...r)}return s}function Px(a){if(a._terminated)throw new pn(jt.FAILED_PRECONDITION,"The client has already been terminated.");return a._firestoreClient||dme(a),a._firestoreClient}function dme(a){const e=a._freezeSettings(),n=lme(a._databaseId,a._app?.options.appId||"",a._persistenceKey,a._app?.options.apiKey,e);a._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(a._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),a._firestoreClient=new Jpe(a._authCredentials,a._appCheckCredentials,a._queue,n,a._componentsProvider&&(function(s){const r=s?._online.build();return{_offline:s?._offline.build(r),_online:r}})(a._componentsProvider))}class nu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new nu(ko.fromBase64String(e))}catch(n){throw new pn(jt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new nu(ko.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:nu._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(bT(e,nu._jsonSchema))return nu.fromBase64String(e.bytes)}}nu._jsonSchemaVersion="firestore/bytes/1.0",nu._jsonSchema={type:br("string",nu._jsonSchemaVersion),bytes:br("string")};class tP{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new pn(jt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Eo(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ix{constructor(e){this._methodName=e}}class Qh{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new pn(jt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new pn(jt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return li(this._lat,e._lat)||li(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Qh._jsonSchemaVersion}}static fromJSON(e){if(bT(e,Qh._jsonSchema))return new Qh(e.latitude,e.longitude)}}Qh._jsonSchemaVersion="firestore/geoPoint/1.0",Qh._jsonSchema={type:br("string",Qh._jsonSchemaVersion),latitude:br("number"),longitude:br("number")};class zd{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,s){if(i.length!==s.length)return!1;for(let r=0;r<i.length;++r)if(i[r]!==s[r])return!1;return!0})(this._values,e._values)}toJSON(){return{type:zd._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(bT(e,zd._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new zd(e.vectorValues);throw new pn(jt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}zd._jsonSchemaVersion="firestore/vectorValue/1.0",zd._jsonSchema={type:br("string",zd._jsonSchemaVersion),vectorValues:br("object")};const hme=/^__.*__$/;class fme{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new b0(e,this.data,this.fieldMask,n,this.fieldTransforms):new TT(e,this.data,n,this.fieldTransforms)}}class GQ{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new b0(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function qQ(a){switch(a){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw na(40011,{dataSource:a})}}class nP{constructor(e,n,i,s,r,o){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=s,r===void 0&&this.validatePath(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new nP({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const n=this.path?.child(e),i=this.contextWith({path:n,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const n=this.path?.child(e),i=this.contextWith({path:n,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return C3(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(qQ(this.dataSource)&&hme.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class pme{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||QR(e)}createContext(e,n,i,s=!1){return new nP({dataSource:e,methodName:n,targetDoc:i,path:Eo.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function CT(a){const e=a._freezeSettings(),n=QR(a._databaseId);return new pme(a._databaseId,!!e.ignoreUndefinedProperties,n)}function Y8(a,e,n,i,s,r={}){const o=a.createContext(r.merge||r.mergeFields?2:0,e,n,s);Z8("Data must be an object, but it was:",o,i);const l=$Q(i,o);let c,u;if(r.merge)c=new au(o.fieldMask),u=o.fieldTransforms;else if(r.mergeFields){const h=[];for(const f of r.mergeFields){const m=ly(e,f,n);if(!o.contains(m))throw new pn(jt.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);XQ(h,m)||h.push(m)}c=new au(h),u=o.fieldTransforms.filter((f=>c.covers(f.field)))}else c=null,u=o.fieldTransforms;return new fme(new al(l),c,u)}class aP extends Ix{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof aP}}function mme(a,e,n){return new nP({dataSource:3,targetDoc:e.settings.targetDoc,methodName:a._methodName,arrayElement:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class X8 extends Ix{_toFieldTransform(e){return new E8(e.path,new NS)}isEqual(e){return e instanceof X8}}class Q8 extends Ix{constructor(e,n){super(e),this.Ac=n}_toFieldTransform(e){const n=mme(this,e,!0),i=this.Ac.map((r=>Lx(r,n))),s=new j_(i);return new E8(e.path,s)}isEqual(e){return e instanceof Q8&&a0(this.Ac,e.Ac)}}class J8 extends Ix{constructor(e,n){super(e),this.Vc=n}_toFieldTransform(e){const n=new PS(e.serializer,ZX(e.serializer,this.Vc));return new E8(e.path,n)}isEqual(e){return e instanceof J8&&this.Vc===e.Vc}}function HQ(a,e,n,i){const s=a.createContext(1,e,n);Z8("Data must be an object, but it was:",s,i);const r=[],o=al.empty();x0(i,((c,u)=>{const h=YQ(e,c,n);u=nr(u);const f=s.childContextForFieldPath(h);if(u instanceof aP)r.push(h);else{const m=Lx(u,f);m!=null&&(r.push(h),o.set(h,m))}}));const l=new au(r);return new GQ(o,l,s.fieldTransforms)}function WQ(a,e,n,i,s,r){const o=a.createContext(1,e,n),l=[ly(e,i,n)],c=[s];if(r.length%2!=0)throw new pn(jt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<r.length;m+=2)l.push(ly(e,r[m])),c.push(r[m+1]);const u=[],h=al.empty();for(let m=l.length-1;m>=0;--m)if(!XQ(u,l[m])){const A=l[m];let x=c[m];x=nr(x);const T=o.childContextForFieldPath(A);if(x instanceof aP)u.push(A);else{const E=Lx(x,T);E!=null&&(u.push(A),h.set(A,E))}}const f=new au(u);return new GQ(h,f,o.fieldTransforms)}function gme(a,e,n,i=!1){return Lx(n,a.createContext(i?4:3,e))}function Lx(a,e){if(KQ(a=nr(a)))return Z8("Unsupported field value:",e,a),$Q(a,e);if(a instanceof Ix)return(function(i,s){if(!qQ(s.dataSource))throw s.createError(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${i._methodName}() is not currently supported inside arrays`);const r=i._toFieldTransform(s);r&&s.fieldTransforms.push(r)})(a,e),null;if(a===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),a instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,s){const r=[];let o=0;for(const l of i){let c=Lx(l,s.childContextForArray(o));c==null&&(c={nullValue:"NULL_VALUE"}),r.push(c),o++}return{arrayValue:{values:r}}})(a,e)}return(function(i,s){if((i=nr(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return ZX(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const r=bi.fromDate(i);return{timestampValue:b3(s.serializer,r)}}if(i instanceof bi){const r=new bi(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:b3(s.serializer,r)}}if(i instanceof Qh)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof nu)return{bytesValue:dQ(s.serializer,i._byteString)};if(i instanceof Us){const r=s.databaseId,o=i.firestore._databaseId;if(!o.isEqual(r))throw s.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:N8(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof zd)return(function(o,l){const c=o instanceof zd?o.toArray():o;return{mapValue:{fields:{[OX]:{stringValue:FX},[v3]:{arrayValue:{values:c.map((h=>{if(typeof h!="number")throw l.createError("VectorValues must only contain numeric values.");return w8(l.serializer,h)}))}}}}}})(i,s);if(_Q(i))return i._toProto(s.serializer);throw s.createError(`Unsupported field value: ${VR(i)}`)})(a,e)}function $Q(a,e){const n={};return RX(a)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):x0(a,((i,s)=>{const r=Lx(s,e.childContextForField(i));r!=null&&(n[i]=r)})),{mapValue:{fields:n}}}function KQ(a){return!(typeof a!="object"||a===null||a instanceof Array||a instanceof Date||a instanceof bi||a instanceof Qh||a instanceof nu||a instanceof Us||a instanceof Ix||a instanceof zd||_Q(a))}function Z8(a,e,n){if(!KQ(n)||!CX(n)){const i=VR(n);throw i==="an object"?e.createError(a+" a custom object"):e.createError(a+" "+i)}}function ly(a,e,n){if((e=nr(e))instanceof tP)return e._internalPath;if(typeof e=="string")return YQ(a,e);throw C3("Field path arguments must be of type string or ",a,!1,void 0,n)}const Ame=new RegExp("[~\\*/\\[\\]]");function YQ(a,e,n){if(e.search(Ame)>=0)throw C3(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,a,!1,void 0,n);try{return new tP(...e.split("."))._internalPath}catch{throw C3(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,a,!1,void 0,n)}}function C3(a,e,n,i,s){const r=i&&!i.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${i}`),o&&(c+=` in document ${s}`),c+=")"),new pn(jt.INVALID_ARGUMENT,l+a+c)}function XQ(a,e){return a.some((n=>n.isEqual(e)))}class QQ{convertValue(e,n="none"){switch(o0(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(r0(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw na(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return x0(e,((s,r)=>{i[s]=this.convertValue(r,n)})),i}convertVectorValue(e){const n=e.fields?.[v3].arrayValue?.values?.map((i=>rr(i.doubleValue)));return new zd(n)}convertGeoPoint(e){return new Qh(rr(e.latitude),rr(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=GR(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(wS(e));default:return null}}convertTimestamp(e){const n=s0(e);return new bi(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=Qi.fromString(e);fi(vQ(i),9688,{name:e});const s=new ES(i.get(1),i.get(3)),r=new Wn(i.popFirst(5));return s.isEqual(n)||um(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),r}}class NT extends QQ{constructor(e){super(),this.firestore=e}convertBytes(e){return new nu(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Us(this.firestore,null,n)}}function Hi(){return new X8("serverTimestamp")}function Qz(...a){return new Q8("arrayUnion",a)}function Lu(a){return new J8("increment",a)}const Jz="@firebase/firestore",Zz="4.10.0";function eG(a){return(function(n,i){if(typeof n!="object"||n===null)return!1;const s=n;for(const r of i)if(r in s&&typeof s[r]=="function")return!0;return!1})(a,["next","error","complete"])}class yme{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class vme{constructor(e,n,i){this._userDataWriter=n,this._data=i,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new al({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}class N3{constructor(e,n,i,s,r){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Us(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _me(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const n=this._document.data.field(ly("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class _me extends N3{data(){return super.data()}}function JQ(a){if(a.limitType==="L"&&a.explicitOrderBy.length===0)throw new pn(jt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class eF{}class tF extends eF{}function hf(a,e,...n){let i=[];e instanceof eF&&i.push(e),i=i.concat(n),(function(r){const o=r.filter((c=>c instanceof nF)).length,l=r.filter((c=>c instanceof iP)).length;if(o>1||o>0&&l>0)throw new pn(jt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const s of i)a=s._apply(a);return a}class iP extends tF{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new iP(e,n,i)}_apply(e){const n=this._parse(e);return eJ(e._query,n),new Pm(e.firestore,e.converter,L6(e._query,n))}_parse(e){const n=CT(e.firestore);return(function(r,o,l,c,u,h,f){let m;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new pn(jt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){nG(f,h);const x=[];for(const T of f)x.push(tG(c,r,T));m={arrayValue:{values:x}}}else m=tG(c,r,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||nG(f,h),m=gme(l,o,f,h==="in"||h==="not-in");return xr.create(u,h,m)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function u0(a,e,n){const i=e,s=ly("where",a);return iP._create(s,i,n)}class nF extends eF{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new nF(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:Wd.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(s,r){let o=s;const l=r.getFlattenedFilters();for(const c of l)eJ(o,c),o=L6(o,c)})(e._query,n),new Pm(e.firestore,e.converter,L6(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class aF extends tF{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new aF(e,n)}_apply(e){const n=(function(s,r,o){if(s.startAt!==null)throw new pn(jt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new pn(jt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new CS(r,o)})(e._query,this._field,this._direction);return new Pm(e.firestore,e.converter,Ghe(e._query,n))}}function ZQ(a,e="asc"){const n=e,i=ly("orderBy",a);return aF._create(i,n)}class iF extends tF{constructor(e,n,i){super(),this.type=e,this._limit=n,this._limitType=i}static _create(e,n,i){return new iF(e,n,i)}_apply(e){return new Pm(e.firestore,e.converter,x3(e._query,this._limit,this._limitType))}}function R3(a){return fhe("limit",a),iF._create("limit",a,"F")}function tG(a,e,n){if(typeof(n=nr(n))=="string"){if(n==="")throw new pn(jt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!HX(e)&&n.indexOf("/")!==-1)throw new pn(jt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Qi.fromString(n));if(!Wn.isDocumentKey(i))throw new pn(jt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return pz(a,new Wn(i))}if(n instanceof Us)return pz(a,n._key);throw new pn(jt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${VR(n)}.`)}function nG(a,e){if(!Array.isArray(a)||a.length===0)throw new pn(jt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function eJ(a,e){const n=(function(s,r){for(const o of s)for(const l of o.getFlattenedFilters())if(r.indexOf(l.op)>=0)return l.op;return null})(a.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new pn(jt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new pn(jt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function sF(a,e,n){let i;return i=a?n&&(n.merge||n.mergeFields)?a.toFirestore(e,n):a.toFirestore(e):e,i}class xme extends QQ{constructor(e){super(),this.firestore=e}convertBytes(e){return new nu(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Us(this.firestore,null,n)}}function bme(){return new yme("count")}function nD(a){return Sme(a,{count:bme()})}function Sme(a,e){const n=ul(a.firestore,$d),i=Px(n),s=She(e,((r,o)=>new sfe(o,r.aggregateType,r._internalFieldPath)));return ime(i,a._query,s).then((r=>(function(l,c,u){const h=new NT(l);return new vme(c,h,u)})(n,a,r)))}class n_{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Yg extends N3{constructor(e,n,i,s,r,o){super(e,n,i,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new BC(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(ly("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new pn(jt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Yg._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Yg._jsonSchemaVersion="firestore/documentSnapshot/1.0",Yg._jsonSchema={type:br("string",Yg._jsonSchemaVersion),bundleSource:br("string","DocumentSnapshot"),bundleName:br("string"),bundle:br("string")};class BC extends Yg{data(e={}){return super.data(e)}}class XA{constructor(e,n,i,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new n_(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new BC(this._firestore,this._userDataWriter,i.key,i,new n_(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new pn(jt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(s,r){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((l=>{const c=new BC(s._firestore,s._userDataWriter,l.doc.key,l.doc,new n_(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((l=>r||l.type!==3)).map((l=>{const c=new BC(s._firestore,s._userDataWriter,l.doc.key,l.doc,new n_(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,h=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:Tme(l.type),doc:c,oldIndex:u,newIndex:h}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new pn(jt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=XA._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=v8.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],s=[];return this.docs.forEach((r=>{r._document!==null&&(n.push(r._document),i.push(this._userDataWriter.convertObjectMap(r._document.data.value.mapValue.fields,"previous")),s.push(r.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Tme(a){switch(a){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return na(61501,{type:a})}}XA._jsonSchemaVersion="firestore/querySnapshot/1.0",XA._jsonSchema={type:br("string",XA._jsonSchemaVersion),bundleSource:br("string","QuerySnapshot"),bundleName:br("string"),bundle:br("string")};const wme={maxAttempts:5};function I2(a,e){if((a=nr(a)).firestore!==e)throw new pn(jt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return a}class Eme{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=CT(e)}get(e){const n=I2(e,this._firestore),i=new xme(this._firestore);return this._transaction.lookup([n._key]).then((s=>{if(!s||s.length!==1)return na(24041);const r=s[0];if(r.isFoundDocument())return new N3(this._firestore,i,r.key,r,n.converter);if(r.isNoDocument())return new N3(this._firestore,i,n._key,null,n.converter);throw na(18433,{doc:r})}))}set(e,n,i){const s=I2(e,this._firestore),r=sF(s.converter,n,i),o=Y8(this._dataReader,"Transaction.set",s._key,r,s.converter!==null,i);return this._transaction.set(s._key,o),this}update(e,n,i,...s){const r=I2(e,this._firestore);let o;return o=typeof(n=nr(n))=="string"||n instanceof tP?WQ(this._dataReader,"Transaction.update",r._key,n,i,s):HQ(this._dataReader,"Transaction.update",r._key,n),this._transaction.update(r._key,o),this}delete(e){const n=I2(e,this._firestore);return this._transaction.delete(n._key),this}}class Mme extends Eme{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=I2(e,this._firestore),i=new NT(this._firestore);return super.get(e).then((s=>new Yg(this._firestore,i,n._key,s._document,new n_(!1,!1),n.converter)))}}function Cme(a,e,n){a=ul(a,$d);const i={...wme,...n};(function(o){if(o.maxAttempts<1)throw new pn(jt.INVALID_ARGUMENT,"Max attempts must be at least 1")})(i);const s=Px(a);return rme(s,(r=>e(new Mme(a,r))),i)}function go(a){a=ul(a,Us);const e=ul(a.firestore,$d),n=Px(e);return nme(n,a._key).then((i=>tJ(e,a,i)))}function ff(a){a=ul(a,Pm);const e=ul(a.firestore,$d),n=Px(e),i=new NT(e);return JQ(a._query),ame(n,a._query).then((s=>new XA(e,i,a,s)))}function Kf(a,e,n){a=ul(a,Us);const i=ul(a.firestore,$d),s=sF(a.converter,e,n),r=CT(i);return rP(i,[Y8(r,"setDoc",a._key,s,a.converter!==null,n).toMutation(a._key,Mo.none())])}function wl(a,e,n,...i){a=ul(a,Us);const s=ul(a.firestore,$d),r=CT(s);let o;return o=typeof(e=nr(e))=="string"||e instanceof tP?WQ(r,"updateDoc",a._key,e,n,i):HQ(r,"updateDoc",a._key,e),rP(s,[o.toMutation(a._key,Mo.exists(!0))])}function cy(a){return rP(ul(a.firestore,$d),[new YR(a._key,Mo.none())])}function Nme(a,e){const n=ul(a.firestore,$d),i=Ra(a),s=sF(a.converter,e),r=CT(a.firestore);return rP(n,[Y8(r,"addDoc",i._key,s,a.converter!==null,{}).toMutation(i._key,Mo.exists(!1))]).then((()=>i))}function sP(a,...e){a=nr(a);let n={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||eG(e[i])||(n=e[i++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(eG(e[i])){const u=e[i];e[i]=u.next?.bind(u),e[i+1]=u.error?.bind(u),e[i+2]=u.complete?.bind(u)}let r,o,l;if(a instanceof Us)o=ul(a.firestore,$d),l=qR(a._key.path),r={next:u=>{e[i]&&e[i](tJ(o,a,u))},error:e[i+1],complete:e[i+2]};else{const u=ul(a,Pm);o=ul(u.firestore,$d),l=u._query;const h=new NT(o);r={next:f=>{e[i]&&e[i](new XA(o,h,u,f))},error:e[i+1],complete:e[i+2]},JQ(a._query)}const c=Px(o);return tme(c,l,s,r)}function rP(a,e){const n=Px(a);return sme(n,e)}function tJ(a,e,n){const i=n.docs.get(e._key),s=new NT(a);return new Yg(a,s,e._key,i,new n_(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){the(wx),L_(new sy("firestore",((i,{instanceIdentifier:s,options:r})=>{const o=i.getProvider("app").getImmediate(),l=new $d(new ihe(i.getProvider("auth-internal")),new ohe(o,i.getProvider("app-check-internal")),Ehe(o,s),o);return r={useFetchStreams:n,...r},l._setSettings(r),l}),"PUBLIC").setMultipleInstances(!0)),Wg(Jz,Zz,e),Wg(Jz,Zz,"esm2020")})();function nJ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Rme=nJ,aJ=new _T("auth","Firebase",nJ());const P3=new m8("@firebase/auth");function Pme(a,...e){P3.logLevel<=ri.WARN&&P3.warn(`Auth (${wx}): ${a}`,...e)}function UC(a,...e){P3.logLevel<=ri.ERROR&&P3.error(`Auth (${wx}): ${a}`,...e)}function qu(a,...e){throw oF(a,...e)}function Gd(a,...e){return oF(a,...e)}function rF(a,e,n){const i={...Rme(),[e]:n};return new _T("auth","Firebase",i).create(e,{appName:a.name})}function Jh(a){return rF(a,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function iJ(a,e,n){const i=n;if(!(e instanceof i))throw i.name!==e.constructor.name&&qu(a,"argument-error"),rF(a,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function oF(a,...e){if(typeof a!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=a.name),a._errorFactory.create(n,...i)}return aJ.create(a,...e)}function Zn(a,e,...n){if(!a)throw oF(e,...n)}function $p(a){const e="INTERNAL ASSERTION FAILED: "+a;throw UC(e),new Error(e)}function hm(a,e){a||$p(e)}function z6(){return typeof self<"u"&&self.location?.href||""}function Ime(){return aG()==="http:"||aG()==="https:"}function aG(){return typeof self<"u"&&self.location?.protocol||null}function Lme(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ime()||Iue()||"connection"in navigator)?navigator.onLine:!0}function Dme(){if(typeof navigator>"u")return null;const a=navigator;return a.languages&&a.languages[0]||a.language||null}class RT{constructor(e,n){this.shortDelay=e,this.longDelay=n,hm(n>e,"Short delay should be less than long delay!"),this.isMobile=Nue()||Lue()}get(){return Lme()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function lF(a,e){hm(a.emulator,"Emulator should always be set here");const{url:n}=a.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class sJ{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$p("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$p("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$p("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const kme={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Ome=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Fme=new RT(3e4,6e4);function Im(a,e){return a.tenantId&&!e.tenantId?{...e,tenantId:a.tenantId}:e}async function Lm(a,e,n,i,s={}){return rJ(a,s,async()=>{let r={},o={};i&&(e==="GET"?o=i:r={body:JSON.stringify(i)});const l=xT({key:a.config.apiKey,...o}).slice(1),c=await a._getAdditionalHeaders();c["Content-Type"]="application/json",a.languageCode&&(c["X-Firebase-Locale"]=a.languageCode);const u={method:e,headers:c,...r};return Pue()||(u.referrerPolicy="no-referrer"),a.emulatorConfig&&Tx(a.emulatorConfig.host)&&(u.credentials="include"),sJ.fetch()(await oJ(a,a.config.apiHost,n,l),u)})}async function rJ(a,e,n){a._canInitEmulator=!1;const i={...kme,...e};try{const s=new Bme(a),r=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw RE(a,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const l=r.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw RE(a,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw RE(a,"email-already-in-use",o);if(c==="USER_DISABLED")throw RE(a,"user-disabled",o);const h=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw rF(a,h,u);qu(a,h)}}catch(s){if(s instanceof Rm)throw s;qu(a,"network-request-failed",{message:String(s)})}}async function PT(a,e,n,i,s={}){const r=await Lm(a,e,n,i,s);return"mfaPendingCredential"in r&&qu(a,"multi-factor-auth-required",{_serverResponse:r}),r}async function oJ(a,e,n,i){const s=`${e}${n}?${i}`,r=a,o=r.config.emulator?lF(a.config,s):`${a.config.apiScheme}://${s}`;return Ome.includes(n)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}function jme(a){switch(a){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Bme{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(Gd(this.auth,"network-request-failed")),Fme.get())})}}function RE(a,e,n){const i={appName:a.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const s=Gd(a,e,i);return s.customData._tokenResponse=n,s}function iG(a){return a!==void 0&&a.enterprise!==void 0}class Ume{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return jme(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Vme(a,e){return Lm(a,"GET","/v2/recaptchaConfig",Im(a,e))}async function zme(a,e){return Lm(a,"POST","/v1/accounts:delete",e)}async function I3(a,e){return Lm(a,"POST","/v1/accounts:lookup",e)}function tS(a){if(a)try{const e=new Date(Number(a));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Gme(a,e=!1){const n=nr(a),i=await n.getIdToken(e),s=cF(i);Zn(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const r=typeof s.firebase=="object"?s.firebase:void 0,o=r?.sign_in_provider;return{claims:s,token:i,authTime:tS(aD(s.auth_time)),issuedAtTime:tS(aD(s.iat)),expirationTime:tS(aD(s.exp)),signInProvider:o||null,signInSecondFactor:r?.sign_in_second_factor||null}}function aD(a){return Number(a)*1e3}function cF(a){const[e,n,i]=a.split(".");if(e===void 0||n===void 0||i===void 0)return UC("JWT malformed, contained fewer than 3 sections"),null;try{const s=oX(n);return s?JSON.parse(s):(UC("Failed to decode base64 JWT payload"),null)}catch(s){return UC("Caught error parsing JWT payload as JSON",s?.toString()),null}}function sG(a){const e=cF(a);return Zn(e,"internal-error"),Zn(typeof e.exp<"u","internal-error"),Zn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function IS(a,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Rm&&qme(i)&&a.auth.currentUser===a&&await a.auth.signOut(),i}}function qme({code:a}){return a==="auth/user-disabled"||a==="auth/user-token-expired"}class Hme{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class G6{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=tS(this.lastLoginAt),this.creationTime=tS(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function L3(a){const e=a.auth,n=await a.getIdToken(),i=await IS(a,I3(e,{idToken:n}));Zn(i?.users.length,e,"internal-error");const s=i.users[0];a._notifyReloadListener(s);const r=s.providerUserInfo?.length?lJ(s.providerUserInfo):[],o=$me(a.providerData,r),l=a.isAnonymous,c=!(a.email&&s.passwordHash)&&!o?.length,u=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new G6(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(a,h)}async function Wme(a){const e=nr(a);await L3(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $me(a,e){return[...a.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function lJ(a){return a.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function Kme(a,e){const n=await rJ(a,{},async()=>{const i=xT({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:r}=a.config,o=await oJ(a,s,"/v1/token",`key=${r}`),l=await a._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:i};return a.emulatorConfig&&Tx(a.emulatorConfig.host)&&(c.credentials="include"),sJ.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Yme(a,e){return Lm(a,"POST","/v2/accounts:revokeToken",Im(a,e))}class p_{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Zn(e.idToken,"internal-error"),Zn(typeof e.idToken<"u","internal-error"),Zn(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sG(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Zn(e.length!==0,"internal-error");const n=sG(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Zn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:s,expiresIn:r}=await Kme(e,n);this.updateTokensAndExpiration(i,s,Number(r))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:s,expirationTime:r}=n,o=new p_;return i&&(Zn(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),s&&(Zn(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),r&&(Zn(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new p_,this.toJSON())}_performRefresh(){return $p("not implemented")}}function ag(a,e){Zn(typeof a=="string"||typeof a>"u","internal-error",{appName:e})}class Ld{constructor({uid:e,auth:n,stsTokenManager:i,...s}){this.providerId="firebase",this.proactiveRefresh=new Hme(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new G6(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await IS(this,this.stsTokenManager.getToken(this.auth,e));return Zn(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Gme(this,e)}reload(){return Wme(this)}_assign(e){this!==e&&(Zn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ld({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Zn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await L3(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(cc(this.auth.app))return Promise.reject(Jh(this.auth));const e=await this.getIdToken();return await IS(this,zme(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,s=n.email??void 0,r=n.phoneNumber??void 0,o=n.photoURL??void 0,l=n.tenantId??void 0,c=n._redirectEventId??void 0,u=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:A,providerData:x,stsTokenManager:T}=n;Zn(f&&T,e,"internal-error");const E=p_.fromJSON(this.name,T);Zn(typeof f=="string",e,"internal-error"),ag(i,e.name),ag(s,e.name),Zn(typeof m=="boolean",e,"internal-error"),Zn(typeof A=="boolean",e,"internal-error"),ag(r,e.name),ag(o,e.name),ag(l,e.name),ag(c,e.name),ag(u,e.name),ag(h,e.name);const M=new Ld({uid:f,auth:e,email:s,emailVerified:m,displayName:i,isAnonymous:A,photoURL:o,phoneNumber:r,tenantId:l,stsTokenManager:E,createdAt:u,lastLoginAt:h});return x&&Array.isArray(x)&&(M.providerData=x.map(N=>({...N}))),c&&(M._redirectEventId=c),M}static async _fromIdTokenResponse(e,n,i=!1){const s=new p_;s.updateFromServerResponse(n);const r=new Ld({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await L3(r),r}static async _fromGetAccountInfoResponse(e,n,i){const s=n.users[0];Zn(s.localId!==void 0,"internal-error");const r=s.providerUserInfo!==void 0?lJ(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!r?.length,l=new p_;l.updateFromIdToken(i);const c=new Ld({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:r,metadata:new G6(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!r?.length};return Object.assign(c,u),c}}const rG=new Map;function Kp(a){hm(a instanceof Function,"Expected a class definition");let e=rG.get(a);return e?(hm(e instanceof a,"Instance stored in cache mismatched with class"),e):(e=new a,rG.set(a,e),e)}class cJ{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}cJ.type="NONE";const oG=cJ;function VC(a,e,n){return`firebase:${a}:${e}:${n}`}class m_{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:s,name:r}=this.auth;this.fullUserKey=VC(this.userKey,s.apiKey,r),this.fullPersistenceKey=VC("persistence",s.apiKey,r),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await I3(this.auth,{idToken:e}).catch(()=>{});return n?Ld._fromGetAccountInfoResponse(this.auth,n,e):null}return Ld._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new m_(Kp(oG),e,i);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let r=s[0]||Kp(oG);const o=VC(i,e.config.apiKey,e.name);let l=null;for(const u of n)try{const h=await u._get(o);if(h){let f;if(typeof h=="string"){const m=await I3(e,{idToken:h}).catch(()=>{});if(!m)break;f=await Ld._fromGetAccountInfoResponse(e,m,h)}else f=Ld._fromJSON(e,h);u!==r&&(l=f),r=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!r._shouldAllowMigration||!c.length?new m_(r,e,i):(r=c[0],l&&await r._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==r)try{await u._remove(o)}catch{}})),new m_(r,e,i))}}function lG(a){const e=a.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mJ(e))return"Blackberry";if(gJ(e))return"Webos";if(dJ(e))return"Safari";if((e.includes("chrome/")||hJ(e))&&!e.includes("edge/"))return"Chrome";if(pJ(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=a.match(n);if(i?.length===2)return i[1]}return"Other"}function uJ(a=ml()){return/firefox\//i.test(a)}function dJ(a=ml()){const e=a.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hJ(a=ml()){return/crios\//i.test(a)}function fJ(a=ml()){return/iemobile/i.test(a)}function pJ(a=ml()){return/android/i.test(a)}function mJ(a=ml()){return/blackberry/i.test(a)}function gJ(a=ml()){return/webos/i.test(a)}function uF(a=ml()){return/iphone|ipad|ipod/i.test(a)||/macintosh/i.test(a)&&/mobile/i.test(a)}function Xme(a=ml()){return uF(a)&&!!window.navigator?.standalone}function Qme(){return Due()&&document.documentMode===10}function AJ(a=ml()){return uF(a)||pJ(a)||gJ(a)||mJ(a)||/windows phone/i.test(a)||fJ(a)}function yJ(a,e=[]){let n;switch(a){case"Browser":n=lG(ml());break;case"Worker":n=`${lG(ml())}-${a}`;break;default:n=a}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${wx}/${i}`}class Jme{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=r=>new Promise((o,l)=>{try{const c=e(r);o(c)}catch(c){l(c)}});i.onAbort=n,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function Zme(a,e={}){return Lm(a,"GET","/v2/passwordPolicy",Im(a,e))}const ege=6;class tge{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??ege,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,s,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class nge{constructor(e,n,i,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cG(this),this.idTokenSubscription=new cG(this),this.beforeStateQueue=new Jme(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=aJ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Kp(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await m_.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await I3(this,{idToken:e}),i=await Ld._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(cc(this.app)){const r=this.app.settings.authIdToken;return r?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(r).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!r||r===o)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(r){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(r))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Zn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await L3(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Dme()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(cc(this.app))return Promise.reject(Jh(this));const n=e?nr(e):null;return n&&Zn(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Zn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return cc(this.app)?Promise.reject(Jh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return cc(this.app)?Promise.reject(Jh(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Kp(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Zme(this),n=new tge(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new _T("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await Yme(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Kp(e)||this._popupRedirectResolver;Zn(n,this,"argument-error"),this.redirectPersistenceManager=await m_.create(this,[Kp(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,s){if(this._deleted)return()=>{};const r=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Zn(l,this,"internal-error"),l.then(()=>{o||r(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,i,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Zn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=yJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(cc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Pme(`Error while retrieving App Check token: ${e.error}`),e?.token}}function eh(a){return nr(a)}class cG{constructor(e){this.auth=e,this.observer=null,this.addObserver=zue(n=>this.observer=n)}get next(){return Zn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let oP={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function age(a){oP=a}function vJ(a){return oP.loadJS(a)}function ige(){return oP.recaptchaEnterpriseScript}function sge(){return oP.gapiScript}function rge(a){return`__${a}${Math.floor(Math.random()*1e6)}`}class oge{constructor(){this.enterprise=new lge}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class lge{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const cge="recaptcha-enterprise",_J="NO_RECAPTCHA";class uge{constructor(e){this.type=cge,this.auth=eh(e)}async verify(e="verify",n=!1){async function i(r){if(!n){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(o,l)=>{Vme(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new Ume(c);return r.tenantId==null?r._agentRecaptchaConfig=u:r._tenantRecaptchaConfigs[r.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(r,o,l){const c=window.grecaptcha;iG(c)?c.enterprise.ready(()=>{c.enterprise.execute(r,{action:e}).then(u=>{o(u)}).catch(()=>{o(_J)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new oge().execute("siteKey",{action:"verify"}):new Promise((r,o)=>{i(this.auth).then(l=>{if(!n&&iG(window.grecaptcha))s(l,r,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=ige();c.length!==0&&(c+=l),vJ(c).then(()=>{s(l,r,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function uG(a,e,n,i=!1,s=!1){const r=new uge(a);let o;if(s)o=_J;else try{o=await r.verify(n)}catch{o=await r.verify(n,!0)}const l={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return i?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function D3(a,e,n,i,s){if(a._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await uG(a,e,n,n==="getOobCode");return i(a,r)}else return i(a,e).catch(async r=>{if(r.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await uG(a,e,n,n==="getOobCode");return i(a,o)}else return Promise.reject(r)})}function dge(a,e){const n=A8(a,"auth");if(n.isInitialized()){const s=n.getImmediate(),r=n.getOptions();if(a0(r,e??{}))return s;qu(s,"already-initialized")}return n.initialize({options:e})}function hge(a,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(Kp);e?.errorMap&&a._updateErrorMap(e.errorMap),a._initializeWithPersistence(i,e?.popupRedirectResolver)}function fge(a,e,n){const i=eh(a);Zn(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!1,r=xJ(e),{host:o,port:l}=pge(e),c=l===null?"":`:${l}`,u={url:`${r}//${o}${c}/`},h=Object.freeze({host:o,port:l,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){Zn(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Zn(a0(u,i.config.emulator)&&a0(h,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=u,i.emulatorConfig=h,i.settings.appVerificationDisabledForTesting=!0,Tx(o)?(dX(`${r}//${o}${c}`),hX("Auth",!0)):mge()}function xJ(a){const e=a.indexOf(":");return e<0?"":a.substr(0,e+1)}function pge(a){const e=xJ(a),n=/(\/\/)?([^?#/]+)/.exec(a.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const r=s[1];return{host:r,port:dG(i.substr(r.length+1))}}else{const[r,o]=i.split(":");return{host:r,port:dG(o)}}}function dG(a){if(!a)return null;const e=Number(a);return isNaN(e)?null:e}function mge(){function a(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",a):a())}class dF{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return $p("not implemented")}_getIdTokenResponse(e){return $p("not implemented")}_linkToIdToken(e,n){return $p("not implemented")}_getReauthenticationResolver(e){return $p("not implemented")}}async function gge(a,e){return Lm(a,"POST","/v1/accounts:signUp",e)}async function Age(a,e){return PT(a,"POST","/v1/accounts:signInWithPassword",Im(a,e))}async function bJ(a,e){return Lm(a,"POST","/v1/accounts:sendOobCode",Im(a,e))}async function yge(a,e){return bJ(a,e)}async function vge(a,e){return bJ(a,e)}async function _ge(a,e){return PT(a,"POST","/v1/accounts:signInWithEmailLink",Im(a,e))}async function xge(a,e){return PT(a,"POST","/v1/accounts:signInWithEmailLink",Im(a,e))}class LS extends dF{constructor(e,n,i,s=null){super("password",i),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new LS(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new LS(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return D3(e,n,"signInWithPassword",Age);case"emailLink":return _ge(e,{email:this._email,oobCode:this._password});default:qu(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return D3(e,i,"signUpPassword",gge);case"emailLink":return xge(e,{idToken:n,email:this._email,oobCode:this._password});default:qu(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function g_(a,e){return PT(a,"POST","/v1/accounts:signInWithIdp",Im(a,e))}const bge="http://localhost";class uy extends dF{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new uy(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):qu("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s,...r}=n;if(!i||!s)return null;const o=new uy(i,s);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return g_(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,g_(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,g_(e,n)}buildRequest(){const e={requestUri:bge,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=xT(n)}return e}}function Sge(a){switch(a){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Tge(a){const e=M2(C2(a)).link,n=e?M2(C2(e)).deep_link_id:null,i=M2(C2(a)).deep_link_id;return(i?M2(C2(i)).link:null)||i||n||e||a}class hF{constructor(e){const n=M2(C2(e)),i=n.apiKey??null,s=n.oobCode??null,r=Sge(n.mode??null);Zn(i&&s&&r,"argument-error"),this.apiKey=i,this.operation=r,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Tge(e);try{return new hF(n)}catch{return null}}}class Dx{constructor(){this.providerId=Dx.PROVIDER_ID}static credential(e,n){return LS._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=hF.parseLink(n);return Zn(i,"argument-error"),LS._fromEmailAndCode(e,i.code,i.tenantId)}}Dx.PROVIDER_ID="password";Dx.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Dx.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class lP{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class IT extends lP{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Cg extends IT{constructor(){super("facebook.com")}static credential(e){return uy._fromParams({providerId:Cg.PROVIDER_ID,signInMethod:Cg.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Cg.credentialFromTaggedObject(e)}static credentialFromError(e){return Cg.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Cg.credential(e.oauthAccessToken)}catch{return null}}}Cg.FACEBOOK_SIGN_IN_METHOD="facebook.com";Cg.PROVIDER_ID="facebook.com";class Bh extends IT{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return uy._fromParams({providerId:Bh.PROVIDER_ID,signInMethod:Bh.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Bh.credentialFromTaggedObject(e)}static credentialFromError(e){return Bh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return Bh.credential(n,i)}catch{return null}}}Bh.GOOGLE_SIGN_IN_METHOD="google.com";Bh.PROVIDER_ID="google.com";class Ng extends IT{constructor(){super("github.com")}static credential(e){return uy._fromParams({providerId:Ng.PROVIDER_ID,signInMethod:Ng.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ng.credentialFromTaggedObject(e)}static credentialFromError(e){return Ng.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ng.credential(e.oauthAccessToken)}catch{return null}}}Ng.GITHUB_SIGN_IN_METHOD="github.com";Ng.PROVIDER_ID="github.com";class Rg extends IT{constructor(){super("twitter.com")}static credential(e,n){return uy._fromParams({providerId:Rg.PROVIDER_ID,signInMethod:Rg.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Rg.credentialFromTaggedObject(e)}static credentialFromError(e){return Rg.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Rg.credential(n,i)}catch{return null}}}Rg.TWITTER_SIGN_IN_METHOD="twitter.com";Rg.PROVIDER_ID="twitter.com";async function wge(a,e){return PT(a,"POST","/v1/accounts:signUp",Im(a,e))}class dy{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,s=!1){const r=await Ld._fromIdTokenResponse(e,i,s),o=hG(i);return new dy({user:r,providerId:o,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const s=hG(i);return new dy({user:e,providerId:s,_tokenResponse:i,operationType:n})}}function hG(a){return a.providerId?a.providerId:"phoneNumber"in a?"phone":null}class k3 extends Rm{constructor(e,n,i,s){super(n.code,n.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,k3.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,s){return new k3(e,n,i,s)}}function SJ(a,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(a):n._getIdTokenResponse(a)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?k3._fromErrorAndOperation(a,r,e,i):r})}async function Ege(a,e,n=!1){const i=await IS(a,e._linkToIdToken(a.auth,await a.getIdToken()),n);return dy._forOperation(a,"link",i)}async function Mge(a,e,n=!1){const{auth:i}=a;if(cc(i.app))return Promise.reject(Jh(i));const s="reauthenticate";try{const r=await IS(a,SJ(i,s,e,a),n);Zn(r.idToken,i,"internal-error");const o=cF(r.idToken);Zn(o,i,"internal-error");const{sub:l}=o;return Zn(a.uid===l,i,"user-mismatch"),dy._forOperation(a,s,r)}catch(r){throw r?.code==="auth/user-not-found"&&qu(i,"user-mismatch"),r}}async function TJ(a,e,n=!1){if(cc(a.app))return Promise.reject(Jh(a));const i="signIn",s=await SJ(a,i,e),r=await dy._fromIdTokenResponse(a,i,s);return n||await a._updateCurrentUser(r.user),r}async function wJ(a,e){return TJ(eh(a),e)}function EJ(a,e,n){Zn(n.url?.length>0,a,"invalid-continue-uri"),Zn(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,a,"invalid-dynamic-link-domain"),Zn(typeof n.linkDomain>"u"||n.linkDomain.length>0,a,"invalid-hosting-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.linkDomain=n.linkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Zn(n.iOS.bundleId.length>0,a,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(Zn(n.android.packageName.length>0,a,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}async function MJ(a){const e=eh(a);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Cge(a,e,n){const i=eh(a),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&EJ(i,s,n),await D3(i,s,"getOobCode",vge)}async function Nge(a,e,n){if(cc(a.app))return Promise.reject(Jh(a));const i=eh(a),o=await D3(i,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",wge).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&MJ(a),c}),l=await dy._fromIdTokenResponse(i,"signIn",o);return await i._updateCurrentUser(l.user),l}function Rge(a,e,n){return cc(a.app)?Promise.reject(Jh(a)):wJ(nr(a),Dx.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&MJ(a),i})}async function CJ(a,e){const n=nr(a),s={requestType:"VERIFY_EMAIL",idToken:await a.getIdToken()};e&&EJ(n.auth,s,e);const{email:r}=await yge(n.auth,s);r!==a.email&&await a.reload()}function Pge(a,e,n,i){return nr(a).onIdTokenChanged(e,n,i)}function Ige(a,e,n){return nr(a).beforeAuthStateChanged(e,n)}function Lge(a,e,n,i){return nr(a).onAuthStateChanged(e,n,i)}function Dge(a){return nr(a).signOut()}const O3="__sak";class NJ{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(O3,"1"),this.storage.removeItem(O3),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const kge=1e3,Oge=10;class RJ extends NJ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=AJ(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),s=this.localCache[n];i!==s&&e(n,s,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const i=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(i);!n&&this.localCache[i]===o||this.notifyListeners(i,o)},r=this.storage.getItem(i);Qme()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Oge):s()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},kge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}RJ.type="LOCAL";const Fge=RJ;class PJ extends NJ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}PJ.type="SESSION";const IJ=PJ;function jge(a){return Promise.all(a.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class cP{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const i=new cP(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:s,data:r}=n.data,o=this.handlersMap[s];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,r)),c=await jge(l);n.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}cP.receivers=[];function fF(a="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return a+n}class Bge{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,o;return new Promise((l,c)=>{const u=fF("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),r=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),l(m.data.response);break;default:clearTimeout(h),clearTimeout(r),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Zh(){return window}function Uge(a){Zh().location.href=a}function LJ(){return typeof Zh().WorkerGlobalScope<"u"&&typeof Zh().importScripts=="function"}async function Vge(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function zge(){return navigator?.serviceWorker?.controller||null}function Gge(){return LJ()?self:null}const DJ="firebaseLocalStorageDb",qge=1,F3="firebaseLocalStorage",kJ="fbase_key";class LT{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function uP(a,e){return a.transaction([F3],e?"readwrite":"readonly").objectStore(F3)}function Hge(){const a=indexedDB.deleteDatabase(DJ);return new LT(a).toPromise()}function q6(){const a=indexedDB.open(DJ,qge);return new Promise((e,n)=>{a.addEventListener("error",()=>{n(a.error)}),a.addEventListener("upgradeneeded",()=>{const i=a.result;try{i.createObjectStore(F3,{keyPath:kJ})}catch(s){n(s)}}),a.addEventListener("success",async()=>{const i=a.result;i.objectStoreNames.contains(F3)?e(i):(i.close(),await Hge(),e(await q6()))})})}async function fG(a,e,n){const i=uP(a,!0).put({[kJ]:e,value:n});return new LT(i).toPromise()}async function Wge(a,e){const n=uP(a,!1).get(e),i=await new LT(n).toPromise();return i===void 0?null:i.value}function pG(a,e){const n=uP(a,!0).delete(e);return new LT(n).toPromise()}const $ge=800,Kge=3;class OJ{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await q6(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>Kge)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return LJ()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=cP._getInstance(Gge()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Vge(),!this.activeServiceWorker)return;this.sender=new Bge(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||zge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await q6();return await fG(e,O3,"1"),await pG(e,O3),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>fG(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>Wge(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>pG(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const r=uP(s,!1).getAll();return new LT(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:r}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$ge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}OJ.type="LOCAL";const Yge=OJ;new RT(3e4,6e4);function pF(a,e){return e?Kp(e):(Zn(a._popupRedirectResolver,a,"argument-error"),a._popupRedirectResolver)}class mF extends dF{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return g_(e,this._buildIdpRequest())}_linkToIdToken(e,n){return g_(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return g_(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Xge(a){return TJ(a.auth,new mF(a),a.bypassAuthState)}function Qge(a){const{auth:e,user:n}=a;return Zn(n,e,"internal-error"),Mge(n,new mF(a),a.bypassAuthState)}async function Jge(a){const{auth:e,user:n}=a;return Zn(n,e,"internal-error"),Ege(n,new mF(a),a.bypassAuthState)}class FJ{constructor(e,n,i,s,r=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:s,tenantId:r,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:i,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Xge;case"linkViaPopup":case"linkViaRedirect":return Jge;case"reauthViaPopup":case"reauthViaRedirect":return Qge;default:qu(this.auth,"internal-error")}}resolve(e){hm(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){hm(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Zge=new RT(2e3,1e4);async function e0e(a,e,n){if(cc(a.app))return Promise.reject(Gd(a,"operation-not-supported-in-this-environment"));const i=eh(a);iJ(a,e,lP);const s=pF(i,n);return new BA(i,"signInViaPopup",e,s).executeNotNull()}class BA extends FJ{constructor(e,n,i,s,r){super(e,n,s,r),this.provider=i,this.authWindow=null,this.pollId=null,BA.currentPopupAction&&BA.currentPopupAction.cancel(),BA.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Zn(e,this.auth,"internal-error"),e}async onExecution(){hm(this.filter.length===1,"Popup operations only handle one event");const e=fF();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Gd(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Gd(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,BA.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Gd(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Zge.get())};e()}}BA.currentPopupAction=null;const t0e="pendingRedirect",zC=new Map;class n0e extends FJ{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=zC.get(this.auth._key());if(!e){try{const i=await a0e(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}zC.set(this.auth._key(),e)}return this.bypassAuthState||zC.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function a0e(a,e){const n=BJ(e),i=jJ(a);if(!await i._isAvailable())return!1;const s=await i._get(n)==="true";return await i._remove(n),s}async function i0e(a,e){return jJ(a)._set(BJ(e),"true")}function s0e(a,e){zC.set(a._key(),e)}function jJ(a){return Kp(a._redirectPersistence)}function BJ(a){return VC(t0e,a.config.apiKey,a.name)}function r0e(a,e,n){return o0e(a,e,n)}async function o0e(a,e,n){if(cc(a.app))return Promise.reject(Jh(a));const i=eh(a);iJ(a,e,lP),await i._initializationPromise;const s=pF(i,n);return await i0e(s,i),s._openRedirect(i,e,"signInViaRedirect")}async function l0e(a,e){return await eh(a)._initializationPromise,UJ(a,e,!1)}async function UJ(a,e,n=!1){if(cc(a.app))return Promise.reject(Jh(a));const i=eh(a),s=pF(i,e),o=await new n0e(i,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const c0e=600*1e3;class u0e{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!d0e(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!VJ(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Gd(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=c0e&&this.cachedEventUids.clear(),this.cachedEventUids.has(mG(e))}saveEventToCache(e){this.cachedEventUids.add(mG(e)),this.lastProcessedEventTime=Date.now()}}function mG(a){return[a.type,a.eventId,a.sessionId,a.tenantId].filter(e=>e).join("-")}function VJ({type:a,error:e}){return a==="unknown"&&e?.code==="auth/no-auth-event"}function d0e(a){switch(a.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return VJ(a);default:return!1}}async function h0e(a,e={}){return Lm(a,"GET","/v1/projects",e)}const f0e=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,p0e=/^https?/;async function m0e(a){if(a.config.emulator)return;const{authorizedDomains:e}=await h0e(a);for(const n of e)try{if(g0e(n))return}catch{}qu(a,"unauthorized-domain")}function g0e(a){const e=z6(),{protocol:n,hostname:i}=new URL(e);if(a.startsWith("chrome-extension://")){const o=new URL(a);return o.hostname===""&&i===""?n==="chrome-extension:"&&a.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===i}if(!p0e.test(n))return!1;if(f0e.test(a))return i===a;const s=a.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const A0e=new RT(3e4,6e4);function gG(){const a=Zh().___jsl;if(a?.H){for(const e of Object.keys(a.H))if(a.H[e].r=a.H[e].r||[],a.H[e].L=a.H[e].L||[],a.H[e].r=[...a.H[e].L],a.CP)for(let n=0;n<a.CP.length;n++)a.CP[n]=null}}function y0e(a){return new Promise((e,n)=>{function i(){gG(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gG(),n(Gd(a,"network-request-failed"))},timeout:A0e.get()})}if(Zh().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Zh().gapi?.load)i();else{const s=rge("iframefcb");return Zh()[s]=()=>{gapi.load?i():n(Gd(a,"network-request-failed"))},vJ(`${sge()}?onload=${s}`).catch(r=>n(r))}}).catch(e=>{throw GC=null,e})}let GC=null;function v0e(a){return GC=GC||y0e(a),GC}const _0e=new RT(5e3,15e3),x0e="__/auth/iframe",b0e="emulator/auth/iframe",S0e={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},T0e=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function w0e(a){const e=a.config;Zn(e.authDomain,a,"auth-domain-config-required");const n=e.emulator?lF(e,b0e):`https://${a.config.authDomain}/${x0e}`,i={apiKey:e.apiKey,appName:a.name,v:wx},s=T0e.get(a.config.apiHost);s&&(i.eid=s);const r=a._getFrameworks();return r.length&&(i.fw=r.join(",")),`${n}?${xT(i).slice(1)}`}async function E0e(a){const e=await v0e(a),n=Zh().gapi;return Zn(n,a,"internal-error"),e.open({where:document.body,url:w0e(a),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:S0e,dontclear:!0},i=>new Promise(async(s,r)=>{await i.restyle({setHideOnLeave:!1});const o=Gd(a,"network-request-failed"),l=Zh().setTimeout(()=>{r(o)},_0e.get());function c(){Zh().clearTimeout(l),s(i)}i.ping(c).then(c,()=>{r(o)})}))}const M0e={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},C0e=500,N0e=600,R0e="_blank",P0e="http://localhost";class AG{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function I0e(a,e,n,i=C0e,s=N0e){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const c={...M0e,width:i.toString(),height:s.toString(),top:r,left:o},u=ml().toLowerCase();n&&(l=hJ(u)?R0e:n),uJ(u)&&(e=e||P0e,c.scrollbars="yes");const h=Object.entries(c).reduce((m,[A,x])=>`${m}${A}=${x},`,"");if(Xme(u)&&l!=="_self")return L0e(e||"",l),new AG(null);const f=window.open(e||"",l,h);Zn(f,a,"popup-blocked");try{f.focus()}catch{}return new AG(f)}function L0e(a,e){const n=document.createElement("a");n.href=a,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const D0e="__/auth/handler",k0e="emulator/auth/handler",O0e=encodeURIComponent("fac");async function yG(a,e,n,i,s,r){Zn(a.config.authDomain,a,"auth-domain-config-required"),Zn(a.config.apiKey,a,"invalid-api-key");const o={apiKey:a.config.apiKey,appName:a.name,authType:n,redirectUrl:i,v:wx,eventId:s};if(e instanceof lP){e.setDefaultLanguage(a.languageCode),o.providerId=e.providerId||"",Vue(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof IT){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}a.tenantId&&(o.tid=a.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await a._getAppCheckToken(),u=c?`#${O0e}=${encodeURIComponent(c)}`:"";return`${F0e(a)}?${xT(l).slice(1)}${u}`}function F0e({config:a}){return a.emulator?lF(a,k0e):`https://${a.authDomain}/${D0e}`}const iD="webStorageSupport";class j0e{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=IJ,this._completeRedirectFn=UJ,this._overrideRedirectResult=s0e}async _openPopup(e,n,i,s){hm(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const r=await yG(e,n,i,z6(),s);return I0e(e,r,fF())}async _openRedirect(e,n,i,s){await this._originValidation(e);const r=await yG(e,n,i,z6(),s);return Uge(r),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:r}=this.eventManagers[n];return s?Promise.resolve(s):(hm(r,"If manager is not set, promise should be"),r)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await E0e(e),i=new u0e(e);return n.register("authEvent",s=>(Zn(s?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(iD,{type:iD},s=>{const r=s?.[0]?.[iD];r!==void 0&&n(!!r),qu(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=m0e(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return AJ()||dJ()||uF()}}const B0e=j0e;var vG="@firebase/auth",_G="1.12.0";class U0e{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Zn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function V0e(a){switch(a){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function z0e(a){L_(new sy("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Zn(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:l,clientPlatform:a,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yJ(a)},u=new nge(i,s,r,c);return hge(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),L_(new sy("auth-internal",e=>{const n=eh(e.getProvider("auth").getImmediate());return(i=>new U0e(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Wg(vG,_G,V0e(a)),Wg(vG,_G,"esm2020")}const G0e=300,q0e=uX("authIdTokenMaxAge")||G0e;let xG=null;const H0e=a=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>q0e)return;const s=n?.token;xG!==s&&(xG=s,await fetch(a,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function W0e(a=gX()){const e=A8(a,"auth");if(e.isInitialized())return e.getImmediate();const n=dge(a,{popupRedirectResolver:B0e,persistence:[Yge,Fge,IJ]}),i=uX("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(i,location.origin);if(location.origin===r.origin){const o=H0e(r.toString());Ige(n,o,()=>o(n.currentUser)),Pge(n,l=>o(l))}}const s=lX("auth");return s&&fge(n,`http://${s}`),n}function $0e(){return document.getElementsByTagName("head")?.[0]??document}age({loadJS(a){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",a),i.onload=e,i.onerror=s=>{const r=Gd("internal-error");r.customData=s,n(r)},i.type="text/javascript",i.charset="UTF-8",$0e().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});z0e("Browser");const K0e={apiKey:"AIzaSyBIpJz1ZoZx_roIne3oc0yArVzeo4kDmvw",authDomain:"pcfutbol-web.firebaseapp.com",projectId:"pcfutbol-web",storageBucket:"pcfutbol-web.firebasestorage.app",messagingSenderId:"664376263748",appId:"1:664376263748:web:3ba1fd5d119d021cb5e811"},zJ=mX(K0e),Kn=ume(zJ),Tr=W0e(zJ),gF="contrarreloj_saves";function AF(a){return`${a}_contrarreloj`}async function GJ(a){const e=Ra(Kn,gF,AF(a)),n=await go(e);if(!n.exists())return null;const i=n.data(),s=o=>{if(Array.isArray(o))return o;if(o&&typeof o=="object"){const l=Object.keys(o);if(l.length>0&&l.every(c=>/^\d+$/.test(c)))return l.sort((c,u)=>+c-+u).map(c=>o[c])}return o},r=["leagueTable","fixtures","results","messages","transferOffers","playerMarket","freeAgents","seasonObjectives","jobOffers","blockedPlayers","activeLoans","loanHistory","incomingLoanOffers","convocados","preseasonMatches"];for(const o of r)o in i&&(i[o]=s(i[o])||[]);return i.team?.players&&(i.team={...i.team,players:s(i.team.players)||[]}),i}async function Y0e(a){const e=await GJ(a);return e?e.contrarrelojData?.finished||!1?(await yF(a),{hasActive:!1,summary:null}):{hasActive:!0,summary:{teamName:e.team?.name||"Equipo desconocido",teamId:e.teamId,leagueId:e.leagueId||e.playerLeagueId,season:e.contrarrelojData?.seasonsPlayed||1,week:e.currentWeek||1,money:e.money||0,trophies:e.contrarrelojData?.trophies?.length||0}}:{hasActive:!1,summary:null}}async function sD(a,e){const n=AF(a),i={...e,userId:a,lastSaved:Hi(),_type:"contrarreloj"};delete i.loaded,await Kf(Ra(Kn,gF,n),i)}async function yF(a){await cy(Ra(Kn,gF,AF(a)))}const vF="promanager_saves";function _F(a){return`${a}_promanager`}async function qJ(a){const e=Ra(Kn,vF,_F(a)),n=await go(e);if(!n.exists())return null;const i=n.data(),s=o=>{if(Array.isArray(o))return o;if(o&&typeof o=="object"){const l=Object.keys(o);if(l.length>0&&l.every(c=>/^\d+$/.test(c)))return l.sort((c,u)=>+c-+u).map(c=>o[c])}return o},r=["leagueTable","fixtures","results","messages","transferOffers","playerMarket","freeAgents","seasonObjectives","jobOffers","blockedPlayers","activeLoans","loanHistory","incomingLoanOffers","convocados","preseasonMatches"];for(const o of r)o in i&&(i[o]=s(i[o])||[]);return i.team?.players&&(i.team={...i.team,players:s(i.team.players)||[]}),i.proManagerData?.careerHistory&&(i.proManagerData.careerHistory=s(i.proManagerData.careerHistory)||[]),i}async function X0e(a){const e=await qJ(a);return e?e.proManagerData?.finished||!1?(await xF(a),{hasActive:!1,summary:null}):{hasActive:!0,summary:{teamName:e.team?.name||"Unknown",teamId:e.teamId,leagueId:e.leagueId||e.playerLeagueId,season:e.proManagerData?.seasonsManaged||1,week:e.currentWeek||1,prestige:e.proManagerData?.prestige||10,boardConfidence:e.proManagerData?.boardConfidence||60,titles:e.proManagerData?.titles||0}}:{hasActive:!1,summary:null}}async function bG(a,e){const n=_F(a),i={...e,userId:a,lastSaved:Hi(),_type:"promanager"};delete i.loaded,await Kf(Ra(Kn,vF,n),i)}async function xF(a){await cy(Ra(Kn,vF,_F(a)))}const SG={GK:[{id:"shot_stopper",name:"Parador",icon:"",desc:"Especialista en paradas difciles"},{id:"sweeper_keeper",name:"Lbero",icon:"",desc:"Sale bien del rea, buen juego con los pies"},{id:"commander",name:"Comunicador",icon:"",desc:"Organiza la defensa, da seguridad"}],CB:[{id:"wall",name:"Muro",icon:"",desc:"Imponente en duelos areos y fsicos"},{id:"leader",name:"Lder",icon:"",desc:"Organiza la lnea, mejora a los compaeros"},{id:"ball_playing",name:"Constructor",icon:"",desc:"Buen pase largo, inicia jugadas"},{id:"marker",name:"Marcador",icon:"",desc:"Anula al delantero rival"}],LB:[{id:"attacking_fb",name:"Ofensivo",icon:"",desc:"Sube constantemente al ataque"},{id:"defensive_fb",name:"Defensivo",icon:"",desc:"Prioriza la solidez atrs"},{id:"inverted_fb",name:"Invertido",icon:"",desc:"Cierra al centro, crea superioridad"}],RB:[{id:"attacking_fb",name:"Ofensivo",icon:"",desc:"Sube constantemente al ataque"},{id:"defensive_fb",name:"Defensivo",icon:"",desc:"Prioriza la solidez atrs"},{id:"inverted_fb",name:"Invertido",icon:"",desc:"Cierra al centro, crea superioridad"}],CDM:[{id:"destroyer",name:"Destructor",icon:"",desc:"Rompe el juego rival, recupera balones"},{id:"anchor",name:"Ancla",icon:"",desc:"Posicional, da equilibrio al equipo"},{id:"deep_playmaker",name:"Pivote creativo",icon:"",desc:"Distribuye desde atrs"}],CM:[{id:"box_to_box",name:"Box to box",icon:"",desc:"Incansable, cubre todo el campo"},{id:"playmaker",name:"Organizador",icon:"",desc:"Cerebro del equipo, dicta el ritmo"},{id:"mezzala",name:"Mezzala",icon:"",desc:"Se incorpora al ataque por los costados"}],CAM:[{id:"classic_10",name:"Clsico 10",icon:"",desc:"Creador puro, ltimo pase letal"},{id:"shadow_striker",name:"Segundo punta",icon:"",desc:"Aparece en el rea, goleador"},{id:"trequartista",name:"Trequartista",icon:"",desc:"Impredecible, busca espacios"}],LW:[{id:"winger",name:"Extremo puro",icon:"",desc:"Velocidad y desborde por banda"},{id:"inverted_winger",name:"Extremo invertido",icon:"",desc:"Recorta hacia dentro para disparar"},{id:"wide_playmaker",name:"Creador de banda",icon:"",desc:"Baja a recibir y distribuir"}],RW:[{id:"winger",name:"Extremo puro",icon:"",desc:"Velocidad y desborde por banda"},{id:"inverted_winger",name:"Extremo invertido",icon:"",desc:"Recorta hacia dentro para disparar"},{id:"wide_playmaker",name:"Creador de banda",icon:"",desc:"Baja a recibir y distribuir"}],RM:[{id:"winger",name:"Extremo puro",icon:"",desc:"Velocidad y desborde por banda"},{id:"wide_midfielder",name:"Volante de banda",icon:"",desc:"Equilibrado, sube y baja"}],LM:[{id:"winger",name:"Extremo puro",icon:"",desc:"Velocidad y desborde por banda"},{id:"wide_midfielder",name:"Volante de banda",icon:"",desc:"Equilibrado, sube y baja"}],ST:[{id:"poacher",name:"Rematador",icon:"",desc:"Letal en el rea, vive del gol"},{id:"speedster",name:"Velocista",icon:"",desc:"Ataca los espacios, letal al contra"},{id:"target_man",name:"Pivote",icon:"",desc:"Aguanta balones, conecta el juego"},{id:"pressing_forward",name:"Presionador",icon:"",desc:"Primer defensor, roba y corre"},{id:"complete_forward",name:"Completo",icon:"",desc:"Hace de todo, referencia total"}],CF:[{id:"false_nine",name:"Falso 9",icon:"",desc:"Baja a crear, arrastra marcas"},{id:"poacher",name:"Rematador",icon:"",desc:"Letal en el rea, vive del gol"},{id:"complete_forward",name:"Completo",icon:"",desc:"Hace de todo, referencia total"}]},Q0e={defensive:{wall:4,leader:3,marker:4,defensive_fb:3,anchor:4,destroyer:3,shot_stopper:2,commander:2,attacking_fb:-2,winger:-2,trequartista:-3,speedster:-1},balanced:{box_to_box:3,anchor:2,playmaker:2,mezzala:2,leader:1,ball_playing:2},attacking:{attacking_fb:4,winger:3,inverted_winger:3,classic_10:3,shadow_striker:3,poacher:2,speedster:2,trequartista:2,defensive_fb:-2,anchor:-1,wall:-1},possession:{playmaker:5,deep_playmaker:4,ball_playing:4,classic_10:4,anchor:3,mezzala:2,wide_playmaker:3,false_nine:4,commander:2,sweeper_keeper:3,destroyer:-2,speedster:-3,pressing_forward:-2,poacher:-1},counter:{speedster:5,winger:4,pressing_forward:3,destroyer:3,box_to_box:3,poacher:2,inverted_winger:2,shot_stopper:2,defensive_fb:2,playmaker:-2,classic_10:-2,trequartista:-3,false_nine:-3,ball_playing:-1}},J0e=[["classic_10","poacher",3,"El creador encuentra al rematador"],["playmaker","box_to_box",2,"Organizacin y despliegue fsico"],["leader","wall",3,"Defensa slida y organizada"],["winger","target_man",3,"Centros al pivote"],["inverted_winger","attacking_fb",2,"Superioridad en banda"],["deep_playmaker","speedster",2,"Pases largos al velocista"],["destroyer","playmaker",2,"Recupera y distribuye"],["pressing_forward","destroyer",2,"Presin coordinada"],["commander","leader",2,"Comunicacin defensiva"],["sweeper_keeper","ball_playing",2,"Salida de baln limpia"],["shadow_striker","target_man",3,"Pivote y llegador"],["false_nine","winger",3,"Espacios para los extremos"],["mezzala","defensive_fb",2,"Equilibrio en banda"]],Z0e=[["poacher","false_nine",-2,"Dos delanteros que quieren el mismo espacio"],["trequartista","classic_10",-2,"Demasiada creatividad, poca finalizacin"],["speedster","speedster",-1,"Sin servicio, corren sin baln"],["destroyer","destroyer",-1,"Demasiado msculo, poca creacin"]];function rD(a){const e=a.position,n=SG[e]||SG.CM;if(!n||n.length===0)return{id:"unknown",name:"Verstil",icon:"",desc:"Jugador polivalente"};const i=a.age||25,s=a.overall||70,r=a.pace||a.speed||s,o=a.passing||s,l=a.shooting||s,c=a.defending||a.tackling||s,u=a.physical||a.stamina||s,h=n.map(f=>{let m=10;switch(f.id){case"shot_stopper":m+=s*.3;break;case"sweeper_keeper":m+=(r+o)*.2;break;case"commander":m+=(i>28?15:0)+(s>78?10:0);break;case"wall":m+=(u+c)*.3;break;case"leader":m+=(i>27?20:0)+(s>75?15:0);break;case"ball_playing":m+=o*.4;break;case"marker":m+=c*.4;break;case"attacking_fb":m+=(r+o)*.25;break;case"defensive_fb":m+=c*.4;break;case"inverted_fb":m+=o*.35;break;case"destroyer":m+=(u+c)*.3;break;case"anchor":m+=(c+o)*.2;break;case"deep_playmaker":m+=o*.5;break;case"box_to_box":m+=(u+r)*.25;break;case"playmaker":m+=o*.5+(i>26?10:0);break;case"mezzala":m+=(r+l)*.2;break;case"classic_10":m+=o*.5;break;case"shadow_striker":m+=l*.4;break;case"trequartista":m+=(o+r)*.2+Math.random()*20;break;case"winger":m+=r*.5;break;case"inverted_winger":m+=l*.4;break;case"wide_playmaker":m+=o*.4;break;case"wide_midfielder":m+=(u+c)*.2;break;case"poacher":m+=l*.5;break;case"speedster":m+=r*.5;break;case"target_man":m+=u*.5;break;case"pressing_forward":m+=(u+r)*.25;break;case"complete_forward":m+=s*.3+(s>82?20:0);break;case"false_nine":m+=o*.4;break}return m+=Math.random()*15,{role:f,weight:m}});return h.sort((f,m)=>m.weight-f.weight),h[0].role}function HJ(a,e,n){if(!a.role)return 0;let i=0;const s=a.role.id,r=Q0e[e]||{};i+=r[s]||0;const o=n.filter(l=>l.name!==a.name&&l.role).map(l=>l.role.id);return J0e.forEach(([l,c,u])=>{s===l&&o.includes(c)&&(i+=u),s===c&&o.includes(l)&&(i+=u)}),Z0e.forEach(([l,c,u])=>{s===l&&o.includes(c)&&(i+=u)}),Math.max(-5,Math.min(8,i))}function eAe(a,e,n,i=75){const s=a.overall||70,r=HJ(a,e,n),o=Math.round((i-75)/10),l=a.fitness??a.energy??100,c=l<70?-2:l<85?-1:0,u=s+r+o+c;return Math.max(40,Math.min(99,u))}const tAe={GK:"GK",CB:"CB",RB:"RB",LB:"LB",RWB:"RWB",LWB:"LWB",CDM:"CDM",CM:"CM",CAM:"CAM",RM:"RM",LM:"LM",RW:"RW",LW:"LW",ST:"ST",CF:"CF"},Sg={es:{GK:"POR",CB:"DFC",RB:"LD",LB:"LI",RWB:"CRD",LWB:"CRI",CDM:"MCD",CM:"MC",CAM:"MCO",RM:"MD",LM:"MI",RW:"ED",LW:"EI",ST:"DC",CF:"SD"},en:{GK:"GK",CB:"CB",RB:"RB",LB:"LB",RWB:"RWB",LWB:"LWB",CDM:"CDM",CM:"CM",CAM:"CAM",RM:"RM",LM:"LM",RW:"RW",LW:"LW",ST:"ST",CF:"CF"},fr:{GK:"GAR",CB:"DC",RB:"DD",LB:"DG",RWB:"PDD",LWB:"PDG",CDM:"MDC",CM:"MC",CAM:"MOC",RM:"MD",LM:"MG",RW:"AD",LW:"AG",ST:"AV",CF:"BU"},de:{GK:"TW",CB:"IV",RB:"RV",LB:"LV",RWB:"RSV",LWB:"LSV",CDM:"ZDM",CM:"ZM",CAM:"ZOM",RM:"RM",LM:"LM",RW:"RA",LW:"LA",ST:"ST",CF:"HS"},pt:{GK:"GR",CB:"ZAG",RB:"LD",LB:"LE",RWB:"ADD",LWB:"ADE",CDM:"VOL",CM:"MC",CAM:"MEI",RM:"MD",LM:"ME",RW:"PD",LW:"PE",ST:"ATA",CF:"SA"},it:{GK:"POR",CB:"DC",RB:"TD",LB:"TS",RWB:"EDD",LWB:"EDS",CDM:"MDI",CM:"CC",CAM:"TRQ",RM:"ED",LM:"ES",RW:"AD",LW:"AS",ST:"ATT",CF:"PUN"}},Xg={};Object.keys(Sg).forEach(a=>{Xg[a]={},Object.entries(Sg[a]).forEach(([e,n])=>{Xg[a][n]=e})});const j3={LTD:"RB",LTI:"LB",MDD:"RM",MDI:"LM",EDD:"RW",EDI:"LW",MP:"CF"};function nAe(){return localStorage.getItem("language")||"es"}function ds(a,e=nAe()){if(!a)return"";const n=a.replace(/\d+$/,"").toUpperCase();if(Sg[e]&&Sg[e][n])return Sg[e][n];let i=n;if(j3[n])i=j3[n];else for(const s of Object.keys(Xg))if(Xg[s][n]){i=Xg[s][n];break}return Sg[e]&&Sg[e][i]?Sg[e][i]:a}function DS(a){if(!a)return"";const e=a.replace(/\d+$/,"").toUpperCase();if(tAe[e])return e;if(j3[e])return j3[e];for(const n of Object.keys(Xg))if(Xg[n][e])return Xg[n][e];return a}const aAe={GK:{GK:1},CB:{CB:1,RB:.88,LB:.88,CDM:.82,CM:.7},RB:{RB:1,CB:.85,LB:.82,RM:.8,RWB:.95,CDM:.72,CM:.68},LB:{LB:1,CB:.85,RB:.82,LM:.8,LWB:.95,CDM:.72,CM:.68},CDM:{CDM:1,CM:.92,CB:.82,CAM:.75,RB:.72,LB:.72},CM:{CM:1,CDM:.9,CAM:.88,RM:.78,LM:.78,RW:.68,LW:.68},CAM:{CAM:1,CM:.88,CF:.85,RW:.78,LW:.78,CDM:.72,ST:.72},RM:{RM:1,RW:.92,CM:.8,RB:.75,LM:.78,CAM:.72},LM:{LM:1,LW:.92,CM:.8,LB:.75,RM:.78,CAM:.72},RW:{RW:1,RM:.92,LW:.88,ST:.75,CF:.78,CAM:.72,CM:.65},LW:{LW:1,LM:.92,RW:.88,ST:.75,CF:.78,CAM:.72,CM:.65},ST:{ST:1,CF:.92,RW:.75,LW:.75,CAM:.72,CM:.62},CF:{CF:1,ST:.92,CAM:.85,RW:.78,LW:.78,CM:.68},RWB:{RWB:1,RB:.95,RM:.85,CB:.75,LB:.72,CM:.68},LWB:{LWB:1,LB:.95,LM:.85,CB:.75,RB:.72,CM:.68}},TG=.6,iAe=.3,sAe=.3;function rc(a,e){if(!a||!e)return{factor:1,level:"perfect"};const n=DS(a).toUpperCase(),i=DS(e).toUpperCase();if(n===i)return{factor:1,level:"perfect"};if(n==="GK")return{factor:iAe,level:"terrible"};if(i==="GK")return{factor:sAe,level:"terrible"};const s=aAe[n];if(s&&s[i]!==void 0){const r=s[i];return{factor:r,level:wG(r)}}return{factor:TG,level:wG(TG)}}function wG(a){return a>=1?"perfect":a>=.88?"good":a>=.75?"decent":a>=.55?"poor":"terrible"}function Lh(a){return a?a.replace(/\d+$/,"").toUpperCase():""}const rAe={perfect:"#30d158",good:"#27ae60",decent:"#ffd60a",poor:"#ff9f0a",terrible:"#ff453a"},H6={"4-3-3":{name:"4-3-3",positions:["GK","RB","CB","CB","LB","CDM","CM","CM","RW","LW","ST"],style:{attack:1.1,defense:.95,midfield:1},description:"Equilibrado con extremos peligrosos"},"4-4-2":{name:"4-4-2",positions:["GK","RB","CB","CB","LB","RM","CM","CM","LM","ST","ST"],style:{attack:1,defense:1,midfield:1.05},description:"Clsico y slido"},"4-2-3-1":{name:"4-2-3-1",positions:["GK","RB","CB","CB","LB","CDM","CDM","CAM","RW","LW","ST"],style:{attack:1.05,defense:1.05,midfield:.95},description:"Control del centro del campo"},"3-5-2":{name:"3-5-2",positions:["GK","CB","CB","CB","RM","CDM","CM","CM","LM","ST","ST"],style:{attack:1.15,defense:.85,midfield:1.1},description:"Ofensivo con carrileros"},"5-3-2":{name:"5-3-2",positions:["GK","RB","CB","CB","CB","LB","CDM","CM","CM","ST","ST"],style:{attack:.85,defense:1.2,midfield:.95},description:"Ultra defensivo"},"4-1-4-1":{name:"4-1-4-1",positions:["GK","RB","CB","CB","LB","CDM","RM","CM","CM","LM","ST"],style:{attack:.9,defense:1.1,midfield:1.1},description:"Compacto y ordenado"},"3-4-3":{name:"3-4-3",positions:["GK","CB","CB","CB","RM","CM","CM","LM","RW","ST","LW"],style:{attack:1.25,defense:.8,midfield:1},description:"Ultra ofensivo con 3 delanteros"},"5-4-1":{name:"5-4-1",positions:["GK","RB","CB","CB","CB","LB","RM","CM","CM","LM","ST"],style:{attack:.75,defense:1.3,midfield:1},description:"Muralla defensiva"},"4-5-1":{name:"4-5-1",positions:["GK","RB","CB","CB","LB","RM","CM","CDM","CM","LM","ST"],style:{attack:.85,defense:1.05,midfield:1.2},description:"Dominio del centro del campo"},"4-3-3 (MCO)":{name:"4-3-3 (MCO)",positions:["GK","RB","CB","CB","LB","CM","CM","CAM","RW","LW","ST"],style:{attack:1.15,defense:.9,midfield:1.05},description:"Mediapunta como enlace ofensivo"},"4-4-2 (Diamante)":{name:"4-4-2 (Diamante)",positions:["GK","RB","CB","CB","LB","CDM","CM","CM","CAM","ST","ST"],style:{attack:1.1,defense:.95,midfield:1.1},description:"Rombo en el centro, potencia arriba"},"4-1-2-1-2":{name:"4-1-2-1-2",positions:["GK","RB","CB","CB","LB","CDM","CM","CM","CAM","ST","ST"],style:{attack:1.1,defense:1,midfield:1},description:"Estrecho, juego interior con 2 puntas"},"3-4-1-2":{name:"3-4-1-2",positions:["GK","CB","CB","CB","RM","CM","CM","LM","CAM","ST","ST"],style:{attack:1.2,defense:.85,midfield:1.05},description:"Mediapunta con doble punta y carrileros"},"4-3-2-1":{name:"4-3-2-1",positions:["GK","RB","CB","CB","LB","CDM","CM","CM","RW","LW","ST"],style:{attack:1.05,defense:1,midfield:1.05},description:"rbol de Navidad, compacto en ataque"},"5-2-3":{name:"5-2-3",positions:["GK","RB","CB","CB","CB","LB","CM","CM","RW","ST","LW"],style:{attack:1.1,defense:1.1,midfield:.85},description:"Defensa slida con tridente ofensivo"}},Dd={balanced:{name:"Equilibrado",attack:1,defense:1,fatigue:1,possession:1},attacking:{name:"Ofensivo",attack:1.35,defense:.7,fatigue:1.15,possession:1.05},defensive:{name:"Defensivo",attack:.6,defense:1.4,fatigue:.85,possession:.85},possession:{name:"Posesin",attack:.95,defense:1.1,fatigue:.9,possession:1.3},counter:{name:"Contraataque",attack:1.2,defense:1.15,fatigue:1.1,possession:.75,counter:1.5},highPress:{name:"Presin alta",attack:1.25,defense:.85,fatigue:1.3,possession:1.1}},oAe={counter:{strongVs:["attacking","highPress"],weakVs:["possession","defensive"]},possession:{strongVs:["counter","defensive"],weakVs:["highPress"]},attacking:{strongVs:["defensive","balanced"],weakVs:["counter","highPress"]},defensive:{strongVs:["balanced"],weakVs:["possession","attacking"]},highPress:{strongVs:["possession","balanced"],weakVs:["counter"]},balanced:{strongVs:[],weakVs:[]}};function EG(a,e){const n=oAe[a];return n?n.strongVs.includes(e)?6:n.weakVs.includes(e)?-4:0:0}function PE(a,e="balanced",n=[],i=70,s="normal"){if(a.injured)return a.overall*.3;let r=eAe(a,e,n,i);if(a.playingPosition){const l=rc(a.position,a.playingPosition);r*=l.factor}a.age>=34&&(r*=.97),a.age>=36&&(r*=.94),a.age<=23&&a.overall>=75&&(r*=1.02);const o=1+({excellent:.12,good:.05,normal:0,low:-.08,terrible:-.18}[s]||0);return r*=o,r}function MG(a,e){const n=a.filter(o=>!o.injured&&!o.suspended),i=[],s=new Set,r={GK:["GK"],RB:["RB","RWB","CB"],LB:["LB","LWB","CB"],CB:["CB","CDM"],CDM:["CDM","CM","CB"],CM:["CM","CDM","CAM"],CAM:["CAM","CM","RW","LW"],RM:["RM","RW","CM"],LM:["LM","LW","CM"],RW:["RW","RM","ST","CAM"],LW:["LW","LM","ST","CAM"],ST:["ST","CF","CAM","RW","LW"]};for(const o of e){const l=r[o]||[o];let c=null,u=-1;for(const h of n){if(s.has(h.name))continue;const f=l.indexOf(h.position);if(f===-1)continue;const m=h.overall-f*3;m>u&&(u=m,c=h)}c&&(i.push({...c,playingPosition:o}),s.add(c.name))}return i}function B3(a,e="4-3-3",n="balanced",i=70,s=null,r={}){if(!a||!a.players||a.players.length===0)return{overall:a?.reputation||50,attack:50,midfield:50,defense:50,goalkeeper:50,lineup:[]};const o=H6[e]||H6["4-3-3"],l=Dd[n]||Dd.balanced;let c;if(s&&Object.keys(s).length>=11){if(c=Object.entries(s).filter(([U,q])=>q&&q.name).map(([U,q])=>{const K=a.players.find(X=>X.name===q.name)||q,H=Lh(U)||q.position;return{...K,playingPosition:H}}).filter(U=>!U.injured&&!U.suspended),c.length<11){const U=new Set(c.map(K=>K.name)),q=MG(a.players.filter(K=>!U.has(K.name)),o.positions.slice(c.length));c=[...c,...q]}}else c=MG(a.players,o.positions);const u=U=>U.playingPosition||U.position,h=c.filter(U=>u(U)==="GK"),f=c.filter(U=>["CB","RB","LB"].includes(u(U))),m=c.filter(U=>["CDM","CM","CAM","RM","LM"].includes(u(U))),A=c.filter(U=>["ST","RW","LW","CF"].includes(u(U)));h.length>0&&h.reduce((U,q)=>U+q.overall,0)/h.length,f.length>0&&f.reduce((U,q)=>U+q.overall,0)/f.length,m.length>0&&m.reduce((U,q)=>U+q.overall,0)/m.length,A.length>0&&A.reduce((U,q)=>U+q.overall,0)/A.length;const x=c.length>0?Math.round(c.reduce((U,q)=>U+q.overall,0)/c.length):60,T=h.length>0?h.reduce((U,q)=>U+PE(q,n,c,i,r[q.name]||"normal"),0)/h.length:60,E=f.length>0?f.reduce((U,q)=>U+PE(q,n,c,i,r[q.name]||"normal"),0)/f.length:60,M=m.length>0?m.reduce((U,q)=>U+PE(q,n,c,i,r[q.name]||"normal"),0)/m.length:60,N=A.length>0?A.reduce((U,q)=>U+PE(q,n,c,i,r[q.name]||"normal"),0)/A.length:60,I=E*o.style.defense*l.defense,F=M*o.style.midfield,G=N*o.style.attack*l.attack,O=T*.15+I*.25+F*.3+G*.3,D=c.filter(U=>U.overall>=85).length,j=D*1;let L=0;return c.forEach(U=>{if(U.role){const q=HJ(U,n,c);L+=q*.1}}),{overall:x,effectiveOverall:Math.min(99,O+j+L),attack:G,midfield:F,defense:I,goalkeeper:T,lineup:c,starPlayers:D,synergyBonus:Math.round(L*10)/10}}const Bb={huge:{upsetChance:.02},large:{upsetChance:.06},medium:{upsetChance:.12},small:{upsetChance:.22},tiny:{upsetChance:.38}},tv={elite:{baseWinRate:.75,drawRate:.15,lossRate:.1,goalsScored:2.4,goalsConceded:.8,tacticalFlexibility:.9,mentalStrength:.95},top:{baseWinRate:.55,drawRate:.25,lossRate:.2,goalsScored:1.8,goalsConceded:1.1,tacticalFlexibility:.75,mentalStrength:.8},midHigh:{baseWinRate:.45,drawRate:.28,lossRate:.27,goalsScored:1.5,goalsConceded:1.3,tacticalFlexibility:.65,mentalStrength:.7},mid:{baseWinRate:.35,drawRate:.3,lossRate:.35,goalsScored:1.2,goalsConceded:1.5,tacticalFlexibility:.55,mentalStrength:.6},midLow:{baseWinRate:.28,drawRate:.3,lossRate:.42,goalsScored:1,goalsConceded:1.7,tacticalFlexibility:.45,mentalStrength:.5},low:{baseWinRate:.22,drawRate:.28,lossRate:.5,goalsScored:.9,goalsConceded:1.9,tacticalFlexibility:.35,mentalStrength:.4}};function lAe(a){return a>=90?tv.elite:a>=80?tv.top:a>=72?tv.midHigh:a>=65?tv.mid:a>=58?tv.midLow:tv.low}function CG(a,e,n,i={}){const{morale:s=70,fatigue:r=0,injuries:o=0,isHome:l=!1,seasonMomentum:c=0,customLineup:u=null,attendanceFillRate:h=.7,playerForm:f={}}=i,m=B3(a,e,n,s,u,f),A=m.effectiveOverall||m.overall||70,x=a.reputation||3,T=lAe(x),E=cAe(a),M=r*.15,N=o*2,I=(s-50)*.12,F=l?2+h*6:0,G=c*.3,O=A-M-N+I+F+G;return{rating:Math.max(40,Math.min(99,O)),baseRating:A,reputation:x,profile:T,squadDepth:E,strength:m,modifiers:{fatigue:-M,injuries:-N,morale:I,home:F,momentum:G}}}function cAe(a){if(!a.players||a.players.length<15)return .5;const e=a.players.slice(0,11).reduce((s,r)=>s+(r.overall||70),0)/11,i=a.players.slice(11,18).reduce((s,r)=>s+(r.overall||65),0)/Math.min(7,a.players.length-11)/e;return Math.min(1,Math.max(0,i))}function uAe(a,e,n,i,s={}){const{homeFormation:r="4-3-3",awayFormation:o="4-3-3",homeTactic:l="balanced",awayTactic:c="balanced",homeMorale:u=70,awayMorale:h=70,homeSeasonMomentum:f=0,awaySeasonMomentum:m=0,isDerby:A=!1,importance:x="normal",weather:T="normal",referee:E="neutral",homeLineup:M=null,awayLineup:N=null,attendanceFillRate:I=.7,playerTeamForm:F={},playerTeamId:G=null}=s,O=n.id===G?F:{},D=i.id===G?F:{},j=CG(n,r,l,{morale:u,isHome:!0,seasonMomentum:f,customLineup:M,attendanceFillRate:I,playerForm:O}),L=CG(i,o,c,{morale:h,isHome:!1,seasonMomentum:m,customLineup:N,playerForm:D}),U=EG(l,c),q=EG(c,l),K=j.rating+U-(L.rating+q),H=(j.reputation-L.reputation)*.5,X=K+H,{homeWinProb:ne,drawProb:Q,awayWinProb:Y}=dAe(j,L,X,A),ue=hAe(X),pe=fAe(ne,Q,Y,ue),{homeScore:Ee,awayScore:oe}=pAe(pe,j,L,x,l,c),Ae=mAe(Ee,oe,n,i,j,L,E),be=gAe(j,L,Ee,oe,pe,l,c);return{homeScore:Ee,awayScore:oe,events:Ae,stats:be,debug:{homeRating:j.rating,awayRating:L.rating,ratingDiff:K,reputationDiff:H,probabilities:{homeWinProb:ne,drawProb:Q,awayWinProb:Y},result:pe===1?"homeWin":pe===0?"draw":"awayWin"}}}function dAe(a,e,n,i){const s=a.profile,r=e.profile;let o=s.baseWinRate,l=(s.drawRate+r.drawRate)/2,c=r.baseWinRate*.6;const u=n/80;o+=u*.5,c-=u*.4,o=Math.max(.05,o),c=Math.max(0,c),i&&(o*=.85,c*=1.15,l*=1.1);const h=o+l+c,f=Math.abs(n)>25?.02:.05;return{homeWinProb:Math.max(.05,Math.min(.92,o/h)),drawProb:Math.max(.08,Math.min(.4,l/h)),awayWinProb:Math.max(f,Math.min(.7,c/h))}}function hAe(a){const e=Math.abs(a);return e>20?Bb.huge.upsetChance:e>15?Bb.large.upsetChance:e>10?Bb.medium.upsetChance:e>5?Bb.small.upsetChance:Bb.tiny.upsetChance}function fAe(a,e,n,i,s){const r=Math.random();return r<i*.5?Math.random()>.6?-1:0:r<a?1:r<a+e?0:-1}function pAe(a,e,n,i,s="balanced",r="balanced"){const o=e.profile,l=n.profile;let c,u;const h=i==="final"?.85:i==="crucial"?.95:1,f=Dd[s]||Dd.balanced,m=Dd[r]||Dd.balanced,A=(f.attack+m.attack)/2;if(a===1){const x=oD([{value:1,weight:45},{value:2,weight:30},{value:3,weight:15},{value:4,weight:8},{value:5,weight:2}]);c=Math.round(o.goalsScored*h*A+Math.random()*1.5),u=Math.max(0,c-x),c<=u&&(c=u+1)}else if(a===-1){const x=oD([{value:1,weight:55},{value:2,weight:30},{value:3,weight:12},{value:4,weight:3}]);u=Math.round(l.goalsScored*h*A+Math.random()*1.2),c=Math.max(0,u-x),u<=c&&(u=c+1)}else{const x=oD([{value:0,weight:25},{value:1,weight:40},{value:2,weight:25},{value:3,weight:8},{value:4,weight:2}]);c=x,u=x}return{homeScore:c,awayScore:u}}function oD(a){const e=a.reduce((i,s)=>i+s.weight,0);let n=Math.random()*e;for(const i of a)if(n-=i.weight,n<=0)return i.value;return a[0].value}function mAe(a,e,n,i,s,r,o){const l=[],c=a+e,u=[];for(let x=0;x<c;x++)u.push(Math.floor(Math.random()*90)+1);u.sort((x,T)=>x-T);let h=a,f=e;u.forEach(x=>{const T=h/(h+f);Math.random()<T&&h>0?(l.push({type:"goal",team:"home",minute:x,player:NG(n,s.strength?.lineup),goalType:x>85?"late":"normal"}),h--):f>0&&(l.push({type:"goal",team:"away",minute:x,player:NG(i,r.strength?.lineup),goalType:x>85?"late":"normal"}),f--)});const m=2+Math.floor(Math.random()*3),A=o==="strict"?1.5:o==="lenient"?.6:1;for(let x=0;x<Math.floor(m*A);x++){const T=Math.random()>.5,E=T?n:i;l.push({type:"yellow_card",team:T?"home":"away",minute:Math.floor(Math.random()*90)+1,player:RG(E)})}return[n,i].forEach((x,T)=>{const E=T===0?"home":"away";Math.random()<.18*A&&l.push({type:"red_card",team:E,minute:25+Math.floor(Math.random()*60),player:RG(x)})}),l.sort((x,T)=>x.minute-T.minute)}function NG(a,e){if(!a?.players)return{name:"Desconocido"};const n=(e||a.players).filter(r=>["ST","CF","RW","LW","CAM"].includes(r.position));if(n.length===0)return a.players[0]||{name:"Desconocido"};const i=n.reduce((r,o)=>r+o.overall,0);let s=Math.random()*i;for(const r of n)if(s-=r.overall,s<=0)return{name:r.name,position:r.position};return{name:n[0].name,position:n[0].position}}function RG(a){return!a?.players||a.players.length===0?{name:"Desconocido"}:{name:a.players[Math.floor(Math.random()*a.players.length)].name}}function gAe(a,e,n,i,s,r="balanced",o="balanced"){const l=Dd[r]||Dd.balanced,c=Dd[o]||Dd.balanced,u=(a.strength?.midfield||70)-(e.strength?.midfield||70),h=((l.possession||1)-(c.possession||1))*20;let f=50+u/4+h+(s===1?3:s===-1?-3:0);f=Math.max(25,Math.min(75,f));const m=l.attack,A=c.attack,x=Math.round((8+Math.floor(f/10)+n*2)*m),T=Math.round((8+Math.floor((100-f)/10)+i*2)*A),E=r==="highPress"?1.4:r==="defensive"?1.2:1,M=o==="highPress"?1.4:o==="defensive"?1.2:1,N=Math.round((10+Math.floor(Math.random()*6))*E),I=Math.round((10+Math.floor(Math.random()*6))*M),F=Math.floor(N*(.15+Math.random()*.15)),G=Math.floor(I*(.15+Math.random()*.15)),O=r==="highPress"?1.5:r==="defensive"?1.3:1,D=o==="highPress"?1.5:o==="defensive"?1.3:1,j=Math.random()<.18*O?1:0,L=Math.random()<.18*D?1:0;return{possession:{home:Math.round(f),away:Math.round(100-f)},shots:{home:x,away:T},shotsOnTarget:{home:Math.floor(x*.4),away:Math.floor(T*.4)},corners:{home:Math.floor(f/12),away:Math.floor((100-f)/12)},fouls:{home:N,away:I},yellowCards:{home:F,away:G},redCards:{home:j,away:L}}}const IE={excellent:{label:"Excelente",arrow:"",color:"#00a8ff",matchBonus:.12},good:{label:"Buena",arrow:"",color:"#7ed321",matchBonus:.05},normal:{label:"Normal",arrow:"",color:"#999999",matchBonus:0},low:{label:"Baja",arrow:"",color:"#ff9500",matchBonus:-.08},terrible:{label:"Psima",arrow:"",color:"#ff3b30",matchBonus:-.18}},lD=["terrible","low","normal","good","excellent"];function WJ(a,e=!1){let n=3;a.age>=30?n+=1:a.age>=27?n+=.5:a.age<=21?n-=1:a.age<=23&&(n-=.5),a.overall>=82&&(n+=.5),e&&(n+=1);const i=a.personality?.type;return(i==="professional"||i==="leader")&&(n+=1),(i==="emotional"||i==="moody")&&(n-=1),Math.max(1,Math.min(5,Math.round(n)))}function AAe(a,e){return e===0||a>0?a<=3?3:a<=5?2.5:a<=7?2:a<=9?1:.5:e<=2?3.5:e<=4?4:e<=6?3:e<=8?2:1}function yAe(a,e,n,i){const s={},{rejectedTransfers:r={},captainName:o=null}=i,l=a[o]||"normal",u=lD.indexOf(l)>=3;return e.forEach(h=>{const f=h.name,m=n[f]||{consecutivePlayed:0,weeksSincePlay:0},A=WJ(h,f===o),x=r[f];if(x&&x.weeksLeft>0){const G=x.totalWeeks||x.weeksLeft,D=(G-x.weeksLeft)/G;D<.35?s[f]="terrible":D<.7?s[f]="low":s[f]="normal";return}if(h.isNewSigning&&(h.newSigningWeeks||0)>0){s[f]=Math.random()>.4?"excellent":"good";return}const T=AAe(m.consecutivePlayed,m.weeksSincePlay),M=lD.indexOf(a[f]||"normal")*.4+T*.6,N=2.5-A*.4,I=(Math.random()-.5)*2*N;let F=Math.round(M+I);u&&F<2&&f!==o&&Math.random()<.2&&(F+=1),F=Math.max(0,Math.min(4,F)),s[f]=lD[F]}),s}function vAe(a,e,n){const i={},s=new Set(n||[]);return e.forEach(r=>{const o=r.name,l=a[o]||{consecutivePlayed:0,weeksSincePlay:4};s.has(o)?i[o]={consecutivePlayed:l.consecutivePlayed+1,weeksSincePlay:0}:i[o]={consecutivePlayed:0,weeksSincePlay:l.weeksSincePlay+1}}),i}function _Ae(a){const e={};return Object.entries(a||{}).forEach(([n,i])=>{i.weeksLeft>1&&(e[n]={...i,weeksLeft:i.weeksLeft-1})}),e}function PG(a){const e={};return(a||[]).forEach(n=>{const i=Math.random();i<.1?e[n.name]="terrible":i<.28?e[n.name]="low":i<.63?e[n.name]="normal":i<.88?e[n.name]="good":e[n.name]="excellent"}),e}function IG(a,e=null){const n={};return a.forEach(i=>{const s=WJ(i,i.name===e),r=Math.random();s>=4?r<.05?n[i.name]="terrible":r<.12?n[i.name]="low":r<.45?n[i.name]="normal":r<.8?n[i.name]="good":n[i.name]="excellent":s>=3?r<.08?n[i.name]="terrible":r<.22?n[i.name]="low":r<.55?n[i.name]="normal":r<.82?n[i.name]="good":n[i.name]="excellent":r<.15?n[i.name]="terrible":r<.3?n[i.name]="low":r<.55?n[i.name]="normal":r<.78?n[i.name]="good":n[i.name]="excellent"}),n}function zh(a,e){const n=a.map(s=>({teamId:s.id,teamName:s.name,shortName:s.shortName,played:0,won:0,drawn:0,lost:0,goalsFor:0,goalsAgainst:0,goalDifference:0,points:0,form:[],homeForm:[],awayForm:[],isPlayer:s.id===e,streak:0,morale:70})),i=xAe(a);return{table:n,fixtures:i}}function xAe(a){const e=a.map(h=>h.id),n=e.length,i=[],s=[...e];n%2!==0&&s.push(null);const r=s.length,o=r-1,l=r/2,c=[];for(let h=0;h<o;h++){const f=[];for(let A=0;A<l;A++){const x=s[A],T=s[r-1-A];x&&T&&f.push({id:`${h+1}_${A}`,week:h+1,homeTeam:x,awayTeam:T,homeScore:null,awayScore:null,played:!1,events:[]})}c.push(f);const m=s.pop();s.splice(1,0,m)}return c.forEach(h=>i.push(...h)),c.map((h,f)=>h.map((m,A)=>({...m,id:`${o+f+1}_${A}`,week:o+f+1,homeTeam:m.awayTeam,awayTeam:m.homeTeam}))).forEach(h=>i.push(...h)),i}function jl(a,e,n,i,s={},r={},o=null){const l=n.id===o,c=i.id===o;l||PG(n.players||[]),c||PG(i.players||[]);const u={...s,playerTeamId:o};return uAe(a,e,n,i,u)}function V_(a,e,n,i,s){const r=a.map(o=>{if(o.teamId===e){const l=i>s?1:0,c=i===s?1:0,u=i<s?1:0,h=l*3+c,f=i>s?"W":i<s?"L":"D",m=[...o.form,f].slice(-5),A=[...o.homeForm||[],f].slice(-5);let x=o.streak||0,T=o.morale||70;return l?(x=x>=0?x+1:1,T=Math.min(100,T+5)):u?(x=x<=0?x-1:-1,T=Math.max(20,T-8)):(x=0,T=Math.max(40,Math.min(85,T-2))),{...o,played:o.played+1,won:o.won+l,drawn:o.drawn+c,lost:o.lost+u,goalsFor:o.goalsFor+i,goalsAgainst:o.goalsAgainst+s,goalDifference:o.goalDifference+i-s,points:o.points+h,form:m,homeForm:A,streak:x,morale:T}}if(o.teamId===n){const l=s>i?1:0,c=i===s?1:0,u=s<i?1:0,h=l*3+c,f=s>i?"W":s<i?"L":"D",m=[...o.form,f].slice(-5),A=[...o.awayForm||[],f].slice(-5);let x=o.streak||0,T=o.morale||70;return l?(x=x>=0?x+1:1,T=Math.min(100,T+7)):u?(x=x<=0?x-1:-1,T=Math.max(20,T-5)):(x=0,T=Math.max(40,Math.min(85,T))),{...o,played:o.played+1,won:o.won+l,drawn:o.drawn+c,lost:o.lost+u,goalsFor:o.goalsFor+s,goalsAgainst:o.goalsAgainst+i,goalDifference:o.goalDifference+s-i,points:o.points+h,form:m,awayForm:A,streak:x,morale:T}}return o});return z_(r)}function z_(a){return[...a].sort((e,n)=>n.points!==e.points?n.points-e.points:n.goalDifference!==e.goalDifference?n.goalDifference-e.goalDifference:n.goalsFor-e.goalsFor)}function W6(a,e,n,i,s){let r=[...e];return{fixtures:a.map(l=>{if(l.played||l.week!==n||l.homeTeam===i||l.awayTeam===i)return l;const c=s.find(A=>A.id===l.homeTeam),u=s.find(A=>A.id===l.awayTeam);if(!c||!u)return l;const h=r.find(A=>A.teamId===l.homeTeam),f=r.find(A=>A.teamId===l.awayTeam),m=jl(l.homeTeam,l.awayTeam,c,u,{homeMorale:h?.morale||70,awayMorale:f?.morale||70},{},null);return r=V_(r,l.homeTeam,l.awayTeam,m.homeScore,m.awayScore),{...l,played:!0,homeScore:m.homeScore,awayScore:m.awayScore,events:m.events,stats:m.stats}}),table:r}}function $J(a,e){const i=[2,3,4,5].map(u=>a[u]).filter(Boolean);if(i.length<4)return console.warn("No hay suficientes equipos para el playoff"),null;const s=u=>e.find(h=>h.id===u),r={...i[0],teamData:s(i[0].teamId),seed:3},o={...i[1],teamData:s(i[1].teamId),seed:4},l={...i[2],teamData:s(i[2].teamId),seed:5},c={...i[3],teamData:s(i[3].teamId),seed:6};return{semifinals:[{id:"semi1",label:"Semifinal 1",homeTeam:r,awayTeam:c,result:null,played:!1},{id:"semi2",label:"Semifinal 2",homeTeam:o,awayTeam:l,result:null,played:!1}],final:{id:"final",label:"Final de Ascenso",homeTeam:null,awayTeam:null,result:null,played:!1},winner:null,phase:"semifinals",teamIds:[r.teamId,o.teamId,l.teamId,c.teamId]}}function Qg(a,e){const n=a.teamData,i=e.teamData;if(!n||!i)return console.error("Missing team data for playoff match"),null;const s=jl(a.teamId,e.teamId,n,i,{homeMorale:a.morale||75,awayMorale:e.morale||75,importance:"playoff",attendanceFillRate:.95});let r=s.homeScore,o=s.awayScore,l=!1,c=null;s.homeScore===s.awayScore&&(l=!0,Math.random()<.3&&(Math.random()<.55?r++:o++),r===o&&(c=bAe(a,e)));const u=c?c.winnerId:r>o?a.teamId:e.teamId;return{homeScore:s.homeScore,awayScore:s.awayScore,finalHomeScore:r,finalAwayScore:o,extraTime:l,penalties:c,winnerId:u,winnerName:u===a.teamId?n.shortName||n.name:i.shortName||i.name,loserName:u===a.teamId?i.shortName||i.name:n.shortName||n.name,events:s.events||[],homeTeamName:n.shortName||n.name,awayTeamName:i.shortName||i.name}}function bAe(a,e){let n=0,i=0;const s=[];for(let l=0;l<5;l++){const c=Math.random()<.78,u=Math.random()<.75;c&&n++,u&&i++,s.push({home:c,away:u});const h=4-l;if(Math.abs(n-i)>h)break}let r=5;for(;n===i&&r<15;){const l=Math.random()<.7,c=Math.random()<.68;if(l&&n++,c&&i++,s.push({home:l,away:c}),r>=5&&l!==c)break;r++}const o=n>=i?a.teamId:e.teamId;return{homeGoals:n,awayGoals:i,rounds:s,winnerId:o}}function nS(a,e,n){const i=JSON.parse(JSON.stringify(a));if(e==="semi1"||e==="semi2"){const s=e==="semi1"?0:1;if(i.semifinals[s].result=n,i.semifinals[s].played=!0,i.semifinals[0].played&&i.semifinals[1].played){const r=i.semifinals[0].result.winnerId,o=i.semifinals[1].result.winnerId,l=i.semifinals[0].homeTeam,c=i.semifinals[0].awayTeam,u=i.semifinals[1].homeTeam,h=i.semifinals[1].awayTeam,f=r===l.teamId?l:c,m=o===u.teamId?u:h;i.final.homeTeam=f.seed<m.seed?f:m,i.final.awayTeam=f.seed<m.seed?m:f,i.phase="final"}}else e==="final"&&(i.final.result=n,i.final.played=!0,i.winner=n.winnerId,i.phase="completed");return i}function KJ(a,e){let n=$J(a,e);if(!n)return null;const i=Qg(n.semifinals[0].homeTeam,n.semifinals[0].awayTeam);n=nS(n,"semi1",i);const s=Qg(n.semifinals[1].homeTeam,n.semifinals[1].awayTeam);n=nS(n,"semi2",s);const r=Qg(n.final.homeTeam,n.final.awayTeam);return n=nS(n,"final",r),n}function LG(a,e){return e?e.phase==="semifinals"?e.semifinals.find(i=>!i.played&&(i.homeTeam.teamId===a||i.awayTeam.teamId===a)):e.phase==="final"&&!e.final.played&&(e.final.homeTeam?.teamId===a||e.final.awayTeam?.teamId===a)?e.final:null:null}function DG(a){if(!a.result)return"";const e=a.result;let n=`${e.homeTeamName} ${e.homeScore} - ${e.awayScore} ${e.awayTeamName}`;return e.extraTime&&!e.penalties&&(n+=` (Prrroga: ${e.finalHomeScore}-${e.finalAwayScore})`),e.penalties&&(n+=` (Penaltis: ${e.penalties.homeGoals}-${e.penalties.awayGoals})`),n+=`  Avanza: ${e.winnerName}`,n}function SAe(a,e,n){const s=[1,2,3,4].map(h=>a[h]).filter(Boolean);if(s.length<4)return console.warn(`No hay suficientes equipos para playoff en ${n}`),null;const r=h=>e.find(f=>f.id===h),o={...s[0],teamData:r(s[0].teamId),seed:2},l={...s[1],teamData:r(s[1].teamId),seed:3},c={...s[2],teamData:r(s[2].teamId),seed:4},u={...s[3],teamData:r(s[3].teamId),seed:5};return{groupId:n,semifinals:[{id:`${n}_semi1`,label:`Semifinal 1 (${n})`,homeTeam:o,awayTeam:u,result:null,played:!1},{id:`${n}_semi2`,label:`Semifinal 2 (${n})`,homeTeam:l,awayTeam:c,result:null,played:!1}],final:{id:`${n}_final`,label:`Final de Ascenso (${n})`,homeTeam:null,awayTeam:null,result:null,played:!1},winner:null,phase:"semifinals",teamIds:[o.teamId,l.teamId,c.teamId,u.teamId]}}function $6(a,e,n=null){const i={};let s=null;return a?.groups?(Object.entries(a.groups).forEach(([r,o])=>{const l=o.table||[];if(l.length<5)return;const c=SAe(l,e,r);c&&(i[r]=c,n&&c.teamIds.includes(n)&&(s=r))}),{brackets:i,playerGroupId:s}):{brackets:i,playerGroupId:s}}function TAe(a){if(!a)return null;const e=Qg(a.semifinals[0].homeTeam,a.semifinals[0].awayTeam);a=aS(a,a.semifinals[0].id,e);const n=Qg(a.semifinals[1].homeTeam,a.semifinals[1].awayTeam);if(a=aS(a,a.semifinals[1].id,n),a.final.homeTeam&&a.final.awayTeam){const i=Qg(a.final.homeTeam,a.final.awayTeam);a=aS(a,a.final.id,i)}return a}function aS(a,e,n){const i=JSON.parse(JSON.stringify(a)),s=e===i.semifinals[0].id,r=e===i.semifinals[1].id,o=e===i.final.id;if(s||r){const l=s?0:1;if(i.semifinals[l].result=n,i.semifinals[l].played=!0,i.semifinals[0].played&&i.semifinals[1].played){const c=i.semifinals[0].result.winnerId,u=i.semifinals[1].result.winnerId,h=i.semifinals[0].homeTeam,f=i.semifinals[0].awayTeam,m=i.semifinals[1].homeTeam,A=i.semifinals[1].awayTeam,x=c===h.teamId?h:f,T=u===m.teamId?m:A;i.final.homeTeam=x.seed<T.seed?x:T,i.final.awayTeam=x.seed<T.seed?T:x,i.phase="final"}}else o&&(i.final.result=n,i.final.played=!0,i.winner=n.winnerId,i.phase="completed");return i}function U3(a,e=null){const n={};let i=null;return Object.entries(a).forEach(([s,r])=>{if(!r)return;e&&r.teamIds.includes(e)?(i=r,n[s]=r):n[s]=TAe(r)}),{brackets:n,playerBracket:i}}function kG(a){const e=[];return Object.values(a).forEach(n=>{n?.winner&&e.push(n.winner)}),e}function L2(a,e=null){const n={};let i=null;return Object.entries(a).forEach(([s,r])=>{if(!r||r.length===0){n[s]={table:[],fixtures:[]};return}const o=e&&r.some(u=>u.id===e);o&&(i=s);const{table:l,fixtures:c}=zh(r,o?e:null);n[s]={table:l,fixtures:c}}),{groups:n,playerGroup:i}}function wAe(a,e,n){const i={};return Object.entries(a.groups).forEach(([s,r])=>{if(!r.fixtures||r.fixtures.length===0){i[s]=r;return}const o=n[s];if(!o||o.length===0){i[s]=r;return}let l=[...r.table];const c=r.fixtures.map(u=>{if(u.week!==e||u.played)return u;const h=o.find(T=>T.id===u.homeTeam),f=o.find(T=>T.id===u.awayTeam);if(!h||!f)return u;const m=l.find(T=>T.teamId===u.homeTeam),A=l.find(T=>T.teamId===u.awayTeam),x=jl(u.homeTeam,u.awayTeam,h,f,{homeMorale:m?.morale||70,awayMorale:A?.morale||70});return l=V_(l,u.homeTeam,u.awayTeam,x.homeScore,x.awayScore),{...u,played:!0,homeScore:x.homeScore,awayScore:x.awayScore,events:x.events,stats:x.stats}});i[s]={table:l,fixtures:c}}),{...a,groups:i}}function OG(a,e=1){const n=[];return a?.groups&&Object.entries(a.groups).forEach(([i,s])=>{const r=s.table||[];for(let o=0;o<e&&o<r.length;o++)n.push({teamId:r[o].teamId,teamName:r[o].teamName,groupId:i,position:o+1})}),n}function EAe(a,e=1){const n=[];return a?.groups&&Object.entries(a.groups).forEach(([i,s])=>{const r=s.table||[],o=r.length;for(let l=0;l<e&&l<o;l++){const c=o-1-l;n.push({teamId:r[c].teamId,teamName:r[c].teamName,groupId:i,position:c+1})}}),n}function FG(a,e){const n={},i=Math.ceil(a.length/e),s=[...a].sort(()=>Math.random()-.5);for(let r=0;r<e;r++){const o=`grupo${r+1}`,l=r*i,c=Math.min(l+i,s.length);n[o]=s.slice(l,c)}return n}const YJ="teams_v2",XJ="leagues_v2",Sr={teams:new Map,leagues:new Map,timestamp:null,TTL:300*1e3};function QJ(){return Sr.timestamp&&Date.now()-Sr.timestamp<Sr.TTL}async function bF(){if(QJ()&&Sr.leagues.size>0)return Array.from(Sr.leagues.values());const a=await ff(du(Kn,XJ)),e=[];return a.forEach(n=>{const i={id:n.id,...n.data()};Sr.leagues.set(n.id,i),e.push(i)}),Sr.timestamp=Date.now(),e}async function MAe(a){if(Sr.leagues.has(a))return Sr.leagues.get(a);const e=Ra(Kn,XJ,a),n=await go(e);if(n.exists()){const i={id:n.id,...n.data()};return Sr.leagues.set(a,i),i}return null}async function kS(a){const e=`league_${a}`;if(QJ()&&Sr.teams.has(e))return Sr.teams.get(e);const n=hf(du(Kn,YJ),u0("league","==",a)),i=await ff(n),s=[];return i.forEach(r=>{s.push({id:r.id,...r.data()})}),s.sort((r,o)=>(o.avgOverall||0)-(r.avgOverall||0)),Sr.teams.set(e,s),Sr.timestamp=Date.now(),s}async function JJ(a){if(Sr.teams.has(a))return Sr.teams.get(a);const e=Ra(Kn,YJ,a),n=await go(e);if(n.exists()){const i={id:n.id,...n.data()};return Sr.teams.set(a,i),i}return null}async function CAe(a,e=null){let n;if(e)n=await kS(e);else{const s=await bF();n=(await Promise.all(s.map(o=>kS(o.id)))).flat()}const i=a.toLowerCase();return n.filter(s=>s.name.toLowerCase().includes(i)||s.city?.toLowerCase().includes(i)||s.shortName?.toLowerCase().includes(i))}async function NAe(a){return(await JJ(a))?.players||[]}async function RAe(a,e={}){const{league:n,position:i,minOverall:s,maxOverall:r,maxAge:o}=e;let l;if(n)l=await kS(n);else{const h=await bF();l=(await Promise.all(h.map(m=>kS(m.id)))).flat()}const c=a?.toLowerCase()||"",u=[];for(const h of l)for(const f of h.players||[])c&&!f.name.toLowerCase().includes(c)||i&&f.position!==i||s&&f.overall<s||r&&f.overall>r||o&&f.age>o||u.push({...f,teamId:h.id,teamName:h.name,league:h.league});return u.sort((h,f)=>f.overall-h.overall)}function PAe(){Sr.teams.clear(),Sr.leagues.clear(),Sr.timestamp=null}async function IAe(){const a=Ra(Kn,"metadata","stats_v2"),e=await go(a);return e.exists()?e.data():null}const ei={getLeagues:bF,getLeague:MAe,getTeamsByLeague:kS,getTeam:JJ,searchTeams:CAe,getPlayersByTeam:NAe,searchPlayers:RAe,clearCache:PAe,getStats:IAe},LAe={"real-madrid":{name:"Crown Arena",capacity:8e4},barcelona:{name:"Grand Coliseum",capacity:1e5},"atletico-madrid":{name:"Titan Arena",capacity:7e4},sevilla:{name:"Crimson Grounds",capacity:43e3},"real-betis":{name:"Estadio Solar",capacity:6e4},"real-sociedad":{name:"Silver Dome",capacity:4e4},"athletic-club":{name:"Coliseo del Norte",capacity:53e3},villarreal:{name:"Hawk Stadium",capacity:23e3},valencia:{name:"Tidal Stadium",capacity:5e4},getafe:{name:"Arena Imperial Estrella",capacity:17e3},osasuna:{name:"Complejo Cruz",capacity:24e3},celta:{name:"Arena El Valle",capacity:29e3},mallorca:{name:"Recinto Cruz",capacity:23e3},"las-palmas":{name:"Complejo Real",capacity:32e3},"rayo-vallecano":{name:"Recinto Real",capacity:15e3},alaves:{name:"Estadio Municipal Cruz",capacity:2e4},girona:{name:"Arena Central",capacity:15e3},espanyol:{name:"Arena Gran Roble",capacity:4e4},leganes:{name:"Arena Norte Costa",capacity:12e3},valladolid:{name:"Recinto Alameda",capacity:27e3},"racing-santander":{name:"Recinto Roca",capacity:22e3},deportivo:{name:"Estadio Municipal Sur",capacity:32e3},"sporting-gijon":{name:"Arena Gran Cruz",capacity:3e4},zaragoza:{name:"Stadium Cruz",capacity:34e3},oviedo:{name:"Stadium Piedra",capacity:3e4},malaga:{name:"Estadio Estrella",capacity:3e4},levante:{name:"Arena Real Fuente",capacity:26e3},granada:{name:"Arena Alto Olivo",capacity:22e3},eibar:{name:"Estadio El Sol",capacity:8e3},huesca:{name:"Arena Alto Llano",capacity:9e3},albacete:{name:"Recinto El Valle",capacity:17e3},elche:{name:"Recinto Viejo",capacity:33e3},cadiz:{name:"Campo El Costa",capacity:22e3},almeria:{name:"Arena Alto Cumbre",capacity:17e3},tenerife:{name:"Arena El Baha",capacity:22e3},cartagena:{name:"Arena Dorado Alameda",capacity:15e3},burgos:{name:"Recinto Baha",capacity:12e3},castellon:{name:"Arena El Olivo",capacity:15e3},eldense:{name:"Campo Torre",capacity:6e3},ferrol:{name:"Arena Gran Roca",capacity:13e3},mirandes:{name:"Recinto Alto",capacity:6e3},cordoba:{name:"Arena El Meseta",capacity:22e3},recreativo:{name:"Estadio Municipal Real",capacity:21e3},murcia:{name:"Estadio Real",capacity:31e3},unionistas:{name:"Arena Alto Puente",capacity:6e3},merida:{name:"Estadio Arco",capacity:14e3},antequera:{name:"Arena Dorado Puente",capacity:6e3},"atletico-baleares":{name:"Arena Alto Monte",capacity:7e3},"celta-b":{name:"Stadium Nuevo",capacity:5e3},"deportivo-b":{name:"Complejo Fuente",capacity:5e3},"real-sociedad-b":{name:"Stadium Costa",capacity:4e3},"athletic-club-b":{name:"Estadio El Estrella",capacity:3e3},"barcelona-b":{name:"Complejo Alto",capacity:6e3},"real-madrid-castilla":{name:"Arena El Bosque",capacity:6e3},"villarreal-b":{name:"Recinto Nuevo",capacity:5e3},"betis-deportivo":{name:"Estadio Municipal Meseta",capacity:4e3},"sevilla-atletico":{name:"Stadium Roble",capacity:8e3},talavera:{name:"Estadio Municipal Central",capacity:7e3},badajoz:{name:"Estadio Puente",capacity:13e3},xerez:{name:"Estadio Municipal Viejo",capacity:2e4},linares:{name:"Arena Alto",capacity:1e4},intercity:{name:"Recinto El Colina",capacity:5e3},hercules:{name:"Campo Dorado",capacity:3e4},ponferradina:{name:"Arena El Prado",capacity:9e3},aviles:{name:"Estadio Viejo",capacity:6e3},tudelano:{name:"Arena El Ro",capacity:4e3},"manchester-city":{name:"Nova Stadium",capacity:54e3},arsenal:{name:"Cannon Park",capacity:6e4},liverpool:{name:"Scarlet Field",capacity:61e3},"manchester-united":{name:"Fortress Ground",capacity:75e3},chelsea:{name:"Bridge Arena",capacity:42e3},tottenham:{name:"Whitecrest Arena",capacity:63e3},newcastle:{name:"St. James' Park",capacity:52e3},"aston-villa":{name:"Claret Park",capacity:43e3},brighton:{name:"Arena El Cedro",capacity:32e3},"west-ham":{name:"Arena Nuevo Torre",capacity:62e3},everton:{name:"Estadio Torre",capacity:4e4},"crystal-palace":{name:"Recinto Estrella",capacity:26e3},fulham:{name:"Complejo El Cedro",capacity:25e3},brentford:{name:"Estadio Municipal Norte",capacity:17e3},"nottingham-forest":{name:"Campo Bosque",capacity:3e4},bournemouth:{name:"Arena Gran Fuente",capacity:11e3},wolves:{name:"Arena Sur Cumbre",capacity:32e3},leicester:{name:"Arena Dorado Colina",capacity:32e3},ipswich:{name:"Stadium Norte",capacity:3e4},southampton:{name:"St. Mary's Stadium",capacity:32e3},inter:{name:"Twin Towers Stadium",capacity:75e3},milan:{name:"Twin Towers Stadium",capacity:75e3},juventus:{name:"Zebra Arena",capacity:41e3},napoli:{name:"Vesuvio Stadium",capacity:55e3},roma:{name:"Gladiator Stadium",capacity:73e3},lazio:{name:"Gladiator Stadium",capacity:73e3},atalanta:{name:"Arena Dorado Olivo",capacity:24e3},fiorentina:{name:"Complejo Monte",capacity:43e3},bologna:{name:"Campo El Lago",capacity:39e3},torino:{name:"Recinto Roble",capacity:28e3},"bayern-munich":{name:"Lions Den Arena",capacity:75e3},"borussia-dortmund":{name:"Signal Wall Stadium",capacity:81e3},"rb-leipzig":{name:"Arena Dorado Prado",capacity:47e3},"bayer-leverkusen":{name:"Campo Central",capacity:3e4},"eintracht-frankfurt":{name:"Estadio Municipal Alto",capacity:51e3},wolfsburg:{name:"Estadio Lago",capacity:3e4},"borussia-mgladbach":{name:"Campo Viejo",capacity:54e3},freiburg:{name:"Arena Imperial Torre",capacity:35e3},hoffenheim:{name:"Complejo El Cruz",capacity:3e4},mainz:{name:"Arena Sur Estrella",capacity:33e3},psg:{name:"toile Park",capacity:48e3},marseille:{name:"Phocen Arena",capacity:67e3},lyon:{name:"Stadium Central",capacity:59e3},monaco:{name:"Campo Sur",capacity:18e3},lille:{name:"Estadio El Viento",capacity:5e4},nice:{name:"Arena Central Estrella",capacity:36e3},lens:{name:"Arena Central Puente",capacity:38e3},rennes:{name:"Stadium Viejo",capacity:3e4},strasbourg:{name:"Campo El Cruz",capacity:26e3},nantes:{name:"Arena Norte Puente",capacity:37e3},"club-atletico-river-plate":{name:"Grand Monumental",capacity:84567},"club-atletico-boca-juniors":{name:"El Caldero",capacity:54e3},"racing-club":{name:"Complejo El Monte",capacity:51389},"club-atletico-independiente":{name:"Estadio Sur",capacity:48069},"club-atletico-san-lorenzo-de-almagro":{name:"Arena El Llano",capacity:48e3},"club-atletico-velez-sarsfield":{name:"Estadio Dorado",capacity:49540},"club-atletico-huracan":{name:"Campo Cedro",capacity:48314},"club-estudiantes-de-la-plata":{name:"Arena El Piedra",capacity:30018},"club-atletico-rosario-central":{name:"Arena Alto Costa",capacity:41654},"club-atletico-newells-old-boys":{name:"Complejo Gran",capacity:42e3},"club-atletico-talleres":{name:"Complejo El Valle",capacity:57e3},"club-atletico-lanus":{name:"Arena Nuevo Lago",capacity:47027},"ca-belgrano":{name:"Recinto Imperial",capacity:34e3},"argentinos-juniors":{name:"Vesuvio Stadium",capacity:26e3},"defensa-y-justicia":{name:"Recinto Sur",capacity:18e3},"club-atletico-tigre":{name:"Estadio El Meseta",capacity:26282},"club-atletico-platense":{name:"Campo Real",capacity:28e3},"club-atletico-union":{name:"Arena Nuevo Roca",capacity:27e3},"club-de-gimnasia-y-esgrima-la-plata":{name:"Complejo Estrella",capacity:33e3},"club-atletico-banfield":{name:"Stadium Viento",capacity:34901},"club-atletico-tucuman":{name:"Complejo Ro",capacity:35200},"instituto-ac-cordoba":{name:"Stadium Imperial",capacity:3e4},"independiente-rivadavia":{name:"Arena Viejo Cumbre",capacity:25e3},"club-atletico-barracas-central":{name:"Stadium Dorado",capacity:18e3},"gimnasia-y-esgrima-de-mendoza":{name:"Complejo El Estrella",capacity:2e4},"club-atletico-sarmiento-junin-":{name:"Complejo Costa",capacity:25e3},"cd-riestra":{name:"Arena Puente",capacity:1e4},"club-atletico-aldosivi":{name:"Arena Alto Ro",capacity:35354},"aa-estudiantes-de-rio-cuarto":{name:"Arena Real",capacity:14e3},"club-atletico-central-cordoba-sde-":{name:"Stadium El Luna",capacity:3e4},"flamengo-rio-de-janeiro":{name:"Grande Arena",capacity:78838},"se-palmeiras-sao-paulo":{name:"Arena Real Sol",capacity:44e3},"corinthians-sao-paulo":{name:"Complejo El Prado",capacity:49205},"fc-sao-paulo":{name:"Recinto Dorado",capacity:66795},"vasco-da-gama-rio-de-janeiro":{name:"Complejo El Meseta",capacity:21880},"fluminense-rio-de-janeiro":{name:"Grande Arena",capacity:78838},"botafogo-rio-de-janeiro":{name:"Recinto Colina",capacity:46931},"clube-atletico-mineiro":{name:"Complejo Alameda",capacity:46e3},"gremio-porto-alegre":{name:"Recinto El Cedro",capacity:60540},"sc-internacional-porto-alegre":{name:"Campo El Baha",capacity:50128},"ec-cruzeiro-belo-horizonte":{name:"Estadio Municipal El Baha",capacity:61846},"esporte-clube-bahia":{name:"Estadio Gran",capacity:50025},"fc-santos":{name:"Recinto El Fuente",capacity:16068},"club-athletico-paranaense":{name:"Complejo El Arco",capacity:42372},"red-bull-bragantino":{name:"Estadio Municipal Imperial",capacity:17728},"esporte-clube-vitoria":{name:"Complejo El Llano",capacity:36e3},"coritiba-fc":{name:"Estadio Municipal El Torre",capacity:40502},chapecoense:{name:"Campo Roble",capacity:22600},"clube-do-remo-pa-":{name:"Campo Piedra",capacity:16200},"mirassol-futebol-clube-sp-":{name:"Estadio Municipal Viento",capacity:15e3},"atletico-nacional":{name:"Campo Ro",capacity:45943},"millonarios-fc":{name:"Arena Gran Valle",capacity:36343},"cd-america-de-cali":{name:"Arena Nuevo Sierra",capacity:36e3},"junior-fc":{name:"Stadium El Cruz",capacity:5e4},"independiente-medellin":{name:"Complejo Torre",capacity:45943},"independiente-santa-fe":{name:"Arena Imperial Arco",capacity:36343},"deportivo-cali":{name:"Estadio El Alameda",capacity:6e4},"deportes-tolima":{name:"Arena El Torre",capacity:27e3},"once-caldas":{name:"Arena Gran Arco",capacity:31e3},"atletico-bucaramanga":{name:"Arena Estrella",capacity:28e3},"club-universidad-de-chile":{name:"Stadium El Baha",capacity:48665},"csd-colo-colo":{name:"Estadio Municipal Gran",capacity:47e3},"cd-universidad-catolica":{name:"Campo Imperial",capacity:15e3},"cd-ohiggins":{name:"Arena Viejo Estrella",capacity:14e3},"coquimbo-unido":{name:"Estadio El Arco",capacity:18750},"ca-penarol":{name:"Campo El Fuente",capacity:4e4},"club-nacional":{name:"Estadio Bosque",capacity:34e3},"defensor-sc":{name:"Arena Imperial",capacity:18e3},"liverpool-fc-montevideo":{name:"Estadio El Torre",capacity:12e3},"ca-boston-river":{name:"Complejo Dorado",capacity:1e4},"independiente-del-valle":{name:"Arena Sur Pradera",capacity:12e3},"barcelona-sc-guayaquil":{name:"Stadium Sierra",capacity:59283},"ldu-quito":{name:"Stadium El Costa",capacity:41575},"cd-universidad-catolica":{name:"Estadio El Puente",capacity:35258},"orense-sc":{name:"Arena Norte Sierra",capacity:18e3},"club-cerro-porteno":{name:"Arena Viejo Lago",capacity:45e3},"olimpia-asuncion":{name:"Estadio Municipal El Prado",capacity:25e3},"club-libertad-asuncion":{name:"Estadio Municipal Sierra",capacity:12e3},"club-guarani":{name:"Campo Monte",capacity:12e3},"club-nacional-asuncion":{name:"Campo Gran",capacity:15e3},"club-alianza-lima":{name:"Recinto Meseta",capacity:35e3},"universitario-de-deportes":{name:"Grand Monumental",capacity:80093},"club-sporting-cristal":{name:"Estadio Luna",capacity:18e3},"fbc-melgar":{name:"Stadium El Sol",capacity:45e3},"cusco-fc":{name:"Arena Alto Bosque",capacity:42056},"bolivar-la-paz":{name:"Complejo Pradera",capacity:42e3},"the-strongest-la-paz":{name:"Arena Imperial Pradera",capacity:42e3},"club-always-ready":{name:"Arena Dorado Ro",capacity:25e3},"blooming-santa-cruz":{name:"Estadio Municipal El Llano",capacity:38e3},"club-deportivo-guabira":{name:"Arena Central Ro",capacity:18e3},"deportivo-tachira":{name:"Estadio Monte",capacity:38755},"caracas-fc":{name:"Arena Dorado Meseta",capacity:25354},"deportivo-la-guaira":{name:"Recinto El Olivo",capacity:25354},"carabobo-fc":{name:"Campo Luna",capacity:15e3},"academia-puerto-cabello":{name:"Arena Central Alameda",capacity:1e4}};function DT(a,e=50){const n=LAe[a];return n||(e>=90?{name:"Estadio Nuevo",capacity:8e4}:e>=75?{name:"Campo Baha",capacity:55e3}:e>=60?{name:"Campo El Estrella",capacity:35e3}:e>=45?{name:"Arena Nuevo Estrella",capacity:18e3}:{name:"Complejo Norte",capacity:8e3})}function dP(a){return a>=7e4?4:a>=45e3?3:a>=25e3?2:a>=12e3?1:0}const Ba={1:{name:"Elite",multiplier:1},2:{name:"Major",multiplier:.5},3:{name:"Standard",multiplier:.22},4:{name:"Lower",multiplier:.08},5:{name:"Amateur",multiplier:.03}},SF={laliga:{tier:1,...Ba[1]},premierLeague:{tier:1,...Ba[1]},serieA:{tier:1,...Ba[1]},bundesliga:{tier:1,...Ba[1]},ligue1:{tier:1,...Ba[1]},segunda:{tier:2,...Ba[2]},championship:{tier:2,...Ba[2]},serieB:{tier:2,...Ba[2]},bundesliga2:{tier:2,...Ba[2]},ligue2:{tier:2,...Ba[2]},eredivisie:{tier:3,...Ba[3]},primeiraLiga:{tier:3,...Ba[3]},belgianPro:{tier:3,...Ba[3]},superLig:{tier:3,...Ba[3]},scottishPrem:{tier:3,...Ba[3]},swissSuperLeague:{tier:3,...Ba[3]},austrianBundesliga:{tier:3,...Ba[3]},greekSuperLeague:{tier:3,...Ba[3]},danishSuperliga:{tier:3,...Ba[3]},croatianLeague:{tier:3,...Ba[3]},czechLeague:{tier:3,...Ba[3]},argentinaPrimera:{tier:2,...Ba[2],salaryMult:.18},brasileiraoA:{tier:2,...Ba[2],salaryMult:.22},colombiaPrimera:{tier:3,...Ba[3],salaryMult:.07},chilePrimera:{tier:3,...Ba[3],salaryMult:.07},uruguayPrimera:{tier:3,...Ba[3],salaryMult:.07},ecuadorLigaPro:{tier:3,...Ba[3],salaryMult:.07},primeraRFEF:{tier:4,...Ba[4]},paraguayPrimera:{tier:4,...Ba[4],salaryMult:.025},peruLiga1:{tier:4,...Ba[4],salaryMult:.025},boliviaPrimera:{tier:4,...Ba[4],salaryMult:.025},venezuelaPrimera:{tier:4,...Ba[4],salaryMult:.025},saudiPro:{tier:2,...Ba[2],salaryMult:.25},ligaMX:{tier:2,...Ba[2],salaryMult:.06},mls:{tier:3,...Ba[3],salaryMult:.08},jLeague:{tier:3,...Ba[3],salaryMult:.04},segundaRFEF:{tier:5,...Ba[5]}},DAe={laliga:1,segunda:2,primeraRFEF:3,segundaRFEF:4,premierLeague:1,championship:2,serieA:1,serieB:2,bundesliga:1,bundesliga2:2,ligue1:1,ligue2:2,eredivisie:1,primeiraLiga:1,belgianPro:1,superLig:1,scottishPrem:1,swissSuperLeague:1,austrianBundesliga:1,greekSuperLeague:1,danishSuperliga:1,croatianLeague:1,czechLeague:1,argentinaPrimera:1,brasileiraoA:1,colombiaPrimera:1,chilePrimera:1,uruguayPrimera:1,ecuadorLigaPro:1,paraguayPrimera:1,peruLiga1:1,boliviaPrimera:1,venezuelaPrimera:1};function kAe(a){return DAe[a]??1}function Pl(a){return SF[a]?.tier??3}function OAe(a){return SF[a]?.multiplier??Ba[3].multiplier}function FAe(a){const e=SF[a];return e?e.salaryMult??e.multiplier:Ba[3].multiplier}function TF(a){const e=Pl(a),n={1:1,2:.55,3:.3,4:.12,5:.06};return n[e]??n[3]}function ZJ(a){const e=Pl(a),n={1:1,2:.55,3:.28,4:.1,5:.04};return n[e]??n[3]}const jAe={laliga:"Liga Ibrica",segunda:"Segunda Ibrica",primeraRFEF:"Primera RFEF",segundaRFEF:"Segunda RFEF",premierLeague:"First League",championship:"Second League",serieA:"Calcio League",serieB:"Calcio B",bundesliga:"Erste Liga",bundesliga2:"Zweite Liga",ligue1:"Division Premire",ligue2:"Division Seconde",eredivisie:"Dutch First",primeiraLiga:"Liga Lusitana",belgianPro:"Belgian First",superLig:"Anatolian League",scottishPrem:"Highland League",swissSuperLeague:"Alpine League",austrianBundesliga:"Erste Liga (AT)",greekSuperLeague:"Super League (GR)",danishSuperliga:"Superligaen",croatianLeague:"HNL",czechLeague:"Fortuna Liga",argentinaPrimera:"Liga Profesional",brasileiraoA:"Brasileiro",colombiaPrimera:"Liga BetPlay",chilePrimera:"Primera Divisin (CL)",uruguayPrimera:"Primera Divisin (UY)",ecuadorLigaPro:"LigaPro",paraguayPrimera:"Primera Divisin (PY)",peruLiga1:"Liga 1",boliviaPrimera:"Divisin Profesional",venezuelaPrimera:"Liga FUTVE",mls:"American League",saudiProLeague:"Arabian League",ligaMX:"Azteca League",jLeague:"Sakura League"};function BAe(a){return jAe[a]||a||"Liga"}const UAe={"club-atletico-river-plate":{city:"Buenos Aires",shortName:"RIV",colors:{primary:"#FFFFFF",secondary:"#D2042D",accent:"#D2042D"}},"club-atletico-boca-juniors":{city:"Buenos Aires",shortName:"BOC",colors:{primary:"#003DA5",secondary:"#FFD700",accent:"#003DA5"}},"racing-club":{city:"Avellaneda",shortName:"RAC",colors:{primary:"#6CACE4",secondary:"#FFFFFF",accent:"#6CACE4"}},"club-atletico-independiente":{city:"Avellaneda",shortName:"IND",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"club-atletico-san-lorenzo-de-almagro":{city:"Buenos Aires",shortName:"SLO",colors:{primary:"#D2042D",secondary:"#00205B",accent:"#D2042D"}},"club-atletico-velez-sarsfield":{city:"Buenos Aires",shortName:"VEL",colors:{primary:"#FFFFFF",secondary:"#002F6C",accent:"#002F6C"}},"club-atletico-huracan":{city:"Buenos Aires",shortName:"HUR",colors:{primary:"#FFFFFF",secondary:"#D2042D",accent:"#002F6C"}},"club-estudiantes-de-la-plata":{city:"La Plata",shortName:"EDL",colors:{primary:"#FFFFFF",secondary:"#D2042D",accent:"#D2042D"}},"club-atletico-rosario-central":{city:"Rosario",shortName:"ROC",colors:{primary:"#003DA5",secondary:"#FFD700",accent:"#003DA5"}},"club-atletico-newells-old-boys":{city:"Rosario",shortName:"NOB",colors:{primary:"#D2042D",secondary:"#000000",accent:"#D2042D"}},"club-atletico-talleres":{city:"Crdoba",shortName:"TAL",colors:{primary:"#002F6C",secondary:"#FFFFFF",accent:"#002F6C"}},"club-atletico-lanus":{city:"Lans",shortName:"LAN",colors:{primary:"#800020",secondary:"#FFFFFF",accent:"#800020"}},"ca-belgrano":{city:"Crdoba",shortName:"BEL",colors:{primary:"#6CACE4",secondary:"#FFFFFF",accent:"#6CACE4"}},"argentinos-juniors":{city:"Buenos Aires",shortName:"ARJ",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"defensa-y-justicia":{city:"Florencio Varela",shortName:"DYJ",colors:{primary:"#FFD700",secondary:"#228B22",accent:"#228B22"}},"club-atletico-tigre":{city:"Victoria",shortName:"TIG",colors:{primary:"#003DA5",secondary:"#D2042D",accent:"#003DA5"}},"club-atletico-platense":{city:"Buenos Aires",shortName:"PLA",colors:{primary:"#8B4513",secondary:"#FFFFFF",accent:"#8B4513"}},"club-atletico-union":{city:"Santa Fe",shortName:"UNI",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"club-de-gimnasia-y-esgrima-la-plata":{city:"La Plata",shortName:"GLP",colors:{primary:"#002F6C",secondary:"#FFFFFF",accent:"#002F6C"}},"club-atletico-banfield":{city:"Banfield",shortName:"BAN",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"club-atletico-tucuman":{city:"Tucumn",shortName:"ATU",colors:{primary:"#6CACE4",secondary:"#FFFFFF",accent:"#6CACE4"}},"instituto-ac-cordoba":{city:"Crdoba",shortName:"INS",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"independiente-rivadavia":{city:"Mendoza",shortName:"IRV",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"club-atletico-barracas-central":{city:"Buenos Aires",shortName:"BAR",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#000000"}},"gimnasia-y-esgrima-de-mendoza":{city:"Mendoza",shortName:"GEM",colors:{primary:"#FFFFFF",secondary:"#000000",accent:"#FFD700"}},"club-atletico-sarmiento-junin-":{city:"Junn",shortName:"SAR",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"cd-riestra":{city:"Buenos Aires",shortName:"RIE",colors:{primary:"#D2042D",secondary:"#000000",accent:"#FFFFFF"}},"club-atletico-aldosivi":{city:"Mar del Plata",shortName:"ALD",colors:{primary:"#006B3F",secondary:"#FFD700",accent:"#006B3F"}},"aa-estudiantes-de-rio-cuarto":{city:"Ro Cuarto",shortName:"ERC",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"club-atletico-central-cordoba-sde-":{city:"Santiago del Estero",shortName:"CCS",colors:{primary:"#000000",secondary:"#FFD700",accent:"#000000"}},"flamengo-rio-de-janeiro":{city:"Ro de Janeiro",shortName:"FLA",colors:{primary:"#D2042D",secondary:"#000000",accent:"#D2042D"}},"se-palmeiras-sao-paulo":{city:"So Paulo",shortName:"PAL",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"corinthians-sao-paulo":{city:"So Paulo",shortName:"COR",colors:{primary:"#000000",secondary:"#FFFFFF",accent:"#000000"}},"fc-sao-paulo":{city:"So Paulo",shortName:"SAO",colors:{primary:"#FFFFFF",secondary:"#D2042D",accent:"#000000"}},"vasco-da-gama-rio-de-janeiro":{city:"Ro de Janeiro",shortName:"VAS",colors:{primary:"#000000",secondary:"#FFFFFF",accent:"#D2042D"}},"fluminense-rio-de-janeiro":{city:"Ro de Janeiro",shortName:"FLU",colors:{primary:"#800020",secondary:"#006B3F",accent:"#FFFFFF"}},"botafogo-rio-de-janeiro":{city:"Ro de Janeiro",shortName:"BOT",colors:{primary:"#000000",secondary:"#FFFFFF",accent:"#000000"}},"clube-atletico-mineiro":{city:"Belo Horizonte",shortName:"CAM",colors:{primary:"#000000",secondary:"#FFFFFF",accent:"#000000"}},"gremio-porto-alegre":{city:"Porto Alegre",shortName:"GRE",colors:{primary:"#003DA5",secondary:"#000000",accent:"#FFFFFF"}},"sc-internacional-porto-alegre":{city:"Porto Alegre",shortName:"INT",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"ec-cruzeiro-belo-horizonte":{city:"Belo Horizonte",shortName:"CRU",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"esporte-clube-bahia":{city:"Salvador",shortName:"BAH",colors:{primary:"#003DA5",secondary:"#D2042D",accent:"#FFFFFF"}},"fc-santos":{city:"Santos",shortName:"SAN",colors:{primary:"#FFFFFF",secondary:"#000000",accent:"#FFFFFF"}},"club-athletico-paranaense":{city:"Curitiba",shortName:"CAP",colors:{primary:"#D2042D",secondary:"#000000",accent:"#D2042D"}},"red-bull-bragantino":{city:"Bragana Paulista",shortName:"BRA",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"esporte-clube-vitoria":{city:"Salvador",shortName:"VIT",colors:{primary:"#D2042D",secondary:"#000000",accent:"#D2042D"}},"coritiba-fc":{city:"Curitiba",shortName:"CFC",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},chapecoense:{city:"Chapec",shortName:"CHA",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"clube-do-remo-pa-":{city:"Belm",shortName:"REM",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"mirassol-futebol-clube-sp-":{city:"Mirassol",shortName:"MIR",colors:{primary:"#FFD700",secondary:"#006B3F",accent:"#000000"}},"atletico-nacional":{city:"Medelln",shortName:"NAL",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"millonarios-fc":{city:"Bogot",shortName:"MIL",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"cd-america-de-cali":{city:"Cali",shortName:"AME",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"junior-fc":{city:"Barranquilla",shortName:"JUN",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#003DA5"}},"independiente-medellin":{city:"Medelln",shortName:"DIM",colors:{primary:"#D2042D",secondary:"#003DA5",accent:"#D2042D"}},"independiente-santa-fe":{city:"Bogot",shortName:"ISF",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"deportivo-cali":{city:"Cali",shortName:"DCA",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"deportes-tolima":{city:"Ibagu",shortName:"TOL",colors:{primary:"#800020",secondary:"#FFD700",accent:"#800020"}},"once-caldas":{city:"Manizales",shortName:"ONC",colors:{primary:"#FFFFFF",secondary:"#006B3F",accent:"#006B3F"}},"atletico-bucaramanga":{city:"Bucaramanga",shortName:"BUC",colors:{primary:"#FFD700",secondary:"#006B3F",accent:"#FFD700"}},"rionegro-aguilas":{city:"Rionegro",shortName:"RIO",colors:{primary:"#FFD700",secondary:"#000000",accent:"#FFD700"}},"cd-la-equidad-seguros-sa":{city:"Bogot",shortName:"EQU",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"deportivo-pereira":{city:"Pereira",shortName:"PER",colors:{primary:"#D2042D",secondary:"#FFD700",accent:"#D2042D"}},"llaneros-fc":{city:"Villavicencio",shortName:"LLA",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"ad-union-magdalena":{city:"Santa Marta",shortName:"UMG",colors:{primary:"#003DA5",secondary:"#FFD700",accent:"#D2042D"}},"deportivo-pasto":{city:"Pasto",shortName:"PAS",colors:{primary:"#D2042D",secondary:"#003DA5",accent:"#FFFFFF"}},"alianza-petrolera":{city:"Barrancabermeja",shortName:"APE",colors:{primary:"#006B3F",secondary:"#FFD700",accent:"#006B3F"}},"envigado-fc":{city:"Envigado",shortName:"ENV",colors:{primary:"#FF8C00",secondary:"#006B3F",accent:"#FF8C00"}},"boyaca-chico-fc":{city:"Tunja",shortName:"BOY",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"fortaleza-ceif":{city:"Bogot",shortName:"FOR",colors:{primary:"#D2042D",secondary:"#003DA5",accent:"#FFFFFF"}},"club-universidad-de-chile":{city:"Santiago",shortName:"UCH",colors:{primary:"#003DA5",secondary:"#D2042D",accent:"#003DA5"}},"csd-colo-colo":{city:"Santiago",shortName:"COL",colors:{primary:"#FFFFFF",secondary:"#000000",accent:"#FFFFFF"}},"cd-universidad-catolica":{city:"Santiago",shortName:"UCA",colors:{primary:"#FFFFFF",secondary:"#003DA5",accent:"#D2042D"}},"cd-ohiggins":{city:"Rancagua",shortName:"OHI",colors:{primary:"#6CACE4",secondary:"#FFFFFF",accent:"#6CACE4"}},"coquimbo-unido":{city:"Coquimbo",shortName:"COQ",colors:{primary:"#FFD700",secondary:"#000000",accent:"#FFD700"}},"audax-italiano":{city:"Santiago",shortName:"AUD",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"universidad-concepcion":{city:"Concepcin",shortName:"UDE",colors:{primary:"#FFD700",secondary:"#000000",accent:"#FFD700"}},"cd-palestino":{city:"Santiago",shortName:"PAL",colors:{primary:"#FFFFFF",secondary:"#006B3F",accent:"#D2042D"}},"cd-everton":{city:"Via del Mar",shortName:"EVE",colors:{primary:"#003DA5",secondary:"#FFD700",accent:"#003DA5"}},"huachipato-fc":{city:"Talcahuano",shortName:"HUA",colors:{primary:"#003DA5",secondary:"#000000",accent:"#003DA5"}},"club-de-deportes-limache":{city:"Limache",shortName:"LIM",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"deportes-la-serena":{city:"La Serena",shortName:"SER",colors:{primary:"#D2042D",secondary:"#FFD700",accent:"#D2042D"}},"cd-nublense":{city:"Chilln",shortName:"NUB",colors:{primary:"#D2042D",secondary:"#000000",accent:"#D2042D"}},"deportes-concepcion":{city:"Concepcin",shortName:"DCC",colors:{primary:"#800080",secondary:"#FFFFFF",accent:"#800080"}},"union-la-calera":{city:"La Calera",shortName:"ULC",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"cd-cobresal":{city:"El Salvador",shortName:"COB",colors:{primary:"#FF8C00",secondary:"#000000",accent:"#FF8C00"}},"ca-penarol":{city:"Montevideo",shortName:"PE",colors:{primary:"#FFD700",secondary:"#000000",accent:"#FFD700"}},"club-nacional":{city:"Montevideo",shortName:"NAC",colors:{primary:"#FFFFFF",secondary:"#003DA5",accent:"#D2042D"}},"defensor-sc":{city:"Montevideo",shortName:"DEF",colors:{primary:"#800080",secondary:"#FFFFFF",accent:"#800080"}},"liverpool-fc-montevideo":{city:"Montevideo",shortName:"LIV",colors:{primary:"#000000",secondary:"#003DA5",accent:"#000000"}},"ca-boston-river":{city:"Montevideo",shortName:"BOS",colors:{primary:"#D2042D",secondary:"#FFD700",accent:"#D2042D"}},"juventud-de-las-piedras":{city:"Las Piedras",shortName:"JUV",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"montevideo-city-torque":{city:"Montevideo",shortName:"MCT",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"racing-club-de-montevideo":{city:"Montevideo",shortName:"RCM",colors:{primary:"#6CACE4",secondary:"#FFFFFF",accent:"#6CACE4"}},"cd-maldonado":{city:"Maldonado",shortName:"MAL",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"montevideo-wanderers":{city:"Montevideo",shortName:"WAN",colors:{primary:"#000000",secondary:"#FFFFFF",accent:"#000000"}},"albion-fc":{city:"Montevideo",shortName:"ALB",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"cerro-largo-fc":{city:"Melo",shortName:"CLA",colors:{primary:"#FFD700",secondary:"#003DA5",accent:"#FFD700"}},"ca-progreso":{city:"Montevideo",shortName:"PRO",colors:{primary:"#FFD700",secondary:"#D2042D",accent:"#FFD700"}},"danubio-fc":{city:"Montevideo",shortName:"DAN",colors:{primary:"#FFFFFF",secondary:"#D2042D",accent:"#003DA5"}},"central-espanol":{city:"Montevideo",shortName:"CEP",colors:{primary:"#D2042D",secondary:"#003DA5",accent:"#D2042D"}},"ca-cerro":{city:"Montevideo",shortName:"CER",colors:{primary:"#003DA5",secondary:"#FFD700",accent:"#003DA5"}},"independiente-del-valle":{city:"Sangolqu",shortName:"IDV",colors:{primary:"#000000",secondary:"#D2042D",accent:"#FFD700"}},"barcelona-sc-guayaquil":{city:"Guayaquil",shortName:"BSC",colors:{primary:"#FFD700",secondary:"#000000",accent:"#FFD700"}},"ldu-quito":{city:"Quito",shortName:"LDU",colors:{primary:"#FFFFFF",secondary:"#003DA5",accent:"#D2042D"}},"cd-universidad-catolica":{city:"Quito",shortName:"UCE",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"orense-sc":{city:"Machala",shortName:"ORE",colors:{primary:"#FFD700",secondary:"#003DA5",accent:"#FFD700"}},"sd-aucas":{city:"Quito",shortName:"AUC",colors:{primary:"#FFD700",secondary:"#D2042D",accent:"#FFD700"}},"cd-macara":{city:"Ambato",shortName:"MAC",colors:{primary:"#6CACE4",secondary:"#FFFFFF",accent:"#6CACE4"}},"deportivo-cuenca":{city:"Cuenca",shortName:"DCU",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"manta-fc":{city:"Manta",shortName:"MAN",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"cs-emelec":{city:"Guayaquil",shortName:"EME",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"mushuc-runa-sc":{city:"Ambato",shortName:"MUS",colors:{primary:"#800080",secondary:"#FFFFFF",accent:"#800080"}},"delfin-sc":{city:"Manta",shortName:"DEL",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#D2042D"}},"club-leones-del-norte":{city:"Tulcn",shortName:"LDN",colors:{primary:"#D2042D",secondary:"#000000",accent:"#D2042D"}},"guayaquil-city-fc":{city:"Guayaquil",shortName:"GCF",colors:{primary:"#003DA5",secondary:"#FFD700",accent:"#003DA5"}},"libertad-fc":{city:"Loja",shortName:"LIB",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"tecnico-universitario":{city:"Ambato",shortName:"TUN",colors:{primary:"#800020",secondary:"#FFFFFF",accent:"#800020"}},"club-cerro-porteno":{city:"Asuncin",shortName:"CCP",colors:{primary:"#003DA5",secondary:"#D2042D",accent:"#003DA5"}},"olimpia-asuncion":{city:"Asuncin",shortName:"OLI",colors:{primary:"#000000",secondary:"#FFFFFF",accent:"#000000"}},"club-libertad-asuncion":{city:"Asuncin",shortName:"LIB",colors:{primary:"#000000",secondary:"#FFFFFF",accent:"#000000"}},"club-guarani":{city:"Asuncin",shortName:"GUA",colors:{primary:"#FFD700",secondary:"#000000",accent:"#FFD700"}},"club-nacional-asuncion":{city:"Asuncin",shortName:"NAC",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#003DA5"}},"club-sportivo-trinidense":{city:"Trinidad",shortName:"TRI",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"sportivo-luqueno":{city:"Luque",shortName:"LUQ",colors:{primary:"#003DA5",secondary:"#FFD700",accent:"#003DA5"}},"sportivo-ameliano":{city:"Asuncin",shortName:"AME",colors:{primary:"#D2042D",secondary:"#000000",accent:"#D2042D"}},"club-sportivo-2-de-mayo":{city:"Pedro Juan Caballero",shortName:"2DM",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"club-deportivo-recoleta":{city:"Asuncin",shortName:"REC",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"club-rubio-nu-asuncion-":{city:"Asuncin",shortName:"RUB",colors:{primary:"#D2042D",secondary:"#000000",accent:"#FFFFFF"}},"club-sportivo-san-lorenzo":{city:"San Lorenzo",shortName:"SPL",colors:{primary:"#003DA5",secondary:"#D2042D",accent:"#003DA5"}},"club-alianza-lima":{city:"Lima",shortName:"ALI",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"universitario-de-deportes":{city:"Lima",shortName:"UNI",colors:{primary:"#FFD700",secondary:"#D2042D",accent:"#FFD700"}},"club-sporting-cristal":{city:"Lima",shortName:"CRI",colors:{primary:"#6CACE4",secondary:"#FFFFFF",accent:"#6CACE4"}},"fbc-melgar":{city:"Arequipa",shortName:"MEL",colors:{primary:"#D2042D",secondary:"#000000",accent:"#D2042D"}},"cusco-fc":{city:"Cusco",shortName:"CUS",colors:{primary:"#FFD700",secondary:"#D2042D",accent:"#FFD700"}},"sport-boys-association":{city:"Callao",shortName:"SPB",colors:{primary:"#FF69B4",secondary:"#000000",accent:"#FF69B4"}},"deportivo-garcilaso":{city:"Cusco",shortName:"GAR",colors:{primary:"#D2042D",secondary:"#003DA5",accent:"#D2042D"}},"comerciantes-unidos":{city:"Cutervo",shortName:"COU",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"club-cienciano":{city:"Cusco",shortName:"CIE",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"sport-huancayo":{city:"Huancayo",shortName:"SHU",colors:{primary:"#D2042D",secondary:"#000000",accent:"#D2042D"}},"asociacion-deportiva-tarma":{city:"Tarma",shortName:"ADT",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"club-atletico-grau":{city:"Piura",shortName:"GRA",colors:{primary:"#FFFFFF",secondary:"#003DA5",accent:"#D2042D"}},"utc-cajamarca":{city:"Cajamarca",shortName:"UTC",colors:{primary:"#003DA5",secondary:"#FFD700",accent:"#003DA5"}},"fc-cajamarca":{city:"Cajamarca",shortName:"FCC",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"cultural-santa-rosa":{city:"Ayaviri",shortName:"CSR",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"alianza-atletico-sullana":{city:"Sullana",shortName:"AAS",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"club-juan-pablo-ii":{city:"Chimbote",shortName:"JPB",colors:{primary:"#FFFFFF",secondary:"#003DA5",accent:"#FFD700"}},"ucv-moquegua":{city:"Moquegua",shortName:"UCV",colors:{primary:"#003DA5",secondary:"#D2042D",accent:"#003DA5"}},"bolivar-la-paz":{city:"La Paz",shortName:"BOL",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"the-strongest-la-paz":{city:"La Paz",shortName:"STR",colors:{primary:"#FFD700",secondary:"#000000",accent:"#FFD700"}},"club-always-ready":{city:"El Alto",shortName:"ALR",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"blooming-santa-cruz":{city:"Santa Cruz",shortName:"BLO",colors:{primary:"#6CACE4",secondary:"#FFFFFF",accent:"#6CACE4"}},"club-deportivo-guabira":{city:"Montero",shortName:"GBR",colors:{primary:"#FFD700",secondary:"#D2042D",accent:"#FFD700"}},"san-antonio-bulo":{city:"Bulo Bulo",shortName:"SAB",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"ca-nacional-potosi":{city:"Potos",shortName:"NAP",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"cd-oriente-petrolero":{city:"Santa Cruz",shortName:"ORI",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"gualberto-villarroel-san-jose":{city:"Oruro",shortName:"SJO",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"real-oruro":{city:"Oruro",shortName:"ROR",colors:{primary:"#D2042D",secondary:"#003DA5",accent:"#D2042D"}},"club-a-b-b-":{city:"Cochabamba",shortName:"ABB",colors:{primary:"#003DA5",secondary:"#FFFFFF",accent:"#003DA5"}},"universitario-de-vinto":{city:"Vinto",shortName:"UDV",colors:{primary:"#D2042D",secondary:"#FFD700",accent:"#D2042D"}},"cd-real-tomayapo":{city:"Tarija",shortName:"TOM",colors:{primary:"#D2042D",secondary:"#000000",accent:"#FFFFFF"}},"club-aurora":{city:"Cochabamba",shortName:"AUR",colors:{primary:"#003DA5",secondary:"#6CACE4",accent:"#003DA5"}},"club-independiente-petrolero":{city:"Sucre",shortName:"CIP",colors:{primary:"#006B3F",secondary:"#FFFFFF",accent:"#006B3F"}},"real-potosi":{city:"Potos",shortName:"RPO",colors:{primary:"#800020",secondary:"#FFFFFF",accent:"#800020"}},"deportivo-tachira":{city:"San Cristbal",shortName:"TAC",colors:{primary:"#FFD700",secondary:"#000000",accent:"#FFD700"}},"caracas-fc":{city:"Caracas",shortName:"CCS",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#D2042D"}},"deportivo-la-guaira":{city:"La Guaira",shortName:"DLG",colors:{primary:"#FF8C00",secondary:"#000000",accent:"#FF8C00"}},"carabobo-fc":{city:"Valencia",shortName:"CAR",colors:{primary:"#800020",secondary:"#FFD700",accent:"#800020"}},"academia-puerto-cabello":{city:"Puerto Cabello",shortName:"APC",colors:{primary:"#D2042D",secondary:"#003DA5",accent:"#FFFFFF"}},"universidad-central-de-venezuela":{city:"Caracas",shortName:"UCV",colors:{primary:"#006B3F",secondary:"#FFD700",accent:"#006B3F"}},"monagas-sc":{city:"Maturn",shortName:"MON",colors:{primary:"#003DA5",secondary:"#D2042D",accent:"#003DA5"}},"academia-anzoategui-fc":{city:"Puerto La Cruz",shortName:"AAF",colors:{primary:"#000000",secondary:"#FFD700",accent:"#000000"}},"estudiantes-de-merida":{city:"Mrida",shortName:"EDM",colors:{primary:"#D2042D",secondary:"#FFFFFF",accent:"#000000"}},"zamora-fc":{city:"Barinas",shortName:"ZAM",colors:{primary:"#FFFFFF",secondary:"#D2042D",accent:"#D2042D"}},"metropolitanos-fc":{city:"Caracas",shortName:"MET",colors:{primary:"#800080",secondary:"#FFFFFF",accent:"#800080"}},"portuguesa-fc":{city:"Acarigua",shortName:"POR",colors:{primary:"#D2042D",secondary:"#003DA5",accent:"#FFFFFF"}},"trujillanos-fc":{city:"Valera",shortName:"TRU",colors:{primary:"#800020",secondary:"#FFFFFF",accent:"#800020"}},"dvo-rayo-zuliano":{city:"Maracaibo",shortName:"RZU",colors:{primary:"#003DA5",secondary:"#D2042D",accent:"#003DA5"}}},jG={1:{pct:.12,min:15e6,max:5e8},2:{pct:.1,min:5e6,max:12e7},3:{pct:.07,min:15e5,max:3e7},4:{pct:.05,min:3e5,max:5e6},5:{pct:.03,min:1e5,max:15e5}};function VAe(a,e){const n=a.players||[],i=n.length?n.reduce((f,m)=>f+(m.overall||0),0)/n.length:70,s=n.reduce((f,m)=>f+(m.value||0),0);a.reputation=Math.round(i);const r=DT(a.id,a.reputation);a.stadium=r.name,a.stadiumCapacity=r.capacity;const o=Pl(e),l=jG[o]||jG[3],c=Math.max(s*l.pct,l.min);let u=1;i>=80?u=2.5:i>=77?u=1.8:i>=74?u=1.3:i>=70?u=1:i>=66?u=.7:u=.5,a.budget=Math.round(Math.min(c*u,l.max));const h=UAe[a.id];return a.shortName=h?.shortName||zAe(a.name),a.city=h?.city||"",a.colors=h?.colors||{primary:"#333333",secondary:"#FFFFFF",accent:"#888888"},a}function _h(a,e){for(const n of a)VAe(n,e);return a}function zAe(a){if(!a)return"???";const e=new Set(["club","atletico","de","del","la","el","los","las","fc","sc","cd","ca","cf","se","ec","aa","ad","sd","cs","fbc","csd","deportivo","esporte","clube","associacao","association","futebol"]),n=a.replace(/[()]/g,"").split(/[\s-]+/).filter(s=>!e.has(s.toLowerCase()));return n.reduce((s,r)=>r.length>s.length?r:s,n[0]||a).slice(0,3).toUpperCase()}const BG={GK:"POR",CB:"DFC",LB:"LB",RB:"RB",LWB:"LB",RWB:"RB",CDM:"MCD",CM:"MC",CAM:"MCO",LM:"MI",RM:"MD",LW:"EI",RW:"ED",CF:"CF",ST:"DC",LD:"RB",LI:"LB"};function GAe(a){if(!a)return a;for(const e of a)if(e.players)for(const n of e.players)n.position&&BG[n.position]&&(n.position=BG[n.position]);return a}let K6=!1,LE=null,V3=[],z3=[],Y6=[],X6=[],G3=[],q3=[],H3=[],W3=[],$3=[],K3=[],Y3=[],X3=[],Q3=[],J3=[],Z3=[],eN=[],tN=[],Q6=[],J6=[],Z6=[],ek=[],tk=[],nk=[],ak=[],ik=[],nN=[],sk=[],aN=[],iN=[],sN=[],rN=[],oN=[],lN=[],rk=[],ok=[],lk=[],ck=[],uk={grupo1:{name:"Grupo 1",teams:[]},grupo2:{name:"Grupo 2",teams:[]}},Jv={grupo1:{name:"Grupo 1",teams:[]},grupo2:{name:"Grupo 2",teams:[]},grupo3:{name:"Grupo 3",teams:[]},grupo4:{name:"Grupo 4",teams:[]},grupo5:{name:"Grupo 5",teams:[]}};function hu(){return V3}function fu(){return z3}function pu(){return Y6}function mu(){return X6}function pf(){return G3}function mf(){return W3}function gf(){return H3}function Af(){return q3}function wF(){return uk}function EF(){return Jv}function yf(){return $3}function vf(){return K3}function _f(){return Y3}function xf(){return X3}function bf(){return Q3}function Sf(){return J3}function Tf(){return Z3}function wf(){return eN}function Ef(){return tN}function Mf(){return Q6}function Cf(){return J6}function Nf(){return Z6}function Rf(){return ek}function Pf(){return tk}function If(){return nk}function hy(){return ak}function fy(){return ik}function py(){return nN}function my(){return sk}function Lf(){return aN}function Df(){return iN}function kf(){return sN}function Of(){return rN}function Ff(){return oN}function jf(){return lN}function Bf(){return rk}function Uf(){return ok}function Vf(){return lk}function zf(){return ck}const qAe={laliga:{name:"Liga Ibrica",country:"Espaa"},segunda:{name:"Segunda Ibrica",country:"Espaa"},primeraRFEF:{name:"Primera Federacin",country:"Espaa"},segundaRFEF:{name:"Segunda Federacin",country:"Espaa"},premierLeague:{name:"First League",country:"Inglaterra"},ligue1:{name:"Division Premire",country:"Francia"},bundesliga:{name:"Erste Liga",country:"Alemania"},serieA:{name:"Calcio League",country:"Italia"},eredivisie:{name:"Dutch First",country:"Pases Bajos"},primeiraLiga:{name:"Liga Lusitana",country:"Portugal"},championship:{name:"Second League",country:"Inglaterra"},belgianPro:{name:"Belgian First",country:"Blgica"},superLig:{name:"Anatolian League",country:"Turqua"},scottishPrem:{name:"Highland League",country:"Escocia"},serieB:{name:"Calcio B",country:"Italia"},bundesliga2:{name:"Zweite Liga",country:"Alemania"},ligue2:{name:"Division Seconde",country:"Francia"},swissSuperLeague:{name:"Alpine League",country:"Suiza"},austrianBundesliga:{name:"Erste Liga",country:"Austria"},greekSuperLeague:{name:"Super League",country:"Grecia"},danishSuperliga:{name:"Superligaen",country:"Dinamarca"},croatianLeague:{name:"HNL",country:"Croacia"},czechLeague:{name:"Chance Liga",country:"Chequia"},argentinaPrimera:{name:"Liga Profesional",country:"Argentina"},brasileiraoA:{name:"Srie A",country:"Brasil"},colombiaPrimera:{name:"Liga BetPlay",country:"Colombia"},chilePrimera:{name:"Primera Divisin",country:"Chile"},uruguayPrimera:{name:"Primera Divisin",country:"Uruguay"},ecuadorLigaPro:{name:"LigaPro",country:"Ecuador"},paraguayPrimera:{name:"Divisin de Honor",country:"Paraguay"},peruLiga1:{name:"Liga 1",country:"Per"},boliviaPrimera:{name:"Divisin Profesional",country:"Bolivia"},venezuelaPrimera:{name:"Liga FUTVE",country:"Venezuela"},mls:{name:"Major League Soccer",country:"USA"},saudiPro:{name:"Saudi Pro League",country:"Arabia Saud"},ligaMX:{name:"Liga MX",country:"Mxico"},jLeague:{name:"J1 League",country:"Japn"}};async function HAe(){return K6?!0:LE||(LE=(async()=>{console.log(" Cargando datos desde Firestore...");const a=Date.now();try{const[e,n,i,s,r,o,l,c,u,h,f,m,A,x,T,E,M,N,I,F,G,O,D,j,L,U,q,K,H,X,ne,Q,Y,ue,pe,Ee,oe]=await Promise.all([ei.getTeamsByLeague("laliga"),ei.getTeamsByLeague("laliga2"),ei.getTeamsByLeague("primera-rfef"),ei.getTeamsByLeague("segunda-rfef"),ei.getTeamsByLeague("premier"),ei.getTeamsByLeague("seriea"),ei.getTeamsByLeague("bundesliga"),ei.getTeamsByLeague("ligue1"),ei.getTeamsByLeague("eredivisie"),ei.getTeamsByLeague("primeiraLiga"),ei.getTeamsByLeague("championship"),ei.getTeamsByLeague("belgianPro"),ei.getTeamsByLeague("superLig"),ei.getTeamsByLeague("scottishPrem"),ei.getTeamsByLeague("serieB"),ei.getTeamsByLeague("bundesliga2"),ei.getTeamsByLeague("ligue2"),ei.getTeamsByLeague("swissSuperLeague"),ei.getTeamsByLeague("austrianBundesliga"),ei.getTeamsByLeague("greekSuperLeague"),ei.getTeamsByLeague("danishSuperliga"),ei.getTeamsByLeague("croatianLeague"),ei.getTeamsByLeague("czechLeague"),ei.getTeamsByLeague("argentinaPrimera"),ei.getTeamsByLeague("brasileiraoA"),ei.getTeamsByLeague("colombiaPrimera"),ei.getTeamsByLeague("chilePrimera"),ei.getTeamsByLeague("uruguayPrimera"),ei.getTeamsByLeague("ecuadorLigaPro"),ei.getTeamsByLeague("paraguayPrimera"),ei.getTeamsByLeague("peruLiga1"),ei.getTeamsByLeague("boliviaPrimera"),ei.getTeamsByLeague("venezuelaPrimera"),ei.getTeamsByLeague("mls"),ei.getTeamsByLeague("saudiProLeague"),ei.getTeamsByLeague("ligaMX"),ei.getTeamsByLeague("jLeague")]);[e,n,i,s,r,o,l,c,u,h,f,m,A,x,T,E,M,N,I,F,G,O,D,j,L,U,q,K,H,X,ne,Q,Y,ue,pe,Ee,oe].forEach(GAe),V3.length=0,V3.push(...e),z3.length=0,z3.push(...n),Y6.length=0,Y6.push(...i),X6.length=0,X6.push(...s),G3.length=0,G3.push(...r),W3.length=0,W3.push(...o),H3.length=0,H3.push(...l),q3.length=0,q3.push(...c),$3.length=0,$3.push(...u),K3.length=0,K3.push(...h),Y3.length=0,Y3.push(...f),X3.length=0,X3.push(...m),Q3.length=0,Q3.push(...A),J3.length=0,J3.push(...x),Z3.length=0,Z3.push(...T),eN.length=0,eN.push(...E),tN.length=0,tN.push(...M),Q6.length=0,Q6.push(...N),J6.length=0,J6.push(...I),Z6.length=0,Z6.push(...F),ek.length=0,ek.push(...G),tk.length=0,tk.push(...O),nk.length=0,nk.push(...D),aN.length=0,aN.push(..._h(j,"argentinaPrimera")),iN.length=0,iN.push(..._h(L,"brasileiraoA")),sN.length=0,sN.push(..._h(U,"colombiaPrimera")),rN.length=0,rN.push(..._h(q,"chilePrimera")),oN.length=0,oN.push(..._h(K,"uruguayPrimera")),lN.length=0,lN.push(..._h(H,"ecuadorLigaPro")),rk.length=0,rk.push(..._h(X,"paraguayPrimera")),ok.length=0,ok.push(..._h(ne,"peruLiga1")),lk.length=0,lk.push(..._h(Q,"boliviaPrimera")),ck.length=0,ck.push(..._h(Y,"venezuelaPrimera")),ak.length=0,ak.push(...ue),ik.length=0,ik.push(...pe),nN.length=0,nN.push(...Ee),sk.length=0,sk.push(...oe);const Ae=i.slice(0,Math.ceil(i.length/2)),be=i.slice(Math.ceil(i.length/2));uk.grupo1.teams=Ae,uk.grupo2.teams=be;const Ce=Math.ceil(s.length/5);Jv.grupo1.teams=s.slice(0,Ce),Jv.grupo2.teams=s.slice(Ce,Ce*2),Jv.grupo3.teams=s.slice(Ce*2,Ce*3),Jv.grupo4.teams=s.slice(Ce*3,Ce*4),Jv.grupo5.teams=s.slice(Ce*4),K6=!0;const ce=e.length+n.length+i.length+s.length+r.length+o.length+l.length+c.length+u.length+h.length+f.length+m.length+A.length+x.length+T.length+E.length+M.length+N.length+I.length+F.length+G.length+O.length+D.length+j.length+L.length+U.length+q.length+K.length+H.length+X.length+ne.length+Q.length+Y.length+ue.length+pe.length+Ee.length+oe.length;return console.log(` Datos cargados en ${Date.now()-a}ms (${ce} equipos)`),!0}catch(e){return console.error(" Error cargando datos:",e),!1}})(),LE)}function cN(){return K6}const Wa={laliga:{id:"laliga",name:"Liga Ibrica",country:"Espaa",teams:20,getTeams:hu,zones:{champions:[1,2,3,4],europaLeague:[5,6],conference:[7],relegation:[18,19,20]}},segunda:{id:"segunda",name:"Segunda Divisin",country:"Espaa",teams:22,getTeams:fu,zones:{promotion:[1,2],playoff:[3,4,5,6],relegation:[19,20,21,22]}},primeraRFEF:{id:"primeraRFEF",name:"Primera Federacin",country:"Espaa",isGroupLeague:!0,numGroups:2,getTeams:pu,getGroups:()=>{const a=wF();return{grupo1:a.grupo1?.teams||a.grupo1||[],grupo2:a.grupo2?.teams||a.grupo2||[]}},zones:{promotionPerGroup:1,playoffPerGroup:[2,3,4,5],relegationPerGroup:5}},segundaRFEF:{id:"segundaRFEF",name:"Segunda Federacin",country:"Espaa",isGroupLeague:!0,numGroups:5,getTeams:mu,getGroups:()=>{const a=EF();return{grupo1:a.grupo1?.teams||a.grupo1||[],grupo2:a.grupo2?.teams||a.grupo2||[],grupo3:a.grupo3?.teams||a.grupo3||[],grupo4:a.grupo4?.teams||a.grupo4||[],grupo5:a.grupo5?.teams||a.grupo5||[]}},zones:{promotionPerGroup:1,playoffPerGroup:[2,3,4,5],relegationPerGroup:0}},premierLeague:{id:"premierLeague",name:"First League",country:"Inglaterra",teams:20,getTeams:pf,zones:{champions:[1,2,3,4],europaLeague:[5],conference:[6,7],relegation:[18,19,20]}},serieA:{id:"serieA",name:"Calcio League",country:"Italia",teams:20,getTeams:mf,zones:{champions:[1,2,3,4],europaLeague:[5,6],conference:[7],relegation:[18,19,20]}},bundesliga:{id:"bundesliga",name:"Erste Liga",country:"Alemania",teams:18,getTeams:gf,zones:{champions:[1,2,3,4],europaLeague:[5,6],conference:[7],relegation:[16,17,18]}},ligue1:{id:"ligue1",name:"Division Premire",country:"Francia",teams:18,getTeams:Af,zones:{champions:[1,2,3],europaLeague:[4],conference:[5],relegation:[16,17,18]}},eredivisie:{id:"eredivisie",name:"Eredivisie",country:"Pases Bajos",teams:18,getTeams:yf,zones:{champions:[1,2],europaLeague:[3,4],conference:[5,6,7],relegation:[16,17,18]}},primeiraLiga:{id:"primeiraLiga",name:"Primeira Liga",country:"Portugal",teams:18,getTeams:vf,zones:{champions:[1,2],europaLeague:[3,4],conference:[5,6,7],relegation:[16,17,18]}},championship:{id:"championship",name:"Championship",country:"Inglaterra",teams:24,getTeams:_f,zones:{promotion:[1,2],playoff:[3,4,5,6],relegation:[22,23,24]}},belgianPro:{id:"belgianPro",name:"Jupiler Pro League",country:"Blgica",teams:16,getTeams:xf,zones:{champions:[1],europaLeague:[2,3,4],conference:[5,6,7],relegation:[15,16]}},superLig:{id:"superLig",name:"Sper Lig",country:"Turqua",teams:19,getTeams:bf,zones:{champions:[1],europaLeague:[2,3,4],conference:[5,6,7],relegation:[17,18,19]}},scottishPrem:{id:"scottishPrem",name:"Scottish Premiership",country:"Escocia",teams:12,getTeams:Sf,zones:{champions:[1],europaLeague:[2,3],conference:[4,5],relegation:[11,12]}},serieB:{id:"serieB",name:"Calcio B",country:"Italia",teams:20,getTeams:Tf,zones:{promotion:[1,2],playoff:[3,4,5,6,7,8],relegation:[18,19,20]}},bundesliga2:{id:"bundesliga2",name:"Zweite Liga",country:"Alemania",teams:18,getTeams:wf,zones:{promotion:[1,2],playoff:[3],relegation:[16,17,18]}},ligue2:{id:"ligue2",name:"Division Seconde",country:"Francia",teams:18,getTeams:Ef,zones:{promotion:[1,2],playoff:[3,4,5],relegation:[16,17,18]}},swissSuperLeague:{id:"swissSuperLeague",name:"Alpine League",country:"Suiza",teams:12,getTeams:Mf,zones:{champions:[1],europaLeague:[2,3],conference:[4,5],relegation:[11,12]}},austrianBundesliga:{id:"austrianBundesliga",name:"Erste Liga (AT)",country:"Austria",teams:12,getTeams:Cf,zones:{champions:[1],europaLeague:[2,3],conference:[4,5],relegation:[11,12]}},greekSuperLeague:{id:"greekSuperLeague",name:"Super League",country:"Grecia",teams:14,getTeams:Nf,zones:{champions:[1],europaLeague:[2,3],conference:[4,5],relegation:[13,14]}},danishSuperliga:{id:"danishSuperliga",name:"Superligaen",country:"Dinamarca",teams:12,getTeams:Rf,zones:{champions:[1],europaLeague:[2,3],conference:[4,5],relegation:[11,12]}},croatianLeague:{id:"croatianLeague",name:"HNL",country:"Croacia",teams:10,getTeams:Pf,zones:{champions:[1],europaLeague:[2],conference:[3,4],relegation:[9,10]}},czechLeague:{id:"czechLeague",name:"Chance Liga",country:"Chequia",teams:16,getTeams:If,zones:{champions:[1],europaLeague:[2,3],conference:[4,5,6],relegation:[15,16]}},argentinaPrimera:{id:"argentinaPrimera",name:"Liga Profesional",country:"Argentina",teams:30,getTeams:Lf,format:"apertura-clausura",zones:{libertadores:[1,2,3,4],sudamericana:[5,6],relegation:[27,28,29,30]}},brasileiraoA:{id:"brasileiraoA",name:"Srie A",country:"Brasil",teams:20,getTeams:Df,format:"standard",zones:{libertadores:[1,2,3,4],sudamericana:[5,6,7,8],relegation:[17,18,19,20]}},colombiaPrimera:{id:"colombiaPrimera",name:"Liga BetPlay",country:"Colombia",teams:20,getTeams:kf,format:"apertura-clausura",zones:{libertadores:[1,2,3],sudamericana:[4,5,6],relegation:[18,19,20]}},chilePrimera:{id:"chilePrimera",name:"Primera Divisin",country:"Chile",teams:16,getTeams:Of,format:"standard",zones:{libertadores:[1,2],sudamericana:[3,4],relegation:[14,15,16]}},uruguayPrimera:{id:"uruguayPrimera",name:"Primera Divisin",country:"Uruguay",teams:16,getTeams:Ff,format:"apertura-clausura",zones:{libertadores:[1,2],sudamericana:[3,4],relegation:[14,15,16]}},ecuadorLigaPro:{id:"ecuadorLigaPro",name:"LigaPro",country:"Ecuador",teams:16,getTeams:jf,format:"standard",zones:{libertadores:[1,2],sudamericana:[3,4],relegation:[14,15,16]}},paraguayPrimera:{id:"paraguayPrimera",name:"Divisin de Honor",country:"Paraguay",teams:12,getTeams:Bf,format:"apertura-clausura",zones:{libertadores:[1],sudamericana:[2,3],relegation:[11,12]}},peruLiga1:{id:"peruLiga1",name:"Liga 1",country:"Per",teams:18,getTeams:Uf,format:"apertura-clausura",zones:{libertadores:[1,2],sudamericana:[3,4],relegation:[16,17,18]}},boliviaPrimera:{id:"boliviaPrimera",name:"Divisin Profesional",country:"Bolivia",teams:16,getTeams:Vf,format:"apertura-clausura",zones:{libertadores:[1],sudamericana:[2,3],relegation:[14,15,16]}},venezuelaPrimera:{id:"venezuelaPrimera",name:"Liga FUTVE",country:"Venezuela",teams:14,getTeams:zf,format:"apertura-clausura",zones:{libertadores:[1,2],sudamericana:[3,4],relegation:[12,13,14]}},mls:{id:"mls",name:"Major League Soccer",country:"USA",teams:20,getTeams:hy,format:"standard",zones:{promotion:[],relegation:[]}},saudiPro:{id:"saudiPro",name:"Saudi Pro League",country:"Arabia Saud",teams:18,getTeams:fy,format:"standard",zones:{championsLeague:[1,2,3],relegation:[16,17,18]}},ligaMX:{id:"ligaMX",name:"Liga MX",country:"Mxico",teams:18,getTeams:py,format:"apertura-clausura",zones:{relegation:[17,18]}},jLeague:{id:"jLeague",name:"J1 League",country:"Japn",teams:20,getTeams:my,format:"standard",zones:{championsLeague:[1,2,3],relegation:[18,19,20]}}};function Jg(a){return Wa[a]?.format==="apertura-clausura"}function WAe(a,e){if(!a||a.length===0)return e||[];if(!e||e.length===0)return a;const n=a.map(i=>{const s=e.find(r=>r.teamId===i.teamId);return s?{...i,played:i.played+s.played,won:i.won+s.won,drawn:i.drawn+s.drawn,lost:i.lost+s.lost,goalsFor:i.goalsFor+s.goalsFor,goalsAgainst:i.goalsAgainst+s.goalsAgainst,goalDifference:i.goalDifference+s.goalDifference,points:i.points+s.points,form:s.form,morale:s.morale||i.morale}:{...i}});return z_(n)}function eZ(a){return 2*(a-1)}function tZ(a,e,n){const i=n.find(A=>A.id===a),s=n.find(A=>A.id===e);if(!i||!s)return null;const r=jl(a,e,i,s,{importance:"final",homeMorale:85,awayMorale:85}),o=jl(e,a,s,i,{importance:"final",homeMorale:85,awayMorale:85}),l=r.homeScore+o.awayScore,c=r.awayScore+o.homeScore,u=o.awayScore,h=r.awayScore;let f,m;return l>c?(f=a,m="aggregate"):c>l?(f=e,m="aggregate"):u>h?(f=a,m="awayGoals"):h>u?(f=e,m="awayGoals"):(f=e,m="clausuraAdvantage"),{aperturaChampion:a,aperturaChampionName:i.name||i.shortName||a,clausuraChampion:e,clausuraChampionName:s.name||s.shortName||e,leg1:{home:a,away:e,homeScore:r.homeScore,awayScore:r.awayScore},leg2:{home:e,away:a,homeScore:o.homeScore,awayScore:o.awayScore},aggregate:{apertura:l,clausura:c},awayGoals:{apertura:u,clausura:h},winner:f,winnerName:f===a?i.name||a:s.name||e,winReason:m,hadFinal:!0}}function kx(a,e=null){const n={};return Object.entries(Wa).forEach(([i,s])=>{if(s.isGroupLeague){try{const c=s.getGroups();if(!c||Object.keys(c).length===0){console.warn(`No groups found for ${i}`),n[i]={isGroupLeague:!0,groups:{}};return}if(!Object.values(c).some(m=>m&&m.length>0)){console.warn(`No teams in groups for ${i}`),n[i]={isGroupLeague:!0,groups:{}};return}let h=c;if(i===a&&e&&(h={},Object.entries(c).forEach(([m,A])=>{m!==e&&(h[m]=A)})),i===a&&!e)return;const f=L2(h,null);n[i]={isGroupLeague:!0,playerGroup:i===a?e:null,...f}}catch(c){console.warn(`Error initializing group league ${i}:`,c),n[i]={isGroupLeague:!0,groups:{}}}return}if(i===a)return;const r=s.getTeams();if(!r||r.length===0){console.warn(`No teams found for ${i}`),n[i]={table:[],fixtures:[]};return}const{table:o,fixtures:l}=zh(r,null);if(Jg(i)){const c=o.map(u=>({...u}));n[i]={table:o,fixtures:l,accumulatedTable:c,aperturaTable:null,currentTournament:"apertura"}}else n[i]={table:o,fixtures:l}}),n}function nZ(a,e){const n={};return Object.entries(a).forEach(([i,s])=>{const r=Wa[i];if(s.isGroupLeague||r?.isGroupLeague){if(!s.groups||Object.keys(s.groups).length===0){n[i]=s;return}try{const x=r?.getGroups?.()||{},T=wAe(s,e,x);n[i]={...T,isGroupLeague:!0}}catch(x){console.warn(`Error simulating group league ${i} week ${e}:`,x),n[i]=s}return}if(!s.fixtures||s.fixtures.length===0){n[i]=s;return}if(!s.fixtures.some(x=>x.week===e&&!x.played)&&!Jg(i)){n[i]=s;return}if(!r){n[i]=s;return}const l=r.getTeams();if(!l||l.length===0){n[i]=s;return}const c=new Map(l.map(x=>[x.id,x]));let u=[...s.table],h=s.accumulatedTable?s.accumulatedTable.map(x=>({...x})):null,f=s.aperturaTable||null,m=s.currentTournament||"apertura";if(Jg(i)){const x=r.teams;e===x&&m==="apertura"&&(f=u.map(T=>({...T})),m="clausura",u=u.map(T=>({...T,played:0,won:0,drawn:0,lost:0,goalsFor:0,goalsAgainst:0,goalDifference:0,points:0,form:[],homeForm:[],awayForm:[],streak:0,morale:70})))}const A=s.fixtures.map(x=>{if(x.week!==e||x.played)return x;const T=c.get(x.homeTeam),E=c.get(x.awayTeam);if(!T||!E)return x;const M=u.find(F=>F.teamId===x.homeTeam),N=u.find(F=>F.teamId===x.awayTeam),I=jl(x.homeTeam,x.awayTeam,T,E,{homeMorale:M?.morale||70,awayMorale:N?.morale||70});return u=V_(u,x.homeTeam,x.awayTeam,I.homeScore,I.awayScore),h&&(h=V_(h,x.homeTeam,x.awayTeam,I.homeScore,I.awayScore)),{...x,played:!0,homeScore:I.homeScore,awayScore:I.awayScore,events:I.events,stats:I.stats}});if(Jg(i)){let x=s.finalResult||null,T=s.champion||null;if(m==="clausura"&&!x){const E=eZ(r.teams);if(e===E){const M=f?z_([...f]):[],N=z_([...u]),I=M[0]?.teamId,F=N[0]?.teamId;I&&F&&(I===F?(T=I,x={aperturaChampion:I,aperturaChampionName:M[0]?.teamName||I,clausuraChampion:F,clausuraChampionName:N[0]?.teamName||F,winner:I,winnerName:M[0]?.teamName||I,winReason:"sameChampion",hadFinal:!1}):(x=tZ(I,F,l),T=x?.winner||null))}}n[i]={table:u,fixtures:A,accumulatedTable:h,aperturaTable:f,currentTournament:m,finalResult:x,champion:T}}else n[i]={table:u,fixtures:A}}),n}function $Ae(a){return Wa[a]?.name||a}const aZ={laliga:{relegatesTo:"segunda",promotedFrom:"segunda",relegationSpots:3,promotionSpots:2},segunda:{relegatesTo:"primeraRFEF",promotedFrom:"primeraRFEF",promotesTo:"laliga",relegationSpots:3,promotionSpots:2},primeraRFEF:{relegatesTo:"segundaRFEF",promotedFrom:"segundaRFEF",promotesTo:"segunda",isGroupLeague:!0,promotionPerGroup:1,relegationPerGroup:2},segundaRFEF:{relegatesTo:null,promotedFrom:null,promotesTo:"primeraRFEF",isGroupLeague:!0,promotionPerGroup:1,relegationPerGroup:0}};function KAe(a,e){const n=Wa[e],i=aZ[e];if(!n||!i)return[];const s=n.zones;return s.relegation?s.relegation.map(r=>a[r-1]?.teamId).filter(Boolean):[]}function YAe(a,e){const n=Wa[e],i=aZ[e];if(!n||!i)return[];const s=n.zones;return s.promotion?s.promotion.map(r=>a[r-1]?.teamId).filter(Boolean):[]}function XAe(a,e,n,i=null){const s=KAe(a,"laliga"),r=YAe(e,"segunda"),o=fu(),l=hu(),c=[...l,...o];let u=i;(!u||u.phase!=="completed")&&(u=KJ(e,c));const h=u?.winner||null,f=[...r];h&&!f.includes(h)&&f.push(h);let m=null;s.includes(n)?m="segunda":f.includes(n)&&(m="laliga");const A=a.map(F=>F.teamId),x=e.map(F=>F.teamId),T=A.filter(F=>!s.includes(F)).concat(f),E=x.filter(F=>!f.includes(F)).concat(s),M=T.map(F=>l.find(G=>G.id===F)||o.find(G=>G.id===F)).filter(Boolean),N=E.map(F=>o.find(G=>G.id===F)||l.find(G=>G.id===F)).filter(Boolean),I=u?.final?.result?.winnerName||h||"";return{newLaLigaTeams:M,newSegundaTeams:N,relegatedFromLaLiga:s,promotedFromSegunda:f,playoffBracket:u,playoffWinnerId:h,newPlayerLeague:m,changes:{relegated:s.map(F=>a.find(O=>O.teamId===F)?.teamName||F),promoted:r.map(F=>e.find(O=>O.teamId===F)?.teamName||F),playoffWinner:I}}}function QAe(a,e,n,i={}){const s=pu(),r=mu(),o={segundaToRFEF:[],rfefToSegunda:[],rfefToSegundaRFEF:[],segundaRFEFToRFEF:[],primeraRFEFPlayoffBrackets:{},segundaRFEFPlayoffBrackets:{}};if(a&&a.length>0){const l=Wa.segunda.zones;l.relegation&&(o.segundaToRFEF=l.relegation.map(c=>a[c-1]?.teamId).filter(Boolean))}if(e?.groups){const l=OG(e,1);o.rfefToSegunda=l.map(h=>h.teamId);let c=i.primeraRFEFPlayoffBrackets;if(!c){const{brackets:h}=$6(e,s,null);c=U3(h,null).brackets}o.primeraRFEFPlayoffBrackets=c;const u=kG(c);o.rfefToSegunda=[...o.rfefToSegunda,...u]}if(e?.groups){const l=EAe(e,5);o.rfefToSegundaRFEF=l.map(c=>c.teamId)}if(n?.groups){const l=OG(n,1);o.segundaRFEFToRFEF=l.map(h=>h.teamId);let c=i.segundaRFEFPlayoffBrackets;if(!c){const{brackets:h}=$6(n,r,null);c=U3(h,null).brackets}o.segundaRFEFPlayoffBrackets=c;const u=kG(c);o.segundaRFEFToRFEF=[...o.segundaRFEFToRFEF,...u]}return o}function JAe(a,e,n=null,i={}){const s=a.playerLeagueId||"laliga",r=["laliga","segunda","primeraRFEF","segundaRFEF"];if(r.includes(s)){const h=s==="laliga"?a.leagueTable:a.otherLeagues?.laliga?.table||[],f=s==="segunda"?a.leagueTable:a.otherLeagues?.segunda?.table||[],m=s==="primeraRFEF"&&a.leagueGroupData||a.otherLeagues?.primeraRFEF,A=s==="segundaRFEF"&&a.leagueGroupData||a.otherLeagues?.segundaRFEF;let x={changes:{relegated:[],promoted:[],playoffWinner:""}};f.length>0&&h.length>0&&(x=XAe(h,f,e,n));const T=QAe(f,m,A,{primeraRFEFPlayoffBrackets:i.primeraRFEFPlayoffBrackets||null,segundaRFEFPlayoffBrackets:i.segundaRFEFPlayoffBrackets||null}),E=hu(),M=fu(),N=pu(),I=mu(),F=[...E,...M,...N,...I],G=ce=>F.find(te=>te.id===ce),O=x.newLaLigaTeams||E;let D;x.newSegundaTeams?D=x.newSegundaTeams.map(ce=>ce.id):D=f.map(ce=>ce.teamId),D=D.filter(ce=>!T.segundaToRFEF.includes(ce)),D=[...D,...T.rfefToSegunda];const j=D.map(G).filter(Boolean);let L=N.map(ce=>ce.id);L=L.filter(ce=>!T.rfefToSegunda.includes(ce)).filter(ce=>!T.rfefToSegundaRFEF.includes(ce)),L=[...L,...T.segundaToRFEF,...T.segundaRFEFToRFEF];const U=L.map(G).filter(Boolean);let q=I.map(ce=>ce.id);q=q.filter(ce=>!T.segundaRFEFToRFEF.includes(ce)),q=[...q,...T.rfefToSegundaRFEF];const K=q.map(G).filter(Boolean);let H=x.newPlayerLeague||s;T.rfefToSegunda.includes(e)?H="segunda":T.rfefToSegundaRFEF.includes(e)?H="segundaRFEF":(T.segundaRFEFToRFEF.includes(e)||T.segundaToRFEF.includes(e))&&(H="primeraRFEF");const X={};Object.keys(Wa).forEach(ce=>{if(r.includes(ce))return;const te=Wa[ce];if(te.isGroupLeague)try{const fe=te.getGroups(),Le=L2(fe,null);X[ce]={isGroupLeague:!0,...Le}}catch{X[ce]={isGroupLeague:!0,groups:{}}}else{const fe=te.getTeams();if(fe&&fe.length>0){const{table:Le,fixtures:Fe}=zh(fe,null);Jg(ce)?X[ce]={table:Le,fixtures:Fe,accumulatedTable:Le.map(Ie=>({...Ie})),aperturaTable:null,currentTournament:"apertura"}:X[ce]={table:Le,fixtures:Fe}}}});const ne=zh(O,H==="laliga"?e:null),Q=zh(j,H==="segunda"?e:null),Y=FG(U,2),ue=L2(Y,H==="primeraRFEF"?e:null),pe=FG(K,5),Ee=L2(pe,H==="segundaRFEF"?e:null),oe={laliga:ne,segunda:Q,primeraRFEF:{isGroupLeague:!0,...ue},segundaRFEF:{isGroupLeague:!0,...Ee}};r.forEach(ce=>{ce!==H&&(X[ce]=oe[ce])});const Ae=oe[H],be=Wa[H]?.isGroupLeague,Ce={otherLeagues:X,newPlayerLeagueId:H,changes:{...x.changes||{},rfefPromoted:T.rfefToSegunda.map(ce=>G(ce)?.name||ce),rfefRelegated:T.rfefToSegundaRFEF.map(ce=>G(ce)?.name||ce),segundaToRFEF:T.segundaToRFEF.map(ce=>G(ce)?.name||ce),segundaRFEFPromoted:T.segundaRFEFToRFEF.map(ce=>G(ce)?.name||ce)},playoffBracket:x.playoffBracket,primeraRFEFPlayoffBrackets:T.primeraRFEFPlayoffBrackets,segundaRFEFPlayoffBrackets:T.segundaRFEFPlayoffBrackets};if(be){const ce=Ae.playerGroup,te=ce?Ae.groups?.[ce]:null;Ce.playerLeague={isGroupLeague:!0,groups:Ae.groups,playerGroup:ce,table:te?.table||[],fixtures:te?.fixtures||[]}}else Ce.playerLeague={table:Ae.table,fixtures:Ae.fixtures};return Ce}const o=kx(s,a.playerGroupId),l=Wa[s];if(l?.isGroupLeague){const h=l.getGroups(),f=L2(h,e),m=f.playerGroup,A=m?f.groups?.[m]:null;return{playerLeague:{isGroupLeague:!0,...f,table:A?.table||[],fixtures:A?.fixtures||[]},otherLeagues:o,newPlayerLeagueId:s,changes:{relegated:[],promoted:[]}}}const c=l?.getTeams()||[];return{playerLeague:zh(c,e),otherLeagues:o,newPlayerLeagueId:s,changes:{relegated:[],promoted:[]}}}const ZAe=new Set(["laliga","premierLeague","serieA","bundesliga","ligue1"]),eye=new Set(["eredivisie","primeiraLiga","belgianPro","superLig","brasileiraoA","argentinaPrimera","ligaMX"]);function tye(a,e,n){const i=[];for(const[r,o]of Object.entries(Wa)){if(o.isGroupLeague)continue;const l=n[r]||o.getTeams;if(l)try{const c=l();if(!c?.length)continue;for(const u of c){const h=uN(u),f=55+e*.3;h<=f&&i.push({team:u,leagueId:r,leagueName:o.name})}}catch{}}return i.sort(()=>Math.random()-.5).slice(0,20).map(r=>({...r,objective:MF(uN(r.team),r.leagueId,r.team)}))}function uN(a){return a?.players?.length?Math.round(a.players.reduce((e,n)=>e+(n.overall||65),0)/a.players.length):65}function MF(a,e,n){const i=Wa[e];if(!i)return{type:"mid_table",positionTarget:10,label:"proManager.objectives.midTable"};const s=i.teams||20;Pl(e);const r=n?.reputation||3,o=a+r*3;if(o>=88)return{type:"win_league",positionTarget:1,label:"proManager.objectives.winLeague"};if(o>=83)return{type:"top_2",positionTarget:2,label:"proManager.objectives.topTwo"};if(o>=78){const l=Math.min(Math.ceil(s*.25),6);return{type:"european",positionTarget:l,label:"proManager.objectives.european",labelParams:{position:l}}}else{if(o>=73)return{type:"top_half",positionTarget:Math.ceil(s*.5),label:"proManager.objectives.topHalf"};{const l=i.zones?.relegation;return{type:"avoid_relegation",positionTarget:l?Math.min(...l)-1:s-3,label:"proManager.objectives.avoidRelegation"}}}}function nye(a,e){const{matchResult:n,leaguePosition:i,objective:s,totalTeams:r=20,winStreak:o=0,lossStreak:l=0}=e;let c=0;n==="win"?c+=3:n==="draw"?c+=0:n==="loss"&&(c-=4);const u=s?.positionTarget||Math.ceil(r/2),h=i-u;return h<=0?c+=2:h<=3?c-=1:h<=6?c-=3:c-=5,o>=3&&(c+=2),o>=5&&(c+=3),l>=3&&(c-=3),l>=5&&(c-=5),Math.max(0,Math.min(100,a+c))}function aye(a){return a>=80?{type:"happy",key:"proManager.board.happy"}:a>=60?{type:"neutral",key:"proManager.board.neutral"}:a>=30?{type:"concerned",key:"proManager.board.concerned"}:a>=10?{type:"warning",key:"proManager.board.warning"}:{type:"fired",key:"proManager.board.fired"}}function iye(a,e,n){const i=e?.positionTarget||10;let s="failed",r=0;return a<=i?a===1?(s="champion",r=20):a<=Math.max(1,i-2)?(s="exceeded",r=15):(s="met",r=8):a<=i+2?(s="close",r=-3):(s="failed",r=-8),n==="winner"?r+=10:n==="finalist"?r+=5:n==="semifinal"&&(r+=2),{result:s,prestigeChange:r}}function sye(a,e,n=!1){let i=a+e.prestigeChange;return n&&(i-=15),Math.max(0,Math.min(100,i))}function rye(a,e,n,i){const s=[],r=[];for(const[l,c]of Object.entries(Wa)){if(!c.getTeams&&!i[l]||c.isGroupLeague)continue;const u=Pl(l);ZAe.has(l)&&a<50||eye.has(l)&&a<25||a<20&&u<=2||a<35&&u<=1||r.push({leagueId:l,config:c,tier:u})}const o=r.sort(()=>Math.random()-.5).slice(0,4);for(const{leagueId:l,config:c}of o)try{const u=i[l]||c.getTeams;if(!u)continue;const h=u();if(!h?.length)continue;const f=60+a*.35,m=h.filter(x=>x.id===n?!1:uN(x)<=f);if(m.length===0)continue;const A=m[Math.floor(Math.random()*m.length)];s.push({team:A,leagueId:l,leagueName:c.name,country:c.country,objective:MF(uN(A),l,A)})}catch{}return s.slice(0,3)}function oye(a){switch(a){case"champion":return 90;case"exceeded":return 85;case"met":return 70;case"close":return 55;case"failed":return 40;default:return 60}}const a_={youth:{name:"Cantera",options:[{id:"goalkeeper",name:"Portero",icon:"",description:"Genera porteros",effect:{positions:["GK"],bonusOvr:2}},{id:"defense",name:"Defensa",icon:"",description:"Genera defensas (CB, RB, LB)",effect:{positions:["CB","RB","LB"],bonusOvr:2}},{id:"midfield",name:"Medio",icon:"",description:"Genera centrocampistas (CDM, CM, CAM)",effect:{positions:["CDM","CM","CAM"],bonusOvr:2}},{id:"forward",name:"Delantero",icon:"",description:"Genera delanteros y extremos (ST, RW, LW)",effect:{positions:["ST","RW","LW"],bonusOvr:2}}]},medical:{name:"Centro Mdico",options:[{id:"prevention",name:"Prevencin",icon:"",description:"Reduce probabilidad de lesiones (-30%)",effect:{injuryChanceReduction:.3}},{id:"recovery",name:"Recuperacin",icon:"",description:"Reduce tiempo de lesiones (-50%)",effect:{recoveryBonus:.5}},{id:"performance",name:"Rendimiento",icon:"",description:"Jugadores rinden mejor tras lesin",effect:{postInjuryBonus:.1}}]}},lye={youth_standout:{type:"youth",title:" Canterano destacado",getMessage:a=>`${a.name} (${a.position}, ${a.age} aos) est brillando en el filial. Lo subes al primer equipo?`,choices:[{id:"promote",text:" Subir al primer equipo",effect:"add_player"},{id:"wait",text:" Esperar una temporada ms",effect:"boost_potential"},{id:"loan",text:" Cederlo para que coja experiencia",effect:"loan_boost"}]},youth_offer:{type:"youth",title:" Oferta por canterano",getMessage:(a,e)=>`Un club ofrece ${(e/1e6).toFixed(1)}M por ${a.name}. Es canterano, lo vendes?`,choices:[{id:"sell",text:" Vender",effect:"sell"},{id:"negotiate",text:" Pedir ms",effect:"negotiate"},{id:"reject",text:" Rechazar",effect:"reject_boost_morale"}]},medical_discovery:{type:"medical",title:" Nueva tcnica descubierta",getMessage:()=>"El equipo mdico ha desarrollado una nueva tcnica de recuperacin.",choices:[{id:"implement",text:" Implementar (500K)",effect:"temp_recovery_boost",cost:5e5},{id:"study",text:" Estudiar ms",effect:"small_permanent_boost"},{id:"ignore",text:" Ignorar",effect:"none"}]},player_discomfort:{type:"medical",title:" Jugador con molestias",getMessage:a=>`${a.name} tiene molestias musculares. El mdico recomienda descanso.`,choices:[{id:"rest",text:" Descansar (1 semana)",effect:"rest_prevent_injury"},{id:"play",text:" Jugar igual",effect:"risk_injury"},{id:"treatment",text:" Tratamiento intensivo (100K)",effect:"quick_fix",cost:1e5}]}};function cye(a,e,n){if(Math.random()>.15)return null;const s=a?.youth||0,r=a?.medical||0,o=[];if(s>0&&o.push("youth_standout","youth_offer"),r>0&&o.push("medical_discovery","player_discomfort"),o.length===0)return null;const l=o[Math.floor(Math.random()*o.length)],c=lye[l],u=e?.filter(x=>!x.injured)||[];if(u.length===0)return null;const h=u[Math.floor(Math.random()*u.length)],f=u.filter(x=>x.name!==h.name)[Math.floor(Math.random()*(u.length-1))],m=Math.round(h.value*(.8+Math.random()*.4)),A=c.getChoices?c.getChoices(h,f):c.choices;return{id:`event_${Date.now()}`,title:c.title,type:c.type,message:c.getMessage(h,l==="youth_offer"?m:f),choices:A,player:h,player2:f,amount:m,week:n}}const DE=[{parent:"Pel",son:"Pel",pos:"ST",parentOvr:97},{parent:"Maradona",son:"Maradoni",pos:"CAM",parentOvr:96},{parent:"Cruyff",son:"Cruyfi",pos:"CAM",parentOvr:95},{parent:"Messi",son:"Massi",pos:"RW",parentOvr:96},{parent:"Ronaldo Nazrio",son:"Roneldo",pos:"ST",parentOvr:95},{parent:"Cristiano Ronaldo",son:"Cristiani",pos:"LW",parentOvr:94},{parent:"Zidane",son:"Zidani",pos:"CAM",parentOvr:95},{parent:"Ronaldinho",son:"Ronaldino",pos:"CAM",parentOvr:93},{parent:"Beckenbauer",son:"Beckenbau",pos:"CB",parentOvr:95},{parent:"Maldini",son:"Maldino",pos:"CB",parentOvr:94},{parent:"Pirlo",son:"Pirli",pos:"CM",parentOvr:91},{parent:"Xavi",son:"Xabi",pos:"CM",parentOvr:92},{parent:"Iniesta",son:"Iniesti",pos:"CM",parentOvr:92},{parent:"Buffon",son:"Baffon",pos:"GK",parentOvr:93},{parent:"Casillas",son:"Casillos",pos:"GK",parentOvr:92},{parent:"Puyol",son:"Puyel",pos:"CB",parentOvr:90},{parent:"Roberto Carlos",son:"Roberto Carles",pos:"LB",parentOvr:91},{parent:"Cafu",son:"Caf Jr.",pos:"RB",parentOvr:91},{parent:"Henry",son:"Hanry",pos:"ST",parentOvr:93},{parent:"Van Basten",son:"Van Bisten",pos:"ST",parentOvr:94},{parent:"Platini",son:"Platoni",pos:"CAM",parentOvr:94},{parent:"Di Stfano",son:"Di Stefini",pos:"ST",parentOvr:95},{parent:"Puskas",son:"Puskis",pos:"ST",parentOvr:94},{parent:"Eusbio",son:"Eusebiu",pos:"ST",parentOvr:93},{parent:"Garrincha",son:"Garrinchi",pos:"RW",parentOvr:93},{parent:"Matthus",son:"Mattheus",pos:"CDM",parentOvr:92},{parent:"Rummenigge",son:"Rummenigi",pos:"ST",parentOvr:91},{parent:"Bergkamp",son:"Bergkump",pos:"ST",parentOvr:91},{parent:"Ral",son:"Ralito",pos:"ST",parentOvr:90},{parent:"Rivaldo",son:"Rivaldu",pos:"LW",parentOvr:91},{parent:"Nedved",son:"Nedvid",pos:"LW",parentOvr:90},{parent:"Baggio",son:"Bagio",pos:"CAM",parentOvr:92},{parent:"Riquelme",son:"Riquelmi",pos:"CAM",parentOvr:90},{parent:"Laudrup",son:"Laudrip",pos:"CAM",parentOvr:90},{parent:"Drogba",son:"Drogbi",pos:"ST",parentOvr:89},{parent:"Scholes",son:"Scholis",pos:"CM",parentOvr:89},{parent:"Gerrard",son:"Gerrurd",pos:"CM",parentOvr:89},{parent:"Lampard",son:"Lampord",pos:"CM",parentOvr:89},{parent:"Nesta",son:"Nisti",pos:"CB",parentOvr:92},{parent:"Cannavaro",son:"Cannavero",pos:"CB",parentOvr:91},{parent:"Terry",son:"Tarry",pos:"CB",parentOvr:89},{parent:"Yashin",son:"Yashun",pos:"GK",parentOvr:94},{parent:"Neuer",son:"Nouer",pos:"GK",parentOvr:92},{parent:"Ramos",son:"Ramas",pos:"CB",parentOvr:90},{parent:"Lahm",son:"Lahmi",pos:"RB",parentOvr:90},{parent:"Seedorf",son:"Seedurf",pos:"CM",parentOvr:89},{parent:"Vieira",son:"Viera",pos:"CDM",parentOvr:90},{parent:"Romrio",son:"Romariu",pos:"ST",parentOvr:93},{parent:"Stoichkov",son:"Stoichkuv",pos:"LW",parentOvr:91},{parent:"Batistuta",son:"Batistuti",pos:"ST",parentOvr:91}];let kE=new Set;function uye(a){const e=a.split(" "),n=e[e.length-1],i=dye(n),s=["Pablo","Miguel","Carlos","Leo","Adrin","Hugo","Iker","Sergio","Lucas","Marco","Andr","Joo","Pierre","Luca","Mohammed","Kevin","Jack","James","Thomas","Jan","Lars","Sven","Ali","Omar"];return`${s[Math.floor(Math.random()*s.length)]} ${i}`}function dye(a){if(a.length<=2)return a+"i";const e=[i=>{const s="aeiou",r={a:"i",e:"a",i:"u",o:"e",u:"o",:"",:"",:"",:"",:""};for(let o=i.length-1;o>=0;o--)if(s.includes(i[o]))return i.slice(0,o)+(r[i[o]]||"i")+i.slice(o+1);return i+"i"},i=>{const s=[[/ez$/,"iz"],[/es$/,"os"],[/o$/,"i"],[/a$/,"o"],[/er$/,"ar"],[/on$/,"un"],[/ini$/,"oni"],[/ard$/,"urd"],[/en$/,"an"],[/is$/,"us"],[/an$/,"en"]];for(const[r,o]of s)if(r.test(i))return i.replace(r,o);return i+"i"},i=>{const s=Math.floor(i.length*.6),r=i[s];return r&&!"aeiou ".includes(r)?Math.random()<.5?i.slice(0,s)+r+i.slice(s):i.slice(0,s)+i.slice(s+1):i+"o"},i=>{const s=1+Math.floor(Math.random()*(i.length-2));return i.slice(0,s)+i[s+1]+i[s]+i.slice(s+2)}],n=e[Math.floor(Math.random()*e.length)];return n(a)}function UG(a){const e=uye(a.name),n=a.position||"CM",i=17+Math.floor(Math.random()*2),s=50+Math.floor(Math.random()*10),r=a.overall||70,o=Math.floor(Math.random()*9)-5,l=Math.max(60,Math.min(99,r+o));return{name:e,position:n,age:i,overall:s,potential:l,parentName:a.name,parentOvr:r,nationality:a.nationality||"Desconocida",salary:Math.max(1500,Math.round(2e3*Math.pow(2,(s-55)/5)*.5)),value:Math.round(s*s*1e4),contractYears:4,isYouthProduct:!0,isSon:!0}}function VG(a,e){const n=[50,55,58,62][a],i=[60,65,70,75][a];let s,r=0;const o=a_.youth.options.find(E=>E.id===e),l=["GK","CB","RB","LB","CDM","CM","CAM","RW","LW","ST"];o?.effect?.positions?(Math.random()<.8?s=o.effect.positions:s=l,r=o.effect.bonusOvr||0):s=l;const c=s[Math.floor(Math.random()*s.length)],u=Math.min(99,Math.floor(Math.random()*(i-n+1))+n+r),h=17+Math.floor(Math.random()*2);let f=null;const m=zG(c),A=DE.map((E,M)=>({...E,idx:M})).filter(E=>!kE.has(E.idx)&&zG(E.pos)===m);if(A.length>0)f=A[Math.floor(Math.random()*A.length)];else{const E=DE.map((M,N)=>({...M,idx:N})).filter(M=>!kE.has(M.idx));E.length>0?f=E[Math.floor(Math.random()*E.length)]:(kE=new Set,f=DE[Math.floor(Math.random()*DE.length)])}if(f){kE.add(f.idx);const E=Math.floor(Math.random()*9)-5,M=Math.max(65,Math.min(99,f.parentOvr+E));return{name:f.son,position:f.pos,age:h,overall:u,potential:M,parentName:f.parent,parentOvr:f.parentOvr,nationality:"Espaa",salary:Math.max(1500,Math.round(2e3*Math.pow(2,(u-55)/5)*.5)),value:Math.round(u*u*1e4),contractYears:4,isYouthProduct:!0,isSon:!0,isLegendSon:!0}}const x=["Pablo","Miguel","Carlos","David","Hugo","Iker","Mario","Diego"],T=["Garca","Martnez","Lpez","Fernndez","Gonzlez","Rodrguez","Prez"];return{name:`${x[Math.floor(Math.random()*x.length)]} ${T[Math.floor(Math.random()*T.length)]}`,position:c,age:h,overall:u,potential:Math.min(99,u+Math.floor(Math.random()*15)+5),nationality:"Espaa",salary:Math.max(1500,Math.round(2e3*Math.pow(2,(u-55)/5)*.5)),value:Math.round(u*u*1e4),contractYears:4,isYouthProduct:!0}}function zG(a){return a==="GK"?"gk":["CB","RB","LB"].includes(a)?"def":["CDM","CM","CAM"].includes(a)?"mid":"fwd"}function iZ(a){return[0,1,2,2,3,3][a]||0}function hye(a){return[0,1,2,3,4,5][a]||0}function fye(a,e){const n=[5e5,5e5,4e5,3e5,2e5,1e5],i=TF(e);return Math.round((n[a]||5e5)*i)}function pye(a,e=[]){const n=iZ(a),i=Array.isArray(e)?e.length:0;return Math.max(0,n-i)}function mye(a,e,n){const i=e.choices.find(l=>l.id===n);if(!i)return a;let s={...a},r=[];const o=i.cost?Math.round(i.cost*TF(a.leagueId)):0;if(o&&a.money<o)return{...a,messages:[{id:Date.now(),type:"error",title:" Fondos insuficientes",content:`No tienes ${(o/1e6).toFixed(1)}M para esta opcin.`,date:`Semana ${a.currentWeek}`},...a.messages]};switch(i.effect){case"add_player":s.team={...s.team,players:[...s.team.players,{...e.player,overall:e.player.overall+2,isPromoted:!0}]},r.push({id:Date.now(),type:"success",title:" Canterano promocionado",content:`${e.player.name} se une al primer equipo.`,date:`Semana ${a.currentWeek}`});break;case"boost_potential":r.push({id:Date.now(),type:"info",title:" Desarrollo en curso",content:`${e.player.name} seguir desarrollndose en el filial.`,date:`Semana ${a.currentWeek}`});break;case"sell":s.money+=e.amount,r.push({id:Date.now(),type:"success",title:" Venta completada",content:`${e.player.name} vendido por ${(e.amount/1e6).toFixed(1)}M.`,date:`Semana ${a.currentWeek}`});break;case"rest_prevent_injury":s.team={...s.team,players:s.team.players.map(l=>l.name===e.player.name?{...l,resting:!0,restWeeks:1}:l)},r.push({id:Date.now(),type:"info",title:" Jugador descansando",content:`${e.player.name} descansar esta semana.`,date:`Semana ${a.currentWeek}`});break;case"risk_injury":if(Math.random()<.4){const l=1+Math.floor(Math.random()*3);s.team={...s.team,players:s.team.players.map(c=>c.name===e.player.name?{...c,injured:!0,injuryWeeksLeft:l,injuryType:"forced"}:c)},r.push({id:Date.now(),type:"danger",title:" Lesin",content:`${e.player.name} se ha lesionado por ${l} semanas.`,date:`Semana ${a.currentWeek}`})}break;case"big_boost_one":s.team={...s.team,players:s.team.players.map(l=>l.name===e.player.name?{...l,overall:Math.min(99,l.overall+1),trainingProgress:(l.trainingProgress||0)+.5}:l)},r.push({id:Date.now(),type:"success",title:" Mejora notable",content:`${e.player.name} ha mejorado significativamente (+1 OVR).`,date:`Semana ${a.currentWeek}`});break;case"small_boost_all":s.team={...s.team,players:s.team.players.map(l=>({...l,trainingProgress:(l.trainingProgress||0)+.1}))},r.push({id:Date.now(),type:"success",title:" Mejora grupal",content:"Todo el equipo se ha beneficiado del entrenamiento.",date:`Semana ${a.currentWeek}`});break}return o&&(s.money-=o),{...s,messages:[...r,...s.messages].slice(0,50),pendingEvent:null}}function co(a,e){const n=a.overall||70,i=a.age||25,s={60:.2,62:.35,64:.5,66:.8,68:1.2,70:2,72:3.5,74:6,76:10,78:18,80:30,82:45,84:65,86:90,88:120,90:150,92:180,94:220},r=Math.max(60,Math.min(94,n)),o=Math.floor(r/2)*2,l=Math.min(94,o+2),c=(r-o)/2,u=s[o]||.1,h=s[l]||u*1.5;let f=(u+(h-u)*c)*1e6,m=1;i<=20?m=1.25:i<=23?m=1.12:i<=26?m=1.05:i<=28?m=1:i<=30?m=.88:i<=32?m=.72:i<=34?m=.52:i<=36?m=.35:m=.2,n>=88?m=Math.max(m,.5):n>=85?m=Math.max(m,.4):n>=82&&(m=Math.max(m,.3));const A={ST:1.3,CF:1.25,RW:1.2,LW:1.2,CAM:1.15,CM:1,CDM:.95,CB:.9,RB:.85,LB:.85,RWB:.85,LWB:.85,RM:1,LM:1,GK:.7},x=(a.position||"").split(",")[0].trim(),T=A[x]||1,E=a.contractYears||2;let M=1;E<=1?M=.6:E<=2?M=.8:E>=5&&(M=1.1);const N=e?ZJ(e):1,I=f*m*T*M*N;return Math.round(Math.max(5e4,Math.min(3e8,I)))}const dN={elite:{name:"Elite",budgetRange:[15e7,4e8],targetOvrMin:82,maxAge:32,preferYouth:!0,sellReluctance:.8,wageMultiplier:1.5,teams:["Real Madrid","Barcelona","Manchester City","PSG","Bayern Mnchen","Liverpool","Chelsea","Arsenal"]},topTier:{name:"Top Tier",budgetRange:[8e7,15e7],targetOvrMin:78,maxAge:30,preferYouth:!0,sellReluctance:.6,wageMultiplier:1.2,teams:["Atltico Madrid","Manchester United","Juventus","Inter","Milan","Tottenham","Borussia Dortmund","Napoli"]},midTable:{name:"Mid Table",budgetRange:[3e7,8e7],targetOvrMin:72,maxAge:29,preferYouth:!1,sellReluctance:.4,wageMultiplier:1,teams:["Real Sociedad","Athletic Club","Villarreal","Sevilla","Valencia","Real Betis","West Ham","Newcastle","Aston Villa","Roma","Lazio","Atalanta","Fiorentina","RB Leipzig","Bayer Leverkusen"]},lowTable:{name:"Low Table",budgetRange:[1e7,3e7],targetOvrMin:65,maxAge:33,preferYouth:!1,sellReluctance:.2,wageMultiplier:.8,teams:[]}};class CF{constructor(e,n){this.allTeams=e,this.playerTeamId=n,this.transferHistory=[],this.activeRumors=[],this.pendingDeals=[],this.season=1,this.week=1,this.isWindowOpen=!1,this.windowType=null}initializeTeams(e){const n=new Map;return e.forEach(i=>{const s=this.getTeamProfile(i.name),r=i.leagueId?ZJ(i.leagueId):1,[o,l]=s.budgetRange,c=Math.round(o*r),u=Math.round(l*r),h=Math.round(c+Math.random()*(u-c));n.set(i.id,{...i,budget:h,originalBudget:h,profile:s.name,transferActivity:[],needs:this.calculateTeamNeeds(i),sellPriority:this.calculateSellPriority(i)})}),this.allTeams=n,n}getTeamProfile(e){for(const[n,i]of Object.entries(dN))if(i.teams.includes(e))return i;return dN.lowTable}calculateTeamNeeds(e){const n=[],i=e.players||[],s={GK:i.filter(l=>l.position==="GK").length,DEF:i.filter(l=>["CB","RB","LB","RWB","LWB"].includes(l.position)).length,MID:i.filter(l=>["CM","CDM","CAM","RM","LM"].includes(l.position)).length,FWD:i.filter(l=>["ST","CF","RW","LW"].includes(l.position)).length},r={GK:this.avgOverall(i.filter(l=>l.position==="GK")),DEF:this.avgOverall(i.filter(l=>["CB","RB","LB","RWB","LWB"].includes(l.position))),MID:this.avgOverall(i.filter(l=>["CM","CDM","CAM","RM","LM"].includes(l.position))),FWD:this.avgOverall(i.filter(l=>["ST","CF","RW","LW"].includes(l.position)))};s.GK<2&&n.push({position:"GK",priority:"high",reason:"Falta portero suplente"}),s.DEF<5&&n.push({position:"DEF",priority:"high",reason:"Defensa corta"}),s.MID<5&&n.push({position:"MID",priority:"medium",reason:"Mediocampo justo"}),s.FWD<3&&n.push({position:"FWD",priority:"high",reason:"Falta profundidad atacante"});const o=this.getTeamProfile(e.name);return r.GK<o.targetOvrMin&&n.push({position:"GK",priority:"medium",reason:"Portero de baja calidad"}),r.DEF<o.targetOvrMin&&n.push({position:"DEF",priority:"medium",reason:"Defensa dbil"}),r.MID<o.targetOvrMin&&n.push({position:"MID",priority:"medium",reason:"Mediocampo mejorable"}),r.FWD<o.targetOvrMin&&n.push({position:"FWD",priority:"high",reason:"Ataque insuficiente"}),n}calculateSellPriority(e){const n=e.players||[],i=this.getTeamProfile(e.name);return n.filter(s=>{if(s.overall>=85&&i.name!=="lowTable")return!1;const r=s.age>i.maxAge,o=(s.contractYears||2)<=1,l=s.overall<i.targetOvrMin-5;return r||o||l}).map(s=>({playerId:s.id||s.name,name:s.name,reason:s.age>i.maxAge?"Edad":(s.contractYears||2)<=1?"Contrato expira":"Nivel insuficiente",askingPrice:Math.round(co(s)*.9)}))}avgOverall(e){return e.length?Math.round(e.reduce((n,i)=>n+(i.overall||70),0)/e.length):0}simulateWeek(e,n,i){this.week=e,this.isWindowOpen=n,this.windowType=i;const s=[];if(!n){const l=this.generateRumors(2);return s.push(...l.map(c=>({type:"rumor",data:c}))),s}const r=Array.from(this.allTeams.values()).filter(l=>l.id!==this.playerTeamId);for(const l of r){if(Math.random()<.3&&l.needs.length>0){const c=this.attemptSigning(l);c&&s.push({type:"transfer",data:c})}if(Math.random()<.15&&l.sellPriority.length>0){const c=this.attemptSale(l);c&&s.push({type:"transfer",data:c})}}const o=this.generateRumors(Math.random()<.5?1:2);if(s.push(...o.map(l=>({type:"rumor",data:l}))),Math.random()<.3){const l=this.generateLoanRumors(1);s.push(...l.map(c=>({type:"rumor",data:c})))}return s}attemptSigning(e){const n=e.needs[Math.floor(Math.random()*e.needs.length)];if(!n)return null;const i=this.findTransferTargets(e,n.position);if(i.length===0)return null;const s=i[Math.floor(Math.random()*Math.min(3,i.length))],r=this.allTeams.get(s.teamId);if(!r||r.id===this.playerTeamId)return null;const o=co(s,r.leagueId),l=this.getTeamProfile(r.name),c=Math.round(o*(1+l.sellReluctance*.3));if(e.budget<c*.7)return null;const u=Math.round(c*(.8+Math.random()*.3));return u>=c*.85||Math.random()<.3?this.executeTransfer(s,r,e,u):null}attemptSale(e){const n=e.sellPriority[Math.floor(Math.random()*e.sellPriority.length)];if(!n)return null;const i=e.players.find(l=>(l.id||l.name)===n.playerId);if(!i)return null;const s=Array.from(this.allTeams.values()).filter(l=>{if(l.id===e.id||l.id===this.playerTeamId)return!1;const c=this.getTeamProfile(l.name);return i.overall>=c.targetOvrMin-3&&l.budget>=n.askingPrice*.7});if(s.length===0)return null;const r=s[Math.floor(Math.random()*s.length)],o=Math.round(n.askingPrice*(.85+Math.random()*.2));return this.executeTransfer(i,e,r,o)}findTransferTargets(e,n){const i=this.getTeamProfile(e.name),s=[],o={GK:["GK"],DEF:["CB","RB","LB","RWB","LWB"],MID:["CM","CDM","CAM","RM","LM"],FWD:["ST","CF","RW","LW"]}[n]||[];for(const[l,c]of this.allTeams){if(l===e.id||l===this.playerTeamId)continue;const u=this.getTeamProfile(c.name);for(const h of c.players||[])o.includes(h.position)&&(h.overall<i.targetOvrMin-5||h.overall>i.targetOvrMin+15||h.age>i.maxAge+2||h.overall>=83&&u.sellReluctance>.6&&Math.random()>.3||s.push({...h,teamId:l,teamName:c.name}))}return s.sort((l,c)=>{const u=l.overall-Math.abs(l.age-26)*.5;return c.overall-Math.abs(c.age-26)*.5-u})}executeTransfer(e,n,i,s){n.players=n.players.filter(l=>l.name!==e.name);const r={...e,teamId:i.id,contractYears:4,salary:Math.round((e.salary||5e4)*1.2)};i.players.push(r),n.budget+=s,i.budget-=s,n.needs=this.calculateTeamNeeds(n),i.needs=this.calculateTeamNeeds(i),n.sellPriority=this.calculateSellPriority(n),i.sellPriority=this.calculateSellPriority(i);const o={id:`transfer_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,player:{name:e.name,position:e.position,overall:e.overall,age:e.age},from:{id:n.id,name:n.name},to:{id:i.id,name:i.name},price:s,season:this.season,week:this.week,date:new Date().toISOString()};return this.transferHistory.push(o),n.transferActivity.push({...o,type:"sale"}),i.transferActivity.push({...o,type:"purchase"}),o}generateLoanRumors(e=1){const n=[],i=[{type:"loan_interest",text:"{to} quiere la cesin de {player} ({from})"},{type:"loan_close",text:"{player} a punto de salir cedido de {from} al {to}"},{type:"loan_return",text:"{player} podra volver a {from} tras su cesin en {to}"}];for(let s=0;s<e;s++){const r=i[Math.floor(Math.random()*i.length)],o=Array.from(this.allTeams.values()).filter(f=>f.id!==this.playerTeamId),l=o[Math.floor(Math.random()*o.length)],c=o.filter(f=>f.id!==l?.id)[Math.floor(Math.random()*Math.max(1,o.length-1))];if(!l?.players?.length||!c)continue;const u=l.players.filter(f=>f.age<=23||f.overall<l.players.reduce((m,A)=>m+(A.overall||70),0)/l.players.length-3),h=u.length>0?u[Math.floor(Math.random()*u.length)]:l.players[Math.floor(Math.random()*l.players.length)];h&&n.push({id:`loan_rumor_${Date.now()}_${s}`,type:r.type,text:r.text.replace("{player}",h.name).replace("{from}",l.name).replace("{to}",c.name),player:{name:h.name,position:h.position,overall:h.overall},from:l.name,to:c.name,reliability:Math.round(25+Math.random()*45),isLoanRumor:!0,createdAt:Date.now()})}return n}generateRumors(e=1){const n=[],i=[{type:"interest",text:"{to} est interesado en {player} ({from})"},{type:"bid",text:"{to} prepara oferta de {price} por {player}"},{type:"negotiation",text:"{player} negocia su salida de {from}"},{type:"close",text:"{player} a punto de firmar por {to}"},{type:"rejected",text:"{from} rechaza oferta por {player}"}];for(let r=0;r<e;r++){const o=i[Math.floor(Math.random()*i.length)],l=Array.from(this.allTeams.values()).filter(A=>A.id!==this.playerTeamId),c=l[Math.floor(Math.random()*l.length)],u=l.filter(A=>A.id!==c.id)[Math.floor(Math.random()*(l.length-1))];if(!c?.players?.length||!u)continue;const h=c.players[Math.floor(Math.random()*c.players.length)];if(!h)continue;const f=co(h,c.leagueId),m={id:`rumor_${Date.now()}_${r}`,type:o.type,text:o.text.replace("{player}",h.name).replace("{from}",c.name).replace("{to}",u.name).replace("{price}",`${(f/1e6).toFixed(0)}M`),player:{name:h.name,position:h.position,overall:h.overall},from:c.name,to:u.name,reliability:Math.round(30+Math.random()*50),willHappen:Math.random()<.3,createdAt:Date.now()};this.activeRumors.push(m),n.push(m)}const s=Date.now()-10080*60*1e3;return this.activeRumors=this.activeRumors.filter(r=>r.createdAt>s),n}getMarketSummary(){const e=this.transferHistory.slice(-20),n=[...this.transferHistory].sort((r,o)=>o.price-r.price).slice(0,10),i={};this.transferHistory.forEach(r=>{i[r.to.name]=(i[r.to.name]||0)+1});const s=Object.entries(i).sort((r,o)=>o[1]-r[1]).slice(0,5).map(([r,o])=>({name:r,purchases:o}));return{totalTransfers:this.transferHistory.length,totalSpent:this.transferHistory.reduce((r,o)=>r+o.price,0),recentTransfers:e,topDeals:n,mostActive:s,activeRumors:this.activeRumors.slice(-10)}}getTeamHistory(e){const n=this.allTeams.get(e);return n?{team:n.name,budget:n.budget,activity:n.transferActivity||[],needs:n.needs,sellPriority:n.sellPriority}:null}serialize(){return{allTeams:Array.from(this.allTeams.entries()),transferHistory:this.transferHistory,activeRumors:this.activeRumors,season:this.season,week:this.week}}static deserialize(e,n){const i=new CF(new Map,n);return i.allTeams=new Map(e.allTeams),i.transferHistory=e.transferHistory||[],i.activeRumors=e.activeRumors||[],i.season=e.season||1,i.week=e.week||1,i}}function NF(a,e={}){return{open:!0,type:"always"}}function Sn(a){if(a==null||a===0)return"0";const e=Math.abs(a);if(e<1e3)return`${Math.round(a)}`;if(e<1e6){const i=a/1e3;return i>=100?`${Math.round(i)}K`:`${i.toFixed(1)}K`}const n=a/1e6;return n>=100?`${Math.round(n)}M`:`${n.toFixed(1)}M`}function gye(a,e=20){return a>=90?1:a>=85?3:a>=80?5:a>=75?8:a>=70?12:a>=65?15:a>=60?17:e-1}function Aye(a){const{team:e,leagueTable:n,teamId:i,currentWeek:s,preseasonPhase:r,managerConfidence:o=75,money:l=0}=a;if(r||s<=5)return{confidence:o,warning:null,fired:!1,reason:null};const c=n?.length||20,u=n?.find(L=>L.teamId===i),h=n?.findIndex(L=>L.teamId===i)+1||c,f=gye(e?.reputation||70,c);let m=0,A=[];const x=h-f;x>10?(m-=8,A.push(`Posicin ${h} (se esperaba top ${f})`)):x>6?(m-=5,A.push("Rendimiento por debajo de expectativas")):x>3?m-=2:x<=0&&(m+=2);const E=(u?.form||[]).slice(-5),M=yye(E);M>=5?(m-=15,A.push(`${M} derrotas consecutivas`)):M>=4?(m-=10,A.push(`${M} derrotas seguidas`)):M>=3&&(m-=5,A.push("Mala racha de resultados"));const N=e?.players?.filter(L=>!L.injured)?.length||0,I=e?.players?.length||0;I<14?(m-=12,A.push(`Plantilla insuficiente (${I} jugadores)`)):I<17&&(m-=5,A.push(`Plantilla muy corta (${I} jugadores)`)),N<11&&(m-=15,A.push("Menos de 11 jugadores disponibles"));const F=c-2;if(h>=F&&s>=15&&(m-=8,A.push("En zona de descenso")),E.length>0&&E[E.length-1]==="W"&&(m+=3),l<0)return{confidence:0,warning:"critical",fired:!0,reason:"La directiva te ha destituido por llevar al club a la bancarrota.",details:[`Presupuesto: ${Math.round(l/1e3)}K`]};const G=Math.max(0,Math.min(100,o+m));let O=null,D=!1,j=null;return G<=10?(D=!0,j=A.length>0?`La directiva ha perdido la confianza. ${A[0]}.`:"Resultados deportivos insuficientes."):G<=25?(O="critical",j=` La directiva est muy descontenta. ${A[0]||"Mejora los resultados urgentemente."}`):G<=40&&(O="low",j=`La directiva empieza a impacientarse. ${A[0]||"Se esperan mejores resultados."}`),{confidence:G,warning:O,fired:D,reason:j,details:A}}function yye(a){let e=0;for(let n=a.length-1;n>=0&&a[n]==="L";n--)e++;return e}function vye(a,e){return!a.warning&&!a.fired?null:a.fired?{id:Date.now()+Math.random(),type:"firing",title:" DESTITUIDO",content:a.reason,date:`Semana ${e}`,urgent:!0}:a.warning==="critical"?{id:Date.now()+Math.random(),type:"warning",title:" Ultimtum de la directiva",content:a.reason,date:`Semana ${e}`,urgent:!0}:a.warning==="low"?{id:Date.now()+Math.random(),type:"warning",title:" Comunicado de la directiva",content:a.reason,date:`Semana ${e}`}:null}function _ye(a){let e=0;for(let n=0;n<a.length;n++)e=(e<<5)-e+a.charCodeAt(n)|0;return Math.abs(e)}function D2(a,e=1){const n=a.overall||65,i=a.age||25,s=2e3*Math.pow(2,(n-55)/5);let r=1;i<=21?r=.7:i<=23?r=.85:i<=29?r=1:i<=32?r=1.05:i<=35?r=.85:r=.6;const l=.88+_ye(a.name||"Player")%250/1e3;let c,u;if(typeof e=="string"){c=FAe(e);const m=[[1,1],[.18,2],[.07,3],[.025,4],[.01,5]];u=3;for(const[A,x]of m)if(c>=A){u=x;break}}else u=e,c={1:1,2:.5,3:.22,4:.08,5:.03}[u]??1;const f={1:2e3,2:1e3,3:500,4:200,5:80}[u]??500;return Math.max(f,Math.round(s*r*l*c))}function xye(a,e=1){return(a||[]).map(n=>({...n,salary:D2(n,e)}))}function bye(a,e=1){return(a||[]).map(n=>{const i=n.leagueId||e;return{...n,players:xye(n.players||[],i)}})}function Sye(a){let e=0;for(let n=0;n<(a||"").length;n++)e=(e<<5)-e+a.charCodeAt(n)|0;return Math.abs(e)}function cD(a,e){return Sye(a+":"+e)%1e4/1e4}function GG(a){const{name:e,age:n,overall:i}=a;if(a.isSon&&a.potential)return Tye(a);const s=cD(e,"talent"),r=cD(e,"peakAge"),o=cD(e,"durability"),l=28+Math.floor(r*6),c=.6+s*.8,u=(Math.random()-.5)*.6;let h=0;if(n<=20)h=1.5+c*1.5+u,s>.85&&Math.random()<.25&&(h+=1);else if(n<=24)h=.8+c*1+u;else if(n<=28)h=.2+c*.4+u*.7,i>=90&&(h*=.5);else if(n<=l)h=.1+u*.5,i>=92&&(h-=.3);else{const M=n-l,N=.5+(1-o)*.8;h=-(M*N)+u*.4,n>=37&&(h-=1),n>=39&&(h-=1.5)}const f=h>=0?1:-1,m=Math.abs(h),A=Math.floor(m),x=m-A,T=f*(A+(Math.random()<x?1:0));return Math.max(50,Math.min(99,i+T))}function Tye(a){const{age:e,overall:n,potential:i}=a,s=i-n,r=(Math.random()-.5)*.4;let o=0;if(e<=20){const m=.2+Math.random()*.1;o=Math.max(2,s*m)+r}else if(e<=24){const m=.12+Math.random()*.08;o=Math.max(1,s*m)+r}else e<=28?s>3?o=1+r:o=.2+r*.5:e<=32?o=-.2+r*.5:(o=-((e-32)*.8)+r*.3,e>=37&&(o-=1));n>=i&&o>0&&(o=Math.min(o,.3));const l=o>=0?1:-1,c=Math.abs(o),u=Math.floor(c),h=c-u,f=l*(u+(Math.random()<h?1:0));return Math.max(50,Math.min(99,n+f))}const wye={id:"championsLeague",name:"Continental Champions Cup",shortName:"Champions",icon:"",color:"#1a237e",teamsCount:32,potsCount:4,matchesPerTeam:8,prizes:{participation:15e6,winBonus:28e5,drawBonus:93e4,r16:11e6,qf:125e5,sf:15e6,final:185e5,winnerExtra:45e5}},Eye={id:"europaLeague",name:"Continental Shield",shortName:"Continental Shield",icon:"",color:"#e65100",teamsCount:32,potsCount:4,matchesPerTeam:8,prizes:{participation:4e6,winBonus:6e5,drawBonus:2e5,r16:12e5,qf:18e5,sf:28e5,final:4e6,winnerExtra:4e6}},Mye={id:"conferenceleague",name:"Continental Trophy",shortName:"Continental Trophy",icon:"",color:"#2e7d32",teamsCount:32,potsCount:4,matchesPerTeam:8,prizes:{participation:3e6,winBonus:5e5,drawBonus:15e4,r16:6e5,qf:1e6,sf:2e6,final:3e6,winnerExtra:3e6}},sZ={championsLeague:wye,europaLeague:Eye,conferenceleague:Mye},hP={laliga:{leagueId:"laliga",name:"Liga Ibrica",country:"Espaa",championsLeague:4,europaLeague:2,conferenceleague:1},premierLeague:{leagueId:"premierLeague",name:"First League",country:"Inglaterra",championsLeague:4,europaLeague:2,conferenceleague:1},serieA:{leagueId:"serieA",name:"Calcio League",country:"Italia",championsLeague:4,europaLeague:2,conferenceleague:1},bundesliga:{leagueId:"bundesliga",name:"Erste Liga",country:"Alemania",championsLeague:4,europaLeague:2,conferenceleague:1},ligue1:{leagueId:"ligue1",name:"Division Premire",country:"Francia",championsLeague:3,europaLeague:1,conferenceleague:1},eredivisie:{leagueId:"eredivisie",name:"Dutch First",country:"Pases Bajos",championsLeague:2,europaLeague:2,conferenceleague:3},primeiraLiga:{leagueId:"primeiraLiga",name:"Liga Lusitana",country:"Portugal",championsLeague:2,europaLeague:2,conferenceleague:3},belgianPro:{leagueId:"belgianPro",name:"Belgian First",country:"Blgica",championsLeague:1,europaLeague:3,conferenceleague:3},superLig:{leagueId:"superLig",name:"Anatolian League",country:"Turqua",championsLeague:1,europaLeague:3,conferenceleague:3},scottishPrem:{leagueId:"scottishPrem",name:"Highland League",country:"Escocia",championsLeague:1,europaLeague:2,conferenceleague:2},austrianBundesliga:{leagueId:"austrianBundesliga",name:"Erste Liga (AT)",country:"Austria",championsLeague:1,europaLeague:2,conferenceleague:2},greekSuperLeague:{leagueId:"greekSuperLeague",name:"Super League",country:"Grecia",championsLeague:1,europaLeague:2,conferenceleague:2},swissSuperLeague:{leagueId:"swissSuperLeague",name:"Alpine League",country:"Suiza",championsLeague:1,europaLeague:2,conferenceleague:2},danishSuperliga:{leagueId:"danishSuperliga",name:"Superligaen",country:"Dinamarca",championsLeague:1,europaLeague:2,conferenceleague:2},croatianLeague:{leagueId:"croatianLeague",name:"HNL",country:"Croacia",championsLeague:1,europaLeague:1,conferenceleague:2},czechLeague:{leagueId:"czechLeague",name:"Chance Liga",country:"Chequia",championsLeague:1,europaLeague:2,conferenceleague:3}},CA={league:[6,9,12,15,18,21,24,27],playoff:[31,33],r16:[35,37],qf:[39,41],sf:[43,45],final:[47]},Cye=[...CA.league,...CA.playoff,...CA.r16,...CA.qf,...CA.sf,...CA.final];function Nye(a){for(const[e,n]of Object.entries(CA)){const i=n.indexOf(a);if(i!==-1)return{phase:e,matchday:i+1}}return null}function Rye(a){return Cye.includes(a)}function RF(a,{hasEuropean:e=!1,cupRounds:n=0}={}){const i=[];for(let A=0;A<n;A++)i.push(Math.round((A+1)*a/(n+1)));const s=[];let r=0,o=0,l=0;const c=()=>{l<i.length&&r>=i[l]&&(o++,s.push({week:o,type:"cup",cupRound:l}),l++)};if(e){const A=Math.floor(a/9);for(let T=0;T<8;T++){for(let E=0;E<A&&!(r>=a);E++)o++,r++,s.push({week:o,type:"league",leagueMD:r}),c();o++,s.push({week:o,type:"european",phase:"league",matchday:T+1})}const x=[["playoff",1],["playoff",2],["r16",1],["r16",2],["qf",1],["qf",2],["sf",1],["sf",2],["final",1]];for(const[T,E]of x)r<a&&(o++,r++,s.push({week:o,type:"league",leagueMD:r}),c()),o++,s.push({week:o,type:"european",phase:T,matchday:E});for(;r<a;)o++,r++,s.push({week:o,type:"league",leagueMD:r}),c()}else for(;r<a;)o++,r++,s.push({week:o,type:"league",leagueMD:r}),c();for(;l<i.length;)o++,s.push({week:o,type:"cup",cupRound:l}),l++;const u={league:[],playoff:[],r16:[],qf:[],sf:[],final:[]},h=new Array(a),f=[];for(const A of s)A.type==="european"?u[A.phase].push(A.week):A.type==="league"?h[A.leagueMD-1]=A.week:A.type==="cup"&&f.push(A.week);const m=Object.values(u).flat().sort((A,x)=>A-x);return{leagueWeekMap:h,europeanWeeks:u,allEuropeanWeeks:m,cupWeeks:f,totalWeeks:o}}function rZ(a,e){return e?.cupWeeks?.includes(a)||!1}function PF(a,e){if(!e?.cupWeeks)return null;const n=e.cupWeeks.indexOf(a);return n>=0?n:null}function IF(a,e){return a.map(n=>{const i=e[n.week-1];return i!=null?{...n,week:i}:n})}function Pye(a,e){if(!e||!e.europeanWeeks)return null;for(const[n,i]of Object.entries(e.europeanWeeks)){const s=i.indexOf(a);if(s!==-1)return{phase:n,matchday:s+1}}return null}function Iye(a,e){return e&&e.allEuropeanWeeks?e.allEuropeanWeeks.includes(a):Rye(a)}function hN(a,e){return e?Pye(a,e):Nye(a)}function fP(a,e={}){const n={championsLeague:[],europaLeague:[],conferenceleague:[]};for(const[i,s]of Object.entries(hP)){const r=a[i];if(!r||r.length===0)continue;for(let c=0;c<s.championsLeague&&c<r.length;c++){const u=r[c],h=e[u.teamId]||{};n.championsLeague.push({teamId:u.teamId,teamName:u.teamName||h.name||u.teamId,shortName:u.shortName||h.shortName||"",league:i,leaguePosition:c+1,reputation:h.reputation||u.reputation||70,overall:h.overall||u.overall||70,players:h.players||[],...h})}const o=s.championsLeague;for(let c=o;c<o+s.europaLeague&&c<r.length;c++){const u=r[c],h=e[u.teamId]||{};n.europaLeague.push({teamId:u.teamId,teamName:u.teamName||h.name||u.teamId,shortName:u.shortName||h.shortName||"",league:i,leaguePosition:c+1,reputation:h.reputation||u.reputation||70,overall:h.overall||u.overall||70,players:h.players||[],...h})}const l=o+s.europaLeague;for(let c=l;c<l+s.conferenceleague&&c<r.length;c++){const u=r[c],h=e[u.teamId]||{};n.conferenceleague.push({teamId:u.teamId,teamName:u.teamName||h.name||u.teamId,shortName:u.shortName||h.shortName||"",league:i,leaguePosition:c+1,reputation:h.reputation||u.reputation||70,overall:h.overall||u.overall||70,players:h.players||[],...h})}}return n}function Lye(a){const e=[...a].sort((s,r)=>{const o=(r.reputation||0)-(s.reputation||0);return o!==0?o:(r.overall||0)-(s.overall||0)}),n=8,i=[];for(let s=0;s<4;s++)i.push(e.slice(s*n,(s+1)*n));return i}function qC(a){const e=[...a];for(let n=e.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[e[n],e[i]]=[e[i],e[n]]}return e}function oZ(a){if(a=[...a],a.length<32)for(console.warn(`Swiss draw: expected 32 teams, got ${a.length}. Padding with placeholder teams.`);a.length<32;)a.push({teamId:`placeholder_${a.length}`,teamName:`Placeholder ${a.length+1}`,shortName:"PLH",league:`placeholder_league_${a.length}`,reputation:50,overall:50,players:[]});const e=Lye(a),n=new Map;e.forEach((r,o)=>{r.forEach(l=>n.set(l.teamId,o))});const i=Dye(a,e,n);return{matchdays:kye(i,8),pots:e}}function Dye(a,e,n){const i=[],s=new Map,r=new Map,o=new Map,l=new Map;a.forEach(h=>{s.set(h.teamId,0),r.set(h.teamId,new Set);const f={},m={};for(let A=0;A<4;A++)f[A]=0,m[A]=0;o.set(h.teamId,f),l.set(h.teamId,m)});const c=new Map;a.forEach(h=>c.set(h.teamId,h));for(let h=0;h<4;h++){const f=e[h];for(const m of qC(a)){const A=n.get(m.teamId),x=r.get(m.teamId),T=o.get(m.teamId),E=l.get(m.teamId),M=1-T[h],N=1-E[h],I=qC(f).filter(D=>!(D.teamId===m.teamId||x.has(D.teamId)||s.get(D.teamId)>=8)),F=I.filter(D=>D.league!==m.league),G=F.length>0?F:I;if(M>0&&G.length>0){const D=G.shift();if(D){const j=l.get(D.teamId);n.get(D.teamId),j[A]<1&&s.get(D.teamId)<8&&(i.push({homeTeamId:m.teamId,awayTeamId:D.teamId,homePot:A,awayPot:n.get(D.teamId)}),T[h]++,j[A]=(j[A]||0)+1,x.add(D.teamId),r.get(D.teamId).add(m.teamId),s.set(m.teamId,s.get(m.teamId)+1),s.set(D.teamId,s.get(D.teamId)+1))}}const O=G.filter(D=>!x.has(D.teamId)&&D.teamId!==m.teamId&&s.get(D.teamId)<8);if(N>0&&O.length>0){const D=O[0];if(D){const j=o.get(D.teamId);j[A]<1&&(i.push({homeTeamId:D.teamId,awayTeamId:m.teamId,homePot:n.get(D.teamId),awayPot:A}),E[h]++,j[A]=(j[A]||0)+1,x.add(D.teamId),r.get(D.teamId).add(m.teamId),s.set(m.teamId,s.get(m.teamId)+1),s.set(D.teamId,s.get(D.teamId)+1))}}}}const u=a.filter(h=>s.get(h.teamId)<8);for(const h of u){const f=r.get(h.teamId),m=8-s.get(h.teamId),A=qC(a).filter(x=>!(x.teamId===h.teamId||f.has(x.teamId)||s.get(x.teamId)>=8));for(let x=0;x<m&&x<A.length;x++){const T=A[x],E=Math.random()>.5;i.push({homeTeamId:E?h.teamId:T.teamId,awayTeamId:E?T.teamId:h.teamId,homePot:n.get(E?h.teamId:T.teamId),awayPot:n.get(E?T.teamId:h.teamId)}),f.add(T.teamId),r.get(T.teamId).add(h.teamId),s.set(h.teamId,s.get(h.teamId)+1),s.set(T.teamId,s.get(T.teamId)+1)}}return i}function kye(a,e){const n=Array.from({length:e},()=>[]),i=new Map,s=new Set;a.forEach(o=>{s.add(o.homeTeamId),s.add(o.awayTeamId)}),s.forEach(o=>i.set(o,new Set));const r=qC(a);for(const o of r){const l=i.get(o.homeTeamId),c=i.get(o.awayTeamId);let u=!1;for(let h=0;h<e;h++)if(!l.has(h)&&!c.has(h)){n[h].push({...o,matchday:h+1}),l.add(h),c.add(h),u=!0;break}if(!u){const h=n.map((f,m)=>({idx:m,count:f.length})).sort((f,m)=>f.count-m.count)[0].idx;n[h].push({...o,matchday:h+1}),l.add(h),c.add(h)}}return n}function pP(a,e){const n=new Map;a.forEach(s=>{n.set(s.teamId,{teamId:s.teamId,teamName:s.teamName||s.name||s.teamId,shortName:s.shortName||"",league:s.league||"",reputation:s.reputation||70,played:0,won:0,drawn:0,lost:0,goalsFor:0,goalsAgainst:0,goalDifference:0,points:0})});for(const s of e){const r=n.get(s.homeTeamId),o=n.get(s.awayTeamId);!r||!o||(r.played++,o.played++,r.goalsFor+=s.homeScore,r.goalsAgainst+=s.awayScore,o.goalsFor+=s.awayScore,o.goalsAgainst+=s.homeScore,s.homeScore>s.awayScore?(r.won++,r.points+=3,o.lost++):s.homeScore<s.awayScore?(o.won++,o.points+=3,r.lost++):(r.drawn++,o.drawn++,r.points+=1,o.points+=1))}const i=Array.from(n.values());return i.forEach(s=>{s.goalDifference=s.goalsFor-s.goalsAgainst}),i.sort((s,r)=>r.points!==s.points?r.points-s.points:r.goalDifference!==s.goalDifference?r.goalDifference-s.goalDifference:r.goalsFor!==s.goalsFor?r.goalsFor-s.goalsFor:(r.reputation||0)-(s.reputation||0)),i}function lZ(a){return{direct:a.slice(0,8),playoffSeeded:a.slice(8,16),playoffUnseeded:a.slice(16,24),eliminated:a.slice(24)}}function dk(a){const e=[...a];for(let n=e.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[e[n],e[i]]=[e[i],e[n]]}return e}function cZ(a,e){const n=[],i=new Set,s=dk(a),r=dk(e);for(const o of s){let l=r.find(c=>!i.has(c.teamId)&&c.league!==o.league);l||(l=r.find(c=>!i.has(c.teamId))),l&&(i.add(l.teamId),n.push({id:`playoff_${n.length}`,team1:l,team2:o,leg1:null,leg2:null,winner:null,aggregate:null}))}return n}function A_(a,e={}){const{avoidSameLeague:n=!0,isFinal:i=!1}=e,s=[],r=dk(a),o=new Set;for(const l of r){if(o.has(l.teamId))continue;let c=null;n&&(c=r.find(u=>u.teamId!==l.teamId&&!o.has(u.teamId)&&u.league!==l.league)),c||(c=r.find(u=>u.teamId!==l.teamId&&!o.has(u.teamId))),c&&(o.add(l.teamId),o.add(c.teamId),s.push({id:`ko_${s.length}`,team1:l,team2:c,isFinal:i,leg1:null,leg2:null,winner:null,aggregate:null}))}return s}function uD(a,e){const n=a.teamId||a.id,i=e.teamId||e.id,s=qG(a),r=qG(e);return jl(n,i,s,r,{importance:"crucial",attendanceFillRate:.85})}function qG(a){if(a.players&&a.players.length>=11)return a;const e=a.reputation||70;return{...a,id:a.teamId||a.id,name:a.teamName||a.name||"Desconocido",players:Array.from({length:18},(n,i)=>({name:`Jugador ${i+1}`,position:["GK","CB","CB","CB","RB","LB","CM","CM","CDM","CAM","RM","LM","RW","LW","ST","ST","CF","GK"][i],overall:Math.round(e+(Math.random()*10-5)),age:22+Math.floor(Math.random()*10),stamina:80+Math.floor(Math.random()*15)}))}}function LF(a,e={}){const{team1:n,team2:i,isFinal:s}=a;if(s){const h=uD(n,i);let f;if(h.homeScore>h.awayScore)f=n;else if(h.awayScore>h.homeScore)f=i;else{const m=n.reputation||70,A=i.reputation||70,x=m/(m+A);f=Math.random()<x?n:i}return{...a,leg1:{homeTeamId:n.teamId,awayTeamId:i.teamId,homeScore:h.homeScore,awayScore:h.awayScore,events:h.events},leg2:null,winner:f,aggregate:`${h.homeScore}-${h.awayScore}`,isFinalResult:!0}}const r=uD(n,i),o=uD(i,n),l=r.homeScore+o.awayScore,c=r.awayScore+o.homeScore;let u;if(l>c)u=n;else if(c>l)u=i;else{const h=o.awayScore,f=r.awayScore;if(h>f)u=n;else if(f>h)u=i;else{const m=n.reputation||70,A=i.reputation||70;u=Math.random()<m/(m+A)?n:i}}return{...a,leg1:{homeTeamId:n.teamId,awayTeamId:i.teamId,homeScore:r.homeScore,awayScore:r.awayScore,events:r.events},leg2:{homeTeamId:i.teamId,awayTeamId:n.teamId,homeScore:o.homeScore,awayScore:o.awayScore,events:o.events},winner:u,aggregate:`${l}-${c}`}}function Fg(a,e=null){const n=[],i=[];let s=null;for(const r of a)if(e&&(r.team1.teamId===e||r.team2.teamId===e))s=r,n.push(r);else{const l=LF(r);n.push(l),i.push(l.winner)}return{results:n,winners:i,playerMatchup:s}}function mP(a){const e={};for(const[n,i]of Object.entries(sZ)){const s=a[n]||[];if(s.length<4){e[n]=null;continue}const{matchdays:r,pots:o}=oZ(s);e[n]={id:n,config:i,teams:s,pots:o,phase:"league",currentMatchday:0,matchdays:r,results:[],standings:s.map(l=>({teamId:l.teamId,teamName:l.teamName||l.name,shortName:l.shortName||"",league:l.league||"",reputation:l.reputation||70,played:0,won:0,drawn:0,lost:0,goalsFor:0,goalsAgainst:0,goalDifference:0,points:0})),qualification:null,playoffMatchups:[],playoffResults:[],r16Matchups:[],r16Results:[],qfMatchups:[],qfResults:[],sfMatchups:[],sfResults:[],finalMatchup:null,finalResult:null,prizesMoney:{}}}return{competitions:e,initialized:!0,season:null}}function Oye(a,e,n){if(!a||a.phase!=="league")return{updatedState:a,playerMatch:null};const i=e-1;if(i<0||i>=a.matchdays.length)return{updatedState:a,playerMatch:null};const s=a.matchdays[i],r=[...a.results];let o=null;const l=new Map;a.teams.forEach(h=>l.set(h.teamId,h));for(const h of s){const f=l.get(h.homeTeamId),m=l.get(h.awayTeamId);if(!f||!m)continue;if(n&&(h.homeTeamId===n||h.awayTeamId===n)){o={...h,homeTeam:f,awayTeam:m,isHome:h.homeTeamId===n,competitionId:a.id,competitionName:a.config.name,matchday:e};continue}const x=Fye(f,m);r.push({matchday:e,homeTeamId:h.homeTeamId,awayTeamId:h.awayTeamId,homeScore:x.homeScore,awayScore:x.awayScore,events:x.events})}const c=pP(a.teams,r),u={...a.prizesMoney};e===1&&a.teams.forEach(h=>{u[h.teamId]=(u[h.teamId]||0)+a.config.prizes.participation});for(const h of r.filter(f=>f.matchday===e))h.homeScore>h.awayScore?u[h.homeTeamId]=(u[h.homeTeamId]||0)+a.config.prizes.winBonus:h.homeScore<h.awayScore?u[h.awayTeamId]=(u[h.awayTeamId]||0)+a.config.prizes.winBonus:(u[h.homeTeamId]=(u[h.homeTeamId]||0)+a.config.prizes.drawBonus,u[h.awayTeamId]=(u[h.awayTeamId]||0)+a.config.prizes.drawBonus);return{updatedState:{...a,currentMatchday:e,results:r,standings:c,prizesMoney:u},playerMatch:o}}function Fye(a,e){const n=HG(a),i=HG(e);return jl(a.teamId||a.id,e.teamId||e.id,n,i,{importance:"crucial",attendanceFillRate:.85})}function HG(a){if(a.players&&a.players.length>=11)return a;const e=a.reputation||70;return{...a,id:a.teamId||a.id,name:a.teamName||a.name||"Desconocido",players:Array.from({length:18},(n,i)=>({name:`Jugador ${i+1}`,position:["GK","CB","CB","CB","RB","LB","CM","CM","CDM","CAM","RM","LM","RW","LW","ST","ST","CF","GK"][i],overall:Math.round(e+(Math.random()*10-5)),age:22+Math.floor(Math.random()*10),stamina:80+Math.floor(Math.random()*15)}))}}function nv(a,e){if(!a)return{updatedState:null,playerMatch:null,messages:[]};const n=[];let i={...a},s=null;switch(i.phase){case"league":{if(i.currentMatchday<8)return{updatedState:i,playerMatch:null,messages:[]};const r=lZ(i.standings);i.qualification=r;const o=cZ(r.playoffSeeded,r.playoffUnseeded),l=r.direct.some(m=>m.teamId===e),c=r.eliminated.some(m=>m.teamId===e),u=[...r.playoffSeeded,...r.playoffUnseeded].some(m=>m.teamId===e);l?n.push({type:"european",title:`${i.config.icon} ${i.config.shortName}`,content:"Tu equipo se clasifica directamente para los octavos de final!"}):u?n.push({type:"european",title:`${i.config.icon} ${i.config.shortName}`,content:"Tu equipo jugar la ronda de playoffs para acceder a octavos."}):c&&n.push({type:"european",title:`${i.config.icon} ${i.config.shortName}`,content:"Tu equipo ha sido eliminado en la fase de liga."});const h={...i.prizesMoney};r.direct.forEach(m=>{h[m.teamId]=(h[m.teamId]||0)+i.config.prizes.r16}),i={...i,phase:"playoff",qualification:r,playoffMatchups:o,prizesMoney:h};const f=Fg(o,e);i.playoffResults=f.results,f.playerMatchup&&(s=f.playerMatchup);break}case"playoff":{if(!(i.playoffResults.length>0&&i.playoffResults.every(f=>f.winner!=null)))return{updatedState:i,playerMatch:null,messages:[]};const o=i.playoffResults.filter(f=>f.winner).map(f=>f.winner),l=[...i.qualification.direct,...o],c=A_(l,{avoidSameLeague:!0}),u={...i.prizesMoney};o.forEach(f=>{u[f.teamId]=(u[f.teamId]||0)+i.config.prizes.r16}),i={...i,phase:"r16",r16Matchups:c,prizesMoney:u};const h=Fg(c,e);i.r16Results=h.results,h.playerMatchup&&(s=h.playerMatchup);break}case"r16":{if(!(i.r16Results.length>0&&i.r16Results.every(h=>h.winner!=null)))return{updatedState:i,playerMatch:null,messages:[]};const o=i.r16Results.filter(h=>h.winner).map(h=>h.winner),l=A_(o,{avoidSameLeague:!0}),c={...i.prizesMoney};o.forEach(h=>{c[h.teamId]=(c[h.teamId]||0)+i.config.prizes.qf}),i={...i,phase:"qf",qfMatchups:l,prizesMoney:c};const u=Fg(l,e);i.qfResults=u.results,u.playerMatchup&&(s=u.playerMatchup);break}case"qf":{if(!(i.qfResults.length>0&&i.qfResults.every(h=>h.winner!=null)))return{updatedState:i,playerMatch:null,messages:[]};const o=i.qfResults.filter(h=>h.winner).map(h=>h.winner),l=A_(o,{avoidSameLeague:!1}),c={...i.prizesMoney};o.forEach(h=>{c[h.teamId]=(c[h.teamId]||0)+i.config.prizes.sf}),i={...i,phase:"sf",sfMatchups:l,prizesMoney:c};const u=Fg(l,e);i.sfResults=u.results,u.playerMatchup&&(s=u.playerMatchup);break}case"sf":{if(!(i.sfResults.length>0&&i.sfResults.every(h=>h.winner!=null)))return{updatedState:i,playerMatch:null,messages:[]};const o=i.sfResults.filter(h=>h.winner).map(h=>h.winner);if(o.length<2){i.phase="completed";break}const l={id:"final",team1:o[0],team2:o[1],isFinal:!0,leg1:null,leg2:null,winner:null,aggregate:null},c={...i.prizesMoney};if(o.forEach(h=>{c[h.teamId]=(c[h.teamId]||0)+i.config.prizes.final}),i={...i,phase:"final",finalMatchup:l,prizesMoney:c},o.some(h=>h.teamId===e))s=l;else{const h=LF(l);i.finalResult=h,i.phase="completed",h.winner&&(i.prizesMoney[h.winner.teamId]=(i.prizesMoney[h.winner.teamId]||0)+i.config.prizes.winnerExtra),n.push({type:"european",title:`${i.config.icon} ${i.config.shortName}  Final!`,content:`${h.winner?.teamName||"Desconocido"} gana la ${i.config.name} (${h.aggregate})`})}break}case"final":{i.phase="completed";break}}return{updatedState:i,playerMatch:s,messages:n}}function WG(a,e,n){const i=[...a.results,{matchday:n,homeTeamId:e.homeTeamId,awayTeamId:e.awayTeamId,homeScore:e.homeScore,awayScore:e.awayScore,events:e.events||[]}],s=pP(a.teams,i),r={...a.prizesMoney};return e.homeScore>e.awayScore?r[e.homeTeamId]=(r[e.homeTeamId]||0)+a.config.prizes.winBonus:e.homeScore<e.awayScore?r[e.awayTeamId]=(r[e.awayTeamId]||0)+a.config.prizes.winBonus:(r[e.homeTeamId]=(r[e.homeTeamId]||0)+a.config.prizes.drawBonus,r[e.awayTeamId]=(r[e.awayTeamId]||0)+a.config.prizes.drawBonus),{...a,results:i,standings:s,prizesMoney:r}}function $G(a,e,n){const i={...a},r={playoff:"playoffResults",r16:"r16Results",qf:"qfResults",sf:"sfResults",final:"finalResult"}[n];if(!r)return i;const o=new Map;i.teams.forEach(f=>o.set(f.teamId,f));const l=o.get(e.homeTeamId),c=o.get(e.awayTeamId);let u;if(e.homeScore>e.awayScore)u=l||{teamId:e.homeTeamId,teamName:e.homeTeamId};else if(e.awayScore>e.homeScore)u=c||{teamId:e.awayTeamId,teamName:e.awayTeamId};else{const f=l?.reputation||70,m=c?.reputation||70;u=Math.random()<f/(f+m)?l:c}const h={team1:l||{teamId:e.homeTeamId},team2:c||{teamId:e.awayTeamId},leg1:{homeTeamId:e.homeTeamId,awayTeamId:e.awayTeamId,homeScore:e.homeScore,awayScore:e.awayScore},leg2:null,winner:u,aggregate:`${e.homeScore}-${e.awayScore}`,isFinalResult:n==="final"};return n==="final"?(i.finalResult=h,u&&(i.prizesMoney={...i.prizesMoney},i.prizesMoney[u.teamId]=(i.prizesMoney[u.teamId]||0)+i.config.prizes.winnerExtra),i.phase="completed"):i[r]=(i[r]||[]).map(f=>{const m=[f.team1?.teamId,f.team2?.teamId];return(m.includes(e.homeTeamId)||m.includes(e.awayTeamId))&&!f.winner?{...f,...h,id:f.id}:f}),i}function uZ(a,e){if(!a)return!1;const n=a.phase;if(n==="league")return a.teams.some(o=>o.teamId===e);if(n==="completed")return!1;const i=a.qualification;if(!i||i.eliminated?.some(o=>o.teamId===e))return!1;const s=["playoff","r16","qf","sf","final"],r=s.indexOf(n);for(let o=0;o<=r;o++){const l=s[o],c=l==="final"?"finalResult":`${l}Results`,u=a[c];if(!u)continue;if(l==="final")return u&&u.winner?u.winner.teamId===e:a.finalMatchup&&(a.finalMatchup.team1.teamId===e||a.finalMatchup.team2.teamId===e);const h=u.find(f=>f.team1?.teamId===e||f.team2?.teamId===e);if(h&&h.winner&&h.winner.teamId!==e)return!1}return!0}function gP(a,e){if(!a?.competitions)return null;for(const[n,i]of Object.entries(a.competitions))if(i&&i.teams.some(s=>s.teamId===e))return{competitionId:n,state:i};return null}const jye={id:"copaLibertadores",name:"South American Champions Cup",shortName:"Libertadores",icon:"",color:"#1a237e",teamsCount:32,potsCount:4,matchesPerTeam:8,prizes:{participation:3e6,winBonus:1e6,drawBonus:33e4,r16:15e5,qf:2e6,sf:25e5,final:6e6,winnerExtra:6e6}},Bye={id:"copaSudamericana",name:"Copa Sudamericana",shortName:"Sudamericana",icon:"",color:"#e65100",teamsCount:32,potsCount:4,matchesPerTeam:8,prizes:{participation:9e5,winBonus:3e5,drawBonus:1e5,r16:5e5,qf:7e5,sf:1e6,final:2e6,winnerExtra:4e6}},dZ={copaLibertadores:jye,copaSudamericana:Bye},kT={argentinaPrimera:{leagueId:"argentinaPrimera",name:"Liga Profesional",country:"Argentina",copaLibertadores:6,copaSudamericana:6},brasileiraoA:{leagueId:"brasileiraoA",name:"Srie A",country:"Brasil",copaLibertadores:6,copaSudamericana:6},colombiaPrimera:{leagueId:"colombiaPrimera",name:"Liga BetPlay",country:"Colombia",copaLibertadores:4,copaSudamericana:4},chilePrimera:{leagueId:"chilePrimera",name:"Primera Divisin",country:"Chile",copaLibertadores:3,copaSudamericana:3},uruguayPrimera:{leagueId:"uruguayPrimera",name:"Primera Divisin",country:"Uruguay",copaLibertadores:3,copaSudamericana:3},ecuadorLigaPro:{leagueId:"ecuadorLigaPro",name:"LigaPro",country:"Ecuador",copaLibertadores:3,copaSudamericana:3},paraguayPrimera:{leagueId:"paraguayPrimera",name:"Divisin de Honor",country:"Paraguay",copaLibertadores:3,copaSudamericana:3},peruLiga1:{leagueId:"peruLiga1",name:"Liga 1",country:"Per",copaLibertadores:2,copaSudamericana:2},boliviaPrimera:{leagueId:"boliviaPrimera",name:"Divisin Profesional",country:"Bolivia",copaLibertadores:1,copaSudamericana:2},venezuelaPrimera:{leagueId:"venezuelaPrimera",name:"Liga FUTVE",country:"Venezuela",copaLibertadores:1,copaSudamericana:2}},Vp={league:[6,9,12,15,18,21,24,27],playoff:[31,33],r16:[35,37],qf:[39,41],sf:[43,45],final:[47]};[...Vp.league,...Vp.playoff,...Vp.r16,...Vp.qf,...Vp.sf,...Vp.final];const Uye=new Set(Object.keys(kT));function fm(a){return Uye.has(a)}function AP(a,e={}){const n={copaLibertadores:[],copaSudamericana:[]};for(const[i,s]of Object.entries(kT)){const r=a[i];if(!r||r.length===0)continue;for(let l=0;l<s.copaLibertadores&&l<r.length;l++){const c=r[l],u=e[c.teamId]||{};n.copaLibertadores.push({teamId:c.teamId,teamName:c.teamName||u.name||c.teamId,shortName:c.shortName||u.shortName||"",league:i,leaguePosition:l+1,reputation:u.reputation||c.reputation||70,overall:u.overall||c.overall||70,players:u.players||[],...u})}const o=s.copaLibertadores;for(let l=o;l<o+s.copaSudamericana&&l<r.length;l++){const c=r[l],u=e[c.teamId]||{};n.copaSudamericana.push({teamId:c.teamId,teamName:c.teamName||u.name||c.teamId,shortName:c.shortName||u.shortName||"",league:i,leaguePosition:l+1,reputation:u.reputation||c.reputation||70,overall:u.overall||c.overall||70,players:u.players||[],...u})}}return n}function yP(a){const e={};for(const[n,i]of Object.entries(dZ)){const s=a[n]||[];if(s.length<4){e[n]=null;continue}const{matchdays:r,pots:o}=oZ(s);e[n]={id:n,config:i,teams:s,pots:o,phase:"league",currentMatchday:0,matchdays:r,results:[],standings:s.map(l=>({teamId:l.teamId,teamName:l.teamName||l.name,shortName:l.shortName||"",league:l.league||"",reputation:l.reputation||70,played:0,won:0,drawn:0,lost:0,goalsFor:0,goalsAgainst:0,goalDifference:0,points:0})),qualification:null,playoffMatchups:[],playoffResults:[],r16Matchups:[],r16Results:[],qfMatchups:[],qfResults:[],sfMatchups:[],sfResults:[],finalMatchup:null,finalResult:null,prizesMoney:{}}}return{competitions:e,initialized:!0,season:null}}function Vye(a,e,n){if(!a||a.phase!=="league")return{updatedState:a,playerMatch:null};const i=e-1;if(i<0||i>=a.matchdays.length)return{updatedState:a,playerMatch:null};const s=a.matchdays[i],r=[...a.results];let o=null;const l=new Map;a.teams.forEach(h=>l.set(h.teamId,h));for(const h of s){const f=l.get(h.homeTeamId),m=l.get(h.awayTeamId);if(!f||!m)continue;if(n&&(h.homeTeamId===n||h.awayTeamId===n)){o={...h,homeTeam:f,awayTeam:m,isHome:h.homeTeamId===n,competitionId:a.id,competitionName:a.config.name,matchday:e};continue}const x=zye(f,m);r.push({matchday:e,homeTeamId:h.homeTeamId,awayTeamId:h.awayTeamId,homeScore:x.homeScore,awayScore:x.awayScore,events:x.events})}const c=pP(a.teams,r),u={...a.prizesMoney};e===1&&a.teams.forEach(h=>{u[h.teamId]=(u[h.teamId]||0)+a.config.prizes.participation});for(const h of r.filter(f=>f.matchday===e))h.homeScore>h.awayScore?u[h.homeTeamId]=(u[h.homeTeamId]||0)+a.config.prizes.winBonus:h.homeScore<h.awayScore?u[h.awayTeamId]=(u[h.awayTeamId]||0)+a.config.prizes.winBonus:(u[h.homeTeamId]=(u[h.homeTeamId]||0)+a.config.prizes.drawBonus,u[h.awayTeamId]=(u[h.awayTeamId]||0)+a.config.prizes.drawBonus);return{updatedState:{...a,currentMatchday:e,results:r,standings:c,prizesMoney:u},playerMatch:o}}function zye(a,e){const n=KG(a),i=KG(e);return jl(a.teamId||a.id,e.teamId||e.id,n,i,{importance:"crucial",attendanceFillRate:.85})}function KG(a){if(a.players&&a.players.length>=11)return a;const e=a.reputation||70;return{...a,id:a.teamId||a.id,name:a.teamName||a.name||"Desconocido",players:Array.from({length:18},(n,i)=>({name:`Jugador ${i+1}`,position:["GK","CB","CB","CB","RB","LB","CM","CM","CDM","CAM","RM","LM","RW","LW","ST","ST","CF","GK"][i],overall:Math.round(e+(Math.random()*10-5)),age:22+Math.floor(Math.random()*10),stamina:80+Math.floor(Math.random()*15)}))}}function Ub(a,e){if(!a)return{updatedState:null,playerMatch:null,messages:[]};const n=[];let i={...a},s=null;switch(i.phase){case"league":{if(i.currentMatchday<8)return{updatedState:i,playerMatch:null,messages:[]};const r=lZ(i.standings);i.qualification=r;const o=cZ(r.playoffSeeded,r.playoffUnseeded),l=r.direct.some(m=>m.teamId===e),c=r.eliminated.some(m=>m.teamId===e),u=[...r.playoffSeeded,...r.playoffUnseeded].some(m=>m.teamId===e);l?n.push({type:"southamerican",title:`${i.config.icon} ${i.config.shortName}`,content:"Tu equipo se clasifica directamente para los octavos de final!"}):u?n.push({type:"southamerican",title:`${i.config.icon} ${i.config.shortName}`,content:"Tu equipo jugar la ronda de playoffs para acceder a octavos."}):c&&n.push({type:"southamerican",title:`${i.config.icon} ${i.config.shortName}`,content:"Tu equipo ha sido eliminado en la fase de liga."});const h={...i.prizesMoney};r.direct.forEach(m=>{h[m.teamId]=(h[m.teamId]||0)+i.config.prizes.r16}),i={...i,phase:"playoff",qualification:r,playoffMatchups:o,prizesMoney:h};const f=Fg(o,e);i.playoffResults=f.results,f.playerMatchup&&(s=f.playerMatchup);break}case"playoff":{if(!(i.playoffResults.length>0&&i.playoffResults.every(f=>f.winner!=null)))return{updatedState:i,playerMatch:null,messages:[]};const o=i.playoffResults.filter(f=>f.winner).map(f=>f.winner),l=[...i.qualification.direct,...o],c=A_(l,{avoidSameLeague:!0}),u={...i.prizesMoney};o.forEach(f=>{u[f.teamId]=(u[f.teamId]||0)+i.config.prizes.r16}),i={...i,phase:"r16",r16Matchups:c,prizesMoney:u};const h=Fg(c,e);i.r16Results=h.results,h.playerMatchup&&(s=h.playerMatchup);break}case"r16":{if(!(i.r16Results.length>0&&i.r16Results.every(h=>h.winner!=null)))return{updatedState:i,playerMatch:null,messages:[]};const o=i.r16Results.filter(h=>h.winner).map(h=>h.winner),l=A_(o,{avoidSameLeague:!0}),c={...i.prizesMoney};o.forEach(h=>{c[h.teamId]=(c[h.teamId]||0)+i.config.prizes.qf}),i={...i,phase:"qf",qfMatchups:l,prizesMoney:c};const u=Fg(l,e);i.qfResults=u.results,u.playerMatchup&&(s=u.playerMatchup);break}case"qf":{if(!(i.qfResults.length>0&&i.qfResults.every(h=>h.winner!=null)))return{updatedState:i,playerMatch:null,messages:[]};const o=i.qfResults.filter(h=>h.winner).map(h=>h.winner),l=A_(o,{avoidSameLeague:!1}),c={...i.prizesMoney};o.forEach(h=>{c[h.teamId]=(c[h.teamId]||0)+i.config.prizes.sf}),i={...i,phase:"sf",sfMatchups:l,prizesMoney:c};const u=Fg(l,e);i.sfResults=u.results,u.playerMatchup&&(s=u.playerMatchup);break}case"sf":{if(!(i.sfResults.length>0&&i.sfResults.every(h=>h.winner!=null)))return{updatedState:i,playerMatch:null,messages:[]};const o=i.sfResults.filter(h=>h.winner).map(h=>h.winner);if(o.length<2){i.phase="completed";break}const l={id:"final",team1:o[0],team2:o[1],isFinal:!0,leg1:null,leg2:null,winner:null,aggregate:null},c={...i.prizesMoney};if(o.forEach(h=>{c[h.teamId]=(c[h.teamId]||0)+i.config.prizes.final}),i={...i,phase:"final",finalMatchup:l,prizesMoney:c},o.some(h=>h.teamId===e))s=l;else{const h=LF(l);i.finalResult=h,i.phase="completed",h.winner&&(i.prizesMoney[h.winner.teamId]=(i.prizesMoney[h.winner.teamId]||0)+i.config.prizes.winnerExtra),n.push({type:"southamerican",title:`${i.config.icon} ${i.config.shortName}  Final!`,content:`${h.winner?.teamName||"Desconocido"} gana la ${i.config.name} (${h.aggregate})`})}break}case"final":{i.phase="completed";break}}return{updatedState:i,playerMatch:s,messages:n}}function YG(a,e,n){const i=[...a.results,{matchday:n,homeTeamId:e.homeTeamId,awayTeamId:e.awayTeamId,homeScore:e.homeScore,awayScore:e.awayScore,events:e.events||[]}],s=pP(a.teams,i),r={...a.prizesMoney};return e.homeScore>e.awayScore?r[e.homeTeamId]=(r[e.homeTeamId]||0)+a.config.prizes.winBonus:e.homeScore<e.awayScore?r[e.awayTeamId]=(r[e.awayTeamId]||0)+a.config.prizes.winBonus:(r[e.homeTeamId]=(r[e.homeTeamId]||0)+a.config.prizes.drawBonus,r[e.awayTeamId]=(r[e.awayTeamId]||0)+a.config.prizes.drawBonus),{...a,results:i,standings:s,prizesMoney:r}}function XG(a,e,n){const i={...a},r={playoff:"playoffResults",r16:"r16Results",qf:"qfResults",sf:"sfResults",final:"finalResult"}[n];if(!r)return i;const o=new Map;i.teams.forEach(f=>o.set(f.teamId,f));const l=o.get(e.homeTeamId),c=o.get(e.awayTeamId);let u;if(e.homeScore>e.awayScore)u=l||{teamId:e.homeTeamId,teamName:e.homeTeamId};else if(e.awayScore>e.homeScore)u=c||{teamId:e.awayTeamId,teamName:e.awayTeamId};else{const f=l?.reputation||70,m=c?.reputation||70;u=Math.random()<f/(f+m)?l:c}const h={team1:l||{teamId:e.homeTeamId},team2:c||{teamId:e.awayTeamId},leg1:{homeTeamId:e.homeTeamId,awayTeamId:e.awayTeamId,homeScore:e.homeScore,awayScore:e.awayScore},leg2:null,winner:u,aggregate:`${e.homeScore}-${e.awayScore}`,isFinalResult:n==="final"};return n==="final"?(i.finalResult=h,u&&(i.prizesMoney={...i.prizesMoney},i.prizesMoney[u.teamId]=(i.prizesMoney[u.teamId]||0)+i.config.prizes.winnerExtra),i.phase="completed"):i[r]=(i[r]||[]).map(f=>{const m=[f.team1?.teamId,f.team2?.teamId];return(m.includes(e.homeTeamId)||m.includes(e.awayTeamId))&&!f.winner?{...f,...h,id:f.id}:f}),i}function QG(){const a={};return Vp.league.forEach((n,i)=>{a[n]={phase:"league",matchday:i+1,isLeague:!0,isKnockout:!1}}),["playoff","r16","qf","sf","final"].forEach(n=>{Vp[n].forEach((i,s)=>{a[i]={phase:n,leg:s+1,isLeague:!1,isKnockout:!0}})}),a}function Gye(a,e){if(!a)return!1;const n=a.phase;if(n==="league")return a.teams.some(o=>o.teamId===e);if(n==="completed")return!1;const i=a.qualification;if(!i||i.eliminated?.some(o=>o.teamId===e))return!1;const s=["playoff","r16","qf","sf","final"],r=s.indexOf(n);for(let o=0;o<=r;o++){const l=s[o],c=l==="final"?"finalResult":`${l}Results`,u=a[c];if(!u)continue;if(l==="final")return u&&u.winner?u.winner.teamId===e:a.finalMatchup&&(a.finalMatchup.team1.teamId===e||a.finalMatchup.team2.teamId===e);const h=u.find(f=>f.team1?.teamId===e||f.team2?.teamId===e);if(h&&h.winner&&h.winner.teamId!==e)return!1}return!0}function vP(a,e){if(!a?.competitions)return null;for(const[n,i]of Object.entries(a.competitions))if(i&&i.teams.some(s=>s.teamId===e))return{competitionId:n,state:i};return null}const hZ={Espaa:{id:"copaDelRey",name:"National Cup",icon:"",shortName:"Copa"},Inglaterra:{id:"faCup",name:"FA Cup",icon:"",shortName:"FA Cup"},Italia:{id:"coppaItalia",name:"Coppa Italia",icon:"",shortName:"Coppa"},Alemania:{id:"dfbPokal",name:"DFB-Pokal",icon:"",shortName:"Pokal"},Francia:{id:"coupeDeFrance",name:"Coupe de France",icon:"",shortName:"Coupe"},"Pases Bajos":{id:"knvbBeker",name:"KNVB Beker",icon:"",shortName:"Beker"},Portugal:{id:"tacaPortugal",name:"Taa de Portugal",icon:"",shortName:"Taa"},Blgica:{id:"bekerBelgie",name:"Beker van Belgi",icon:"",shortName:"Beker"},Turqua:{id:"turkishCup",name:"Trkiye Kupas",icon:"",shortName:"Kupa"},Escocia:{id:"scottishCup",name:"Scottish Cup",icon:"",shortName:"Scottish Cup"},Suiza:{id:"swissCup",name:"Schweizer Cup",icon:"",shortName:"Cup"},Austria:{id:"oefbCup",name:"FB Cup",icon:"",shortName:"FB Cup"},Grecia:{id:"greekCup",name:" ",icon:"",shortName:"Cup"},Dinamarca:{id:"danishCup",name:"DBU Pokalen",icon:"",shortName:"Pokalen"},Croacia:{id:"croatianCup",name:"Hrvatski kup",icon:"",shortName:"Kup"},Chequia:{id:"czechCup",name:"MOL Cup",icon:"",shortName:"MOL Cup"},Argentina:{id:"copaArgentina",name:"Copa Argentina",icon:"",shortName:"Copa"},Brasil:{id:"copaDoBrasil",name:"Copa do Brasil",icon:"",shortName:"Copa"},Colombia:{id:"copaColombia",name:"Copa Colombia",icon:"",shortName:"Copa"},Chile:{id:"copaChile",name:"Copa Chile",icon:"",shortName:"Copa"},Uruguay:{id:"copaUruguay",name:"Copa Uruguay",icon:"",shortName:"Copa"},Ecuador:{id:"copaEcuador",name:"Copa Ecuador",icon:"",shortName:"Copa"},Paraguay:{id:"copaParaguay",name:"Copa Paraguay",icon:"",shortName:"Copa"},Per:{id:"copaPeru",name:"Copa Per",icon:"",shortName:"Copa"},Bolivia:{id:"copaBolivia",name:"Copa Bolivia",icon:"",shortName:"Copa"},Venezuela:{id:"copaVenezuela",name:"Copa Venezuela",icon:"",shortName:"Copa"}},qye=["primeraRFEF","segundaRFEF"],HC={};Object.entries(Wa).forEach(([a,e])=>{e.country&&(HC[e.country]||(HC[e.country]=[]),HC[e.country].push({id:a,isGroupLeague:!!e.isGroupLeague,teams:e.teams||0}))});Object.values(HC).forEach(a=>{a.sort((e,n)=>e.isGroupLeague!==n.isGroupLeague?e.isGroupLeague?1:-1:0)});function OT(a,e,n,i){const s=Wa[a];if(!s||!s.country)return null;const r=s.country,o=hZ[r];if(!o)return null;const c=Object.entries(Wa).filter(([f,m])=>m.country===r&&!qye.includes(f)).sort((f,m)=>{const A=!!f[1].zones?.champions,x=!!m[1].zones?.champions;return A!==x?A?-1:1:0}).slice(0,2),u=[],h=new Set;for(const[f,m]of c)if(f===a){const A=i||[],x=m.getTeams?m.getTeams():[];for(const T of A){if(h.has(T.teamId))continue;const E=x.find(M=>M.id===T.teamId);E&&(u.push({teamId:E.id,teamName:E.name,shortName:E.shortName||E.name?.substring(0,3).toUpperCase(),reputation:E.reputation||70,players:E.players||[],leagueId:f,leaguePosition:A.indexOf(T)+1,isFirstDivision:!!m.zones?.champions}),h.add(T.teamId))}}else{const A=n?.[f],x=m.getTeams?m.getTeams():[];if(A?.table?.length>0)for(const T of A.table){if(h.has(T.teamId))continue;const E=x.find(M=>M.id===T.teamId);E&&(u.push({teamId:E.id,teamName:E.name,shortName:E.shortName||E.name?.substring(0,3).toUpperCase(),reputation:E.reputation||70,players:E.players||[],leagueId:f,leaguePosition:A.table.indexOf(T)+1,isFirstDivision:!!m.zones?.champions}),h.add(T.teamId))}else for(const T of x)h.has(T.id)||(u.push({teamId:T.id,teamName:T.name,shortName:T.shortName||T.name?.substring(0,3).toUpperCase(),reputation:T.reputation||70,players:T.players||[],leagueId:f,leaguePosition:x.indexOf(T)+1,isFirstDivision:!!m.zones?.champions}),h.add(T.id))}return e&&!h.has(e.id)&&u.push({teamId:e.id,teamName:e.name,shortName:e.shortName||e.name?.substring(0,3).toUpperCase(),reputation:e.reputation||70,players:e.players||[],leagueId:a,leaguePosition:99,isFirstDivision:!1}),{teams:u,cupConfig:o,country:r}}function FT(a,e){if(!a||a.length<2)return null;const n=a.length,i=Math.ceil(Math.log2(n)),s=Math.pow(2,i),r=s-n,o=[...a].sort((H,X)=>H.isFirstDivision!==X.isFirstDivision?H.isFirstDivision?-1:1:X.reputation!==H.reputation?X.reputation-H.reputation:H.leaguePosition-X.leaguePosition),l=o.slice(0,r),c=o.slice(r),u=c.filter(H=>H.isFirstDivision),h=c.filter(H=>!H.isFirstDivision),f=s/2,m=H=>{const X=[...H];for(let ne=X.length-1;ne>0;ne--){const Q=Math.floor(Math.random()*(ne+1));[X[ne],X[Q]]=[X[Q],X[ne]]}return X},A=m(u),x=m(h),T=[],E=new Set,M=new Set;for(let H=0;H<A.length&&H<x.length;H++)T.push({home:x[H],away:A[H]}),E.add(H),M.add(H);const N=A.filter((H,X)=>!E.has(X)),I=x.filter((H,X)=>!M.has(X)),F=m([...N,...I]);for(let H=0;H<F.length;H+=2)H+1<F.length&&T.push({home:F[H],away:F[H+1]});const G=[],O=[];let D=0,j=0;const L=m(l);for(let H=0;H<f;H++)j<L.length?(O.push({id:`cup_r0_m${H}`,homeTeam:L[j],awayTeam:null,homeScore:null,awayScore:null,played:!0,bye:!0,winnerId:L[j].teamId}),j++):D<T.length&&(O.push({id:`cup_r0_m${H}`,homeTeam:T[D].home,awayTeam:T[D].away,homeScore:null,awayScore:null,played:!1,bye:!1,winnerId:null}),D++);G.push({name:JG(0,i),matches:O});for(let H=1;H<i;H++){const X=Math.pow(2,i-H-1),ne=[];for(let Q=0;Q<X;Q++)ne.push({id:`cup_r${H}_m${Q}`,homeTeam:null,awayTeam:null,homeScore:null,awayScore:null,played:!1,bye:!1,winnerId:null});G.push({name:JG(H,i),matches:ne})}const U=a.find(H=>H.teamId===e),q=U?.leagueId?Wa[U.leagueId]?.country:null;return{config:{...q?hZ[q]:{name:"Copa",icon:"",shortName:"Copa"},country:q},rounds:G,currentRound:0,playerTeamId:e,playerEliminated:!1,winner:null}}function fZ(a,e,n,i){if(!a||!a.rounds[e])return{updatedBracket:a,playerMatch:null};const s={...a.rounds[e]},r=[...s.matches];let o=null;for(let h=0;h<r.length;h++){const f=r[h];if(f.played||f.bye||!f.homeTeam||!f.awayTeam)continue;if((f.homeTeam.teamId===n||f.awayTeam.teamId===n)&&!a.playerEliminated){o={...f,roundIdx:e,matchIdx:h};continue}const A=eq(f.homeTeam,i),x=eq(f.awayTeam,i),T=jl(f.homeTeam.teamId,f.awayTeam.teamId,A,x,{homeMorale:70,awayMorale:70});let E=T.homeScore,M=T.awayScore,N;if(E===M){const I=f.homeTeam.reputation||70,F=f.awayTeam.reputation||70,G=.5+(I-F)/200;N=Math.random()<G?f.homeTeam.teamId:f.awayTeam.teamId,N===f.homeTeam.teamId&&(E=E+0)}else N=E>M?f.homeTeam.teamId:f.awayTeam.teamId;r[h]={...f,homeScore:E,awayScore:M,played:!0,winnerId:N,penalties:E===M}}const l={...s,matches:r},c=[...a.rounds];return c[e]=l,{updatedBracket:mZ({...a,rounds:c},e),playerMatch:o}}function pZ(a,e,n,i,s,r){if(!a||!a.rounds[e])return a;const o=a.rounds[e].matches[n];if(!o)return a;let l,c=!1;if(i===s){const T=o.homeTeam.teamId===r;l=Math.random()<.55?r:T?o.awayTeam.teamId:o.homeTeam.teamId,c=!0}else l=i>s?o.homeTeam.teamId:o.awayTeam.teamId;const u={...o,homeScore:i,awayScore:s,played:!0,winnerId:l,penalties:c},h=[...a.rounds],f={...h[e]},m=[...f.matches];m[n]=u,f.matches=m,h[e]=f;let A={...a,rounds:h};l!==r&&(A.playerEliminated=!0),A=mZ(A,e);const x=A.rounds[A.rounds.length-1];return x.matches.length===1&&x.matches[0].played&&(A.winner=x.matches[0].winnerId),A}function mZ(a,e){if(e>=a.rounds.length-1){const l=a.rounds[a.rounds.length-1];return l.matches.length===1&&l.matches[0].played?{...a,winner:l.matches[0].winnerId}:a}const n=a.rounds[e],i=a.rounds[e+1];if(!n.matches.every(l=>l.played||l.bye))return a;const r=[...i.matches];for(let l=0;l<n.matches.length;l+=2){const c=n.matches[l],u=n.matches[l+1],h=Math.floor(l/2);if(h<r.length){const f=c?ZG(c):null,m=u?ZG(u):null;r[h]={...r[h],homeTeam:f,awayTeam:m}}}const o=[...a.rounds];return o[e+1]={...i,matches:r},{...a,rounds:o,currentRound:e+1}}function JG(a,e){switch(e-a){case 1:return"Final";case 2:return"Semifinales";case 3:return"Cuartos de Final";case 4:return"Octavos de Final";case 5:return"Dieciseisavos";case 6:return"Treintaidosavos";default:return`Ronda ${a+1}`}}function ZG(a){return a?a.bye&&a.homeTeam?a.homeTeam:!a.played||!a.winnerId?null:a.homeTeam?.teamId===a.winnerId?a.homeTeam:a.awayTeam?.teamId===a.winnerId?a.awayTeam:null:null}function eq(a,e){if(!a)return{id:"unknown",name:"Desconocido",players:[],reputation:60};const n=e?.[a.teamId];return n?{...n,id:n.id||a.teamId,name:n.name||a.teamName}:{id:a.teamId,name:a.teamName,shortName:a.shortName,reputation:a.reputation||70,players:a.players||Hye(a.reputation||70)}}function Hye(a){return["GK","CB","CB","CB","RB","LB","CM","CM","CDM","CAM","RM","LM","RW","LW","ST","ST","CF","GK"].map((n,i)=>({name:`Jugador ${i+1}`,position:n,overall:Math.round(a+(Math.random()*10-5)),age:22+Math.floor(Math.random()*10),stamina:80+Math.floor(Math.random()*15)}))}const tq=3,Wye=38;function fN(a,e){const n=co(a,e);let i=.15;a.age<=21?i+=.05:a.age<=23&&(i+=.03),a.overall>=82?i+=.05:a.overall>=78&&(i+=.03);const s=a.contractYears||2;s>=4?i+=.05:s<=1&&(i-=.05),i=Math.max(.1,Math.min(.3,i));const r=Math.round(n*i);return Math.max(1e5,r)}function gZ(a,e){let n=.5;const i=e?.name||"Low Table";i==="Low Table"||i==="lowTable"?n=.4:i==="Mid Table"||i==="midTable"?n=.5:i==="Top Tier"||i==="topTier"?n=.6:(i==="Elite"||i==="elite")&&(n=.7);const s=a.salary||5e4;return s>2e5?n=Math.max(.3,n-.15):s>1e5&&(n=Math.max(.35,n-.1)),Math.round(n*100)/100}function $ye(a,e,n){const i=[];if(!a?.players||!e)return i;const s=a.players.filter(T=>{if(T.onLoan||T.injured||T.suspended)return!1;const E=T.age<=23,M=T.overall<pN(a.players)-2;return E||M});if(s.length===0)return i;const r=s[Math.floor(Math.random()*s.length)],l=(e instanceof Map?Array.from(e.values()):Array.isArray(e)?e:[]).filter(T=>{if(T.id===n)return!1;y_(T.name);const E=pN(T.players||[]);return r.overall>=E-5&&r.overall<=E+10&&(T.budget||0)>=1e6});if(l.length===0)return i;const c=l[Math.floor(Math.random()*l.length)],u=y_(c.name),h=fN(r,a.leagueId||""),f=gZ(r,u),m=co(r,a.leagueId||""),x=Math.random()<.6?Math.round(m*(.9+Math.random()*.3)):null;return i.push({id:`loan_offer_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,playerId:r.name,playerData:{name:r.name,position:r.position,overall:r.overall,age:r.age,salary:r.salary},fromTeamId:n,fromTeamName:a.name||"",toTeamId:c.id,toTeamName:c.name,loanFee:h,salaryShare:f,purchaseOption:x,status:"pending",createdAt:Date.now(),expiresAt:Date.now()+10080*60*1e3}),i}function Kye(a,e,n,i){let s=.5;const r=y_(a.name),o=pN(a.players||[]);e.overall<o-3?s+=.2:e.overall<o&&(s+=.1),e.age<=23&&(r.name==="Elite"||r.name==="Top Tier")&&(s+=.15),(e.contractYears||2)>=3&&(s+=.1);const l=co(e,a.leagueId);return i.loanFee>=l*.2&&(s+=.1),i.purchaseOption&&i.purchaseOption>=l*.9&&(s+=.1),r.sellReluctance>.6&&(s-=.15),e.overall>=83&&(s-=.25),s=Math.max(.1,Math.min(.9,s)),{accepted:Math.random()<s,acceptChance:Math.round(s*100),reasons:Xye(e,a,r,o)}}function nq(a,e){const n=[],i=[],s=[];for(const r of a){if(r.status!=="active"){i.push(r);continue}n.push({...r,status:"expired"}),s.push({type:"loan",title:" Cesin finalizada",content:`${r.playerData?.name||r.playerId} vuelve a ${r.fromTeamName} tras su cesin en ${r.toTeamName}`})}return{expiredLoans:n,remainingLoans:i,messages:s}}function dD(a,e,n,i,s,r){return{id:`loan_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,playerId:a.name,playerData:{name:a.name,position:a.position,overall:a.overall,age:a.age,salary:a.salary||5e4,value:a.value||0},fromTeamId:e.id||e,fromTeamName:e.name||e,toTeamId:n.id||n,toTeamName:n.name||n,loanFee:i,salaryShare:s,purchaseOption:r||null,duration:"season",startedAt:Date.now(),weeksRemaining:Wye,status:"active"}}function AZ(a,e,n="out"){const i=[];return n==="out"&&(a.injured&&i.push("No se puede ceder un jugador lesionado"),a.suspended&&i.push("No se puede ceder un jugador sancionado"),a.onLoan&&i.push("Este jugador ya est en cesin")),n==="in"&&(e.activeLoans||[]).filter(r=>r.toTeamId===e.teamId&&r.status==="active").length>=tq&&i.push(`Mximo ${tq} cesiones entrantes por temporada`),{canLoan:i.length===0,errors:i}}function Yye(a,e,n){const i=[],r=(a instanceof Map?Array.from(a.values()):Array.isArray(a)?a:[]).filter(o=>o.id!==e);for(const o of r){if(Math.random()>=.15)continue;const l=y_(o.name);if(l.name==="Elite"||l.name==="Top Tier"){const c=(o.players||[]).filter(u=>u.age<=23&&u.overall>=65&&u.overall<=75&&!u.injured&&!u.suspended&&!u.onLoan);if(c.length>0){const u=c[Math.floor(Math.random()*c.length)],h=r.filter(f=>{if(f.id===o.id)return!1;const m=y_(f.name);return m.name==="Mid Table"||m.name==="Low Table"});if(h.length>0){const f=h[Math.floor(Math.random()*h.length)],m=fN(u,o.leagueId);i.push({type:"ai_loan",player:{name:u.name,position:u.position,overall:u.overall,age:u.age},from:{id:o.id,name:o.name},to:{id:f.id,name:f.name},loanFee:m})}}}if(l.name==="Mid Table"||l.name==="Low Table"){const c=r.filter(u=>{const h=y_(u.name);return h.name==="Elite"||h.name==="Top Tier"});if(c.length>0&&Math.random()<.3){const u=c[Math.floor(Math.random()*c.length)],h=pN(u.players||[]),f=(u.players||[]).filter(m=>m.overall<h-2&&!m.injured&&!m.suspended&&!m.onLoan&&m.overall>=65);if(f.length>0){const m=f[Math.floor(Math.random()*f.length)],A=fN(m,u.leagueId);i.push({type:"ai_loan",player:{name:m.name,position:m.position,overall:m.overall,age:m.age},from:{id:u.id,name:u.name},to:{id:o.id,name:o.name},loanFee:A})}}}}return i}function y_(a){for(const[e,n]of Object.entries(dN))if(n.teams?.includes(a))return n;return dN.lowTable}function pN(a){return a.length?Math.round(a.reduce((e,n)=>e+(n.overall||70),0)/a.length):0}function Xye(a,e,n,i){const s=[];return a.overall<i-3?s.push({text:"Es suplente en su equipo",positive:!0}):s.push({text:"Es titular en su equipo",positive:!1}),a.age<=23&&s.push({text:"Joven que necesita minutos",positive:!0}),(a.contractYears||2)>=3?s.push({text:"Contrato largo, equipo tranquilo",positive:!0}):(a.contractYears||2)<=1&&s.push({text:"Contrato corto, no quieren perderlo",positive:!1}),n.sellReluctance>.6&&s.push({text:"Equipo grande, difcil negociar",positive:!1}),a.overall>=83&&s.push({text:"Jugador estrella, improbable cesin",positive:!1}),s}const yZ=ge.createContext();function ig(a,e,n){if(!a||!e||e.length<11)return a;const i={"4-3-3":["GK","RB","CB1","CB2","LB","CM1","CDM","CM2","RW","ST","LW"],"4-4-2":["GK","RB","CB1","CB2","LB","RM","CM1","CM2","LM","ST1","ST2"],"4-2-3-1":["GK","RB","CB1","CB2","LB","CDM1","CDM2","RW","CAM","LW","ST"],"3-5-2":["GK","CB1","CB2","CB3","RM","CM1","CDM","CM2","LM","ST1","ST2"],"5-3-2":["GK","RB","CB1","CB2","CB3","LB","CM1","CDM","CM2","ST1","ST2"],"4-1-4-1":["GK","RB","CB1","CB2","LB","CDM","RM","CM1","CM2","LM","ST"],"3-4-3":["GK","CB1","CB2","CB3","RM","CM1","CM2","LM","RW","ST","LW"],"5-4-1":["GK","RB","CB1","CB2","CB3","LB","RM","CM1","CM2","LM","ST"],"4-5-1":["GK","RB","CB1","CB2","LB","RM","CM1","CDM","CM2","LM","ST"],"4-3-3 (MCO)":["GK","RB","CB1","CB2","LB","CM1","CM2","CAM","RW","ST","LW"],"4-4-2 (Diamante)":["GK","RB","CB1","CB2","LB","CDM","CM1","CM2","CAM","ST1","ST2"],"4-1-2-1-2":["GK","RB","CB1","CB2","LB","CDM","CM1","CM2","CAM","ST1","ST2"]},s=i[n]||i["4-3-3"];if(Object.values(a).filter(Boolean).length>=11)return a;const o={...a},l=new Set(Object.values(o).map(u=>u?.name).filter(Boolean)),c=e.filter(u=>!l.has(u.name)&&!u.injured&&!u.suspended&&!u.onLoan);for(const u of s){if(o[u])continue;const h=Lh(u),f=c.sort((m,A)=>{const x=rc(m.position,h);return rc(A.position,h).factor*A.overall-x.factor*m.overall})[0];f&&(o[u]=f,l.add(f.name),c.splice(c.indexOf(f),1))}return o}function Vb(a){return a.askingPrice&&a.askingPrice>0?a.askingPrice:co(a,null)}typeof window<"u"&&window.Capacitor&&window.Capacitor.isNativePlatform;const Qye=!1,Zv={saveId:null,loaded:!1,managerName:`gaffer${Math.floor(Math.random()*9e9)+1e9}`,gameStarted:!1,currentWeek:1,currentSeason:1,teamId:null,team:null,leagueId:null,leagueTier:1,formation:"4-3-3",tactic:"balanced",lineup:{},convocados:[],money:0,weeklyIncome:0,weeklyExpenses:0,blockedPlayers:[],activeLoans:[],loanHistory:[],incomingLoanOffers:[],facilities:{stadium:0,training:0,youth:0,medical:0,scouting:0,sponsorship:0},facilitySpecs:{youth:null,medical:null,training:null},facilitySpecsLocked:{},facilityStats:{medical:{weeksSaved:0,injuriesPrevented:0,treatmentsApplied:0},youth:{playersGenerated:0,totalOvr:0},training:{totalProgress:0}},medicalTreatmentsUsed:0,pendingEvent:null,stadium:{level:0,seasonTickets:2400,ticketPrice:30,grassCondition:100,naming:null,lastEventWeek:0},leagueTable:[],fixtures:[],results:[],playerSeasonStats:{},otherLeagues:{segunda:{table:[],fixtures:[]},premierLeague:{table:[],fixtures:[]},serieA:{table:[],fixtures:[]},bundesliga:{table:[],fixtures:[]},ligue1:{table:[],fixtures:[]}},playerLeagueId:"laliga",playerGroupId:null,aperturaTable:null,currentTournament:"apertura",aperturaClausuraFinal:null,pendingAperturaClausuraFinal:null,transferOffers:[],playerMarket:[],freeAgents:[],managerConfidence:75,managerFired:!1,europeanCompetitions:null,pendingEuropeanMatch:null,europeanQualification:null,europeanCalendar:null,saCompetitions:null,pendingSAMatch:null,cupCompetition:null,pendingCupMatch:null,messages:[],settings:{difficulty:"normal",matchSpeed:"normal",autoSave:!0,showTutorials:!0,soundEnabled:!0,musicVolume:70,sfxVolume:80},training:{type:"balanced",intensity:null,specialPlayers:[]},seasonObjectives:[],managerRating:50,jobOffers:[],gameMode:"career",contrarrelojData:null,proManagerData:null,currentScreen:"main_menu",playerForm:{},matchTracker:{},rejectedTransfers:{}};function vZ(a,e){switch(e.type){case"LOAD_SAVE":{const n=e.payload||{},i=r=>{if(Array.isArray(r))return r;if(r&&typeof r=="object"&&!Array.isArray(r)){const o=Object.keys(r);if(o.length>0&&o.every(l=>/^\d+$/.test(l)))return o.sort((l,c)=>+l-+c).map(l=>r[l])}return r},s={...n};if(["leagueTable","fixtures","results","messages","transferOffers","playerMarket","freeAgents","seasonObjectives","jobOffers","blockedPlayers","activeLoans","loanHistory","incomingLoanOffers","convocados","preseasonMatches"].forEach(r=>{r in s&&(s[r]=i(s[r])||[])}),s.team&&s.team.players&&(s.team={...s.team,players:i(s.team.players)||[]}),s.team?.players?.length>0){const r=s.playerLeagueId||s.leagueId;if(r){const o=s.team.players,l=o.reduce((f,m)=>f+(m.salary||0),0)/o.length,c=Math.round(o.reduce((f,m)=>f+(m.overall||70),0)/o.length),u=D2({overall:c,age:27,name:"Test"},r);l<u*.3&&(console.log(` Salary migration: avg ${Math.round(l)}/wk vs expected ${u}/wk for ${r}. Recalculating.`),s.team={...s.team,players:o.map(f=>({...f,salary:D2(f,r)}))})}}return{...a,...s,loaded:!0}}case"NEW_GAME":{const n=e.payload.stadiumInfo||{name:"Estadio",capacity:8e3},i=e.payload.stadiumLevel??0,s=e.payload.leagueId,r=s?Pl(s):1,o=m=>m<=21||m<=25?Math.floor(Math.random()*3)+3:m<=28?Math.floor(Math.random()*3)+2:m<=32?Math.floor(Math.random()*2)+2:Math.floor(Math.random()*2)+1,l={...e.payload.team,players:e.payload.team.players.map(m=>({...m,role:m.role||rD(m),contractYears:m.contractYears??o(m.age||25),salary:D2(m,s||r)}))},c=IG(l.players),u={};l.players.forEach(m=>{u[m.name]={consecutivePlayed:0,weeksSincePlay:3}});const h=e.payload.gameMode||"career",f=h==="contrarreloj"?{seasonsPlayed:1,trophies:[],seasonHistory:[],totalWins:0,totalDraws:0,totalLosses:0,totalMatches:0,startTeam:{id:e.payload.teamId,name:e.payload.team?.name},startLeague:s,won:!1,finished:!1,loseReason:null,wonCompetition:null}:null;return{...Zv,gameStarted:!0,gameMode:h,contrarrelojData:f,_contrarrelojUserId:h==="contrarreloj"&&e.payload._contrarrelojUserId||null,teamId:e.payload.teamId,team:l,leagueId:s,leagueTier:r,money:l.budget,loaded:!0,currentScreen:"office",stadium:{...Zv.stadium,level:i,name:n.name,realCapacity:n.capacity,seasonTickets:Math.floor((n.capacity||8e3)*.4),seasonTicketsFinal:null,seasonTicketsCampaignOpen:!0,ticketPrice:30,grassCondition:100},facilities:{...Zv.facilities,stadium:i},preseasonMatches:e.payload.preseasonMatches||[],preseasonPhase:e.payload.preseasonPhase||!1,preseasonWeek:e.payload.preseasonPhase?1:0,playerForm:c,matchTracker:u,rejectedTransfers:{}}}case"SET_SCREEN":return{...a,currentScreen:e.payload};case"SET_RANKED_MATCH_ID":return{...a,rankedMatchId:e.payload};case"LOAD_RANKED_TEAM":{const{team:n,leagueId:i,leagueTable:s,money:r,formation:o,tactic:l,gameMode:c}=e.payload;return{...a,gameStarted:!0,gameMode:c||"ranked",teamId:n.id,team:n,leagueId:i,playerLeagueId:i,leagueTier:i?Pl(i):1,money:r||n.budget||n.transferBudget||5e6,formation:o||"4-3-3",tactic:l||"balanced",leagueTable:s||[],fixtures:[],currentScreen:"office",currentWeek:1,currentSeason:1,messages:[],seasonObjectives:[],preseasonPhase:!1}}case"CLEAR_RANKED_TEAM":return{...a,gameMode:"career",rankedMatchId:null};case"SET_PROMANAGER_DATA":return{...a,proManagerData:e.payload};case"PROMANAGER_SWITCH_TEAM":{const{team:n,leagueId:i,_proManagerUserId:s}=e.payload;return{...Zv,gameStarted:!0,gameMode:"promanager",proManagerData:a.proManagerData,_proManagerUserId:s||a._proManagerUserId,teamId:n.id,team:{...n},leagueId:i,leagueTier:i?Pl(i):1,money:n.budget||5e6,loaded:!0,currentScreen:"office",settings:a.settings,managerName:a.managerName}}case"UPDATE_PROMANAGER_CONFIDENCE":{if(!a.proManagerData)return a;const{boardConfidence:n,winStreak:i,lossStreak:s,totalMatches:r,totalWins:o,totalDraws:l,totalLosses:c}=e.payload;return{...a,proManagerData:{...a.proManagerData,boardConfidence:n??a.proManagerData.boardConfidence,winStreak:i??a.proManagerData.winStreak,lossStreak:s??a.proManagerData.lossStreak,totalMatches:r??a.proManagerData.totalMatches,totalWins:o??a.proManagerData.totalWins,totalDraws:l??a.proManagerData.totalDraws,totalLosses:c??a.proManagerData.totalLosses},managerConfidence:n??a.proManagerData.boardConfidence}}case"SET_MANAGER_NAME":return{...a,managerName:e.payload};case"UPDATE_MONEY":return{...a,money:a.money+e.payload};case"TREAT_INJURY":{const{playerId:n,weeksReduced:i,cost:s}=e.payload,r=a.team?.players?.map(o=>{if(o.id===n||o.name===n){const l=Math.max(0,(o.injuryWeeksLeft||0)-i);return{...o,injuryWeeksLeft:l,injured:l>0,treated:!0}}return o})||[];return{...a,team:{...a.team,players:r},money:a.money-s}}case"SET_LEAGUE_TABLE":return{...a,leagueTable:e.payload};case"SET_FIXTURES":return{...a,fixtures:e.payload};case"SET_OTHER_LEAGUES":return{...a,otherLeagues:e.payload};case"UPDATE_OTHER_LEAGUE":{const{leagueId:n,table:i,fixtures:s}=e.payload;return{...a,otherLeagues:{...a.otherLeagues,[n]:{table:i||a.otherLeagues[n]?.table||[],fixtures:s||a.otherLeagues[n]?.fixtures||[]}}}}case"SET_PLAYER_LEAGUE":{const n=e.payload,i=n?Pl(n):a.leagueTier||1,s=a.leagueTier||(a.playerLeagueId?Pl(a.playerLeagueId):1);let r=a.team;return i!==s&&a.team?.players?.length>0&&(console.log(` League change: tier ${s}  ${i}. Recalculating salaries for ${n}`),r={...a.team,players:a.team.players.map(o=>({...o,salary:D2(o,n)}))}),{...a,team:r,playerLeagueId:n,leagueId:n,leagueTier:i}}case"SET_PLAYER_GROUP":return{...a,playerGroupId:e.payload};case"ADD_RESULT":return{...a,results:[...a.results,e.payload]};case"UPDATE_PLAYER_SEASON_STATS":{const{events:n,playerTeamSide:i,cleanSheet:s}=e.payload,r={...a.playerSeasonStats},o=u=>typeof u=="object"?u?.name||"Desconocido":u||"Desconocido",l=()=>({goals:0,assists:0,cleanSheets:0,matchesPlayed:0,yellowCards:0,redCards:0,motm:0});n.forEach(u=>{if(u.type==="goal"&&u.team===i){const h=o(u.player);if(r[h]||(r[h]=l()),r[h].goals++,u.assist){const f=o(u.assist);r[f]||(r[f]=l()),r[f].assists++}}if(u.type==="yellow_card"&&u.team===i){const h=o(u.player);r[h]||(r[h]=l()),r[h].yellowCards++}if(u.type==="red_card"&&u.team===i){const h=o(u.player);r[h]||(r[h]=l()),r[h].redCards++}});const c=a.convocados||[];if(c.forEach(u=>{r[u]||(r[u]={goals:0,assists:0,cleanSheets:0,matchesPlayed:0,yellowCards:0,redCards:0,motm:0}),r[u].matchesPlayed++}),s){const u=a.team?.players?.find(h=>h.position==="GK"&&c.includes(h.name));u&&r[u.name]&&r[u.name].cleanSheets++}return{...a,playerSeasonStats:r}}case"START_NEW_SEASON":{const{seasonResult:n,objectiveRewards:i,europeanBonus:s,preseasonMatches:r,moneyChange:o,newFixtures:l,newTable:c,newObjectives:u}=e.payload,h=a.activeLoans||[],{expiredLoans:f,remainingLoans:m,messages:A}=nq(h,a.leagueTeams),x=(X,ne)=>{if(X.retiring)return!0;if(ne>=33){const Y=(ne-32)*.12;if(Math.random()<Y)return!0}return(X.severeInjuryCount||0)>=2&&Math.random()<.3},T=(a.team?.players||[]).filter(X=>!X.onLoan),E=f.filter(X=>X.fromTeamId===a.teamId).map(X=>X.playerData).filter(Boolean),N=[...T,...E].map(X=>{const ne=(X.age||25)+1,Q=X.contractYears??X.personality?.contractYears??2,Y=GG(X),ue=x(X,ne);return{...X,age:ne,overall:Y,contractYears:Q-1,injured:!1,injuryWeeksLeft:0,yellowCards:0,suspended:!1,suspensionType:null,retiring:ue,severeInjuryCount:0,onLoan:!1,loanFromTeam:void 0,loanFromTeamId:void 0,loanSalaryShare:void 0}})||[];N.filter(X=>X.contractYears<=0||X.retiring);const I=N.filter(X=>X.retiring),F=N.filter(X=>X.contractYears>0&&!X.retiring),G=new Set(F.map(X=>X.name)),O={};a.lineup&&Object.entries(a.lineup).forEach(([X,ne])=>{ne&&G.has(ne.name)&&(O[X]=ne)});let D=a.stadium?.naming;D&&D.yearsLeft>0&&(D={...D,yearsLeft:D.yearsLeft-1},D.yearsLeft<=0&&(D=null));const j=I.map(X=>UG(X)),L=[...F,...j],U=[];I.forEach((X,ne)=>{U.push({id:Date.now()+ne+.5,type:"retirement",titleKey:"gameMessages.playerRetiredTitle",titleParams:{player:X.name},contentKey:"gameMessages.playerRetired",contentParams:{player:X.name,position:X.position,overall:X.overall},dateKey:"gameMessages.endOfSeason",dateParams:{season:a.currentSeason}})}),j.forEach((X,ne)=>{U.push({id:Date.now()+ne+.8,type:"youth",titleKey:"gameMessages.newYouthPlayerSon",titleParams:{player:X.name},contentKey:"gameMessages.youthSonContent",contentParams:{parent:X.parentName,position:X.position,overall:X.overall,potential:X.potential},dateKey:"gameMessages.startOfSeason",dateParams:{season:a.currentSeason+1}})}),new Set(L.map(X=>X.name));const q=(a.leagueTeams||[]).map(X=>{if(X.id===a.teamId||!X.players||X.players.length===0)return X;const ne=X.players.map(pe=>({...pe,age:(pe.age||25)+1,overall:GG(pe)})),Q=ne.filter(pe=>pe.age>38?!1:pe.age>36?Math.random()>.5:!0),ue=ne.filter(pe=>!Q.includes(pe)).map(pe=>UG(pe));return{...X,players:[...Q,...ue]}}),K=a.money+o+(a.stadium?.accumulatedTicketIncome??0)+(a.stadium?.seasonTicketIncomeCollected??0),H=K<0;return{...a,currentSeason:a.currentSeason+1,currentWeek:1,team:{...a.team,players:L},lineup:ig(O,L,a.formation),convocados:(a.convocados||[]).filter(X=>G.has(X)),money:K,managerFired:H||a.managerFired,managerFiredReason:H?"managerFired.bankruptReason":a.managerFiredReason,stadium:{...a.stadium,naming:D,accumulatedTicketIncome:0,ticketPriceLocked:!1,lastMatchAttendance:null,lastMatchTicketSales:null,lastMatchIncome:null,seasonTicketsCampaignOpen:!0,seasonTicketsFinal:null,seasonTicketIncomeCollected:0,totalSeasonIncome:0},preseasonMatches:r,preseasonPhase:!0,preseasonWeek:1,leagueTable:c||[],fixtures:l||[],seasonObjectives:u||[],lastSeasonResult:n,europeanQualification:n.qualification,training:{intensity:null},medicalSlots:[],blockedPlayers:[],facilitySpecsLocked:{},facilitySpecs:{youth:null,medical:null,training:null},playerSeasonStats:{},aperturaTable:null,currentTournament:"apertura",aperturaClausuraFinal:null,pendingAperturaClausuraFinal:null,europeanCompetitions:null,pendingEuropeanMatch:null,europeanCalendar:e.payload.europeanCalendar||null,saCompetitions:null,pendingSAMatch:null,cupCompetition:null,pendingCupMatch:null,leagueTeams:q,activeLoans:m,loanHistory:[...a.loanHistory||[],...f],incomingLoanOffers:[],messages:[...U,...A.map(X=>({id:Date.now()+Math.random(),type:"loan",titleKey:X.titleKey||"gameMessages.loan",title:X.title||"Loan",content:X.content||"",dateKey:"gameMessages.endOfSeason",dateParams:{season:a.currentSeason}}))].slice(0,50),playerForm:IG(L,a.team?.players?.find(X=>X.role==="captain")?.name),matchTracker:Object.fromEntries((L||[]).map(X=>[X.name,{consecutivePlayed:0,weeksSincePlay:3}])),rejectedTransfers:{},contrarrelojData:a.contrarrelojData?(()=>{const X=a.leagueTable?.find(ue=>ue.teamId===a.teamId),ne=X?.won||0,Q=X?.drawn||0,Y=X?.lost||0;return{...a.contrarrelojData,...H&&!a.contrarrelojData.finished?{won:!1,finished:!0,loseReason:"bankrupt"}:{},seasonsPlayed:(a.contrarrelojData.seasonsPlayed||1)+1,totalWins:(a.contrarrelojData.totalWins||0)+ne,totalDraws:(a.contrarrelojData.totalDraws||0)+Q,totalLosses:(a.contrarrelojData.totalLosses||0)+Y,totalMatches:(a.contrarrelojData.totalMatches||0)+ne+Q+Y,seasonHistory:[...a.contrarrelojData.seasonHistory||[],{season:a.contrarrelojData.seasonsPlayed||1,league:a.leagueId||a.playerLeagueId,leagueName:null,position:n?.position||0,totalTeams:a.leagueTable?.length||0,promoted:!!n?.promotion,promotedTo:n?.promotion&&e.payload.newPlayerLeagueId||null,relegated:!!n?.relegation,relegatedTo:n?.relegation&&e.payload.newPlayerLeagueId||null,europeanPhase:(()=>{const ue=a.europeanCompetitions||a.saCompetitions;if(!ue)return null;for(const pe of Object.values(ue)){if(!pe?.state)continue;const Ee=pe.state.teamResults?.[a.teamId];if(Ee?.phase)return Ee.phase;if(pe.state.teams?.some(Ae=>(Ae.teamId||Ae.id)===a.teamId))return pe.state.currentPhase||"Fase de grupos"}return null})(),europeanComp:(()=>{const ue=a.europeanCompetitions||a.saCompetitions;if(!ue)return null;for(const[pe,Ee]of Object.entries(ue)){if(!Ee?.state)continue;if((Ee.state.teams||[]).some(Ae=>(Ae.teamId||Ae.id)===a.teamId))return pe==="championsLeague"?"Continental Champions Cup":pe==="europaLeague"?"Continental Shield":pe==="conferenceleague"?"Continental Trophy":pe==="copaLibertadores"?"South American Champions Cup":pe==="copaSudamericana"?"Copa Sudamericana":pe}return null})()}]}})():null}}case"END_PRESEASON":{const n=e.payload?.fixtures||a.fixtures,i=e.payload?.table||a.leagueTable,s=e.payload?.objectives||a.seasonObjectives;return{...a,preseasonPhase:!1,preseasonMatches:[],preseasonWeek:0,fixtures:n,leagueTable:i,seasonObjectives:s}}case"ADVANCE_PRESEASON_WEEK":{let n=[...a.incomingOffers||[]],i=[];if(a.team?.players){const h=a.team.players.filter(f=>f.transferListed&&!f.onLoan);for(const f of h)if(!n.some(A=>A.player?.name===f.name&&A.status==="pending")){const x=(a.leagueTeams||[]).filter(N=>N.id!==a.teamId&&(N.budget||0)>=5e5);let T;if(x.length>0)T=x[Math.floor(Math.random()*x.length)];else{const N=["FC Esperanza","Atltico Progreso","CD Horizonte","UD Fnix","Racing Nuevo"];T={id:`fake_${Date.now()}`,name:N[Math.floor(Math.random()*N.length)],budget:1e7}}const E=Vb(f),M=Math.max(5e4,Math.round(E*(.8+Math.random()*.4)));n.push({id:`incoming_preseason_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,player:{name:f.name,position:f.position,overall:f.overall,age:f.age},fromTeam:T.name,fromTeamId:T.id,amount:M,salaryOffer:Math.round((f.salary||5e4)*1.3),status:"pending",createdAt:Date.now(),expiresAt:Date.now()+336*60*60*1e3}),i.push({id:Date.now()+Math.random(),type:"offer",titleKey:"gameMessages.offerForListedPlayer",contentKey:"gameMessages.offerContent",contentParams:{buyer:T.name,amount:Sn(M),player:f.name},dateKey:"gameMessages.preseason"})}if(Math.random()<.8){const f=a.team.players.filter(x=>!x.injured&&!x.onLoan).sort(()=>Math.random()-.5),m=Math.random()<.5?1:Math.random()<.8?2:3,A=new Set(n.map(x=>x.player?.name));for(let x=0;x<Math.min(m,f.length);x++){const T=f[x];if(A.has(T.name))continue;const E=Vb(T),N=(a.leagueTeams||[]).filter(I=>I.id!==a.teamId&&(I.budget||0)>=E*.5);if(N.length>0){const I=N[Math.floor(Math.random()*N.length)],F=Math.round(E*(.85+Math.random()*.35));n.push({id:`incoming_pre_${Date.now()}_${x}_${Math.random().toString(36).substr(2,6)}`,player:{name:T.name,position:T.position,overall:T.overall,age:T.age},fromTeam:I.name,fromTeamId:I.id,amount:F,salaryOffer:Math.round((T.salary||5e4)*1.3),status:"pending",createdAt:Date.now(),expiresAt:Date.now()+336*60*60*1e3}),A.add(T.name),i.push({id:Date.now()+Math.random(),type:"offer",titleKey:"gameMessages.newOfferReceived",contentKey:"gameMessages.offerContent",contentParams:{buyer:I.name,amount:Sn(F),player:T.name},dateKey:"gameMessages.preseason"})}}}}const s=(a.preseasonWeek||1)+1;let r=[...a.outgoingOffers||[]],o=[],l=0;r=r.map(h=>{if(h.status!=="pending")return h;const f=s-(h.submittedWeek||s),A=(a.leagueTeams||[]).find(q=>q.id===h.toTeamId),x=A?(A.players||[]).find(q=>q.name===h.playerName):null;if(!A||!x)return l+=h.amount,o.push({id:Date.now()+Math.random(),type:"transfer",titleKey:"gameMessages.offerCancelled",titleParams:{player:h.playerName},contentKey:"gameMessages.playerUnavailableRefund",contentParams:{player:h.playerName,amount:Sn(h.amount)},dateKey:"gameMessages.preseason"}),null;const T=co(x,A.leagueId),E=h.amount/T,M=E>=.9?3:E>=.7?2:1;if(f>=M)return l+=h.amount,o.push({id:Date.now()+Math.random(),type:"transfer",titleKey:"gameMessages.offerExpiredPlayer",titleParams:{player:h.playerName},contentKey:"gameMessages.offerExpiredRefund",contentParams:{player:h.playerName,amount:Sn(h.amount)},dateKey:"gameMessages.preseason"}),null;if(f<1)return h;const N=x.overall>=(A.players||[]).reduce((q,K)=>q+K.overall,0)/(A.players?.length||1)+3;let I="rejected",F="",G=null;N&&E<1.3?(I="rejected",F="Titular indiscutible, no est en venta"):E>=1.15?(I="accepted",F="Oferta irrechazable"):E>=.9?Math.random()<.65?(I="accepted",F="Oferta aceptada"):(I="countered",G=Math.round(T*(1.05+Math.random()*.15)),F=`Piden ${Sn(G)}`):E>=.7?Math.random()<.2?(I="accepted",F="Necesitan liquidez"):Math.random()<.6?(I="countered",G=Math.round(T*(1.1+Math.random()*.2)),F=`Piden ${Sn(G)}`):F="Oferta insuficiente":F="Oferta irrisoria";let O="rejected",D="";const j=Math.round((x.salary||5e4)*1.1);h.salaryOffer>=j*1.2?(O="accepted",D="Encantado con la propuesta"):h.salaryOffer>=j*.95?Math.random()<.7?(O="accepted",D="Acepta el proyecto deportivo"):D="Quiere un salario mayor":h.salaryOffer>=j*.7?Math.random()<.25?(O="accepted",D="Le convence el proyecto"):D="Salario insuficiente":D="Oferta salarial irrisoria";const L=I==="accepted"&&O==="accepted",U=L?"":I==="countered"?"":"";return o.push({id:Date.now()+Math.random(),type:"transfer",titleKey:L?"gameMessages.transferComplete":"gameMessages.offerResponse",titleParams:{player:h.playerName,icon:U},contentKey:L?"gameMessages.transferCompleteContent":"gameMessages.offerRejectedContent",contentParams:L?{player:h.playerName,cost:Sn(h.amount)}:{clubReason:F,playerReason:D},dateKey:"gameMessages.preseason"}),L||I!=="countered"&&(l+=h.amount),{...h,status:"resolved",clubResponse:I,clubReason:F,clubCounterAmount:G,playerResponse:O,playerReason:D,resolvedWeek:s,expiryWeek:s+2}}).filter(Boolean);let c=a.team?[...a.team.players]:[],u=[...a.leagueTeams||[]];return r.forEach(h=>{if(h.resolvedWeek===s&&h.clubResponse==="accepted"&&h.playerResponse==="accepted"){const f=u.find(A=>A.id===h.toTeamId),m=f?(f.players||[]).find(A=>A.name===h.playerName):null;m&&(c.push({...m,salary:h.salaryOffer,contractYears:h.contractYears||4,teamId:a.teamId,morale:80,fitness:100}),u=u.map(A=>A.id===h.toTeamId?{...A,players:(A.players||[]).filter(x=>x.name!==h.playerName),budget:(A.budget||5e7)+h.amount}:A))}}),{...a,preseasonWeek:s,incomingOffers:n,outgoingOffers:r,money:(a.money||0)+l,team:a.team?{...a.team,players:c}:null,leagueTeams:u,messages:[...o,...i,...a.messages].slice(0,50)}}case"ADVANCE_WEEK":{let n=a.europeanCompetitions,i=a.saCompetitions;const s=(Te,st,mt,ht,Qe,Xe)=>{const ct=st?.competitions?.[Te.competitionId];if(!ct)return st;const Tt=Te.homeTeam?.reputation||Te.team1?.reputation||70,kt=Te.awayTeam?.reputation||Te.team2?.reputation||70,vt=Tt+5-kt,Tn=1.2+vt*.02,Ne=1.2-vt*.02,Xt=Math.max(0,Math.round(Tn+(Math.random()*2-1))),Ht=Math.max(0,Math.round(Ne+(Math.random()*2-1))),$t={homeTeamId:Te.homeTeamId||Te.homeTeam?.teamId||Te.team1?.teamId,awayTeamId:Te.awayTeamId||Te.awayTeam?.teamId||Te.team2?.teamId,homeScore:Xt,awayScore:Ht,events:[]};let zt=Te.phase==="league"?mt(ct,$t,Te.matchday):ht(ct,$t,Te.phase);if(Te.phase==="league"&&Te.matchday===8&&zt.currentMatchday>=8||Te.phase!=="league"){const Ot=Qe(zt,Xe);(Ot.updatedState.phase!==ct.phase||Te.phase==="league")&&(zt=Ot.updatedState)}return{...st,competitions:{...st.competitions,[Te.competitionId]:zt}}};a.pendingEuropeanMatch&&(n=s(a.pendingEuropeanMatch,n,WG,$G,nv,a.teamId)),a.pendingSAMatch&&(i=s(a.pendingSAMatch,i,YG,XG,Ub,a.teamId));const r=0,o=0;let l=a.team?.players?.map(Te=>{if(Te.injured&&Te.injuryWeeksLeft>0){const st=Te.injuryWeeksLeft-1;return st<=0?{...Te,injured:!1,injuryWeeksLeft:0,injuryType:null,treated:!1}:{...Te,injuryWeeksLeft:st}}if(Te.resting&&Te.restWeeks){const st=Te.restWeeks-1;return st<=0?{...Te,resting:!1,restWeeks:0}:{...Te,restWeeks:st}}return Te})||[];const c=[];let u=a.facilityStats?.youth||{playersGenerated:0,totalOvr:0};if(a.currentWeek===38){const Te=a.facilities?.youth||0,st=a.facilitySpecs?.youth||"general",mt=VG(Te,st);c.push(mt),u={playersGenerated:u.playersGenerated+1,totalOvr:u.totalOvr+mt.overall},l=[...l,...c]}let h=null;a.pendingEvent||(h=cye(a.facilities,l,a.currentWeek+1));const f=[];if(c.length>0){const Te=a_.youth.options.find(mt=>mt.id===a.facilitySpecs?.youth)?.name||"General",st=c[0];f.push({id:Date.now(),type:"youth",titleKey:"gameMessages.newYouthPlayer",contentKey:"gameMessages.youthPlayerContent",contentParams:{spec:Te,player:st.name,position:st.position,overall:st.overall,age:st.age},dateKey:"gameMessages.endOfSeason",dateParams:{season:a.currentSeason}})}const m=5,A=a.stadium?.grassCondition??100,x=Math.min(100,A+m),T=a.stadium?{...a.stadium,grassCondition:x}:a.stadium,E=a.currentWeek+1;a.fixtures?.length>0&&Math.max(...a.fixtures.map(Te=>Te.week));const M=NF(E,{preseasonPhase:a.preseasonPhase||!1});let N=a.leagueTeams||[],I=a.globalMarket?.summary||{recentTransfers:[],activeRumors:[],totalTransfers:0,totalSpent:0},F=[];if(a.leagueTeams&&a.leagueTeams.length>0){const Te=new CF(new Map,a.teamId),st=a.leagueTeams.map(ht=>({...ht,budget:ht.budget||5e7}));Te.initializeTeams(st),Te.season=a.currentSeason||1,Te.simulateWeek(E,M.open,M.type).forEach(ht=>{if(ht.type==="transfer"){const Qe=ht.data;(Qe.from?.id===a.teamId||Qe.to?.id===a.teamId)&&F.push({id:Date.now()+Math.random(),type:"transfer",titleKey:"gameMessages.transferConfirmed",contentKey:"gameMessages.transferConfirmedContent",contentParams:{player:Qe.player.name,position:Qe.player.position,overall:Qe.player.overall,toTeam:Qe.to.name,fromTeam:Qe.from.name,price:Sn(Qe.price)},dateKey:"gameMessages.weekDate",dateParams:{week:E}}),I.recentTransfers=[ht.data,...I.recentTransfers||[]].slice(0,30),I.totalTransfers=(I.totalTransfers||0)+1,I.totalSpent=(I.totalSpent||0)+Qe.price}else ht.type==="rumor"&&(I.activeRumors=[ht.data,...I.activeRumors||[]].slice(0,20))}),N=Array.from(Te.allTeams.values()).map(ht=>({...ht,players:ht.players,budget:ht.budget}))}let G=[...a.incomingOffers||[]];const O=a.preseasonPhase||!1,D=O?.8:.4;if(M.open&&a.team?.players&&Math.random()<D){const Te=Math.random(),st=Te<.45?1:Te<.75?2:Te<.92?3:4,mt=a.team.players.filter(Qe=>!Qe.injured&&!Qe.onLoan).sort(()=>Math.random()-.5),ht=new Set;for(let Qe=0;Qe<Math.min(st,mt.length);Qe++){const Xe=mt[Qe];if(ht.has(Xe.name))continue;const ct=Vb(Xe),Tt=(a.leagueTeams||[]).filter(kt=>kt.id===a.teamId?!1:kt.budget>=ct*.5);if(Tt.length>0){const kt=Tt[Math.floor(Math.random()*Tt.length)],vt=Math.round(ct*(.85+Math.random()*.35)),Ne=vt/ct>=.95?2:1,Xt={id:`incoming_${Date.now()}_${Qe}_${Math.random().toString(36).substr(2,6)}`,player:{name:Xe.name,position:Xe.position,overall:Xe.overall,age:Xe.age},fromTeam:kt.name,fromTeamId:kt.id,amount:vt,salaryOffer:Math.round((Xe.salary||5e4)*1.3),status:"pending",createdWeek:E,expiryWeek:E+Ne,createdAt:Date.now(),expiresAt:Date.now()+Ne*7*24*60*60*1e3};G.push(Xt),ht.add(Xe.name),F.push({id:Date.now()+Math.random(),type:"offer",titleKey:"gameMessages.newOfferReceived",contentKey:"gameMessages.offerContent",contentParams:{buyer:kt.name,amount:Sn(vt),player:Xe.name},dateKey:O?"gameMessages.preseason":"gameMessages.weekDate",dateParams:O?{}:{week:E}})}}}if(O&&M.open&&a.team?.players&&G.length-(a.incomingOffers||[]).length===0){const st=a.team.players.filter(mt=>!mt.injured&&!mt.onLoan).sort(()=>Math.random()-.5);if(st.length>0){const mt=st[0],ht=Vb(mt),Qe=(a.leagueTeams||[]).filter(Xe=>Xe.id===a.teamId?!1:Xe.budget>=ht*.3);if(Qe.length>0){const Xe=Qe[Math.floor(Math.random()*Qe.length)],ct=Math.round(ht*(.8+Math.random()*.4));G.push({id:`incoming_preseason_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,player:{name:mt.name,position:mt.position,overall:mt.overall,age:mt.age},fromTeam:Xe.name,fromTeamId:Xe.id,amount:ct,salaryOffer:Math.round((mt.salary||5e4)*1.3),status:"pending",createdAt:Date.now(),expiresAt:Date.now()+336*60*60*1e3}),F.push({id:Date.now()+Math.random(),type:"offer",titleKey:"gameMessages.newOfferReceived",contentKey:"gameMessages.offerContent",contentParams:{buyer:Xe.name,amount:Sn(ct),player:mt.name},dateKey:"gameMessages.preseason"})}}}if(a.team?.players){const Te=a.team.players.filter(st=>st.transferListed&&!st.onLoan);console.log("[OFFERS] Listed players:",Te.length,"LeagueTeams:",(a.leagueTeams||[]).length,"Window:",M.open);for(const st of Te)if(!G.some(ht=>ht.player?.name===st.name&&ht.status==="pending")){const ht=a.leagueTeams||[],Qe=ht.filter(vt=>vt.id===a.teamId?!1:(vt.budget||0)>=5e5);console.log("[OFFERS] Player:",st.name,"Buyers found:",Qe.length,"AllTeams:",ht.length);let Xe;if(Qe.length>0)Xe=Qe[Math.floor(Math.random()*Qe.length)];else{const vt=["FC Esperanza","Atltico Progreso","CD Horizonte","UD Fnix","Racing Nuevo","CF Promesa","SD Aurora","Real Frontera"];Xe={id:`fake_buyer_${Date.now()}`,name:vt[Math.floor(Math.random()*vt.length)],budget:1e7}}const ct=Vb(st),Tt=Math.max(5e4,Math.round(ct*(.8+Math.random()*.4))),kt={id:`incoming_listed_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,player:{name:st.name,position:st.position,overall:st.overall,age:st.age},fromTeam:Xe.name,fromTeamId:Xe.id,amount:Tt,salaryOffer:Math.round((st.salary||5e4)*1.3),status:"pending",createdAt:Date.now(),expiresAt:Date.now()+336*60*60*1e3};G.push(kt),F.push({id:Date.now()+Math.random(),type:"offer",titleKey:"gameMessages.offerForListedPlayer",contentKey:"gameMessages.offerContent",contentParams:{buyer:Xe.name,amount:Sn(Tt),player:st.name},dateKey:"gameMessages.weekDate",dateParams:{week:E}})}}const j=[],L=G.filter(Te=>Te.status==="pending"&&(Te.expiryWeek&&E>=Te.expiryWeek||Te.expiresAt&&Te.expiresAt<=Date.now()));L.length>0&&L.forEach(Te=>{j.push({id:Date.now()+Math.random(),type:"offer",titleKey:"gameMessages.offerExpired",contentKey:"gameMessages.offerExpiredContent",contentParams:{team:Te.fromTeam,player:Te.player?.name},dateKey:"gameMessages.weekDate",dateParams:{week:E}})}),G=G.filter(Te=>Te.status!=="pending"||(!Te.expiryWeek||E<Te.expiryWeek)&&(!Te.expiresAt||Te.expiresAt>Date.now()));const U=a.money+r-o,q=U<0;let K={confidence:a.managerConfidence||75,warning:null,fired:!1,reason:null};if(E>5&&E%3===0&&!a.preseasonPhase||q){K=Aye({...a,money:U,currentWeek:E,team:{...a.team,players:l}});const Te=vye(K,E);Te&&f.push(Te)}let H=n,X=null,ne=[];const Q=Iye(E,a.europeanCalendar);if(H&&Q){const Te=hN(E,a.europeanCalendar);if(Te&&Te.phase==="league")for(const[st,mt]of Object.entries(H.competitions)){if(!mt||mt.phase!=="league")continue;const{updatedState:ht,playerMatch:Qe}=Oye(mt,Te.matchday,a.teamId);if(H={...H,competitions:{...H.competitions,[st]:ht}},Qe&&(X={...Qe,competitionId:st,competitionName:mt.config?.name||st,phase:"league"}),Te.matchday===8&&ht.currentMatchday>=8&&!Qe){const Xe=nv(ht,a.teamId);H.competitions[st]=Xe.updatedState,ne.push(...Xe.messages),Xe.playerMatch&&(X={...Xe.playerMatch,competitionId:st,competitionName:mt.config?.name||st,phase:Xe.updatedState.phase})}}else if(Te)for(const[st,mt]of Object.entries(H.competitions)){if(!mt||mt.phase==="completed"||mt.phase==="league")continue;const ht=nv(mt,a.teamId);H={...H,competitions:{...H.competitions,[st]:ht.updatedState}},ne.push(...ht.messages),ht.playerMatch&&(X={...ht.playerMatch,competitionId:st,competitionName:mt.config?.name||st,phase:ht.updatedState.phase})}}const Y=ne.map(Te=>({id:Date.now()+Math.random(),type:Te.type||"european",title:Te.title,content:Te.content,dateKey:"gameMessages.weekDate",dateParams:{week:E}}));let ue=i,pe=null,Ee=[];if(ue&&Q){const Te=hN(E,a.europeanCalendar);if(Te&&Te.phase==="league")for(const[st,mt]of Object.entries(ue.competitions)){if(!mt||mt.phase!=="league")continue;const{updatedState:ht,playerMatch:Qe}=Vye(mt,Te.matchday,a.teamId);if(ue={...ue,competitions:{...ue.competitions,[st]:ht}},Qe&&(pe={...Qe,competitionId:st,competitionName:mt.config?.name||st,phase:"league"}),Te.matchday===8&&ht.currentMatchday>=8&&!Qe){const Xe=Ub(ht,a.teamId);ue.competitions[st]=Xe.updatedState,Ee.push(...Xe.messages),Xe.playerMatch&&(pe={...Xe.playerMatch,competitionId:st,competitionName:mt.config?.name||st,phase:Xe.updatedState.phase})}}else if(Te)for(const[st,mt]of Object.entries(ue.competitions)){if(!mt||mt.phase==="completed"||mt.phase==="league")continue;const ht=Ub(mt,a.teamId);ue={...ue,competitions:{...ue.competitions,[st]:ht.updatedState}},Ee.push(...ht.messages),ht.playerMatch&&(pe={...ht.playerMatch,competitionId:st,competitionName:mt.config?.name||st,phase:ht.updatedState.phase})}}const oe=Ee.map(Te=>({id:Date.now()+Math.random(),type:Te.type||"southamerican",title:Te.title,content:Te.content,dateKey:"gameMessages.weekDate",dateParams:{week:E}}));let Ae=a.cupCompetition,be=null,Ce=[];if(rZ(E,a.europeanCalendar)&&Ae&&!Ae.winner){const Te=PF(E,a.europeanCalendar);if(Te!==null&&Te===Ae.currentRound){const st={};a.leagueTeams&&a.leagueTeams.forEach(Qe=>{st[Qe.id]=Qe}),a.team&&(st[a.teamId]=a.team);const{updatedBracket:mt,playerMatch:ht}=fZ(Ae,Te,a.teamId,st);if(Ae=mt,ht&&!Ae.playerEliminated&&(be={...ht,cupName:Ae.config?.name||"Copa",cupIcon:Ae.config?.icon||"",cupShortName:Ae.config?.shortName||"Copa",roundName:Ae.rounds[Te]?.name||`Ronda ${Te+1}`}),!ht&&!Ae.playerEliminated&&Ae.rounds[Te]?.matches.some(Xe=>Xe.bye&&Xe.homeTeam?.teamId===a.teamId)&&Ce.push({id:Date.now()+Math.random(),type:"cup",titleKey:"gameMessages.cupByeTitle",titleParams:{icon:Ae.config?.icon||"",cup:Ae.config?.shortName||"Cup"},contentKey:"gameMessages.cupByeContent",dateKey:"gameMessages.weekDate",dateParams:{week:E}}),Ae.winner){const Qe=Ae.rounds[Ae.rounds.length-1]?.matches[0]?.winnerId===a.teamId?a.team?.name:"otro equipo";Ce.push({id:Date.now()+Math.random(),type:"cup",titleKey:"gameMessages.cupFinishedTitle",titleParams:{icon:Ae.config?.icon||"",cup:Ae.config?.name||"Cup"},contentKey:Ae.winner===a.teamId?"gameMessages.cupWonContent":"gameMessages.cupWonByOther",contentParams:{cup:Ae.config?.name||"Cup",winner:Qe},dateKey:"gameMessages.weekDate",dateParams:{week:E}})}}}let te=a.otherLeagues;if(te&&Object.keys(te).length>0)try{te=nZ(te,E)}catch(Te){console.warn("Error simulating other leagues week",E,Te)}let fe=[...a.activeLoans||[]].map(Te=>Te.status==="active"&&Te.weeksRemaining>0?{...Te,weeksRemaining:Te.weeksRemaining-1}:Te),Le=[...a.incomingLoanOffers||[]],Fe=[];if(M.open&&a.team?.players&&Math.random()<.2){const Te=$ye(a.team,a.leagueTeams||[],a.teamId);Te.length>0&&(Le=[...Le,...Te],Te.forEach(st=>{Fe.push({id:Date.now()+Math.random(),type:"loan",titleKey:"gameMessages.loanOfferReceived",contentKey:"gameMessages.loanOfferContent",contentParams:{team:st.toTeamName,player:st.playerData.name,fee:`${(st.loanFee/1e6).toFixed(1)}M`},dateKey:"gameMessages.weekDate",dateParams:{week:E}})}))}Le=Le.filter(Te=>Te.status!=="pending"||Te.expiresAt&&Te.expiresAt>Date.now()),M.open&&N.length>0&&Yye(N,a.teamId);const Ie=[],at=a.convocados||[],je=vAe(a.matchTracker||{},a.team?.players||[],at),Ve=_Ae(a.rejectedTransfers),Me=a.team?.players?.find(Te=>Te.role==="captain")?.name||null,ze=yAe(a.playerForm||{},a.team?.players||[],je,{rejectedTransfers:Ve,captainName:Me});let Je=a.leagueTable,rt=a.aperturaTable,ve=a.currentTournament||"apertura";if(Jg(a.playerLeagueId)){const Te=Wa[a.playerLeagueId];if(Te){const st=Te.teams;E===st&&ve==="apertura"&&(rt=a.leagueTable.map(mt=>({...mt})),ve="clausura",Je=a.leagueTable.map(mt=>({...mt,played:0,won:0,drawn:0,lost:0,goalsFor:0,goalsAgainst:0,goalDifference:0,points:0,form:[],homeForm:[],awayForm:[],streak:0,morale:70})))}}let Ue=a.aperturaClausuraFinal||null,it=a.pendingAperturaClausuraFinal||null,wt=[];if(Jg(a.playerLeagueId)&&ve==="clausura"&&!Ue&&!it){const Te=Wa[a.playerLeagueId];if(Te){const st=eZ(Te.teams);if(a.currentWeek>=st){const mt=rt?z_([...rt]):[],ht=z_([...Je]),Qe=mt[0]?.teamId,Xe=ht[0]?.teamId;if(Qe&&Xe){const ct=a.teamId,Tt=ct===Qe||ct===Xe;if(Qe===Xe)Ue={aperturaChampion:Qe,aperturaChampionName:mt[0]?.teamName||Qe,clausuraChampion:Xe,clausuraChampionName:ht[0]?.teamName||Xe,winner:Qe,winnerName:mt[0]?.teamName||Qe,winReason:"sameChampion",hadFinal:!1},wt.push({id:Date.now()+500,type:"league",titleKey:"gameMessages.leagueChampion",contentKey:"gameMessages.directChampion",contentParams:{team:mt[0]?.teamName,league:Wa[a.playerLeagueId]?.name||"Liga"},dateKey:"gameMessages.weekDate",dateParams:{week:E}});else if(Tt){const kt=Te.getTeams(),vt=kt.find(Ne=>Ne.id===Qe),Tn=kt.find(Ne=>Ne.id===Xe);it={aperturaChampion:Qe,aperturaChampionName:vt?.name||mt[0]?.teamName||Qe,clausuraChampion:Xe,clausuraChampionName:Tn?.name||ht[0]?.teamName||Xe,leagueId:a.playerLeagueId,leagueName:Wa[a.playerLeagueId]?.name||"Liga"},wt.push({id:Date.now()+500,type:"league",titleKey:"gameMessages.aperturaClausuraFinal",contentKey:"gameMessages.aperturaClausuraFinalContent",contentParams:{league:Wa[a.playerLeagueId]?.name||"Liga",apertura:mt[0]?.teamName,clausura:ht[0]?.teamName},dateKey:"gameMessages.weekDate",dateParams:{week:E}})}else{const kt=Te.getTeams();Ue=tZ(Qe,Xe,kt),Ue&&(Ue.winReason==="aggregate"||Ue.winReason,wt.push({id:Date.now()+500,type:"league",titleKey:"gameMessages.aperturaClausuraFinalResult",contentKey:"gameMessages.aperturaClausuraFinalResultContent",contentParams:{winner:Ue.winnerName,league:Wa[a.playerLeagueId]?.name||"Liga",leg1Home:Ue.leg1.homeScore,leg1Away:Ue.leg1.awayScore,leg2Home:Ue.leg2.homeScore,leg2Away:Ue.leg2.awayScore},dateKey:"gameMessages.weekDate",dateParams:{week:E}}))}}}}}let Mt=a.money+r-o,_e=a.contrarrelojData,le=null;a.gameMode==="contrarreloj"&&_e&&!_e.finished&&(Mt<0?(_e={..._e,won:!1,finished:!0,loseReason:"bankrupt"},le="contrarreloj_end"):K.fired&&(_e={..._e,won:!1,finished:!0,loseReason:"fired"},le="contrarreloj_end"));let Ge=[...a.outgoingOffers||[]],tt=[],pt=0;return Ge=Ge.map(Te=>{if(Te.status!=="pending")return Te.status==="resolved"&&Te.resolvedWeek&&E-Te.resolvedWeek>3?null:Te.status==="resolved"&&Te.clubResponse==="countered"&&Te.resolvedWeek&&E-Te.resolvedWeek>2?(pt+=Te.amount,tt.push({id:Date.now()+Math.random(),type:"transfer",titleKey:"gameMessages.counterOfferExpired",titleParams:{player:Te.playerName},contentKey:"gameMessages.counterOfferExpiredContent",contentParams:{player:Te.playerName,amount:Sn(Te.amount)},dateKey:"gameMessages.weekDate",dateParams:{week:E}}),null):Te;const st=E-(Te.submittedWeek||E),mt=N.find(an=>an.id===Te.toTeamId),ht=mt?(mt.players||[]).find(an=>an.name===Te.playerName):null;if(!mt||!ht)return pt+=Te.amount,tt.push({id:Date.now()+Math.random(),type:"transfer",titleKey:"gameMessages.offerCancelled",titleParams:{player:Te.playerName},contentKey:"gameMessages.playerUnavailableRefund",contentParams:{player:Te.playerName,amount:Sn(Te.amount)},dateKey:"gameMessages.weekDate",dateParams:{week:E}}),null;const Qe=co(ht,mt.leagueId),Xe=Te.amount/Qe,ct=Xe>=.9?3:Xe>=.7?2:1;if(st>=ct)return pt+=Te.amount,tt.push({id:Date.now()+Math.random(),type:"transfer",titleKey:"gameMessages.offerExpiredPlayer",titleParams:{player:Te.playerName},contentKey:"gameMessages.offerExpiredRefund",contentParams:{player:Te.playerName,amount:Sn(Te.amount)},dateKey:"gameMessages.weekDate",dateParams:{week:E}}),null;if(st<1)return Te;const Tt=ht.overall>=(mt.players||[]).reduce((an,jn)=>an+jn.overall,0)/(mt.players?.length||1)+3;let kt="rejected",vt="",Tn=null;Tt&&Xe<1.3?(kt="rejected",vt="Titular indiscutible, no est en venta"):Xe>=1.15?(kt="accepted",vt="Oferta irrechazable"):Xe>=.9?Math.random()<.65?(kt="accepted",vt="Oferta aceptada"):(kt="countered",Tn=Math.round(Qe*(1.05+Math.random()*.15)),vt=`Piden ${Sn(Tn)}`):Xe>=.7?Math.random()<.2?(kt="accepted",vt="Necesitan liquidez"):Math.random()<.6?(kt="countered",Tn=Math.round(Qe*(1.1+Math.random()*.2)),vt=`Piden ${Sn(Tn)}`):vt="Oferta insuficiente":vt="Oferta irrisoria";let Ne="rejected",Xt="";const Ht=Math.round((ht.salary||5e4)*1.1);Te.salaryOffer>=Ht*1.2?(Ne="accepted",Xt="Encantado con la propuesta"):Te.salaryOffer>=Ht*.95?Math.random()<.7?(Ne="accepted",Xt="Acepta el proyecto deportivo"):Xt="Quiere un salario mayor":Te.salaryOffer>=Ht*.7?Math.random()<.25?(Ne="accepted",Xt="Le convence el proyecto"):Xt="Salario insuficiente":Xt="Oferta salarial irrisoria";const $t=kt==="accepted"&&Ne==="accepted",zt={...Te,status:"resolved",clubResponse:kt,clubReason:vt,clubCounterAmount:Tn,playerResponse:Ne,playerReason:Xt,resolvedWeek:E,expiryWeek:E+2},Ot=$t?"":kt==="countered"?"":"";if(tt.push({id:Date.now()+Math.random(),type:"transfer",titleKey:$t?"gameMessages.transferComplete":"gameMessages.offerResponse",titleParams:{player:Te.playerName,icon:Ot},contentKey:$t?"gameMessages.transferCompleteContent":"gameMessages.offerRejectedContent",contentParams:$t?{player:Te.playerName,cost:Sn(Te.amount)}:{clubReason:vt,playerReason:Xt},dateKey:"gameMessages.weekDate",dateParams:{week:E}}),$t){const an={...ht,salary:Te.salaryOffer,contractYears:Te.contractYears||4,teamId:a.teamId,morale:80,fitness:100};l=[...l,an],N=N.map(jn=>jn.id===Te.toTeamId?{...jn,players:(jn.players||[]).filter(ai=>ai.name!==Te.playerName),budget:(jn.budget||5e7)+Te.amount}:jn)}else kt!=="countered"&&(pt+=Te.amount);return zt}).filter(Boolean),Mt+=pt,{...a,currentWeek:E,leagueTable:Je,aperturaTable:rt,currentTournament:ve,aperturaClausuraFinal:Ue,pendingAperturaClausuraFinal:it,money:Mt,weeklyIncome:r,weeklyExpenses:o,team:a.team?{...a.team,players:l}:null,stadium:T,messages:[...j,...tt,...wt,...Ce,...Y,...oe,...F,...Fe,...Ie,...f,...a.messages].slice(0,50),outgoingOffers:Ge,pendingEvent:h||a.pendingEvent,facilityStats:{...a.facilityStats,youth:u},medicalTreatmentsUsed:0,leagueTeams:N,incomingOffers:G,globalMarket:{...a.globalMarket,summary:I,windowOpen:M.open,windowType:M.type},managerConfidence:K.confidence,managerFired:K.fired,europeanCompetitions:H,pendingEuropeanMatch:X,saCompetitions:ue,pendingSAMatch:pe,europeanCalendar:a.europeanCalendar,cupCompetition:Ae,pendingCupMatch:be,otherLeagues:te,playerForm:ze,matchTracker:je,rejectedTransfers:Ve,activeLoans:fe,incomingLoanOffers:Le,contrarrelojData:_e,...le?{currentScreen:le}:{}}}case"ADVANCE_WEEKS_BATCH":{const n=e.payload?.count||1;let i=a;for(let s=0;s<n&&(i=vZ(i,{type:"ADVANCE_WEEK"}),!(i.managerFired||i.contrarrelojData?.finished));s++);return i}case"ADD_MESSAGE":return{...a,messages:[e.payload,...a.messages].slice(0,50)};case"SET_FORMATION":return{...a,formation:e.payload};case"SET_TACTIC":return{...a,tactic:e.payload};case"CLEAR_RESOLVED_OFFERS":return{...a,outgoingOffers:(a.outgoingOffers||[]).filter(n=>n.status==="pending")};case"SET_LINEUP":return{...a,lineup:e.payload};case"SET_MANAGER_FIRED":return{...a,managerFired:!0,managerFiredReason:e.payload?.reason||"La directiva ha prescindido de tus servicios"};case"SET_CONVOCADOS":return{...a,convocados:e.payload};case"ADD_TRANSFER_OFFER":return{...a,transferOffers:[...a.transferOffers,e.payload]};case"REMOVE_TRANSFER_OFFER":return{...a,transferOffers:a.transferOffers.filter(n=>n.id!==e.payload)};case"UPDATE_TRANSFER_OFFER":return{...a,transferOffers:a.transferOffers.map(n=>n.id===e.payload.id?e.payload:n)};case"SIGN_PLAYER":{if(a.money<e.payload.fee)return a;const n={...e.payload.player,role:e.payload.player.role||rD(e.payload.player)};return{...a,team:{...a.team,players:[...a.team.players,n]},money:a.money-e.payload.fee}}case"SELL_PLAYER":return{...a,team:{...a.team,players:a.team.players.filter(n=>n.name!==e.payload.playerName)},money:a.money+e.payload.fee};case"UPGRADE_FACILITY":return{...a,facilities:{...a.facilities,[e.payload.facilityId]:(a.facilities[e.payload.facilityId]||0)+1},money:a.money-e.payload.cost};case"BLOCK_PLAYER":{const n=e.payload,i=a.blockedPlayers||[];return i.includes(n)?a:{...a,blockedPlayers:[...i,n]}}case"UPDATE_STADIUM":return{...a,stadium:{...a.stadium,...e.payload}};case"SET_GLOBAL_MARKET":return{...a,globalMarket:e.payload};case"ADD_OUTGOING_OFFER":return{...a,outgoingOffers:[...a.outgoingOffers||[],e.payload],money:a.money-(e.payload.amount||0)};case"UPDATE_OUTGOING_OFFER":return{...a,outgoingOffers:(a.outgoingOffers||[]).map(n=>n.id===e.payload.id?{...n,...e.payload}:n)};case"REMOVE_OUTGOING_OFFER":return{...a,outgoingOffers:(a.outgoingOffers||[]).filter(n=>n.id!==e.payload)};case"ADD_INCOMING_OFFER":return{...a,incomingOffers:[...a.incomingOffers||[],e.payload]};case"UPDATE_INCOMING_OFFER":return{...a,incomingOffers:(a.incomingOffers||[]).map(n=>n.id===e.payload.id?{...n,...e.payload}:n)};case"REMOVE_INCOMING_OFFER":return{...a,incomingOffers:(a.incomingOffers||[]).filter(n=>n.id!==e.payload)};case"ADD_TRANSFER_NEWS":return{...a,transferNews:[...(a.transferNews||[]).slice(-50),e.payload]};case"UPDATE_LEAGUE_TEAMS":return{...a,leagueTeams:bye(e.payload)};case"REMOVE_FREE_AGENT":return{...a,freeAgents:(a.freeAgents||[]).filter(n=>n.name!==e.payload.playerName)};case"ACCEPT_INCOMING_OFFER":{const n=e.payload,i=a.team.players.find(l=>l.name===n.player.name);if(!i)return a;const s=a.team.players.filter(l=>l.name!==n.player.name),r={};a.lineup&&Object.entries(a.lineup).forEach(([l,c])=>{c&&c.name!==n.player.name&&(r[l]=c)});const o=(a.leagueTeams||[]).map(l=>l.id===n.fromTeamId?{...l,players:[...l.players||[],{...i,teamId:l.id,contractYears:4}],budget:(l.budget||5e7)-n.amount}:l);return{...a,team:{...a.team,players:s},lineup:ig(r,s,a.formation),money:a.money+n.amount,leagueTeams:o,incomingOffers:(a.incomingOffers||[]).filter(l=>l.id!==n.id),messages:[{id:Date.now(),type:"transfer",titleKey:"gameMessages.saleComplete",contentKey:"gameMessages.saleCompleteContent",contentParams:{player:n.player.name,team:n.fromTeam,amount:Sn(n.amount)},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}},...a.messages].slice(0,50)}}case"REJECT_INCOMING_OFFER":{const n=e.payload;return{...a,incomingOffers:(a.incomingOffers||[]).map(i=>i.id===n.id?{...i,status:"rejected"}:i)}}case"REJECT_TRANSFER_PENALTY":{const{playerName:n,offerQuality:i}=e.payload,s=i==="excellent"?8:i==="good"?5:3,r={...a.rejectedTransfers,[n]:{weeksLeft:s,totalWeeks:s,quality:i}},o={...a.playerForm};return o[n]="terrible",{...a,rejectedTransfers:r,playerForm:o}}case"COUNTER_INCOMING_OFFER":{const n=e.payload,i=Math.round(n.amount*1.3);return Math.random()<.6?{...a,incomingOffers:(a.incomingOffers||[]).map(r=>r.id===n.id?{...r,amount:i,status:"pending",counterAccepted:!0}:r),messages:[{id:Date.now(),type:"offer",titleKey:"gameMessages.counterOfferAccepted",contentKey:"gameMessages.counterOfferAcceptedContent",contentParams:{team:n.fromTeam,amount:Sn(i),player:n.player.name},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}},...a.messages].slice(0,50)}:{...a,incomingOffers:(a.incomingOffers||[]).map(r=>r.id===n.id?{...r,status:"rejected",counterRejected:!0}:r),messages:[{id:Date.now(),type:"offer",titleKey:"gameMessages.counterOfferRejected",contentKey:"gameMessages.counterOfferRejectedContent",contentParams:{team:n.fromTeam,amount:Sn(i),player:n.player.name},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}},...a.messages].slice(0,50)}}case"PROCESS_OUTGOING_OFFER":{const n=e.payload,i=(a.leagueTeams||[]).find(f=>f.id===n.toTeamId);if(!i)return a;const s=(i.players||[]).find(f=>f.name===n.player.name);if(!s)return a;const r=co(s,i.leagueId),o=n.amount/r;let l="rejected",c=null;if(o>=1.1)l="accepted";else if(o>=.85)l=Math.random()<.6?"accepted":"countered",l==="countered"&&(c=Math.round(r*(1.05+Math.random()*.15)));else if(o>=.7){const f=Math.random();f<.2?l="accepted":f<.7&&(l="countered",c=Math.round(r*(1.1+Math.random()*.2)))}const u={...n,status:l,counterAmount:c,respondedAt:Date.now()};let h={...a,outgoingOffers:(a.outgoingOffers||[]).map(f=>f.id===n.id?u:f)};if(l==="accepted"){const f={...s,teamId:a.teamId,contractYears:4,salary:Math.round((s.salary||5e4)*1.2)};h={...h,team:{...a.team,players:[...a.team.players,f]},money:a.money-n.amount,leagueTeams:(a.leagueTeams||[]).map(m=>m.id===n.toTeamId?{...m,players:(m.players||[]).filter(A=>A.name!==s.name),budget:(m.budget||5e7)+n.amount}:m),messages:[{id:Date.now(),type:"transfer",titleKey:"gameMessages.transferComplete",contentKey:"gameMessages.transferCompleteContent",contentParams:{player:s.name,cost:Sn(n.amount)},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}},...a.messages].slice(0,50)}}return h}case"ACCEPT_COUNTER_OFFER":{const n=e.payload,i=(a.leagueTeams||[]).find(u=>u.id===n.toTeamId);if(!i)return a;const s=n.playerName||n.player?.name,r=(i.players||[]).find(u=>u.name===s);if(!r)return a;const o=n.clubCounterAmount||n.counterAmount||n.amount,l=o-(n.amount||0);if(a.money<l)return a;const c={...r,teamId:a.teamId,salary:n.salaryOffer||r.salary,contractYears:n.contractYears||4,role:rD(r)};return{...a,team:{...a.team,players:[...a.team.players,c]},money:a.money-l,leagueTeams:(a.leagueTeams||[]).map(u=>u.id===n.toTeamId?{...u,players:(u.players||[]).filter(h=>h.name!==r.name),budget:(u.budget||5e7)+o}:u),outgoingOffers:(a.outgoingOffers||[]).filter(u=>u.id!==n.id),messages:[{id:Date.now(),type:"transfer",titleKey:"gameMessages.transferComplete",contentKey:"gameMessages.transferCompleteCounterContent",contentParams:{player:r.name,cost:Sn(o)},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}},...a.messages].slice(0,50)}}case"DELETE_MESSAGE":return{...a,messages:a.messages.filter(n=>n.id!==e.payload)};case"CLEAR_MESSAGES":return{...a,messages:[]};case"UPDATE_TEAM":return{...a,team:e.payload};case"UPDATE_PLAYER":return{...a,team:{...a.team,players:a.team.players.map(n=>n.name===e.payload.name?e.payload:n)}};case"REMOVE_PLAYER":{const n=a.team.players.filter(s=>s.name!==e.payload),i={};return a.lineup&&Object.entries(a.lineup).forEach(([s,r])=>{r&&r.name!==e.payload&&(i[s]=r)}),{...a,team:{...a.team,players:n},lineup:ig(i,n,a.formation),convocados:(a.convocados||[]).filter(s=>s!==e.payload)}}case"INJURE_PLAYER":{const n=a.facilities?.medical||0,i=[0,.2,.35,.5][n],s=a.facilitySpecs?.medical==="recovery"?.5:0,r=Math.min(.75,i+s),o=e.payload.weeksOut,l=Math.max(1,Math.round(o*(1-r))),c=o>=6,u=a.team.players.map(h=>{if(h.name===e.payload.playerName){const f=h.severeInjuryCount||0,m=c?f+1:0;let A=h.retiring||!1;return m>=2&&(h.age||25)>=30&&Math.random()<.25&&(A=!0),{...h,injured:!0,injuryWeeksLeft:l,injuryType:e.payload.severity,severeInjuryCount:m,retiring:A}}return h});return{...a,team:{...a.team,players:u}}}case"ADD_YELLOW_CARDS":{const n=e.payload.cards||[];if(n.length===0)return a;const i=new Set,s=a.team.players.map(o=>{const l=n.filter(u=>u.playerName===o.name).length;if(l===0)return o;const c=(o.yellowCards||0)+l;return c>=5?(i.add(o.name),{...o,yellowCards:0,suspended:!0,suspensionType:"yellow",suspensionMatches:1}):{...o,yellowCards:c}});let r=a.lineup||{};return i.size>0&&(r={...r},Object.keys(r).forEach(o=>{r[o]&&i.has(r[o].name)&&delete r[o]})),{...a,team:{...a.team,players:s},lineup:ig(r,s,a.formation)}}case"ADD_RED_CARDS":{const n=e.payload.cards||[];if(n.length===0)return a;const i=new Set(n.map(l=>l.playerName)),s=a.team.players.map(l=>{const c=n.find(f=>f.playerName===l.name);if(!c)return l;const u=c.reason==="Segunda amarilla";return{...l,suspended:!0,suspensionType:u?"double_yellow":"red",suspensionMatches:u?1:2}}),o={...a.lineup||{}};return Object.keys(o).forEach(l=>{o[l]&&i.has(o[l].name)&&delete o[l]}),{...a,team:{...a.team,players:s},lineup:ig(o,s,a.formation)}}case"SERVE_SUSPENSIONS":{const n=a.team.players.map(l=>{if(!l.suspended||!l.suspensionMatches)return l;const c=l.suspensionMatches-1;return c<=0?{...l,suspended:!1,suspensionType:null,suspensionMatches:0}:{...l,suspensionMatches:c}}),s={...a.lineup||{}},r=n.filter(l=>l.suspended),o=new Set(r.map(l=>l.name));return Object.keys(s).forEach(l=>{s[l]&&o.has(s[l].name)&&delete s[l]}),{...a,team:{...a.team,players:n},lineup:ig(s,n,a.formation)}}case"HEAL_INJURIES":{const n=a.medicalSlots||[],i=[],s=a.facilitySpecs?.medical==="performance",r=a.team.players.map(l=>{if(l.injured&&l.injuryWeeksLeft>0){const c=l.injuryWeeksLeft-1;return c<=0?(i.push(l.name),{...l,injured:!1,injuryWeeksLeft:0,injuryType:null,treated:!1,...s?{postInjuryBonus:2,postInjuryWeeksLeft:4}:{}}):{...l,injuryWeeksLeft:c}}if(l.postInjuryWeeksLeft>0){const c=l.postInjuryWeeksLeft-1;return c<=0?{...l,postInjuryBonus:0,postInjuryWeeksLeft:0}:{...l,postInjuryWeeksLeft:c}}return l}),o=n.filter(l=>!i.includes(l));return{...a,team:{...a.team,players:r},medicalSlots:o}}case"APPLY_MEDICAL_TREATMENT":{const{playerName:n,healingWeeks:i,cost:s}=e.payload,r=a.team?.players?.find(m=>m.name===n),o=a.medicalSlots||[];if(!r||!r.injured||o.includes(n)||a.money<s)return a;const l=r.injuryWeeksLeft,c=Math.max(0,l-i),u=l-c,h=a.team.players.map(m=>m.name===n?{...m,injuryWeeksLeft:c,injured:c>0,treated:!0}:m),f=c>0?[...o,n]:o;return{...a,team:{...a.team,players:h},medicalSlots:f,money:a.money-s,facilityStats:{...a.facilityStats,medical:{...a.facilityStats?.medical,weeksSaved:(a.facilityStats?.medical?.weeksSaved||0)+u,treatmentsApplied:(a.facilityStats?.medical?.treatmentsApplied||0)+1}},messages:[{id:Date.now(),type:"medical",titleKey:"gameMessages.treatmentApplied",contentKey:"gameMessages.medicalTreatment",contentParams:{player:n,oldWeeks:l,newWeeks:c,cost:`${(s/1e6).toFixed(1)}M`},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}},...a.messages].slice(0,50)}}case"UPDATE_SETTINGS":return{...a,settings:{...a.settings,...e.payload}};case"SET_TRAINING":return{...a,training:{...a.training,...e.payload}};case"SET_SEASON_OBJECTIVES":return{...a,seasonObjectives:e.payload};case"SET_MANAGER_RATING":return{...a,managerRating:e.payload};case"SET_JOB_OFFERS":return{...a,jobOffers:e.payload};case"APPLY_TRAINING":{if(!a.team?.players||!a.training)return a;a.training.type;const n=a.training.intensity||"normal",i=a.facilities?.training||0,s={light:.5,normal:1,intense:1.5},r=[0,.1,.2,.35],o={light:.02,normal:.05,intense:.12},l=s[n]||1,c=r[i]||0,u=o[n]||.05,h=a.team.players.map(f=>{if(f.injured)return f;const m=f.age<=21?1.5:f.age<=25?1.2:f.age<=29?1:f.age<=33?.6:.3,A=f.overall<70?1.3:f.overall<75?1.1:f.overall<80?1:f.overall<85?.8:.5,T=.05*l*m*A*(1+c),M=(f.trainingProgress||0)+T;let N=f.overall,I=M;if(M>=1){const G=Math.floor(M);N=Math.min(99,f.overall+G),I=M-G}return Math.random()<u&&!f.injured?{...f,overall:N,trainingProgress:I,injured:!0,injuryWeeksLeft:1+Math.floor(Math.random()*2),injuryType:"training"}:{...f,overall:N,trainingProgress:I}});return{...a,team:{...a.team,players:h}}}case"GENERATE_YOUTH_PLAYER":{const n=a.facilities?.youth||0,i=a.facilitySpecs?.youth||"general",s=VG(n,i);return{...a,team:{...a.team,players:[...a.team.players,s]},facilityStats:{...a.facilityStats,youth:{playersGenerated:(a.facilityStats?.youth?.playersGenerated||0)+1,totalOvr:(a.facilityStats?.youth?.totalOvr||0)+s.overall}}}}case"SET_FACILITY_SPEC":return a.facilitySpecsLocked?.[e.payload.facility]?a:{...a,facilitySpecs:{...a.facilitySpecs,[e.payload.facility]:e.payload.spec},facilitySpecsLocked:{...a.facilitySpecsLocked,[e.payload.facility]:!0}};case"SET_PENDING_EVENT":return{...a,pendingEvent:e.payload};case"HANDLE_EVENT_CHOICE":return a.pendingEvent?mye(a,a.pendingEvent,e.payload):a;case"DISMISS_EVENT":return{...a,pendingEvent:null};case"INIT_EUROPEAN_COMPETITIONS":return{...a,europeanCompetitions:e.payload,pendingEuropeanMatch:null};case"COMPLETE_EUROPEAN_MATCH":{const{competitionId:n,matchResult:i,matchday:s,phase:r}=e.payload;let o={...a.europeanCompetitions};const l=o.competitions[n];if(!l)return a;let c;r==="league"?c=WG(l,i,s):c=$G(l,i,r),o={...o,competitions:{...o.competitions,[n]:c}};let u=[],h=null;if(r==="league"&&s===8&&c.currentMatchday>=8){const N=nv(c,a.teamId);o.competitions[n]=N.updatedState,u=N.messages,N.playerMatch&&(h={...N.playerMatch,competitionId:n,competitionName:c.config?.name||n,phase:N.updatedState.phase})}if(r!=="league"){const N=o.competitions[n],I=nv(N,a.teamId);I.updatedState.phase!==N.phase&&(o.competitions[n]=I.updatedState,u.push(...I.messages),I.playerMatch&&(h={...I.playerMatch,competitionId:n,competitionName:N.config?.name||n,phase:I.updatedState.phase}))}const f=o.competitions[n],m=f.prizesMoney?.[a.teamId]||0,A=l.prizesMoney?.[a.teamId]||0,x=m-A,T=x>0?[{id:Date.now(),type:"european",titleKey:"gameMessages.europeanIncome",titleParams:{icon:f.config.icon},contentKey:"gameMessages.prizeMoneyContent",contentParams:{competition:f.config.shortName,amount:`${(x/1e6).toFixed(1)}M`},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}}]:[],E=u.map(N=>({id:Date.now()+Math.random(),type:"european",title:N.title,content:N.content,dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}}));let M={};if(a.gameMode==="contrarreloj"&&a.contrarrelojData&&!a.contrarrelojData.finished&&f.phase==="completed"&&f.finalResult?.winner?.teamId===a.teamId)if(n==="championsLeague"){const N=[...a.contrarrelojData.trophies||[],{type:"champions",season:a.currentSeason,name:f.config?.name||"Continental Champions Cup"}];M={contrarrelojData:{...a.contrarrelojData,trophies:N,won:!0,finished:!0,wonCompetition:"champions"},currentScreen:"contrarreloj_end"}}else{const N=n==="europaLeague"?"europaLeague":"conference";M={contrarrelojData:{...a.contrarrelojData,trophies:[...a.contrarrelojData.trophies||[],{type:N,season:a.currentSeason,name:f.config?.name||n}]}}}return{...a,europeanCompetitions:o,pendingEuropeanMatch:h,money:a.money+x,messages:[...E,...T,...a.messages].slice(0,50),...M}}case"ADVANCE_EUROPEAN_PHASE":{const{competitionId:n}=e.payload,i={...a.europeanCompetitions},s=i.competitions[n];if(!s)return a;const{updatedState:r,playerMatch:o,messages:l}=nv(s,a.teamId);i.competitions[n]=r;const c=l.map(h=>({id:Date.now()+Math.random(),type:"european",title:h.title,content:h.content,dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}}));let u=a.pendingEuropeanMatch;return o&&(u={...o,competitionId:n,competitionName:s.config?.name||n,phase:r.phase}),{...a,europeanCompetitions:i,pendingEuropeanMatch:u,messages:[...c,...a.messages].slice(0,50)}}case"CLEAR_EUROPEAN_MATCH":return{...a,pendingEuropeanMatch:null};case"INIT_SA_COMPETITIONS":return{...a,saCompetitions:e.payload,pendingSAMatch:null};case"COMPLETE_SA_MATCH":{const{competitionId:n,matchResult:i,matchday:s,phase:r}=e.payload;let o={...a.saCompetitions};const l=o.competitions[n];if(!l)return a;let c;r==="league"?c=YG(l,i,s):c=XG(l,i,r),o={...o,competitions:{...o.competitions,[n]:c}};let u=[],h=null;if(r==="league"&&s===8&&c.currentMatchday>=8){const N=Ub(c,a.teamId);o.competitions[n]=N.updatedState,u=N.messages,N.playerMatch&&(h={...N.playerMatch,competitionId:n,competitionName:c.config?.name||n,phase:N.updatedState.phase})}if(r!=="league"){const N=o.competitions[n],I=Ub(N,a.teamId);I.updatedState.phase!==N.phase&&(o.competitions[n]=I.updatedState,u.push(...I.messages),I.playerMatch&&(h={...I.playerMatch,competitionId:n,competitionName:N.config?.name||n,phase:I.updatedState.phase}))}const f=o.competitions[n],m=f.prizesMoney?.[a.teamId]||0,A=l.prizesMoney?.[a.teamId]||0,x=m-A,T=x>0?[{id:Date.now(),type:"southamerican",titleKey:"gameMessages.continentalIncome",titleParams:{icon:f.config.icon},contentKey:"gameMessages.prizeMoneyContent",contentParams:{competition:f.config.shortName,amount:`$${(x/1e6).toFixed(1)}M`},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}}]:[],E=u.map(N=>({id:Date.now()+Math.random(),type:"southamerican",title:N.title,content:N.content,dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}}));let M={};if(a.gameMode==="contrarreloj"&&a.contrarrelojData&&!a.contrarrelojData.finished&&f.phase==="completed"&&f.finalResult?.winner?.teamId===a.teamId)if(n==="copaLibertadores"){const N=[...a.contrarrelojData.trophies||[],{type:"libertadores",season:a.currentSeason,name:f.config?.name||"South American Champions Cup"}];M={contrarrelojData:{...a.contrarrelojData,trophies:N,won:!0,finished:!0,wonCompetition:"libertadores"},currentScreen:"contrarreloj_end"}}else M={contrarrelojData:{...a.contrarrelojData,trophies:[...a.contrarrelojData.trophies||[],{type:"copaSudamericana",season:a.currentSeason,name:f.config?.name||"Copa Sudamericana"}]}};return{...a,saCompetitions:o,pendingSAMatch:h,money:a.money+x,messages:[...E,...T,...a.messages].slice(0,50),...M}}case"CLEAR_SA_MATCH":return{...a,pendingSAMatch:null};case"SET_EUROPEAN_CALENDAR":return{...a,europeanCalendar:e.payload};case"INIT_CUP_COMPETITION":return{...a,cupCompetition:e.payload,pendingCupMatch:null};case"COMPLETE_CUP_MATCH":{const{roundIdx:n,matchIdx:i,homeScore:s,awayScore:r}=e.payload;if(!a.cupCompetition)return a;const o=pZ(a.cupCompetition,n,i,s,r,a.teamId),l=[],c=a.cupCompetition.rounds[n]?.matches[i];if(c){const h=c.homeTeam?.teamId===a.teamId,f=h?s:r,m=h?r:s,A=h?c.awayTeam?.teamName:c.homeTeam?.teamName,x=o.rounds[n]?.matches[i]?.winnerId===a.teamId;l.push({id:Date.now(),type:"cup",titleKey:"gameMessages.cupMatchResult",titleParams:{icon:o.config?.icon||"",cup:o.config?.shortName||"Cup",team:a.team.name,playerScore:f,rivalScore:m,rival:A||"Rival"},contentKey:x?"gameMessages.cupAdvance":"gameMessages.cupEliminated",dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}})}let u={};return o.winner===a.teamId&&(l.push({id:Date.now()+1,type:"cup",titleKey:"gameMessages.cupChampionTitle",titleParams:{icon:o.config?.icon||"",cup:(o.config?.name||"Cup").toUpperCase()},contentKey:"gameMessages.cupChampionContent",contentParams:{team:a.team.name,cup:o.config?.name||"Cup"},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}}),a.gameMode==="contrarreloj"&&a.contrarrelojData&&(u={contrarrelojData:{...a.contrarrelojData,trophies:[...a.contrarrelojData.trophies||[],{type:"cup",season:a.currentSeason,name:o.config?.name||"Copa Nacional"}]}})),{...a,cupCompetition:o,pendingCupMatch:null,messages:[...l,...a.messages].slice(0,50),...u}}case"CLEAR_CUP_MATCH":return{...a,pendingCupMatch:null};case"LOAN_OUT_PLAYER":{const{player:n,toTeamId:i,toTeamName:s,loanFee:r,salaryShare:o,purchaseOption:l}=e.payload,c=a.team.players.filter(m=>m.name!==n.name),u={};a.lineup&&Object.entries(a.lineup).forEach(([m,A])=>{A&&A.name!==n.name&&(u[m]=A)});const h=dD(n,{id:a.teamId,name:a.team.name},{id:i,name:s},r,o,l),f=(a.leagueTeams||[]).map(m=>{if(m.id===i){const A={...n,onLoan:!0,loanFromTeam:a.team.name,loanFromTeamId:a.teamId,teamId:i};return{...m,players:[...m.players||[],A],budget:(m.budget||5e7)-r}}return m});return{...a,team:{...a.team,players:c},lineup:ig(u,c,a.formation),convocados:(a.convocados||[]).filter(m=>m!==n.name),money:a.money+r,activeLoans:[...a.activeLoans||[],h],leagueTeams:f,messages:[{id:Date.now(),type:"loan",titleKey:"gameMessages.playerLoaned",contentKey:"gameMessages.playerLoanedContent",contentParams:{player:n.name,team:s,fee:Sn(r),option:l?Sn(l):""},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}},...a.messages].slice(0,50)}}case"LOAN_IN_PLAYER":{const{player:n,fromTeamId:i,fromTeamName:s,loanFee:r,salaryShare:o,purchaseOption:l}=e.payload;if(a.money<r)return a;const c={...n,onLoan:!0,loanFromTeam:s,loanFromTeamId:i,loanSalaryShare:o,teamId:a.teamId},u=dD(n,{id:i,name:s},{id:a.teamId,name:a.team.name},r,o,l),h=(a.leagueTeams||[]).map(f=>f.id===i?{...f,players:(f.players||[]).filter(m=>m.name!==n.name),budget:(f.budget||5e7)+r}:f);return{...a,team:{...a.team,players:[...a.team.players,c]},money:a.money-r,activeLoans:[...a.activeLoans||[],u],leagueTeams:h,messages:[{id:Date.now(),type:"loan",titleKey:"gameMessages.playerReceivedOnLoan",contentKey:"gameMessages.playerReceivedOnLoanContent",contentParams:{player:n.name,team:s,fee:Sn(r),option:l?Sn(l):""},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}},...a.messages].slice(0,50)}}case"EXPIRE_LOANS":{const n=a.activeLoans||[],{expiredLoans:i,remainingLoans:s,messages:r}=nq(n,a.leagueTeams);let o=(a.team?.players||[]).filter(u=>!u.onLoan);const l=i.filter(u=>u.fromTeamId===a.teamId);for(const u of l)u.playerData&&o.push({...u.playerData,onLoan:!1,loanFromTeam:void 0,loanFromTeamId:void 0,loanSalaryShare:void 0,teamId:a.teamId});const c=r.map(u=>({id:Date.now()+Math.random(),type:u.type,title:u.title,content:u.content,dateKey:"gameMessages.endOfSeason",dateParams:{season:a.currentSeason}}));return{...a,team:{...a.team,players:o},activeLoans:s,loanHistory:[...a.loanHistory||[],...i],messages:[...c,...a.messages].slice(0,50)}}case"EXERCISE_LOAN_PURCHASE":{const{loanId:n}=e.payload,i=(a.activeLoans||[]).find(l=>l.id===n);if(!i||!i.purchaseOption||i.status!=="active"||a.money<i.purchaseOption)return a;const s=a.team.players.map(l=>l.name===i.playerId&&l.onLoan?{...l,onLoan:!1,loanFromTeam:void 0,loanFromTeamId:void 0,loanSalaryShare:void 0,contractYears:4}:l),r=(a.activeLoans||[]).map(l=>l.id===n?{...l,status:"purchased"}:l),o=(a.leagueTeams||[]).map(l=>l.id===i.fromTeamId?{...l,budget:(l.budget||5e7)+i.purchaseOption}:l);return{...a,team:{...a.team,players:s},money:a.money-i.purchaseOption,activeLoans:r,loanHistory:[...a.loanHistory||[],{...i,status:"purchased"}],leagueTeams:o,messages:[{id:Date.now(),type:"transfer",titleKey:"gameMessages.purchaseOptionExecuted",contentKey:"gameMessages.purchaseOptionContent",contentParams:{player:i.playerData?.name||i.playerId,amount:Sn(i.purchaseOption)},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}},...a.messages].slice(0,50)}}case"ACCEPT_LOAN_OFFER":{const n=e.payload,i=a.team.players.find(c=>c.name===n.playerId);if(!i)return a;const s=a.team.players.filter(c=>c.name!==n.playerId),r={};a.lineup&&Object.entries(a.lineup).forEach(([c,u])=>{u&&u.name!==n.playerId&&(r[c]=u)});const o=dD(i,{id:a.teamId,name:a.team.name},{id:n.toTeamId,name:n.toTeamName},n.loanFee,n.salaryShare,n.purchaseOption),l=(a.leagueTeams||[]).map(c=>{if(c.id===n.toTeamId){const u={...i,onLoan:!0,loanFromTeam:a.team.name,loanFromTeamId:a.teamId,teamId:n.toTeamId};return{...c,players:[...c.players||[],u],budget:(c.budget||5e7)-n.loanFee}}return c});return{...a,team:{...a.team,players:s},lineup:ig(r,s,a.formation),convocados:(a.convocados||[]).filter(c=>c!==n.playerId),money:a.money+n.loanFee,activeLoans:[...a.activeLoans||[],o],incomingLoanOffers:(a.incomingLoanOffers||[]).filter(c=>c.id!==n.id),leagueTeams:l,messages:[{id:Date.now(),type:"loan",titleKey:"gameMessages.loanAccepted",contentKey:"gameMessages.playerLoanedContent",contentParams:{player:i.name,team:n.toTeamName,fee:Sn(n.loanFee),option:""},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}},...a.messages].slice(0,50)}}case"REJECT_LOAN_OFFER":{const n=e.payload;return{...a,incomingLoanOffers:(a.incomingLoanOffers||[]).filter(i=>i.id!==n.id)}}case"SET_TOURNAMENT_PHASE":return{...a,currentTournament:e.payload};case"SAVE_APERTURA_TABLE":return{...a,aperturaTable:e.payload};case"COMPLETE_APCL_FINAL":{const n=e.payload;return{...a,aperturaClausuraFinal:n,pendingAperturaClausuraFinal:null,messages:[{id:Date.now(),type:"league",titleKey:"gameMessages.aperturaClausuraFinalResult",contentKey:n.hadFinal?"gameMessages.aperturaClausuraFinalResultContent":"gameMessages.directChampionShort",contentParams:n.hadFinal?{winner:n.winnerName,league:"",leg1Home:n.leg1?.homeScore,leg1Away:n.leg1?.awayScore,leg2Home:n.leg2?.homeScore,leg2Away:n.leg2?.awayScore}:{winner:n.winnerName},dateKey:"gameMessages.weekDate",dateParams:{week:a.currentWeek}},...a.messages].slice(0,50)}}case"SET_GAME_MODE":return{...a,gameMode:e.payload};case"CONTRARRELOJ_WIN":return a.gameMode!=="contrarreloj"||!a.contrarrelojData?a:{...a,contrarrelojData:{...a.contrarrelojData,won:!0,finished:!0,wonCompetition:e.payload?.competition||"champions"},currentScreen:"contrarreloj_end"};case"CONTRARRELOJ_LOSE":return a.gameMode!=="contrarreloj"||!a.contrarrelojData?a:{...a,contrarrelojData:{...a.contrarrelojData,won:!1,finished:!0,loseReason:e.payload?.reason||"fired"},currentScreen:"contrarreloj_end"};case"CONTRARRELOJ_ADD_TROPHY":{if(!a.contrarrelojData)return a;const n=e.payload;return{...a,contrarrelojData:{...a.contrarrelojData,trophies:[...a.contrarrelojData.trophies||[],n]}}}case"CONTRARRELOJ_INCREMENT_SEASON":return a.contrarrelojData?{...a,contrarrelojData:{...a.contrarrelojData,seasonsPlayed:(a.contrarrelojData.seasonsPlayed||1)+1}}:a;case"CONTRARRELOJ_RECORD_SEASON":{if(!a.contrarrelojData)return a;const n=e.payload;return{...a,contrarrelojData:{...a.contrarrelojData,seasonHistory:[...a.contrarrelojData.seasonHistory||[],n]}}}case"RESET_GAME":return localStorage.removeItem("pcfutbol_saveId"),localStorage.removeItem("pcfutbol_local_save"),{...Zv,loaded:!0,settings:a.settings};default:return a}}function Jye({children:a}){const[e,n]=ge.useReducer(vZ,Zv),i=ge.useRef(null),s=()=>"save_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),r=async()=>{if(!e.gameStarted||e.gameMode==="contrarreloj")return;const f={...e,lastSaved:new Date().toISOString()};{const m=e.saveId||s();f.saveId=m;try{await Kf(Ra(Kn,"saves",m),f),localStorage.setItem("pcfutbol_saveId",m),console.log(" Game saved to Firebase!")}catch(A){console.error("Error saving game:",A)}}},o=()=>{try{const f=localStorage.getItem("pcfutbol_local_save");if(f){const m=JSON.parse(f);return n({type:"LOAD_SAVE",payload:m}),console.log(" Game loaded from localStorage!"),!0}return!1}catch(f){return console.error("Error loading from localStorage:",f),!1}},l=async f=>{try{const m=Ra(Kn,"saves",f),A=await go(m);return A.exists()?(n({type:"LOAD_SAVE",payload:A.data()}),!0):!1}catch(m){return console.error("Error loading game:",m),!1}};ge.useEffect(()=>{const f=async()=>{try{if(!Qye){const A=localStorage.getItem("pcfutbol_saveId");A?await l(A)||n({type:"LOAD_SAVE",payload:{loaded:!0}}):n({type:"LOAD_SAVE",payload:{loaded:!0}})}}catch(A){console.error("Error loading initial state:",A),n({type:"LOAD_SAVE",payload:{loaded:!0}})}},m=setTimeout(()=>{e.loaded||(console.warn("Loading timeout, going to main menu"),n({type:"LOAD_SAVE",payload:{loaded:!0}}))},3e3);return f(),()=>clearTimeout(m)},[]),ge.useEffect(()=>{if(e.gameStarted&&e.gameMode!=="contrarreloj"&&e.settings?.autoSave!==!1){const f=setTimeout(r,2e3);return()=>clearTimeout(f)}},[e.currentWeek,e.money,e.team]),ge.useEffect(()=>{if(!(e.gameMode!=="contrarreloj"||!e.gameStarted||!e._contrarrelojUserId)){if(e.contrarrelojData?.finished){yF(e._contrarrelojUserId).catch(f=>console.error("Error deleting contrarreloj save:",f));return}return i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{const f={...e};delete f.loaded,delete f._contrarrelojUserId,sD(e._contrarrelojUserId,f).then(()=>console.log(" Contrarreloj auto-saved to Firebase")).catch(m=>console.error("Error auto-saving contrarreloj:",m))},500),()=>{i.current&&clearTimeout(i.current)}}},[e.currentWeek,e.currentSeason,e.money,e.team,e.leagueTable,e.results,e.contrarrelojData?.finished,e.gameMode,e.currentScreen]);const c=ge.useRef(e);c.current=e,ge.useEffect(()=>{if(e.gameMode!=="contrarreloj"||!e.gameStarted||!e._contrarrelojUserId||e.contrarrelojData?.finished)return;const f=setInterval(()=>{const m=c.current;if(m.gameMode==="contrarreloj"&&m.gameStarted&&m._contrarrelojUserId&&!m.contrarrelojData?.finished){const A={...m};delete A.loaded,delete A._contrarrelojUserId,sD(m._contrarrelojUserId,A).then(()=>console.log(" Contrarreloj periodic save OK")).catch(x=>console.error("Periodic save error:",x))}},3e4);return()=>clearInterval(f)},[e.gameMode,e.gameStarted,e._contrarrelojUserId,e.contrarrelojData?.finished]);const u=ge.useRef(null);ge.useEffect(()=>{if(!(e.gameMode!=="promanager"||!e.gameStarted||!e._proManagerUserId)){if(e.proManagerData?.finished){xF(e._proManagerUserId).catch(()=>{});return}return u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{const f={...e};delete f.loaded,delete f._proManagerUserId,bG(e._proManagerUserId,f).then(()=>console.log(" ProManager auto-saved")).catch(m=>console.error("ProManager save error:",m))},500),()=>{u.current&&clearTimeout(u.current)}}},[e.currentWeek,e.currentSeason,e.money,e.team,e.leagueTable,e.proManagerData,e.gameMode,e.currentScreen]),ge.useEffect(()=>{const f=()=>{const x=c.current;if(x.gameMode==="contrarreloj"&&x.gameStarted&&x._contrarrelojUserId&&!x.contrarrelojData?.finished){const T={...x};delete T.loaded,delete T._contrarrelojUserId,sD(x._contrarrelojUserId,T).catch(()=>{}),console.log(" Contrarreloj save-on-exit triggered")}if(x.gameMode==="promanager"&&x.gameStarted&&x._proManagerUserId&&!x.proManagerData?.finished){const T={...x};delete T.loaded,delete T._proManagerUserId,bG(x._proManagerUserId,T).catch(()=>{}),console.log(" ProManager save-on-exit triggered")}x.gameStarted&&x.gameMode!=="contrarreloj"&&x.gameMode!=="promanager"&&x.settings?.autoSave!==!1&&r()},m=()=>{document.visibilityState==="hidden"&&f()};document.addEventListener("visibilitychange",m),window.addEventListener("beforeunload",f),window.addEventListener("pagehide",f);let A=null;return Yh(async()=>{const{App:x}=await import("./index-CjJ4hg2Y.js");return{App:x}},[]).then(({App:x})=>{x.addListener("pause",f).then(T=>{A=T}).catch(()=>{})}).catch(()=>{}),()=>{document.removeEventListener("visibilitychange",m),window.removeEventListener("beforeunload",f),window.removeEventListener("pagehide",f),A&&A.remove()}},[]);const h={state:e,dispatch:n,saveGame:r,loadGame:l};return d.jsx(yZ.Provider,{value:h,children:a})}function Va(){const a=ge.useContext(yZ);if(!a)throw new Error("useGame must be used within a GameProvider");return a}var G_;(function(a){a.Unimplemented="UNIMPLEMENTED",a.Unavailable="UNAVAILABLE"})(G_||(G_={}));class hD extends Error{constructor(e,n,i){super(e),this.message=e,this.code=n,this.data=i}}const Zye=a=>{var e,n;return a?.androidBridge?"android":!((n=(e=a?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},e1e=a=>{const e=a.CapacitorCustomPlatform||null,n=a.Capacitor||{},i=n.Plugins=n.Plugins||{},s=()=>e!==null?e.name:Zye(a),r=()=>s()!=="web",o=f=>{const m=u.get(f);return!!(m?.platforms.has(s())||l(f))},l=f=>{var m;return(m=n.PluginHeaders)===null||m===void 0?void 0:m.find(A=>A.name===f)},c=f=>a.console.error(f),u=new Map,h=(f,m={})=>{const A=u.get(f);if(A)return console.warn(`Capacitor plugin "${f}" already registered. Cannot register plugins twice.`),A.proxy;const x=s(),T=l(f);let E;const M=async()=>(!E&&x in m?E=typeof m[x]=="function"?E=await m[x]():E=m[x]:e!==null&&!E&&"web"in m&&(E=typeof m.web=="function"?E=await m.web():E=m.web),E),N=(j,L)=>{var U,q;if(T){const K=T?.methods.find(H=>L===H.name);if(K)return K.rtype==="promise"?H=>n.nativePromise(f,L.toString(),H):(H,X)=>n.nativeCallback(f,L.toString(),H,X);if(j)return(U=j[L])===null||U===void 0?void 0:U.bind(j)}else{if(j)return(q=j[L])===null||q===void 0?void 0:q.bind(j);throw new hD(`"${f}" plugin is not implemented on ${x}`,G_.Unimplemented)}},I=j=>{let L;const U=(...q)=>{const K=M().then(H=>{const X=N(H,j);if(X){const ne=X(...q);return L=ne?.remove,ne}else throw new hD(`"${f}.${j}()" is not implemented on ${x}`,G_.Unimplemented)});return j==="addListener"&&(K.remove=async()=>L()),K};return U.toString=()=>`${j.toString()}() { [capacitor code] }`,Object.defineProperty(U,"name",{value:j,writable:!1,configurable:!1}),U},F=I("addListener"),G=I("removeListener"),O=(j,L)=>{const U=F({eventName:j},L),q=async()=>{const H=await U;G({eventName:j,callbackId:H},L)},K=new Promise(H=>U.then(()=>H({remove:q})));return K.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await q()},K},D=new Proxy({},{get(j,L){switch(L){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return T?O:F;case"removeListener":return G;default:return I(L)}}});return i[f]=D,u.set(f,{name:f,proxy:D,platforms:new Set([...Object.keys(m),...T?[x]:[]])}),D};return n.convertFileSrc||(n.convertFileSrc=f=>f),n.getPlatform=s,n.handleError=c,n.isNativePlatform=r,n.isPluginAvailable=o,n.registerPlugin=h,n.Exception=hD,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},t1e=a=>a.Capacitor=e1e(a),OS=t1e(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),DF=OS.registerPlugin;class kF{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let i=!1;this.listeners[e]||(this.listeners[e]=[],i=!0),this.listeners[e].push(n);const r=this.windowListeners[e];r&&!r.registered&&this.addWindowListener(r),i&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,n);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,i){const s=this.listeners[e];if(!s){if(i){let r=this.retainedEventArguments[e];r||(r=[]),r.push(n),this.retainedEventArguments[e]=r}return}s.forEach(r=>r(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:i=>{this.notifyListeners(n,i)}}}unimplemented(e="not implemented"){return new OS.Exception(e,G_.Unimplemented)}unavailable(e="not available"){return new OS.Exception(e,G_.Unavailable)}async removeListener(e,n){const i=this.listeners[e];if(!i)return;const s=i.indexOf(n);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(i=>{this.notifyListeners(e,i)}))}}const aq=a=>encodeURIComponent(a).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),iq=a=>a.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class n1e extends kF{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[s,r]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=iq(s).trim(),r=iq(r).trim(),n[s]=r}),n}async setCookie(e){try{const n=aq(e.key),i=aq(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,r=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${i||""}${s}; path=${r}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}DF("CapacitorCookies",{web:()=>new n1e});const a1e=async a=>new Promise((e,n)=>{const i=new FileReader;i.onload=()=>{const s=i.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},i.onerror=s=>n(s),i.readAsDataURL(a)}),i1e=(a={})=>{const e=Object.keys(a);return Object.keys(a).map(s=>s.toLocaleLowerCase()).reduce((s,r,o)=>(s[r]=a[e[o]],s),{})},s1e=(a,e=!0)=>a?Object.entries(a).reduce((i,s)=>{const[r,o]=s;let l,c;return Array.isArray(o)?(c="",o.forEach(u=>{l=e?encodeURIComponent(u):u,c+=`${r}=${l}&`}),c.slice(0,-1)):(l=e?encodeURIComponent(o):o,c=`${r}=${l}`),`${i}&${c}`},"").substr(1):null,r1e=(a,e={})=>{const n=Object.assign({method:a.method||"GET",headers:a.headers},e),s=i1e(a.headers)["content-type"]||"";if(typeof a.data=="string")n.body=a.data;else if(s.includes("application/x-www-form-urlencoded")){const r=new URLSearchParams;for(const[o,l]of Object.entries(a.data||{}))r.set(o,l);n.body=r.toString()}else if(s.includes("multipart/form-data")||a.data instanceof FormData){const r=new FormData;if(a.data instanceof FormData)a.data.forEach((l,c)=>{r.append(c,l)});else for(const l of Object.keys(a.data))r.append(l,a.data[l]);n.body=r;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(s.includes("application/json")||typeof a.data=="object")&&(n.body=JSON.stringify(a.data));return n};class o1e extends kF{async request(e){const n=r1e(e,e.webFetchExtra),i=s1e(e.params,e.shouldEncodeUrlParams),s=i?`${e.url}?${i}`:e.url,r=await fetch(s,n),o=r.headers.get("content-type")||"";let{responseType:l="text"}=r.ok?e:{};o.includes("application/json")&&(l="json");let c,u;switch(l){case"arraybuffer":case"blob":u=await r.blob(),c=await a1e(u);break;case"json":c=await r.json();break;default:c=await r.text()}const h={};return r.headers.forEach((f,m)=>{h[m]=f}),{data:c,headers:h,status:r.status,url:r.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}DF("CapacitorHttp",{web:()=>new o1e});var sq;(function(a){a.Dark="DARK",a.Light="LIGHT",a.Default="DEFAULT"})(sq||(sq={}));var rq;(function(a){a.StatusBar="StatusBar",a.NavigationBar="NavigationBar"})(rq||(rq={}));class l1e extends kF{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}DF("SystemBars",{web:()=>new l1e});const oq=new Bh,_Z=OS.isNativePlatform();async function xZ(a,e,n){const s=(await Nge(Tr,a,e)).user;return await Kf(Ra(Kn,"users",s.uid),{email:s.email,displayName:n||a.split("@")[0],createdAt:Hi(),emailVerified:!1}),await CJ(s,{url:_Z?"https://pcfutbol-web.firebaseapp.com":window.location.origin+"/pcfutbol-web/",handleCodeInApp:!1}),s}async function bZ(a,e){return(await Rge(Tr,a,e)).user}async function SZ(){if(_Z){const{SocialLogin:a}=await Yh(async()=>{const{SocialLogin:r}=await import("./index-oZ3m2Ggg.js");return{SocialLogin:r}},[]);await a.initialize({google:{webClientId:"664376263748-9s0h5cdt4od2q3eb5gf4eo2kki71vpdn.apps.googleusercontent.com"}});const n=(await a.login({provider:"google",options:{}})).result?.idToken;if(!n)throw new Error("No se pudo obtener el token de Google");const i=Bh.credential(n),s=await wJ(Tr,i);return await hk(s.user),s.user}try{const e=(await e0e(Tr,oq)).user;return await hk(e),e}catch(a){if(console.warn("Popup failed, trying redirect:",a.code),a.code==="auth/popup-blocked"||a.code==="auth/popup-closed-by-user"||a.code==="auth/unauthorized-domain"||a.code==="auth/internal-error")return await r0e(Tr,oq),null;throw a}}async function hk(a){(await go(Ra(Kn,"users",a.uid))).exists()||await Kf(Ra(Kn,"users",a.uid),{email:a.email,displayName:a.displayName||a.email.split("@")[0],createdAt:Hi(),emailVerified:!0})}async function TZ(){await Dge(Tr)}async function c1e(a){await Cge(Tr,a,{url:window.location.origin+"/pcfutbol-web/",handleCodeInApp:!1})}async function u1e(){Tr.currentUser&&!Tr.currentUser.emailVerified&&await CJ(Tr.currentUser,{url:window.location.origin+"/pcfutbol-web/",handleCodeInApp:!1})}async function d1e(){try{const a=await l0e(Tr);if(a?.user)return await hk(a.user),a.user}catch(a){console.warn("Redirect result error:",a)}return null}function wZ(a){return Lge(Tr,a)}function lq(){return Tr.currentUser}async function h1e(a){if(Tr.currentUser)try{await wl(Ra(Kn,"users",Tr.currentUser.uid),{language:a})}catch(e){console.warn("Could not save language preference:",e)}}async function f1e(){if(Tr.currentUser)try{const a=await go(Ra(Kn,"users",Tr.currentUser.uid));if(a.exists()&&a.data().language)return a.data().language}catch(a){console.warn("Could not load language preference:",a)}return null}async function p1e(){return Tr.currentUser?(await Tr.currentUser.reload(),Tr.currentUser):null}const kh=()=>OS.getPlatform()==="android";class m1e{constructor(){this.isSignedIn=!1,this.player=null}async signIn(){if(!kh())throw new Error("Google Play Games is only available on Android");try{const{PlayGames:e}=await Yh(async()=>{const{PlayGames:i}=await import("./playGamesPlugin-B4Oz_TGJ.js");return{PlayGames:i}},__vite__mapDeps([0,1])),n=await e.signIn();if(n.isSignedIn)return this.isSignedIn=!0,this.player=n.player,await this.syncWithFirebase(n.player),n.player;throw new Error("Sign in failed")}catch(e){throw console.error("Play Games sign in error:",e),e}}async syncWithFirebase(e){const n=e.playerId,i=Ra(Kn,"users",`playgames_${n}`);return(await go(i)).exists()||await Kf(i,{displayName:e.displayName||"Player",playGamesId:n,avatarUrl:e.iconImageUrl||null,createdAt:Hi(),platform:"android",authProvider:"play_games"}),i}async signOut(){if(kh())try{const{PlayGames:e}=await Yh(async()=>{const{PlayGames:n}=await import("./playGamesPlugin-B4Oz_TGJ.js");return{PlayGames:n}},__vite__mapDeps([0,1]));await e.signOut(),this.isSignedIn=!1,this.player=null}catch(e){console.error("Play Games sign out error:",e)}}getPlayer(){return this.player}async isAuthenticated(){if(!kh())return!1;try{const{PlayGames:e}=await Yh(async()=>{const{PlayGames:i}=await import("./playGamesPlugin-B4Oz_TGJ.js");return{PlayGames:i}},__vite__mapDeps([0,1]));return(await e.isSignedIn()).isSignedIn}catch{return!1}}}const zb=new m1e,g1e={shouldUsePlayGames:()=>!1,getAvailableMethods:()=>["google","email"],signInWithPlayGames:async()=>{if(!kh())throw new Error("Play Games is only available on Android");return zb.signIn()},signInWithGoogle:async()=>SZ(),signInWithEmail:async(a,e)=>{if(kh())throw new Error("Email login not available on Android. Use Google Play Games.");return bZ(a,e)},registerWithEmail:async(a,e,n)=>{if(kh())throw new Error("Email registration not available on Android. Use Google Play Games.");return xZ(a,e,n)},signOut:async()=>{kh()&&await zb.signOut(),await TZ()},getCurrentUser:()=>kh()&&zb.isSignedIn?zb.getPlayer():lq(),isAuthenticated:async()=>kh()?zb.isAuthenticated():!!lq(),onAuthStateChange:a=>wZ(a)},xa=a=>typeof a=="string",Gb=()=>{let a,e;const n=new Promise((i,s)=>{a=i,e=s});return n.resolve=a,n.reject=e,n},cq=a=>a==null?"":""+a,A1e=(a,e,n)=>{a.forEach(i=>{e[i]&&(n[i]=e[i])})},y1e=/###/g,uq=a=>a&&a.indexOf("###")>-1?a.replace(y1e,"."):a,dq=a=>!a||xa(a),iS=(a,e,n)=>{const i=xa(e)?e.split("."):e;let s=0;for(;s<i.length-1;){if(dq(a))return{};const r=uq(i[s]);!a[r]&&n&&(a[r]=new n),Object.prototype.hasOwnProperty.call(a,r)?a=a[r]:a={},++s}return dq(a)?{}:{obj:a,k:uq(i[s])}},hq=(a,e,n)=>{const{obj:i,k:s}=iS(a,e,Object);if(i!==void 0||e.length===1){i[s]=n;return}let r=e[e.length-1],o=e.slice(0,e.length-1),l=iS(a,o,Object);for(;l.obj===void 0&&o.length;)r=`${o[o.length-1]}.${r}`,o=o.slice(0,o.length-1),l=iS(a,o,Object),l?.obj&&typeof l.obj[`${l.k}.${r}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${r}`]=n},v1e=(a,e,n,i)=>{const{obj:s,k:r}=iS(a,e,Object);s[r]=s[r]||[],s[r].push(n)},mN=(a,e)=>{const{obj:n,k:i}=iS(a,e);if(n&&Object.prototype.hasOwnProperty.call(n,i))return n[i]},_1e=(a,e,n)=>{const i=mN(a,n);return i!==void 0?i:mN(e,n)},EZ=(a,e,n)=>{for(const i in e)i!=="__proto__"&&i!=="constructor"&&(i in a?xa(a[i])||a[i]instanceof String||xa(e[i])||e[i]instanceof String?n&&(a[i]=e[i]):EZ(a[i],e[i],n):a[i]=e[i]);return a},av=a=>a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var x1e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const b1e=a=>xa(a)?a.replace(/[&<>"'\/]/g,e=>x1e[e]):a;class S1e{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const i=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,i),this.regExpQueue.push(e),i}}const T1e=[" ",",","?","!",";"],w1e=new S1e(20),E1e=(a,e,n)=>{e=e||"",n=n||"";const i=T1e.filter(o=>e.indexOf(o)<0&&n.indexOf(o)<0);if(i.length===0)return!0;const s=w1e.getRegExp(`(${i.map(o=>o==="?"?"\\?":o).join("|")})`);let r=!s.test(a);if(!r){const o=a.indexOf(n);o>0&&!s.test(a.substring(0,o))&&(r=!0)}return r},fk=(a,e,n=".")=>{if(!a)return;if(a[e])return Object.prototype.hasOwnProperty.call(a,e)?a[e]:void 0;const i=e.split(n);let s=a;for(let r=0;r<i.length;){if(!s||typeof s!="object")return;let o,l="";for(let c=r;c<i.length;++c)if(c!==r&&(l+=n),l+=i[c],o=s[l],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&c<i.length-1)continue;r+=c-r+1;break}s=o}return s},FS=a=>a?.replace("_","-"),M1e={type:"logger",log(a){this.output("log",a)},warn(a){this.output("warn",a)},error(a){this.output("error",a)},output(a,e){console?.[a]?.apply?.(console,e)}};class gN{constructor(e,n={}){this.init(e,n)}init(e,n={}){this.prefix=n.prefix||"i18next:",this.logger=e||M1e,this.options=n,this.debug=n.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,i,s){return s&&!this.debug?null:(xa(e[0])&&(e[0]=`${i}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new gN(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new gN(this.logger,e)}}var Gh=new gN;class _P{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(i=>{this.observers[i]||(this.observers[i]=new Map);const s=this.observers[i].get(n)||0;this.observers[i].set(n,s+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e,...n){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([s,r])=>{for(let o=0;o<r;o++)s(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([s,r])=>{for(let o=0;o<r;o++)s.apply(s,[e,...n])})}}class fq extends _P{constructor(e,n={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,i,s={}){const r=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,o=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,n],i&&(Array.isArray(i)?l.push(...i):xa(i)&&r?l.push(...i.split(r)):l.push(i)));const c=mN(this.data,l);return!c&&!n&&!i&&e.indexOf(".")>-1&&(e=l[0],n=l[1],i=l.slice(2).join(".")),c||!o||!xa(i)?c:fk(this.data?.[e]?.[n],i,r)}addResource(e,n,i,s,r={silent:!1}){const o=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let l=[e,n];i&&(l=l.concat(o?i.split(o):i)),e.indexOf(".")>-1&&(l=e.split("."),s=n,n=l[1]),this.addNamespaces(n),hq(this.data,l,s),r.silent||this.emit("added",e,n,i,s)}addResources(e,n,i,s={silent:!1}){for(const r in i)(xa(i[r])||Array.isArray(i[r]))&&this.addResource(e,n,r,i[r],{silent:!0});s.silent||this.emit("added",e,n,i)}addResourceBundle(e,n,i,s,r,o={silent:!1,skipCopy:!1}){let l=[e,n];e.indexOf(".")>-1&&(l=e.split("."),s=i,i=n,n=l[1]),this.addNamespaces(n);let c=mN(this.data,l)||{};o.skipCopy||(i=JSON.parse(JSON.stringify(i))),s?EZ(c,i,r):c={...c,...i},hq(this.data,l,c),o.silent||this.emit("added",e,n,i)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(s=>n[s]&&Object.keys(n[s]).length>0)}toJSON(){return this.data}}var MZ={processors:{},addPostProcessor(a){this.processors[a.name]=a},handle(a,e,n,i,s){return a.forEach(r=>{e=this.processors[r]?.process(e,n,i,s)??e}),e}};const CZ=Symbol("i18next/PATH_KEY");function C1e(){const a=[],e=Object.create(null);let n;return e.get=(i,s)=>(n?.revoke?.(),s===CZ?a:(a.push(s),n=Proxy.revocable(i,e),n.proxy)),Proxy.revocable(Object.create(null),e).proxy}function pk(a,e){const{[CZ]:n}=a(C1e());return n.join(e?.keySeparator??".")}const pq={},fD=a=>!xa(a)&&typeof a!="boolean"&&typeof a!="number";class AN extends _P{constructor(e,n={}){super(),A1e(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Gh.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,n={interpolation:{}}){const i={...n};if(e==null)return!1;const s=this.resolve(e,i);if(s?.res===void 0)return!1;const r=fD(s.res);return!(i.returnObjects===!1&&r)}extractFromKey(e,n){let i=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");const s=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let r=n.ns||this.options.defaultNS||[];const o=i&&e.indexOf(i)>-1,l=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!E1e(e,i,s);if(o&&!l){const c=e.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:e,namespaces:xa(r)?[r]:r};const u=e.split(i);(i!==s||i===s&&this.options.ns.indexOf(u[0])>-1)&&(r=u.shift()),e=u.join(s)}return{key:e,namespaces:xa(r)?[r]:r}}translate(e,n,i){let s=typeof n=="object"?{...n}:n;if(typeof s!="object"&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),typeof s=="object"&&(s={...s}),s||(s={}),e==null)return"";typeof e=="function"&&(e=pk(e,{...this.options,...s})),Array.isArray(e)||(e=[String(e)]);const r=s.returnDetails!==void 0?s.returnDetails:this.options.returnDetails,o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,{key:l,namespaces:c}=this.extractFromKey(e[e.length-1],s),u=c[c.length-1];let h=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;h===void 0&&(h=":");const f=s.lng||this.language,m=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(f?.toLowerCase()==="cimode")return m?r?{res:`${u}${h}${l}`,usedKey:l,exactUsedKey:l,usedLng:f,usedNS:u,usedParams:this.getUsedParamsDetails(s)}:`${u}${h}${l}`:r?{res:l,usedKey:l,exactUsedKey:l,usedLng:f,usedNS:u,usedParams:this.getUsedParamsDetails(s)}:l;const A=this.resolve(e,s);let x=A?.res;const T=A?.usedKey||l,E=A?.exactUsedKey||l,M=["[object Number]","[object Function]","[object RegExp]"],N=s.joinArrays!==void 0?s.joinArrays:this.options.joinArrays,I=!this.i18nFormat||this.i18nFormat.handleAsObject,F=s.count!==void 0&&!xa(s.count),G=AN.hasDefaultValue(s),O=F?this.pluralResolver.getSuffix(f,s.count,s):"",D=s.ordinal&&F?this.pluralResolver.getSuffix(f,s.count,{ordinal:!1}):"",j=F&&!s.ordinal&&s.count===0,L=j&&s[`defaultValue${this.options.pluralSeparator}zero`]||s[`defaultValue${O}`]||s[`defaultValue${D}`]||s.defaultValue;let U=x;I&&!x&&G&&(U=L);const q=fD(U),K=Object.prototype.toString.apply(U);if(I&&U&&q&&M.indexOf(K)<0&&!(xa(N)&&Array.isArray(U))){if(!s.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const H=this.options.returnedObjectHandler?this.options.returnedObjectHandler(T,U,{...s,ns:c}):`key '${l} (${this.language})' returned an object instead of string.`;return r?(A.res=H,A.usedParams=this.getUsedParamsDetails(s),A):H}if(o){const H=Array.isArray(U),X=H?[]:{},ne=H?E:T;for(const Q in U)if(Object.prototype.hasOwnProperty.call(U,Q)){const Y=`${ne}${o}${Q}`;G&&!x?X[Q]=this.translate(Y,{...s,defaultValue:fD(L)?L[Q]:void 0,joinArrays:!1,ns:c}):X[Q]=this.translate(Y,{...s,joinArrays:!1,ns:c}),X[Q]===Y&&(X[Q]=U[Q])}x=X}}else if(I&&xa(N)&&Array.isArray(x))x=x.join(N),x&&(x=this.extendTranslation(x,e,s,i));else{let H=!1,X=!1;!this.isValidLookup(x)&&G&&(H=!0,x=L),this.isValidLookup(x)||(X=!0,x=l);const Q=(s.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&X?void 0:x,Y=G&&L!==x&&this.options.updateMissing;if(X||H||Y){if(this.logger.log(Y?"updateKey":"missingKey",f,u,l,Y?L:x),o){const oe=this.resolve(l,{...s,keySeparator:!1});oe&&oe.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ue=[];const pe=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if(this.options.saveMissingTo==="fallback"&&pe&&pe[0])for(let oe=0;oe<pe.length;oe++)ue.push(pe[oe]);else this.options.saveMissingTo==="all"?ue=this.languageUtils.toResolveHierarchy(s.lng||this.language):ue.push(s.lng||this.language);const Ee=(oe,Ae,be)=>{const Ce=G&&be!==x?be:Q;this.options.missingKeyHandler?this.options.missingKeyHandler(oe,u,Ae,Ce,Y,s):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(oe,u,Ae,Ce,Y,s),this.emit("missingKey",oe,u,Ae,x)};this.options.saveMissing&&(this.options.saveMissingPlurals&&F?ue.forEach(oe=>{const Ae=this.pluralResolver.getSuffixes(oe,s);j&&s[`defaultValue${this.options.pluralSeparator}zero`]&&Ae.indexOf(`${this.options.pluralSeparator}zero`)<0&&Ae.push(`${this.options.pluralSeparator}zero`),Ae.forEach(be=>{Ee([oe],l+be,s[`defaultValue${be}`]||L)})}):Ee(ue,l,L))}x=this.extendTranslation(x,e,s,A,i),X&&x===l&&this.options.appendNamespaceToMissingKey&&(x=`${u}${h}${l}`),(X||H)&&this.options.parseMissingKeyHandler&&(x=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${u}${h}${l}`:l,H?x:void 0,s))}return r?(A.res=x,A.usedParams=this.getUsedParamsDetails(s),A):x}extendTranslation(e,n,i,s,r){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const c=xa(e)&&(i?.interpolation?.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let u;if(c){const f=e.match(this.interpolator.nestingRegexp);u=f&&f.length}let h=i.replace&&!xa(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(h={...this.options.interpolation.defaultVariables,...h}),e=this.interpolator.interpolate(e,h,i.lng||this.language||s.usedLng,i),c){const f=e.match(this.interpolator.nestingRegexp),m=f&&f.length;u<m&&(i.nest=!1)}!i.lng&&s&&s.res&&(i.lng=this.language||s.usedLng),i.nest!==!1&&(e=this.interpolator.nest(e,(...f)=>r?.[0]===f[0]&&!i.context?(this.logger.warn(`It seems you are nesting recursively key: ${f[0]} in key: ${n[0]}`),null):this.translate(...f,n),i)),i.interpolation&&this.interpolator.reset()}const o=i.postProcess||this.options.postProcess,l=xa(o)?[o]:o;return e!=null&&l?.length&&i.applyPostProcessor!==!1&&(e=MZ.handle(l,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),e}resolve(e,n={}){let i,s,r,o,l;return xa(e)&&(e=[e]),e.forEach(c=>{if(this.isValidLookup(i))return;const u=this.extractFromKey(c,n),h=u.key;s=h;let f=u.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const m=n.count!==void 0&&!xa(n.count),A=m&&!n.ordinal&&n.count===0,x=n.context!==void 0&&(xa(n.context)||typeof n.context=="number")&&n.context!=="",T=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);f.forEach(E=>{this.isValidLookup(i)||(l=E,!pq[`${T[0]}-${E}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(l)&&(pq[`${T[0]}-${E}`]=!0,this.logger.warn(`key "${s}" for languages "${T.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),T.forEach(M=>{if(this.isValidLookup(i))return;o=M;const N=[h];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(N,h,M,E,n);else{let F;m&&(F=this.pluralResolver.getSuffix(M,n.count,n));const G=`${this.options.pluralSeparator}zero`,O=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(m&&(n.ordinal&&F.indexOf(O)===0&&N.push(h+F.replace(O,this.options.pluralSeparator)),N.push(h+F),A&&N.push(h+G)),x){const D=`${h}${this.options.contextSeparator||"_"}${n.context}`;N.push(D),m&&(n.ordinal&&F.indexOf(O)===0&&N.push(D+F.replace(O,this.options.pluralSeparator)),N.push(D+F),A&&N.push(D+G))}}let I;for(;I=N.pop();)this.isValidLookup(i)||(r=I,i=this.getResource(M,E,I,n))}))})}),{res:i,usedKey:s,exactUsedKey:r,usedLng:o,usedNS:l}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,i,s={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,n,i,s):this.resourceStore.getResource(e,n,i,s)}getUsedParamsDetails(e={}){const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=e.replace&&!xa(e.replace);let s=i?e.replace:e;if(i&&typeof e.count<"u"&&(s.count=e.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!i){s={...s};for(const r of n)delete s[r]}return s}static hasDefaultValue(e){const n="defaultValue";for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&n===i.substring(0,n.length)&&e[i]!==void 0)return!0;return!1}}class mq{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Gh.create("languageUtils")}getScriptPartFromCode(e){if(e=FS(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=FS(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(xa(e)&&e.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(e)[0]}catch{}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(i=>{if(n)return;const s=this.formatLanguageCode(i);(!this.options.supportedLngs||this.isSupportedCode(s))&&(n=s)}),!n&&this.options.supportedLngs&&e.forEach(i=>{if(n)return;const s=this.getScriptPartFromCode(i);if(this.isSupportedCode(s))return n=s;const r=this.getLanguagePartFromCode(i);if(this.isSupportedCode(r))return n=r;n=this.options.supportedLngs.find(o=>{if(o===r)return o;if(!(o.indexOf("-")<0&&r.indexOf("-")<0)&&(o.indexOf("-")>0&&r.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===r||o.indexOf(r)===0&&r.length>1))return o})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),xa(e)&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let i=e[n];return i||(i=e[this.getScriptPartFromCode(n)]),i||(i=e[this.formatLanguageCode(n)]),i||(i=e[this.getLanguagePartFromCode(n)]),i||(i=e.default),i||[]}toResolveHierarchy(e,n){const i=this.getFallbackCodes((n===!1?[]:n)||this.options.fallbackLng||[],e),s=[],r=o=>{o&&(this.isSupportedCode(o)?s.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return xa(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&r(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&r(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&r(this.getLanguagePartFromCode(e))):xa(e)&&r(this.formatLanguageCode(e)),i.forEach(o=>{s.indexOf(o)<0&&r(this.formatLanguageCode(o))}),s}}const gq={zero:0,one:1,two:2,few:3,many:4,other:5},Aq={select:a=>a===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class N1e{constructor(e,n={}){this.languageUtils=e,this.options=n,this.logger=Gh.create("pluralResolver"),this.pluralRulesCache={}}clearCache(){this.pluralRulesCache={}}getRule(e,n={}){const i=FS(e==="dev"?"en":e),s=n.ordinal?"ordinal":"cardinal",r=JSON.stringify({cleanedCode:i,type:s});if(r in this.pluralRulesCache)return this.pluralRulesCache[r];let o;try{o=new Intl.PluralRules(i,{type:s})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Aq;if(!e.match(/-|_/))return Aq;const c=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(c,n)}return this.pluralRulesCache[r]=o,o}needsPlural(e,n={}){let i=this.getRule(e,n);return i||(i=this.getRule("dev",n)),i?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,n,i={}){return this.getSuffixes(e,i).map(s=>`${n}${s}`)}getSuffixes(e,n={}){let i=this.getRule(e,n);return i||(i=this.getRule("dev",n)),i?i.resolvedOptions().pluralCategories.sort((s,r)=>gq[s]-gq[r]).map(s=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${s}`):[]}getSuffix(e,n,i={}){const s=this.getRule(e,i);return s?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${s.select(n)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",n,i))}}const yq=(a,e,n,i=".",s=!0)=>{let r=_1e(a,e,n);return!r&&s&&xa(n)&&(r=fk(a,n,i),r===void 0&&(r=fk(e,n,i))),r},pD=a=>a.replace(/\$/g,"$$$$");class vq{constructor(e={}){this.logger=Gh.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(n=>n),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:i,useRawValueToEscape:s,prefix:r,prefixEscaped:o,suffix:l,suffixEscaped:c,formatSeparator:u,unescapeSuffix:h,unescapePrefix:f,nestingPrefix:m,nestingPrefixEscaped:A,nestingSuffix:x,nestingSuffixEscaped:T,nestingOptionsSeparator:E,maxReplaces:M,alwaysFormat:N}=e.interpolation;this.escape=n!==void 0?n:b1e,this.escapeValue=i!==void 0?i:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=r?av(r):o||"{{",this.suffix=l?av(l):c||"}}",this.formatSeparator=u||",",this.unescapePrefix=h?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=m?av(m):A||av("$t("),this.nestingSuffix=x?av(x):T||av(")"),this.nestingOptionsSeparator=E||",",this.maxReplaces=M||1e3,this.alwaysFormat=N!==void 0?N:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,i)=>n?.source===i?(n.lastIndex=0,n):new RegExp(i,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,n,i,s){let r,o,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=A=>{if(A.indexOf(this.formatSeparator)<0){const M=yq(n,c,A,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(M,void 0,i,{...s,...n,interpolationkey:A}):M}const x=A.split(this.formatSeparator),T=x.shift().trim(),E=x.join(this.formatSeparator).trim();return this.format(yq(n,c,T,this.options.keySeparator,this.options.ignoreJSONStructure),E,i,{...s,...n,interpolationkey:T})};this.resetRegExp();const h=s?.missingInterpolationHandler||this.options.missingInterpolationHandler,f=s?.interpolation?.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:A=>pD(A)},{regex:this.regexp,safeValue:A=>this.escapeValue?pD(this.escape(A)):pD(A)}].forEach(A=>{for(l=0;r=A.regex.exec(e);){const x=r[1].trim();if(o=u(x),o===void 0)if(typeof h=="function"){const E=h(e,r,s);o=xa(E)?E:""}else if(s&&Object.prototype.hasOwnProperty.call(s,x))o="";else if(f){o=r[0];continue}else this.logger.warn(`missed to pass in variable ${x} for interpolating ${e}`),o="";else!xa(o)&&!this.useRawValueToEscape&&(o=cq(o));const T=A.safeValue(o);if(e=e.replace(r[0],T),f?(A.regex.lastIndex+=o.length,A.regex.lastIndex-=r[0].length):A.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),e}nest(e,n,i={}){let s,r,o;const l=(c,u)=>{const h=this.nestingOptionsSeparator;if(c.indexOf(h)<0)return c;const f=c.split(new RegExp(`${h}[ ]*{`));let m=`{${f[1]}`;c=f[0],m=this.interpolate(m,o);const A=m.match(/'/g),x=m.match(/"/g);((A?.length??0)%2===0&&!x||x.length%2!==0)&&(m=m.replace(/'/g,'"'));try{o=JSON.parse(m),u&&(o={...u,...o})}catch(T){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,T),`${c}${h}${m}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,c};for(;s=this.nestingRegexp.exec(e);){let c=[];o={...i},o=o.replace&&!xa(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const u=/{.*}/.test(s[1])?s[1].lastIndexOf("}")+1:s[1].indexOf(this.formatSeparator);if(u!==-1&&(c=s[1].slice(u).split(this.formatSeparator).map(h=>h.trim()).filter(Boolean),s[1]=s[1].slice(0,u)),r=n(l.call(this,s[1].trim(),o),o),r&&s[0]===e&&!xa(r))return r;xa(r)||(r=cq(r)),r||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${e}`),r=""),c.length&&(r=c.reduce((h,f)=>this.format(h,f,i.lng,{...i,interpolationkey:s[1].trim()}),r.trim())),e=e.replace(s[0],r),this.regexp.lastIndex=0}return e}}const R1e=a=>{let e=a.toLowerCase().trim();const n={};if(a.indexOf("(")>-1){const i=a.split("(");e=i[0].toLowerCase().trim();const s=i[1].substring(0,i[1].length-1);e==="currency"&&s.indexOf(":")<0?n.currency||(n.currency=s.trim()):e==="relativetime"&&s.indexOf(":")<0?n.range||(n.range=s.trim()):s.split(";").forEach(o=>{if(o){const[l,...c]=o.split(":"),u=c.join(":").trim().replace(/^'+|'+$/g,""),h=l.trim();n[h]||(n[h]=u),u==="false"&&(n[h]=!1),u==="true"&&(n[h]=!0),isNaN(u)||(n[h]=parseInt(u,10))}})}return{formatName:e,formatOptions:n}},_q=a=>{const e={};return(n,i,s)=>{let r=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(r={...r,[s.interpolationkey]:void 0});const o=i+JSON.stringify(r);let l=e[o];return l||(l=a(FS(i),s),e[o]=l),l(n)}},P1e=a=>(e,n,i)=>a(FS(n),i)(e);class I1e{constructor(e={}){this.logger=Gh.create("formatter"),this.options=e,this.init(e)}init(e,n={interpolation:{}}){this.formatSeparator=n.interpolation.formatSeparator||",";const i=n.cacheInBuiltFormats?_q:P1e;this.formats={number:i((s,r)=>{const o=new Intl.NumberFormat(s,{...r});return l=>o.format(l)}),currency:i((s,r)=>{const o=new Intl.NumberFormat(s,{...r,style:"currency"});return l=>o.format(l)}),datetime:i((s,r)=>{const o=new Intl.DateTimeFormat(s,{...r});return l=>o.format(l)}),relativetime:i((s,r)=>{const o=new Intl.RelativeTimeFormat(s,{...r});return l=>o.format(l,r.range||"day")}),list:i((s,r)=>{const o=new Intl.ListFormat(s,{...r});return l=>o.format(l)})}}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=_q(n)}format(e,n,i,s={}){const r=n.split(this.formatSeparator);if(r.length>1&&r[0].indexOf("(")>1&&r[0].indexOf(")")<0&&r.find(l=>l.indexOf(")")>-1)){const l=r.findIndex(c=>c.indexOf(")")>-1);r[0]=[r[0],...r.splice(1,l)].join(this.formatSeparator)}return r.reduce((l,c)=>{const{formatName:u,formatOptions:h}=R1e(c);if(this.formats[u]){let f=l;try{const m=s?.formatParams?.[s.interpolationkey]||{},A=m.locale||m.lng||s.locale||s.lng||i;f=this.formats[u](l,A,{...h,...s,...m})}catch(m){this.logger.warn(m)}return f}else this.logger.warn(`there was no format function for ${u}`);return l},e)}}const L1e=(a,e)=>{a.pending[e]!==void 0&&(delete a.pending[e],a.pendingCount--)};class D1e extends _P{constructor(e,n,i,s={}){super(),this.backend=e,this.store=n,this.services=i,this.languageUtils=i.languageUtils,this.options=s,this.logger=Gh.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(i,s.backend,s)}queueLoad(e,n,i,s){const r={},o={},l={},c={};return e.forEach(u=>{let h=!0;n.forEach(f=>{const m=`${u}|${f}`;!i.reload&&this.store.hasResourceBundle(u,f)?this.state[m]=2:this.state[m]<0||(this.state[m]===1?o[m]===void 0&&(o[m]=!0):(this.state[m]=1,h=!1,o[m]===void 0&&(o[m]=!0),r[m]===void 0&&(r[m]=!0),c[f]===void 0&&(c[f]=!0)))}),h||(l[u]=!0)}),(Object.keys(r).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(r),pending:Object.keys(o),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(e,n,i){const s=e.split("|"),r=s[0],o=s[1];n&&this.emit("failedLoading",r,o,n),!n&&i&&this.store.addResourceBundle(r,o,i,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&i&&(this.state[e]=0);const l={};this.queue.forEach(c=>{v1e(c.loaded,[r],o),L1e(c,e),n&&c.errors.push(n),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(u=>{l[u]||(l[u]={});const h=c.loaded[u];h.length&&h.forEach(f=>{l[u][f]===void 0&&(l[u][f]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(e,n,i,s=0,r=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:i,tried:s,wait:r,callback:o});return}this.readingCalls++;const l=(u,h)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(u&&h&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,i,s+1,r*2,o)},r);return}o(u,h)},c=this.backend[i].bind(this.backend);if(c.length===2){try{const u=c(e,n);u&&typeof u.then=="function"?u.then(h=>l(null,h)).catch(l):l(null,u)}catch(u){l(u)}return}return c(e,n,l)}prepareLoading(e,n,i={},s){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();xa(e)&&(e=this.languageUtils.toResolveHierarchy(e)),xa(n)&&(n=[n]);const r=this.queueLoad(e,n,i,s);if(!r.toLoad.length)return r.pending.length||s(),null;r.toLoad.forEach(o=>{this.loadOne(o)})}load(e,n,i){this.prepareLoading(e,n,{},i)}reload(e,n,i){this.prepareLoading(e,n,{reload:!0},i)}loadOne(e,n=""){const i=e.split("|"),s=i[0],r=i[1];this.read(s,r,"read",void 0,void 0,(o,l)=>{o&&this.logger.warn(`${n}loading namespace ${r} for language ${s} failed`,o),!o&&l&&this.logger.log(`${n}loaded namespace ${r} for language ${s}`,l),this.loaded(e,o,l)})}saveMissing(e,n,i,s,r,o={},l=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(n)){this.logger.warn(`did not save key "${i}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if(this.backend?.create){const c={...o,isUpdate:r},u=this.backend.create.bind(this.backend);if(u.length<6)try{let h;u.length===5?h=u(e,n,i,s,c):h=u(e,n,i,s),h&&typeof h.then=="function"?h.then(f=>l(null,f)).catch(l):l(null,h)}catch(h){l(h)}else u(e,n,i,s,l,c)}!e||!e[0]||this.store.addResource(e[0],n,i,s)}}}const mD=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:a=>{let e={};if(typeof a[1]=="object"&&(e=a[1]),xa(a[1])&&(e.defaultValue=a[1]),xa(a[2])&&(e.tDescription=a[2]),typeof a[2]=="object"||typeof a[3]=="object"){const n=a[3]||a[2];Object.keys(n).forEach(i=>{e[i]=n[i]})}return e},interpolation:{escapeValue:!0,format:a=>a,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),xq=a=>(xa(a.ns)&&(a.ns=[a.ns]),xa(a.fallbackLng)&&(a.fallbackLng=[a.fallbackLng]),xa(a.fallbackNS)&&(a.fallbackNS=[a.fallbackNS]),a.supportedLngs?.indexOf?.("cimode")<0&&(a.supportedLngs=a.supportedLngs.concat(["cimode"])),typeof a.initImmediate=="boolean"&&(a.initAsync=a.initImmediate),a),OE=()=>{},k1e=a=>{Object.getOwnPropertyNames(Object.getPrototypeOf(a)).forEach(n=>{typeof a[n]=="function"&&(a[n]=a[n].bind(a))})};class sS extends _P{constructor(e={},n){if(super(),this.options=xq(e),this.services={},this.logger=Gh,this.modules={external:[]},k1e(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(e={},n){this.isInitializing=!0,typeof e=="function"&&(n=e,e={}),e.defaultNS==null&&e.ns&&(xa(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const i=mD();this.options={...i,...this.options,...xq(e)},this.options.interpolation={...i.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator),typeof this.options.overloadTranslationOptionHandler!="function"&&(this.options.overloadTranslationOptionHandler=i.overloadTranslationOptionHandler),this.options.debug===!0&&typeof console<"u"&&console.warn("i18next is maintained with support from locize.com  consider powering your project with managed localization (AI, CDN, integrations): https://locize.com");const s=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?Gh.init(s(this.modules.logger),this.options):Gh.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:u=I1e;const h=new mq(this.options);this.store=new fq(this.options.resources,this.options);const f=this.services;f.logger=Gh,f.resourceStore=this.store,f.languageUtils=h,f.pluralResolver=new N1e(h,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),u&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(f.formatter=s(u),f.formatter.init&&f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new vq(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new D1e(s(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",(A,...x)=>{this.emit(A,...x)}),this.modules.languageDetector&&(f.languageDetector=s(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=s(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new AN(this.services,this.options),this.translator.on("*",(A,...x)=>{this.emit(A,...x)}),this.modules.external.forEach(A=>{A.init&&A.init(this)})}if(this.format=this.options.interpolation.format,n||(n=OE),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=(...h)=>this.store[u](...h)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=(...h)=>(this.store[u](...h),this)});const l=Gb(),c=()=>{const u=(h,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(f),n(h,f)};if(this.languages&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(e,n=OE){let i=n;const s=xa(e)?e:this.language;if(typeof e=="function"&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if(s?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return i();const r=[],o=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(u=>{u!=="cimode"&&r.indexOf(u)<0&&r.push(u)})};s?o(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>o(c)),this.options.preload?.forEach?.(l=>o(l)),this.services.backendConnector.load(r,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(l)})}else i(null)}reloadResources(e,n,i){const s=Gb();return typeof e=="function"&&(i=e,e=void 0),typeof n=="function"&&(i=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),i||(i=OE),this.services.backendConnector.reload(e,n,r=>{s.resolve(),i(r)}),s}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&MZ.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let n=0;n<this.languages.length;n++){const i=this.languages[n];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,n){this.isLanguageChangingTo=e;const i=Gb();this.emit("languageChanging",e);const s=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},r=(l,c)=>{c?this.isLanguageChangingTo===e&&(s(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,i.resolve((...u)=>this.t(...u)),n&&n(l,(...u)=>this.t(...u))},o=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const c=xa(l)?l:l&&l[0],u=this.store.hasLanguageSomeTranslations(c)?c:this.services.languageUtils.getBestMatchFromCodes(xa(l)?[l]:l);u&&(this.language||s(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector?.cacheUserLanguage?.(u)),this.loadResources(u,h=>{r(h,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),i}getFixedT(e,n,i){const s=(r,o,...l)=>{let c;typeof o!="object"?c=this.options.overloadTranslationOptionHandler([r,o].concat(l)):c={...o},c.lng=c.lng||s.lng,c.lngs=c.lngs||s.lngs,c.ns=c.ns||s.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||i||s.keyPrefix);const u=this.options.keySeparator||".";let h;return c.keyPrefix&&Array.isArray(r)?h=r.map(f=>(typeof f=="function"&&(f=pk(f,{...this.options,...o})),`${c.keyPrefix}${u}${f}`)):(typeof r=="function"&&(r=pk(r,{...this.options,...o})),h=c.keyPrefix?`${c.keyPrefix}${u}${r}`:r),this.t(h,c)};return xa(e)?s.lng=e:s.lngs=e,s.ns=n,s.keyPrefix=i,s}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,n={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=n.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,r=this.languages[this.languages.length-1];if(i.toLowerCase()==="cimode")return!0;const o=(l,c)=>{const u=this.services.backendConnector.state[`${l}|${c}`];return u===-1||u===0||u===2};if(n.precheck){const l=n.precheck(this,o);if(l!==void 0)return l}return!!(this.hasResourceBundle(i,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(i,e)&&(!s||o(r,e)))}loadNamespaces(e,n){const i=Gb();return this.options.ns?(xa(e)&&(e=[e]),e.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{i.resolve(),n&&n(s)}),i):(n&&n(),Promise.resolve())}loadLanguages(e,n){const i=Gb();xa(e)&&(e=[e]);const s=this.options.preload||[],r=e.filter(o=>s.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return r.length?(this.options.preload=s.concat(r),this.loadResources(o=>{i.resolve(),n&&n(o)}),i):(n&&n(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";try{const s=new Intl.Locale(e);if(s&&s.getTextInfo){const r=s.getTextInfo();if(r&&r.direction)return r.direction}}catch{}const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=this.services?.languageUtils||new mq(mD());return e.toLowerCase().indexOf("-latn")>1?"ltr":n.indexOf(i.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},n){const i=new sS(e,n);return i.createInstance=sS.createInstance,i}cloneInstance(e={},n=OE){const i=e.forkResourceStore;i&&delete e.forkResourceStore;const s={...this.options,...e,isClone:!0},r=new sS(s);if((e.debug!==void 0||e.prefix!==void 0)&&(r.logger=r.logger.clone(e)),["store","services","language"].forEach(l=>{r[l]=this[l]}),r.services={...this.services},r.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},i){const l=Object.keys(this.store.data).reduce((c,u)=>(c[u]={...this.store.data[u]},c[u]=Object.keys(c[u]).reduce((h,f)=>(h[f]={...c[u][f]},h),c[u]),c),{});r.store=new fq(l,s),r.services.resourceStore=r.store}if(e.interpolation){const c={...mD().interpolation,...this.options.interpolation,...e.interpolation},u={...s,interpolation:c};r.services.interpolator=new vq(u)}return r.translator=new AN(r.services,s),r.translator.on("*",(l,...c)=>{r.emit(l,...c)}),r.init(s,n),r.translator.options=s,r.translator.backendConnector.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Fo=sS.createInstance();Fo.createInstance;Fo.dir;Fo.init;Fo.loadResources;Fo.reloadResources;Fo.use;Fo.changeLanguage;Fo.getFixedT;Fo.t;Fo.exists;Fo.setDefaultNamespace;Fo.hasLoadedNamespace;Fo.loadNamespaces;Fo.loadLanguages;const O1e=(a,e,n,i)=>{const s=[n,{code:e,...i||{}}];if(a?.services?.logger?.forward)return a.services.logger.forward(s,"warn","react-i18next::",!0);gy(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),a?.services?.logger?.warn?a.services.logger.warn(...s):console?.warn&&console.warn(...s)},bq={},NZ=(a,e,n,i)=>{gy(n)&&bq[n]||(gy(n)&&(bq[n]=new Date),O1e(a,e,n,i))},RZ=(a,e)=>()=>{if(a.isInitialized)e();else{const n=()=>{setTimeout(()=>{a.off("initialized",n)},0),e()};a.on("initialized",n)}},mk=(a,e,n)=>{a.loadNamespaces(e,RZ(a,n))},Sq=(a,e,n,i)=>{if(gy(n)&&(n=[n]),a.options.preload&&a.options.preload.indexOf(e)>-1)return mk(a,n,i);n.forEach(s=>{a.options.ns.indexOf(s)<0&&a.options.ns.push(s)}),a.loadLanguages(e,RZ(a,i))},F1e=(a,e,n={})=>!e.languages||!e.languages.length?(NZ(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(a,{lng:n.lng,precheck:(i,s)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!s(i.isLanguageChangingTo,a))return!1}}),gy=a=>typeof a=="string",j1e=a=>typeof a=="object"&&a!==null,B1e=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,U1e={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},V1e=a=>U1e[a],z1e=a=>a.replace(B1e,V1e);let gk={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:z1e,transDefaultProps:void 0};const G1e=(a={})=>{gk={...gk,...a}},q1e=()=>gk;let PZ;const H1e=a=>{PZ=a},W1e=()=>PZ,$1e={type:"3rdParty",init(a){G1e(a.options.react),H1e(a)}},K1e=ge.createContext();class Y1e{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var gD={exports:{}},AD={};var Tq;function X1e(){if(Tq)return AD;Tq=1;var a=BR();function e(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var n=typeof Object.is=="function"?Object.is:e,i=a.useState,s=a.useEffect,r=a.useLayoutEffect,o=a.useDebugValue;function l(f,m){var A=m(),x=i({inst:{value:A,getSnapshot:m}}),T=x[0].inst,E=x[1];return r(function(){T.value=A,T.getSnapshot=m,c(T)&&E({inst:T})},[f,A,m]),s(function(){return c(T)&&E({inst:T}),f(function(){c(T)&&E({inst:T})})},[f]),o(A),A}function c(f){var m=f.getSnapshot;f=f.value;try{var A=m();return!n(f,A)}catch{return!0}}function u(f,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return AD.useSyncExternalStore=a.useSyncExternalStore!==void 0?a.useSyncExternalStore:h,AD}var wq;function Q1e(){return wq||(wq=1,gD.exports=X1e()),gD.exports}var J1e=Q1e();const Z1e=(a,e)=>gy(e)?e:j1e(e)&&gy(e.defaultValue)?e.defaultValue:Array.isArray(a)?a[a.length-1]:a,eve={t:Z1e,ready:!1},tve=()=>()=>{},Sa=(a,e={})=>{const{i18n:n}=e,{i18n:i,defaultNS:s}=ge.useContext(K1e)||{},r=n||i||W1e();r&&!r.reportNamespaces&&(r.reportNamespaces=new Y1e),r||NZ(r,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const o=ge.useMemo(()=>({...q1e(),...r?.options?.react,...e}),[r,e]),{useSuspense:l,keyPrefix:c}=o,u=s||r?.options?.defaultNS,h=gy(u)?[u]:u||["translation"],f=ge.useMemo(()=>h,h);r?.reportNamespaces?.addUsedNamespaces?.(f);const m=ge.useRef(0),A=ge.useCallback(L=>{if(!r)return tve;const{bindI18n:U,bindI18nStore:q}=o,K=()=>{m.current+=1,L()};return U&&r.on(U,K),q&&r.store.on(q,K),()=>{U&&U.split(" ").forEach(H=>r.off(H,K)),q&&q.split(" ").forEach(H=>r.store.off(H,K))}},[r,o]),x=ge.useRef(),T=ge.useCallback(()=>{if(!r)return eve;const L=!!(r.isInitialized||r.initializedStoreOnce)&&f.every(ne=>F1e(ne,r,o)),U=e.lng||r.language,q=m.current,K=x.current;if(K&&K.ready===L&&K.lng===U&&K.keyPrefix===c&&K.revision===q)return K;const X={t:r.getFixedT(U,o.nsMode==="fallback"?f:f[0],c),ready:L,lng:U,keyPrefix:c,revision:q};return x.current=X,X},[r,f,c,o,e.lng]),[E,M]=ge.useState(0),{t:N,ready:I}=J1e.useSyncExternalStore(A,T,T);ge.useEffect(()=>{if(r&&!I&&!l){const L=()=>M(U=>U+1);e.lng?Sq(r,e.lng,f,L):mk(r,f,L)}},[r,e.lng,f,I,l,E]);const F=r||{},G=ge.useRef(null),O=ge.useRef(),D=L=>{const U=Object.getOwnPropertyDescriptors(L);U.__original&&delete U.__original;const q=Object.create(Object.getPrototypeOf(L),U);if(!Object.prototype.hasOwnProperty.call(q,"__original"))try{Object.defineProperty(q,"__original",{value:L,writable:!1,enumerable:!1,configurable:!1})}catch{}return q},j=ge.useMemo(()=>{const L=F,U=L?.language;let q=L;L&&(G.current&&G.current.__original===L?O.current!==U?(q=D(L),G.current=q,O.current=U):q=G.current:(q=D(L),G.current=q,O.current=U));const K=[N,q,I];return K.t=N,K.i18n=q,K.ready=I,K},[N,F,I,F.resolvedLanguage,F.language,F.languages]);if(r&&l&&!I)throw new Promise(L=>{const U=()=>L();e.lng?Sq(r,e.lng,f,U):mk(r,f,U)});return j},nve={save:"Guardar",cancel:"Cancelar",confirm:"Confirmar",accept:"Aceptar",close:"Cerrar",back:"Volver",continue:"Continuar",yes:"S",no:"No",loading:"Cargando...",error:"Error",warning:"Advertencia",success:"xito",next:"Siguiente",previous:"Anterior",edit:"Editar",delete:"Eliminar",add:"Aadir",remove:"Eliminar",select:"Seleccionar",search:"Buscar",filter:"Filtrar",all:"Todos",none:"Ninguno",name:"Nombre",age:"Edad",position:"Posicin",value:"Valor",salary:"Salario",contract:"Contrato",team:"Equipo",league:"Liga",season:"Temporada",week:"Semana",day:"Da",month:"Mes",year:"Ao",money:"Dinero",budget:"Presupuesto",unknown:"Desconocido"},ave={title:"PC GAFFER",subtitle:"",season:"",continueGame:"Continuar Partida",play:"Jugar",login:"Iniciar Sesin",logout:"Salir",loggingOut:"Saliendo...",saveGame:"Guardar Partida",contrarreloj:"Contrarreloj",records:"Rcords",options:"Opciones",loadOrCreate:"Cargar partida o crear nueva",saveProgress:"Guarda tu progreso en la nube",saveCurrentProgress:"Guarda tu progreso actual",reachChampions:"Llega a la Champions desde abajo",guestNotice:"Inicia sesin para guardar tu progreso en la nube",tribute:"The beautiful game, managed by you",contrarrelojActive:"Contrarreloj activo",newGame:"Nueva partida",deleteWarning:"?? Empezar nueva partida borrar el progreso actual",playButton:"Jugar",loginButton:"Iniciar Sesin",saveCurrentGame:"Guardar Partida",recordsButton:"Rcords",optionsButton:"Opciones"},ive={title:"Despacho",overview:"Resumen",simulate:"Simular",simulateWeek:"Simular Semana",simulateSeason:"Simular Temporada",simulateToWindow:"Simular hasta Ventana",simulating:"Simulando...",seasonInfo:"Temporada {{season}}",weekInfo:"Semana {{week}}",changeManagerName:"Nombre del mnager (aparece en el ranking):",clickToChangeName:"Clic para cambiar nombre",budget:"Presupuesto",teamValue:"Valor del Equipo",stadiumCapacity:"Capacidad del Estadio",facilities:"Instalaciones",objectives:"Objetivos",nextMatch:"Prximo Partido",vs:"VS",home:"Local",away:"Visitante",injuredWarning:"Jugadores lesionados en alineacin",playersInjured:"Tienes {{count}} jugador{{count, plural, one {} other {es}}} lesionado{{count, plural, one {} other {s}}} en tu alineacin titular",stillPlay:"Quieres seguir con el partido?",checkFormation:"Ve a Alineacin y sustituye a los lesionados antes de continuar.",welcome:"Bienvenido, Mster",preseason:"Pretemporada {{week}}/{{total}}",players:"jugadores",boardConfidence:"Confianza de la directiva",friendlyMatch:"Amistoso {{week}}/5",matchday:"Jornada {{week}}",lastResults:"ltimos Resultados",form_W:"V",form_D:"E",form_L:"D",noMatches:"Sin partidos jugados",mainObjective:"Objetivo Principal",viewAllObjectives:"Ver todos los objetivos",recentMessages:"Mensajes Recientes",weeksOut:"{{weeks}} semana{{weeks, plural, one {} other {s}}}",goToFormation:"Ir a Alineacin",threeMatches:"3 partidos",endOfSeason:"Fin de temporada",halfSeason:"Media temporada",winterBanner:"MERCADO DE INVIERNO  Jornada {{current}} de {{total}}",notEnoughPlayers:"No tienes suficientes jugadores para formar un equipo",seasonEnd:"Fin de Temporada",seasonEndedAfterWeeks:"La temporada ha terminado despus de {{weeks}} semanas simuladas.",simulatedWeeks:"Simuladas {{weeks}} semanas",advancedToWeek:"Has avanzado hasta la semana {{week}}",insufficientSquad:"Plantilla insuficiente!",onlyHavePlayers:"Solo tienes <strong>{{count}} jugadores</strong>. Necesitas un mnimo de <strong>11</strong> para poder jugar.",goToTransfersWarning:"Ve al mercado de fichajes y ficha jugadores antes de continuar. Si vuelves a intentar simular sin tener 11 jugadores, <strong>perders el juego</strong>.",goToTransfers:"Ir a Fichajes"},sve={title:"Alineacin",lineup:"Alineacin",reserves:"Jugadores Convocados",notCalled:"Jugadores No Convocados",injured:"Lesionados",suspended:"Sancionados",tactic:"Tctica",formation:"Formacin",captain:"Capitn",freekicks:"Faltas",penalties:"Penaltis",corners:"Corners",mentality:"Mentalidad",attacking:"Ofensiva",balanced:"Equilibrada",defensive:"Defensiva",fitness:"Forma",morale:"Moral",energy:"Energa",experience:"Experiencia",makeReserve:"Hacer Suplente",makeStarter:"Hacer Titular",makeNotCalled:"No Convocar",callUp:"Convocar",setCaptain:"Nombrar Capitn",setFreekicks:"Lanzar Faltas",setPenalties:"Lanzar Penaltis",setCorners:"Lanzar Corners",years:"aos",statistics:"Estadsticas",selectPlayer:"Seleccionar Jugador",tacticAndFormation:"Tctica y Formacin",parameters:"PARMETROS",rating:"CALIFICACIN",teamAverage:"MEDIA EQUIPO",playingAs:"jugando de",tacDefensive:"Defensiva",tacDefensiveDesc:"Muro atrs, pocas ocasiones",tacDefensiveBonus:"+40% defensa, -40% ataque",tacDefensiveDetail:"Fuerte vs Equilibrada  Dbil vs Posesin y Ofensiva",tacBalanced:"Equilibrada",tacBalancedDesc:"Sin sorpresas, sin riesgos",tacBalancedBonus:"Sin modificadores",tacBalancedDetail:"No tiene ventajas ni desventajas tcticas",tacAttacking:"Ofensiva",tacAttackingDesc:"A por todas, riesgo alto",tacAttackingBonus:"+35% ataque, -30% defensa",tacAttackingDetail:"Fuerte vs Defensiva  Dbil vs Contra y Presin",tacPossession:"Posesin",tacPossessionDesc:"Dominar el baln y cansar",tacPossessionBonus:"+30% posesin, +10% defensa",tacPossessionDetail:"Fuerte vs Contra  Dbil vs Presin alta",tacCounter:"Contraataque",tacCounterDesc:"Ceder baln, matar a la contra",tacCounterBonus:"+20% ataque, +15% defensa, -25% posesin",tacCounterDetail:"Fuerte vs Ofensiva y Presin  Dbil vs Posesin",noInjuredPlayers:"No hay jugadores lesionados",medicalLevel:"Nivel centro mdico: {{level}}/5",upgradeMedical:"Mejora las instalaciones para ms tratamientos",statsTeam:"Equipo",statsSeason:"Temporada",statsPlayers:"Jugadores",statsTop:"Top",players:"JUGADORES",avgOVR:"MEDIA OVR",avgAge:"EDAD MEDIA",squadValue:"VALOR PLANTILLA",matches:"Partidos",wins:"Victorias",draws:"Empates",losses:"Derrotas",goalsFor:"Goles a favor",goalsAgainst:"Goles en contra",goalDiff:"Diferencia",topRated:"Mejor valorados",mostValuable:"Ms valiosos",mostMatches:"Ms partidos",noStatsYet:"Sin estadsticas an - juega partidos para generar datos",apply:"Aplicar"},rve={title:"Plantilla",players:"jugadores",player:"JUGADOR",contracts:"Contratos",salaries:"Salarios",totalSalary:"Salario Total",averageAge:"Edad Media",squadSize:"Tamao Plantilla",putForSale:"Poner en Venta",renew:"Renovar",release:"Liberar",loan:"Prestar",recall:"Recordar",yearsLeft:"Aos Restantes",onLoan:"Cedido",forSale:"En Venta",wantToLeave:"Quiere Irse",unhappy:"Descontento",sortBy:"Ordenar por",expired:"Expirado",oneYear:"{{years}} ao",multipleYears:"{{years}} aos",budget:"Presupuesto",weeklySalary:"Masa salarial",perYear:"/ao",perWeek:"/sem",ofBudget:"del presupuesto",playersNeedAttention:"{{count}} jugador(es) requiere(n) atencin",retiring:"Se retira",wantsToLeaveAlert:"Quiere irse",more:"+{{count}} ms",renewPlayer:"Renovar a {{name}}",currentContractLabel:"Contrato actual",demands:"Pide",budgetImpact:"Impacto en presupuesto:",acceptAndRenew:"Aceptar y renovar",sellPlayer:"Poner en venta a {{name}}",marketValue:"Valor de mercado",currentSalary:"Salario actual",ifSold:"Si se vende:",savedSalary:"ahorrados",sellNote:"El jugador aparecer en el mercado. Otros equipos pueden hacer ofertas.",unlistPlayer:"Quitar de venta a {{name}}",unlistQuestion:"Este jugador est actualmente en la lista de transferibles. Quieres retirarlo del mercado?",unlistNote:"Dejar de recibir ofertas de otros equipos.",confirmUnlist:"S, quitar de venta",releasePlayer:"Liberar a {{name}}",severanceWarning:"Debes pagar la indemnizacin por los {{years}} ao(s) de contrato restantes.",severanceCost:"Indemnizacin a pagar:",salarySaved:"Ahorrars en salarios:",moraleWarning:"Esto puede afectar la moral del vestuario",insufficientFunds:"No tienes suficiente dinero para la indemnizacin",payAndRelease:"Pagar y liberar",onLoanTag:"EN CESIN",forSaleTag:"En venta",removeFromSale:"Click para quitar de venta",renewContract:"Renovar contrato",releasePlayerBtn:"Liberar jugador",loanedBy:"Jugador cedido por {{team}}  No se puede vender ni liberar",loanedBadge:"Cedido",years:"aos",total:"total",canRenew:"Se puede renovar",cannotRenew:"El jugador no necesita renovar (le quedan ms de 2 aos)",playerRetiring:"El jugador ha anunciado su retiro"},ove={title:"Fichajes",explore:"Explorar",scout:"Ojeador",search:"Buscar",received:"Recibidas",sent:"Enviadas",offers:"Ofertas",market:"Mercado",available:"Disponible",notForSale:"No est en venta",makeOffer:"Hacer Oferta",counterOffer:"Contraoferta",accept:"Aceptar",reject:"Rechazar",withdraw:"Retirar",negotiate:"Negociar",transferFee:"Traspaso",salary:"Salario",duration:"Duracin",loan:"Cesin",permanent:"Permanente",windowClosed:"Ventana de Fichajes Cerrada",windowOpens:"La ventana abre en la semana",windowCloses:"La ventana cierra en la semana",noOffers:"No hay ofertas",scoutingReport:"Informe del Ojeador",preseasonOpen:"Pretemporada  Mercado ABIERTO",matchdayOpen:"Jornada {{week}}  Mercado ABIERTO",marketOpen:"Mercado Abierto",preseasonMessage:"Estamos en pretemporada. Aprovecha para fichar antes de que empiece la liga!",marketAlwaysOpen:"El mercado est siempre abierto. Ficha, cede y negocia cuando quieras.",totalTransfers:"Fichajes Totales",moneyMoved:"Dinero Movido",activeRumors:"Rumores Activos",latestTransfers:"ltimos Fichajes",noRecentTransfers:"No hay fichajes recientes",marketRumors:"Rumores del Mercado",reliable:"{{pct}}% fiable",noActiveRumors:"No hay rumores activos",searchPlayerPlaceholder:"Buscar jugador por nombre...",filters:"Filtros",position:"Posicin",allPositions:"Todas",goalkeeper:"Portero",defender:"Defensa",midfielder:"Centrocampista",forward:"Delantero",ageRange:"Edad: {{min}} - {{max}}",minOvr:"OVR mnimo: {{value}}",freeOnly:"Solo jugadores libres",free:"LIBRE",yearsOld:"{{age}} aos",blockedThisSeason:"Bloqueado esta temporada",contractExpiring:"Fin de contrato",noReceivedOffers:"Sin ofertas recibidas",noInterestYet:"Ningn club ha mostrado inters en tus jugadores... por ahora.",pendingTransferOffers:"Ofertas de traspaso pendientes",transfer:"Traspaso",pending:"Pendiente",expiresWeek:"Caduca sem. {{week}}",askMore:"Pedir ms",pendingLoanOffers:"Ofertas de cesin pendientes",loanFee:"Fee de cesin",receiverSalary:"Salario receptor",purchaseOption:"Opcin de compra",historyTitle:"Historial",rejected:"Rechazada",noOffersOrLoans:"Sin ofertas ni cesiones",noActiveOffersMsg:"No tienes ofertas activas ni cesiones. Busca jugadores para reforzar tu equipo!",transferOffers:"Ofertas de traspaso",clear:"Borrar",perYear:"/ao",weekShort:"Sem. {{week}}",pendingResponse:"Pendiente de respuesta  simula un partido",club:"Club",accepts:"Acepta",playerLabel:"Jugador",transferComplete:"Fichaje completado!",clubAsks:"El club pide {{amount}}",acceptCounter:"Aceptar contraoferta",playerRejectedCantComplete:"El jugador rechaz, no se puede completar",deleteBtn:"Eliminar",offerRejected:"Oferta rechazada",loanedOutPlayers:"Jugadores cedidos",loanedOut:"Cedido",weeksShort:"{{weeks}} sem.",atTeam:"En {{team}}",purchaseOptionAmount:"Opcin de compra: {{amount}}",loanedInPlayers:"Jugadores en cesin",onLoan:"En cesin",ownedBy:"Propiedad de {{team}}",buyAmount:"Comprar ({{amount}})",newsFeed:"Feed de Noticias",noRecentNews:"No hay noticias recientes",europe:"Europa",southAmerica:"Sudamrica",restOfWorld:"Resto del Mundo",leaguesMeta:"{{count}} liga{{plural}}  {{teams}} equipos",nTeams:"{{count}} equipos",searchTeamPlaceholder:"Buscar equipo...",playersAvgOvr:"{{count}} jugadores  Media {{avg}}",yourTeam:"Tu equipo",posHeader:"POS",playerHeader:"JUGADOR",ageHeader:"EDAD",ovrHeader:"OVR",valueHeader:"VALOR",levelBadge:"Nv. {{level}}",searchPositionLabel:"Posicin a buscar:",analyzingMarket:"Analizando mercado...",searchPlayers:"Buscar jugadores",searchSpecific:"Buscar {{pos}}",playersFound:"{{count}} jugadores encontrados",tickerDefault:"Mercado de fichajes activo | Mantente atento a las novedades",breakingNews:"LTIMA HORA",loanExclamation:"CESIN!",transferExclamation:"FICHAJE!",seasonLabel:"Temporada",nYears:"{{count}} aos",totalWord:"total",close:"Cerrar",transferFailed:"FICHAJE FALLIDO",blockedUntilNextSeason:"No podrs negociar con este jugador hasta la prxima temporada",freeAgent:"AGENTE LIBRE",ageLabel:"Edad",valueLabel:"Valor",salaryLabel:"Salario",contractLabel:"Contrato",noContract:"Sin contrato",professional:"Profesional",difficultyLabel:"Dificultad",tierDropWarning:"Baja {{count}} nivel{{plural}}",freeAgentLabel:"Agente Libre",signing:"Fichaje",loanToggle:"Cesin",preContractToggle:"Pre-contrato",requestLoan:"Solicitar Cesin",negotiatingStatus:"Negociando...",acceptedStatus:"Aceptada",rejectedBadge:"Rechazada",salaryPercentLabel:"% salario que pago",salaryPayHint:"Pagaras {{amount}}/ao del salario",loanDenied:"{{team}} no acepta ceder a {{player}}. {{reasons}}",noPurchaseOption:"Sin opcin de compra",noOption:"Sin opcin",valuePercent90:"90% valor",valuePercent100:"100% valor",estimatedProbability:"Probabilidad estimada",insufficientBudget:"Presupuesto insuficiente ({{amount}})",sendLoanRequest:"Enviar solicitud de cesin",waitingClubResponse:"Esperando respuesta del club...",prepareOffer:"Preparar Oferta",directRival:"Rival directo",transferToClub:"Traspaso al club",clubAccepts:"Club acepta",annualSalary:"Salario anual",minEstimated:"Mnimo estimado: {{amount}}/ao",contractDuration:"Duracin contrato",playerAccepts:"Jugador acepta",totalTransferCost:"Coste total traspaso",totalContractCost:"Coste total contrato",totalInvestment:"Inversin total",sendOffer:"Enviar oferta",offerHint:"La respuesta llegar tras simular un partido. El importe se reserva de tu presupuesto.",freeAgentNegotiation:"Negociacin con Agente Libre",preContractSection:"Pre-contrato",acceptedPlayerStatus:"Aceptado",rejectedPlayerStatus:"Rechazado",counterOfferStatus:"Contraoferta",freeAgentInfo:"No hay que negociar con ningn club. Negocia directamente con el jugador ofreciendo una prima de fichaje y un salario.",preContractBadge:"PRE-CONTRATO",preContractInfo:"Su contrato expira pronto. Puedes negociar directamente con l sin pagar traspaso. Se unir a tu equipo cuando finalice su contrato.",signingBonus:"Prima de fichaje",suggested:"Sugerido: {{amount}}",totalCostFormatted:"Coste total: {{amount}} ({{years}} ao{{plural}})",acceptanceProbability:"Probabilidad de aceptacin",playerCounterLabel:"Contraoferta del jugador:",counterTotalCost:"Coste total: {{amount}}",totalCostLabel:"Coste total",presentOffer:"Presentar oferta",offerPreContract:"Ofrecer pre-contrato",playerEvaluating:"El jugador evala tu oferta...",noAgreementReached:"No se lleg a un acuerdo con el jugador",insufficientSalaryOffer:"La oferta salarial es insuficiente",expectsHigherBonus:"Espera una prima de fichaje mayor",teamLevelNotConvincing:"No le convence el nivel del equipo",overallOfferNotConvincing:"No le convence la oferta global",needsMoreMoney:"Necesita ms dinero para compensar el nivel del club",wantsFinancialImprovement:"Pide una mejora econmica para aceptar el cambio",freeAgentSigned:"Agente libre fichado",preContractSigned:"Pre-contrato firmado",playerJoined:"{{name}} es nuevo jugador. Prima: {{bonus}}, Salario: {{salary}}/ao",offerSentTitle:"Oferta enviada",offerSentContent:"Oferta por {{name}} ({{team}}): {{amount}} + {{salary}}/ao",playerRejectedDefinitely:"El jugador rechaz definitivamente",loanNotPossible:"Cesin no posible",cannotLoan:"No se puede ceder",insufficientForLoanFee:"Necesitas {{amount}} para la fee de cesin",insufficientBudgetTitle:"Presupuesto insuficiente",cannotExecute:"No se puede ejecutar",noLoanPurchaseOption:"Esta cesin no tiene opcin de compra",insufficientBudgetShort:"Presupuesto insuficiente",europeTab:"Europa",continentalTab:"Continental",accepted:"Aceptada",age:"Edad",contract:"Contrato",difficulty:"Dificultad",freeAgentsOnly:"Solo jugadores libres",history:"Historial",level:"Nv.",loanBadge:"Cesin",loanSuccess:"CESIN!",negotiating:"Negociando...",noOffersReceived:"Sin ofertas recibidas",noSentOffers:"Sin ofertas ni cesiones",noSentOffersDesc:"No tienes ofertas activas ni cesiones. Busca jugadores para reforzar tu equipo!",persProfessional:"Profesional",playerValue:"Valor",posAll:"Todas",posDEF:"Defensa",posFWD:"Delantero",posGK:"Portero",positionToSearch:"Posicin a buscar",posMID:"Centrocampista",preseasonMsg:"Estamos en pretemporada. Aprovecha para fichar antes de que empiece la liga!",purchaseOptionLabel:"Opcin de compra",recentTransfers:"ltimos Fichajes",responseAfterMatch:"La respuesta llegar tras simular un partido. El importe se reserva de tu presupuesto.",searchPlaceholder:"Buscar jugador por nombre...",season:"Temporada",signingFailed:"FICHAJE FALLIDO",signingSuccess:"FICHAJE!",tickerMsg:"Mercado de fichajes activo | Mantente atento a las novedades",transferBadge:"Traspaso",transferCompleted:"Fichaje completado!",value:"valor",wantsHigherBonus:"Espera una prima de fichaje mayor",year:"ao",years:"aos",veryEasy:"Muy Fcil",easy:"Fcil",normal:"Normal",hard:"Difcil",veryHard:"Muy Difcil",almostImpossible:"Casi Imposible",persAmbitious:"Ambicioso",persLoyal:"Leal",persMercenary:"Mercenario",persHomesick:"Familiar",persAdventurous:"Aventurero",persDescAmbitious:"Quiere jugar en los mejores equipos",persDescLoyal:"Muy difcil que deje su club",persDescMercenary:"Solo le importa el dinero",persDescHomesick:"Prefiere estar cerca de casa",persDescProfessional:"Evala todo con equilibrio",persDescAdventurous:"Le gusta cambiar de aires"},lve={title:"Calendario",fixtures:"Partidos",results:"Resultados",matchday:"Jornada",date:"Fecha",time:"Hora",home:"Local",away:"Visitante",score:"Resultado",competition:"Competicin",venue:"Estadio",european:"Europa",southAmerican:"Sudamericana",cup:"Copa",week:"Semana",noEuropeanMatches:"No hay partidos europeos en esta jornada",noSouthAmericanMatches:"No hay partidos sudamericanos en esta jornada",noCupMatches:"No hay partidos de copa en esta ronda"},cve={title:"Da del Partido",kickoff:"Pitido Inicial",fulltime:"Tiempo Completo",halftime:"Descanso",goal:"Gol!",assist:"Asistencia",yellowCard:"Tarjeta Amarilla",redCard:"Tarjeta Roja",substitution:"Cambio",injury:"Lesin",minute:"Min",attendance:"Asistencia",possession:"Posesin",shots:"Disparos",shotsOnTarget:"Disparos a Portera",corners:"Corners",fouls:"Faltas",offsides:"Fueras de Juego",golazo:"GOLAZO!",lateGoal:"Gol en el descuento!",finalResult:"Resultado Final",skipToEnd:"Saltar al final",noMatchThisWeek:"No hay partido esta semana"},uve={title:"Clasificacin",position:"Pos",team:"Equipo",played:"PJ",won:"G",drawn:"E",lost:"P",goalsFor:"GF",goalsAgainst:"GC",goalDifference:"DIF",points:"PTS",form:"Forma",next:"Prximo",last5:"ltimos 5",champion:"Campen",championQualification:"Clasificacin Champions",europaQualification:"Clasificacin Europa",conferenceQualification:"Clasificacin Conference",relegation:"Descenso",playoff:"Playoff",championsLeague:"Continental Champions Cup",libertadores:"Libertadores",europaLeague:"Continental Shield",sudamericana:"Sudamericana",conferenceLeague:"Continental Trophy",promotion:"Ascenso directo",playoffPromotion:"Playoff ascenso",apertura:"Apertura",clausura:"Clausura",acumulada:"Acumulada",inProgress:"en curso",searchLeague:"Buscar liga...",yourLeague:"Tu liga",noData:"No hay datos disponibles para esta liga.",noDataHint:"Los datos se generarn al avanzar en la temporada.",group:"Grupo",championLabel:"Campen",firstLeg:"Ida",secondLeg:"Vuelta",bothTournamentsChampion:"campen de ambos torneos",formW:"V",formD:"E",formL:"D",showAllTeams:"Ver todos los equipos ({{count}})",showLess:"Ver menos",countries:{spain:"Espaa",england:"Inglaterra",italy:"Italia",germany:"Alemania",france:"Francia",restOfEurope:"Resto de Europa",southAmerica:"Sudamrica"}},dve={title:"Finanzas",income:"Ingresos",expenses:"Gastos",balance:"Balance",profit:"Beneficio",loss:"Prdida",ticketSales:"Venta de Entradas",transfers:"Traspasos",sponsorship:"Patrocinio",merchandise:"Merchandising",salaries:"Salarios",maintenance:"Mantenimiento",other:"Otros",bank:"Banco",currentBudget:"Presupuesto actual",currentSeason:"Temporada Actual",seasonTickets:"Abonados (cobro fin temporada)",pending:"pendiente",noCampaignClosed:"Sin campaa cerrada",ticketsSold:"Entradas vendidas",accumulatedMatches:"Acumulado partidos jugados",stadiumNaming:"Naming del estadio",playerSales:"Ventas de jugadores",prizesRewards:"Premios y recompensas",squadSalaries:"Salarios plantilla (fin temporada)",stadiumMaintenance:"Mantenimiento estadio",signings:"Fichajes",seasonBalance:"Balance temporada"},hve={title:"Instalaciones",subtitle:"Mejora tu club para competir al mximo nivel",training:"Entrenamiento",youth:"Cantera",medical:{infirmary:"Enfermera",doctors:"Mdicos",available:"disponibles",heals:"Cura",weeks:"semanas",weeksShort:"sem",weeksSingular:"ana",weeksPlural:"anas",cost:"Coste",noInjured:"Sin jugadores lesionados",inTreatment:"En tratamiento",noMedicalCenter:"Sin centro mdico",noDoctorsAvailable:"No hay mdicos disponibles",reduceTo:"Reducir a"},level:"Nivel",upgrade:"Mejorar",upgraded:"mejorado",cost:"Coste",benefit:"Beneficio",upgrading:"Mejorando",completed:"Completado",incomePerSeason:"Ingresos/temporada",nextLevel:"Siguiente nivel",maxLevel:"Nivel Mximo",specialization:"Especializacin",notChosen:"Sin elegir",choose:"Elegir",chooseSpecDesc:"Elige la especializacin (se bloquear hasta la prxima temporada)",ignore:"Ignorar",categories:{income:"Ingresos",development:"Desarrollo",support:"Soporte"},stadium:{name:"Estadio",description:"Capacidad y factor cancha"},impact:{title:"Impacto de tus instalaciones",youth:"Canteranos",treatments:"Tratamientos",weeksSaved:"Semanas ahorradas"},facilityNames:{stadium:"Estadio",sponsorship:"Comercial",youth:"Cantera",medical:"Centro Mdico",scouting:"Ojeadores"},facilityDescs:{stadium:"Capacidad y factor cancha",sponsorship:"Ingresos por patrocinios",youth:"Genera jvenes talentos",medical:"Reduce tiempo de lesiones",scouting:"Reduce costes de fichaje"},levelNames:{municipal:"Municipal",modern:"Moderno",large:"Grande",elite:"lite",legendary:"Legendario",basic:"Bsico",active:"Activo",professional:"Profesional",premium:"Premium",developed:"Desarrollada",advanced:"Avanzado",improved:"Mejorado",local:"Local",national:"Nacional",european:"Europeo",worldwide:"Mundial"},benefits:{seats:"{{count}} asientos",youthPlayer:"1 canterano/temporada ({{range}})",standardRecovery:"Recuperacin estndar",injuryReduction:"-{{percent}}% lesiones  {{treatments}} tratamiento(s)",noTransferAdvantage:"Sin ventaja en fichajes",transferDiscount:"-{{percent}}% coste fichajes"}},fve={title:"Estadio",capacity:"Capacidad",expand:"Ampliar",maintenance:"Mantenimiento",condition:"Estado",excellent:"Excelente",good:"Bueno",poor:"Malo",terrible:"Psimo",view3dNotAvailable:"Vista 3D no disponible",loadingStadium:"Cargando estadio...",general:"General",sponsorship:"Patrocinio",events:{friendly:"Amistoso",concert:"Concierto",corporate:"Evento Corporativo",legends:"Partido Leyendas"},seasonTicketCampaign:"Campaa de Abonos",campaignOpen:"Campaa abierta hasta jornada {{deadline}} (actual: {{current}})",seasonTicketPrice:"Precio del abono:",pricePerMatch:"{{matches}} partidos ? {{pricePerMatch}}/partido",expectedSubscribers:"Previsin de abonados:",maxShort:"mx",closeCampaign:"Cerrar campaa y fijar abonados",campaignClosed:"Campaa cerrada",subscribers:"abonados",pricePerTicket:"precio/abono",collected:"ingresado",ofCapacitySubscribed:"{{percent}}% del aforo abonado",ticketPrice:"Precio Entrada",priceLocked:"Precio fijado para esta temporada. Solo para no abonados.",setPriceBeforeLeague:"Precio por partido para no abonados. Fija antes de que empiece la liga.",accumulatedTicketIncome:"Ingresos entradas acumulados",onlyTicketsSold:"Solo entradas vendidas (sin abonados). Se cobra al finalizar la temporada.",lastHomeMatchday:"ltima jornada en casa",ticketsSold:"Entradas vendidas",totalAttendance:"Asistencia total",ticketIncome:"Ingresos entradas",grassCondition:"Estado del Csped",optimal:"ptimo",injuryRisk:"Riesgo lesiones +{{percent}}%",recovers:"Recupera +5%/semana",perfectCondition:"En perfectas condiciones",poorGrassWarning:"El mal estado aumenta lesiones de TUS jugadores",repairGrass:"Reparar csped ({{cost}})",currentSponsor:"Patrocinador Actual",yearsRemaining:"{{years}} aos restantes",cancelContract:"Cancelar contrato",penalty:"Penalizacin: {{amount}}",namingOffers:"Ofertas de Naming",sellStadiumName:"Vende el nombre del estadio por ingresos anuales",upgradeForSponsors:"Mejora tu estadio para atraer patrocinadores",organizeEvents:"Organizar Eventos",generateExtraIncome:"Genera ingresos extra (requiere 2 semanas entre eventos)",waitMoreWeeks:"Espera {{weeks}} semana(s) ms",grassDamage:"Dao csped: -{{percent}}%",organize:"Organizar",repairGrassBeforeEvents:"Repara el csped antes de organizar eventos",homeAdvantage:"Factor cancha",occupation:"Ocupacin",grass:"Csped",budget:"Presupuesto",stadium:"Estadio",accept:"Aceptar",perYear:"/ao",years:"aos",seasonTicketsClosed:"Campaa de abonos cerrada",seasonTicketsMessage:"{{count}} abonados  {{price}} = {{total}} (se cobrarn a final de temporada)",namingRights:"Derechos de Nombre",namingMessage:"Acuerdo con {{sponsor}}: {{amount}}M/ao por {{duration}} aos",sponsorshipCancelled:"Patrocinio cancelado",stadiumNameRestored:"El estadio recupera su nombre original. Penalizacin pagada: {{amount}}M",stadiumNameRestoredFree:"El estadio recupera su nombre original",eventHosted:"Evento celebrado. Ingresos: {{amount}}K",stadiumUpgraded:"Estadio ampliado",nowStadium:"Ahora es {{name}} con {{capacity}} asientos",seats:"asientos",insufficientFunds:"Fondos insuficientes",penaltyRequired:"Necesitas {{amount}}M para pagar la penalizacin por cancelar el contrato."},pve={title:"Intensidad de Entrenamiento",fitness:"Forma Fsica",tactics:"Tctica",technical:"Tcnica",intensity:"Intensidad",low:"Baja",medium:"Media",high:"Alta",intensitySet:"Intensidad de entrenamiento fijada",intensitySetDesc:"El equipo entrenar con intensidad {{intensity}} durante toda la temporada.",lockedUntil:"Bloqueado hasta prxima pretemporada",selectIntensity:"Selecciona la intensidad para toda la temporada",statImprovement:"Mejora stats",injuryRisk:"Riesgo lesin",facilityLevel:"Nivel instalaciones",bonus:"bonus",currentIntensity:"Intensidad actual",canChangeNext:"Podrs cambiarla al inicio de la prxima temporada",intensities:{light:{name:"Suave",description:"Menor progresin, menos lesiones. Ideal para veteranos."},normal:{name:"Normal",description:"Balance equilibrado entre progresin y riesgo."},intense:{name:"Intenso",description:"Mxima progresin, mayor riesgo de lesiones."}}},mve={title:"Opciones",language:"Idioma",graphics:"Grficos",sound:"Sonido",gameplay:"Jugabilidad",difficulty:"Dificultad",easy:"Fcil",normal:"Normal",hard:"Difcil",animations:"Animaciones",notifications:"Notificaciones",autosave:"Guardado Automtico",general:"General",autosaveLabel:"Autoguardado",autosaveDesc:"Guarda automticamente cada 5 minutos",volume:"Volumen",music:"Msica",effects:"Efectos",gameData:"Datos de Partida",saveAndExit:"Guardar y salir",deleteAndReset:"Borrar datos y reiniciar",deleteConfirm:"Borrar todos los datos?",deleteMessage:"Esta accin eliminar tu partida guardada y no se puede deshacer.",appTitle:"PC Gaffer",appVersion:"Versin 1.0.0",appTribute:"El arte de dirigir",difficultyEasyDesc:"IA menos agresiva, ms dinero inicial",difficultyNormalDesc:"Experiencia equilibrada",difficultyHardDesc:"IA muy competitiva, menos recursos",speedSlow:"Lenta",speedSlowDesc:"Ms tiempo para ver los partidos",speedNormalDesc:"Velocidad estndar",speedFast:"Rpida",speedFastDesc:"Partidos ms cortos",yesDeleteAll:"S, borrar todo"},gve={office:"Despacho",formation:"Alineacin",squad:"Plantilla",transfers:"Fichajes",calendar:"Calendario",table:"Clasificacin",finance:"Finanzas",stadium:"Estadio",facilities:"Instalaciones",training:"Entrenamiento",objectives:"Objetivos",competitions:"Competiciones",messages:"Mensajes",bank:"Banco",options:"Opciones",mainMenu:"Men Principal"},Ave={back:"Volver",loadGame:"Cargar Partida",saveGame:"Guardar Partida",manageGames:"Gestionar Partidas",selectOrCreate:"Selecciona una partida guardada o crea una nueva",chooseSlot:"Elige un hueco para guardar tu progreso",manageSlots:"Administra tus partidas guardadas",slot:"Hueco",emptySlot:"Hueco vaco",newGame:"Nueva Partida",saving:"Guardando...",saveHere:"Guardar aqu",unknownTeam:"Equipo desconocido",loading:"Cargando...",load:"Cargar",overwrite:"Sobrescribir?",deleteGame:"Eliminar partida?",loadingGames:"Cargando partidas...",never:"Nunca",errorLoadGames:"Error al cargar las partidas",errorLoadGame:"Error al cargar la partida",errorSaveGame:"Error al guardar la partida",errorDeleteGame:"Error al eliminar la partida"},yve={teamsAvailable:"{{count}} equipos disponibles",comingSoon:"Prximamente",groupsAndTeams:"{{groups}} grupos  {{teams}} equipos",teamsCount:"{{count}} equipo{{count, plural, one {} other {s}}}",selectGroup:"Selecciona un grupo",searchTeam:"Buscar equipo...",stadium:"Estadio",municipal:"Municipal",capacity:"Capacidad",reputation:"Reputacin",presentation:"Presentacin",startSeason:"Comenzar Temporada"},vve={title:"Modo Contrarreloj",setup:"Configuracin",start:"Comenzar",objective:"Objetivo: Llegar a la Champions League desde abajo",rules:"Reglas",progress:"Progreso",timeElapsed:"Tiempo Transcurrido",seasonsPlayed:"Temporadas Jugadas",currentLeague:"Liga Actual",trophies:"Trofeos",completed:"Completado!",failed:"Fallido",activated:"Modo Contrarreloj activado!",objectiveMessage:"Objetivo: ganar la {{competition}} con {{team}} en el menor nmero de temporadas. El reloj corre!",southAmericanCup:"South American Champions Cup",continentalCup:"Continental Champions Cup"},_ve={menu:"Men",title:"CONTRARRELOJ",subtitle:"Puedes llegar a la cima del ftbol europeo/sudamericano?",objective:"Objetivo",winChampions:"Ganar la Champions League o Copa Libertadores",losesIf:"Pierdes si",fired:"Te despiden o tu presupuesto llega a negativo",ranking:"Ranking",fewestSeasons:"El menor nmero de temporadas gana",chooseChallenge:"Elige tu desafo",newTeams:"Nuevos equipos",ovr:"OVR",goal:"Meta:",libertadores:"?? Copa Libertadores",championsLeague:"?? Champions League",starting:"Iniciando...",acceptChallenge:"ACEPTAR EL DESAFO!"},xve={title:"Fin de Temporada",summary:"Resumen",achievements:"Logros",statistics:"Estadsticas",topScorer:"Mximo Goleador",bestPlayer:"Mejor Jugador",nextSeason:"Prxima Temporada",finalTitle:"Final",league:"Liga",aperturaVsClausura:"Apertura vs Clausura",firstLeg:"Ida",secondLeg:"Vuelta",result:"Resultado",byAggregate:"por resultado global",byAwayGoals:"por goles de visitante",byClausuraAdvantage:"por ventaja deportiva (campen del Clausura)",sameChampion:"campen de ambos torneos",playoffAscenso:"Playoff de Ascenso",semifinals:"Semifinales",final:"FINAL!",victory:"Victoria!",defeat:"Derrota",extraTime:"Prrroga",penalties:"Penaltis",champion:"CAMPEN!",runner:"Subcampen",promotion:"ASCENSO!",relegation:"Descenso",eliminated:"El equipo ha sido eliminado del playoff",ascends:"ASCIENDE A LA LIGA!",playoffCompleted:"Playoff completado",playoffWinner:"Ganador del playoff",seasonSummary:"Resumen de temporada",finalPosition:"Posicin Final",points:"Puntos",wins:"Victorias",draws:"Empates",losses:"Derrotas",goalDifference:"Dif. Goles",qualifiedFor:"Clasificado para",qualificationBonus:"Bonus de clasificacin",objectives:"Objetivos",objectiveBalance:"Balance de objetivos",europeanBonus:"Bonus europeo",continue:"Continuar",playMatch:"Jugar partido",nextMatch:"Prximo partido",homeGame:"Jugamos en casa",awayGame:"Jugamos fuera"},bve={title:"Objetivos",current:"Actuales",completed:"Completados",failed:"Fallidos",primary:"Primario",secondary:"Secundario",bonus:"Bonus",leaguePosition:"Posicin en Liga",cupProgress:"Progreso en Copa",budget:"Presupuesto",youngPlayers:"Jugadores Jvenes",critical:"Crtico",high:"Principal",medium:"Secundario",low:"Opcional",objective:"Objetivo",onTrack:"En camino",atRisk:"En riesgo",danger:"Peligro",pending:"Pendiente",goalDifference:"Dif. goles",objectivesAtRisk:"objetivo{{ count === 1 ? '' : 's' }}",atRiskWarning:"en riesgo. Revisa tu estrategia para evitar penalizaciones.",all:"Todos",inProgress:"En progreso",criticalObjectives:"Objetivos Crticos",seasonObjectives:"Objetivos de Temporada",noObjectives:"Sin objetivos definidos",objectivesWillGenerate:"Los objetivos de temporada se generarn al comenzar la liga.",boardExpects:"La directiva espera"},Sve={championsQualification:"Clasificacin a Champions",europeanQualification:"Clasificacin europea",topHalf:"Primera mitad de tabla",avoidRelegation:"Evitar el descenso",promotion:"Ascenso",titleContender:"Luchar por el ttulo",goalDifference:"Diferencia de goles positiva",financialStability:"Estabilidad financiera",youthDevelopment:"Desarrollo de cantera"},Tve={championsQualification:"Terminar entre los 4 primeros para clasificar a la Continental Champions Cup",europeanQualification:"Terminar entre los 6 primeros para clasificar a competicin europea",topHalf:"Terminar en la primera mitad de la clasificacin",avoidRelegation:"Mantener la categora terminando fuera de puestos de descenso",promotion:"Conseguir el ascenso a la categora superior",titleContender:"Terminar entre los 2 primeros",goalDifference:"Terminar la temporada con ms goles a favor que en contra",financialStability:"No terminar la temporada en nmeros rojos",youthDevelopment:"Dar minutos a jugadores jvenes del club"},wve={title:"Mensajes",inbox:"Bandeja de Entrada",unread:"No Ledos",all:"Todos",transfers:"Traspasos",injuries:"Lesiones",contracts:"Contratos",objectives:"Objetivos",markAsRead:"Marcar como Ledo",deleteAll:"Borrar todo",deleteAllConfirm:"Eliminar todos los mensajes?",noMessages:"No tienes mensajes",backToMessages:"Volver a mensajes",deleteMessage:"Eliminar mensaje"},Eve={noCupActive:"No hay copa activa esta temporada",cup:"Copa",season:"Temporada",champion:"Campen!",cupFinished:"Copa finalizada",eliminatedIn:"Eliminado en",round:"Ronda",inCompetition:"En competicin",nextRound:"Prxima ronda",matches:"partidos",exempt:"exentos",current:"Actual"},Mve={title:"Renovaciones de Contrato",subtitle:"Gestiona los contratos de tu plantilla",contractExpiring:"Contrato Expira",wantsToRenew:"Quiere Renovar",rejectRenewal:"Rechaza Renovacin",demandIncrease:"Pide Aumento",offer:"Oferta",playerDemands:"Exigencias del Jugador",currentContract:"Contrato actual:",newContract:"Nuevo Contrato",contractExpiresSoon:"Contrato expira pronto",wantsToLeave:"Quiere irse",veryUnhappy:"Muy descontento",unhappy:"Descontento",wantToLeave:"Quieren irse",urgent:"Urgentes",displeased:"Descontentos",years:"aos",year:"ao",contract:"Contrato",salary:"Salario",minutes:"Minutos",happiness:"Felicidad",negotiateRenewal:"Negociar Renovacin",retiring:"Se retira",noRenewalNeeded:"No necesita renovar (ms de 2 aos de contrato)",renewal:"Renovacin",playerInfo:"Informacin del Jugador",currentSalary:"Salario actual:",minutesPlayed:"Minutos jugados:",playerConditions:"Condiciones del jugador:",required:"obligatorio",acceptsOffer:"Acepta la oferta!",wantsToNegotiate:"Quiere negociar",rejectsOffer:"Rechaza la oferta",playerCounterOffer:"Contraoferta del jugador:",demandsStarterRole:"Exige: Rol de titular",acceptCounterOffer:"Aceptar contraoferta",abandonNegotiation:"Abandonar negociacin",playerWillSign:"El jugador firmar el nuevo contrato",playerNotInterested:"El jugador no est interesado en renovar con estas condiciones.",close:"Cerrar",yourOffer:"Tu oferta",newWeeklySalary:"Nuevo salario semanal",contractDuration:"Duracin del contrato",promisedRole:"Rol prometido",starter:"Titular",rotation:"Rotacin",backup:"Suplente",weeklyCost:"Coste semanal:",playerAsks:"El jugador pide:",sendOffer:"Enviar Oferta",hasRenewed:"ha renovado",newContractDetails:"Nuevo contrato: {{years}} aos, {{salary}}/sem",refusesToRenew:"rechaza renovar",playerUnhappyWantsOut:"El jugador est descontento y quiere salir del club"},Cve={title:"Competiciones",domestic:"Domsticas",european:"Europeas",international:"Internacionales",league:"Liga",cup:"Copa",champions:"Champions League",europa:"Europa League",conference:"Conference League",qualifyForEuropean:"Clasifcate en liga para jugar competiciones europeas",qualifyForSouthAmerican:"Clasifcate en liga para jugar la Copa Libertadores o Sudamericana",cupWillStart:"La Copa comenzar durante la temporada",europeTab:"Europa",continentalTab:"Continental",europe:"Europa",continental:"Continental"},Nve={title:"Ranking",contrarreloj:"Contrarreloj",position:"Posicin",manager:"Entrenador",team:"Equipo",time:"Tiempo",trophies:"Trofeos",noRecords:"Sin rcords an",records:"RCORDS",subtitle:"Modo Contrarreloj  Los mejores tiempos",clear:"Borrar",confirmClear:"Borrar todos los rcords? Esta accin no se puede deshacer.",loading:"Cargando ranking...",noRecordsDesc:"Completa el modo Contrarreloj para aparecer en el ranking.",playContrarreloj:"Jugar Contrarreloj",player:"Jugador",score:"Puntuacin",seasons:"Temp.",competition:"Competicin",date:"Fecha"},Rve={title:"Notificaciones",clear:"Limpiar",settings:"Configuracin",matchResult:"Resultado del Partido",transfer:"Traspaso",injury:"Lesin",contract:"Contrato",objective:"Objetivo",board:"Directiva",fired:"Despido",bankruptcy:"Crisis",yellow:"Tarjeta",red:"Expulsin",transferOffer:"Oferta",loan:"Cesin",cup:"Copa",european:"Europa",southamerican:"Continental",retirement:"Retiro",offer:"Oferta",training:"Entreno",youth:"Cantera",medical:"Mdico",facility:"Instalacin",news:"Noticia",default:"Mensaje",moreNotifications:"+{{count}} notificaciones ms",checkInbox:"Revisa tu bandeja de entrada"},Pve={POR:"POR",DFC:"DFC",LD:"LD",LI:"LI",CRD:"CRD",CRI:"CRI",MCD:"MCD",MC:"MC",MCO:"MCO",MD:"MD",MI:"MI",ED:"ED",EI:"EI",DC:"DC",SD:"SD"},Ive={goalkeeper:"Portero",defender:"Defensa",midfielder:"Centrocampista",forward:"Delantero",gkShort:"POR",defShort:"DEF",midShort:"MED",fwdShort:"DEL",backToSquad:"Volver a plantilla",injuredWeeks:"Lesionado  {{weeks}} semana(s) de baja",speed:"Velocidad",technique:"Tcnica",passing:"Pase",shooting:"Remate",defense:"Defensa",physical:"Fsico",number:"Dorsal",myTeam:"Mi Equipo",average:"Media"},Lve={home:"Inicio",competitions:"Compet.",more:"Ms",advance:"Avanzar",menu:"Men"},Dve={champion:"CAMPEN!",gameOver:"FIN DEL JUEGO",copaLibertadores:"Copa Libertadores",championsLeague:"Continental Champions Cup",conquered:"{{competition}} conquistada!",anonymous:"Annimo",bankrupt:"?? Tu equipo ha entrado en bancarrota.",noPlayers:"?? No tienes suficientes jugadores para formar un equipo.",fired:"?? La directiva ha prescindido de tus servicios.",bestPlayer:"Mejor jugador",years:"aos",runStats:"Estadsticas de la run",matches:"Partidos",victories:"Victorias",draws:"Empates",defeats:"Derrotas",winRate:"% Victoria",trophies:"Palmars",achievedIn:"Lo conseguiste en",lasted:"Duraste",seasons:"temporada",seasons_plural:"temporadas",seeRanking:"Ver Ranking"},kve={title:"DESTITUIDO",defaultReason:"La junta directiva ha decidido prescindir de sus servicios como entrenador.",balance:"Balance",confidence:"Confianza de la directiva",backToMenu:"Volver al Men Principal",bankruptReason:"La directiva te ha destituido por llevar al club a la bancarrota."},Ove={accountCreated:"Cuenta creada! Revisa tu email para verificar tu cuenta.",passwordResetSent:"Email de recuperacin enviado. Revisa tu bandeja de entrada.",verificationResent:"Email de verificacin reenviado",emailNotVerified:"Email an no verificado. Revisa tu bandeja de entrada.",verifyEmail:"Verifica tu email",verificationSent:"Hemos enviado un email de verificacin a:",clickLinkToActivate:"Haz clic en el enlace del email para activar tu cuenta.",checking:"Comprobando...",alreadyVerified:"Ya lo verifiqu",resendEmail:"Reenviar email",login:"Iniciar Sesin",createAccount:"Crear Cuenta",resetPassword:"Recuperar Contrasea",continueWithGoogle:"Continuar con Google",enterAsGuest:"Entrar como Invitado (Pruebas)",orUseEmail:"o usa tu email",username:"Nombre de usuario",usernamePlaceholder:"Tu nombre en el juego",email:"Email",emailPlaceholder:"tu@email.com",password:"Contrasea",enter:"Entrar",sendEmail:"Enviar email",forgotPassword:"Olvidaste tu contrasea?",noAccount:"No tienes cuenta? Regstrate",haveAccount:"Ya tienes cuenta? Inicia sesin",backToLogin:"Volver a iniciar sesin",enterUsername:"Introduce un nombre de usuario"},Fve={title:"Competiciones Europeas",notQualified:"No ests clasificado para competiciones europeas esta temporada.",qualificationHint:"Termina en los primeros puestos de tu liga para clasificarte.",selectCompetition:"Selecciona una competicin",prizes:"Premios: {{amount}}",eliminated:"Eliminado",standings:"Clasificacin  Fase de Liga",matchday:"Jornada {{current}}/{{total}}",knockoutPhase:"Fase Eliminatoria  {{phase}}",championTitle:"{{competition}}  Campen!",finalScore:"Final: {{score}}",recentResults:"ltimos Resultados",pendingDraw:"Pendiente de sorteo...",aggregate:"Agg: {{score}}",phases:{league:"Fase de Liga",playoff:"Playoffs",r16:"Octavos de Final",qf:"Cuartos de Final",sf:"Semifinales",final:"Final",completed:"Competicin Finalizada",r16Short:"Octavos",qfShort:"Cuartos",sfShort:"Semifinales"},legend:{directQualification:"1-8: Octavos directos",playoff:"9-24: Playoffs",eliminated:"25-32: Eliminado"}},jve={title:"Competiciones Sudamericanas",notQualified:"No ests clasificado para competiciones continentales esta temporada.",qualificationHint:"Termina en los primeros puestos de tu liga para clasificarte."},Bve={challengeStart:"Inicio del desafo",seasonPosition:"Temporada {{season}}  {{position}} de {{total}}",promotion:"Ascenso!",promotionDetail:"De {{from}} a {{to}}",relegation:"Descenso",relegationDetail:"De {{from}} a {{to}}",continentalCompetition:"Competicin continental",phaseReached:"Fase alcanzada: {{phase}}",trophyWon:"?? {{trophy}}",seasonLabel:"Temporada {{season}}",currentSeason:"Temporada {{season}}  EN CURSO",currentPosition:"{{position}} de {{total}}",noClassification:"Sin clasificacin",copaLibertadores:"Copa Libertadores",championsLeague:"Continental Champions Cup",winGoal:"?? Ganar la {{competition}}",accomplished:"CONSEGUIDO!",howManySeasonsQuestion:"Cuntas temporadas necesitars?",roadToGlory:"Camino a la Gloria",startingFrom:"desde",currentLeague:"Liga actual",positionOf:"de {{total}}",position:"Posicin",trophies:"Trofeos",timeline:"Cronologa"},Uve={weekDate:"Semana {{week}}",preseason:"Pretemporada",endOfSeason:"Fin Temporada {{season}}",newOfferReceived:" Nueva oferta recibida",offerForListedPlayer:" Oferta por jugador en venta",offerExpired:" Oferta expirada",offerCancelled:" Oferta cancelada: {{player}}",transferConfirmed:" Fichaje confirmado",transferComplete:" Fichaje completado",newYouthPlayer:" Nuevo canterano",loanOfferReceived:" Oferta de cesin recibida",leagueChampion:" Campen de Liga!",playerReceivedOnLoan:" Jugador recibido en cesin",purchaseOptionExecuted:" Opcin de compra ejecutada",loanAccepted:" Cesin aceptada",loan:"Cesin",treatmentApplied:" Tratamiento aplicado",playerRetiredTitle:"Se retira: {{player}}",aperturaClausuraFinal:" Final Apertura vs Clausura",cupChampionTitle:"{{icon}} CAMPEN DE LA {{cup}}!!",offerContent:"{{buyer}} ofrece {{amount}} por {{player}}",transferConfirmedContent:"{{player}} ({{position}}, {{overall}}) ficha por {{toTeam}} desde {{fromTeam}} por {{price}}",youthPlayerContent:"La cantera ({{spec}}) ha promocionado a {{player}} ({{position}}, {{overall}} OVR, {{age}} aos)",playerRetired:"{{player}} ({{position}}, {{overall}} OVR) se retira del ftbol profesional",offerExpiredContent:"La oferta de {{team}} por {{player}} ha caducado",playerUnavailableRefund:"{{player}} ya no est disponible. Se devuelven {{amount}}",loanOfferContent:"{{team}} quiere llevarse a {{player}} en cesin. Fee: {{fee}}",directChampion:"{{team}} gana Apertura y Clausura y es campen directo de la {{league}}.",aperturaClausuraFinalContent:"Tu equipo jugar la final de la {{league}}! {{apertura}} (Apertura) vs {{clausura}} (Clausura).",transferCompleteContent:"{{player}} es nuevo jugador del equipo! Coste: {{cost}}",transferCompleteCounterContent:"{{player}} es nuevo jugador del equipo! Contraoferta aceptada: {{cost}}",medicalTreatment:"{{player}} ha recibido tratamiento. Lesin reducida de {{oldWeeks}} a {{newWeeks}} semanas. Coste: {{cost}}",cupChampionContent:"{{team}} ha ganado la {{cup}}!",playerReceivedOnLoanContent:"{{player}} llega cedido desde {{team}}. Fee: {{fee}}{{option}}",purchaseOptionContent:"{{player}} fichado en propiedad por {{amount}}",startOfSeason:"Inicio Temporada {{season}}",newYouthPlayerSon:" Nuevo canterano: {{player}}",youthSonContent:"Hijo de {{parent}}  {{position}}, {{overall}} OVR, potencial {{potential}}",offerExpiredPlayer:" Oferta expirada: {{player}}",offerExpiredRefund:"Tu oferta por {{player}} ha caducado sin respuesta. Se devuelven {{amount}}",offerResponse:"{{icon}} Respuesta: {{player}}",offerRejectedContent:" Club: {{clubReason}}   Jugador: {{playerReason}}",counterOfferExpired:" Contraoferta expirada: {{player}}",counterOfferExpiredContent:"La contraoferta por {{player}} ha caducado. Se devuelven {{amount}}",saleComplete:" Venta completada",saleCompleteContent:"Has vendido a {{player}} al {{team}} por {{amount}}",counterOfferAccepted:" Contraoferta aceptada",counterOfferAcceptedContent:"{{team}} acepta pagar {{amount}} por {{player}}",counterOfferRejected:" Contraoferta rechazada",counterOfferRejectedContent:"{{team}} no acepta tu contraoferta de {{amount}} por {{player}}",europeanIncome:"{{icon}} Ingresos europeos",continentalIncome:"{{icon}} Ingresos continentales",prizeMoneyContent:"{{competition}}: +{{amount}}",cupByeTitle:"{{icon}} {{cup}}",cupByeContent:"Tu equipo pasa directamente a la siguiente ronda (exento)",cupFinishedTitle:"{{icon}} {{cup}} finalizada!",cupWonContent:"Tu equipo ha ganado la {{cup}}!",cupWonByOther:"La {{cup}} ha sido ganada por {{winner}}",cupMatchResult:"{{icon}} {{cup}}: {{team}} {{playerScore}} - {{rivalScore}} {{rival}}",cupAdvance:"Clasificado para la siguiente ronda!",cupEliminated:"Eliminado de la copa",playerLoaned:" Jugador cedido",playerLoanedContent:"{{player}} cedido al {{team}}. Fee: {{fee}}{{option}}",aperturaClausuraFinalResult:" Final Apertura vs Clausura",aperturaClausuraFinalResultContent:"{{winner}} gana la final de la {{league}}. Ida: {{leg1Home}}-{{leg1Away}}, Vuelta: {{leg2Home}}-{{leg2Away}}.",directChampionShort:"{{winner}} es campen directo."},Vve={title:"ProManager",menuSubtitle:"Carrera de entrenador desde abajo",chooseCountry:"Elige un pas para empezar tu carrera",chooseTeam:"Elige un equipo para dirigir",leagues:"ligas",newOffers:"Nuevas ofertas",noOffers:"No hay ofertas disponibles. Prueba otro pas.",startCareer:"Iniciar Carrera",activeCareer:"Carrera activa",dashboard:"ProManager",boardConfidence:"Confianza de la directiva",objective:"Objetivo",prestige:"Prestigio",matches:"PJ",wins:"PG",titles:"Ttulos",board:{happy:"La directiva est encantada con tu trabajo.",neutral:"La directiva sigue tu progreso con atencin.",concerned:"La directiva empieza a cuestionar tus decisiones.",warning:" La directiva est considerando tu destitucin!",fired:"La directiva ha decidido prescindir de tus servicios."},objectives:{winLeague:"Ganar la liga",topTwo:"Terminar en el Top 2",european:"Clasificarse para Europa (Top {{position}})",topHalf:"Mitad superior de la tabla",avoidRelegation:"Evitar el descenso",midTable:"Mitad de tabla"},seasonEnd:{title:"Fin de Temporada",champion:"Campen! Temporada extraordinaria.",exceeded:"Has superado las expectativas de la directiva.",met:"Objetivo cumplido. Buen trabajo.",close:"Cerca del objetivo, pero no fue suficiente.",failed:"No has cumplido el objetivo de la directiva.",viewOffers:"Ver ofertas de trabajo",jobOffers:"Ofertas de trabajo",renewWith:"Renovar con {{team}}",renew:"Renovar",noExternalOffers:"No hay ofertas externas en este momento.",retire:"Retirarse"}},zve={victory:"VICTORIA!",defeat:"DERROTA",draw:"EMPATE",disconnectWin:"Victoria por desconexin!",disconnectLoss:"Derrota por desconexin",myTeam:"Mi equipo",rivalTeam:"Rival",breakdown:" Desglose de puntos",you:"T",rival:"Rival",leagueChampion:"Campen de Liga",cup:"Copa",superCup:"Supercopa",aboveRival:"Mejor posicin que rival",h2hWins:"Victorias directas ({{count}})",h2h:"Enfrentamientos directos",leaguePos:"Posicin liga: {{pos}} ({{pts}} pts)",cupRound:"Copa: {{round}}",backToLobby:"Volver al Lobby"},Gve={round1:"Ronda 1  Primera vuelta",round2:"Ronda 2  Segunda vuelta",ready:"Listo",setReady:"Listo!",waitingReady:"Esperando al rival...",readyStatus:"{{count}}/2",timerExpired:"Tiempo agotado"},qve={common:nve,mainMenu:ave,office:ive,formation:sve,plantilla:rve,transfers:ove,calendar:lve,matchday:cve,leagueTable:uve,finance:dve,facilities:hve,stadium:fve,training:pve,settings:mve,sidebar:gve,saveSlots:Ave,teamSelection:yve,contrarreloj:vve,contrarrelojSetup:_ve,seasonEnd:xve,objectives:bve,objNames:Sve,objDescs:Tve,messages:wve,cup:Eve,renewals:Mve,competitions:Cve,ranking:Nve,notifications:Rve,positions:Pve,squad:Ive,mobileNav:Lve,contrarrelojEnd:Dve,managerFired:kve,auth:Ove,europe:Fve,southAmerica:jve,contrarrelojProgress:Bve,gameMessages:Uve,proManager:Vve,rankedResults:zve,ranked:Gve},Hve={save:"Save",cancel:"Cancel",confirm:"Confirm",accept:"Accept",close:"Close",back:"Back",continue:"Continue",yes:"Yes",no:"No",loading:"Loading...",error:"Error",warning:"Warning",success:"Success",next:"Next",previous:"Previous",edit:"Edit",delete:"Delete",add:"Add",remove:"Remove",select:"Select",search:"Search",filter:"Filter",all:"All",none:"None",name:"Name",age:"Age",position:"Position",value:"Value",salary:"Salary",contract:"Contract",team:"Team",league:"League",season:"Season",week:"Week",day:"Day",month:"Month",year:"Year",money:"Money",budget:"Budget",unknown:"Unknown"},Wve={title:"PC GAFFER",subtitle:"",season:"",continueGame:"Continue Game",play:"Play",login:"Log In",logout:"Log Out",loggingOut:"Logging Out...",saveGame:"Save Game",contrarreloj:"Race Against Time",records:"Records",options:"Options",loadOrCreate:"Load game or create new",saveProgress:"Save your progress in the cloud",saveCurrentProgress:"Save your current progress",reachChampions:"Reach Champions League from the bottom",guestNotice:"Log in to save your progress in the cloud",tribute:"The beautiful game, managed by you",contrarrelojActive:"Race Against Time Active",newGame:"New Game",deleteWarning:"?? Starting a new game will delete current progress",playButton:"Play",loginButton:"Log In",saveCurrentGame:"Save Game",recordsButton:"Records",optionsButton:"Options"},$ve={noCupActive:"No active cup this season",cup:"Cup",season:"Season",champion:"Champion!",cupFinished:"Cup finished",eliminatedIn:"Eliminated in",round:"Round",inCompetition:"In competition",nextRound:"Next round",matches:"matches",exempt:"exempt",current:"Current"},Kve={title:"Office",overview:"Overview",simulate:"Simulate",simulateWeek:"Simulate Week",simulateSeason:"Simulate Season",simulateToWindow:"Simulate to Window",simulating:"Simulating...",seasonInfo:"Season {{season}}",weekInfo:"Week {{week}}",changeManagerName:"Manager name (shown in ranking):",clickToChangeName:"Click to change name",budget:"Budget",teamValue:"Team Value",stadiumCapacity:"Stadium Capacity",facilities:"Facilities",objectives:"Objectives",nextMatch:"Next Match",vs:"VS",home:"Home",away:"Away",injuredWarning:"Injured players in lineup",playersInjured:"You have {{count}} injured player{{count, plural, one {} other {s}}} in your starting lineup",stillPlay:"Do you want to continue with the match?",checkFormation:"Go to Formation and substitute the injured players before continuing.",welcome:"Welcome, Manager",preseason:"Preseason {{week}}/{{total}}",players:"players",boardConfidence:"Board confidence",friendlyMatch:"Friendly {{week}}/5",matchday:"Matchday {{week}}",lastResults:"Last Results",form_W:"W",form_D:"D",form_L:"L",noMatches:"No matches played",mainObjective:"Main Objective",viewAllObjectives:"View all objectives",recentMessages:"Recent Messages",weeksOut:"{{weeks}} week{{weeks, plural, one {} other {s}}}",goToFormation:"Go to Formation",threeMatches:"3 matches",endOfSeason:"End of season",halfSeason:"Half season",winterBanner:"WINTER WINDOW  Matchday {{current}} of {{total}}",notEnoughPlayers:"You don't have enough players to form a team",seasonEnd:"Season End",seasonEndedAfterWeeks:"The season has ended after {{weeks}} simulated weeks.",simulatedWeeks:"Simulated {{weeks}} weeks",advancedToWeek:"You have advanced to week {{week}}",insufficientSquad:"Insufficient squad!",onlyHavePlayers:"You only have <strong>{{count}} players</strong>. You need a minimum of <strong>11</strong> to play.",goToTransfersWarning:"Go to the transfer market and sign players before continuing. If you try to simulate again without having 11 players, <strong>you will lose the game</strong>.",goToTransfers:"Go to Transfers"},Yve={title:"Formation",lineup:"Lineup",reserves:"Called Up Players",notCalled:"Not Called Players",injured:"Injured",suspended:"Suspended",tactic:"Tactic",formation:"Formation",captain:"Captain",freekicks:"Free Kicks",penalties:"Penalties",corners:"Corners",mentality:"Mentality",attacking:"Attacking",balanced:"Balanced",defensive:"Defensive",fitness:"Fitness",morale:"Morale",energy:"Energy",experience:"Experience",makeReserve:"Make Reserve",makeStarter:"Make Starter",makeNotCalled:"Don't Call",callUp:"Call Up",setCaptain:"Set Captain",setFreekicks:"Take Free Kicks",setPenalties:"Take Penalties",setCorners:"Take Corners",years:"years old",statistics:"Statistics",selectPlayer:"Select Player",tacticAndFormation:"Tactic and Formation",parameters:"PARAMETERS",rating:"RATING",teamAverage:"TEAM AVERAGE",playingAs:"playing as",tacDefensive:"Defensive",tacDefensiveDesc:"Park the bus, few chances",tacDefensiveBonus:"+40% defense, -40% attack",tacDefensiveDetail:"Strong vs Balanced  Weak vs Possession and Attacking",tacBalanced:"Balanced",tacBalancedDesc:"No surprises, no risks",tacBalancedBonus:"No modifiers",tacBalancedDetail:"No tactical advantages or disadvantages",tacAttacking:"Attacking",tacAttackingDesc:"All out, high risk",tacAttackingBonus:"+35% attack, -30% defense",tacAttackingDetail:"Strong vs Defensive  Weak vs Counter and Press",tacPossession:"Possession",tacPossessionDesc:"Control the ball and tire them out",tacPossessionBonus:"+30% possession, +10% defense",tacPossessionDetail:"Strong vs Counter  Weak vs High Press",tacCounter:"Counter-Attack",tacCounterDesc:"Give up the ball, hit on the break",tacCounterBonus:"+20% attack, +15% defense, -25% possession",tacCounterDetail:"Strong vs Attacking and Press  Weak vs Possession",noInjuredPlayers:"No injured players",medicalLevel:"Medical center level: {{level}}/5",upgradeMedical:"Upgrade facilities for more treatments",statsTeam:"Team",statsSeason:"Season",statsPlayers:"Players",statsTop:"Top",players:"PLAYERS",avgOVR:"AVG OVR",avgAge:"AVG AGE",squadValue:"SQUAD VALUE",matches:"Matches",wins:"Wins",draws:"Draws",losses:"Losses",goalsFor:"Goals for",goalsAgainst:"Goals against",goalDiff:"Difference",topRated:"Top rated",mostValuable:"Most valuable",mostMatches:"Most matches",noStatsYet:"No stats yet - play matches to generate data",apply:"Apply"},Xve={title:"Squad",players:"players",player:"PLAYER",contracts:"Contracts",salaries:"Salaries",totalSalary:"Total Salary",averageAge:"Average Age",squadSize:"Squad Size",putForSale:"Put For Sale",renew:"Renew",release:"Release",loan:"Loan",recall:"Recall",yearsLeft:"Years Left",onLoan:"On Loan",forSale:"For Sale",wantToLeave:"Wants to Leave",unhappy:"Unhappy",sortBy:"Sort by",expired:"Expired",oneYear:"{{years}} year",multipleYears:"{{years}} years",budget:"Budget",weeklySalary:"Wage bill",perYear:"/year",perWeek:"/week",ofBudget:"of budget",playersNeedAttention:"{{count}} player(s) need(s) attention",retiring:"Retiring",wantsToLeaveAlert:"Wants to leave",more:"+{{count}} more",renewPlayer:"Renew {{name}}",currentContractLabel:"Current contract",demands:"Demands",budgetImpact:"Budget impact:",acceptAndRenew:"Accept and renew",sellPlayer:"Put {{name}} for sale",marketValue:"Market value",currentSalary:"Current salary",ifSold:"If sold:",savedSalary:"saved",sellNote:"The player will appear on the market. Other teams can make offers.",unlistPlayer:"Remove {{name}} from sale",unlistQuestion:"This player is currently on the transfer list. Do you want to remove them from the market?",unlistNote:"Will stop receiving offers from other teams.",confirmUnlist:"Yes, remove from sale",releasePlayer:"Release {{name}}",severanceWarning:"You must pay the severance for the remaining {{years}} year(s) of contract.",severanceCost:"Severance to pay:",salarySaved:"You will save on salaries:",moraleWarning:"This may affect the dressing room morale",insufficientFunds:"You don't have enough money for the severance",payAndRelease:"Pay and release",onLoanTag:"ON LOAN",forSaleTag:"For sale",removeFromSale:"Click to remove from sale",renewContract:"Renew contract",releasePlayerBtn:"Release player",loanedBy:"Player loaned by {{team}}  Cannot sell or release",loanedBadge:"On loan",years:"years",total:"total",canRenew:"Can be renewed",cannotRenew:"Player doesn't need renewal (more than 2 years left)",playerRetiring:"Player has announced retirement"},Qve={title:"Transfers",explore:"Explore",scout:"Scout",search:"Search",received:"Received",sent:"Sent",offers:"Offers",market:"Market",available:"Available",notForSale:"Not for sale",makeOffer:"Make Offer",counterOffer:"Counter Offer",accept:"Accept",reject:"Reject",withdraw:"Withdraw",negotiate:"Negotiate",transferFee:"Transfer Fee",salary:"Salary",duration:"Duration",loan:"Loan",permanent:"Permanent",windowClosed:"Transfer Window Closed",windowOpens:"Window opens in week",windowCloses:"Window closes in week",noOffers:"No offers",scoutingReport:"Scouting Report",preseasonOpen:"Preseason  Market OPEN",matchdayOpen:"Matchday {{week}}  Market OPEN",marketOpen:"Market Open",preseasonMessage:"It's preseason. Take advantage and sign players before the league starts!",marketAlwaysOpen:"The market is always open. Sign, loan and negotiate whenever you want.",totalTransfers:"Total Transfers",moneyMoved:"Money Moved",activeRumors:"Active Rumors",latestTransfers:"Latest Transfers",noRecentTransfers:"No recent transfers",marketRumors:"Market Rumors",reliable:"{{pct}}% reliable",noActiveRumors:"No active rumors",searchPlayerPlaceholder:"Search player by name...",filters:"Filters",position:"Position",allPositions:"All",goalkeeper:"Goalkeeper",defender:"Defender",midfielder:"Midfielder",forward:"Forward",ageRange:"Age: {{min}} - {{max}}",minOvr:"Min OVR: {{value}}",freeOnly:"Free agents only",free:"FREE",yearsOld:"{{age}} yrs",blockedThisSeason:"Blocked this season",contractExpiring:"Contract expiring",noReceivedOffers:"No offers received",noInterestYet:"No club has shown interest in your players... yet.",pendingTransferOffers:"Pending transfer offers",transfer:"Transfer",pending:"Pending",expiresWeek:"Expires wk. {{week}}",askMore:"Ask more",pendingLoanOffers:"Pending loan offers",loanFee:"Loan fee",receiverSalary:"Receiver salary",purchaseOption:"Purchase option",historyTitle:"History",rejected:"Rejected",noOffersOrLoans:"No offers or loans",noActiveOffersMsg:"You have no active offers or loans. Search for players to strengthen your team!",transferOffers:"Transfer offers",clear:"Clear",perYear:"/yr",weekShort:"Wk. {{week}}",pendingResponse:"Pending response  simulate a match",club:"Club",accepts:"Accepts",playerLabel:"Player",transferComplete:"Transfer completed!",clubAsks:"Club asks {{amount}}",acceptCounter:"Accept counter offer",playerRejectedCantComplete:"Player rejected, cannot complete",deleteBtn:"Delete",offerRejected:"Offer rejected",loanedOutPlayers:"Loaned out players",loanedOut:"Loaned out",weeksShort:"{{weeks}} wks",atTeam:"At {{team}}",purchaseOptionAmount:"Purchase option: {{amount}}",loanedInPlayers:"Players on loan",onLoan:"On loan",ownedBy:"Owned by {{team}}",buyAmount:"Buy ({{amount}})",newsFeed:"News Feed",noRecentNews:"No recent news",europe:"Europe",southAmerica:"South America",restOfWorld:"Rest of the World",leaguesMeta:"{{count}} league{{plural}}  {{teams}} teams",nTeams:"{{count}} teams",searchTeamPlaceholder:"Search team...",playersAvgOvr:"{{count}} players  Avg {{avg}}",yourTeam:"Your team",posHeader:"POS",playerHeader:"PLAYER",ageHeader:"AGE",ovrHeader:"OVR",valueHeader:"VALUE",levelBadge:"Lv. {{level}}",searchPositionLabel:"Position to search:",analyzingMarket:"Analyzing market...",searchPlayers:"Search players",searchSpecific:"Search {{pos}}",playersFound:"{{count}} players found",tickerDefault:"Transfer market active | Stay tuned for updates",breakingNews:"BREAKING NEWS",loanExclamation:"LOAN!",transferExclamation:"TRANSFER!",seasonLabel:"Season",nYears:"{{count}} years",totalWord:"total",close:"Close",transferFailed:"TRANSFER FAILED",blockedUntilNextSeason:"You won't be able to negotiate with this player until next season",freeAgent:"FREE AGENT",ageLabel:"Age",valueLabel:"Value",salaryLabel:"Salary",contractLabel:"Contract",noContract:"No contract",professional:"Professional",difficultyLabel:"Difficulty",tierDropWarning:"Drops {{count}} tier{{plural}}",freeAgentLabel:"Free Agent",signing:"Signing",loanToggle:"Loan",preContractToggle:"Pre-contract",requestLoan:"Request Loan",negotiatingStatus:"Negotiating...",acceptedStatus:"Accepted",rejectedBadge:"Rejected",salaryPercentLabel:"% salary I pay",salaryPayHint:"You'd pay {{amount}}/yr of salary",loanDenied:"{{team}} does not accept to loan {{player}}. {{reasons}}",noPurchaseOption:"No purchase option",noOption:"No option",valuePercent90:"90% value",valuePercent100:"100% value",estimatedProbability:"Estimated probability",insufficientBudget:"Insufficient budget ({{amount}})",sendLoanRequest:"Send loan request",waitingClubResponse:"Waiting for club response...",prepareOffer:"Prepare Offer",directRival:"Direct rival",transferToClub:"Transfer fee to club",clubAccepts:"Club accepts",annualSalary:"Annual salary",minEstimated:"Min estimated: {{amount}}/yr",contractDuration:"Contract duration",playerAccepts:"Player accepts",totalTransferCost:"Total transfer cost",totalContractCost:"Total contract cost",totalInvestment:"Total investment",sendOffer:"Send offer",offerHint:"Response will arrive after simulating a match. The amount is reserved from your budget.",freeAgentNegotiation:"Free Agent Negotiation",preContractSection:"Pre-contract",acceptedPlayerStatus:"Accepted",rejectedPlayerStatus:"Rejected",counterOfferStatus:"Counter Offer",freeAgentInfo:"No club negotiation needed. Negotiate directly with the player by offering a signing bonus and salary.",preContractBadge:"PRE-CONTRACT",preContractInfo:"Their contract expires soon. You can negotiate directly without paying a transfer fee. They'll join your team when their contract ends.",signingBonus:"Signing bonus",suggested:"Suggested: {{amount}}",totalCostFormatted:"Total cost: {{amount}} ({{years}} year{{plural}})",acceptanceProbability:"Acceptance probability",playerCounterLabel:"Player's counter offer:",counterTotalCost:"Total cost: {{amount}}",totalCostLabel:"Total cost",presentOffer:"Present offer",offerPreContract:"Offer pre-contract",playerEvaluating:"The player is evaluating your offer...",noAgreementReached:"No agreement was reached with the player",insufficientSalaryOffer:"The salary offer is insufficient",expectsHigherBonus:"Expects a higher signing bonus",teamLevelNotConvincing:"Not convinced by the team's level",overallOfferNotConvincing:"Not convinced by the overall offer",needsMoreMoney:"Needs more money to compensate for the club's level",wantsFinancialImprovement:"Wants a financial improvement to accept the move",freeAgentSigned:"Free agent signed",preContractSigned:"Pre-contract signed",playerJoined:"{{name}} is a new player. Bonus: {{bonus}}, Salary: {{salary}}/yr",offerSentTitle:"Offer sent",offerSentContent:"Offer for {{name}} ({{team}}): {{amount}} + {{salary}}/yr",playerRejectedDefinitely:"The player rejected definitively",loanNotPossible:"Loan not possible",cannotLoan:"Cannot loan",insufficientForLoanFee:"You need {{amount}} for the loan fee",insufficientBudgetTitle:"Insufficient budget",cannotExecute:"Cannot execute",noLoanPurchaseOption:"This loan has no purchase option",insufficientBudgetShort:"Insufficient budget",europeTab:"Europe",continentalTab:"Continental",accepted:"Accepted",age:"Age",contract:"Contract",difficulty:"Difficulty",freeAgentsOnly:"Free agents only",history:"History",level:"Lv.",loanBadge:"Loan",loanSuccess:"LOAN!",negotiating:"Negotiating...",noOffersReceived:"No offers received",noSentOffers:"No offers or loans",noSentOffersDesc:"You have no active offers or loans. Find players to strengthen your team!",persProfessional:"Professional",playerValue:"Value",posAll:"All",posDEF:"Defender",posFWD:"Forward",posGK:"Goalkeeper",positionToSearch:"Position to search",posMID:"Midfielder",preseasonMsg:"We're in preseason. Sign players before the league starts!",purchaseOptionLabel:"Purchase option",recentTransfers:"Latest Transfers",responseAfterMatch:"The response will arrive after simulating a match. The amount is reserved from your budget.",searchPlaceholder:"Search player by name...",season:"Season",signingFailed:"SIGNING FAILED",signingSuccess:"SIGNING!",tickerMsg:"Transfer market active | Stay tuned for updates",transferBadge:"Transfer",transferCompleted:"Transfer completed!",value:"value",wantsHigherBonus:"Expects a higher signing bonus",year:"year",years:"years",veryEasy:"Very Easy",easy:"Easy",normal:"Normal",hard:"Hard",veryHard:"Very Hard",almostImpossible:"Nearly Impossible",persAmbitious:"Ambitious",persLoyal:"Loyal",persMercenary:"Mercenary",persHomesick:"Homebody",persAdventurous:"Adventurous",persDescAmbitious:"Wants to play at top clubs",persDescLoyal:"Very unlikely to leave their club",persDescMercenary:"Only cares about money",persDescHomesick:"Prefers to stay close to home",persDescProfessional:"Evaluates everything with balance",persDescAdventurous:"Likes a change of scenery"},Jve={title:"Calendar",fixtures:"Fixtures",results:"Results",matchday:"Matchday",date:"Date",time:"Time",home:"Home",away:"Away",score:"Score",competition:"Competition",venue:"Venue",european:"European",southAmerican:"South American",cup:"Cup",week:"Week",noEuropeanMatches:"No European matches this matchday",noSouthAmericanMatches:"No South American matches this matchday",noCupMatches:"No cup matches this round"},Zve={title:"Match Day",kickoff:"Kick Off",fulltime:"Full Time",halftime:"Half Time",goal:"Goal!",assist:"Assist",yellowCard:"Yellow Card",redCard:"Red Card",substitution:"Substitution",injury:"Injury",minute:"Min",attendance:"Attendance",possession:"Possession",shots:"Shots",shotsOnTarget:"Shots on Target",corners:"Corners",fouls:"Fouls",offsides:"Offsides",golazo:"WHAT A GOAL!",lateGoal:"Late goal!",finalResult:"Final Result",skipToEnd:"Skip to end",noMatchThisWeek:"No match this week"},e_e={title:"League Table",position:"Pos",team:"Team",played:"P",won:"W",drawn:"D",lost:"L",goalsFor:"GF",goalsAgainst:"GA",goalDifference:"DIFF",points:"PTS",form:"Form",next:"Next",last5:"Last 5",champion:"Champion",championQualification:"Champions Qualification",europaQualification:"Europa Qualification",conferenceQualification:"Conference Qualification",relegation:"Relegation",playoff:"Playoff",championsLeague:"Continental Champions Cup",libertadores:"Copa Libertadores",europaLeague:"Continental Shield",sudamericana:"Copa Sudamericana",conferenceLeague:"Continental Trophy",promotion:"Direct Promotion",playoffPromotion:"Promotion Playoff",apertura:"Apertura",clausura:"Clausura",acumulada:"Accumulated",inProgress:"in progress",searchLeague:"Search league...",yourLeague:"Your league",noData:"No data available for this league.",noDataHint:"Data will be generated as the season progresses.",group:"Group",championLabel:"Champion",firstLeg:"1st leg",secondLeg:"2nd leg",bothTournamentsChampion:"champion of both tournaments",formW:"W",formD:"D",formL:"L",showAllTeams:"Show all teams ({{count}})",showLess:"Show less",countries:{spain:"Spain",england:"England",italy:"Italy",germany:"Germany",france:"France",restOfEurope:"Rest of Europe",southAmerica:"South America"}},t_e={title:"Finance",income:"Income",expenses:"Expenses",balance:"Balance",profit:"Profit",loss:"Loss",ticketSales:"Ticket Sales",transfers:"Transfers",sponsorship:"Sponsorship",merchandise:"Merchandise",salaries:"Salaries",maintenance:"Maintenance",other:"Other",bank:"Bank",currentBudget:"Current Budget",currentSeason:"Current Season",seasonTickets:"Season Tickets (end season collection)",pending:"pending",noCampaignClosed:"No campaign closed",ticketsSold:"Tickets sold",accumulatedMatches:"Accumulated matches played",stadiumNaming:"Stadium naming",playerSales:"Player sales",prizesRewards:"Prizes and rewards",squadSalaries:"Squad salaries (end season)",stadiumMaintenance:"Stadium maintenance",signings:"Signings",seasonBalance:"Season balance"},n_e={title:"Facilities",subtitle:"Upgrade your club to compete at the highest level",training:"Training",youth:"Youth",medical:{infirmary:"Infirmary",doctors:"Doctors",available:"available",heals:"Heals",weeks:"weeks",weeksShort:"wks",weeksSingular:"",weeksPlural:"s",cost:"Cost",noInjured:"No injured players",inTreatment:"In treatment",noMedicalCenter:"No medical center",noDoctorsAvailable:"No doctors available",reduceTo:"Reduce to"},level:"Level",upgrade:"Upgrade",upgraded:"upgraded",cost:"Cost",benefit:"Benefit",upgrading:"Upgrading",completed:"Completed",incomePerSeason:"Income/season",nextLevel:"Next level",maxLevel:"Max Level",specialization:"Specialization",notChosen:"Not chosen",choose:"Choose",chooseSpecDesc:"Choose specialization (will be locked until next season)",ignore:"Ignore",categories:{income:"Income",development:"Development",support:"Support"},stadium:{name:"Stadium",description:"Capacity and home advantage"},impact:{title:"Impact of your facilities",youth:"Youth players",treatments:"Treatments",weeksSaved:"Weeks saved"},facilityNames:{stadium:"Stadium",sponsorship:"Commercial",youth:"Youth Academy",medical:"Medical Center",scouting:"Scouting"},facilityDescs:{stadium:"Capacity and home advantage",sponsorship:"Sponsorship income",youth:"Generates young talent",medical:"Reduces injury time",scouting:"Reduces transfer costs"},levelNames:{municipal:"Municipal",modern:"Modern",large:"Large",elite:"Elite",legendary:"Legendary",basic:"Basic",active:"Active",professional:"Professional",premium:"Premium",developed:"Developed",advanced:"Advanced",improved:"Improved",local:"Local",national:"National",european:"European",worldwide:"Worldwide"},benefits:{seats:"{{count}} seats",youthPlayer:"1 youth player/season ({{range}})",standardRecovery:"Standard recovery",injuryReduction:"-{{percent}}% injuries  {{treatments}} treatment(s)",noTransferAdvantage:"No transfer advantage",transferDiscount:"-{{percent}}% transfer cost"}},a_e={title:"Stadium",capacity:"Capacity",expand:"Expand",maintenance:"Maintenance",condition:"Condition",excellent:"Excellent",good:"Good",poor:"Poor",terrible:"Terrible",view3dNotAvailable:"3D view not available",loadingStadium:"Loading stadium...",general:"General",sponsorship:"Sponsorship",events:{friendly:"Friendly Match",concert:"Concert",corporate:"Corporate Event",legends:"Legends Match"},seasonTicketCampaign:"Season Ticket Campaign",campaignOpen:"Campaign open until matchday {{deadline}} (current: {{current}})",seasonTicketPrice:"Season ticket price:",pricePerMatch:"{{matches}} matches ? {{pricePerMatch}}/match",expectedSubscribers:"Expected subscribers:",maxShort:"max",closeCampaign:"Close campaign and fix subscribers",campaignClosed:"Campaign closed",subscribers:"subscribers",pricePerTicket:"price/ticket",collected:"collected",ofCapacitySubscribed:"{{percent}}% of capacity subscribed",ticketPrice:"Ticket Price",priceLocked:"Price fixed for this season. Only for non-subscribers.",setPriceBeforeLeague:"Price per match for non-subscribers. Set before the league starts.",accumulatedTicketIncome:"Accumulated ticket income",onlyTicketsSold:"Only tickets sold (without subscribers). Collected at the end of the season.",lastHomeMatchday:"Last home matchday",ticketsSold:"Tickets sold",totalAttendance:"Total attendance",ticketIncome:"Ticket income",grassCondition:"Grass Condition",optimal:"Optimal",injuryRisk:"Injury risk +{{percent}}%",recovers:"Recovers +5%/week",perfectCondition:"In perfect condition",poorGrassWarning:"Poor condition increases injuries for YOUR players",repairGrass:"Repair grass ({{cost}})",currentSponsor:"Current Sponsor",yearsRemaining:"{{years}} years remaining",cancelContract:"Cancel contract",penalty:"Penalty: {{amount}}",namingOffers:"Naming Offers",sellStadiumName:"Sell the stadium name for annual income",upgradeForSponsors:"Improve your stadium to attract sponsors",organizeEvents:"Organize Events",generateExtraIncome:"Generate extra income (requires 2 weeks between events)",waitMoreWeeks:"Wait {{weeks}} more week(s)",grassDamage:"Grass damage: -{{percent}}%",organize:"Organize",repairGrassBeforeEvents:"Repair the grass before organizing events",homeAdvantage:"Home advantage",occupation:"Occupation",grass:"Grass",budget:"Budget",stadium:"Stadium",accept:"Accept",perYear:"/year",years:"years",seasonTicketsClosed:"Season tickets campaign closed",seasonTicketsMessage:"{{count}} subscribers  {{price}} = {{total}} (will be collected at end of season)",namingRights:"Naming Rights",namingMessage:"Agreement with {{sponsor}}: {{amount}}M/year for {{duration}} years",sponsorshipCancelled:"Sponsorship cancelled",stadiumNameRestored:"The stadium recovers its original name. Penalty paid: {{amount}}M",stadiumNameRestoredFree:"The stadium recovers its original name",eventHosted:"Event held. Income: {{amount}}K",stadiumUpgraded:"Stadium expanded",nowStadium:"Now it's {{name}} with {{capacity}} seats",seats:"seats",insufficientFunds:"Insufficient funds",penaltyRequired:"You need {{amount}}M to pay the penalty for cancelling the contract."},i_e={title:"Training Intensity",fitness:"Fitness",tactics:"Tactics",technical:"Technical",intensity:"Intensity",low:"Low",medium:"Medium",high:"High",intensitySet:"Training intensity set",intensitySetDesc:"The team will train with {{intensity}} intensity throughout the season.",lockedUntil:"Locked until next preseason",selectIntensity:"Select intensity for the entire season",statImprovement:"Stat improvement",injuryRisk:"Injury risk",facilityLevel:"Facility level",bonus:"bonus",currentIntensity:"Current intensity",canChangeNext:"You can change it at the start of next season",intensities:{light:{name:"Light",description:"Lower progression, fewer injuries. Ideal for veterans."},normal:{name:"Normal",description:"Balanced progression and risk."},intense:{name:"Intense",description:"Maximum progression, higher injury risk."}}},s_e={title:"Settings",language:"Language",graphics:"Graphics",sound:"Sound",gameplay:"Gameplay",difficulty:"Difficulty",easy:"Easy",normal:"Normal",hard:"Hard",animations:"Animations",notifications:"Notifications",autosave:"Auto Save",general:"General",autosaveLabel:"Auto-save",autosaveDesc:"Automatically saves every 5 minutes",volume:"Volume",music:"Music",effects:"Effects",gameData:"Game Data",saveAndExit:"Save and exit",deleteAndReset:"Delete data and restart",deleteConfirm:"Delete all data?",deleteMessage:"This action will delete your saved game and cannot be undone.",appTitle:"PC Gaffer",appVersion:"Version 1.0.0",appTribute:"The art of management",difficultyEasyDesc:"Less aggressive AI, more initial money",difficultyNormalDesc:"Balanced experience",difficultyHardDesc:"Very competitive AI, fewer resources",speedSlow:"Slow",speedSlowDesc:"More time to watch matches",speedNormalDesc:"Standard speed",speedFast:"Fast",speedFastDesc:"Shorter matches",yesDeleteAll:"Yes, delete all"},r_e={office:"Office",formation:"Formation",squad:"Squad",transfers:"Transfers",calendar:"Calendar",table:"Table",finance:"Finance",stadium:"Stadium",facilities:"Facilities",training:"Training",objectives:"Objectives",competitions:"Competitions",messages:"Messages",bank:"Bank",options:"Options",mainMenu:"Main Menu"},o_e={back:"Back",loadGame:"Load Game",saveGame:"Save Game",manageGames:"Manage Games",selectOrCreate:"Select a saved game or create a new one",chooseSlot:"Choose a slot to save your progress",manageSlots:"Manage your saved games",slot:"Slot",emptySlot:"Empty slot",newGame:"New Game",saving:"Saving...",saveHere:"Save here",unknownTeam:"Unknown team",loading:"Loading...",load:"Load",overwrite:"Overwrite?",deleteGame:"Delete game?",loadingGames:"Loading games...",never:"Never",errorLoadGames:"Error loading games",errorLoadGame:"Error loading game",errorSaveGame:"Error saving game",errorDeleteGame:"Error deleting game"},l_e={teamsAvailable:"{{count}} teams available",comingSoon:"Coming soon",groupsAndTeams:"{{groups}} groups  {{teams}} teams",teamsCount:"{{count}} team{{count, plural, one {} other {s}}}",selectGroup:"Select a group",searchTeam:"Search team...",stadium:"Stadium",municipal:"Municipal",capacity:"Capacity",reputation:"Reputation",presentation:"Presentation",startSeason:"Start Season"},c_e={title:"Race Against Time Mode",setup:"Setup",start:"Start",objective:"Objective: Reach Champions League from the bottom",rules:"Rules",progress:"Progress",timeElapsed:"Time Elapsed",seasonsPlayed:"Seasons Played",currentLeague:"Current League",trophies:"Trophies",completed:"Completed!",failed:"Failed",activated:"Race Against Time activated!",objectiveMessage:"Objective: win the {{competition}} with {{team}} in the fewest seasons. The clock is ticking!",southAmericanCup:"South American Champions Cup",continentalCup:"Continental Champions Cup"},u_e={menu:"Menu",title:"RACE AGAINST TIME",subtitle:"Can you reach the top of European/South American football?",objective:"Objective",winChampions:"Win the Champions League or Copa Libertadores",losesIf:"You lose if",fired:"You get fired or your budget goes negative",ranking:"Ranking",fewestSeasons:"Fewest number of seasons wins",chooseChallenge:"Choose your challenge",newTeams:"New teams",ovr:"OVR",goal:"Goal:",libertadores:"?? Copa Libertadores",championsLeague:"?? Champions League",starting:"Starting...",acceptChallenge:"ACCEPT THE CHALLENGE!"},d_e={title:"Season End",summary:"Summary",achievements:"Achievements",statistics:"Statistics",topScorer:"Top Scorer",bestPlayer:"Best Player",nextSeason:"Next Season",finalTitle:"Final",league:"League",aperturaVsClausura:"Apertura vs Clausura",firstLeg:"First Leg",secondLeg:"Second Leg",result:"Result",byAggregate:"by aggregate score",byAwayGoals:"by away goals",byClausuraAdvantage:"by sporting advantage (Clausura champion)",sameChampion:"champion of both tournaments",playoffAscenso:"Promotion Playoff",semifinals:"Semifinals",final:"FINAL!",victory:"Victory!",defeat:"Defeat",extraTime:"Extra Time",penalties:"Penalties",champion:"CHAMPION!",runner:"Runner-up",promotion:"PROMOTION!",relegation:"Relegation",eliminated:"The team has been eliminated from the playoff",ascends:"ASCENDS TO THE LEAGUE!",playoffCompleted:"Playoff completed",playoffWinner:"Playoff winner",seasonSummary:"Season Summary",finalPosition:"Final Position",points:"Points",wins:"Wins",draws:"Draws",losses:"Losses",goalDifference:"Goal Diff",qualifiedFor:"Qualified for",qualificationBonus:"Qualification bonus",objectives:"Objectives",objectiveBalance:"Objectives balance",europeanBonus:"European bonus",continue:"Continue",playMatch:"Play match",nextMatch:"Next match",homeGame:"We play at home",awayGame:"We play away"},h_e={title:"Objectives",current:"Current",completed:"Completed",failed:"Failed",primary:"Primary",secondary:"Secondary",bonus:"Bonus",leaguePosition:"League Position",cupProgress:"Cup Progress",budget:"Budget",youngPlayers:"Young Players",critical:"Critical",high:"High",medium:"Medium",low:"Low",objective:"Objective",onTrack:"On Track",atRisk:"At Risk",danger:"Danger",pending:"Pending",goalDifference:"Goal Diff",objectivesAtRisk:"objective{{ count === 1 ? '' : 's' }}",atRiskWarning:"at risk. Review your strategy to avoid penalties.",all:"All",inProgress:"In Progress",criticalObjectives:"Critical Objectives",seasonObjectives:"Season Objectives",noObjectives:"No objectives defined",objectivesWillGenerate:"Season objectives will be generated when the league starts.",boardExpects:"The board expects"},f_e={championsQualification:"Champions Qualification",europeanQualification:"European Qualification",topHalf:"Top Half Finish",avoidRelegation:"Avoid Relegation",promotion:"Promotion",titleContender:"Title Contender",goalDifference:"Positive Goal Difference",financialStability:"Financial Stability",youthDevelopment:"Youth Development"},p_e={championsQualification:"Finish in the top 4 to qualify for the Continental Champions Cup",europeanQualification:"Finish in the top 6 to qualify for European competition",topHalf:"Finish in the top half of the table",avoidRelegation:"Stay up by finishing outside the relegation zone",promotion:"Earn promotion to the higher division",titleContender:"Finish in the top 2",goalDifference:"End the season with more goals scored than conceded",financialStability:"Don't end the season in the red",youthDevelopment:"Give minutes to young players from the academy"},m_e={title:"Messages",inbox:"Inbox",unread:"Unread",all:"All",transfers:"Transfers",injuries:"Injuries",contracts:"Contracts",objectives:"Objectives",markAsRead:"Mark as Read",deleteAll:"Delete All",deleteAllConfirm:"Delete all messages?",noMessages:"You have no messages",backToMessages:"Back to messages",deleteMessage:"Delete message"},g_e={title:"Contract Renewals",subtitle:"Manage your squad contracts",contractExpiring:"Contract Expiring",wantsToRenew:"Wants to Renew",rejectRenewal:"Rejects Renewal",demandIncrease:"Demands Increase",offer:"Offer",playerDemands:"Player Demands",currentContract:"Current contract",newContract:"New Contract",contractExpiresSoon:"Contract expires soon",wantsToLeave:"Wants to leave",veryUnhappy:"Very unhappy",unhappy:"Unhappy",wantToLeave:"Want to leave",urgent:"Urgent",displeased:"Displeased",years:"years",year:"year",contract:"Contract",salary:"Salary",minutes:"Minutes",happiness:"Happiness",negotiateRenewal:"Negotiate Renewal",retiring:"Retiring",noRenewalNeeded:"No renewal needed (more than 2 years contract)",renewal:"Renewal",playerInfo:"Player Info",currentSalary:"Current salary",minutesPlayed:"Minutes played",playerConditions:"Player conditions:",required:"required",acceptsOffer:"Accepts offer!",wantsToNegotiate:"Wants to negotiate",rejectsOffer:"Rejects offer",playerCounterOffer:"Player counter offer:",demandsStarterRole:"Demands: Starter role",acceptCounterOffer:"Accept counter offer",abandonNegotiation:"Abandon negotiation",playerWillSign:"Player will sign the new contract",playerNotInterested:"Player is not interested in renewing with these conditions.",close:"Close",yourOffer:"Your offer",newWeeklySalary:"New weekly salary",contractDuration:"Contract duration",promisedRole:"Promised role",starter:"Starter",rotation:"Rotation",backup:"Backup",weeklyCost:"Weekly cost:",playerAsks:"Player asks:",sendOffer:"Send Offer",hasRenewed:"has renewed",newContractDetails:"New contract: {{years}} years, {{salary}}/week",refusesToRenew:"refuses to renew",playerUnhappyWantsOut:"Player is unhappy and wants to leave the club"},A_e={title:"Competitions",domestic:"Domestic",european:"European",international:"International",league:"League",cup:"Cup",champions:"Champions League",europa:"Europa League",conference:"Conference League",qualifyForEuropean:"Qualify in league to play European competitions",qualifyForSouthAmerican:"Qualify in league to play Copa Libertadores or Sudamericana",cupWillStart:"The Cup will start during the season",europeTab:"Europe",continentalTab:"Continental",europe:"Europe",continental:"Continental"},y_e={title:"Ranking",contrarreloj:"Race Against Time",position:"Position",manager:"Manager",team:"Team",time:"Time",trophies:"Trophies",noRecords:"No records yet",records:"RECORDS",subtitle:"Race Against Time Mode  Best Times",clear:"Clear",confirmClear:"Delete all records? This action cannot be undone.",loading:"Loading ranking...",noRecordsDesc:"Complete Race Against Time mode to appear in the ranking.",playContrarreloj:"Play Race Against Time",player:"Player",score:"Score",seasons:"Seasons",competition:"Competition",date:"Date"},v_e={title:"Notifications",clear:"Clear",settings:"Settings",matchResult:"Match Result",transfer:"Transfer",injury:"Injury",contract:"Contract",objective:"Objective",board:"Board",fired:"Fired",bankruptcy:"Crisis",yellow:"Card",red:"Expulsion",transferOffer:"Offer",loan:"Loan",cup:"Cup",european:"Europe",southamerican:"Continental",retirement:"Retirement",offer:"Offer",training:"Training",youth:"Youth",medical:"Medical",facility:"Facility",news:"News",default:"Message",moreNotifications:"+{{count}} more notifications",checkInbox:"Check your inbox"},__e={POR:"GK",DFC:"CB",LD:"RB",LI:"LB",CRD:"RWB",CRI:"LWB",MCD:"CDM",MC:"CM",MCO:"CAM",MD:"RM",MI:"LM",ED:"RW",EI:"LW",DC:"ST",SD:"CF"},x_e={goalkeeper:"Goalkeeper",defender:"Defender",midfielder:"Midfielder",forward:"Forward",gkShort:"GK",defShort:"DEF",midShort:"MID",fwdShort:"FWD",backToSquad:"Back to squad",injuredWeeks:"Injured  {{weeks}} week(s) out",speed:"Speed",technique:"Technique",passing:"Passing",shooting:"Shooting",defense:"Defense",physical:"Physical",number:"Number",myTeam:"My Team",average:"Average"},b_e={home:"Home",competitions:"Comp.",more:"More",advance:"Advance",menu:"Menu"},S_e={champion:"CHAMPION!",gameOver:"GAME OVER",copaLibertadores:"Copa Libertadores",championsLeague:"Continental Champions Cup",conquered:"{{competition}} conquered!",anonymous:"Anonymous",bankrupt:"?? Your team has gone bankrupt.",noPlayers:"?? You don't have enough players to form a team.",fired:"?? The board has dispensed with your services.",bestPlayer:"Best player",years:"years old",runStats:"Run statistics",matches:"Matches",victories:"Victories",draws:"Draws",defeats:"Defeats",winRate:"Win %",trophies:"Trophies",achievedIn:"You achieved it in",lasted:"You lasted",seasons:"season",seasons_plural:"seasons",seeRanking:"See Ranking"},T_e={title:"FIRED",defaultReason:"The board has decided to relieve you of your coaching duties.",balance:"Record",confidence:"Board confidence",backToMenu:"Back to Main Menu",bankruptReason:"The board has fired you for driving the club into bankruptcy."},w_e={accountCreated:"Account created! Check your email to verify your account.",passwordResetSent:"Password reset email sent. Check your inbox.",verificationResent:"Verification email resent",emailNotVerified:"Email not yet verified. Check your inbox.",verifyEmail:"Verify your email",verificationSent:"We've sent a verification email to:",clickLinkToActivate:"Click the link in the email to activate your account.",checking:"Checking...",alreadyVerified:"I already verified it",resendEmail:"Resend email",login:"Log In",createAccount:"Create Account",resetPassword:"Reset Password",continueWithGoogle:"Continue with Google",enterAsGuest:"Enter as Guest (Testing)",orUseEmail:"or use your email",username:"Username",usernamePlaceholder:"Your name in the game",email:"Email",emailPlaceholder:"your@email.com",password:"Password",enter:"Enter",sendEmail:"Send email",forgotPassword:"Forgot your password?",noAccount:"Don't have an account? Sign up",haveAccount:"Already have an account? Sign in",backToLogin:"Back to login",enterUsername:"Enter a username"},E_e={title:"European Competitions",notQualified:"You are not qualified for European competitions this season.",qualificationHint:"Finish in the top positions of your league to qualify.",selectCompetition:"Select a competition",prizes:"Prize money: {{amount}}",eliminated:"Eliminated",standings:"League Phase Table",matchday:"Matchday {{current}}/{{total}}",knockoutPhase:"Knockout Phase  {{phase}}",championTitle:"{{competition}}  Champion!",finalScore:"Final: {{score}}",recentResults:"Recent Results",pendingDraw:"Awaiting draw...",aggregate:"Agg: {{score}}",phases:{league:"League Phase",playoff:"Playoffs",r16:"Round of 16",qf:"Quarterfinals",sf:"Semifinals",final:"Final",completed:"Competition Finished",r16Short:"Round of 16",qfShort:"Quarterfinals",sfShort:"Semifinals"},legend:{directQualification:"1-8: Direct to Round of 16",playoff:"9-24: Playoffs",eliminated:"25-32: Eliminated"}},M_e={title:"South American Competitions",notQualified:"You are not qualified for continental competitions this season.",qualificationHint:"Finish in the top positions of your league to qualify."},C_e={challengeStart:"Challenge start",seasonPosition:"Season {{season}}  {{position}} of {{total}}",promotion:"Promotion!",promotionDetail:"From {{from}} to {{to}}",relegation:"Relegation",relegationDetail:"From {{from}} to {{to}}",continentalCompetition:"Continental competition",phaseReached:"Phase reached: {{phase}}",trophyWon:"?? {{trophy}}",seasonLabel:"Season {{season}}",currentSeason:"Season {{season}}  ONGOING",currentPosition:"{{position}} of {{total}}",noClassification:"No ranking",copaLibertadores:"Copa Libertadores",championsLeague:"Continental Champions Cup",winGoal:"?? Win the {{competition}}",accomplished:"ACCOMPLISHED!",howManySeasonsQuestion:"How many seasons will you need?",roadToGlory:"Road to Glory",startingFrom:"starting from",currentLeague:"Current league",positionOf:"of {{total}}",position:"Position",trophies:"Trophies",timeline:"Timeline"},N_e={weekDate:"Week {{week}}",preseason:"Preseason",endOfSeason:"End of Season {{season}}",newOfferReceived:" New offer received",offerForListedPlayer:" Offer for listed player",offerExpired:" Offer expired",offerCancelled:" Offer cancelled: {{player}}",transferConfirmed:" Transfer confirmed",transferComplete:" Transfer completed",newYouthPlayer:" New youth player",loanOfferReceived:" Loan offer received",leagueChampion:" League Champion!",playerReceivedOnLoan:" Player received on loan",purchaseOptionExecuted:" Purchase option executed",loanAccepted:" Loan accepted",loan:"Loan",treatmentApplied:" Treatment applied",playerRetiredTitle:"Retires: {{player}}",aperturaClausuraFinal:" Apertura vs Clausura Final",cupChampionTitle:"{{icon}} {{cup}} CHAMPION!!",offerContent:"{{buyer}} offers {{amount}} for {{player}}",transferConfirmedContent:"{{player}} ({{position}}, {{overall}}) signs for {{toTeam}} from {{fromTeam}} for {{price}}",youthPlayerContent:"Academy ({{spec}}) has promoted {{player}} ({{position}}, {{overall}} OVR, {{age}} yrs)",playerRetired:"{{player}} ({{position}}, {{overall}} OVR) retires from professional football",offerExpiredContent:"The offer from {{team}} for {{player}} has expired",playerUnavailableRefund:"{{player}} is no longer available. {{amount}} refunded",loanOfferContent:"{{team}} wants {{player}} on loan. Fee: {{fee}}",directChampion:"{{team}} wins Apertura and Clausura and is direct champion of {{league}}.",aperturaClausuraFinalContent:"Your team will play the {{league}} final! {{apertura}} (Apertura) vs {{clausura}} (Clausura).",transferCompleteContent:"{{player}} is a new member of the team! Cost: {{cost}}",transferCompleteCounterContent:"{{player}} is a new member of the team! Counter offer accepted: {{cost}}",medicalTreatment:"{{player}} received treatment. Injury reduced from {{oldWeeks}} to {{newWeeks}} weeks. Cost: {{cost}}",cupChampionContent:"{{team}} won the {{cup}}!",playerReceivedOnLoanContent:"{{player}} arrives on loan from {{team}}. Fee: {{fee}}{{option}}",purchaseOptionContent:"{{player}} signed permanently for {{amount}}",startOfSeason:"Start of Season {{season}}",newYouthPlayerSon:" New youth player: {{player}}",youthSonContent:"Son of {{parent}}  {{position}}, {{overall}} OVR, potential {{potential}}",offerExpiredPlayer:" Offer expired: {{player}}",offerExpiredRefund:"Your offer for {{player}} has expired without response. {{amount}} refunded",offerResponse:"{{icon}} Response: {{player}}",offerRejectedContent:" Club: {{clubReason}}   Player: {{playerReason}}",counterOfferExpired:" Counter offer expired: {{player}}",counterOfferExpiredContent:"Counter offer for {{player}} has expired. {{amount}} refunded",saleComplete:" Sale completed",saleCompleteContent:"You sold {{player}} to {{team}} for {{amount}}",counterOfferAccepted:" Counter offer accepted",counterOfferAcceptedContent:"{{team}} agrees to pay {{amount}} for {{player}}",counterOfferRejected:" Counter offer rejected",counterOfferRejectedContent:"{{team}} rejects your counter offer of {{amount}} for {{player}}",europeanIncome:"{{icon}} European income",continentalIncome:"{{icon}} Continental income",prizeMoneyContent:"{{competition}}: +{{amount}}",cupByeTitle:"{{icon}} {{cup}}",cupByeContent:"Your team advances directly to the next round (bye)",cupFinishedTitle:"{{icon}} {{cup}} finished!",cupWonContent:"Your team won the {{cup}}!",cupWonByOther:"The {{cup}} was won by {{winner}}",cupMatchResult:"{{icon}} {{cup}}: {{team}} {{playerScore}} - {{rivalScore}} {{rival}}",cupAdvance:"Qualified for the next round!",cupEliminated:"Eliminated from the cup",playerLoaned:" Player loaned out",playerLoanedContent:"{{player}} loaned to {{team}}. Fee: {{fee}}{{option}}",aperturaClausuraFinalResult:" Apertura vs Clausura Final",aperturaClausuraFinalResultContent:"{{winner}} wins the {{league}} final. 1st leg: {{leg1Home}}-{{leg1Away}}, 2nd leg: {{leg2Home}}-{{leg2Away}}.",directChampionShort:"{{winner}} is the direct champion."},R_e={title:"ProManager",menuSubtitle:"Manager career from the bottom",chooseCountry:"Choose a country to start your career",chooseTeam:"Choose a team to manage",leagues:"leagues",newOffers:"New offers",noOffers:"No offers available. Try another country.",startCareer:"Start Career",activeCareer:"Active Career",dashboard:"ProManager",boardConfidence:"Board Confidence",objective:"Objective",prestige:"Prestige",matches:"MP",wins:"W",titles:"Titles",board:{happy:"The board is delighted with your work.",neutral:"The board is monitoring your progress.",concerned:"The board is starting to question your decisions.",warning:" The board is considering your dismissal!",fired:"The board has decided to relieve you of your duties."},objectives:{winLeague:"Win the league",topTwo:"Finish in the Top 2",european:"Qualify for Europe (Top {{position}})",topHalf:"Top half of the table",avoidRelegation:"Avoid relegation",midTable:"Mid-table finish"},seasonEnd:{title:"End of Season",champion:"Champion! Extraordinary season.",exceeded:"You've exceeded the board's expectations.",met:"Objective met. Good work.",close:"Close to the objective, but not enough.",failed:"You failed to meet the board's objective.",viewOffers:"View job offers",jobOffers:"Job Offers",renewWith:"Renew with {{team}}",renew:"Renew",noExternalOffers:"No external offers at this time.",retire:"Retire"}},P_e={victory:"VICTORY!",defeat:"DEFEAT",draw:"DRAW",disconnectWin:"Victory by disconnection!",disconnectLoss:"Defeat by disconnection",myTeam:"My team",rivalTeam:"Rival",breakdown:" Points Breakdown",you:"You",rival:"Rival",leagueChampion:"League Champion",cup:"Cup",superCup:"Super Cup",aboveRival:"Finished above rival",h2hWins:"H2H wins ({{count}})",h2h:"Head to Head",leaguePos:"League position: {{pos}}th ({{pts}} pts)",cupRound:"Cup: {{round}}",backToLobby:"Back to Lobby"},I_e={round1:"Round 1  First Half",round2:"Round 2  Second Half",ready:"Ready",setReady:"Ready!",waitingReady:"Waiting for opponent...",readyStatus:"{{count}}/2",timerExpired:"Time expired"},L_e={common:Hve,mainMenu:Wve,cup:$ve,office:Kve,formation:Yve,plantilla:Xve,transfers:Qve,calendar:Jve,matchday:Zve,leagueTable:e_e,finance:t_e,facilities:n_e,stadium:a_e,training:i_e,settings:s_e,sidebar:r_e,saveSlots:o_e,teamSelection:l_e,contrarreloj:c_e,contrarrelojSetup:u_e,seasonEnd:d_e,objectives:h_e,objNames:f_e,objDescs:p_e,messages:m_e,renewals:g_e,competitions:A_e,ranking:y_e,notifications:v_e,positions:__e,squad:x_e,mobileNav:b_e,contrarrelojEnd:S_e,managerFired:T_e,auth:w_e,europe:E_e,southAmerica:M_e,contrarrelojProgress:C_e,gameMessages:N_e,proManager:R_e,rankedResults:P_e,ranked:I_e},D_e={save:"Sauvegarder",cancel:"Annuler",confirm:"Confirmer",accept:"Accepter",close:"Fermer",back:"Retour",continue:"Continuer",yes:"Oui",no:"Non",loading:"Chargement...",error:"Erreur",warning:"Avertissement",success:"Succs",next:"Suivant",previous:"Prcdent",edit:"Modifier",delete:"Supprimer",add:"Ajouter",remove:"Retirer",select:"Slectionner",search:"Rechercher",filter:"Filtrer",all:"Tous",none:"Aucun",name:"Nom",age:"ge",position:"Position",value:"Valeur",salary:"Salaire",contract:"Contrat",team:"quipe",league:"Championnat",season:"Saison",week:"Semaine",day:"Jour",month:"Mois",year:"Anne",money:"Argent",budget:"Budget",unknown:"Inconnu"},k_e={title:"PC GAFFER",subtitle:"",season:"",continueGame:"Continuer la Partie",play:"Jouer",login:"Se Connecter",logout:"Se Dconnecter",loggingOut:"Dconnexion...",saveGame:"Sauvegarder",contrarreloj:"Course Contre la Montre",records:"Records",options:"Options",loadOrCreate:"Charger ou crer une partie",saveProgress:"Sauvegardez votre progression dans le cloud",saveCurrentProgress:"Sauvegarder votre progression actuelle",reachChampions:"Atteignez la Champions League depuis le bas",guestNotice:"Connectez-vous pour sauvegarder votre progression dans le cloud",tribute:"Le beau jeu, dirig par vous",contrarrelojActive:"Course Contre la Montre Active",newGame:"Nouvelle Partie",deleteWarning:"?? Commencer une nouvelle partie supprimera les progrs actuels",playButton:"Jouer",loginButton:"Se connecter",saveCurrentGame:"Sauvegarder",recordsButton:"Records",optionsButton:"Options"},O_e={noCupActive:"Pas de coupe active cette saison",cup:"Coupe",season:"Saison",champion:"Champion !",cupFinished:"Coupe termine",eliminatedIn:"limin en",round:"Tour",inCompetition:"En comptition",nextRound:"Prochain tour",matches:"matchs",exempt:"exempts",current:"Actuel"},F_e={title:"Bureau",overview:"Aperu",simulate:"Simuler",simulateWeek:"Simuler Semaine",simulateSeason:"Simuler Saison",simulateToWindow:"Simuler jusqu'au Mercato",simulating:"Simulation...",seasonInfo:"Saison {{season}}",weekInfo:"Semaine {{week}}",changeManagerName:"Nom du manager (apparat dans le classement) :",clickToChangeName:"Cliquez pour changer le nom",budget:"Budget",teamValue:"Valeur de l'quipe",stadiumCapacity:"Capacit du Stade",facilities:"Installations",objectives:"Objectifs",nextMatch:"Prochain Match",vs:"VS",home:"Domicile",away:"Extrieur",injuredWarning:"Joueurs blesss dans l'quipe",playersInjured:"Vous avez {{count}} joueur{{count, plural, one {} other {s}}} bless{{count, plural, one {} other {s}}} dans votre quipe titulaire",stillPlay:"Voulez-vous continuer avec le match?",checkFormation:"Allez  la Composition et remplacez les joueurs blesss avant de continuer.",welcome:"Bienvenue, Entraneur",preseason:"Pr-saison {{week}}/{{total}}",players:"joueurs",boardConfidence:"Confiance de la direction",friendlyMatch:"Amical {{week}}/5",matchday:"Journe {{week}}",lastResults:"Derniers Rsultats",form_W:"V",form_D:"N",form_L:"D",noMatches:"Aucun match jou",mainObjective:"Objectif Principal",viewAllObjectives:"Voir tous les objectifs",recentMessages:"Messages Rcents",weeksOut:"{{weeks}} semaine{{weeks, plural, one {} other {s}}}",goToFormation:"Aller  la Composition",threeMatches:"3 matchs",endOfSeason:"Fin de saison",halfSeason:"Mi-saison",winterBanner:"MERCATO D'HIVER  Journe {{current}} de {{total}}",notEnoughPlayers:"Vous n'avez pas assez de joueurs pour former une quipe",seasonEnd:"Fin de Saison",seasonEndedAfterWeeks:"La saison s'est termine aprs {{weeks}} semaines simules.",simulatedWeeks:"{{weeks}} semaines simules",advancedToWeek:"Vous avez avanc jusqu' la semaine {{week}}",insufficientSquad:"Effectif insuffisant !",onlyHavePlayers:"Vous n'avez que <strong>{{count}} joueurs</strong>. Vous avez besoin d'un minimum de <strong>11</strong> pour jouer.",goToTransfersWarning:"Allez au march des transferts et signez des joueurs avant de continuer. Si vous tentez de simuler  nouveau sans avoir 11 joueurs, <strong>vous perdrez la partie</strong>.",goToTransfers:"Aller aux Transferts"},j_e={title:"Formation",lineup:"quipe Titulaire",reserves:"Joueurs Convoqus",notCalled:"Joueurs Non Convoqus",injured:"Blesss",suspended:"Suspendus",tactic:"Tactique",formation:"Formation",captain:"Capitaine",freekicks:"Coups Francs",penalties:"Pnalties",corners:"Corners",mentality:"Mentalit",attacking:"Offensive",balanced:"quilibre",defensive:"Dfensive",fitness:"Forme",morale:"Moral",energy:"nergie",experience:"Exprience",makeReserve:"Faire Remplaant",makeStarter:"Faire Titulaire",makeNotCalled:"Ne Pas Convoquer",callUp:"Convoquer",setCaptain:"Nommer Capitaine",setFreekicks:"Tirer les Coups Francs",setPenalties:"Tirer les Pnalties",setCorners:"Tirer les Corners",years:"ans",statistics:"Statistiques",selectPlayer:"Slectionner Joueur",tacticAndFormation:"Tactique et Formation",parameters:"PARAMTRES",rating:"NOTE",teamAverage:"MOYENNE QUIPE",playingAs:"jouant comme",tacDefensive:"Dfensive",tacDefensiveDesc:"Mur dfensif, peu d'occasions",tacDefensiveBonus:"+40% dfense, -40% attaque",tacDefensiveDetail:"Fort vs quilibre  Faible vs Possession et Offensive",tacBalanced:"quilibre",tacBalancedDesc:"Pas de surprises, pas de risques",tacBalancedBonus:"Aucun modificateur",tacBalancedDetail:"Pas d'avantages ni d'inconvnients tactiques",tacAttacking:"Offensive",tacAttackingDesc:"Tout pour l'attaque, risque lev",tacAttackingBonus:"+35% attaque, -30% dfense",tacAttackingDetail:"Fort vs Dfensive  Faible vs Contre et Pressing",tacPossession:"Possession",tacPossessionDesc:"Contrler le ballon et fatiguer",tacPossessionBonus:"+30% possession, +10% dfense",tacPossessionDetail:"Fort vs Contre  Faible vs Pressing haut",tacCounter:"Contre-attaque",tacCounterDesc:"Cder le ballon, tuer en contre",tacCounterBonus:"+20% attaque, +15% dfense, -25% possession",tacCounterDetail:"Fort vs Offensive et Pressing  Faible vs Possession",noInjuredPlayers:"Aucun joueur bless",medicalLevel:"Niveau centre mdical: {{level}}/5",upgradeMedical:"Amliorez les installations pour plus de traitements",statsTeam:"quipe",statsSeason:"Saison",statsPlayers:"Joueurs",statsTop:"Top",players:"JOUEURS",avgOVR:"MOY OVR",avgAge:"GE MOYEN",squadValue:"VALEUR EFFECTIF",matches:"Matchs",wins:"Victoires",draws:"Nuls",losses:"Dfaites",goalsFor:"Buts pour",goalsAgainst:"Buts contre",goalDiff:"Diffrence",topRated:"Mieux nots",mostValuable:"Plus prcieux",mostMatches:"Plus de matchs",noStatsYet:"Pas encore de stats - jouez des matchs pour gnrer des donnes",apply:"Appliquer"},B_e={title:"Effectif",players:"joueurs",player:"JOUEUR",contracts:"Contrats",salaries:"Salaires",totalSalary:"Salaire Total",averageAge:"ge Moyen",squadSize:"Taille de l'Effectif",putForSale:"Mettre en Vente",renew:"Renouveler",release:"Librer",loan:"Prter",recall:"Rappeler",yearsLeft:"Annes Restantes",onLoan:"En Prt",forSale:" Vendre",wantToLeave:"Veut Partir",unhappy:"Mcontent",sortBy:"Trier par",expired:"Expir",oneYear:"{{years}} an",multipleYears:"{{years}} ans",budget:"Budget",weeklySalary:"Masse salariale",perYear:"/an",perWeek:"/sem",ofBudget:"du budget",playersNeedAttention:"{{count}} joueur(s) ncessite(nt) attention",retiring:"Prend sa retraite",wantsToLeaveAlert:"Veut partir",more:"+{{count}} de plus",renewPlayer:"Renouveler {{name}}",currentContractLabel:"Contrat actuel",demands:"Demande",budgetImpact:"Impact sur le budget :",acceptAndRenew:"Accepter et renouveler",sellPlayer:"Mettre {{name}} en vente",marketValue:"Valeur marchande",currentSalary:"Salaire actuel",ifSold:"Si vendu :",savedSalary:"conomiss",sellNote:"Le joueur apparatra sur le march. D'autres quipes peuvent faire des offres.",unlistPlayer:"Retirer {{name}} de la vente",unlistQuestion:"Ce joueur est actuellement sur la liste des transferts. Voulez-vous le retirer du march ?",unlistNote:"Ne recevra plus d'offres d'autres quipes.",confirmUnlist:"Oui, retirer de la vente",releasePlayer:"Librer {{name}}",severanceWarning:"Vous devez payer l'indemnit pour les {{years}} anne(s) de contrat restantes.",severanceCost:"Indemnit  payer :",salarySaved:"Vous conomiserez en salaires :",moraleWarning:"Cela peut affecter le moral du vestiaire",insufficientFunds:"Vous n'avez pas assez d'argent pour l'indemnit",payAndRelease:"Payer et librer",onLoanTag:"EN PRT",forSaleTag:" vendre",removeFromSale:"Cliquez pour retirer de la vente",renewContract:"Renouveler le contrat",releasePlayerBtn:"Librer le joueur",loanedBy:"Joueur prt par {{team}}  Impossible de vendre ou librer",loanedBadge:"Prt",years:"ans",total:"total",canRenew:"Peut tre renouvel",cannotRenew:"Le joueur n'a pas besoin de renouvellement (plus de 2 ans restants)",playerRetiring:"Le joueur a annonc sa retraite"},U_e={title:"Transferts",explore:"Explorer",scout:"Scout",search:"Rechercher",received:"Reues",sent:"Envoyes",offers:"Offres",market:"March",available:"Disponible",notForSale:"Pas  vendre",makeOffer:"Faire une Offre",counterOffer:"Contre-offre",accept:"Accepter",reject:"Rejeter",withdraw:"Retirer",negotiate:"Ngocier",transferFee:"Indemnit de Transfert",salary:"Salaire",duration:"Dure",loan:"Prt",permanent:"Permanent",windowClosed:"Mercato Ferm",windowOpens:"Le mercato ouvre  la semaine",windowCloses:"Le mercato ferme  la semaine",noOffers:"Aucune offre",scoutingReport:"Rapport de Scout",preseasonOpen:"Pr-saison  March OUVERT",matchdayOpen:"Journe {{week}}  March OUVERT",marketOpen:"March Ouvert",preseasonMessage:"C'est la pr-saison. Profitez-en pour recruter avant le dbut du championnat !",marketAlwaysOpen:"Le march est toujours ouvert. Recrutez, prtez et ngociez quand vous voulez.",totalTransfers:"Transferts Totaux",moneyMoved:"Argent Dpens",activeRumors:"Rumeurs Actives",latestTransfers:"Derniers Transferts",noRecentTransfers:"Pas de transferts rcents",marketRumors:"Rumeurs du March",reliable:"{{pct}}% fiable",noActiveRumors:"Pas de rumeurs actives",searchPlayerPlaceholder:"Rechercher un joueur par nom...",filters:"Filtres",position:"Position",allPositions:"Toutes",goalkeeper:"Gardien",defender:"Dfenseur",midfielder:"Milieu",forward:"Attaquant",ageRange:"ge: {{min}} - {{max}}",minOvr:"OVR minimum: {{value}}",freeOnly:"Joueurs libres uniquement",free:"LIBRE",yearsOld:"{{age}} ans",blockedThisSeason:"Bloqu cette saison",contractExpiring:"Fin de contrat",noReceivedOffers:"Aucune offre reue",noInterestYet:"Aucun club n'a montr d'intrt pour vos joueurs... pour le moment.",pendingTransferOffers:"Offres de transfert en attente",transfer:"Transfert",pending:"En attente",expiresWeek:"Expire sem. {{week}}",askMore:"Demander plus",pendingLoanOffers:"Offres de prt en attente",loanFee:"Frais de prt",receiverSalary:"Salaire receveur",purchaseOption:"Option d'achat",historyTitle:"Historique",rejected:"Refuse",noOffersOrLoans:"Aucune offre ni prt",noActiveOffersMsg:"Vous n'avez pas d'offres actives ni de prts. Cherchez des joueurs pour renforcer votre quipe !",transferOffers:"Offres de transfert",clear:"Effacer",perYear:"/an",weekShort:"Sem. {{week}}",pendingResponse:"En attente de rponse  simulez un match",club:"Club",accepts:"Accepte",playerLabel:"Joueur",transferComplete:"Transfert complt !",clubAsks:"Le club demande {{amount}}",acceptCounter:"Accepter la contre-offre",playerRejectedCantComplete:"Le joueur a refus, impossible de complter",deleteBtn:"Supprimer",offerRejected:"Offre refuse",loanedOutPlayers:"Joueurs prts",loanedOut:"Prt",weeksShort:"{{weeks}} sem.",atTeam:" {{team}}",purchaseOptionAmount:"Option d'achat: {{amount}}",loanedInPlayers:"Joueurs en prt",onLoan:"En prt",ownedBy:"Proprit de {{team}}",buyAmount:"Acheter ({{amount}})",newsFeed:"Fil d'Actualits",noRecentNews:"Pas d'actualits rcentes",europe:"Europe",southAmerica:"Amrique du Sud",restOfWorld:"Reste du Monde",leaguesMeta:"{{count}} championnat{{plural}}  {{teams}} quipes",nTeams:"{{count}} quipes",searchTeamPlaceholder:"Rechercher quipe...",playersAvgOvr:"{{count}} joueurs  Moy {{avg}}",yourTeam:"Votre quipe",posHeader:"POS",playerHeader:"JOUEUR",ageHeader:"GE",ovrHeader:"OVR",valueHeader:"VALEUR",levelBadge:"Niv. {{level}}",searchPositionLabel:"Position  rechercher :",analyzingMarket:"Analyse du march...",searchPlayers:"Rechercher joueurs",searchSpecific:"Rechercher {{pos}}",playersFound:"{{count}} joueurs trouvs",tickerDefault:"March des transferts actif | Restez  l'coute",breakingNews:"DERNIRE HEURE",loanExclamation:"PRT !",transferExclamation:"TRANSFERT !",seasonLabel:"Saison",nYears:"{{count}} ans",totalWord:"total",close:"Fermer",transferFailed:"TRANSFERT CHOU",blockedUntilNextSeason:"Vous ne pourrez pas ngocier avec ce joueur avant la saison prochaine",freeAgent:"AGENT LIBRE",ageLabel:"ge",valueLabel:"Valeur",salaryLabel:"Salaire",contractLabel:"Contrat",noContract:"Sans contrat",professional:"Professionnel",difficultyLabel:"Difficult",tierDropWarning:"Descend de {{count}} niveau{{plural}}",freeAgentLabel:"Agent Libre",signing:"Recrutement",loanToggle:"Prt",preContractToggle:"Pr-contrat",requestLoan:"Demander un Prt",negotiatingStatus:"En ngociation...",acceptedStatus:"Accepte",rejectedBadge:"Refuse",salaryPercentLabel:"% salaire que je paie",salaryPayHint:"Vous paieriez {{amount}}/an du salaire",loanDenied:"{{team}} n'accepte pas de prter {{player}}. {{reasons}}",noPurchaseOption:"Pas d'option d'achat",noOption:"Sans option",valuePercent90:"90% valeur",valuePercent100:"100% valeur",estimatedProbability:"Probabilit estime",insufficientBudget:"Budget insuffisant ({{amount}})",sendLoanRequest:"Envoyer demande de prt",waitingClubResponse:"En attente de rponse du club...",prepareOffer:"Prparer l'Offre",directRival:"Rival direct",transferToClub:"Transfert au club",clubAccepts:"Club accepte",annualSalary:"Salaire annuel",minEstimated:"Minimum estim: {{amount}}/an",contractDuration:"Dure du contrat",playerAccepts:"Joueur accepte",totalTransferCost:"Cot total transfert",totalContractCost:"Cot total contrat",totalInvestment:"Investissement total",sendOffer:"Envoyer l'offre",offerHint:"La rponse arrivera aprs simulation d'un match. Le montant est rserv sur votre budget.",freeAgentNegotiation:"Ngociation Agent Libre",preContractSection:"Pr-contrat",acceptedPlayerStatus:"Accept",rejectedPlayerStatus:"Refus",counterOfferStatus:"Contre-offre",freeAgentInfo:"Pas de ngociation avec un club. Ngociez directement avec le joueur en offrant une prime de signature et un salaire.",preContractBadge:"PR-CONTRAT",preContractInfo:"Son contrat expire bientt. Vous pouvez ngocier directement sans payer de transfert. Il rejoindra votre quipe  la fin de son contrat.",signingBonus:"Prime de signature",suggested:"Suggr: {{amount}}",totalCostFormatted:"Cot total: {{amount}} ({{years}} an{{plural}})",acceptanceProbability:"Probabilit d'acceptation",playerCounterLabel:"Contre-offre du joueur :",counterTotalCost:"Cot total: {{amount}}",totalCostLabel:"Cot total",presentOffer:"Prsenter l'offre",offerPreContract:"Proposer pr-contrat",playerEvaluating:"Le joueur value votre offre...",noAgreementReached:"Aucun accord n'a t trouv avec le joueur",insufficientSalaryOffer:"L'offre salariale est insuffisante",expectsHigherBonus:"Attend une prime de signature plus leve",teamLevelNotConvincing:"Le niveau de l'quipe ne le convainc pas",overallOfferNotConvincing:"L'offre globale ne le convainc pas",needsMoreMoney:"A besoin de plus d'argent pour compenser le niveau du club",wantsFinancialImprovement:"Demande une amlioration financire pour accepter le changement",freeAgentSigned:"Agent libre recrut",preContractSigned:"Pr-contrat sign",playerJoined:"{{name}} est un nouveau joueur. Prime: {{bonus}}, Salaire: {{salary}}/an",offerSentTitle:"Offre envoye",offerSentContent:"Offre pour {{name}} ({{team}}): {{amount}} + {{salary}}/an",playerRejectedDefinitely:"Le joueur a dfinitivement refus",loanNotPossible:"Prt impossible",cannotLoan:"Impossible de prter",insufficientForLoanFee:"Vous avez besoin de {{amount}} pour les frais de prt",insufficientBudgetTitle:"Budget insuffisant",cannotExecute:"Impossible d'excuter",noLoanPurchaseOption:"Ce prt n'a pas d'option d'achat",insufficientBudgetShort:"Budget insuffisant",europeTab:"Europe",continentalTab:"Continental",accepted:"Accepte",age:"ge",contract:"Contrat",difficulty:"Difficult",freeAgentsOnly:"Joueurs libres uniquement",history:"Historique",level:"Nv.",loanBadge:"Prt",loanSuccess:"PRT !",negotiating:"Ngociation...",noOffersReceived:"Aucune offre reue",noSentOffers:"Aucune offre ni prt",noSentOffersDesc:"Vous n'avez aucune offre active ni prt. Cherchez des joueurs !",persProfessional:"Professionnel",playerValue:"Valeur",posAll:"Toutes",posDEF:"Dfenseur",posFWD:"Attaquant",posGK:"Gardien",positionToSearch:"Position  chercher",posMID:"Milieu",preseasonMsg:"C'est la pr-saison. Recrutez avant le dbut de la ligue !",purchaseOptionLabel:"Option d'achat",recentTransfers:"Derniers Transferts",responseAfterMatch:"La rponse arrivera aprs la simulation d'un match.",searchPlaceholder:"Rechercher un joueur...",season:"Saison",signingFailed:"TRANSFERT CHOU",signingSuccess:"TRANSFERT !",tickerMsg:"March des transferts actif",transferBadge:"Transfert",transferCompleted:"Transfert russi !",value:"valeur",wantsHigherBonus:"Attend une prime plus leve",year:"an",years:"ans",veryEasy:"Trs Facile",easy:"Facile",normal:"Normal",hard:"Difficile",veryHard:"Trs Difficile",almostImpossible:"Quasi Impossible",persAmbitious:"Ambitieux",persLoyal:"Loyal",persMercenary:"Mercenaire",persHomesick:"Familial",persAdventurous:"Aventurier",persDescAmbitious:"Veut jouer dans les meilleurs clubs",persDescLoyal:"Trs difficile qu'il quitte son club",persDescMercenary:"Seul l'argent compte",persDescHomesick:"Prfre rester prs de chez lui",persDescProfessional:"value tout avec quilibre",persDescAdventurous:"Aime changer d'air"},V_e={title:"Calendrier",fixtures:"Matchs",results:"Rsultats",matchday:"Journe",date:"Date",time:"Heure",home:"Domicile",away:"Extrieur",score:"Score",competition:"Comptition",venue:"Stade",european:"Europenne",southAmerican:"Sud-Amricaine",cup:"Coupe",week:"Semaine",noEuropeanMatches:"Aucun match europen cette journe",noSouthAmericanMatches:"Aucun match sud-amricain cette journe",noCupMatches:"Aucun match de coupe ce tour"},z_e={title:"Jour de Match",kickoff:"Coup d'Envoi",fulltime:"Temps Complet",halftime:"Mi-temps",goal:"But!",assist:"Passe Dcisive",yellowCard:"Carton Jaune",redCard:"Carton Rouge",substitution:"Remplacement",injury:"Blessure",minute:"Min",attendance:"Affluence",possession:"Possession",shots:"Tirs",shotsOnTarget:"Tirs Cadrs",corners:"Corners",fouls:"Fautes",offsides:"Hors-jeu",golazo:"QUEL BUT!",lateGoal:"But dans les arrts de jeu!",finalResult:"Rsultat Final",skipToEnd:"Aller  la fin",noMatchThisWeek:"Pas de match cette semaine"},G_e={title:"Classement",position:"Pos",team:"quipe",played:"J",won:"G",drawn:"N",lost:"P",goalsFor:"BP",goalsAgainst:"BC",goalDifference:"DB",points:"Pts",form:"Forme",next:"Suivant",last5:"5 Derniers",champion:"Champion",championQualification:"Qualification Champions",europaQualification:"Qualification Europa",conferenceQualification:"Qualification Conference",relegation:"Relgation",playoff:"Barrage",championsLeague:"Ligue des Champions",libertadores:"Copa Libertadores",europaLeague:"Ligue Europa",sudamericana:"Copa Sudamericana",conferenceLeague:"Ligue Confrence",promotion:"Monte directe",playoffPromotion:"Barrage de monte",apertura:"Apertura",clausura:"Clausura",acumulada:"Cumul",inProgress:"en cours",searchLeague:"Rechercher ligue...",yourLeague:"Votre ligue",noData:"Pas de donnes disponibles pour cette ligue.",noDataHint:"Les donnes seront gnres au fur et  mesure de la saison.",group:"Groupe",championLabel:"Champion",firstLeg:"Aller",secondLeg:"Retour",bothTournamentsChampion:"champion des deux tournois",formW:"V",formD:"N",formL:"D",showAllTeams:"Voir toutes les quipes ({{count}})",showLess:"Voir moins",countries:{spain:"Espagne",england:"Angleterre",italy:"Italie",germany:"Allemagne",france:"France",restOfEurope:"Reste de l'Europe",southAmerica:"Amrique du Sud"}},q_e={title:"Finances",income:"Revenus",expenses:"Dpenses",balance:"Solde",profit:"Bnfice",loss:"Perte",ticketSales:"Ventes de Billets",transfers:"Transferts",sponsorship:"Sponsoring",merchandise:"Merchandising",salaries:"Salaires",maintenance:"Maintenance",other:"Autres",bank:"Banque",currentBudget:"Budget actuel",currentSeason:"Saison Actuelle",seasonTickets:"Abonns (encaissement fin saison)",pending:"en attente",noCampaignClosed:"Aucune campagne ferme",ticketsSold:"Billets vendus",accumulatedMatches:"Matchs jous accumuls",stadiumNaming:"Naming du stade",playerSales:"Ventes de joueurs",prizesRewards:"Prix et rcompenses",squadSalaries:"Salaires quipe (fin saison)",stadiumMaintenance:"Maintenance du stade",signings:"Recrues",seasonBalance:"Bilan saison"},H_e={title:"Installations",subtitle:"Amliorez votre club pour rivaliser au plus haut niveau",training:"Entranement",youth:"Formation",medical:{infirmary:"Infirmerie",doctors:"Mdecins",available:"disponibles",heals:"Soigne",weeks:"semaines",weeksShort:"sem",weeksSingular:"e",weeksPlural:"es",cost:"Cot",noInjured:"Aucun joueur bless",inTreatment:"En traitement",noMedicalCenter:"Pas de centre mdical",noDoctorsAvailable:"Aucun mdecin disponible",reduceTo:"Rduire "},level:"Niveau",upgrade:"Amliorer",upgraded:"amlior",cost:"Cot",benefit:"Avantage",upgrading:"Amlioration",completed:"Termin",incomePerSeason:"Revenus/saison",nextLevel:"Niveau suivant",maxLevel:"Niveau Max",specialization:"Spcialisation",notChosen:"Non choisi",choose:"Choisir",chooseSpecDesc:"Choisissez la spcialisation (sera verrouille jusqu' la saison prochaine)",ignore:"Ignorer",categories:{income:"Revenus",development:"Dveloppement",support:"Support"},stadium:{name:"Stade",description:"Capacit et avantage  domicile"},impact:{title:"Impact de vos installations",youth:"Jeunes joueurs",treatments:"Traitements",weeksSaved:"Semaines conomises"},facilityNames:{stadium:"Stade",sponsorship:"Commercial",youth:"Centre de Formation",medical:"Centre Mdical",scouting:"Recrutement"},facilityDescs:{stadium:"Capacit et avantage  domicile",sponsorship:"Revenus de sponsoring",youth:"Gnre de jeunes talents",medical:"Rduit le temps de blessure",scouting:"Rduit les cots de transfert"},levelNames:{municipal:"Municipal",modern:"Moderne",large:"Grand",elite:"lite",legendary:"Lgendaire",basic:"Basique",active:"Actif",professional:"Professionnel",premium:"Premium",developed:"Dvelopp",advanced:"Avanc",improved:"Amlior",local:"Local",national:"National",european:"Europen",worldwide:"Mondial"},benefits:{seats:"{{count}} places",youthPlayer:"1 jeune/saison ({{range}})",standardRecovery:"Rcupration standard",injuryReduction:"-{{percent}}% blessures  {{treatments}} traitement(s)",noTransferAdvantage:"Pas d'avantage de transfert",transferDiscount:"-{{percent}}% cot de transfert"}},W_e={title:"Stade",capacity:"Capacit",expand:"Agrandir",maintenance:"Maintenance",condition:"tat",excellent:"Excellent",good:"Bon",poor:"Mauvais",terrible:"Terrible",view3dNotAvailable:"Vue 3D non disponible",loadingStadium:"Chargement du stade...",general:"Gnral",sponsorship:"Sponsoring",events:{friendly:"Match Amical",concert:"Concert",corporate:"vnement d'Entreprise",legends:"Match des Lgendes"},seasonTicketCampaign:"Campagne d'Abonnements",campaignOpen:"Campagne ouverte jusqu' la journe {{deadline}} (actuelle: {{current}})",seasonTicketPrice:"Prix de l'abonnement:",pricePerMatch:"{{matches}} matchs ? {{pricePerMatch}}/match",expectedSubscribers:"Abonns prvus:",maxShort:"max",closeCampaign:"Fermer la campagne et fixer les abonns",campaignClosed:"Campagne ferme",subscribers:"abonns",pricePerTicket:"prix/billet",collected:"encaiss",ofCapacitySubscribed:"{{percent}}% de la capacit abonne",ticketPrice:"Prix du Billet",priceLocked:"Prix fix pour cette saison. Uniquement pour les non-abonns.",setPriceBeforeLeague:"Prix par match pour les non-abonns.  fixer avant le dbut du championnat.",accumulatedTicketIncome:"Revenus billetterie accumuls",onlyTicketsSold:"Seulement les billets vendus (sans les abonns). Encaiss en fin de saison.",lastHomeMatchday:"Dernire journe  domicile",ticketsSold:"Billets vendus",totalAttendance:"Assistance totale",ticketIncome:"Revenus billetterie",grassCondition:"tat de la Pelouse",optimal:"Optimal",injuryRisk:"Risque blessures +{{percent}}%",recovers:"Rcupre +5%/semaine",perfectCondition:"En parfait tat",poorGrassWarning:"Le mauvais tat augmente les blessures de VOS joueurs",repairGrass:"Rparer la pelouse ({{cost}})",currentSponsor:"Sponsor Actuel",yearsRemaining:"{{years}} annes restantes",cancelContract:"Annuler le contrat",penalty:"Pnalit: {{amount}}",namingOffers:"Offres de Naming",sellStadiumName:"Vendez le nom du stade pour des revenus annuels",upgradeForSponsors:"Amliorez votre stade pour attirer des sponsors",organizeEvents:"Organiser des vnements",generateExtraIncome:"Gnrer des revenus supplmentaires (ncessite 2 semaines entre les vnements)",waitMoreWeeks:"Attendez {{weeks}} semaine(s) de plus",grassDamage:"Dgts pelouse: -{{percent}}%",organize:"Organiser",repairGrassBeforeEvents:"Rparez la pelouse avant d'organiser des vnements",homeAdvantage:"Avantage  domicile",occupation:"Occupation",grass:"Pelouse",budget:"Budget",stadium:"Stade",accept:"Accepter",perYear:"/an",years:"annes",seasonTicketsClosed:"Campagne d'abonnements ferme",seasonTicketsMessage:"{{count}} abonns  {{price}} = {{total}} (sera encaiss en fin de saison)",namingRights:"Droits de Naming",namingMessage:"Accord avec {{sponsor}}: {{amount}}M/an pour {{duration}} annes",sponsorshipCancelled:"Sponsoring annul",stadiumNameRestored:"Le stade retrouve son nom d'origine. Pnalit paye: {{amount}}M",stadiumNameRestoredFree:"Le stade retrouve son nom d'origine",eventHosted:"vnement organis. Revenus: {{amount}}K",stadiumUpgraded:"Stade agrandi",nowStadium:"Maintenant c'est {{name}} avec {{capacity}} places",seats:"places",insufficientFunds:"Fonds insuffisants",penaltyRequired:"Vous avez besoin de {{amount}}M pour payer la pnalit d'annulation du contrat."},$_e={title:"Entranement",fitness:"Condition Physique",tactics:"Tactique",technical:"Technique",intensity:"Intensit",low:"Faible",medium:"Moyenne",high:"leve"},K_e={title:"Options",language:"Langue",graphics:"Graphiques",sound:"Son",gameplay:"Gameplay",difficulty:"Difficult",easy:"Facile",normal:"Normal",hard:"Difficile",animations:"Animations",notifications:"Notifications",autosave:"Sauvegarde Automatique",general:"Gnral",autosaveLabel:"Sauvegarde automatique",autosaveDesc:"Sauvegarde automatiquement toutes les 5 minutes",volume:"Volume",music:"Musique",effects:"Effets",gameData:"Donnes de Partie",saveAndExit:"Sauvegarder et sortir",deleteAndReset:"Supprimer donnes et redmarrer",deleteConfirm:"Supprimer toutes les donnes ?",deleteMessage:"Cette action supprimera votre partie sauvegarde et ne peut pas tre annule.",appTitle:"PC Gaffer",appVersion:"Version 1.0.0",appTribute:"L'art du management",difficultyEasyDesc:"IA moins agressive, plus d'argent initial",difficultyNormalDesc:"Exprience quilibre",difficultyHardDesc:"IA trs comptitive, moins de ressources",speedSlow:"Lent",speedSlowDesc:"Plus de temps pour regarder les matchs",speedNormalDesc:"Vitesse standard",speedFast:"Rapide",speedFastDesc:"Matchs plus courts",yesDeleteAll:"Oui, tout supprimer"},Y_e={office:"Bureau",formation:"Formation",squad:"Effectif",transfers:"Transferts",calendar:"Calendrier",table:"Classement",finance:"Finances",stadium:"Stade",facilities:"Installations",training:"Entranement",objectives:"Objectifs",competitions:"Comptitions",messages:"Messages",bank:"Banque",options:"Options",mainMenu:"Menu Principal"},X_e={teamsAvailable:"{{count}} quipes disponibles",comingSoon:"Prochainement",groupsAndTeams:"{{groups}} groupes  {{teams}} quipes",teamsCount:"{{count}} quipe{{count, plural, one {} other {s}}}",selectGroup:"Slectionnez un groupe",searchTeam:"Rechercher une quipe...",stadium:"Stade",municipal:"Municipal",capacity:"Capacit",reputation:"Rputation",presentation:"Prsentation",startSeason:"Commencer la Saison"},Q_e={title:"Mode Course Contre la Montre",setup:"Configuration",start:"Commencer",objective:"Objectif: Atteindre la Champions League depuis le bas",rules:"Rgles",progress:"Progrs",timeElapsed:"Temps coul",seasonsPlayed:"Saisons Joues",currentLeague:"Championnat Actuel",trophies:"Trophes",completed:"Termin!",failed:"chou",activated:"Course contre la montre active !",objectiveMessage:"Objectif : remporter la {{competition}} avec {{team}} en un minimum de saisons. Le chrono tourne !",southAmericanCup:"South American Champions Cup",continentalCup:"Continental Champions Cup"},J_e={title:"Fin de Saison",summary:"Rsum",achievements:"Ralisations",statistics:"Statistiques",topScorer:"Meilleur Buteur",bestPlayer:"Meilleur Joueur",nextSeason:"Prochaine Saison",finalTitle:"Finale",league:"Ligue",aperturaVsClausura:"Apertura vs Clausura",firstLeg:"Aller",secondLeg:"Retour",result:"Rsultat",byAggregate:"au score total",byAwayGoals:"aux buts  l'extrieur",byClausuraAdvantage:"par avantage sportif (champion du Clausura)",sameChampion:"champion des deux tournois",playoffAscenso:"Barrage de Monte",semifinals:"Demi-finales",final:"FINALE!",victory:"Victoire!",defeat:"Dfaite",extraTime:"Prolongations",penalties:"Tirs au But",champion:"CHAMPION!",runner:"Finaliste",promotion:"MONTE!",relegation:"Relgation",eliminated:"L'quipe a t limine du barrage",ascends:"MONTE EN PREMIRE DIVISION!",playoffCompleted:"Barrage termin",playoffWinner:"Vainqueur du barrage",seasonSummary:"Rsum de saison",finalPosition:"Position Finale",points:"Points",wins:"Victoires",draws:"Nuls",losses:"Dfaites",goalDifference:"Diff. Buts",qualifiedFor:"Qualifi pour",qualificationBonus:"Bonus de qualification",objectives:"Objectifs",objectiveBalance:"Bilan des objectifs",europeanBonus:"Bonus europen",continue:"Continuer",playMatch:"Jouer le match",nextMatch:"Prochain match",homeGame:"Nous jouons  domicile",awayGame:"Nous jouons  l'extrieur"},Z_e={title:"Objectifs",current:"Actuels",completed:"Termins",failed:"chous",primary:"Primaire",secondary:"Secondaire",bonus:"Bonus",leaguePosition:"Position au Classement",cupProgress:"Progrs en Coupe",budget:"Budget",youngPlayers:"Jeunes Joueurs",critical:"Critique",high:"Principal",medium:"Secondaire",low:"Optionnel",objective:"Objectif",onTrack:"En bonne voie",atRisk:" risque",danger:"Danger",pending:"En attente",goalDifference:"Diff. buts",objectivesAtRisk:"objectif{{ count === 1 ? '' : 's' }}",atRiskWarning:" risque. Rvisez votre stratgie pour viter les pnalits.",all:"Tous",inProgress:"En cours",criticalObjectives:"Objectifs Critiques",seasonObjectives:"Objectifs de Saison",noObjectives:"Pas d'objectifs dfinis",objectivesWillGenerate:"Les objectifs de saison seront gnrs au dbut de la ligue.",boardExpects:"La direction attend"},exe={championsQualification:"Qualification en Champions",europeanQualification:"Qualification europenne",topHalf:"Premire moiti de classement",avoidRelegation:"viter la relgation",promotion:"Promotion",titleContender:"Lutter pour le titre",goalDifference:"Diffrence de buts positive",financialStability:"Stabilit financire",youthDevelopment:"Dveloppement des jeunes"},txe={championsQualification:"Terminer dans les 4 premiers pour se qualifier en Continental Champions Cup",europeanQualification:"Terminer dans les 6 premiers pour se qualifier en comptition europenne",topHalf:"Terminer dans la premire moiti du classement",avoidRelegation:"Se maintenir en terminant hors de la zone de relgation",promotion:"Obtenir la promotion en division suprieure",titleContender:"Terminer dans les 2 premiers",goalDifference:"Terminer la saison avec plus de buts marqus que encaisss",financialStability:"Ne pas terminer la saison dans le rouge",youthDevelopment:"Donner du temps de jeu aux jeunes du centre de formation"},nxe={title:"Messages",inbox:"Bote de rception",unread:"Non Lus",all:"Tous",transfers:"Transferts",injuries:"Blessures",contracts:"Contrats",objectives:"Objectifs",markAsRead:"Marquer comme Lu",deleteAll:"Tout supprimer",deleteAllConfirm:"Supprimer tous les messages ?",noMessages:"Vous n'avez pas de messages",backToMessages:"Retour aux messages",deleteMessage:"Supprimer le message"},axe={title:"Renouvellements",contractExpiring:"Contrat Expire",wantsToRenew:"Veut Renouveler",rejectRenewal:"Rejette le Renouvellement",demandIncrease:"Demande une Augmentation",offer:"Offre",playerDemands:"Exigences du Joueur",currentContract:"Contrat Actuel",newContract:"Nouveau Contrat"},ixe={title:"Comptitions",domestic:"Domestiques",european:"Europennes",international:"Internationales",league:"Championnat",cup:"Coupe",champions:"Ligue des Champions",europa:"Ligue Europa",conference:"Conference League",europeTab:"Europe",continentalTab:"Continental",europe:"Europe",continental:"Continental"},sxe={title:"Classement",contrarreloj:"Course Contre la Montre",position:"Position",manager:"Entraneur",team:"quipe",time:"Temps",trophies:"Trophes",noRecords:"Aucun record pour l'instant",records:"RECORDS",subtitle:"Mode Course Contre la Montre  Meilleurs Temps",clear:"Effacer",confirmClear:"Supprimer tous les records ? Cette action ne peut pas tre annule.",loading:"Chargement du classement...",noRecordsDesc:"Terminez le mode Course Contre la Montre pour apparatre dans le classement.",playContrarreloj:"Jouer Course Contre la Montre",player:"Joueur",score:"Score",seasons:"Saisons",competition:"Comptition",date:"Date"},rxe={title:"Notifications",clear:"Effacer",settings:"Paramtres",matchResult:"Rsultat du Match",transfer:"Transfert",injury:"Blessure",contract:"Contrat",objective:"Objectif"},oxe={POR:"GAR",DFC:"DC",LD:"DD",LI:"DG",CRD:"PDD",CRI:"PDG",MCD:"MDC",MC:"MC",MCO:"MOC",MD:"MD",MI:"MG",ED:"AD",EI:"AG",DC:"AV",SD:"BU"},lxe={goalkeeper:"Gardien",defender:"Dfenseur",midfielder:"Milieu",forward:"Attaquant",gkShort:"GAR",defShort:"DF",midShort:"MIL",fwdShort:"ATT",backToSquad:"Retour  l'effectif",injuredWeeks:"Bless  {{weeks}} semaine(s) d'absence",speed:"Vitesse",technique:"Technique",passing:"Passe",shooting:"Tir",defense:"Dfense",physical:"Physique",number:"Numro",myTeam:"Mon quipe",average:"Moyenne"},cxe={back:"Retour",loadGame:"Charger Partie",saveGame:"Sauvegarder Partie",manageGames:"Grer Parties",selectOrCreate:"Slectionnez une partie sauvegarde ou crez-en une nouvelle",chooseSlot:"Choisissez un emplacement pour sauvegarder votre progression",manageSlots:"Grez vos parties sauvegardes",slot:"Emplacement",emptySlot:"Emplacement vide",newGame:"Nouvelle Partie",saving:"Sauvegarde...",saveHere:"Sauvegarder ici",unknownTeam:"quipe inconnue",loading:"Chargement...",load:"Charger",overwrite:"craser ?",deleteGame:"Supprimer partie ?",loadingGames:"Chargement des parties...",never:"Jamais",errorLoadGames:"Erreur lors du chargement des parties",errorLoadGame:"Erreur lors du chargement de la partie",errorSaveGame:"Erreur lors de la sauvegarde",errorDeleteGame:"Erreur lors de la suppression"},uxe={menu:"Menu",title:"COURSE CONTRE LA MONTRE",subtitle:"Pouvez-vous atteindre le sommet du football europen/sud-amricain ?",objective:"Objectif",winChampions:"Gagner la Champions League ou la Copa Libertadores",losesIf:"Vous perdez si",fired:"Vous tes renvoy ou votre budget devient ngatif",ranking:"Classement",fewestSeasons:"Le moins de saisons possibles gagne",chooseChallenge:"Choisissez votre dfi",newTeams:"Nouvelles quipes",ovr:"GN",goal:"Objectif :",libertadores:"?? Copa Libertadores",championsLeague:"?? Champions League",starting:"Dmarrage...",acceptChallenge:"ACCEPTER LE DFI !"},dxe={home:"Accueil",competitions:"Compt.",more:"Plus",advance:"Avancer",menu:"Menu"},hxe={title:"RENVOY",defaultReason:"Le conseil d'administration a dcid de vous relever de vos fonctions d'entraneur.",balance:"Bilan",confidence:"Confiance du conseil",backToMenu:"Retour au Menu Principal",bankruptReason:"La direction vous a licenci pour avoir men le club  la faillite."},fxe={accountCreated:"Compte cr ! Vrifiez votre email pour activer votre compte.",passwordResetSent:"Email de rcupration envoy. Vrifiez votre bote de rception.",verificationResent:"Email de vrification renvoy",emailNotVerified:"Email pas encore vrifi. Vrifiez votre bote de rception.",verifyEmail:"Vrifiez votre email",verificationSent:"Nous avons envoy un email de vrification  :",clickLinkToActivate:"Cliquez sur le lien dans l'email pour activer votre compte.",checking:"Vrification...",alreadyVerified:"Je l'ai dj vrifi",resendEmail:"Renvoyer l'email",login:"Se connecter",createAccount:"Crer un compte",resetPassword:"Rinitialiser le mot de passe",continueWithGoogle:"Continuer avec Google",enterAsGuest:"Entrer en tant qu'invit (Tests)",orUseEmail:"ou utilisez votre email",username:"Nom d'utilisateur",usernamePlaceholder:"Votre nom dans le jeu",email:"Email",emailPlaceholder:"votre@email.com",password:"Mot de passe",enter:"Entrer",sendEmail:"Envoyer l'email",forgotPassword:"Mot de passe oubli ?",noAccount:"Pas de compte ? Inscrivez-vous",haveAccount:"Dj un compte ? Connectez-vous",backToLogin:"Retour  la connexion",enterUsername:"Entrez un nom d'utilisateur"},pxe={title:"Comptitions Europennes",notQualified:"Vous n'tes pas qualifi pour les comptitions europennes cette saison.",qualificationHint:"Finissez dans les premires positions de votre ligue pour vous qualifier.",selectCompetition:"Slectionnez une comptition",prizes:"Prix: {{amount}}",eliminated:"limin",standings:"Classement  Phase de Ligue",matchday:"Journe {{current}}/{{total}}",knockoutPhase:"Phase liminatoire  {{phase}}",championTitle:"{{competition}}  Champion !",finalScore:"Finale: {{score}}",recentResults:"Rsultats Rcents",pendingDraw:"En attente du tirage...",aggregate:"Agg: {{score}}",phases:{league:"Phase de Ligue",playoff:"Barrages",r16:"Huitimes de Finale",qf:"Quarts de Finale",sf:"Demi-Finales",final:"Finale",completed:"Comptition Termine",r16Short:"Huitimes",qfShort:"Quarts",sfShort:"Demi-Finales"},legend:{directQualification:"1-8: Direct en huitimes",playoff:"9-24: Barrages",eliminated:"25-32: limin"}},mxe={title:"Comptitions Sud-Amricaines",notQualified:"Vous n'tes pas qualifi pour les comptitions continentales cette saison.",qualificationHint:"Finissez dans les premires positions de votre ligue pour vous qualifier."},gxe={challengeStart:"Dbut du dfi",seasonPosition:"Saison {{season}}  {{position}} sur {{total}}",promotion:"Promotion !",promotionDetail:"De {{from}}  {{to}}",relegation:"Relgation",relegationDetail:"De {{from}}  {{to}}",continentalCompetition:"Comptition continentale",phaseReached:"Phase atteinte: {{phase}}",trophyWon:"?? {{trophy}}",seasonLabel:"Saison {{season}}",currentSeason:"Saison {{season}}  EN COURS",currentPosition:"{{position}} sur {{total}}",noClassification:"Pas de classement",copaLibertadores:"Copa Libertadores",championsLeague:"Ligue des Champions",winGoal:"?? Remporter la {{competition}}",accomplished:"ACCOMPLI !",howManySeasonsQuestion:"Combien de saisons vous faudra-t-il ?",roadToGlory:"Route vers la Gloire",startingFrom:"en partant de",currentLeague:"Ligue actuelle",positionOf:"sur {{total}}",position:"Position",trophies:"Trophes",timeline:"Chronologie"},Axe={weekDate:"Semaine {{week}}",preseason:"Pr-saison",endOfSeason:"Fin Saison {{season}}",newOfferReceived:" Nouvelle offre reue",offerForListedPlayer:" Offre pour joueur en vente",offerExpired:" Offre expire",offerCancelled:" Offre annule : {{player}}",transferConfirmed:" Transfert confirm",transferComplete:" Transfert complt",newYouthPlayer:" Nouveau jeune",loanOfferReceived:" Offre de prt reue",leagueChampion:" Champion de Ligue !",playerReceivedOnLoan:" Joueur reu en prt",purchaseOptionExecuted:" Option d'achat excute",loanAccepted:" Prt accept",loan:"Prt",treatmentApplied:" Traitement appliqu",playerRetiredTitle:"Retraite : {{player}}",aperturaClausuraFinal:" Finale Apertura vs Clausura",cupChampionTitle:"{{icon}} CHAMPION DE LA {{cup}} !!",offerContent:"{{buyer}} offre {{amount}} pour {{player}}",transferConfirmedContent:"{{player}} ({{position}}, {{overall}}) signe pour {{toTeam}} depuis {{fromTeam}} pour {{price}}",youthPlayerContent:"Le centre de formation ({{spec}}) a promu {{player}} ({{position}}, {{overall}} OVR, {{age}} ans)",playerRetired:"{{player}} ({{position}}, {{overall}} OVR) prend sa retraite du football professionnel",offerExpiredContent:"L'offre de {{team}} pour {{player}} a expir",playerUnavailableRefund:"{{player}} n'est plus disponible. {{amount}} rembourss",loanOfferContent:"{{team}} veut {{player}} en prt. Frais : {{fee}}",directChampion:"{{team}} remporte l'Apertura et la Clausura et est champion direct de la {{league}}.",aperturaClausuraFinalContent:"Votre quipe jouera la finale de la {{league}} ! {{apertura}} (Apertura) vs {{clausura}} (Clausura).",transferCompleteContent:"{{player}} est un nouveau membre de l'quipe ! Cot : {{cost}}",transferCompleteCounterContent:"{{player}} est un nouveau membre ! Contre-offre accepte : {{cost}}",medicalTreatment:"{{player}} a reu un traitement. Blessure rduite de {{oldWeeks}}  {{newWeeks}} semaines. Cot : {{cost}}",cupChampionContent:"{{team}} a remport la {{cup}} !",playerReceivedOnLoanContent:"{{player}} arrive en prt de {{team}}. Frais : {{fee}}{{option}}",purchaseOptionContent:"{{player}} sign dfinitivement pour {{amount}}",startOfSeason:"Dbut Saison {{season}}",newYouthPlayerSon:" Nouveau jeune : {{player}}",youthSonContent:"Fils de {{parent}}  {{position}}, {{overall}} OVR, potentiel {{potential}}",offerExpiredPlayer:" Offre expire : {{player}}",offerExpiredRefund:"Votre offre pour {{player}} a expir sans rponse. {{amount}} rembourss",offerResponse:"{{icon}} Rponse : {{player}}",offerRejectedContent:" Club : {{clubReason}}   Joueur : {{playerReason}}",counterOfferExpired:" Contre-offre expire : {{player}}",counterOfferExpiredContent:"La contre-offre pour {{player}} a expir. {{amount}} rembourss",saleComplete:" Vente finalise",saleCompleteContent:"Vous avez vendu {{player}}  {{team}} pour {{amount}}",counterOfferAccepted:" Contre-offre accepte",counterOfferAcceptedContent:"{{team}} accepte de payer {{amount}} pour {{player}}",counterOfferRejected:" Contre-offre refuse",counterOfferRejectedContent:"{{team}} refuse votre contre-offre de {{amount}} pour {{player}}",europeanIncome:"{{icon}} Revenus europens",continentalIncome:"{{icon}} Revenus continentaux",prizeMoneyContent:"{{competition}} : +{{amount}}",cupByeTitle:"{{icon}} {{cup}}",cupByeContent:"Votre quipe passe directement au tour suivant (exempt)",cupFinishedTitle:"{{icon}} {{cup}} termine !",cupWonContent:"Votre quipe a remport la {{cup}} !",cupWonByOther:"La {{cup}} a t remporte par {{winner}}",cupMatchResult:"{{icon}} {{cup}} : {{team}} {{playerScore}} - {{rivalScore}} {{rival}}",cupAdvance:"Qualifi pour le tour suivant !",cupEliminated:"limin de la coupe",playerLoaned:" Joueur prt",playerLoanedContent:"{{player}} prt  {{team}}. Frais : {{fee}}{{option}}",aperturaClausuraFinalResult:" Finale Apertura vs Clausura",aperturaClausuraFinalResultContent:"{{winner}} remporte la finale de la {{league}}. Aller : {{leg1Home}}-{{leg1Away}}, Retour : {{leg2Home}}-{{leg2Away}}.",directChampionShort:"{{winner}} est champion direct."},yxe={common:D_e,mainMenu:k_e,cup:O_e,office:F_e,formation:j_e,plantilla:B_e,transfers:U_e,calendar:V_e,matchday:z_e,leagueTable:G_e,finance:q_e,facilities:H_e,stadium:W_e,training:$_e,settings:K_e,sidebar:Y_e,teamSelection:X_e,contrarreloj:Q_e,seasonEnd:J_e,objectives:Z_e,objNames:exe,objDescs:txe,messages:nxe,renewals:axe,competitions:ixe,ranking:sxe,notifications:rxe,positions:oxe,squad:lxe,saveSlots:cxe,contrarrelojSetup:uxe,mobileNav:dxe,managerFired:hxe,auth:fxe,europe:pxe,southAmerica:mxe,contrarrelojProgress:gxe,gameMessages:Axe},vxe={save:"Speichern",cancel:"Abbrechen",confirm:"Besttigen",accept:"Akzeptieren",close:"Schlieen",back:"Zurck",continue:"Weiter",yes:"Ja",no:"Nein",loading:"Ldt...",error:"Fehler",warning:"Warnung",success:"Erfolg",next:"Weiter",previous:"Zurck",edit:"Bearbeiten",delete:"Lschen",add:"Hinzufgen",remove:"Entfernen",select:"Auswhlen",search:"Suchen",filter:"Filtern",all:"Alle",none:"Keine",name:"Name",age:"Alter",position:"Position",value:"Wert",salary:"Gehalt",contract:"Vertrag",team:"Team",league:"Liga",season:"Saison",week:"Woche",day:"Tag",month:"Monat",year:"Jahr",money:"Geld",budget:"Budget",unknown:"Unbekannt"},_xe={title:"PC GAFFER",subtitle:"",season:"",continueGame:"Spiel Fortsetzen",play:"Spielen",login:"Anmelden",logout:"Abmelden",loggingOut:"Abmeldung...",saveGame:"Spiel Speichern",contrarreloj:"Zeitrennen",records:"Rekorde",options:"Optionen",loadOrCreate:"Spiel laden oder neues erstellen",saveProgress:"Fortschritt in der Cloud speichern",saveCurrentProgress:"Aktuellen Fortschritt speichern",reachChampions:"Champions League von unten erreichen",guestNotice:"Melden Sie sich an, um Ihren Fortschritt in der Cloud zu speichern",tribute:"Das schne Spiel, von dir geleitet",contrarrelojActive:"Zeitrennen Aktiv",newGame:"Neues Spiel",deleteWarning:"?? Ein neues Spiel zu starten wird den aktuellen Fortschritt lschen",playButton:"Spielen",loginButton:"Anmelden",saveCurrentGame:"Spiel speichern",recordsButton:"Rekorde",optionsButton:"Optionen"},xxe={noCupActive:"Kein Pokal aktiv diese Saison",cup:"Pokal",season:"Saison",champion:"Meister!",cupFinished:"Pokal beendet",eliminatedIn:"Ausgeschieden in",round:"Runde",inCompetition:"Im Wettbewerb",nextRound:"Nchste Runde",matches:"Spiele",exempt:"freigestellt",current:"Aktuell"},bxe={title:"Bro",overview:"bersicht",simulate:"Simulieren",simulateWeek:"Woche Simulieren",simulateSeason:"Saison Simulieren",simulateToWindow:"Bis Transferfenster Simulieren",simulating:"Simuliert...",seasonInfo:"Saison {{season}}",weekInfo:"Woche {{week}}",changeManagerName:"Managername (erscheint im Ranking):",clickToChangeName:"Klicken um Namen zu ndern",budget:"Budget",teamValue:"Teamwert",stadiumCapacity:"Stadionkapazitt",facilities:"Anlagen",objectives:"Ziele",nextMatch:"Nchstes Spiel",vs:"VS",home:"Heim",away:"Auswrts",injuredWarning:"Verletzte Spieler in der Aufstellung",playersInjured:"Sie haben {{count}} verletzten Spieler in Ihrer Startaufstellung",stillPlay:"Mchten Sie trotzdem mit dem Spiel fortfahren?",checkFormation:"Gehen Sie zur Aufstellung und ersetzen Sie die verletzten Spieler, bevor Sie fortfahren.",welcome:"Willkommen, Trainer",preseason:"Vorbereitung {{week}}/{{total}}",players:"Spieler",boardConfidence:"Vertrauen der Vereinsfhrung",friendlyMatch:"Freundschaftsspiel {{week}}/5",matchday:"Spieltag {{week}}",lastResults:"Letzte Ergebnisse",form_W:"S",form_D:"U",form_L:"N",noMatches:"Keine Spiele gespielt",mainObjective:"Hauptziel",viewAllObjectives:"Alle Ziele anzeigen",recentMessages:"Neueste Nachrichten",weeksOut:"{{weeks}} Woche{{weeks, plural, one {} other {n}}}",goToFormation:"Zur Aufstellung",threeMatches:"3 Spiele",endOfSeason:"Saisonende",halfSeason:"Halbzeit",winterBanner:"WINTERPAUSE  Spieltag {{current}} von {{total}}",notEnoughPlayers:"Sie haben nicht genug Spieler, um ein Team zu bilden",seasonEnd:"Saisonende",seasonEndedAfterWeeks:"Die Saison ist nach {{weeks}} simulierten Wochen zu Ende gegangen.",simulatedWeeks:"{{weeks}} Wochen simuliert",advancedToWeek:"Sie sind zur Woche {{week}} vorgerckt",insufficientSquad:"Unzureichender Kader!",onlyHavePlayers:"Sie haben nur <strong>{{count}} Spieler</strong>. Sie bentigen mindestens <strong>11</strong> um zu spielen.",goToTransfersWarning:"Gehen Sie zum Transfermarkt und verpflichten Sie Spieler bevor Sie fortfahren. Wenn Sie versuchen erneut zu simulieren ohne 11 Spieler zu haben, <strong>verlieren Sie das Spiel</strong>.",goToTransfers:"Zu Transfers"},Sxe={title:"Aufstellung",lineup:"Startelf",reserves:"Aufgebotene Spieler",notCalled:"Nicht Aufgebotene Spieler",injured:"Verletzt",suspended:"Gesperrt",tactic:"Taktik",formation:"Formation",captain:"Kapitn",freekicks:"Freiste",penalties:"Elfmeter",corners:"Ecken",mentality:"Mentalitt",attacking:"Offensiv",balanced:"Ausgeglichen",defensive:"Defensiv",fitness:"Fitness",morale:"Moral",energy:"Energie",experience:"Erfahrung",makeReserve:"Auf Bank Setzen",makeStarter:"In Startelf",makeNotCalled:"Nicht Aufstellen",callUp:"Aufstellen",setCaptain:"Als Kapitn Setzen",setFreekicks:"Freiste Schieen",setPenalties:"Elfmeter Schieen",setCorners:"Ecken Schieen",years:"Jahre",statistics:"Statistiken",selectPlayer:"Spieler Auswhlen",tacticAndFormation:"Taktik und Formation",parameters:"PARAMETER",rating:"BEWERTUNG",teamAverage:"TEAMDURCHSCHNITT",playingAs:"spielt als",tacDefensive:"Defensiv",tacDefensiveDesc:"Mauertaktik, wenig Chancen",tacDefensiveBonus:"+40% Verteidigung, -40% Angriff",tacDefensiveDetail:"Stark vs Ausgewogen  Schwach vs Ballbesitz und Offensiv",tacBalanced:"Ausgewogen",tacBalancedDesc:"Keine berraschungen, kein Risiko",tacBalancedBonus:"Keine Modifikatoren",tacBalancedDetail:"Keine taktischen Vor- oder Nachteile",tacAttacking:"Offensiv",tacAttackingDesc:"Alles nach vorne, hohes Risiko",tacAttackingBonus:"+35% Angriff, -30% Verteidigung",tacAttackingDetail:"Stark vs Defensiv  Schwach vs Konter und Pressing",tacPossession:"Ballbesitz",tacPossessionDesc:"Ball kontrollieren und ermden",tacPossessionBonus:"+30% Ballbesitz, +10% Verteidigung",tacPossessionDetail:"Stark vs Konter  Schwach vs Hohes Pressing",tacCounter:"Konter",tacCounterDesc:"Ball abgeben, auf Konter lauern",tacCounterBonus:"+20% Angriff, +15% Verteidigung, -25% Ballbesitz",tacCounterDetail:"Stark vs Offensiv und Pressing  Schwach vs Ballbesitz",noInjuredPlayers:"Keine verletzten Spieler",medicalLevel:"Medizinzentrum Level: {{level}}/5",upgradeMedical:"Einrichtungen verbessern fr mehr Behandlungen",statsTeam:"Team",statsSeason:"Saison",statsPlayers:"Spieler",statsTop:"Top",players:"SPIELER",avgOVR:"DURCHSCHN. OVR",avgAge:"DURCHSCHN. ALTER",squadValue:"KADERWERT",matches:"Spiele",wins:"Siege",draws:"Unentschieden",losses:"Niederlagen",goalsFor:"Tore dafr",goalsAgainst:"Gegentore",goalDiff:"Differenz",topRated:"Bestbewertet",mostValuable:"Wertvollste",mostMatches:"Meiste Spiele",noStatsYet:"Noch keine Statistiken - spiele Partien um Daten zu generieren",apply:"Anwenden"},Txe={title:"Kader",players:"Spieler",contracts:"Vertrge",salaries:"Gehlter",totalSalary:"Gesamtgehalt",averageAge:"Durchschnittsalter",squadSize:"Kadergre",putForSale:"Zum Verkauf Stellen",renew:"Verlngern",release:"Freigeben",loan:"Leihen",recall:"Zurckholen",yearsLeft:"Jahre brig",onLoan:"Verliehen",forSale:"Zu Verkaufen",wantToLeave:"Will Wechseln",unhappy:"Unzufrieden",player:"SPIELER",sortBy:"Sortieren nach",expired:"Abgelaufen",oneYear:"{{years}} Jahr",multipleYears:"{{years}} Jahre",budget:"Budget",weeklySalary:"Gehaltskosten",perYear:"/Jahr",perWeek:"/Woche",ofBudget:"des Budgets",playersNeedAttention:"{{count}} Spieler bentigt/en Aufmerksamkeit",retiring:"Tritt zurck",wantsToLeaveAlert:"Will wechseln",more:"+{{count}} weitere",renewPlayer:"{{name}} verlngern",currentContractLabel:"Aktueller Vertrag",demands:"Fordert",budgetImpact:"Budget-Auswirkung:",acceptAndRenew:"Akzeptieren und verlngern",sellPlayer:"{{name}} zum Verkauf stellen",marketValue:"Marktwert",currentSalary:"Aktuelles Gehalt",ifSold:"Bei Verkauf:",savedSalary:"gespart",sellNote:"Der Spieler erscheint auf dem Markt. Andere Teams knnen Angebote machen.",unlistPlayer:"{{name}} vom Verkauf nehmen",unlistQuestion:"Dieser Spieler steht derzeit auf der Transferliste. Mchten Sie ihn vom Markt nehmen?",unlistNote:"Erhlt keine weiteren Angebote von anderen Teams.",confirmUnlist:"Ja, vom Verkauf nehmen",releasePlayer:"{{name}} freigeben",severanceWarning:"Sie mssen die Abfindung fr die verbleibenden {{years}} Vertragsjahr(e) zahlen.",severanceCost:"Zu zahlende Abfindung:",salarySaved:"Sie sparen an Gehltern:",moraleWarning:"Dies kann die Moral der Kabine beeintrchtigen",insufficientFunds:"Nicht genug Geld fr die Abfindung",payAndRelease:"Zahlen und freigeben",onLoanTag:"VERLIEHEN",forSaleTag:"Zu verkaufen",removeFromSale:"Klicken zum Entfernen",renewContract:"Vertrag verlngern",releasePlayerBtn:"Spieler freigeben",loanedBy:"Von {{team}} ausgeliehen  Verkauf oder Freigabe nicht mglich",loanedBadge:"Verliehen",years:"Jahre",total:"gesamt",canRenew:"Kann verlngert werden",cannotRenew:"Spieler braucht keine Verlngerung (mehr als 2 Jahre brig)",playerRetiring:"Spieler hat Rcktritt angekndigt"},wxe={title:"Transfers",explore:"Erkunden",scout:"Scout",search:"Suchen",received:"Erhalten",sent:"Gesendet",offers:"Angebote",market:"Markt",available:"Verfgbar",notForSale:"Nicht zu verkaufen",makeOffer:"Angebot Machen",counterOffer:"Gegenangebot",accept:"Akzeptieren",reject:"Ablehnen",withdraw:"Zurckziehen",negotiate:"Verhandeln",transferFee:"Ablsesumme",salary:"Gehalt",duration:"Dauer",loan:"Leihe",permanent:"Permanent",windowClosed:"Transferfenster Geschlossen",windowOpens:"Fenster ffnet in Woche",windowCloses:"Fenster schliet in Woche",noOffers:"Keine Angebote",scoutingReport:"Scout-Bericht",preseasonOpen:"Vorbereitung  Markt OFFEN",matchdayOpen:"Spieltag {{week}}  Markt OFFEN",marketOpen:"Markt Offen",preseasonMessage:"Es ist Vorbereitung. Nutze die Chance und verpflichte Spieler bevor die Liga startet!",marketAlwaysOpen:"Der Markt ist immer offen. Verpflichte, verleihe und verhandle wann du willst.",totalTransfers:"Transfers Gesamt",moneyMoved:"Geld Bewegt",activeRumors:"Aktive Gerchte",latestTransfers:"Letzte Transfers",noRecentTransfers:"Keine aktuellen Transfers",marketRumors:"Marktgerchte",reliable:"{{pct}}% zuverlssig",noActiveRumors:"Keine aktiven Gerchte",searchPlayerPlaceholder:"Spieler nach Name suchen...",filters:"Filter",position:"Position",allPositions:"Alle",goalkeeper:"Torwart",defender:"Verteidiger",midfielder:"Mittelfeldspieler",forward:"Strmer",ageRange:"Alter: {{min}} - {{max}}",minOvr:"Min OVR: {{value}}",freeOnly:"Nur vereinslose Spieler",free:"FREI",yearsOld:"{{age}} J.",blockedThisSeason:"Diese Saison gesperrt",contractExpiring:"Vertrag luft aus",noReceivedOffers:"Keine erhaltenen Angebote",noInterestYet:"Kein Verein hat Interesse an deinen Spielern gezeigt... bisher.",pendingTransferOffers:"Ausstehende Transferangebote",transfer:"Transfer",pending:"Ausstehend",expiresWeek:"Luft ab Wo. {{week}}",askMore:"Mehr fordern",pendingLoanOffers:"Ausstehende Leihangebote",loanFee:"Leihgebhr",receiverSalary:"Empfngergehalt",purchaseOption:"Kaufoption",historyTitle:"Verlauf",rejected:"Abgelehnt",noOffersOrLoans:"Keine Angebote oder Leihen",noActiveOffersMsg:"Du hast keine aktiven Angebote oder Leihen. Suche Spieler um dein Team zu verstrken!",transferOffers:"Transferangebote",clear:"Lschen",perYear:"/Jahr",weekShort:"Wo. {{week}}",pendingResponse:"Antwort ausstehend  simuliere ein Spiel",club:"Verein",accepts:"Akzeptiert",playerLabel:"Spieler",transferComplete:"Transfer abgeschlossen!",clubAsks:"Verein fordert {{amount}}",acceptCounter:"Gegenangebot akzeptieren",playerRejectedCantComplete:"Spieler hat abgelehnt, kann nicht abgeschlossen werden",deleteBtn:"Lschen",offerRejected:"Angebot abgelehnt",loanedOutPlayers:"Verliehene Spieler",loanedOut:"Verliehen",weeksShort:"{{weeks}} Wo.",atTeam:"Bei {{team}}",purchaseOptionAmount:"Kaufoption: {{amount}}",loanedInPlayers:"Ausgeliehene Spieler",onLoan:"Ausgeliehen",ownedBy:"Eigentum von {{team}}",buyAmount:"Kaufen ({{amount}})",newsFeed:"Nachrichten-Feed",noRecentNews:"Keine aktuellen Nachrichten",europe:"Europa",southAmerica:"Sdamerika",restOfWorld:"Rest der Welt",leaguesMeta:"{{count}} Liga{{plural}}  {{teams}} Teams",nTeams:"{{count}} Teams",searchTeamPlaceholder:"Team suchen...",playersAvgOvr:"{{count}} Spieler   {{avg}}",yourTeam:"Dein Team",posHeader:"POS",playerHeader:"SPIELER",ageHeader:"ALTER",ovrHeader:"OVR",valueHeader:"WERT",levelBadge:"Stufe {{level}}",searchPositionLabel:"Position suchen:",analyzingMarket:"Markt wird analysiert...",searchPlayers:"Spieler suchen",searchSpecific:"{{pos}} suchen",playersFound:"{{count}} Spieler gefunden",tickerDefault:"Transfermarkt aktiv | Bleib auf dem Laufenden",breakingNews:"EILMELDUNG",loanExclamation:"LEIHE!",transferExclamation:"TRANSFER!",seasonLabel:"Saison",nYears:"{{count}} Jahre",totalWord:"gesamt",close:"Schlieen",transferFailed:"TRANSFER GESCHEITERT",blockedUntilNextSeason:"Du kannst mit diesem Spieler erst nchste Saison verhandeln",freeAgent:"VEREINSLOS",ageLabel:"Alter",valueLabel:"Wert",salaryLabel:"Gehalt",contractLabel:"Vertrag",noContract:"Kein Vertrag",professional:"Professionell",difficultyLabel:"Schwierigkeit",tierDropWarning:"Fllt {{count}} Stufe{{plural}} ab",freeAgentLabel:"Vereinslos",signing:"Verpflichtung",loanToggle:"Leihe",preContractToggle:"Vorvertrag",requestLoan:"Leihe Anfragen",negotiatingStatus:"Verhandlung...",acceptedStatus:"Akzeptiert",rejectedBadge:"Abgelehnt",salaryPercentLabel:"% Gehalt das ich zahle",salaryPayHint:"Du wrdest {{amount}}/Jahr des Gehalts zahlen",loanDenied:"{{team}} akzeptiert die Ausleihe von {{player}} nicht. {{reasons}}",noPurchaseOption:"Keine Kaufoption",noOption:"Ohne Option",valuePercent90:"90% Wert",valuePercent100:"100% Wert",estimatedProbability:"Geschtzte Wahrscheinlichkeit",insufficientBudget:"Budget unzureichend ({{amount}})",sendLoanRequest:"Leihanfrage senden",waitingClubResponse:"Warte auf Antwort des Vereins...",prepareOffer:"Angebot Vorbereiten",directRival:"Direkter Rivale",transferToClub:"Ablse an den Verein",clubAccepts:"Verein akzeptiert",annualSalary:"Jahresgehalt",minEstimated:"Minimum geschtzt: {{amount}}/Jahr",contractDuration:"Vertragsdauer",playerAccepts:"Spieler akzeptiert",totalTransferCost:"Gesamte Transferkosten",totalContractCost:"Gesamte Vertragskosten",totalInvestment:"Gesamtinvestition",sendOffer:"Angebot senden",offerHint:"Die Antwort kommt nach Simulation eines Spiels. Der Betrag wird von deinem Budget reserviert.",freeAgentNegotiation:"Verhandlung Vereinsloser Spieler",preContractSection:"Vorvertrag",acceptedPlayerStatus:"Akzeptiert",rejectedPlayerStatus:"Abgelehnt",counterOfferStatus:"Gegenangebot",freeAgentInfo:"Keine Vereinsverhandlung ntig. Verhandle direkt mit dem Spieler mit Handgeld und Gehalt.",preContractBadge:"VORVERTRAG",preContractInfo:"Sein Vertrag luft bald aus. Du kannst direkt ohne Ablse verhandeln. Er wird deinem Team beitreten wenn sein Vertrag endet.",signingBonus:"Handgeld",suggested:"Vorgeschlagen: {{amount}}",totalCostFormatted:"Gesamtkosten: {{amount}} ({{years}} Jahr{{plural}})",acceptanceProbability:"Akzeptanzwahrscheinlichkeit",playerCounterLabel:"Gegenangebot des Spielers:",counterTotalCost:"Gesamtkosten: {{amount}}",totalCostLabel:"Gesamtkosten",presentOffer:"Angebot vorlegen",offerPreContract:"Vorvertrag anbieten",playerEvaluating:"Der Spieler prft dein Angebot...",noAgreementReached:"Es wurde keine Einigung mit dem Spieler erzielt",insufficientSalaryOffer:"Das Gehaltsangebot ist unzureichend",expectsHigherBonus:"Erwartet ein hheres Handgeld",teamLevelNotConvincing:"Das Niveau des Teams berzeugt nicht",overallOfferNotConvincing:"Das Gesamtangebot berzeugt nicht",needsMoreMoney:"Braucht mehr Geld um das Vereinsniveau zu kompensieren",wantsFinancialImprovement:"Mchte eine finanzielle Verbesserung um den Wechsel zu akzeptieren",freeAgentSigned:"Vereinsloser Spieler verpflichtet",preContractSigned:"Vorvertrag unterschrieben",playerJoined:"{{name}} ist ein neuer Spieler. Bonus: {{bonus}}, Gehalt: {{salary}}/Jahr",offerSentTitle:"Angebot gesendet",offerSentContent:"Angebot fr {{name}} ({{team}}): {{amount}} + {{salary}}/Jahr",playerRejectedDefinitely:"Der Spieler hat endgltig abgelehnt",loanNotPossible:"Leihe nicht mglich",cannotLoan:"Kann nicht verliehen werden",insufficientForLoanFee:"Du brauchst {{amount}} fr die Leihgebhr",insufficientBudgetTitle:"Budget unzureichend",cannotExecute:"Kann nicht ausgefhrt werden",noLoanPurchaseOption:"Diese Leihe hat keine Kaufoption",insufficientBudgetShort:"Budget unzureichend",europeTab:"Europa",continentalTab:"Kontinental",accepted:"Angenommen",age:"Alter",contract:"Vertrag",difficulty:"Schwierigkeit",freeAgentsOnly:"Nur vereinslose Spieler",history:"Verlauf",level:"Lv.",loanBadge:"Leihe",loanSuccess:"LEIHE!",negotiating:"Verhandlung...",noOffersReceived:"Keine Angebote erhalten",noSentOffers:"Keine Angebote oder Leihen",noSentOffersDesc:"Du hast keine aktiven Angebote. Suche Spieler zur Verstrkung!",persProfessional:"Professionell",playerValue:"Wert",posAll:"Alle",posDEF:"Verteidiger",posFWD:"Strmer",posGK:"Torwart",positionToSearch:"Position suchen",posMID:"Mittelfeldspieler",preseasonMsg:"Vorsaison! Verpflichte Spieler bevor die Liga beginnt!",purchaseOptionLabel:"Kaufoption",recentTransfers:"Letzte Transfers",responseAfterMatch:"Die Antwort kommt nach der Simulation eines Spiels.",searchPlaceholder:"Spieler suchen...",season:"Saison",signingFailed:"TRANSFER GESCHEITERT",signingSuccess:"TRANSFER!",tickerMsg:"Transfermarkt aktiv",transferBadge:"Transfer",transferCompleted:"Transfer abgeschlossen!",value:"Wert",wantsHigherBonus:"Erwartet hhere Handgeld",year:"Jahr",years:"Jahre",veryEasy:"Sehr Einfach",easy:"Einfach",normal:"Normal",hard:"Schwierig",veryHard:"Sehr Schwierig",almostImpossible:"Fast Unmglich",persAmbitious:"Ehrgeizig",persLoyal:"Loyal",persMercenary:"Sldner",persHomesick:"Familir",persAdventurous:"Abenteuerlustig",persDescAmbitious:"Will bei Top-Clubs spielen",persDescLoyal:"Verlsst kaum seinen Verein",persDescMercenary:"Nur Geld zhlt",persDescHomesick:"Bleibt lieber in der Nhe",persDescProfessional:"Wgt alles ausgeglichen ab",persDescAdventurous:"Mag Vernderung"},Exe={title:"Kalender",fixtures:"Spielplan",results:"Ergebnisse",matchday:"Spieltag",date:"Datum",time:"Zeit",home:"Heim",away:"Auswrts",score:"Ergebnis",competition:"Wettbewerb",venue:"Stadion",european:"Europisch",southAmerican:"Sdamerikanisch",cup:"Pokal",week:"Woche",noEuropeanMatches:"Keine europischen Spiele an diesem Spieltag",noSouthAmericanMatches:"Keine sdamerikanischen Spiele an diesem Spieltag",noCupMatches:"Keine Pokalspiele in dieser Runde"},Mxe={title:"Spieltag",kickoff:"Ansto",fulltime:"Spielende",halftime:"Halbzeit",goal:"Tor!",assist:"Vorlage",yellowCard:"Gelbe Karte",redCard:"Rote Karte",substitution:"Wechsel",injury:"Verletzung",minute:"Min",attendance:"Zuschauer",possession:"Ballbesitz",shots:"Schsse",shotsOnTarget:"Schsse aufs Tor",corners:"Ecken",fouls:"Fouls",offsides:"Abseits",golazo:"TRAUMTOR!",lateGoal:"Tor in der Nachspielzeit!",finalResult:"Endergebnis",skipToEnd:"Zum Ende springen"},Cxe={title:"Tabelle",position:"Platz",team:"Team",played:"Sp",won:"S",drawn:"U",lost:"N",goalsFor:"Tore",goalsAgainst:"GT",goalDifference:"TD",points:"Pkt",form:"Form",next:"Nchster",last5:"Letzte 5",champion:"Meister",championQualification:"Champions Qualifikation",europaQualification:"Europa Qualifikation",conferenceQualification:"Conference Qualifikation",relegation:"Abstieg",playoff:"Playoff",championsLeague:"Continental Champions Cup",libertadores:"Copa Libertadores",europaLeague:"Continental Shield",sudamericana:"Copa Sudamericana",conferenceLeague:"Continental Trophy",promotion:"Direkter Aufstieg",playoffPromotion:"Aufstiegs-Playoff",apertura:"Apertura",clausura:"Clausura",acumulada:"Kumuliert",inProgress:"im Gange",searchLeague:"Liga suchen...",yourLeague:"Ihre Liga",noData:"Keine Daten fr diese Liga verfgbar.",noDataHint:"Daten werden im Laufe der Saison generiert.",group:"Gruppe",championLabel:"Meister",firstLeg:"Hinspiel",secondLeg:"Rckspiel",bothTournamentsChampion:"Meister beider Turniere",formW:"S",formD:"U",formL:"N",showAllTeams:"Alle Teams anzeigen ({{count}})",showLess:"Weniger anzeigen",countries:{spain:"Spanien",england:"England",italy:"Italien",germany:"Deutschland",france:"Frankreich",restOfEurope:"Rest von Europa",southAmerica:"Sdamerika"}},Nxe={title:"Finanzen",income:"Einnahmen",expenses:"Ausgaben",balance:"Saldo",profit:"Gewinn",loss:"Verlust",ticketSales:"Ticketverkufe",transfers:"Transfers",sponsorship:"Sponsoring",merchandise:"Merchandising",salaries:"Gehlter",maintenance:"Wartung",other:"Sonstige",bank:"Bank",currentBudget:"Aktuelles Budget",currentSeason:"Aktuelle Saison",seasonTickets:"Dauerkarten (Saisonende-Einzug)",pending:"ausstehend",noCampaignClosed:"Keine Kampagne abgeschlossen",ticketsSold:"Verkaufte Tickets",accumulatedMatches:"Kumulierte gespielte Spiele",stadiumNaming:"Stadion-Naming",playerSales:"Spielerverkufe",prizesRewards:"Preise und Belohnungen",squadSalaries:"Kader-Gehlter (Saisonende)",stadiumMaintenance:"Stadion-Wartung",signings:"Neuverpflichtungen",seasonBalance:"Saisonbilanz"},Rxe={title:"Anlagen",subtitle:"Verbessern Sie Ihren Verein, um auf hchstem Niveau zu konkurrieren",training:"Training",youth:"Jugend",medical:{infirmary:"Krankenstation",doctors:"rzte",available:"verfgbar",heals:"Heilt",weeks:"Wochen",weeksShort:"Wo",weeksSingular:"e",weeksPlural:"en",cost:"Kosten",noInjured:"Keine verletzten Spieler",inTreatment:"In Behandlung",noMedicalCenter:"Kein medizinisches Zentrum",noDoctorsAvailable:"Keine rzte verfgbar",reduceTo:"Reduzieren auf"},level:"Level",upgrade:"Verbessern",upgraded:"verbessert",cost:"Kosten",benefit:"Nutzen",upgrading:"Verbesserung",completed:"Abgeschlossen",incomePerSeason:"Einkommen/Saison",nextLevel:"Nchstes Level",maxLevel:"Max Level",specialization:"Spezialisierung",notChosen:"Nicht gewhlt",choose:"Whlen",chooseSpecDesc:"Whlen Sie die Spezialisierung (wird bis zur nchsten Saison gesperrt)",ignore:"Ignorieren",categories:{income:"Einkommen",development:"Entwicklung",support:"Untersttzung"},stadium:{name:"Stadion",description:"Kapazitt und Heimvorteil"},impact:{title:"Auswirkungen Ihrer Anlagen",youth:"Nachwuchsspieler",treatments:"Behandlungen",weeksSaved:"Gesparte Wochen"},facilityNames:{stadium:"Stadion",sponsorship:"Kommerziell",youth:"Jugendakademie",medical:"Medizinzentrum",scouting:"Scouting"},facilityDescs:{stadium:"Kapazitt und Heimvorteil",sponsorship:"Sponsoring-Einnahmen",youth:"Generiert junge Talente",medical:"Verkrzt Verletzungszeit",scouting:"Reduziert Transferkosten"},levelNames:{municipal:"Kommunal",modern:"Modern",large:"Gro",elite:"Elite",legendary:"Legendr",basic:"Basis",active:"Aktiv",professional:"Professionell",premium:"Premium",developed:"Entwickelt",advanced:"Fortgeschritten",improved:"Verbessert",local:"Lokal",national:"National",european:"Europisch",worldwide:"Weltweit"},benefits:{seats:"{{count}} Pltze",youthPlayer:"1 Nachwuchsspieler/Saison ({{range}})",standardRecovery:"Standard-Erholung",injuryReduction:"-{{percent}}% Verletzungen  {{treatments}} Behandlung(en)",noTransferAdvantage:"Kein Transfervorteil",transferDiscount:"-{{percent}}% Transferkosten"}},Pxe={title:"Stadion",capacity:"Kapazitt",expand:"Erweitern",maintenance:"Wartung",condition:"Zustand",excellent:"Ausgezeichnet",good:"Gut",poor:"Schlecht",terrible:"Schrecklich",view3dNotAvailable:"3D-Ansicht nicht verfgbar",loadingStadium:"Stadion wird geladen...",general:"Allgemein",sponsorship:"Sponsoring",events:{friendly:"Freundschaftsspiel",concert:"Konzert",corporate:"Firmenevent",legends:"Legendenspiel"},seasonTicketCampaign:"Dauerkarten-Kampagne",campaignOpen:"Kampagne offen bis Spieltag {{deadline}} (aktuell: {{current}})",seasonTicketPrice:"Dauerkarten-Preis:",pricePerMatch:"{{matches}} Spiele ? {{pricePerMatch}}/Spiel",expectedSubscribers:"Erwartete Abonnenten:",maxShort:"max",closeCampaign:"Kampagne schlieen und Abonnenten festlegen",campaignClosed:"Kampagne geschlossen",subscribers:"Abonnenten",pricePerTicket:"Preis/Karte",collected:"eingenommen",ofCapacitySubscribed:"{{percent}}% der Kapazitt abonniert",ticketPrice:"Ticketpreis",priceLocked:"Preis fr diese Saison festgelegt. Nur fr Nicht-Abonnenten.",setPriceBeforeLeague:"Preis pro Spiel fr Nicht-Abonnenten. Vor Ligabeginn festlegen.",accumulatedTicketIncome:"Angesammelte Ticketeinnahmen",onlyTicketsSold:"Nur verkaufte Tickets (ohne Abonnenten). Wird am Saisonende eingezogen.",lastHomeMatchday:"Letzter Heimspieltag",ticketsSold:"Verkaufte Tickets",totalAttendance:"Gesamtbesuch",ticketIncome:"Ticketeinnahmen",grassCondition:"Rasenzustand",optimal:"Optimal",injuryRisk:"Verletzungsrisiko +{{percent}}%",recovers:"Erholt sich +5%/Woche",perfectCondition:"In perfektem Zustand",poorGrassWarning:"Der schlechte Zustand erhht Verletzungen IHRER Spieler",repairGrass:"Rasen reparieren ({{cost}})",currentSponsor:"Aktueller Sponsor",yearsRemaining:"{{years}} Jahre verbleibend",cancelContract:"Vertrag kndigen",penalty:"Strafe: {{amount}}",namingOffers:"Naming-Angebote",sellStadiumName:"Verkaufen Sie den Stadionnamen fr jhrliche Einnahmen",upgradeForSponsors:"Verbessern Sie Ihr Stadion, um Sponsoren anzuziehen",organizeEvents:"Veranstaltungen Organisieren",generateExtraIncome:"Zustzliche Einnahmen generieren (2 Wochen Pause zwischen Events erforderlich)",waitMoreWeeks:"Warten Sie {{weeks}} weitere Woche(n)",grassDamage:"Rasenschaden: -{{percent}}%",organize:"Organisieren",repairGrassBeforeEvents:"Reparieren Sie den Rasen vor der Organisation von Veranstaltungen",homeAdvantage:"Heimvorteil",occupation:"Auslastung",grass:"Rasen",budget:"Budget",stadium:"Stadion",accept:"Akzeptieren",perYear:"/Jahr",years:"Jahre",seasonTicketsClosed:"Dauerkarten-Kampagne geschlossen",seasonTicketsMessage:"{{count}} Abonnenten  {{price}} = {{total}} (wird am Saisonende eingezogen)",namingRights:"Naming Rights",namingMessage:"Vereinbarung mit {{sponsor}}: {{amount}}M/Jahr fr {{duration}} Jahre",sponsorshipCancelled:"Sponsoring gekndigt",stadiumNameRestored:"Das Stadion erhlt seinen ursprnglichen Namen zurck. Strafe bezahlt: {{amount}}M",stadiumNameRestoredFree:"Das Stadion erhlt seinen ursprnglichen Namen zurck",eventHosted:"Veranstaltung durchgefhrt. Einnahmen: {{amount}}K",stadiumUpgraded:"Stadion erweitert",nowStadium:"Jetzt ist es {{name}} mit {{capacity}} Pltzen",seats:"Pltze",insufficientFunds:"Unzureichende Mittel",penaltyRequired:"Sie bentigen {{amount}}M, um die Kndigungsstrafe zu zahlen."},Ixe={title:"Training",fitness:"Fitness",tactics:"Taktik",technical:"Technik",intensity:"Intensitt",low:"Niedrig",medium:"Mittel",high:"Hoch"},Lxe={title:"Einstellungen",language:"Sprache",graphics:"Grafik",sound:"Ton",gameplay:"Gameplay",difficulty:"Schwierigkeit",easy:"Einfach",normal:"Normal",hard:"Schwer",animations:"Animationen",notifications:"Benachrichtigungen",autosave:"Auto-Speichern",general:"Allgemein",autosaveLabel:"Automatisch speichern",autosaveDesc:"Speichert automatisch alle 5 Minuten",volume:"Lautstrke",music:"Musik",effects:"Effekte",gameData:"Spieldaten",saveAndExit:"Speichern und beenden",deleteAndReset:"Daten lschen und neu starten",deleteConfirm:"Alle Daten lschen?",deleteMessage:"Diese Aktion wird Ihr gespeichertes Spiel lschen und kann nicht rckgngig gemacht werden.",appTitle:"PC Gaffer",appVersion:"Version 1.0.0",appTribute:"Die Kunst des Managements",difficultyEasyDesc:"Weniger aggressive KI, mehr Startgeld",difficultyNormalDesc:"Ausgewogene Erfahrung",difficultyHardDesc:"Sehr kompetitive KI, weniger Ressourcen",speedSlow:"Langsam",speedSlowDesc:"Mehr Zeit, um Spiele zu verfolgen",speedNormalDesc:"Standard-Geschwindigkeit",speedFast:"Schnell",speedFastDesc:"Krzere Spiele",yesDeleteAll:"Ja, alles lschen"},Dxe={office:"Bro",formation:"Aufstellung",squad:"Kader",transfers:"Transfers",calendar:"Kalender",table:"Tabelle",finance:"Finanzen",stadium:"Stadion",facilities:"Anlagen",training:"Training",objectives:"Ziele",competitions:"Wettbewerbe",messages:"Nachrichten",bank:"Bank",options:"Optionen",mainMenu:"Hauptmen"},kxe={teamsAvailable:"{{count}} Teams verfgbar",comingSoon:"Demnchst",groupsAndTeams:"{{groups}} Gruppen  {{teams}} Teams",teamsCount:"{{count}} Team{{count, plural, one {} other {s}}}",selectGroup:"Whlen Sie eine Gruppe",searchTeam:"Team suchen...",stadium:"Stadion",municipal:"Municipal",capacity:"Kapazitt",reputation:"Reputation",presentation:"Prsentation",startSeason:"Saison Beginnen"},Oxe={title:"Zeitrennen-Modus",setup:"Einrichtung",start:"Starten",objective:"Ziel: Champions League von unten erreichen",rules:"Regeln",progress:"Fortschritt",timeElapsed:"Verstrichene Zeit",seasonsPlayed:"Gespielte Saisons",currentLeague:"Aktuelle Liga",trophies:"Trophen",completed:"Abgeschlossen!",failed:"Gescheitert",activated:"Zeitrennen aktiviert!",objectiveMessage:"Ziel: die {{competition}} mit {{team}} in mglichst wenigen Saisons gewinnen. Die Uhr tickt!",southAmericanCup:"South American Champions Cup",continentalCup:"Continental Champions Cup"},Fxe={title:"Saisonende",summary:"Zusammenfassung",achievements:"Erfolge",statistics:"Statistiken",topScorer:"Torschtzenknig",bestPlayer:"Bester Spieler",nextSeason:"Nchste Saison",finalTitle:"Finale",league:"Liga",aperturaVsClausura:"Apertura vs Clausura",firstLeg:"Hinspiel",secondLeg:"Rckspiel",result:"Ergebnis",byAggregate:"nach Gesamtergebnis",byAwayGoals:"nach Auswrtstoren",byClausuraAdvantage:"durch sportlichen Vorteil (Clausura-Champion)",sameChampion:"Champion beider Turniere",playoffAscenso:"Aufstiegs-Playoff",semifinals:"Halbfinale",final:"FINALE!",victory:"Sieg!",defeat:"Niederlage",extraTime:"Verlngerung",penalties:"Elfmeterschieen",champion:"CHAMPION!",runner:"Finalist",promotion:"AUFSTIEG!",relegation:"Abstieg",eliminated:"Das Team wurde aus dem Playoff eliminiert",ascends:"STEIGT IN DIE LIGA AUF!",playoffCompleted:"Playoff beendet",playoffWinner:"Playoff-Gewinner",seasonSummary:"Saisonzusammenfassung",finalPosition:"Endposition",points:"Punkte",wins:"Siege",draws:"Unentschieden",losses:"Niederlagen",goalDifference:"Tordiff.",qualifiedFor:"Qualifiziert fr",qualificationBonus:"Qualifikationsbonus",objectives:"Ziele",objectiveBalance:"Zielbilanz",europeanBonus:"Europa-Bonus",continue:"Weiter",playMatch:"Spiel spielen",nextMatch:"Nchstes Spiel",homeGame:"Wir spielen zu Hause",awayGame:"Wir spielen auswrts"},jxe={title:"Ziele",current:"Aktuell",completed:"Abgeschlossen",failed:"Gescheitert",primary:"Primr",secondary:"Sekundr",bonus:"Bonus",leaguePosition:"Tabellenplatz",cupProgress:"Pokal-Fortschritt",budget:"Budget",youngPlayers:"Junge Spieler",critical:"Kritisch",high:"Hoch",medium:"Mittel",low:"Niedrig",objective:"Ziel",onTrack:"Auf Kurs",atRisk:"Gefhrdet",danger:"Gefahr",pending:"Ausstehend",goalDifference:"Tordiff",objectivesAtRisk:"Ziel{{ count === 1 ? '' : 'e' }}",atRiskWarning:"gefhrdet. berprfen Sie Ihre Strategie, um Strafen zu vermeiden.",all:"Alle",inProgress:"In Bearbeitung",criticalObjectives:"Kritische Ziele",seasonObjectives:"Saisonziele",noObjectives:"Keine Ziele definiert",objectivesWillGenerate:"Saisonziele werden generiert, wenn die Liga beginnt.",boardExpects:"Der Vorstand erwartet"},Bxe={championsQualification:"Champions-Qualifikation",europeanQualification:"Europapokal-Qualifikation",topHalf:"Obere Tabellenhlfte",avoidRelegation:"Abstieg vermeiden",promotion:"Aufstieg",titleContender:"Titelkandidat",goalDifference:"Positive Tordifferenz",financialStability:"Finanzielle Stabilitt",youthDevelopment:"Jugendfrderung"},Uxe={championsQualification:"Unter den ersten 4 abschlieen, um sich fr die Continental Champions Cup zu qualifizieren",europeanQualification:"Unter den ersten 6 abschlieen, um sich fr den Europapokal zu qualifizieren",topHalf:"In der oberen Tabellenhlfte abschlieen",avoidRelegation:"Die Klasse halten und auerhalb der Abstiegspltze abschlieen",promotion:"Den Aufstieg in die hhere Liga schaffen",titleContender:"Unter den ersten 2 abschlieen",goalDifference:"Die Saison mit mehr geschossenen als kassierten Toren beenden",financialStability:"Die Saison nicht mit roten Zahlen beenden",youthDevelopment:"Jungen Spielern aus der Jugendakademie Einsatzzeit geben"},Vxe={title:"Nachrichten",inbox:"Posteingang",unread:"Ungelesen",all:"Alle",transfers:"Transfers",injuries:"Verletzungen",contracts:"Vertrge",objectives:"Ziele",markAsRead:"Als Gelesen Markieren",deleteAll:"Alle lschen",deleteAllConfirm:"Alle Nachrichten lschen?",noMessages:"Sie haben keine Nachrichten",backToMessages:"Zurck zu Nachrichten",deleteMessage:"Nachricht lschen"},zxe={title:"Verlngerungen",contractExpiring:"Vertrag Luft Aus",wantsToRenew:"Will Verlngern",rejectRenewal:"Lehnt Verlngerung Ab",demandIncrease:"Fordert Erhhung",offer:"Angebot",playerDemands:"Spieler-Forderungen",currentContract:"Aktueller Vertrag",newContract:"Neuer Vertrag"},Gxe={title:"Wettbewerbe",domestic:"National",european:"Europisch",international:"International",league:"Liga",cup:"Pokal",champions:"Champions League",europa:"Europa League",conference:"Conference League",europeTab:"Europa",continentalTab:"Kontinental",europe:"Europa",continental:"Kontinental"},qxe={title:"Rangliste",contrarreloj:"Zeitrennen",position:"Position",manager:"Trainer",team:"Team",time:"Zeit",trophies:"Trophen",noRecords:"Noch keine Rekorde",records:"REKORDE",subtitle:"Zeitrennen-Modus  Beste Zeiten",clear:"Lschen",confirmClear:"Alle Rekorde lschen? Diese Aktion kann nicht rckgngig gemacht werden.",loading:"Lade Rangliste...",noRecordsDesc:"Schlieen Sie den Zeitrennen-Modus ab, um in der Rangliste zu erscheinen.",playContrarreloj:"Zeitrennen spielen",player:"Spieler",score:"Punktzahl",seasons:"Saisons",competition:"Wettbewerb",date:"Datum"},Hxe={title:"Benachrichtigungen",clear:"Lschen",settings:"Einstellungen",matchResult:"Spielergebnis",transfer:"Transfer",injury:"Verletzung",contract:"Vertrag",objective:"Ziel"},Wxe={POR:"TW",DFC:"IV",LD:"RV",LI:"LV",CRD:"RSV",CRI:"LSV",MCD:"ZDM",MC:"ZM",MCO:"ZOM",MD:"RM",MI:"LM",ED:"RA",EI:"LA",DC:"ST",SD:"HS"},$xe={goalkeeper:"Torwart",defender:"Verteidiger",midfielder:"Mittelfeldspieler",forward:"Strmer",gkShort:"TW",defShort:"ABW",midShort:"MF",fwdShort:"STU",backToSquad:"Zurck zum Kader",injuredWeeks:"Verletzt  {{weeks}} Woche(n) Ausfall",speed:"Tempo",technique:"Technik",passing:"Passspiel",shooting:"Schuss",defense:"Verteidigung",physical:"Physis",number:"Rckennummer",myTeam:"Mein Team",average:"Durchschnitt"},Kxe={back:"Zurck",loadGame:"Spiel Laden",saveGame:"Spiel Speichern",manageGames:"Spiele Verwalten",selectOrCreate:"Whlen Sie ein gespeichertes Spiel oder erstellen Sie ein neues",chooseSlot:"Whlen Sie einen Slot, um Ihren Fortschritt zu speichern",manageSlots:"Verwalten Sie Ihre gespeicherten Spiele",slot:"Slot",emptySlot:"Leerer Slot",newGame:"Neues Spiel",saving:"Speichern...",saveHere:"Hier speichern",unknownTeam:"Unbekanntes Team",loading:"Ldt...",load:"Laden",overwrite:"berschreiben?",deleteGame:"Spiel lschen?",loadingGames:"Lade Spiele...",never:"Nie",errorLoadGames:"Fehler beim Laden der Spiele",errorLoadGame:"Fehler beim Laden des Spiels",errorSaveGame:"Fehler beim Speichern des Spiels",errorDeleteGame:"Fehler beim Lschen des Spiels"},Yxe={menu:"Men",title:"WETTRENNEN GEGEN DIE ZEIT",subtitle:"Knnen Sie die Spitze des europischen/sdamerikanischen Fuballs erreichen?",objective:"Ziel",winChampions:"Champions League oder Copa Libertadores gewinnen",losesIf:"Sie verlieren, wenn",fired:"Sie entlassen werden oder Ihr Budget negativ wird",ranking:"Ranking",fewestSeasons:"Die wenigsten Saisons gewinnen",chooseChallenge:"Whlen Sie Ihre Herausforderung",newTeams:"Neue Teams",ovr:"GES",goal:"Ziel:",libertadores:"?? Copa Libertadores",championsLeague:"?? Champions League",starting:"Startet...",acceptChallenge:"HERAUSFORDERUNG ANNEHMEN!"},Xxe={home:"Startseite",competitions:"Wettb.",more:"Mehr",advance:"Vorwrts",menu:"Men"},Qxe={title:"ENTLASSEN",defaultReason:"Der Vorstand hat beschlossen, Sie von Ihren Trainerpflichten zu entbinden.",balance:"Bilanz",confidence:"Vorstandsvertrauen",backToMenu:"Zurck zum Hauptmen",bankruptReason:"Der Vorstand hat Sie entlassen, weil Sie den Verein in den Bankrott getrieben haben."},Jxe={accountCreated:"Konto erstellt! berprfen Sie Ihre E-Mail zur Kontobesttigung.",passwordResetSent:"Passwort-Reset-E-Mail gesendet. berprfen Sie Ihren Posteingang.",verificationResent:"Besttigungs-E-Mail erneut gesendet",emailNotVerified:"E-Mail noch nicht besttigt. berprfen Sie Ihren Posteingang.",verifyEmail:"E-Mail besttigen",verificationSent:"Wir haben eine Besttigungs-E-Mail gesendet an:",clickLinkToActivate:"Klicken Sie auf den Link in der E-Mail, um Ihr Konto zu aktivieren.",checking:"berprfung...",alreadyVerified:"Ich habe es bereits besttigt",resendEmail:"E-Mail erneut senden",login:"Anmelden",createAccount:"Konto erstellen",resetPassword:"Passwort zurcksetzen",continueWithGoogle:"Mit Google fortfahren",enterAsGuest:"Als Gast eintreten (Test)",orUseEmail:"oder Ihre E-Mail verwenden",username:"Benutzername",usernamePlaceholder:"Ihr Name im Spiel",email:"E-Mail",emailPlaceholder:"ihre@email.de",password:"Passwort",enter:"Eintreten",sendEmail:"E-Mail senden",forgotPassword:"Passwort vergessen?",noAccount:"Kein Konto? Registrieren",haveAccount:"Bereits ein Konto? Anmelden",backToLogin:"Zurck zur Anmeldung",enterUsername:"Geben Sie einen Benutzernamen ein"},Zxe={title:"Europische Wettbewerbe",notQualified:"Sie sind nicht fr europische Wettbewerbe in dieser Saison qualifiziert.",qualificationHint:"Beenden Sie Ihre Liga in den ersten Pltzen, um sich zu qualifizieren.",selectCompetition:"Whlen Sie einen Wettbewerb",prizes:"Preisgelder: {{amount}}",eliminated:"Eliminiert",standings:"Ligaphase Tabelle",matchday:"Spieltag {{current}}/{{total}}",knockoutPhase:"K.o.-Phase  {{phase}}",championTitle:"{{competition}}  Champion!",finalScore:"Finale: {{score}}",recentResults:"Letzte Ergebnisse",pendingDraw:"Auslosung ausstehend...",aggregate:"Agg: {{score}}",phases:{league:"Ligaphase",playoff:"Playoffs",r16:"Achtelfinale",qf:"Viertelfinale",sf:"Halbfinale",final:"Finale",completed:"Wettbewerb Beendet",r16Short:"Achtelfinale",qfShort:"Viertelfinale",sfShort:"Halbfinale"},legend:{directQualification:"1-8: Direkt ins Achtelfinale",playoff:"9-24: Playoffs",eliminated:"25-32: Eliminiert"}},ebe={title:"Sdamerikanische Wettbewerbe",notQualified:"Sie sind nicht fr kontinentale Wettbewerbe in dieser Saison qualifiziert.",qualificationHint:"Beenden Sie Ihre Liga in den ersten Pltzen, um sich zu qualifizieren."},tbe={challengeStart:"Herausforderung beginnt",seasonPosition:"Saison {{season}}  {{position}}. von {{total}}",promotion:"Aufstieg!",promotionDetail:"Von {{from}} zu {{to}}",relegation:"Abstieg",relegationDetail:"Von {{from}} zu {{to}}",continentalCompetition:"Kontinentaler Wettbewerb",phaseReached:"Erreichte Phase: {{phase}}",trophyWon:"?? {{trophy}}",seasonLabel:"Saison {{season}}",currentSeason:"Saison {{season}}  LAUFEND",currentPosition:"{{position}}. von {{total}}",noClassification:"Keine Klassifizierung",copaLibertadores:"Copa Libertadores",championsLeague:"Continental Champions Cup",winGoal:"?? Gewinne die {{competition}}",accomplished:"ERREICHT!",howManySeasonsQuestion:"Wie viele Saisons werden Sie brauchen?",roadToGlory:"Weg zum Ruhm",startingFrom:"beginnend von",currentLeague:"Aktuelle Liga",positionOf:"von {{total}}",position:"Position",trophies:"Trophen",timeline:"Zeitlinie"},nbe={weekDate:"Woche {{week}}",preseason:"Vorsaison",endOfSeason:"Saisonende {{season}}",newOfferReceived:" Neues Angebot erhalten",offerForListedPlayer:" Angebot fr gelisteten Spieler",offerExpired:" Angebot abgelaufen",offerCancelled:" Angebot storniert: {{player}}",transferConfirmed:" Transfer besttigt",transferComplete:" Transfer abgeschlossen",newYouthPlayer:" Neuer Jugendspieler",loanOfferReceived:" Leihangebot erhalten",leagueChampion:" Ligameister!",playerReceivedOnLoan:" Spieler ausgeliehen",purchaseOptionExecuted:" Kaufoption ausgebt",loanAccepted:" Leihe akzeptiert",loan:"Leihe",treatmentApplied:" Behandlung angewendet",playerRetiredTitle:"Rcktritt: {{player}}",aperturaClausuraFinal:" Finale Apertura vs Clausura",cupChampionTitle:"{{icon}} {{cup}}-MEISTER!!",offerContent:"{{buyer}} bietet {{amount}} fr {{player}}",transferConfirmedContent:"{{player}} ({{position}}, {{overall}}) wechselt zu {{toTeam}} von {{fromTeam}} fr {{price}}",youthPlayerContent:"Die Akademie ({{spec}}) hat {{player}} ({{position}}, {{overall}} OVR, {{age}} Jahre) gefrdert",playerRetired:"{{player}} ({{position}}, {{overall}} OVR) tritt vom Profifuball zurck",offerExpiredContent:"Das Angebot von {{team}} fr {{player}} ist abgelaufen",playerUnavailableRefund:"{{player}} ist nicht mehr verfgbar. {{amount}} erstattet",loanOfferContent:"{{team}} mchte {{player}} ausleihen. Gebhr: {{fee}}",directChampion:"{{team}} gewinnt Apertura und Clausura und ist direkter Meister der {{league}}.",aperturaClausuraFinalContent:"Dein Team spielt das Finale der {{league}}! {{apertura}} (Apertura) vs {{clausura}} (Clausura).",transferCompleteContent:"{{player}} ist neues Teammitglied! Kosten: {{cost}}",transferCompleteCounterContent:"{{player}} ist neues Teammitglied! Gegenangebot akzeptiert: {{cost}}",medicalTreatment:"{{player}} wurde behandelt. Verletzung von {{oldWeeks}} auf {{newWeeks}} Wochen reduziert. Kosten: {{cost}}",cupChampionContent:"{{team}} hat den {{cup}} gewonnen!",playerReceivedOnLoanContent:"{{player}} kommt auf Leihbasis von {{team}}. Gebhr: {{fee}}{{option}}",purchaseOptionContent:"{{player}} fest verpflichtet fr {{amount}}",startOfSeason:"Saisonstart {{season}}",newYouthPlayerSon:" Neuer Nachwuchsspieler: {{player}}",youthSonContent:"Sohn von {{parent}}  {{position}}, {{overall}} OVR, Potenzial {{potential}}",offerExpiredPlayer:" Angebot abgelaufen: {{player}}",offerExpiredRefund:"Dein Angebot fr {{player}} ist ohne Antwort abgelaufen. {{amount}} erstattet",offerResponse:"{{icon}} Antwort: {{player}}",offerRejectedContent:" Verein: {{clubReason}}   Spieler: {{playerReason}}",counterOfferExpired:" Gegenangebot abgelaufen: {{player}}",counterOfferExpiredContent:"Das Gegenangebot fr {{player}} ist abgelaufen. {{amount}} erstattet",saleComplete:" Verkauf abgeschlossen",saleCompleteContent:"Du hast {{player}} an {{team}} fr {{amount}} verkauft",counterOfferAccepted:" Gegenangebot angenommen",counterOfferAcceptedContent:"{{team}} akzeptiert {{amount}} fr {{player}}",counterOfferRejected:" Gegenangebot abgelehnt",counterOfferRejectedContent:"{{team}} lehnt dein Gegenangebot von {{amount}} fr {{player}} ab",europeanIncome:"{{icon}} Europische Einnahmen",continentalIncome:"{{icon}} Kontinentale Einnahmen",prizeMoneyContent:"{{competition}}: +{{amount}}",cupByeTitle:"{{icon}} {{cup}}",cupByeContent:"Dein Team kommt direkt in die nchste Runde (Freilos)",cupFinishedTitle:"{{icon}} {{cup}} beendet!",cupWonContent:"Dein Team hat den {{cup}} gewonnen!",cupWonByOther:"Der {{cup}} wurde von {{winner}} gewonnen",cupMatchResult:"{{icon}} {{cup}}: {{team}} {{playerScore}} - {{rivalScore}} {{rival}}",cupAdvance:"Fr die nchste Runde qualifiziert!",cupEliminated:"Aus dem Pokal ausgeschieden",playerLoaned:" Spieler ausgeliehen",playerLoanedContent:"{{player}} an {{team}} ausgeliehen. Gebhr: {{fee}}{{option}}",aperturaClausuraFinalResult:" Finale Apertura vs Clausura",aperturaClausuraFinalResultContent:"{{winner}} gewinnt das Finale der {{league}}. Hinspiel: {{leg1Home}}-{{leg1Away}}, Rckspiel: {{leg2Home}}-{{leg2Away}}.",directChampionShort:"{{winner}} ist direkter Meister."},abe={common:vxe,mainMenu:_xe,cup:xxe,office:bxe,formation:Sxe,plantilla:Txe,transfers:wxe,calendar:Exe,matchday:Mxe,leagueTable:Cxe,finance:Nxe,facilities:Rxe,stadium:Pxe,training:Ixe,settings:Lxe,sidebar:Dxe,teamSelection:kxe,contrarreloj:Oxe,seasonEnd:Fxe,objectives:jxe,objNames:Bxe,objDescs:Uxe,messages:Vxe,renewals:zxe,competitions:Gxe,ranking:qxe,notifications:Hxe,positions:Wxe,squad:$xe,saveSlots:Kxe,contrarrelojSetup:Yxe,mobileNav:Xxe,managerFired:Qxe,auth:Jxe,europe:Zxe,southAmerica:ebe,contrarrelojProgress:tbe,gameMessages:nbe},ibe={save:"Guardar",cancel:"Cancelar",confirm:"Confirmar",accept:"Aceitar",close:"Fechar",back:"Voltar",continue:"Continuar",yes:"Sim",no:"No",loading:"Carregando...",error:"Erro",warning:"Aviso",success:"Sucesso",next:"Prximo",previous:"Anterior",edit:"Editar",delete:"Apagar",add:"Adicionar",remove:"Remover",select:"Selecionar",search:"Pesquisar",filter:"Filtrar",all:"Todos",none:"Nenhum",name:"Nome",age:"Idade",position:"Posio",value:"Valor",salary:"Salrio",contract:"Contrato",team:"Equipe",league:"Liga",season:"Temporada",week:"Semana",day:"Dia",month:"Ms",year:"Ano",money:"Dinheiro",budget:"Oramento",unknown:"Desconhecido"},sbe={title:"PC GAFFER",subtitle:"",season:"",continueGame:"Continuar Jogo",play:"Jogar",login:"Entrar",logout:"Sair",loggingOut:"Saindo...",saveGame:"Guardar Jogo",contrarreloj:"Contra o Relgio",records:"Recordes",options:"Opes",loadOrCreate:"Carregar jogo ou criar novo",saveProgress:"Guarde o seu progresso na nuvem",saveCurrentProgress:"Guardar progresso atual",reachChampions:"Chegue  Champions League desde baixo",guestNotice:"Entre para guardar o seu progresso na nuvem",tribute:"O belo jogo, gerido por ti",contrarrelojActive:"Contra o Relgio Ativo",newGame:"Novo Jogo",deleteWarning:"?? Iniciar novo jogo apagar o progresso atual",playButton:"Jogar",loginButton:"Entrar",saveCurrentGame:"Guardar Jogo",recordsButton:"Recordes",optionsButton:"Opes"},rbe={noCupActive:"Nenhuma taa ativa esta temporada",cup:"Taa",season:"Temporada",champion:"Campeo!",cupFinished:"Taa terminada",eliminatedIn:"Eliminado em",round:"Ronda",inCompetition:"Em competio",nextRound:"Prxima ronda",matches:"jogos",exempt:"isentos",current:"Atual"},obe={title:"Escritrio",overview:"Resumo",simulate:"Simular",simulateWeek:"Simular Semana",simulateSeason:"Simular Temporada",simulateToWindow:"Simular at Janela",simulating:"Simulando...",seasonInfo:"Temporada {{season}}",weekInfo:"Semana {{week}}",changeManagerName:"Nome do treinador (aparece no ranking):",clickToChangeName:"Clique para mudar o nome",budget:"Oramento",teamValue:"Valor da Equipe",stadiumCapacity:"Capacidade do Estdio",facilities:"Instalaes",objectives:"Objetivos",nextMatch:"Prximo Jogo",vs:"VS",home:"Casa",away:"Fora",injuredWarning:"Jogadores lesionados no plantel",playersInjured:"Voc tem {{count}} jogador{{count, plural, one {} other {es}}} lesionado{{count, plural, one {} other {s}}} no seu plantel titular",stillPlay:"Quer continuar com o jogo?",checkFormation:"V  Formao e substitua os jogadores lesionados antes de continuar.",welcome:"Bem-vindo, Treinador",preseason:"Pr-temporada {{week}}/{{total}}",players:"jogadores",boardConfidence:"Confiana da direo",friendlyMatch:"Amigvel {{week}}/5",matchday:"Jornada {{week}}",lastResults:"ltimos Resultados",form_W:"V",form_D:"E",form_L:"D",noMatches:"Nenhum jogo realizado",mainObjective:"Objetivo Principal",viewAllObjectives:"Ver todos os objetivos",recentMessages:"Mensagens Recentes",weeksOut:"{{weeks}} semana{{weeks, plural, one {} other {s}}}",goToFormation:"Ir  Formao",threeMatches:"3 jogos",endOfSeason:"Fim de temporada",halfSeason:"Meia temporada",winterBanner:"JANELA DE INVERNO  Jornada {{current}} de {{total}}",notEnoughPlayers:"Voc no tem jogadores suficientes para formar um time",seasonEnd:"Fim de Temporada",seasonEndedAfterWeeks:"A temporada terminou aps {{weeks}} semanas simuladas.",simulatedWeeks:"{{weeks}} semanas simuladas",advancedToWeek:"Voc avanou para a semana {{week}}",insufficientSquad:"Plantel insuficiente!",onlyHavePlayers:"Voc tem apenas <strong>{{count}} jogadores</strong>. Precisa de um mnimo de <strong>11</strong> para jogar.",goToTransfersWarning:"V ao mercado de transferncias e contrate jogadores antes de continuar. Se tentar simular novamente sem ter 11 jogadores, <strong>perder o jogo</strong>.",goToTransfers:"Ir s Transferncias"},lbe={title:"Formao",lineup:"Onze Titular",reserves:"Jogadores Convocados",notCalled:"Jogadores No Convocados",injured:"Lesionados",suspended:"Suspensos",tactic:"Ttica",formation:"Formao",captain:"Capito",freekicks:"Livres",penalties:"Penltis",corners:"Cantos",mentality:"Mentalidade",attacking:"Ofensiva",balanced:"Equilibrada",defensive:"Defensiva",fitness:"Forma",morale:"Moral",energy:"Energia",experience:"Experincia",makeReserve:"Fazer Suplente",makeStarter:"Fazer Titular",makeNotCalled:"No Convocar",callUp:"Convocar",setCaptain:"Nomear Capito",setFreekicks:"Bater Livres",setPenalties:"Bater Penltis",setCorners:"Bater Cantos",years:"anos",statistics:"Estatsticas",selectPlayer:"Selecionar Jogador",tacticAndFormation:"Ttica e Formao",parameters:"PARMETROS",rating:"AVALIAO",teamAverage:"MDIA EQUIPE",playingAs:"jogando como",tacDefensive:"Defensiva",tacDefensiveDesc:"Muro defensivo, poucas oportunidades",tacDefensiveBonus:"+40% defesa, -40% ataque",tacDefensiveDetail:"Forte vs Equilibrada  Fraco vs Posse e Ofensiva",tacBalanced:"Equilibrada",tacBalancedDesc:"Sem surpresas, sem riscos",tacBalancedBonus:"Sem modificadores",tacBalancedDetail:"Sem vantagens nem desvantagens tticas",tacAttacking:"Ofensiva",tacAttackingDesc:"Tudo para a frente, risco alto",tacAttackingBonus:"+35% ataque, -30% defesa",tacAttackingDetail:"Forte vs Defensiva  Fraco vs Contra e Presso",tacPossession:"Posse de bola",tacPossessionDesc:"Controlar a bola e cansar",tacPossessionBonus:"+30% posse, +10% defesa",tacPossessionDetail:"Forte vs Contra  Fraco vs Presso alta",tacCounter:"Contra-ataque",tacCounterDesc:"Ceder a bola, atacar em contra",tacCounterBonus:"+20% ataque, +15% defesa, -25% posse",tacCounterDetail:"Forte vs Ofensiva e Presso  Fraco vs Posse",noInjuredPlayers:"Nenhum jogador lesionado",medicalLevel:"Nvel centro mdico: {{level}}/5",upgradeMedical:"Melhore as instalaes para mais tratamentos",statsTeam:"Equipa",statsSeason:"Temporada",statsPlayers:"Jogadores",statsTop:"Top",players:"JOGADORES",avgOVR:"MDIA OVR",avgAge:"IDADE MDIA",squadValue:"VALOR PLANTEL",matches:"Jogos",wins:"Vitrias",draws:"Empates",losses:"Derrotas",goalsFor:"Golos a favor",goalsAgainst:"Golos contra",goalDiff:"Diferena",topRated:"Melhor avaliados",mostValuable:"Mais valiosos",mostMatches:"Mais jogos",noStatsYet:"Sem estatsticas ainda - joga jogos para gerar dados",apply:"Aplicar"},cbe={title:"Plantel",players:"Jogadores",contracts:"Contratos",salaries:"Salrios",totalSalary:"Salrio Total",averageAge:"Idade Mdia",squadSize:"Tamanho do Plantel",putForSale:"Pr  Venda",renew:"Renovar",release:"Libertar",loan:"Emprestar",recall:"Chamar de Volta",yearsLeft:"Anos Restantes",onLoan:"Emprestado",forSale:" Venda",wantToLeave:"Quer Sair",unhappy:"Descontente",player:"JOGADOR",sortBy:"Ordenar por",expired:"Expirado",oneYear:"{{years}} ano",multipleYears:"{{years}} anos",budget:"Oramento",weeklySalary:"Folha salarial",perYear:"/ano",perWeek:"/sem",ofBudget:"do oramento",playersNeedAttention:"{{count}} jogador(es) precisa(m) de ateno",retiring:"Aposentando-se",wantsToLeaveAlert:"Quer sair",more:"+{{count}} mais",renewPlayer:"Renovar {{name}}",currentContractLabel:"Contrato atual",demands:"Pede",budgetImpact:"Impacto no oramento:",acceptAndRenew:"Aceitar e renovar",sellPlayer:"Pr {{name}}  venda",marketValue:"Valor de mercado",currentSalary:"Salrio atual",ifSold:"Se vendido:",savedSalary:"poupados",sellNote:"O jogador aparecer no mercado. Outras equipes podem fazer ofertas.",unlistPlayer:"Retirar {{name}} da venda",unlistQuestion:"Este jogador est na lista de transferncias. Quer retir-lo do mercado?",unlistNote:"Deixar de receber ofertas de outras equipes.",confirmUnlist:"Sim, retirar da venda",releasePlayer:"Libertar {{name}}",severanceWarning:"Deve pagar a indemnizao pelos {{years}} ano(s) de contrato restantes.",severanceCost:"Indemnizao a pagar:",salarySaved:"Poupar em salrios:",moraleWarning:"Isto pode afetar o moral do balnerio",insufficientFunds:"No tem dinheiro suficiente para a indemnizao",payAndRelease:"Pagar e libertar",onLoanTag:"EMPRESTADO",forSaleTag:" venda",removeFromSale:"Clique para retirar da venda",renewContract:"Renovar contrato",releasePlayerBtn:"Libertar jogador",loanedBy:"Jogador emprestado por {{team}}  No  possvel vender ou libertar",loanedBadge:"Emprestado",years:"anos",total:"total",canRenew:"Pode ser renovado",cannotRenew:"Jogador no precisa de renovao (mais de 2 anos restantes)",playerRetiring:"Jogador anunciou aposentadoria"},ube={title:"Transferncias",explore:"Explorar",scout:"Olheiro",search:"Pesquisar",received:"Recebidas",sent:"Enviadas",offers:"Ofertas",market:"Mercado",available:"Disponvel",notForSale:"No est  venda",makeOffer:"Fazer Oferta",counterOffer:"Contra-oferta",accept:"Aceitar",reject:"Rejeitar",withdraw:"Retirar",negotiate:"Negociar",transferFee:"Valor da Transferncia",salary:"Salrio",duration:"Durao",loan:"Emprstimo",permanent:"Permanente",windowClosed:"Janela de Transferncias Fechada",windowOpens:"Janela abre na semana",windowCloses:"Janela fecha na semana",noOffers:"Sem ofertas",scoutingReport:"Relatrio do Olheiro",preseasonOpen:"Pr-temporada  Mercado ABERTO",matchdayOpen:"Jornada {{week}}  Mercado ABERTO",marketOpen:"Mercado Aberto",preseasonMessage:" pr-temporada. Aproveite para contratar antes do incio do campeonato!",marketAlwaysOpen:"O mercado est sempre aberto. Contrate, empreste e negocie quando quiser.",totalTransfers:"Transferncias Totais",moneyMoved:"Dinheiro Movido",activeRumors:"Rumores Ativos",latestTransfers:"ltimas Transferncias",noRecentTransfers:"Sem transferncias recentes",marketRumors:"Rumores do Mercado",reliable:"{{pct}}% confivel",noActiveRumors:"Sem rumores ativos",searchPlayerPlaceholder:"Buscar jogador por nome...",filters:"Filtros",position:"Posio",allPositions:"Todas",goalkeeper:"Goleiro",defender:"Defensor",midfielder:"Meio-campista",forward:"Atacante",ageRange:"Idade: {{min}} - {{max}}",minOvr:"OVR mnimo: {{value}}",freeOnly:"Somente jogadores livres",free:"LIVRE",yearsOld:"{{age}} anos",blockedThisSeason:"Bloqueado nesta temporada",contractExpiring:"Contrato expirando",noReceivedOffers:"Sem ofertas recebidas",noInterestYet:"Nenhum clube mostrou interesse nos seus jogadores... por enquanto.",pendingTransferOffers:"Ofertas de transferncia pendentes",transfer:"Transferncia",pending:"Pendente",expiresWeek:"Expira sem. {{week}}",askMore:"Pedir mais",pendingLoanOffers:"Ofertas de emprstimo pendentes",loanFee:"Taxa de emprstimo",receiverSalary:"Salrio receptor",purchaseOption:"Opo de compra",historyTitle:"Histrico",rejected:"Rejeitada",noOffersOrLoans:"Sem ofertas nem emprstimos",noActiveOffersMsg:"No tens ofertas ativas nem emprstimos. Procura jogadores para reforar a tua equipa!",transferOffers:"Ofertas de transferncia",clear:"Limpar",perYear:"/ano",weekShort:"Sem. {{week}}",pendingResponse:"Pendente de resposta  simula um jogo",club:"Clube",accepts:"Aceita",playerLabel:"Jogador",transferComplete:"Transferncia concluda!",clubAsks:"O clube pede {{amount}}",acceptCounter:"Aceitar contra-oferta",playerRejectedCantComplete:"O jogador recusou, no se pode completar",deleteBtn:"Eliminar",offerRejected:"Oferta rejeitada",loanedOutPlayers:"Jogadores emprestados",loanedOut:"Emprestado",weeksShort:"{{weeks}} sem.",atTeam:"No {{team}}",purchaseOptionAmount:"Opo de compra: {{amount}}",loanedInPlayers:"Jogadores por emprstimo",onLoan:"Por emprstimo",ownedBy:"Propriedade do {{team}}",buyAmount:"Comprar ({{amount}})",newsFeed:"Feed de Notcias",noRecentNews:"Sem notcias recentes",europe:"Europa",southAmerica:"Amrica do Sul",restOfWorld:"Resto do Mundo",leaguesMeta:"{{count}} liga{{plural}}  {{teams}} equipas",nTeams:"{{count}} equipas",searchTeamPlaceholder:"Procurar equipa...",playersAvgOvr:"{{count}} jogadores  Mdia {{avg}}",yourTeam:"A tua equipa",posHeader:"POS",playerHeader:"JOGADOR",ageHeader:"IDADE",ovrHeader:"OVR",valueHeader:"VALOR",levelBadge:"Nv. {{level}}",searchPositionLabel:"Posio a procurar:",analyzingMarket:"A analisar o mercado...",searchPlayers:"Procurar jogadores",searchSpecific:"Procurar {{pos}}",playersFound:"{{count}} jogadores encontrados",tickerDefault:"Mercado de transferncias ativo | Fica atento s novidades",breakingNews:"LTIMA HORA",loanExclamation:"EMPRSTIMO!",transferExclamation:"TRANSFERNCIA!",seasonLabel:"Temporada",nYears:"{{count}} anos",totalWord:"total",close:"Fechar",transferFailed:"TRANSFERNCIA FALHADA",blockedUntilNextSeason:"No poders negociar com este jogador at  prxima temporada",freeAgent:"AGENTE LIVRE",ageLabel:"Idade",valueLabel:"Valor",salaryLabel:"Salrio",contractLabel:"Contrato",noContract:"Sem contrato",professional:"Profissional",difficultyLabel:"Dificuldade",tierDropWarning:"Desce {{count}} nvel{{plural}}",freeAgentLabel:"Agente Livre",signing:"Contratao",loanToggle:"Emprstimo",preContractToggle:"Pr-contrato",requestLoan:"Pedir Emprstimo",negotiatingStatus:"A negociar...",acceptedStatus:"Aceite",rejectedBadge:"Rejeitada",salaryPercentLabel:"% salrio que pago",salaryPayHint:"Pagarias {{amount}}/ano do salrio",loanDenied:"{{team}} no aceita emprestar {{player}}. {{reasons}}",noPurchaseOption:"Sem opo de compra",noOption:"Sem opo",valuePercent90:"90% valor",valuePercent100:"100% valor",estimatedProbability:"Probabilidade estimada",insufficientBudget:"Oramento insuficiente ({{amount}})",sendLoanRequest:"Enviar pedido de emprstimo",waitingClubResponse:" espera da resposta do clube...",prepareOffer:"Preparar Oferta",directRival:"Rival direto",transferToClub:"Transferncia ao clube",clubAccepts:"Clube aceita",annualSalary:"Salrio anual",minEstimated:"Mnimo estimado: {{amount}}/ano",contractDuration:"Durao do contrato",playerAccepts:"Jogador aceita",totalTransferCost:"Custo total transferncia",totalContractCost:"Custo total contrato",totalInvestment:"Investimento total",sendOffer:"Enviar oferta",offerHint:"A resposta chegar aps simular um jogo. O montante  reservado do teu oramento.",freeAgentNegotiation:"Negociao Agente Livre",preContractSection:"Pr-contrato",acceptedPlayerStatus:"Aceite",rejectedPlayerStatus:"Rejeitado",counterOfferStatus:"Contra-oferta",freeAgentInfo:"No  preciso negociar com nenhum clube. Negoceia diretamente com o jogador oferecendo um bnus de assinatura e salrio.",preContractBadge:"PR-CONTRATO",preContractInfo:"O contrato dele expira em breve. Podes negociar diretamente sem pagar transferncia. Vai juntar-se  tua equipa quando o contrato terminar.",signingBonus:"Bnus de assinatura",suggested:"Sugerido: {{amount}}",totalCostFormatted:"Custo total: {{amount}} ({{years}} ano{{plural}})",acceptanceProbability:"Probabilidade de aceitao",playerCounterLabel:"Contra-oferta do jogador:",counterTotalCost:"Custo total: {{amount}}",totalCostLabel:"Custo total",presentOffer:"Apresentar oferta",offerPreContract:"Oferecer pr-contrato",playerEvaluating:"O jogador est a avaliar a tua oferta...",noAgreementReached:"No se chegou a um acordo com o jogador",insufficientSalaryOffer:"A oferta salarial  insuficiente",expectsHigherBonus:"Espera um bnus de assinatura mais alto",teamLevelNotConvincing:"O nvel da equipa no o convence",overallOfferNotConvincing:"A oferta global no o convence",needsMoreMoney:"Precisa de mais dinheiro para compensar o nvel do clube",wantsFinancialImprovement:"Quer uma melhoria financeira para aceitar a mudana",freeAgentSigned:"Agente livre contratado",preContractSigned:"Pr-contrato assinado",playerJoined:"{{name}}  um novo jogador. Bnus: {{bonus}}, Salrio: {{salary}}/ano",offerSentTitle:"Oferta enviada",offerSentContent:"Oferta por {{name}} ({{team}}): {{amount}} + {{salary}}/ano",playerRejectedDefinitely:"O jogador rejeitou definitivamente",loanNotPossible:"Emprstimo no possvel",cannotLoan:"No se pode emprestar",insufficientForLoanFee:"Precisas de {{amount}} para a taxa de emprstimo",insufficientBudgetTitle:"Oramento insuficiente",cannotExecute:"No se pode executar",noLoanPurchaseOption:"Este emprstimo no tem opo de compra",insufficientBudgetShort:"Oramento insuficiente",europeTab:"Europa",continentalTab:"Continental",accepted:"Aceite",age:"Idade",contract:"Contrato",difficulty:"Dificuldade",freeAgentsOnly:"Apenas jogadores livres",history:"Histrico",level:"Nv.",loanBadge:"Emprstimo",loanSuccess:"EMPRSTIMO!",negotiating:"Negociando...",noOffersReceived:"Nenhuma oferta recebida",noSentOffers:"Sem ofertas ou emprstimos",noSentOffersDesc:"No tens ofertas ativas. Procura jogadores para reforar a equipa!",persProfessional:"Profissional",playerValue:"Valor",posAll:"Todas",posDEF:"Defensor",posFWD:"Avanado",posGK:"Guarda-redes",positionToSearch:"Posio a procurar",posMID:"Mdio",preseasonMsg:"Estamos na pr-temporada. Contrata antes do incio da liga!",purchaseOptionLabel:"Opo de compra",recentTransfers:"ltimas Transferncias",responseAfterMatch:"A resposta chegar aps simular um jogo.",searchPlaceholder:"Procurar jogador...",season:"Temporada",signingFailed:"CONTRATAO FALHADA",signingSuccess:"CONTRATAO!",tickerMsg:"Mercado de transferncias ativo",transferBadge:"Transferncia",transferCompleted:"Transferncia concluda!",value:"valor",wantsHigherBonus:"Espera um bnus de assinatura mais alto",year:"ano",years:"anos",veryEasy:"Muito Fcil",easy:"Fcil",normal:"Normal",hard:"Difcil",veryHard:"Muito Difcil",almostImpossible:"Quase Impossvel",persAmbitious:"Ambicioso",persLoyal:"Leal",persMercenary:"Mercenrio",persHomesick:"Familiar",persAdventurous:"Aventureiro",persDescAmbitious:"Quer jogar nos melhores clubes",persDescLoyal:"Muito difcil que saia do clube",persDescMercenary:"S o dinheiro importa",persDescHomesick:"Prefere ficar perto de casa",persDescProfessional:"Avalia tudo com equilbrio",persDescAdventurous:"Gosta de mudar de ares"},dbe={title:"Calendrio",fixtures:"Jogos",results:"Resultados",matchday:"Jornada",date:"Data",time:"Hora",home:"Casa",away:"Fora",score:"Resultado",competition:"Competio",venue:"Estdio",european:"Europeia",southAmerican:"Sul-Americana",cup:"Copa",week:"Semana",noEuropeanMatches:"Nenhuma partida europeia nesta rodada",noSouthAmericanMatches:"Nenhuma partida sul-americana nesta rodada",noCupMatches:"Nenhuma partida de copa nesta rodada"},hbe={title:"Dia de Jogo",kickoff:"Incio",fulltime:"Fim de Jogo",halftime:"Intervalo",goal:"Golo!",assist:"Assistncia",yellowCard:"Carto Amarelo",redCard:"Carto Vermelho",substitution:"Substituio",injury:"Leso",minute:"Min",attendance:"Assistncia",possession:"Posse",shots:"Remates",shotsOnTarget:"Remates  Baliza",corners:"Cantos",fouls:"Faltas",offsides:"Foras de Jogo",golazo:"GOLAO!",lateGoal:"Golo nos descontos!",finalResult:"Resultado Final",skipToEnd:"Saltar para o fim"},fbe={title:"Classificao",position:"Pos",team:"Equipe",played:"J",won:"V",drawn:"E",lost:"D",goalsFor:"GM",goalsAgainst:"GS",goalDifference:"DG",points:"Pts",form:"Forma",next:"Prximo",last5:"ltimos 5",champion:"Campeo",championQualification:"Qualificao Champions",europaQualification:"Qualificao Europa",conferenceQualification:"Qualificao Conference",relegation:"Descida",playoff:"Playoff",championsLeague:"Liga dos Campees",libertadores:"Copa Libertadores",europaLeague:"Liga Europa",sudamericana:"Copa Sul-Americana",conferenceLeague:"Liga Conferncia",promotion:"Acesso direto",playoffPromotion:"Playoff de acesso",apertura:"Apertura",clausura:"Clausura",acumulada:"Acumulada",inProgress:"em andamento",searchLeague:"Buscar liga...",yourLeague:"Sua liga",noData:"Sem dados disponveis para esta liga.",noDataHint:"Os dados sero gerados conforme a temporada avana.",group:"Grupo",championLabel:"Campeo",firstLeg:"Ida",secondLeg:"Volta",bothTournamentsChampion:"campeo de ambos os torneios",formW:"V",formD:"E",formL:"D",showAllTeams:"Ver todos os times ({{count}})",showLess:"Ver menos",countries:{spain:"Espanha",england:"Inglaterra",italy:"Itlia",germany:"Alemanha",france:"Frana",restOfEurope:"Resto da Europa",southAmerica:"Amrica do Sul"}},pbe={title:"Finanas",income:"Receitas",expenses:"Despesas",balance:"Saldo",profit:"Lucro",loss:"Prejuzo",ticketSales:"Venda de Bilhetes",transfers:"Transferncias",sponsorship:"Patrocnio",merchandise:"Merchandising",salaries:"Salrios",maintenance:"Manuteno",other:"Outros",bank:"Banco",currentBudget:"Oramento atual",currentSeason:"Temporada Atual",seasonTickets:"Scio-torcedores (cobrana fim temporada)",pending:"pendente",noCampaignClosed:"Nenhuma campanha fechada",ticketsSold:"Ingressos vendidos",accumulatedMatches:"Partidas jogadas acumuladas",stadiumNaming:"Naming do estdio",playerSales:"Vendas de jogadores",prizesRewards:"Prmios e recompensas",squadSalaries:"Salrios do elenco (fim temporada)",stadiumMaintenance:"Manuteno do estdio",signings:"Contrataes",seasonBalance:"Balano da temporada"},mbe={title:"Instalaes",subtitle:"Melhore o seu clube para competir ao mais alto nvel",training:"Treino",youth:"Formao",medical:{infirmary:"Enfermaria",doctors:"Mdicos",available:"disponveis",heals:"Cura",weeks:"semanas",weeksShort:"sem",weeksSingular:"a",weeksPlural:"as",cost:"Custo",noInjured:"Sem jogadores lesionados",inTreatment:"Em tratamento",noMedicalCenter:"Sem centro mdico",noDoctorsAvailable:"Nenhum mdico disponvel",reduceTo:"Reduzir para"},level:"Nvel",upgrade:"Melhorar",upgraded:"melhorado",cost:"Custo",benefit:"Benefcio",upgrading:"Melhorando",completed:"Concludo",incomePerSeason:"Receita/temporada",nextLevel:"Prximo nvel",maxLevel:"Nvel Mx",specialization:"Especializao",notChosen:"No escolhido",choose:"Escolher",chooseSpecDesc:"Escolha a especializao (ser bloqueada at  prxima temporada)",ignore:"Ignorar",categories:{income:"Receitas",development:"Desenvolvimento",support:"Apoio"},stadium:{name:"Estdio",description:"Capacidade e vantagem em casa"},impact:{title:"Impacto das suas instalaes",youth:"Jovens jogadores",treatments:"Tratamentos",weeksSaved:"Semanas poupadas"},facilityNames:{stadium:"Estdio",sponsorship:"Comercial",youth:"Academia",medical:"Centro Mdico",scouting:"Olheiros"},facilityDescs:{stadium:"Capacidade e fator casa",sponsorship:"Receitas de patrocnio",youth:"Gera jovens talentos",medical:"Reduz tempo de leso",scouting:"Reduz custos de transferncia"},levelNames:{municipal:"Municipal",modern:"Moderno",large:"Grande",elite:"Elite",legendary:"Lendrio",basic:"Bsico",active:"Ativo",professional:"Profissional",premium:"Premium",developed:"Desenvolvido",advanced:"Avanado",improved:"Melhorado",local:"Local",national:"Nacional",european:"Europeu",worldwide:"Mundial"},benefits:{seats:"{{count}} lugares",youthPlayer:"1 jovem/temporada ({{range}})",standardRecovery:"Recuperao padro",injuryReduction:"-{{percent}}% leses  {{treatments}} tratamento(s)",noTransferAdvantage:"Sem vantagem em transferncias",transferDiscount:"-{{percent}}% custo de transferncia"}},gbe={title:"Estdio",capacity:"Capacidade",expand:"Expandir",maintenance:"Manuteno",condition:"Estado",excellent:"Excelente",good:"Bom",poor:"Mau",terrible:"Terrvel",view3dNotAvailable:"Vista 3D no disponvel",loadingStadium:"Carregando estdio...",general:"Geral",sponsorship:"Patrocnio",events:{friendly:"Amistoso",concert:"Show",corporate:"Evento Corporativo",legends:"Jogo das Lendas"},seasonTicketCampaign:"Campanha de Scios",campaignOpen:"Campanha aberta at rodada {{deadline}} (atual: {{current}})",seasonTicketPrice:"Preo da carteirinha:",pricePerMatch:"{{matches}} jogos ? {{pricePerMatch}}/jogo",expectedSubscribers:"Scios previstos:",maxShort:"mx",closeCampaign:"Fechar campanha e fixar scios",campaignClosed:"Campanha fechada",subscribers:"scios",pricePerTicket:"preo/ingresso",collected:"arrecadado",ofCapacitySubscribed:"{{percent}}% da capacidade associada",ticketPrice:"Preo do Ingresso",priceLocked:"Preo fixado para esta temporada. Apenas para no-scios.",setPriceBeforeLeague:"Preo por jogo para no-scios. Definir antes do incio do campeonato.",accumulatedTicketIncome:"Receita de ingressos acumulada",onlyTicketsSold:"Apenas ingressos vendidos (sem scios). Arrecadado no final da temporada.",lastHomeMatchday:"ltima rodada em casa",ticketsSold:"Ingressos vendidos",totalAttendance:"Pblico total",ticketIncome:"Receita de ingressos",grassCondition:"Condio do Gramado",optimal:"timo",injuryRisk:"Risco leses +{{percent}}%",recovers:"Recupera +5%/semana",perfectCondition:"Em perfeitas condies",poorGrassWarning:"O mau estado aumenta leses dos SEUS jogadores",repairGrass:"Reparar gramado ({{cost}})",currentSponsor:"Patrocinador Atual",yearsRemaining:"{{years}} anos restantes",cancelContract:"Cancelar contrato",penalty:"Multa: {{amount}}",namingOffers:"Ofertas de Naming",sellStadiumName:"Venda o nome do estdio por receitas anuais",upgradeForSponsors:"Melhore seu estdio para atrair patrocinadores",organizeEvents:"Organizar Eventos",generateExtraIncome:"Gerar receita extra (requer 2 semanas entre eventos)",waitMoreWeeks:"Aguarde {{weeks}} semana(s) a mais",grassDamage:"Dano gramado: -{{percent}}%",organize:"Organizar",repairGrassBeforeEvents:"Repare o gramado antes de organizar eventos",homeAdvantage:"Fator casa",occupation:"Ocupao",grass:"Gramado",budget:"Oramento",stadium:"Estdio",accept:"Aceitar",perYear:"/ano",years:"anos",seasonTicketsClosed:"Campanha de scios fechada",seasonTicketsMessage:"{{count}} scios  {{price}} = {{total}} (ser arrecadado no final da temporada)",namingRights:"Direitos de Naming",namingMessage:"Acordo com {{sponsor}}: {{amount}}M/ano por {{duration}} anos",sponsorshipCancelled:"Patrocnio cancelado",stadiumNameRestored:"O estdio recupera seu nome original. Multa paga: {{amount}}M",stadiumNameRestoredFree:"O estdio recupera seu nome original",eventHosted:"Evento realizado. Receita: {{amount}}K",stadiumUpgraded:"Estdio expandido",nowStadium:"Agora  {{name}} com {{capacity}} lugares",seats:"lugares",insufficientFunds:"Fundos insuficientes",penaltyRequired:"Voc precisa de {{amount}}M para pagar a multa de cancelamento do contrato."},Abe={title:"Treino",fitness:"Forma Fsica",tactics:"Ttica",technical:"Tcnica",intensity:"Intensidade",low:"Baixa",medium:"Mdia",high:"Alta"},ybe={title:"Opes",language:"Idioma",graphics:"Grficos",sound:"Som",gameplay:"Jogabilidade",difficulty:"Dificuldade",easy:"Fcil",normal:"Normal",hard:"Difcil",animations:"Animaes",notifications:"Notificaes",autosave:"Guardar Automtico",general:"Geral",autosaveLabel:"Guardar automtico",autosaveDesc:"Guarda automaticamente a cada 5 minutos",volume:"Volume",music:"Msica",effects:"Efeitos",gameData:"Dados do Jogo",saveAndExit:"Guardar e sair",deleteAndReset:"Apagar dados e reiniciar",deleteConfirm:"Apagar todos os dados?",deleteMessage:"Esta ao ir apagar o seu jogo guardado e no pode ser desfeita.",appTitle:"PC Gaffer",appVersion:"Verso 1.0.0",appTribute:"A arte de gerir",difficultyEasyDesc:"IA menos agressiva, mais dinheiro inicial",difficultyNormalDesc:"Experincia equilibrada",difficultyHardDesc:"IA muito competitiva, menos recursos",speedSlow:"Lenta",speedSlowDesc:"Mais tempo para ver os jogos",speedNormalDesc:"Velocidade padro",speedFast:"Rpida",speedFastDesc:"Jogos mais curtos",yesDeleteAll:"Sim, apagar tudo"},vbe={office:"Escritrio",formation:"Formao",squad:"Plantel",transfers:"Transferncias",calendar:"Calendrio",table:"Classificao",finance:"Finanas",stadium:"Estdio",facilities:"Instalaes",training:"Treino",objectives:"Objetivos",competitions:"Competies",messages:"Mensagens",bank:"Banco",options:"Opes",mainMenu:"Menu Principal"},_be={teamsAvailable:"{{count}} times disponveis",comingSoon:"Em breve",groupsAndTeams:"{{groups}} grupos  {{teams}} times",teamsCount:"{{count}} time{{count, plural, one {} other {s}}}",selectGroup:"Selecione um grupo",searchTeam:"Buscar time...",stadium:"Estdio",municipal:"Municipal",capacity:"Capacidade",reputation:"Reputao",presentation:"Apresentao",startSeason:"Comear Temporada"},xbe={title:"Modo Contra o Relgio",setup:"Configurao",start:"Comear",objective:"Objetivo: Chegar  Champions League desde baixo",rules:"Regras",progress:"Progresso",timeElapsed:"Tempo Decorrido",seasonsPlayed:"Temporadas Jogadas",currentLeague:"Liga Atual",trophies:"Trofus",completed:"Concludo!",failed:"Falhado",activated:"Contra o Relgio ativado!",objectiveMessage:"Objetivo: vencer a {{competition}} com {{team}} no menor nmero de temporadas. O relgio corre!",southAmericanCup:"South American Champions Cup",continentalCup:"Continental Champions Cup"},bbe={title:"Fim de Temporada",summary:"Resumo",achievements:"Conquistas",statistics:"Estatsticas",topScorer:"Artilheiro",bestPlayer:"Melhor Jogador",nextSeason:"Prxima Temporada",finalTitle:"Final",league:"Liga",aperturaVsClausura:"Apertura vs Clausura",firstLeg:"Ida",secondLeg:"Volta",result:"Resultado",byAggregate:"por saldo de gols",byAwayGoals:"por gols fora de casa",byClausuraAdvantage:"por vantagem esportiva (campeo do Clausura)",sameChampion:"campeo de ambos os torneios",playoffAscenso:"Playoff de Acesso",semifinals:"Semifinais",final:"FINAL!",victory:"Vitria!",defeat:"Derrota",extraTime:"Prorrogao",penalties:"Pnaltis",champion:"CAMPEO!",runner:"Vice-campeo",promotion:"ACESSO!",relegation:"Rebaixamento",eliminated:"A equipe foi eliminada do playoff",ascends:"SOBE PARA A PRIMEIRA DIVISO!",playoffCompleted:"Playoff concludo",playoffWinner:"Vencedor do playoff",seasonSummary:"Resumo da temporada",finalPosition:"Posio Final",points:"Pontos",wins:"Vitrias",draws:"Empates",losses:"Derrotas",goalDifference:"Saldo",qualifiedFor:"Classificado para",qualificationBonus:"Bnus de classificao",objectives:"Objetivos",objectiveBalance:"Balano dos objetivos",europeanBonus:"Bnus europeu",continue:"Continuar",playMatch:"Jogar partida",nextMatch:"Prxima partida",homeGame:"Jogamos em casa",awayGame:"Jogamos fora"},Sbe={title:"Objetivos",current:"Atuais",completed:"Concludos",failed:"Falhados",primary:"Primrio",secondary:"Secundrio",bonus:"Bnus",leaguePosition:"Posio na Liga",cupProgress:"Progresso na Taa",budget:"Oramento",youngPlayers:"Jogadores Jovens",critical:"Crtico",high:"Principal",medium:"Secundrio",low:"Opcional",objective:"Objetivo",onTrack:"No Caminho",atRisk:"Em Risco",danger:"Perigo",pending:"Pendente",goalDifference:"Diff. gols",objectivesAtRisk:"objetivo{{ count === 1 ? '' : 's' }}",atRiskWarning:"em risco. Revise sua estratgia para evitar penalidades.",all:"Todos",inProgress:"Em Progresso",criticalObjectives:"Objetivos Crticos",seasonObjectives:"Objetivos da Temporada",noObjectives:"Sem objetivos definidos",objectivesWillGenerate:"Os objetivos da temporada sero gerados quando a liga comear.",boardExpects:"A diretoria espera"},Tbe={championsQualification:"Classificao para a Champions",europeanQualification:"Classificao europeia",topHalf:"Primeira metade da tabela",avoidRelegation:"Evitar o rebaixamento",promotion:"Promoo",titleContender:"Lutar pelo ttulo",goalDifference:"Saldo de gols positivo",financialStability:"Estabilidade financeira",youthDevelopment:"Desenvolvimento da base"},wbe={championsQualification:"Terminar entre os 4 primeiros para se classificar para a Continental Champions Cup",europeanQualification:"Terminar entre os 6 primeiros para se classificar para competio europeia",topHalf:"Terminar na primeira metade da classificao",avoidRelegation:"Manter a categoria terminando fora da zona de rebaixamento",promotion:"Conseguir a promoo para a diviso superior",titleContender:"Terminar entre os 2 primeiros",goalDifference:"Terminar a temporada com mais gols marcados do que sofridos",financialStability:"No terminar a temporada no vermelho",youthDevelopment:"Dar minutos a jovens jogadores da base"},Ebe={title:"Mensagens",inbox:"Caixa de entrada",unread:"No Lidas",all:"Todas",transfers:"Transferncias",injuries:"Leses",contracts:"Contratos",objectives:"Objetivos",markAsRead:"Marcar como Lida",deleteAll:"Apagar todas",deleteAllConfirm:"Apagar todas as mensagens?",noMessages:"No tem mensagens",backToMessages:"Voltar s mensagens",deleteMessage:"Apagar mensagem"},Mbe={title:"Renovaes",contractExpiring:"Contrato Expira",wantsToRenew:"Quer Renovar",rejectRenewal:"Rejeita Renovao",demandIncrease:"Exige Aumento",offer:"Oferta",playerDemands:"Exigncias do Jogador",currentContract:"Contrato Atual",newContract:"Novo Contrato"},Cbe={title:"Competies",domestic:"Domsticas",european:"Europeias",international:"Internacionais",league:"Liga",cup:"Taa",champions:"Liga dos Campees",europa:"Liga Europa",conference:"Conference League",europeTab:"Europa",continentalTab:"Continental",europe:"Europa",continental:"Continental"},Nbe={title:"Ranking",contrarreloj:"Contra o Relgio",position:"Posio",manager:"Treinador",team:"Equipe",time:"Tempo",trophies:"Trofus",noRecords:"Ainda sem recordes",records:"RECORDES",subtitle:"Modo Contra o Relgio  Melhores Tempos",clear:"Limpar",confirmClear:"Apagar todos os recordes? Esta ao no pode ser desfeita.",loading:"Carregando ranking...",noRecordsDesc:"Complete o modo Contra o Relgio para aparecer no ranking.",playContrarreloj:"Jogar Contra o Relgio",player:"Jogador",score:"Pontuao",seasons:"Temporadas",competition:"Competio",date:"Data"},Rbe={title:"Notificaes",clear:"Limpar",settings:"Definies",matchResult:"Resultado do Jogo",transfer:"Transferncia",injury:"Leso",contract:"Contrato",objective:"Objetivo"},Pbe={POR:"GR",DFC:"ZAG",LD:"LD",LI:"LE",CRD:"ADD",CRI:"ADE",MCD:"VOL",MC:"MC",MCO:"MEI",MD:"MD",MI:"ME",ED:"PD",EI:"PE",DC:"ATA",SD:"SA"},Ibe={goalkeeper:"Goleiro",defender:"Defensor",midfielder:"Meio-campista",forward:"Atacante",gkShort:"GR",defShort:"DEF",midShort:"MEI",fwdShort:"ATA",backToSquad:"Voltar ao plantel",injuredWeeks:"Lesionado  {{weeks}} semana(s) fora",speed:"Velocidade",technique:"Tcnica",passing:"Passe",shooting:"Remate",defense:"Defesa",physical:"Fsico",number:"Dorsal",myTeam:"Minha Equipe",average:"Mdia"},Lbe={back:"Voltar",loadGame:"Carregar Jogo",saveGame:"Salvar Jogo",manageGames:"Gerenciar Jogos",selectOrCreate:"Selecione um jogo salvo ou crie um novo",chooseSlot:"Escolha um slot para salvar seu progresso",manageSlots:"Gerencie seus jogos salvos",slot:"Slot",emptySlot:"Slot vazio",newGame:"Novo Jogo",saving:"Salvando...",saveHere:"Salvar aqui",unknownTeam:"Equipe desconhecida",loading:"Carregando...",load:"Carregar",overwrite:"Substituir?",deleteGame:"Apagar jogo?",loadingGames:"Carregando jogos...",never:"Nunca",errorLoadGames:"Erro ao carregar jogos",errorLoadGame:"Erro ao carregar jogo",errorSaveGame:"Erro ao salvar jogo",errorDeleteGame:"Erro ao apagar jogo"},Dbe={menu:"Menu",title:"CORRIDA CONTRA O TEMPO",subtitle:"Voc consegue chegar ao topo do futebol europeu/sul-americano?",objective:"Objetivo",winChampions:"Vencer a Champions League ou Copa Libertadores",losesIf:"Voc perde se",fired:"For demitido ou seu oramento ficar negativo",ranking:"Ranking",fewestSeasons:"Menor nmero de temporadas vence",chooseChallenge:"Escolha seu desafio",newTeams:"Novas equipes",ovr:"GER",goal:"Meta:",libertadores:"?? Copa Libertadores",championsLeague:"?? Champions League",starting:"Iniciando...",acceptChallenge:"ACEITAR O DESAFIO!"},kbe={home:"Incio",competitions:"Comp.",more:"Mais",advance:"Avanar",menu:"Menu"},Obe={title:"DEMITIDO",defaultReason:"A diretoria decidiu dispensar seus servios como treinador.",balance:"Saldo",confidence:"Confiana da diretoria",backToMenu:"Voltar ao Menu Principal",bankruptReason:"A diretoria te demitiu por levar o clube  falncia."},Fbe={accountCreated:"Conta criada! Verifique seu email para ativar sua conta.",passwordResetSent:"Email de recuperao enviado. Verifique sua caixa de entrada.",verificationResent:"Email de verificao reenviado",emailNotVerified:"Email ainda no verificado. Verifique sua caixa de entrada.",verifyEmail:"Verifique seu email",verificationSent:"Enviamos um email de verificao para:",clickLinkToActivate:"Clique no link do email para ativar sua conta.",checking:"Verificando...",alreadyVerified:"J verifiquei",resendEmail:"Reenviar email",login:"Iniciar Sesso",createAccount:"Criar Conta",resetPassword:"Recuperar Senha",continueWithGoogle:"Continuar com Google",enterAsGuest:"Entrar como Convidado (Testes)",orUseEmail:"ou use seu email",username:"Nome de usurio",usernamePlaceholder:"Seu nome no jogo",email:"Email",emailPlaceholder:"seu@email.com",password:"Senha",enter:"Entrar",sendEmail:"Enviar email",forgotPassword:"Esqueceu sua senha?",noAccount:"No tem conta? Registre-se",haveAccount:"J tem conta? Faa login",backToLogin:"Voltar ao login",enterUsername:"Digite um nome de usurio"},jbe={title:"Competies Europeias",notQualified:"Voc no est classificado para competies europeias nesta temporada.",qualificationHint:"Termine nas primeiras posies da sua liga para se classificar.",selectCompetition:"Selecione uma competio",prizes:"Prmios: {{amount}}",eliminated:"Eliminado",standings:"Tabela da Fase de Liga",matchday:"Jornada {{current}}/{{total}}",knockoutPhase:"Fase Eliminatria  {{phase}}",championTitle:"{{competition}}  Campeo!",finalScore:"Final: {{score}}",recentResults:"Resultados Recentes",pendingDraw:"Aguardando sorteio...",aggregate:"Agg: {{score}}",phases:{league:"Fase de Liga",playoff:"Playoffs",r16:"Oitavas de Final",qf:"Quartas de Final",sf:"Semifinais",final:"Final",completed:"Competio Finalizada",r16Short:"Oitavas",qfShort:"Quartas",sfShort:"Semifinais"},legend:{directQualification:"1-8: Direto s oitavas",playoff:"9-24: Playoffs",eliminated:"25-32: Eliminado"}},Bbe={title:"Competies Sul-Americanas",notQualified:"Voc no est classificado para competies continentais nesta temporada.",qualificationHint:"Termine nas primeiras posies da sua liga para se classificar."},Ube={challengeStart:"Incio do desafio",seasonPosition:"Temporada {{season}}  {{position}} de {{total}}",promotion:"Promoo!",promotionDetail:"De {{from}} para {{to}}",relegation:"Rebaixamento",relegationDetail:"De {{from}} para {{to}}",continentalCompetition:"Competio continental",phaseReached:"Fase alcanada: {{phase}}",trophyWon:"?? {{trophy}}",seasonLabel:"Temporada {{season}}",currentSeason:"Temporada {{season}}  EM ANDAMENTO",currentPosition:"{{position}} de {{total}}",noClassification:"Sem classificao",copaLibertadores:"Copa Libertadores",championsLeague:"Liga dos Campees",winGoal:"?? Ganhar a {{competition}}",accomplished:"CONSEGUIDO!",howManySeasonsQuestion:"Quantas temporadas voc precisar?",roadToGlory:"Caminho para a Glria",startingFrom:"comeando de",currentLeague:"Liga atual",positionOf:"de {{total}}",position:"Posio",trophies:"Trofus",timeline:"Cronologia"},Vbe={weekDate:"Semana {{week}}",preseason:"Pr-temporada",endOfSeason:"Fim Temporada {{season}}",newOfferReceived:" Nova oferta recebida",offerForListedPlayer:" Oferta por jogador  venda",offerExpired:" Oferta expirada",offerCancelled:" Oferta cancelada: {{player}}",transferConfirmed:" Transferncia confirmada",transferComplete:" Transferncia concluda",newYouthPlayer:" Novo jogador da base",loanOfferReceived:" Oferta de emprstimo recebida",leagueChampion:" Campeo da Liga!",playerReceivedOnLoan:" Jogador recebido por emprstimo",purchaseOptionExecuted:" Opo de compra executada",loanAccepted:" Emprstimo aceite",loan:"Emprstimo",treatmentApplied:" Tratamento aplicado",playerRetiredTitle:"Reformou-se: {{player}}",aperturaClausuraFinal:" Final Apertura vs Clausura",cupChampionTitle:"{{icon}} CAMPEO DA {{cup}}!!",offerContent:"{{buyer}} oferece {{amount}} por {{player}}",transferConfirmedContent:"{{player}} ({{position}}, {{overall}}) assina pelo {{toTeam}} vindo do {{fromTeam}} por {{price}}",youthPlayerContent:"A academia ({{spec}}) promoveu {{player}} ({{position}}, {{overall}} OVR, {{age}} anos)",playerRetired:"{{player}} ({{position}}, {{overall}} OVR) retira-se do futebol profissional",offerExpiredContent:"A oferta de {{team}} por {{player}} expirou",playerUnavailableRefund:"{{player}} j no est disponvel. {{amount}} devolvidos",loanOfferContent:"{{team}} quer {{player}} por emprstimo. Taxa: {{fee}}",directChampion:"{{team}} vence Apertura e Clausura e  campeo direto da {{league}}.",aperturaClausuraFinalContent:"A tua equipa jogar a final da {{league}}! {{apertura}} (Apertura) vs {{clausura}} (Clausura).",transferCompleteContent:"{{player}}  novo membro da equipa! Custo: {{cost}}",transferCompleteCounterContent:"{{player}}  novo membro! Contraproposta aceite: {{cost}}",medicalTreatment:"{{player}} recebeu tratamento. Leso reduzida de {{oldWeeks}} para {{newWeeks}} semanas. Custo: {{cost}}",cupChampionContent:"{{team}} venceu a {{cup}}!",playerReceivedOnLoanContent:"{{player}} chega por emprstimo de {{team}}. Taxa: {{fee}}{{option}}",purchaseOptionContent:"{{player}} contratado em definitivo por {{amount}}",startOfSeason:"Incio Temporada {{season}}",newYouthPlayerSon:" Novo jovem: {{player}}",youthSonContent:"Filho de {{parent}}  {{position}}, {{overall}} OVR, potencial {{potential}}",offerExpiredPlayer:" Oferta expirada: {{player}}",offerExpiredRefund:"Sua oferta por {{player}} expirou sem resposta. {{amount}} devolvidos",offerResponse:"{{icon}} Resposta: {{player}}",offerRejectedContent:" Clube: {{clubReason}}   Jogador: {{playerReason}}",counterOfferExpired:" Contra-oferta expirada: {{player}}",counterOfferExpiredContent:"A contra-oferta por {{player}} expirou. {{amount}} devolvidos",saleComplete:" Venda concluda",saleCompleteContent:"Voc vendeu {{player}} para {{team}} por {{amount}}",counterOfferAccepted:" Contra-oferta aceita",counterOfferAcceptedContent:"{{team}} aceita pagar {{amount}} por {{player}}",counterOfferRejected:" Contra-oferta recusada",counterOfferRejectedContent:"{{team}} recusa sua contra-oferta de {{amount}} por {{player}}",europeanIncome:"{{icon}} Receitas europeias",continentalIncome:"{{icon}} Receitas continentais",prizeMoneyContent:"{{competition}}: +{{amount}}",cupByeTitle:"{{icon}} {{cup}}",cupByeContent:"Sua equipe avana diretamente para a prxima fase (isento)",cupFinishedTitle:"{{icon}} {{cup}} encerrada!",cupWonContent:"Sua equipe venceu a {{cup}}!",cupWonByOther:"A {{cup}} foi vencida por {{winner}}",cupMatchResult:"{{icon}} {{cup}}: {{team}} {{playerScore}} - {{rivalScore}} {{rival}}",cupAdvance:"Classificado para a prxima fase!",cupEliminated:"Eliminado da copa",playerLoaned:" Jogador emprestado",playerLoanedContent:"{{player}} emprestado ao {{team}}. Taxa: {{fee}}{{option}}",aperturaClausuraFinalResult:" Final Apertura vs Clausura",aperturaClausuraFinalResultContent:"{{winner}} vence a final da {{league}}. Ida: {{leg1Home}}-{{leg1Away}}, Volta: {{leg2Home}}-{{leg2Away}}.",directChampionShort:"{{winner}}  campeo direto."},zbe={common:ibe,mainMenu:sbe,cup:rbe,office:obe,formation:lbe,plantilla:cbe,transfers:ube,calendar:dbe,matchday:hbe,leagueTable:fbe,finance:pbe,facilities:mbe,stadium:gbe,training:Abe,settings:ybe,sidebar:vbe,teamSelection:_be,contrarreloj:xbe,seasonEnd:bbe,objectives:Sbe,objNames:Tbe,objDescs:wbe,messages:Ebe,renewals:Mbe,competitions:Cbe,ranking:Nbe,notifications:Rbe,positions:Pbe,squad:Ibe,saveSlots:Lbe,contrarrelojSetup:Dbe,mobileNav:kbe,managerFired:Obe,auth:Fbe,europe:jbe,southAmerica:Bbe,contrarrelojProgress:Ube,gameMessages:Vbe},Gbe={save:"Salva",cancel:"Annulla",confirm:"Conferma",accept:"Accetta",close:"Chiudi",back:"Indietro",continue:"Continua",yes:"S",no:"No",loading:"Caricamento...",error:"Errore",warning:"Avviso",success:"Successo",next:"Successivo",previous:"Precedente",edit:"Modifica",delete:"Elimina",add:"Aggiungi",remove:"Rimuovi",select:"Seleziona",search:"Cerca",filter:"Filtra",all:"Tutti",none:"Nessuno",name:"Nome",age:"Et",position:"Posizione",value:"Valore",salary:"Stipendio",contract:"Contratto",team:"Squadra",league:"Campionato",season:"Stagione",week:"Settimana",day:"Giorno",month:"Mese",year:"Anno",money:"Denaro",budget:"Budget",unknown:"Sconosciuto"},qbe={title:"PC GAFFER",subtitle:"",season:"",continueGame:"Continua Partita",play:"Gioca",login:"Accedi",logout:"Esci",loggingOut:"Uscendo...",saveGame:"Salva Partita",contrarreloj:"Contro il Tempo",records:"Record",options:"Opzioni",loadOrCreate:"Carica partita o creane una nuova",saveProgress:"Salva il tuo progresso nel cloud",saveCurrentProgress:"Salva il tuo progresso attuale",reachChampions:"Raggiungi la Champions League dal basso",guestNotice:"Accedi per salvare il tuo progresso nel cloud",tribute:"Il bel gioco, gestito da te",contrarrelojActive:"Contro il Tempo Attivo",newGame:"Nuova Partita",deleteWarning:"?? Iniziare una nuova partita canceller il progresso attuale",playButton:"Gioca",loginButton:"Accedi",saveCurrentGame:"Salva Partita",recordsButton:"Record",optionsButton:"Opzioni"},Hbe={noCupActive:"Nessuna coppa attiva questa stagione",cup:"Coppa",season:"Stagione",champion:"Campione!",cupFinished:"Coppa terminata",eliminatedIn:"Eliminato in",round:"Turno",inCompetition:"In competizione",nextRound:"Prossimo turno",matches:"partite",exempt:"esenti",current:"Attuale"},Wbe={title:"Ufficio",overview:"Panoramica",simulate:"Simula",simulateWeek:"Simula Settimana",simulateSeason:"Simula Stagione",simulateToWindow:"Simula fino alla Finestra",simulating:"Simulando...",seasonInfo:"Stagione {{season}}",weekInfo:"Settimana {{week}}",changeManagerName:"Nome del manager (appare nella classifica):",clickToChangeName:"Clicca per cambiare nome",budget:"Budget",teamValue:"Valore Squadra",stadiumCapacity:"Capacit Stadio",facilities:"Strutture",objectives:"Obiettivi",nextMatch:"Prossima Partita",vs:"VS",home:"Casa",away:"Trasferta",injuredWarning:"Giocatori infortunati in formazione",playersInjured:"Hai {{count}} giocatore{{count, plural, one {} other {i}}} infortunato{{count, plural, one {} other {i}}} nella tua formazione titolare",stillPlay:"Vuoi continuare con la partita?",checkFormation:"Vai alla Formazione e sostituisci i giocatori infortunati prima di continuare.",welcome:"Benvenuto, Allenatore",preseason:"Pre-stagione {{week}}/{{total}}",players:"giocatori",boardConfidence:"Fiducia della dirigenza",friendlyMatch:"Amichevole {{week}}/5",matchday:"Giornata {{week}}",lastResults:"Ultimi Risultati",form_W:"V",form_D:"P",form_L:"S",noMatches:"Nessuna partita giocata",mainObjective:"Obiettivo Principale",viewAllObjectives:"Vedi tutti gli obiettivi",recentMessages:"Messaggi Recenti",weeksOut:"{{weeks}} settimana{{weeks, plural, one {} other {e}}}",goToFormation:"Vai alla Formazione",threeMatches:"3 partite",endOfSeason:"Fine stagione",halfSeason:"Met stagione",winterBanner:"MERCATO INVERNALE  Giornata {{current}} di {{total}}",notEnoughPlayers:"Non hai abbastanza giocatori per formare una squadra",seasonEnd:"Fine Stagione",seasonEndedAfterWeeks:"La stagione  terminata dopo {{weeks}} settimane simulate.",simulatedWeeks:"{{weeks}} settimane simulate",advancedToWeek:"Sei avanzato alla settimana {{week}}",insufficientSquad:"Rosa insufficiente!",onlyHavePlayers:"Hai solo <strong>{{count}} giocatori</strong>. Hai bisogno di un minimo di <strong>11</strong> per giocare.",goToTransfersWarning:"Vai al mercato dei trasferimenti e ingaggia giocatori prima di continuare. Se provi a simulare di nuovo senza avere 11 giocatori, <strong>perderai la partita</strong>.",goToTransfers:"Vai ai Trasferimenti"},$be={title:"Formazione",lineup:"Formazione Titolare",reserves:"Giocatori Convocati",notCalled:"Giocatori Non Convocati",injured:"Infortunati",suspended:"Squalificati",tactic:"Tattica",formation:"Formazione",captain:"Capitano",freekicks:"Punizioni",penalties:"Rigori",corners:"Calci d'Angolo",mentality:"Mentalit",attacking:"Offensiva",balanced:"Equilibrata",defensive:"Difensiva",fitness:"Forma",morale:"Morale",energy:"Energia",experience:"Esperienza",makeReserve:"Rendi Riserva",makeStarter:"Rendi Titolare",makeNotCalled:"Non Convocare",callUp:"Convoca",setCaptain:"Nomina Capitano",setFreekicks:"Batti Punizioni",setPenalties:"Batti Rigori",setCorners:"Batti Calci d'Angolo",years:"anni",statistics:"Statistiche",selectPlayer:"Seleziona Giocatore",tacticAndFormation:"Tattica e Formazione",parameters:"PARAMETRI",rating:"VALUTAZIONE",teamAverage:"MEDIA SQUADRA",playingAs:"giocando come",tacDefensive:"Difensiva",tacDefensiveDesc:"Muro difensivo, poche occasioni",tacDefensiveBonus:"+40% difesa, -40% attacco",tacDefensiveDetail:"Forte vs Equilibrata  Debole vs Possesso e Offensiva",tacBalanced:"Equilibrata",tacBalancedDesc:"Nessuna sorpresa, nessun rischio",tacBalancedBonus:"Nessun modificatore",tacBalancedDetail:"Nessun vantaggio o svantaggio tattico",tacAttacking:"Offensiva",tacAttackingDesc:"Tutto in attacco, rischio alto",tacAttackingBonus:"+35% attacco, -30% difesa",tacAttackingDetail:"Forte vs Difensiva  Debole vs Contro e Pressing",tacPossession:"Possesso",tacPossessionDesc:"Controllare il pallone e stancare",tacPossessionBonus:"+30% possesso, +10% difesa",tacPossessionDetail:"Forte vs Contro  Debole vs Pressing alto",tacCounter:"Contropiede",tacCounterDesc:"Cedere il pallone, colpire in contropiede",tacCounterBonus:"+20% attacco, +15% difesa, -25% possesso",tacCounterDetail:"Forte vs Offensiva e Pressing  Debole vs Possesso",noInjuredPlayers:"Nessun giocatore infortunato",medicalLevel:"Livello centro medico: {{level}}/5",upgradeMedical:"Migliora le strutture per pi trattamenti",statsTeam:"Squadra",statsSeason:"Stagione",statsPlayers:"Giocatori",statsTop:"Top",players:"GIOCATORI",avgOVR:"MEDIA OVR",avgAge:"ET MEDIA",squadValue:"VALORE ROSA",matches:"Partite",wins:"Vittorie",draws:"Pareggi",losses:"Sconfitte",goalsFor:"Gol fatti",goalsAgainst:"Gol subiti",goalDiff:"Differenza",topRated:"Migliori",mostValuable:"Pi preziosi",mostMatches:"Pi partite",noStatsYet:"Nessuna statistica - gioca partite per generare dati",apply:"Applica"},Kbe={title:"Rosa",players:"Giocatori",contracts:"Contratti",salaries:"Stipendi",totalSalary:"Stipendio Totale",averageAge:"Et Media",squadSize:"Dimensione Rosa",putForSale:"Metti in Vendita",renew:"Rinnova",release:"Libera",loan:"Prestito",recall:"Richiama",yearsLeft:"Anni Rimanenti",onLoan:"In Prestito",forSale:"In Vendita",wantToLeave:"Vuole Andarsene",unhappy:"Scontento",player:"GIOCATORE",sortBy:"Ordina per",expired:"Scaduto",oneYear:"{{years}} anno",multipleYears:"{{years}} anni",budget:"Budget",weeklySalary:"Monte stipendi",perYear:"/anno",perWeek:"/sett",ofBudget:"del budget",playersNeedAttention:"{{count}} giocatore/i richiede/ono attenzione",retiring:"Si ritira",wantsToLeaveAlert:"Vuole andarsene",more:"+{{count}} altri",renewPlayer:"Rinnova {{name}}",currentContractLabel:"Contratto attuale",demands:"Richiede",budgetImpact:"Impatto sul budget:",acceptAndRenew:"Accetta e rinnova",sellPlayer:"Metti {{name}} in vendita",marketValue:"Valore di mercato",currentSalary:"Stipendio attuale",ifSold:"Se venduto:",savedSalary:"risparmiati",sellNote:"Il giocatore apparir sul mercato. Altre squadre possono fare offerte.",unlistPlayer:"Ritira {{name}} dalla vendita",unlistQuestion:"Questo giocatore  attualmente nella lista trasferimenti. Vuoi ritirarlo dal mercato?",unlistNote:"Non ricever pi offerte da altre squadre.",confirmUnlist:"S, ritira dalla vendita",releasePlayer:"Libera {{name}}",severanceWarning:"Devi pagare l'indennit per i {{years}} anno/i di contratto rimanenti.",severanceCost:"Indennit da pagare:",salarySaved:"Risparmierai in stipendi:",moraleWarning:"Questo pu influenzare il morale dello spogliatoio",insufficientFunds:"Non hai abbastanza soldi per l'indennit",payAndRelease:"Paga e libera",onLoanTag:"IN PRESTITO",forSaleTag:"In vendita",removeFromSale:"Clicca per ritirare dalla vendita",renewContract:"Rinnova contratto",releasePlayerBtn:"Libera giocatore",loanedBy:"Giocatore in prestito da {{team}}  Non  possibile vendere o liberare",loanedBadge:"In prestito",years:"anni",total:"totale",canRenew:"Pu essere rinnovato",cannotRenew:"Il giocatore non ha bisogno di rinnovo (pi di 2 anni rimanenti)",playerRetiring:"Il giocatore ha annunciato il ritiro"},Ybe={title:"Trasferimenti",explore:"Esplora",scout:"Scout",search:"Cerca",received:"Ricevute",sent:"Inviate",offers:"Offerte",market:"Mercato",available:"Disponibile",notForSale:"Non in vendita",makeOffer:"Fai Offerta",counterOffer:"Controfferta",accept:"Accetta",reject:"Rifiuta",withdraw:"Ritira",negotiate:"Negozia",transferFee:"Commissione di Trasferimento",salary:"Stipendio",duration:"Durata",loan:"Prestito",permanent:"Permanente",windowClosed:"Finestra Trasferimenti Chiusa",windowOpens:"La finestra apre nella settimana",windowCloses:"La finestra chiude nella settimana",noOffers:"Nessuna offerta",scoutingReport:"Rapporto Scout",preseasonOpen:"Pre-campionato  Mercato APERTO",matchdayOpen:"Giornata {{week}}  Mercato APERTO",marketOpen:"Mercato Aperto",preseasonMessage:" pre-campionato. Approfitta per acquistare prima dell'inizio del campionato!",marketAlwaysOpen:"Il mercato  sempre aperto. Acquista, presta e negozia quando vuoi.",totalTransfers:"Trasferimenti Totali",moneyMoved:"Denaro Mosso",activeRumors:"Voci Attive",latestTransfers:"Ultimi Trasferimenti",noRecentTransfers:"Nessun trasferimento recente",marketRumors:"Voci di Mercato",reliable:"{{pct}}% affidabile",noActiveRumors:"Nessuna voce attiva",searchPlayerPlaceholder:"Cerca giocatore per nome...",filters:"Filtri",position:"Posizione",allPositions:"Tutte",goalkeeper:"Portiere",defender:"Difensore",midfielder:"Centrocampista",forward:"Attaccante",ageRange:"Et: {{min}} - {{max}}",minOvr:"OVR minimo: {{value}}",freeOnly:"Solo svincolati",free:"LIBERO",yearsOld:"{{age}} anni",blockedThisSeason:"Bloccato questa stagione",contractExpiring:"Contratto in scadenza",noReceivedOffers:"Nessuna offerta ricevuta",noInterestYet:"Nessun club ha mostrato interesse per i tuoi giocatori... per ora.",pendingTransferOffers:"Offerte di trasferimento in sospeso",transfer:"Trasferimento",pending:"In sospeso",expiresWeek:"Scade sett. {{week}}",askMore:"Chiedere di pi",pendingLoanOffers:"Offerte di prestito in sospeso",loanFee:"Costo del prestito",receiverSalary:"Stipendio ricevente",purchaseOption:"Opzione di acquisto",historyTitle:"Storico",rejected:"Rifiutata",noOffersOrLoans:"Nessuna offerta o prestito",noActiveOffersMsg:"Non hai offerte attive n prestiti. Cerca giocatori per rinforzare la tua squadra!",transferOffers:"Offerte di trasferimento",clear:"Cancella",perYear:"/anno",weekShort:"Sett. {{week}}",pendingResponse:"In attesa di risposta  simula una partita",club:"Club",accepts:"Accetta",playerLabel:"Giocatore",transferComplete:"Trasferimento completato!",clubAsks:"Il club chiede {{amount}}",acceptCounter:"Accettare controfferta",playerRejectedCantComplete:"Il giocatore ha rifiutato, non si pu completare",deleteBtn:"Elimina",offerRejected:"Offerta rifiutata",loanedOutPlayers:"Giocatori in prestito",loanedOut:"In prestito",weeksShort:"{{weeks}} sett.",atTeam:"A {{team}}",purchaseOptionAmount:"Opzione di acquisto: {{amount}}",loanedInPlayers:"Giocatori in prestito",onLoan:"In prestito",ownedBy:"Di propriet di {{team}}",buyAmount:"Acquista ({{amount}})",newsFeed:"Feed Notizie",noRecentNews:"Nessuna notizia recente",europe:"Europa",southAmerica:"Sud America",restOfWorld:"Resto del Mondo",leaguesMeta:"{{count}} campionato{{plural}}  {{teams}} squadre",nTeams:"{{count}} squadre",searchTeamPlaceholder:"Cerca squadra...",playersAvgOvr:"{{count}} giocatori  Media {{avg}}",yourTeam:"La tua squadra",posHeader:"POS",playerHeader:"GIOCATORE",ageHeader:"ET",ovrHeader:"OVR",valueHeader:"VALORE",levelBadge:"Liv. {{level}}",searchPositionLabel:"Posizione da cercare:",analyzingMarket:"Analisi del mercato...",searchPlayers:"Cerca giocatori",searchSpecific:"Cerca {{pos}}",playersFound:"{{count}} giocatori trovati",tickerDefault:"Mercato trasferimenti attivo | Resta aggiornato",breakingNews:"ULTIMA ORA",loanExclamation:"PRESTITO!",transferExclamation:"TRASFERIMENTO!",seasonLabel:"Stagione",nYears:"{{count}} anni",totalWord:"totale",close:"Chiudi",transferFailed:"TRASFERIMENTO FALLITO",blockedUntilNextSeason:"Non potrai negoziare con questo giocatore fino alla prossima stagione",freeAgent:"SVINCOLATO",ageLabel:"Et",valueLabel:"Valore",salaryLabel:"Stipendio",contractLabel:"Contratto",noContract:"Senza contratto",professional:"Professionista",difficultyLabel:"Difficolt",tierDropWarning:"Scende di {{count}} livello{{plural}}",freeAgentLabel:"Svincolato",signing:"Acquisto",loanToggle:"Prestito",preContractToggle:"Pre-contratto",requestLoan:"Richiedere Prestito",negotiatingStatus:"In trattativa...",acceptedStatus:"Accettata",rejectedBadge:"Rifiutata",salaryPercentLabel:"% stipendio che pago",salaryPayHint:"Pagheresti {{amount}}/anno dello stipendio",loanDenied:"{{team}} non accetta di prestare {{player}}. {{reasons}}",noPurchaseOption:"Nessuna opzione di acquisto",noOption:"Senza opzione",valuePercent90:"90% valore",valuePercent100:"100% valore",estimatedProbability:"Probabilit stimata",insufficientBudget:"Budget insufficiente ({{amount}})",sendLoanRequest:"Invia richiesta di prestito",waitingClubResponse:"In attesa della risposta del club...",prepareOffer:"Preparare Offerta",directRival:"Rivale diretto",transferToClub:"Trasferimento al club",clubAccepts:"Club accetta",annualSalary:"Stipendio annuale",minEstimated:"Minimo stimato: {{amount}}/anno",contractDuration:"Durata contratto",playerAccepts:"Giocatore accetta",totalTransferCost:"Costo totale trasferimento",totalContractCost:"Costo totale contratto",totalInvestment:"Investimento totale",sendOffer:"Invia offerta",offerHint:"La risposta arriver dopo la simulazione di una partita. L'importo viene riservato dal tuo budget.",freeAgentNegotiation:"Trattativa Svincolato",preContractSection:"Pre-contratto",acceptedPlayerStatus:"Accettato",rejectedPlayerStatus:"Rifiutato",counterOfferStatus:"Controfferta",freeAgentInfo:"Non serve negoziare con nessun club. Negozia direttamente con il giocatore offrendo un bonus alla firma e uno stipendio.",preContractBadge:"PRE-CONTRATTO",preContractInfo:"Il suo contratto scade presto. Puoi negoziare direttamente senza pagare un trasferimento. Si unir alla tua squadra alla fine del contratto.",signingBonus:"Bonus alla firma",suggested:"Suggerito: {{amount}}",totalCostFormatted:"Costo totale: {{amount}} ({{years}} anno{{plural}})",acceptanceProbability:"Probabilit di accettazione",playerCounterLabel:"Controfferta del giocatore:",counterTotalCost:"Costo totale: {{amount}}",totalCostLabel:"Costo totale",presentOffer:"Presentare offerta",offerPreContract:"Offrire pre-contratto",playerEvaluating:"Il giocatore sta valutando la tua offerta...",noAgreementReached:"Non si  raggiunto un accordo con il giocatore",insufficientSalaryOffer:"L'offerta salariale  insufficiente",expectsHigherBonus:"Si aspetta un bonus alla firma pi alto",teamLevelNotConvincing:"Il livello della squadra non lo convince",overallOfferNotConvincing:"L'offerta complessiva non lo convince",needsMoreMoney:"Ha bisogno di pi soldi per compensare il livello del club",wantsFinancialImprovement:"Vuole un miglioramento economico per accettare il trasferimento",freeAgentSigned:"Svincolato acquistato",preContractSigned:"Pre-contratto firmato",playerJoined:"{{name}}  un nuovo giocatore. Bonus: {{bonus}}, Stipendio: {{salary}}/anno",offerSentTitle:"Offerta inviata",offerSentContent:"Offerta per {{name}} ({{team}}): {{amount}} + {{salary}}/anno",playerRejectedDefinitely:"Il giocatore ha rifiutato definitivamente",loanNotPossible:"Prestito non possibile",cannotLoan:"Non si pu prestare",insufficientForLoanFee:"Hai bisogno di {{amount}} per il costo del prestito",insufficientBudgetTitle:"Budget insufficiente",cannotExecute:"Non si pu eseguire",noLoanPurchaseOption:"Questo prestito non ha opzione di acquisto",insufficientBudgetShort:"Budget insufficiente",europeTab:"Europa",continentalTab:"Continentale",accepted:"Accettata",age:"Et",contract:"Contratto",difficulty:"Difficolt",freeAgentsOnly:"Solo svincolati",history:"Storico",level:"Lv.",loanBadge:"Prestito",loanSuccess:"PRESTITO!",negotiating:"Trattativa...",noOffersReceived:"Nessuna offerta ricevuta",noSentOffers:"Nessuna offerta o prestito",noSentOffersDesc:"Non hai offerte attive. Cerca giocatori per rinforzare la squadra!",persProfessional:"Professionista",playerValue:"Valore",posAll:"Tutte",posDEF:"Difensore",posFWD:"Attaccante",posGK:"Portiere",positionToSearch:"Posizione da cercare",posMID:"Centrocampista",preseasonMsg:"Siamo in precampionato. Acquista prima dell'inizio della lega!",purchaseOptionLabel:"Opzione di riscatto",recentTransfers:"Ultimi Trasferimenti",responseAfterMatch:"La risposta arriver dopo la simulazione di una partita.",searchPlaceholder:"Cerca giocatore...",season:"Stagione",signingFailed:"ACQUISTO FALLITO",signingSuccess:"ACQUISTO!",tickerMsg:"Calciomercato attivo",transferBadge:"Trasferimento",transferCompleted:"Acquisto completato!",value:"valore",wantsHigherBonus:"Vuole un premio alla firma pi alto",year:"anno",years:"anni",veryEasy:"Molto Facile",easy:"Facile",normal:"Normale",hard:"Difficile",veryHard:"Molto Difficile",almostImpossible:"Quasi Impossibile",persAmbitious:"Ambizioso",persLoyal:"Leale",persMercenary:"Mercenario",persHomesick:"Familiare",persAdventurous:"Avventuroso",persDescAmbitious:"Vuole giocare nei migliori club",persDescLoyal:"Difficile che lasci il club",persDescMercenary:"Solo i soldi contano",persDescHomesick:"Preferisce stare vicino a casa",persDescProfessional:"Valuta tutto con equilibrio",persDescAdventurous:"Ama cambiare aria"},Xbe={title:"Calendario",fixtures:"Partite",results:"Risultati",matchday:"Giornata",date:"Data",time:"Ora",home:"Casa",away:"Trasferta",score:"Punteggio",competition:"Competizione",venue:"Stadio",european:"Europeo",southAmerican:"Sudamericano",cup:"Coppa",week:"Settimana",noEuropeanMatches:"Nessuna partita europea in questa giornata",noSouthAmericanMatches:"Nessuna partita sudamericana in questa giornata",noCupMatches:"Nessuna partita di coppa in questo turno"},Qbe={title:"Giorno della Partita",kickoff:"Calcio d'Inizio",fulltime:"Fine Partita",halftime:"Primo Tempo",goal:"Gol!",assist:"Assist",yellowCard:"Cartellino Giallo",redCard:"Cartellino Rosso",substitution:"Sostituzione",injury:"Infortunio",minute:"Min",attendance:"Spettatori",possession:"Possesso",shots:"Tiri",shotsOnTarget:"Tiri in Porta",corners:"Calci d'Angolo",fouls:"Falli",offsides:"Fuorigioco",golazo:"CHE GOL!",lateGoal:"Gol al recupero!",finalResult:"Risultato Finale",skipToEnd:"Salta alla fine"},Jbe={title:"Classifica",position:"Pos",team:"Squadra",played:"G",won:"V",drawn:"P",lost:"S",goalsFor:"GF",goalsAgainst:"GS",goalDifference:"DR",points:"Pti",form:"Forma",next:"Prossimo",last5:"Ultimi 5",champion:"Campione",championQualification:"Qualificazione Champions",europaQualification:"Qualificazione Europa",conferenceQualification:"Qualificazione Conference",relegation:"Retrocessione",playoff:"Playoff",championsLeague:"Continental Champions Cup",libertadores:"Copa Libertadores",europaLeague:"Continental Shield",sudamericana:"Copa Sudamericana",conferenceLeague:"Continental Trophy",promotion:"Promozione diretta",playoffPromotion:"Playoff promozione",apertura:"Apertura",clausura:"Clausura",acumulada:"Accumulata",inProgress:"in corso",searchLeague:"Cerca campionato...",yourLeague:"Il tuo campionato",noData:"Nessun dato disponibile per questo campionato.",noDataHint:"I dati verranno generati man mano che la stagione avanza.",group:"Girone",championLabel:"Campione",firstLeg:"Andata",secondLeg:"Ritorno",bothTournamentsChampion:"campione di entrambi i tornei",formW:"V",formD:"P",formL:"S",showAllTeams:"Mostra tutte le squadre ({{count}})",showLess:"Mostra meno",countries:{spain:"Spagna",england:"Inghilterra",italy:"Italia",germany:"Germania",france:"Francia",restOfEurope:"Resto d'Europa",southAmerica:"Sud America"}},Zbe={title:"Finanze",income:"Entrate",expenses:"Spese",balance:"Bilancio",profit:"Profitto",loss:"Perdita",ticketSales:"Vendite Biglietti",transfers:"Trasferimenti",sponsorship:"Sponsorizzazione",merchandise:"Merchandising",salaries:"Stipendi",maintenance:"Manutenzione",other:"Altri",bank:"Banca",currentBudget:"Budget attuale",currentSeason:"Stagione Attuale",seasonTickets:"Abbonati (incasso fine stagione)",pending:"in attesa",noCampaignClosed:"Nessuna campagna chiusa",ticketsSold:"Biglietti venduti",accumulatedMatches:"Partite giocate accumulate",stadiumNaming:"Naming dello stadio",playerSales:"Vendite di giocatori",prizesRewards:"Premi e ricompense",squadSalaries:"Stipendi squadra (fine stagione)",stadiumMaintenance:"Manutenzione stadio",signings:"Acquisti",seasonBalance:"Bilancio stagione"},e2e={title:"Strutture",subtitle:"Migliora il tuo club per competere ai massimi livelli",training:"Allenamento",youth:"Giovanili",medical:{infirmary:"Infermeria",doctors:"Medici",available:"disponibili",heals:"Cura",weeks:"settimane",weeksShort:"sett",weeksSingular:"a",weeksPlural:"e",cost:"Costo",noInjured:"Nessun giocatore infortunato",inTreatment:"In cura",noMedicalCenter:"Nessun centro medico",noDoctorsAvailable:"Nessun medico disponibile",reduceTo:"Riduci a"},level:"Livello",upgrade:"Migliora",upgraded:"migliorato",cost:"Costo",benefit:"Beneficio",upgrading:"Migliorando",completed:"Completato",incomePerSeason:"Entrate/stagione",nextLevel:"Livello successivo",maxLevel:"Livello Max",specialization:"Specializzazione",notChosen:"Non scelto",choose:"Scegli",chooseSpecDesc:"Scegli la specializzazione (sar bloccata fino alla prossima stagione)",ignore:"Ignora",categories:{income:"Entrate",development:"Sviluppo",support:"Supporto"},stadium:{name:"Stadio",description:"Capacit e fattore casa"},impact:{title:"Impatto delle tue strutture",youth:"Giovani giocatori",treatments:"Trattamenti",weeksSaved:"Settimane risparmiate"},facilityNames:{stadium:"Stadio",sponsorship:"Commerciale",youth:"Settore Giovanile",medical:"Centro Medico",scouting:"Scouting"},facilityDescs:{stadium:"Capienza e fattore campo",sponsorship:"Entrate da sponsor",youth:"Genera giovani talenti",medical:"Riduce i tempi di infortunio",scouting:"Riduce i costi di trasferimento"},levelNames:{municipal:"Comunale",modern:"Moderno",large:"Grande",elite:"Elite",legendary:"Leggendario",basic:"Base",active:"Attivo",professional:"Professionale",premium:"Premium",developed:"Sviluppato",advanced:"Avanzato",improved:"Migliorato",local:"Locale",national:"Nazionale",european:"Europeo",worldwide:"Mondiale"},benefits:{seats:"{{count}} posti",youthPlayer:"1 giovane/stagione ({{range}})",standardRecovery:"Recupero standard",injuryReduction:"-{{percent}}% infortuni  {{treatments}} trattamento/i",noTransferAdvantage:"Nessun vantaggio nei trasferimenti",transferDiscount:"-{{percent}}% costo trasferimenti"}},t2e={title:"Stadio",capacity:"Capacit",expand:"Espandi",maintenance:"Manutenzione",condition:"Condizione",excellent:"Eccellente",good:"Buono",poor:"Scarso",terrible:"Terribile",view3dNotAvailable:"Vista 3D non disponibile",loadingStadium:"Caricamento stadio...",general:"Generale",sponsorship:"Sponsorizzazione",events:{friendly:"Amichevole",concert:"Concerto",corporate:"Evento Aziendale",legends:"Partita delle Leggende"},seasonTicketCampaign:"Campagna Abbonamenti",campaignOpen:"Campagna aperta fino alla giornata {{deadline}} (attuale: {{current}})",seasonTicketPrice:"Prezzo abbonamento:",pricePerMatch:"{{matches}} partite ? {{pricePerMatch}}/partita",expectedSubscribers:"Abbonati previsti:",maxShort:"max",closeCampaign:"Chiudere campagna e fissare abbonati",campaignClosed:"Campagna chiusa",subscribers:"abbonati",pricePerTicket:"prezzo/biglietto",collected:"incassato",ofCapacitySubscribed:"{{percent}}% della capacit abbonata",ticketPrice:"Prezzo Biglietto",priceLocked:"Prezzo fissato per questa stagione. Solo per non abbonati.",setPriceBeforeLeague:"Prezzo per partita per non abbonati. Fissare prima dell'inizio del campionato.",accumulatedTicketIncome:"Incassi biglietti accumulati",onlyTicketsSold:"Solo biglietti venduti (senza abbonati). Incassato a fine stagione.",lastHomeMatchday:"Ultima giornata casalinga",ticketsSold:"Biglietti venduti",totalAttendance:"Presenze totali",ticketIncome:"Incassi biglietti",grassCondition:"Condizione del Prato",optimal:"Ottimale",injuryRisk:"Rischio infortuni +{{percent}}%",recovers:"Recupera +5%/settimana",perfectCondition:"In perfette condizioni",poorGrassWarning:"Le cattive condizioni aumentano gli infortuni dei TUOI giocatori",repairGrass:"Riparare prato ({{cost}})",currentSponsor:"Sponsor Attuale",yearsRemaining:"{{years}} anni rimanenti",cancelContract:"Cancella contratto",penalty:"Penalit: {{amount}}",namingOffers:"Offerte di Naming",sellStadiumName:"Vendi il nome dello stadio per entrate annuali",upgradeForSponsors:"Migliora il tuo stadio per attirare sponsor",organizeEvents:"Organizzare Eventi",generateExtraIncome:"Generare entrate extra (richiede 2 settimane tra eventi)",waitMoreWeeks:"Aspetta {{weeks}} settimana/e in pi",grassDamage:"Danno prato: -{{percent}}%",organize:"Organizza",repairGrassBeforeEvents:"Ripara il prato prima di organizzare eventi",homeAdvantage:"Fattore casa",occupation:"Occupazione",grass:"Prato",budget:"Budget",stadium:"Stadio",accept:"Accetta",perYear:"/anno",years:"anni",seasonTicketsClosed:"Campagna abbonamenti chiusa",seasonTicketsMessage:"{{count}} abbonati  {{price}} = {{total}} (sar incassato a fine stagione)",namingRights:"Diritti di Naming",namingMessage:"Accordo con {{sponsor}}: {{amount}}M/anno per {{duration}} anni",sponsorshipCancelled:"Sponsorizzazione cancellata",stadiumNameRestored:"Lo stadio recupera il suo nome originale. Penalit pagata: {{amount}}M",stadiumNameRestoredFree:"Lo stadio recupera il suo nome originale",eventHosted:"Evento realizzato. Incassi: {{amount}}K",stadiumUpgraded:"Stadio ampliato",nowStadium:"Ora  {{name}} con {{capacity}} posti",seats:"posti",insufficientFunds:"Fondi insufficienti",penaltyRequired:"Hai bisogno di {{amount}}M per pagare la penalit di cancellazione del contratto."},n2e={title:"Allenamento",fitness:"Forma Fisica",tactics:"Tattica",technical:"Tecnica",intensity:"Intensit",low:"Bassa",medium:"Media",high:"Alta"},a2e={title:"Impostazioni",language:"Lingua",graphics:"Grafica",sound:"Suono",gameplay:"Gameplay",difficulty:"Difficolt",easy:"Facile",normal:"Normale",hard:"Difficile",animations:"Animazioni",notifications:"Notifiche",autosave:"Salvataggio Automatico",general:"Generale",autosaveLabel:"Salvataggio automatico",autosaveDesc:"Salva automaticamente ogni 5 minuti",volume:"Volume",music:"Musica",effects:"Effetti",gameData:"Dati del Gioco",saveAndExit:"Salva ed esci",deleteAndReset:"Elimina dati e riavvia",deleteConfirm:"Eliminare tutti i dati?",deleteMessage:"Questa azione eliminer la tua partita salvata e non pu essere annullata.",appTitle:"PC Gaffer",appVersion:"Versione 1.0.0",appTribute:"L'arte del management",difficultyEasyDesc:"IA meno aggressiva, pi soldi iniziali",difficultyNormalDesc:"Esperienza equilibrata",difficultyHardDesc:"IA molto competitiva, meno risorse",speedSlow:"Lenta",speedSlowDesc:"Pi tempo per guardare le partite",speedNormalDesc:"Velocit standard",speedFast:"Veloce",speedFastDesc:"Partite pi brevi",yesDeleteAll:"S, cancella tutto"},i2e={office:"Ufficio",formation:"Formazione",squad:"Rosa",transfers:"Trasferimenti",calendar:"Calendario",table:"Classifica",finance:"Finanze",stadium:"Stadio",facilities:"Strutture",training:"Allenamento",objectives:"Obiettivi",competitions:"Competizioni",messages:"Messaggi",bank:"Banca",options:"Opzioni",mainMenu:"Menu Principale"},s2e={teamsAvailable:"{{count}} squadre disponibili",comingSoon:"Prossimamente",groupsAndTeams:"{{groups}} gruppi  {{teams}} squadre",teamsCount:"{{count}} squadra{{count, plural, one {} other {e}}}",selectGroup:"Seleziona un gruppo",searchTeam:"Cerca squadra...",stadium:"Stadio",municipal:"Municipale",capacity:"Capacit",reputation:"Reputazione",presentation:"Presentazione",startSeason:"Inizia Stagione"},r2e={title:"Modalit Contro il Tempo",setup:"Configurazione",start:"Inizia",objective:"Obiettivo: Raggiungi la Champions League dal basso",rules:"Regole",progress:"Progresso",timeElapsed:"Tempo Trascorso",seasonsPlayed:"Stagioni Giocate",currentLeague:"Campionato Attuale",trophies:"Trofei",completed:"Completato!",failed:"Fallito",activated:"Contro il Tempo attivato!",objectiveMessage:"Obiettivo: vincere la {{competition}} con {{team}} nel minor numero di stagioni. Il tempo scorre!",southAmericanCup:"South American Champions Cup",continentalCup:"Continental Champions Cup"},o2e={title:"Fine Stagione",summary:"Riassunto",achievements:"Risultati",statistics:"Statistiche",topScorer:"Capocannoniere",bestPlayer:"Miglior Giocatore",nextSeason:"Prossima Stagione",finalTitle:"Finale",league:"Lega",aperturaVsClausura:"Apertura vs Clausura",firstLeg:"Andata",secondLeg:"Ritorno",result:"Risultato",byAggregate:"per risultato complessivo",byAwayGoals:"per gol in trasferta",byClausuraAdvantage:"per vantaggio sportivo (campione del Clausura)",sameChampion:"campione di entrambi i tornei",playoffAscenso:"Playoff di Promozione",semifinals:"Semifinali",final:"FINALE!",victory:"Vittoria!",defeat:"Sconfitta",extraTime:"Tempi Supplementari",penalties:"Rigori",champion:"CAMPIONE!",runner:"Finalista",promotion:"PROMOZIONE!",relegation:"Retrocessione",eliminated:"La squadra  stata eliminata dal playoff",ascends:"SALE IN SERIE SUPERIORE!",playoffCompleted:"Playoff completato",playoffWinner:"Vincitore playoff",seasonSummary:"Riassunto stagione",finalPosition:"Posizione Finale",points:"Punti",wins:"Vittorie",draws:"Pareggi",losses:"Sconfitte",goalDifference:"Diff. Reti",qualifiedFor:"Qualificato per",qualificationBonus:"Bonus qualificazione",objectives:"Obiettivi",objectiveBalance:"Bilancio obiettivi",europeanBonus:"Bonus europeo",continue:"Continua",playMatch:"Gioca partita",nextMatch:"Prossima partita",homeGame:"Giochiamo in casa",awayGame:"Giochiamo fuori casa"},l2e={title:"Obiettivi",current:"Attuali",completed:"Completati",failed:"Falliti",primary:"Primario",secondary:"Secondario",bonus:"Bonus",leaguePosition:"Posizione in Classifica",cupProgress:"Progresso in Coppa",budget:"Budget",youngPlayers:"Giocatori Giovani",critical:"Critico",high:"Principale",medium:"Secondario",low:"Opzionale",objective:"Obiettivo",onTrack:"Sulla Strada",atRisk:"A Rischio",danger:"Pericolo",pending:"In Attesa",goalDifference:"Diff. reti",objectivesAtRisk:"obiettiv{{ count === 1 ? 'o' : 'i' }}",atRiskWarning:"a rischio. Rivedi la tua strategia per evitare penalit.",all:"Tutti",inProgress:"In Corso",criticalObjectives:"Obiettivi Critici",seasonObjectives:"Obiettivi Stagionali",noObjectives:"Nessun obiettivo definito",objectivesWillGenerate:"Gli obiettivi stagionali verranno generati all'inizio del campionato.",boardExpects:"La dirigenza si aspetta"},c2e={championsQualification:"Qualificazione Champions",europeanQualification:"Qualificazione europea",topHalf:"Prima met classifica",avoidRelegation:"Evitare la retrocessione",promotion:"Promozione",titleContender:"Lottare per il titolo",goalDifference:"Differenza reti positiva",financialStability:"Stabilit finanziaria",youthDevelopment:"Sviluppo del vivaio"},u2e={championsQualification:"Finire tra i primi 4 per qualificarsi alla Continental Champions Cup",europeanQualification:"Finire tra i primi 6 per qualificarsi a una competizione europea",topHalf:"Finire nella prima met della classifica",avoidRelegation:"Mantenere la categoria finendo fuori dalla zona retrocessione",promotion:"Ottenere la promozione nella divisione superiore",titleContender:"Finire tra i primi 2",goalDifference:"Chiudere la stagione con pi gol fatti che subiti",financialStability:"Non chiudere la stagione in rosso",youthDevelopment:"Dare minuti ai giovani del settore giovanile"},d2e={title:"Messaggi",inbox:"Posta in arrivo",unread:"Non Letti",all:"Tutti",transfers:"Trasferimenti",injuries:"Infortuni",contracts:"Contratti",objectives:"Obiettivi",markAsRead:"Segna come Letto",deleteAll:"Elimina tutti",deleteAllConfirm:"Eliminare tutti i messaggi?",noMessages:"Non hai messaggi",backToMessages:"Torna ai messaggi",deleteMessage:"Elimina messaggio"},h2e={title:"Rinnovi",contractExpiring:"Contratto in Scadenza",wantsToRenew:"Vuole Rinnovare",rejectRenewal:"Rifiuta Rinnovo",demandIncrease:"Richiede Aumento",offer:"Offerta",playerDemands:"Richieste Giocatore",currentContract:"Contratto Attuale",newContract:"Nuovo Contratto"},f2e={title:"Competizioni",domestic:"Nazionali",european:"Europee",international:"Internazionali",league:"Campionato",cup:"Coppa",champions:"Champions League",europa:"Europa League",conference:"Conference League",europeTab:"Europa",continentalTab:"Continentale",europe:"Europa",continental:"Continentale"},p2e={title:"Classifica",contrarreloj:"Contro il Tempo",position:"Posizione",manager:"Allenatore",team:"Squadra",time:"Tempo",trophies:"Trofei",noRecords:"Nessun record ancora",records:"RECORD",subtitle:"Modalit Contro il Tempo  Tempi Migliori",clear:"Cancella",confirmClear:"Eliminare tutti i record? Questa azione non pu essere annullata.",loading:"Caricamento classifica...",noRecordsDesc:"Completa la modalit Contro il Tempo per apparire nella classifica.",playContrarreloj:"Gioca Contro il Tempo",player:"Giocatore",score:"Punteggio",seasons:"Stagioni",competition:"Competizione",date:"Data"},m2e={title:"Notifiche",clear:"Cancella",settings:"Impostazioni",matchResult:"Risultato Partita",transfer:"Trasferimento",injury:"Infortunio",contract:"Contratto",objective:"Obiettivo"},g2e={POR:"POR",DFC:"DC",LD:"TD",LI:"TS",CRD:"EDD",CRI:"EDS",MCD:"MDI",MC:"CC",MCO:"TRQ",MD:"ED",MI:"ES",ED:"AD",EI:"AS",DC:"ATT",SD:"PUN"},A2e={goalkeeper:"Portiere",defender:"Difensore",midfielder:"Centrocampista",forward:"Attaccante",gkShort:"POR",defShort:"DIF",midShort:"CEN",fwdShort:"ATT",backToSquad:"Torna alla rosa",injuredWeeks:"Infortunato  {{weeks}} settimana/e fuori",speed:"Velocit",technique:"Tecnica",passing:"Passaggio",shooting:"Tiro",defense:"Difesa",physical:"Fisico",number:"Numero",myTeam:"La Mia Squadra",average:"Media"},y2e={back:"Indietro",loadGame:"Carica Partita",saveGame:"Salva Partita",manageGames:"Gestisci Partite",selectOrCreate:"Seleziona una partita salvata o creane una nuova",chooseSlot:"Scegli uno slot per salvare i tuoi progressi",manageSlots:"Gestisci le tue partite salvate",slot:"Slot",emptySlot:"Slot vuoto",newGame:"Nuova Partita",saving:"Salvando...",saveHere:"Salva qui",unknownTeam:"Squadra sconosciuta",loading:"Caricamento...",load:"Carica",overwrite:"Sovrascrivere?",deleteGame:"Eliminare partita?",loadingGames:"Caricamento partite...",never:"Mai",errorLoadGames:"Errore nel caricamento delle partite",errorLoadGame:"Errore nel caricamento della partita",errorSaveGame:"Errore nel salvataggio della partita",errorDeleteGame:"Errore nell'eliminazione della partita"},v2e={menu:"Menu",title:"CORSA CONTRO IL TEMPO",subtitle:"Riesci a raggiungere la vetta del calcio europeo/sudamericano?",objective:"Obiettivo",winChampions:"Vincere la Champions League o Copa Libertadores",losesIf:"Perdi se",fired:"Vieni licenziato o il budget diventa negativo",ranking:"Classifica",fewestSeasons:"Il minor numero di stagioni vince",chooseChallenge:"Scegli la tua sfida",newTeams:"Nuove squadre",ovr:"COM",goal:"Obiettivo:",libertadores:"?? Copa Libertadores",championsLeague:"?? Champions League",starting:"Iniziando...",acceptChallenge:"ACCETTA LA SFIDA!"},_2e={home:"Casa",competitions:"Comp.",more:"Altro",advance:"Avanza",menu:"Menu"},x2e={title:"LICENZIATO",defaultReason:"Il consiglio di amministrazione ha deciso di sollevarti dai tuoi doveri di allenatore.",balance:"Bilancio",confidence:"Fiducia del consiglio",backToMenu:"Torna al Menu Principale",bankruptReason:"La dirigenza ti ha licenziato per aver portato il club alla bancarotta."},b2e={accountCreated:"Account creato! Controlla la tua email per verificare il tuo account.",passwordResetSent:"Email di recupero password inviata. Controlla la tua posta in arrivo.",verificationResent:"Email di verifica reinviata",emailNotVerified:"Email non ancora verificata. Controlla la tua posta in arrivo.",verifyEmail:"Verifica la tua email",verificationSent:"Abbiamo inviato un'email di verifica a:",clickLinkToActivate:"Clicca sul link nell'email per attivare il tuo account.",checking:"Verificando...",alreadyVerified:"L'ho gi verificata",resendEmail:"Reinvia email",login:"Accedi",createAccount:"Crea Account",resetPassword:"Recupera Password",continueWithGoogle:"Continua con Google",enterAsGuest:"Entra come Ospite (Test)",orUseEmail:"o usa la tua email",username:"Nome utente",usernamePlaceholder:"Il tuo nome nel gioco",email:"Email",emailPlaceholder:"tua@email.it",password:"Password",enter:"Entra",sendEmail:"Invia email",forgotPassword:"Password dimenticata?",noAccount:"Non hai un account? Registrati",haveAccount:"Hai gi un account? Accedi",backToLogin:"Torna al login",enterUsername:"Inserisci un nome utente"},S2e={title:"Competizioni Europee",notQualified:"Non sei qualificato per le competizioni europee questa stagione.",qualificationHint:"Finisci nelle prime posizioni del tuo campionato per qualificarti.",selectCompetition:"Seleziona una competizione",prizes:"Premi: {{amount}}",eliminated:"Eliminato",standings:"Classifica  Fase a Gironi",matchday:"Giornata {{current}}/{{total}}",knockoutPhase:"Fase Eliminazione  {{phase}}",championTitle:"{{competition}}  Campione!",finalScore:"Finale: {{score}}",recentResults:"Risultati Recenti",pendingDraw:"In attesa del sorteggio...",aggregate:"Agg: {{score}}",phases:{league:"Fase a Gironi",playoff:"Playoff",r16:"Ottavi di Finale",qf:"Quarti di Finale",sf:"Semifinali",final:"Finale",completed:"Competizione Finita",r16Short:"Ottavi",qfShort:"Quarti",sfShort:"Semifinali"},legend:{directQualification:"1-8: Diretti agli ottavi",playoff:"9-24: Playoff",eliminated:"25-32: Eliminato"}},T2e={title:"Competizioni Sudamericane",notQualified:"Non sei qualificato per le competizioni continentali questa stagione.",qualificationHint:"Finisci nelle prime posizioni del tuo campionato per qualificarti."},w2e={challengeStart:"Inizio della sfida",seasonPosition:"Stagione {{season}}  {{position}} di {{total}}",promotion:"Promozione!",promotionDetail:"Da {{from}} a {{to}}",relegation:"Retrocessione",relegationDetail:"Da {{from}} a {{to}}",continentalCompetition:"Competizione continentale",phaseReached:"Fase raggiunta: {{phase}}",trophyWon:"?? {{trophy}}",seasonLabel:"Stagione {{season}}",currentSeason:"Stagione {{season}}  IN CORSO",currentPosition:"{{position}} di {{total}}",noClassification:"Nessuna classifica",copaLibertadores:"Copa Libertadores",championsLeague:"Continental Champions Cup",winGoal:"?? Vincere la {{competition}}",accomplished:"COMPLETATO!",howManySeasonsQuestion:"Quante stagioni ti serviranno?",roadToGlory:"Strada verso la Gloria",startingFrom:"iniziando da",currentLeague:"Campionato attuale",positionOf:"di {{total}}",position:"Posizione",trophies:"Trofei",timeline:"Cronologia"},E2e={weekDate:"Settimana {{week}}",preseason:"Pre-stagione",endOfSeason:"Fine Stagione {{season}}",newOfferReceived:" Nuova offerta ricevuta",offerForListedPlayer:" Offerta per giocatore in vendita",offerExpired:" Offerta scaduta",offerCancelled:" Offerta annullata: {{player}}",transferConfirmed:" Trasferimento confermato",transferComplete:" Trasferimento completato",newYouthPlayer:" Nuovo giovane",loanOfferReceived:" Offerta di prestito ricevuta",leagueChampion:" Campione di Lega!",playerReceivedOnLoan:" Giocatore ricevuto in prestito",purchaseOptionExecuted:" Opzione d'acquisto eseguita",loanAccepted:" Prestito accettato",loan:"Prestito",treatmentApplied:" Trattamento applicato",playerRetiredTitle:"Si ritira: {{player}}",aperturaClausuraFinal:" Finale Apertura vs Clausura",cupChampionTitle:"{{icon}} CAMPIONE DELLA {{cup}}!!",offerContent:"{{buyer}} offre {{amount}} per {{player}}",transferConfirmedContent:"{{player}} ({{position}}, {{overall}}) firma per {{toTeam}} da {{fromTeam}} per {{price}}",youthPlayerContent:"L'accademia ({{spec}}) ha promosso {{player}} ({{position}}, {{overall}} OVR, {{age}} anni)",playerRetired:"{{player}} ({{position}}, {{overall}} OVR) si ritira dal calcio professionistico",offerExpiredContent:"L'offerta di {{team}} per {{player}}  scaduta",playerUnavailableRefund:"{{player}} non  pi disponibile. {{amount}} rimborsati",loanOfferContent:"{{team}} vuole {{player}} in prestito. Costo: {{fee}}",directChampion:"{{team}} vince Apertura e Clausura ed  campione diretto della {{league}}.",aperturaClausuraFinalContent:"La tua squadra giocher la finale della {{league}}! {{apertura}} (Apertura) vs {{clausura}} (Clausura).",transferCompleteContent:"{{player}}  un nuovo membro della squadra! Costo: {{cost}}",transferCompleteCounterContent:"{{player}}  un nuovo membro! Controproposta accettata: {{cost}}",medicalTreatment:"{{player}} ha ricevuto cure. Infortunio ridotto da {{oldWeeks}} a {{newWeeks}} settimane. Costo: {{cost}}",cupChampionContent:"{{team}} ha vinto la {{cup}}!",playerReceivedOnLoanContent:"{{player}} arriva in prestito da {{team}}. Costo: {{fee}}{{option}}",purchaseOptionContent:"{{player}} acquistato a titolo definitivo per {{amount}}",startOfSeason:"Inizio Stagione {{season}}",newYouthPlayerSon:" Nuovo giovane: {{player}}",youthSonContent:"Figlio di {{parent}}  {{position}}, {{overall}} OVR, potenziale {{potential}}",offerExpiredPlayer:" Offerta scaduta: {{player}}",offerExpiredRefund:"La tua offerta per {{player}}  scaduta senza risposta. {{amount}} rimborsati",offerResponse:"{{icon}} Risposta: {{player}}",offerRejectedContent:" Club: {{clubReason}}   Giocatore: {{playerReason}}",counterOfferExpired:" Controfferta scaduta: {{player}}",counterOfferExpiredContent:"La controfferta per {{player}}  scaduta. {{amount}} rimborsati",saleComplete:" Vendita completata",saleCompleteContent:"Hai venduto {{player}} al {{team}} per {{amount}}",counterOfferAccepted:" Controfferta accettata",counterOfferAcceptedContent:"{{team}} accetta di pagare {{amount}} per {{player}}",counterOfferRejected:" Controfferta rifiutata",counterOfferRejectedContent:"{{team}} rifiuta la tua controfferta di {{amount}} per {{player}}",europeanIncome:"{{icon}} Entrate europee",continentalIncome:"{{icon}} Entrate continentali",prizeMoneyContent:"{{competition}}: +{{amount}}",cupByeTitle:"{{icon}} {{cup}}",cupByeContent:"La tua squadra passa direttamente al turno successivo (esentata)",cupFinishedTitle:"{{icon}} {{cup}} terminata!",cupWonContent:"La tua squadra ha vinto la {{cup}}!",cupWonByOther:"La {{cup}}  stata vinta da {{winner}}",cupMatchResult:"{{icon}} {{cup}}: {{team}} {{playerScore}} - {{rivalScore}} {{rival}}",cupAdvance:"Qualificato per il turno successivo!",cupEliminated:"Eliminato dalla coppa",playerLoaned:" Giocatore ceduto in prestito",playerLoanedContent:"{{player}} ceduto in prestito al {{team}}. Costo: {{fee}}{{option}}",aperturaClausuraFinalResult:" Finale Apertura vs Clausura",aperturaClausuraFinalResultContent:"{{winner}} vince la finale della {{league}}. Andata: {{leg1Home}}-{{leg1Away}}, Ritorno: {{leg2Home}}-{{leg2Away}}.",directChampionShort:"{{winner}}  campione diretto."},M2e={common:Gbe,mainMenu:qbe,cup:Hbe,office:Wbe,formation:$be,plantilla:Kbe,transfers:Ybe,calendar:Xbe,matchday:Qbe,leagueTable:Jbe,finance:Zbe,facilities:e2e,stadium:t2e,training:n2e,settings:a2e,sidebar:i2e,teamSelection:s2e,contrarreloj:r2e,seasonEnd:o2e,objectives:l2e,objNames:c2e,objDescs:u2e,messages:d2e,renewals:h2e,competitions:f2e,ranking:p2e,notifications:m2e,positions:g2e,squad:A2e,saveSlots:y2e,contrarrelojSetup:v2e,mobileNav:_2e,managerFired:x2e,auth:b2e,europe:S2e,southAmerica:T2e,contrarrelojProgress:w2e,gameMessages:E2e},C2e={es:{translation:qve},en:{translation:L_e},fr:{translation:yxe},de:{translation:abe},pt:{translation:zbe},it:{translation:M2e}},IZ=["es","en","fr","de","pt","it"];function N2e(){const e=(navigator.language||navigator.userLanguage||"es").split("-")[0].toLowerCase();return IZ.includes(e)?e:"es"}const R2e=localStorage.getItem("language")||N2e();Fo.use($1e).init({resources:C2e,lng:R2e,fallbackLng:"es",interpolation:{escapeValue:!1},debug:!1,returnNull:!1,returnEmptyString:!1,updateMissing:!1});Fo.on("languageChanged",a=>{localStorage.setItem("language",a),h1e(a)});async function P2e(){const a=await f1e();a&&IZ.includes(a)&&Fo.changeLanguage(a)}const LZ=ge.createContext();function I2e({children:a}){const[e,n]=ge.useState(null),[i,s]=ge.useState(!0),[r,o]=ge.useState(null);ge.useEffect(()=>{d1e().catch(()=>{});const N=wZ(async I=>{n(I),s(!1),I&&await P2e()});return()=>N()},[]);const l=async(N,I)=>{o(null);try{return await bZ(N,I)}catch(F){throw o(iv(F.code)),F}},c=async()=>{o(null);try{return await SZ()}catch(N){throw console.error("Google login error:",N),o(N.code?iv(N.code):N.message||"Error con Google Sign-In"),N}},u=async()=>{o(null);try{const N=await g1e.signInWithPlayGames(),I={uid:`playgames_${N.playerId}`,displayName:N.displayName||"Jugador",email:null,emailVerified:!0,photoURL:N.iconImageUrl||null,isPlayGames:!0,playerId:N.playerId};return n(I),I}catch(N){throw o(N.message||"Error al conectar con Google Play Games"),N}},h=async(N,I,F)=>{o(null);try{return await xZ(N,I,F)}catch(G){throw console.error("Register error:",G),o(G.code?iv(G.code):G.message||"Error al registrar"),G}},f=async()=>{if(o(null),e?.isGuest){n(null);return}try{await TZ()}catch(N){throw o(iv(N.code)),N}},m=async N=>{o(null);try{await c1e(N)}catch(I){throw o(iv(I.code)),I}},A=async()=>{o(null);try{await u1e()}catch(N){throw o(iv(N.code)),N}},x=async()=>{const N=await p1e();return N&&n({...N}),N?.emailVerified||!1},T=()=>{const N={uid:"guest_"+Date.now(),email:"invitado@pruebas.local",displayName:"Invitado",emailVerified:!0,isGuest:!0};return n(N),N},E=()=>o(null),M={user:e,loading:i,error:r,isAuthenticated:!!e,isEmailVerified:e?.emailVerified||!1,isGuest:e?.isGuest||!1,isPlayGames:e?.isPlayGames||!1,isAndroid:kh(),login:l,loginGoogle:c,loginPlayGames:u,loginAsGuest:T,register:h,logout:f,sendPasswordReset:m,resendVerification:A,checkEmailVerified:x,clearError:E};return d.jsx(LZ.Provider,{value:M,children:a})}function Mc(){const a=ge.useContext(LZ);if(!a)throw new Error("useAuth must be used within an AuthProvider");return a}function iv(a){return{"auth/email-already-in-use":"Este email ya est registrado","auth/invalid-email":"Email invlido","auth/operation-not-allowed":"Operacin no permitida","auth/weak-password":"La contrasea debe tener al menos 6 caracteres","auth/user-disabled":"Esta cuenta ha sido deshabilitada","auth/user-not-found":"No existe una cuenta con este email","auth/wrong-password":"Contrasea incorrecta","auth/invalid-credential":"Credenciales invlidas","auth/too-many-requests":"Demasiados intentos. Espera un momento","auth/popup-closed-by-user":"Ventana cerrada. Intntalo de nuevo","auth/network-request-failed":"Error de conexin. Comprueba tu internet"}[a]||`Error: ${a||"desconocido"}`}const L2e=ge.createContext();function D2e({children:a}){const[e,n]=ge.useState(!cN()),[i,s]=ge.useState(null),[r,o]=ge.useState(0);return ge.useEffect(()=>{if(cN()){n(!1);return}async function l(){try{o(10);const c=await HAe();o(100),c||s("Error cargando datos del juego"),n(!1)}catch(c){s(c.message),n(!1)}}l()},[]),e?d.jsxs("div",{className:"pcf-loading-screen",children:[d.jsxs("div",{className:"loading-content",children:[d.jsx("div",{className:"loading-logo",children:""}),d.jsx("h1",{children:"PC GAFFER"}),d.jsx("div",{className:"loading-bar",children:d.jsx("div",{className:"loading-progress",style:{width:`${r}%`}})}),d.jsx("p",{className:"loading-text",children:"Cargando datos de equipos..."})]}),d.jsx("style",{children:`
          .pcf-loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #0a1628 0%, #1a2744 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-family: system-ui, -apple-system, sans-serif;
          }
          .loading-content {
            text-align: center;
          }
          .loading-logo {
            font-size: 64px;
            margin-bottom: 16px;
            animation: bounce 1s ease infinite;
          }
          @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
          }
          .loading-content h1 {
            font-size: 36px;
            margin: 0;
            background: linear-gradient(90deg, #00d4ff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
          }
          .loading-content > p {
            color: #00d4ff;
            letter-spacing: 4px;
            font-size: 14px;
            margin: 8px 0 32px;
          }
          .loading-bar {
            width: 300px;
            height: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 2px;
            overflow: hidden;
            margin: 0 auto;
          }
          .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, #00d4ff, #00ff88);
            transition: width 0.3s ease;
          }
          .loading-text {
            margin-top: 16px;
            color: rgba(255,255,255,0.6);
            font-size: 14px;
          }
        `})]}):i?d.jsxs("div",{className:"pcf-error-screen",children:[d.jsxs("div",{className:"error-content",children:[d.jsx("div",{className:"error-icon",children:""}),d.jsx("h1",{children:"Error de conexin"}),d.jsx("p",{children:i}),d.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]}),d.jsx("style",{children:`
          .pcf-error-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #1a0a0a 0%, #2a1414 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-family: system-ui, -apple-system, sans-serif;
          }
          .error-content {
            text-align: center;
          }
          .error-icon {
            font-size: 64px;
            margin-bottom: 16px;
          }
          .error-content h1 {
            color: #ff4444;
          }
          .error-content button {
            margin-top: 20px;
            padding: 12px 24px;
            background: #ff4444;
            border: none;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
          }
          .error-content button:hover {
            background: #ff6666;
          }
        `})]}):d.jsx(L2e.Provider,{value:{loaded:!0},children:a})}const DZ=(...a)=>a.filter((e,n,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===n).join(" ").trim();const k2e=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const O2e=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,i)=>i?i.toUpperCase():n.toLowerCase());const Eq=a=>{const e=O2e(a);return e.charAt(0).toUpperCase()+e.slice(1)};var F2e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const j2e=a=>{for(const e in a)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const B2e=ge.forwardRef(({color:a="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:s="",children:r,iconNode:o,...l},c)=>ge.createElement("svg",{ref:c,...F2e,width:e,height:e,stroke:a,strokeWidth:i?Number(n)*24/Number(e):n,className:DZ("lucide",s),...!r&&!j2e(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,h])=>ge.createElement(u,h)),...Array.isArray(r)?r:[r]]));const nn=(a,e)=>{const n=ge.forwardRef(({className:i,...s},r)=>ge.createElement(B2e,{ref:r,iconNode:e,className:DZ(`lucide-${k2e(Eq(a))}`,`lucide-${a}`,i),...s}));return n.displayName=Eq(a),n};const U2e=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],V2e=nn("activity",U2e);const z2e=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],kZ=nn("arrow-left-right",z2e);const G2e=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],s1=nn("arrow-left",G2e);const q2e=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],jS=nn("arrow-right",q2e);const H2e=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Ay=nn("award",H2e);const W2e=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],xP=nn("ban",W2e);const $2e=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],OF=nn("bell",$2e);const K2e=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],gu=nn("briefcase",K2e);const Y2e=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Ol=nn("building-2",Y2e);const X2e=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],Q2e=nn("building",X2e);const J2e=[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h.01",key:"1bh4kh"}],["path",{d:"M12 4h.01",key:"1ujb9j"}],["path",{d:"M17 4h.01",key:"1upcoc"}]],Z2e=nn("cake",J2e);const eSe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],tSe=nn("calendar-days",eSe);const nSe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],pm=nn("calendar",nSe);const aSe=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],v_=nn("chart-column",aSe);const iSe=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],sSe=nn("chart-no-axes-column",iSe);const rSe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],uo=nn("check",rSe);const oSe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],S0=nn("chevron-down",oSe);const lSe=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],OZ=nn("chevron-left",lSe);const cSe=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],_r=nn("chevron-right",cSe);const uSe=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],jT=nn("chevron-up",uSe);const dSe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Mq=nn("circle-alert",dSe);const hSe=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],yN=nn("circle-check-big",hSe);const fSe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],rS=nn("circle-check",fSe);const pSe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 18V6",key:"zqpxq5"}]],Cq=nn("circle-dollar-sign",pSe);const mSe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],gSe=nn("circle-plus",mSe);const ASe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],kd=nn("circle-x",ASe);const ySe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Yp=nn("circle",ySe);const vSe=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],yy=nn("clipboard-list",vSe);const _Se=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],or=nn("clock",_Se);const xSe=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],ju=nn("coins",xSe);const bSe=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],FZ=nn("crown",bSe);const SSe=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],mm=nn("dollar-sign",SSe);const TSe=[["path",{d:"M17.596 12.768a2 2 0 1 0 2.829-2.829l-1.768-1.767a2 2 0 0 0 2.828-2.829l-2.828-2.828a2 2 0 0 0-2.829 2.828l-1.767-1.768a2 2 0 1 0-2.829 2.829z",key:"9m4mmf"}],["path",{d:"m2.5 21.5 1.4-1.4",key:"17g3f0"}],["path",{d:"m20.1 3.9 1.4-1.4",key:"1qn309"}],["path",{d:"M5.343 21.485a2 2 0 1 0 2.829-2.828l1.767 1.768a2 2 0 1 0 2.829-2.829l-6.364-6.364a2 2 0 1 0-2.829 2.829l1.768 1.767a2 2 0 0 0-2.828 2.829z",key:"1t2c92"}],["path",{d:"m9.6 14.4 4.8-4.8",key:"6umqxw"}]],wSe=nn("dumbbell",TSe);const ESe=[["path",{d:"M12 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 12 18z",key:"b19h5q"}],["path",{d:"M2 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 2 18z",key:"h7h5ge"}]],jZ=nn("fast-forward",ESe);const MSe=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],FF=nn("file-text",MSe);const CSe=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],BZ=nn("flag",CSe);const NSe=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],vN=nn("flame",NSe);const RSe=[["path",{d:"M10.3 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.98a2 2 0 0 1 1.69.9l.66 1.2A2 2 0 0 0 12 6h8a2 2 0 0 1 2 2v3.3",key:"128dxu"}],["path",{d:"m14.305 19.53.923-.382",key:"3m78fa"}],["path",{d:"m15.228 16.852-.923-.383",key:"npixar"}],["path",{d:"m16.852 15.228-.383-.923",key:"5xggr7"}],["path",{d:"m16.852 20.772-.383.924",key:"dpfhf9"}],["path",{d:"m19.148 15.228.383-.923",key:"1reyyz"}],["path",{d:"m19.53 21.696-.382-.924",key:"1goivc"}],["path",{d:"m20.772 16.852.924-.383",key:"htqkph"}],["path",{d:"m20.772 19.148.924.383",key:"9w9pjp"}],["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}]],PSe=nn("folder-cog",RSe);const ISe=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],LSe=nn("folder-open",ISe);const DSe=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ak=nn("funnel",DSe);const kSe=[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]],jF=nn("gamepad-2",kSe);const OSe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],dc=nn("globe",OSe);const FSe=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],BS=nn("handshake",FSe);const jSe=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],su=nn("heart-pulse",jSe);const BSe=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],BF=nn("heart",BSe);const USe=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],qh=nn("house",USe);const VSe=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],zSe=nn("inbox",VSe);const GSe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],_N=nn("info",GSe);const qSe=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],HSe=nn("key",qSe);const WSe=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],UF=nn("landmark",WSe);const $Se=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],KSe=nn("lightbulb",$Se);const YSe=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],XSe=nn("loader",YSe);const QSe=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],vy=nn("lock",QSe);const JSe=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],ZSe=nn("log-in",JSe);const eTe=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],VF=nn("log-out",eTe);const tTe=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],_y=nn("mail",tTe);const nTe=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],aTe=nn("map-pin",nTe);const iTe=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],sTe=nn("map",iTe);const rTe=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],xN=nn("medal",rTe);const oTe=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],lTe=nn("megaphone",oTe);const cTe=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],uTe=nn("menu",cTe);const dTe=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],yk=nn("mic",dTe);const hTe=[["path",{d:"M5 12h14",key:"1ays0h"}]],fTe=nn("minus",hTe);const pTe=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],mTe=nn("music",pTe);const gTe=[["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2",key:"39pd36"}],["rect",{width:"8",height:"4",x:"10",y:"6",rx:"1",key:"aywv1n"}]],bN=nn("newspaper",gTe);const ATe=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],yD=nn("pen-tool",ATe);const yTe=[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]],k2=nn("plane",yTe);const vTe=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],SN=nn("play",vTe);const _Te=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],__=nn("refresh-cw",_Te);const xTe=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Nq=nn("save",xTe);const bTe=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],UZ=nn("scale",bTe);const STe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],T0=nn("search",STe);const TTe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],BT=nn("settings",TTe);const wTe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Rq=nn("shield-alert",wTe);const ETe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],x_=nn("shield",ETe);const MTe=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],zF=nn("skip-forward",MTe);const CTe=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],jg=nn("sparkles",CTe);const NTe=[["path",{d:"M14 9.536V7a4 4 0 0 1 4-4h1.5a.5.5 0 0 1 .5.5V5a4 4 0 0 1-4 4 4 4 0 0 0-4 4c0 2 1 3 1 5a5 5 0 0 1-1 3",key:"139s4v"}],["path",{d:"M4 9a5 5 0 0 1 8 4 5 5 0 0 1-8-4",key:"1dlkgp"}],["path",{d:"M5 21h14",key:"11awu3"}]],GF=nn("sprout",NTe);const RTe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],sc=nn("square",RTe);const PTe=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Br=nn("star",PTe);const ITe=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],Pq=nn("stethoscope",ITe);const LTe=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]],ef=nn("swords",LTe);const DTe=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],Iq=nn("syringe",DTe);const kTe=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],O2=nn("tag",kTe);const OTe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Fs=nn("target",OTe);const FTe=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],WC=nn("ticket",FTe);const jTe=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],tf=nn("timer",jTe);const BTe=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],UT=nn("trash-2",BTe);const UTe=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],VT=nn("trending-down",UTe);const VTe=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],dl=nn("trending-up",VTe);const zTe=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],wr=nn("triangle-alert",zTe);const GTe=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Ai=nn("trophy",GTe);const qTe=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],$C=nn("user-check",qTe);const HTe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],FE=nn("user-minus",HTe);const WTe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],vk=nn("user-x",WTe);const $Te=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],KTe=nn("user",$Te);const YTe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Hu=nn("users",YTe);const XTe=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],QTe=nn("volume-2",XTe);const JTe=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],_k=nn("wallet",JTe);const ZTe=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],ewe=nn("wifi-off",ZTe);const twe=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],zT=nn("wrench",twe);const nwe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],zr=nn("x",nwe);const awe=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],ru=nn("zap",awe),VZ=ge.createContext();function iwe(){const a=ge.useContext(VZ);if(!a)throw new Error("useToast must be used within ToastProvider");return a}function swe({children:a}){const[e,n]=ge.useState([]),i=ge.useCallback((r,o="success",l=3e3)=>{const c=Date.now();n(u=>[...u,{id:c,message:r,type:o}]),setTimeout(()=>{n(u=>u.filter(h=>h.id!==c))},l)},[]),s={success:(r,o)=>i(r,"success",o),error:(r,o)=>i(r,"error",o),info:(r,o)=>i(r,"info",o),warning:(r,o)=>i(r,"warning",o)};return d.jsxs(VZ.Provider,{value:s,children:[a,d.jsx("div",{className:"toast-container",children:e.map(r=>d.jsxs("div",{className:`toast toast--${r.type}`,children:[d.jsxs("span",{className:"toast__icon",children:[r.type==="success"&&d.jsx(uo,{size:14}),r.type==="error"&&d.jsx(zr,{size:14}),r.type==="info"&&d.jsx(_N,{size:14}),r.type==="warning"&&d.jsx(wr,{size:14})]}),d.jsx("span",{className:"toast__message",children:r.message})]},r.id))})]})}class rwe extends p8.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){this.setState({errorInfo:n}),console.error("ErrorBoundary caught:",e,n),n?.componentStack&&this.setState({componentStack:n.componentStack})}handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};handleReset=()=>{try{localStorage.removeItem("pcfutbol_saveId"),localStorage.removeItem("pcfutbol_local_save"),localStorage.removeItem("pcfutbol_pending_slot")}catch{}window.location.reload()};render(){return this.state.hasError?d.jsx("div",{style:{position:"fixed",inset:0,background:"linear-gradient(135deg, #1a0a0a 0%, #2a1414 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontFamily:"system-ui, -apple-system, sans-serif",padding:"20px"},children:d.jsxs("div",{style:{textAlign:"center",maxWidth:500},children:[d.jsx("div",{style:{fontSize:64,marginBottom:16},children:""}),d.jsx("h1",{style:{color:"#ff4444",margin:"0 0 12px"},children:"Algo sali mal"}),d.jsx("p",{style:{color:"rgba(255,255,255,0.7)",marginBottom:24},children:"Ha ocurrido un error inesperado. Puedes intentar reintentar o reiniciar la app."}),this.state.error&&d.jsxs("pre",{style:{background:"rgba(255,0,0,0.1)",padding:12,borderRadius:8,fontSize:11,textAlign:"left",overflow:"auto",maxHeight:200,marginBottom:24,color:"#ff8888",wordBreak:"break-all"},children:[this.state.error.toString(),this.state.componentStack&&`

Component Stack:`+this.state.componentStack.slice(0,500)]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[d.jsx("button",{onClick:this.handleRetry,style:{padding:"12px 24px",background:"#ff4444",border:"none",color:"white",borderRadius:8,cursor:"pointer",fontSize:16},children:"Reintentar"}),d.jsx("button",{onClick:this.handleReset,style:{padding:"12px 24px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:8,cursor:"pointer",fontSize:16},children:"Reiniciar App"})]})]})}):this.props.children}}function Lo({size:a=24,className:e="",style:n={},strokeWidth:i=2,...s}){return d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:i,strokeLinecap:"round",strokeLinejoin:"round",className:e,style:n,...s,children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("polygon",{points:"12,7 15.09,9.18 13.9,12.82 10.1,12.82 8.91,9.18"}),d.jsx("line",{x1:"12",y1:"7",x2:"12",y2:"2.5"}),d.jsx("line",{x1:"15.09",y1:"9.18",x2:"19.8",y2:"7.2"}),d.jsx("line",{x1:"13.9",y1:"12.82",x2:"18.5",y2:"16"}),d.jsx("line",{x1:"10.1",y1:"12.82",x2:"5.5",y2:"16"}),d.jsx("line",{x1:"8.91",y1:"9.18",x2:"4.2",y2:"7.2"})]})}const Lq={injury:{priority:"critical",icon:su,color:"#ff453a",duration:5e3,labelKey:"notifications.injury"},board:{priority:"critical",icon:UF,color:"#ff453a",duration:5e3,labelKey:"notifications.board"},fired:{priority:"critical",icon:Rq,color:"#ff453a",duration:6e3,labelKey:"notifications.fired"},bankruptcy:{priority:"critical",icon:wr,color:"#ff453a",duration:6e3,labelKey:"notifications.bankruptcy"},yellow:{priority:"important",icon:wr,color:"#ffcc00",duration:3500,labelKey:"notifications.yellow"},red:{priority:"critical",icon:Rq,color:"#ff453a",duration:4e3,labelKey:"notifications.red"},transfer_offer:{priority:"important",icon:_y,color:"#ff9f0a",duration:4e3,labelKey:"notifications.transferOffer"},transfer:{priority:"important",icon:gu,color:"#0a84ff",duration:4e3,labelKey:"notifications.transfer"},loan:{priority:"important",icon:BS,color:"#bf5af2",duration:4e3,labelKey:"notifications.loan"},contract:{priority:"important",icon:FF,color:"#ff9f0a",duration:4e3,labelKey:"notifications.contract"},match_result:{priority:"important",icon:Lo,color:"#30d158",duration:3500,labelKey:"notifications.matchResult"},cup:{priority:"important",icon:Ai,color:"#ffd60a",duration:4e3,labelKey:"notifications.cup"},european:{priority:"important",icon:Br,color:"#0a84ff",duration:4e3,labelKey:"notifications.european"},southamerican:{priority:"important",icon:Br,color:"#30d158",duration:4e3,labelKey:"notifications.southamerican"},retirement:{priority:"important",icon:Hu,color:"#8e8e93",duration:4e3,labelKey:"notifications.retirement"},offer:{priority:"important",icon:mm,color:"#30d158",duration:4e3,labelKey:"notifications.offer"},training:{priority:"info",icon:dl,color:"#30d158",duration:3e3,labelKey:"notifications.training"},youth:{priority:"info",icon:ru,color:"#bf5af2",duration:3500,labelKey:"notifications.youth"},medical:{priority:"info",icon:su,color:"#30d158",duration:3e3,labelKey:"notifications.medical"},facility:{priority:"info",icon:dl,color:"#0a84ff",duration:3e3,labelKey:"notifications.facility"},news:{priority:"info",icon:bN,color:"#8e8e93",duration:3e3,labelKey:"notifications.news"},default:{priority:"info",icon:_y,color:"#8e8e93",duration:3e3,labelKey:"notifications.default"}},Dq={critical:0,important:1,info:2},jE=3,kq=5;function xk(a,e){const n=Lq[a]||Lq.default;return{...n,label:e(n.labelKey)}}function owe(a,e){if(a.titleKey){const n={...a.titleParams};return n&&Object.keys(n).forEach(i=>{if(i.endsWith("Key")&&typeof n[i]=="string"&&!i.endsWith("KeyParams")){const s=i.slice(0,-3);n[s]=e(n[i],n[`${i}Params`])}}),e(a.titleKey,n)}return a.title}function lwe(a,e){if(a.contentKey){const n={...a.contentParams};return n&&Object.keys(n).forEach(i=>{if(i.endsWith("Key")&&typeof n[i]=="string"&&!i.endsWith("KeyParams")){const s=i.slice(0,-3);n[s]=e(n[i],n[`${i}Params`])}}),e(a.contentKey,n)}return a.content}function cwe({notification:a,onDismiss:e,index:n,t:i}){const[s,r]=ge.useState(!1),o=xk(a.type,i),l=o.icon,c=ge.useRef(null);ge.useEffect(()=>(c.current=setTimeout(()=>{r(!0),setTimeout(()=>e(a.id),300)},o.duration),()=>clearTimeout(c.current)),[a.id,o.duration,e]);const u=()=>{clearTimeout(c.current),r(!0),setTimeout(()=>e(a.id),300)},h=ge.useRef(null),f=A=>{h.current=A.touches[0].clientX},m=A=>{if(h.current===null)return;const x=A.changedTouches[0].clientX-h.current;Math.abs(x)>80&&u(),h.current=null};return d.jsxs("div",{className:`notif-toast notif-toast--${o.priority} ${s?"notif-toast--exit":""}`,style:{"--notif-color":o.color,"--index":n},onClick:u,onTouchStart:f,onTouchEnd:m,children:[d.jsx("div",{className:"notif-toast__icon",children:typeof l=="function"&&l.$$typeof?d.jsx(l,{size:16}):d.jsx(l,{size:16})}),d.jsxs("div",{className:"notif-toast__content",children:[d.jsx("span",{className:"notif-toast__label",children:o.label}),d.jsx("span",{className:"notif-toast__title",children:owe(a,i)}),(a.content||a.contentKey)&&d.jsx("span",{className:"notif-toast__body",children:lwe(a,i)})]}),d.jsx("button",{className:"notif-toast__close",onClick:A=>{A.stopPropagation(),u()},children:d.jsx(zr,{size:14})})]})}function uwe({count:a,onDismiss:e,t:n}){const[i,s]=ge.useState(!1);return ge.useEffect(()=>{const r=setTimeout(()=>{s(!0),setTimeout(e,300)},4e3);return()=>clearTimeout(r)},[e]),d.jsxs("div",{className:`notif-toast notif-toast--overflow ${i?"notif-toast--exit":""}`,onClick:e,children:[d.jsx("div",{className:"notif-toast__icon",style:{"--notif-color":"#8e8e93"},children:d.jsx(S0,{size:16})}),d.jsxs("div",{className:"notif-toast__content",children:[d.jsx("span",{className:"notif-toast__title",children:n("notifications.moreNotifications",{count:a})}),d.jsx("span",{className:"notif-toast__body",children:n("notifications.checkInbox")})]})]})}function dwe(){const{t:a}=Sa(),{state:e}=Va(),[n,i]=ge.useState([]),[s,r]=ge.useState(0),o=ge.useRef(e.messages||[]),l=ge.useRef(new Set),c=ge.useCallback(h=>{i(f=>f.filter(m=>m.id!==h))},[]),u=ge.useCallback(()=>{r(0)},[]);return ge.useEffect(()=>{const h=o.current,f=e.messages||[];if(f===h)return;const m=new Set(h.map(x=>x.id)),A=f.filter(x=>!m.has(x.id)&&!l.current.has(x.id));if(A.length>0){const x=[...A].sort((I,F)=>{const G=Dq[xk(I.type,a).priority]??2,O=Dq[xk(F.type,a).priority]??2;return G-O}),T=x.slice(0,kq),E=x.length-kq,M=T.slice(0,jE),N=T.length-jE+Math.max(0,E);A.forEach(I=>l.current.add(I.id)),M.forEach((I,F)=>{setTimeout(()=>{i(G=>{const O=[...G,I];return O.length>jE?O.slice(-jE):O})},F*200)}),N>0&&setTimeout(()=>{r(N)},M.length*200+300)}o.current=f},[e.messages]),ge.useEffect(()=>{const h=setInterval(()=>{if(l.current.size>200){const f=Array.from(l.current);l.current=new Set(f.slice(-100))}},6e4);return()=>clearInterval(h)},[]),n.length===0&&s===0?null:d.jsxs("div",{className:"notification-center",children:[n.map((h,f)=>d.jsx(cwe,{notification:h,onDismiss:c,index:f,t:a},h.id)),s>0&&d.jsx(uwe,{count:s,onDismiss:u,t:a})]})}function qF({onClose:a}){const{t:e,i18n:n}=Sa(),{state:i,dispatch:s,saveGame:r}=Va(),[o,l]=ge.useState(i.settings||{difficulty:"normal",matchSpeed:"normal",autoSave:!0,showTutorials:!0,soundEnabled:!0,musicVolume:70,sfxVolume:80}),[c,u]=ge.useState(!1),[h,f]=ge.useState(null),m=(M,N)=>{const I={...o,[M]:N};l(I),s({type:"UPDATE_SETTINGS",payload:{[M]:N}})},A=M=>{n.changeLanguage(M)},x=async()=>{f("saving");try{await r(),f("saved"),setTimeout(()=>{s({type:"SET_SCREEN",payload:"main_menu"})},500)}catch{f("error"),setTimeout(()=>f(null),3e3)}},T=()=>{s({type:"RESET_GAME"}),u(!1),a?.()},E=[{code:"es",name:"Espaol",flag:""},{code:"en",name:"English",flag:""},{code:"fr",name:"Franais",flag:""},{code:"de",name:"Deutsch",flag:""},{code:"pt",name:"Portugus",flag:""},{code:"it",name:"Italiano",flag:""}];return e("settings.easy"),e("settings.difficultyEasyDesc"),e("settings.normal"),e("settings.difficultyNormalDesc"),e("settings.hard"),e("settings.difficultyHardDesc"),e("settings.speedSlow"),e("settings.speedSlowDesc"),e("settings.normal"),e("settings.speedNormalDesc"),e("settings.speedFast"),e("settings.speedFastDesc"),d.jsxs("div",{className:"settings",children:[d.jsxs("div",{className:"settings__header",children:[d.jsxs("h2",{children:[d.jsx(BT,{size:16})," ",e("settings.title")]}),a&&d.jsx("button",{className:"settings__close",onClick:a,children:d.jsx(zr,{size:16})})]}),d.jsxs("div",{className:"settings__content",children:[d.jsxs("section",{className:"settings__section",children:[d.jsxs("h3",{children:[d.jsx(dc,{size:16})," ",e("settings.language")]}),d.jsx("div",{className:"settings__language-grid",children:E.map(M=>d.jsxs("button",{className:`settings__language-card ${n.language===M.code?"active":""}`,onClick:()=>A(M.code),children:[d.jsx("span",{className:"flag",children:M.flag}),d.jsx("span",{className:"name",children:M.name})]},M.code))})]}),d.jsxs("section",{className:"settings__section",children:[d.jsx("h3",{children:e("settings.general")}),d.jsx("div",{className:"settings__toggles",children:d.jsxs("div",{className:"settings__toggle-item",children:[d.jsxs("div",{className:"info",children:[d.jsx("span",{className:"label",children:e("settings.autosaveLabel")}),d.jsx("span",{className:"desc",children:e("settings.autosaveDesc")})]}),d.jsx("button",{className:`settings__toggle ${o.autoSave?"active":""}`,onClick:()=>m("autoSave",!o.autoSave),children:d.jsx("span",{className:"toggle-knob"})})]})})]}),d.jsxs("section",{className:"settings__section",children:[d.jsx("h3",{children:e("settings.volume")}),d.jsxs("div",{className:"settings__sliders",children:[d.jsxs("div",{className:"settings__slider-item",children:[d.jsxs("div",{className:"slider-header",children:[d.jsxs("span",{className:"label",children:[d.jsx(mTe,{size:14})," ",e("settings.music")]}),d.jsxs("span",{className:"value",children:[o.musicVolume,"%"]})]}),d.jsx("input",{type:"range",min:"0",max:"100",value:o.musicVolume,onChange:M=>m("musicVolume",parseInt(M.target.value))})]}),d.jsxs("div",{className:"settings__slider-item",children:[d.jsxs("div",{className:"slider-header",children:[d.jsxs("span",{className:"label",children:[d.jsx(QTe,{size:14})," ",e("settings.effects")]}),d.jsxs("span",{className:"value",children:[o.sfxVolume,"%"]})]}),d.jsx("input",{type:"range",min:"0",max:"100",value:o.sfxVolume,onChange:M=>m("sfxVolume",parseInt(M.target.value))})]})]})]}),d.jsxs("section",{className:"settings__section",children:[d.jsx("h3",{children:e("settings.gameData")}),d.jsxs("div",{className:"settings__actions",children:[i.gameStarted&&d.jsxs("button",{className:`settings__action-btn exit ${h==="saving"?"disabled":""}`,onClick:x,disabled:h==="saving",children:[d.jsx(VF,{size:14})," ",e("settings.saveAndExit")]}),d.jsxs("button",{className:"settings__action-btn danger",onClick:()=>u(!0),children:[d.jsx(UT,{size:14})," ",e("settings.deleteAndReset")]})]})]}),d.jsx("section",{className:"settings__section settings__section--info",children:d.jsxs("div",{className:"settings__game-info",children:[d.jsx("p",{className:"title",children:e("settings.appTitle")}),d.jsx("p",{className:"version",children:e("settings.appVersion")}),d.jsx("p",{className:"credits",children:e("settings.appTribute")})]})})]}),c&&d.jsx("div",{className:"settings__modal-overlay",onClick:()=>u(!1),children:d.jsxs("div",{className:"settings__modal",onClick:M=>M.stopPropagation(),children:[d.jsx("div",{className:"modal-icon",children:d.jsx(wr,{size:22})}),d.jsx("h3",{children:e("settings.deleteConfirm")}),d.jsx("p",{children:e("settings.deleteMessage")}),d.jsxs("div",{className:"modal-actions",children:[d.jsx("button",{className:"cancel",onClick:()=>u(!1),children:e("common.cancel")}),d.jsx("button",{className:"confirm",onClick:T,children:e("settings.yesDeleteAll")})]})]})})]})}function hwe({onBack:a}){const{t:e}=Sa(),[n,i]=ge.useState("login"),[s,r]=ge.useState(""),[o,l]=ge.useState(""),[c,u]=ge.useState(""),[h,f]=ge.useState(""),[m,A]=ge.useState(""),[x,T]=ge.useState(!1),[E,M]=ge.useState("web"),{login:N,loginGoogle:I,loginPlayGames:F,register:G,sendPasswordReset:O,resendVerification:D,checkEmailVerified:j,error:L,clearError:U,user:q,isEmailVerified:K}=Mc();ge.useEffect(()=>{M("web")},[]);const H=async ue=>{ue.preventDefault(),f(""),A(""),U(),T(!0);try{if(n==="login")await N(s,o);else if(n==="register"){if(!c.trim()){f(e("auth.enterUsername")),T(!1);return}await G(s,o,c),i("verify"),A(e("auth.accountCreated"))}else n==="reset"&&(await O(s),A(e("auth.passwordResetSent")))}catch{}T(!1)},X=async()=>{f(""),U(),T(!0);try{await I()}catch{}T(!1)},ne=async()=>{f(""),U(),T(!0);try{await F()}catch(ue){f(ue.message||"Error al conectar con Google Play Games")}T(!1)},Q=async()=>{T(!0);try{await D(),A(e("auth.verificationResent"))}catch{}T(!1)},Y=async()=>{T(!0),await j()||f(e("auth.emailNotVerified")),T(!1)};return E==="android"?d.jsx("div",{className:"auth",children:d.jsxs("div",{className:"auth__card",children:[d.jsxs("button",{className:"auth__back",onClick:a,children:[" ",e("common.back")]}),d.jsxs("div",{className:"auth__header",children:[d.jsx("div",{className:"auth__icon",children:d.jsx(jF,{size:22})}),d.jsx("h2",{children:e("auth.login")})]}),d.jsx("div",{className:"auth__android-info",children:d.jsx("p",{children:"Inicia sesin con tu cuenta de Google Play Games para guardar tu progreso y competir en los rankings."})}),(L||h)&&d.jsx("div",{className:"auth__error",children:L||h}),d.jsxs("button",{className:"auth__playgames",onClick:ne,disabled:x,children:[d.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:d.jsx("path",{fill:"#4CAF50",d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),d.jsx("span",{children:x?"Conectando...":"Iniciar con Google Play Games"})]}),d.jsxs("div",{className:"auth__android-benefits",children:[d.jsx("h4",{children:"Beneficios:"}),d.jsxs("ul",{children:[d.jsx("li",{children:" Guardado en la nube automtico"}),d.jsx("li",{children:" Logros y rankings globales"}),d.jsx("li",{children:" Sincroniza entre dispositivos"})]})]})]})}):n==="verify"||q&&!K?d.jsx("div",{className:"auth",children:d.jsxs("div",{className:"auth__card",children:[d.jsxs("button",{className:"auth__back",onClick:a,children:[" ",e("common.back")]}),d.jsxs("div",{className:"auth__header",children:[d.jsx("div",{className:"auth__icon",children:d.jsx(_y,{size:22})}),d.jsx("h2",{children:e("auth.verifyEmail")})]}),d.jsxs("div",{className:"auth__verify-message",children:[d.jsx("p",{children:e("auth.verificationSent")}),d.jsx("p",{className:"auth__email-display",children:q?.email||s}),d.jsx("p",{children:e("auth.clickLinkToActivate")})]}),(L||h)&&d.jsx("div",{className:"auth__error",children:L||h}),m&&d.jsx("div",{className:"auth__success",children:m}),d.jsxs("div",{className:"auth__verify-actions",children:[d.jsx("button",{className:"auth__btn auth__btn--primary",onClick:Y,disabled:x,children:e(x?"auth.checking":"auth.alreadyVerified")}),d.jsx("button",{className:"auth__btn auth__btn--secondary",onClick:Q,disabled:x,children:e("auth.resendEmail")})]})]})}):d.jsx("div",{className:"auth",children:d.jsxs("div",{className:"auth__card",children:[d.jsxs("button",{className:"auth__back",onClick:a,children:[" ",e("common.back")]}),d.jsxs("div",{className:"auth__header",children:[d.jsx("div",{className:"auth__icon",children:n==="login"?d.jsx(vy,{size:22}):n==="register"?d.jsx(FF,{size:22}):d.jsx(HSe,{size:22})}),d.jsxs("h2",{children:[n==="login"&&e("auth.login"),n==="register"&&e("auth.createAccount"),n==="reset"&&e("auth.resetPassword")]})]}),n!=="reset"&&d.jsx(d.Fragment,{children:d.jsxs("button",{className:"auth__google",onClick:X,disabled:x,children:[d.jsxs("svg",{viewBox:"0 0 24 24",width:"20",height:"20",children:[d.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),d.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),d.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),d.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),e("auth.continueWithGoogle")]})}),n!=="reset"&&d.jsx("div",{className:"auth__divider",children:d.jsx("span",{children:e("auth.orUseEmail")})}),d.jsxs("form",{onSubmit:H,className:"auth__form",children:[n==="register"&&d.jsxs("div",{className:"auth__field",children:[d.jsx("label",{children:e("auth.username")}),d.jsx("input",{type:"text",value:c,onChange:ue=>u(ue.target.value),placeholder:e("auth.usernamePlaceholder"),required:!0})]}),d.jsxs("div",{className:"auth__field",children:[d.jsx("label",{children:e("auth.email")}),d.jsx("input",{type:"email",value:s,onChange:ue=>r(ue.target.value),placeholder:e("auth.emailPlaceholder"),required:!0})]}),n!=="reset"&&d.jsxs("div",{className:"auth__field",children:[d.jsx("label",{children:e("auth.password")}),d.jsx("input",{type:"password",value:o,onChange:ue=>l(ue.target.value),placeholder:"",required:!0,minLength:6})]}),(L||h)&&d.jsx("div",{className:"auth__error",children:L||h}),m&&d.jsx("div",{className:"auth__success",children:m}),d.jsx("button",{type:"submit",className:"auth__btn auth__btn--primary",disabled:x,children:e(x?"common.loading":n==="login"?"auth.enter":n==="register"?"auth.createAccount":"auth.sendEmail")})]}),d.jsxs("div",{className:"auth__links",children:[n==="login"&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>{i("reset"),U(),A("")},children:e("auth.forgotPassword")}),d.jsx("button",{onClick:()=>{i("register"),U(),A("")},children:e("auth.noAccount")})]}),n==="register"&&d.jsx("button",{onClick:()=>{i("login"),U(),A("")},children:e("auth.haveAccount")}),n==="reset"&&d.jsx("button",{onClick:()=>{i("login"),U(),A("")},children:e("auth.backToLogin")})]})]})})}const zZ=5;function bP(a,e){return`${a}_slot_${e}`}async function fwe(a){const e=[];for(let n=0;n<zZ;n++){const i=bP(a,n),s=Ra(Kn,"saves",i),r=await go(s);r.exists()?e.push({slotIndex:n,...r.data()}):e.push({slotIndex:n,empty:!0})}return e}async function GZ(a,e,n){if(e<0||e>=zZ)throw new Error("Invalid slot index");const i=bP(a,e),s={...n,userId:a,slotIndex:e,lastSaved:Hi(),summary:{teamName:n.team?.name||"Desconocido",teamId:n.teamId,season:n.currentSeason||1,week:n.currentWeek||1,money:n.money||0,position:gwe(n)}};return await Kf(Ra(Kn,"saves",i),s),i}async function pwe(a,e){const n=bP(a,e),i=Ra(Kn,"saves",n),s=await go(i);if(s.exists()){const r=s.data(),o=["leagueTable","fixtures","results","messages","transferOffers","playerMarket","freeAgents","seasonObjectives","jobOffers","blockedPlayers","activeLoans","loanHistory","incomingLoanOffers","convocados","preseasonMatches"];for(const l of o)if(l in r&&r[l]&&!Array.isArray(r[l])&&typeof r[l]=="object"){const c=Object.keys(r[l]);c.length>0&&c.every(u=>/^\d+$/.test(u))?r[l]=c.sort((u,h)=>+u-+h).map(u=>r[l][u]):r[l]=[]}if(r.team?.players&&!Array.isArray(r.team.players)&&typeof r.team.players=="object"){const l=Object.keys(r.team.players);r.team.players=l.length>0&&l.every(c=>/^\d+$/.test(c))?l.sort((c,u)=>+c-+u).map(c=>r.team.players[c]):[]}return r}return null}async function mwe(a,e){const n=bP(a,e);await cy(Ra(Kn,"saves",n))}function gwe(a){if(!a.leagueTable||!a.teamId)return null;const e=a.leagueTable.find(n=>n.teamId===a.teamId);return e?a.leagueTable.indexOf(e)+1:null}function Awe({mode:a="load",onBack:e,onSlotSelected:n}){const{t:i}=Sa(),{user:s}=Mc(),{state:r,dispatch:o}=Va(),[l,c]=ge.useState([]),[u,h]=ge.useState(!0),[f,m]=ge.useState(null),[A,x]=ge.useState(null),[T,E]=ge.useState("");ge.useEffect(()=>{M()},[s]);const M=async()=>{if(s){h(!0),E("");try{const j=await fwe(s.uid);c(j)}catch(j){console.error("Error loading saves:",j),E(i("saveSlots.errorLoadGames"))}h(!1)}},N=async j=>{if(s){m(j),E("");try{const L=await pwe(s.uid,j);L&&(o({type:"LOAD_SAVE",payload:L}),o({type:"SET_SCREEN",payload:"office"}),n&&n(j))}catch(L){console.error("Error loading slot:",L),E(i("saveSlots.errorLoadGame"))}m(null)}},I=async j=>{if(!(!s||!r.gameStarted)){m(j),E("");try{await GZ(s.uid,j,r),await M(),n&&n(j)}catch(L){console.error("Error saving slot:",L),E(i("saveSlots.errorSaveGame"))}m(null)}},F=async j=>{if(s){m(j),E("");try{await mwe(s.uid,j),x(null),await M()}catch(L){console.error("Error deleting slot:",L),E(i("saveSlots.errorDeleteGame"))}m(null)}},G=j=>{localStorage.setItem("pcfutbol_pending_slot",j.toString()),o({type:"SET_SCREEN",payload:"team_selection"}),n&&n(j)},O=j=>j?(j.toDate?j.toDate():new Date(j)).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):i("saveSlots.never"),D=j=>j?new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR",maximumFractionDigits:0}).format(j):"0";return u?d.jsx("div",{className:"save-slots",children:d.jsxs("div",{className:"save-slots__loading",children:[d.jsx("div",{className:"save-slots__spinner",children:d.jsx(Lo,{size:22})}),d.jsx("p",{children:i("saveSlots.loadingGames")})]})}):d.jsx("div",{className:"save-slots",children:d.jsxs("div",{className:"save-slots__container",children:[d.jsxs("button",{className:"save-slots__back",onClick:e,children:[d.jsx(s1,{size:14})," ",i("saveSlots.back")]}),d.jsxs("div",{className:"save-slots__header",children:[d.jsxs("h2",{children:[a==="load"&&d.jsxs(d.Fragment,{children:[d.jsx(LSe,{size:16})," ",i("saveSlots.loadGame")]}),a==="save"&&d.jsxs(d.Fragment,{children:[d.jsx(Nq,{size:16})," ",i("saveSlots.saveGame")]}),a==="manage"&&d.jsxs(d.Fragment,{children:[d.jsx(PSe,{size:16})," ",i("saveSlots.manageGames")]})]}),d.jsxs("p",{className:"save-slots__subtitle",children:[a==="load"&&i("saveSlots.selectOrCreate"),a==="save"&&i("saveSlots.chooseSlot"),a==="manage"&&i("saveSlots.manageSlots")]})]}),T&&d.jsx("div",{className:"save-slots__error",children:T}),d.jsx("div",{className:"save-slots__grid",children:l.map((j,L)=>d.jsxs("div",{className:`save-slots__slot ${j.empty?"save-slots__slot--empty":""}`,children:[d.jsxs("div",{className:"save-slots__slot-header",children:[d.jsxs("span",{className:"save-slots__slot-number",children:[i("saveSlots.slot")," ",L+1]}),!j.empty&&d.jsx("span",{className:"save-slots__slot-date",children:O(j.lastSaved)})]}),j.empty?d.jsxs("div",{className:"save-slots__slot-empty",children:[d.jsx("div",{className:"save-slots__empty-icon",children:d.jsx(gSe,{size:36})}),d.jsx("p",{children:i("saveSlots.emptySlot")}),a==="load"&&d.jsx("button",{className:"save-slots__btn save-slots__btn--new",onClick:()=>G(L),children:i("saveSlots.newGame")}),a==="save"&&r.gameStarted&&d.jsx("button",{className:"save-slots__btn save-slots__btn--save",onClick:()=>I(L),disabled:f===L,children:i(f===L?"saveSlots.saving":"saveSlots.saveHere")})]}):d.jsxs("div",{className:"save-slots__slot-content",children:[d.jsxs("div",{className:"save-slots__team-info",children:[d.jsx("div",{className:"save-slots__team-badge",children:d.jsx(Lo,{size:20})}),d.jsxs("div",{className:"save-slots__team-details",children:[d.jsx("h3",{children:j.summary?.teamName||i("saveSlots.unknownTeam")}),d.jsxs("p",{children:[i("common.season")," ",j.summary?.season||1," ",i("common.week")," ",j.summary?.week||1,j.summary?.position&&`  ${j.summary.position}`]})]})]}),d.jsx("div",{className:"save-slots__stats",children:d.jsxs("div",{className:"save-slots__stat",children:[d.jsx("span",{className:"label",children:i("common.budget")}),d.jsx("span",{className:"value",children:D(j.summary?.money)})]})}),d.jsxs("div",{className:"save-slots__actions",children:[a==="load"&&d.jsx("button",{className:"save-slots__btn save-slots__btn--load",onClick:()=>N(L),disabled:f===L,children:f===L?i("saveSlots.loading"):d.jsxs(d.Fragment,{children:[d.jsx(SN,{size:14})," ",i("saveSlots.load")]})}),a==="save"&&d.jsx(d.Fragment,{children:A===L?d.jsxs("div",{className:"save-slots__confirm",children:[d.jsx("p",{children:i("saveSlots.overwrite")}),d.jsx("button",{className:"save-slots__btn save-slots__btn--danger",onClick:()=>I(L),children:i("common.yes")}),d.jsx("button",{className:"save-slots__btn save-slots__btn--cancel",onClick:()=>x(null),children:i("common.no")})]}):d.jsxs("button",{className:"save-slots__btn save-slots__btn--save",onClick:()=>x(L),disabled:f===L,children:[d.jsx(Nq,{size:14})," ",i("saveSlots.saveHere")]})}),a==="manage"&&d.jsx(d.Fragment,{children:A===L?d.jsxs("div",{className:"save-slots__confirm",children:[d.jsx("p",{children:i("saveSlots.deleteGame")}),d.jsx("button",{className:"save-slots__btn save-slots__btn--danger",onClick:()=>F(L),disabled:f===L,children:i(f===L?"common.loading":"common.yes")}),d.jsx("button",{className:"save-slots__btn save-slots__btn--cancel",onClick:()=>x(null),children:i("common.no")})]}):d.jsxs(d.Fragment,{children:[d.jsxs("button",{className:"save-slots__btn save-slots__btn--load",onClick:()=>N(L),disabled:f===L,children:[d.jsx(SN,{size:14})," ",i("saveSlots.load")]}),d.jsx("button",{className:"save-slots__btn save-slots__btn--delete",onClick:()=>x(L),children:d.jsx(UT,{size:14})})]})})]})]})]},L))})]})})}function ywe(){const{t:a}=Sa(),{state:e,dispatch:n}=Va(),{user:i,isAuthenticated:s,isEmailVerified:r,logout:o,loading:l}=Mc(),[c,u]=ge.useState(!1),[h,f]=ge.useState(!1),[m,A]=ge.useState(!1),[x,T]=ge.useState(!1),[E,M]=ge.useState("load"),[N,I]=ge.useState(!1),[F,G]=ge.useState({hasActive:!1,summary:null}),[O,D]=ge.useState(!1),[j,L]=ge.useState(!1),[U,q]=ge.useState({hasActive:!1,summary:null}),[K,H]=ge.useState(!1),[X,ne]=ge.useState(!1);ge.useEffect(()=>{setTimeout(()=>u(!0),100)},[]);const Q=e.gameStarted&&e.gameMode==="contrarreloj"&&!e.contrarrelojData?.finished;ge.useEffect(()=>{if(Q){G({hasActive:!0,source:"memory",summary:{teamName:e.team?.name||"Equipo desconocido",teamId:e.teamId,leagueId:e.leagueId||e.playerLeagueId,season:e.contrarrelojData?.seasonsPlayed||1,week:e.currentWeek||1,money:e.money||0,trophies:e.contrarrelojData?.trophies?.length||0}});return}s&&i?.uid?Y0e(i.uid).then(te=>G(te)).catch(()=>G({hasActive:!1,summary:null})):G({hasActive:!1,summary:null})},[s,i?.uid,Q]);const Y=e.gameStarted&&e.gameMode==="promanager"&&!e.proManagerData?.finished;ge.useEffect(()=>{if(Y){q({hasActive:!0,source:"memory",summary:{teamName:e.team?.name||"Unknown",teamId:e.teamId,season:e.proManagerData?.seasonsManaged||1,prestige:e.proManagerData?.prestige||10}});return}s&&i?.uid?X0e(i.uid).then(te=>q(te)).catch(()=>q({hasActive:!1,summary:null})):q({hasActive:!1,summary:null})},[s,i?.uid,Y]),ge.useEffect(()=>{s&&m&&A(!1)},[s,m]);const ue=()=>{s&&r?(M("load"),T(!0)):A(!0)},pe=async()=>{I(!0),await o(),n({type:"RESET_GAME"}),I(!1)},Ee=()=>{if(!s){A(!0);return}F.hasActive?D(!0):n({type:"SET_SCREEN",payload:"contrarreloj_setup"})},oe=async()=>{if(Q){n({type:"SET_SCREEN",payload:"office"}),D(!1);return}if(i?.uid){L(!0);try{const te=await GJ(i.uid);te&&(n({type:"LOAD_SAVE",payload:{...te,_contrarrelojUserId:i.uid}}),n({type:"SET_SCREEN",payload:"office"}))}catch(te){console.error("Error loading contrarreloj save:",te)}L(!1),D(!1)}},Ae=()=>{if(!s){A(!0);return}U.hasActive?H(!0):n({type:"SET_SCREEN",payload:"promanager_setup"})},be=async()=>{if(Y){n({type:"SET_SCREEN",payload:"office"}),H(!1);return}if(i?.uid){ne(!0);try{const te=await qJ(i.uid);te&&(n({type:"LOAD_SAVE",payload:{...te,_proManagerUserId:i.uid}}),n({type:"SET_SCREEN",payload:"office"}))}catch(te){console.error("Error loading ProManager save:",te)}ne(!1),H(!1)}},Ce=async()=>{if(i?.uid)try{await xF(i.uid)}catch{}Y&&n({type:"RESET_GAME"}),q({hasActive:!1,summary:null}),H(!1),n({type:"SET_SCREEN",payload:"promanager_setup"})},ce=async()=>{if(i?.uid)try{await yF(i.uid)}catch(te){console.error("Error deleting old contrarreloj save:",te)}Q&&n({type:"RESET_GAME"}),G({hasActive:!1,summary:null}),D(!1),n({type:"SET_SCREEN",payload:"contrarreloj_setup"})};return h?d.jsx("div",{className:"main-menu__settings-wrapper",children:d.jsx(qF,{onClose:()=>f(!1)})}):m?d.jsx(hwe,{onBack:()=>A(!1)}):x?d.jsx(Awe,{mode:E,onBack:()=>T(!1),onSlotSelected:()=>T(!1)}):d.jsxs("div",{className:`main-menu ${c?"animate-in":""}`,children:[d.jsxs("div",{className:"main-menu__background",children:[d.jsx("div",{className:"main-menu__gradient"}),d.jsx("div",{className:"main-menu__pattern"}),d.jsx("div",{className:"main-menu__glow"}),d.jsx("div",{className:"main-menu__particles",children:[...Array(6)].map((te,fe)=>d.jsx("div",{className:`particle particle--${fe}`},fe))})]}),s&&d.jsxs("div",{className:"main-menu__user",children:[d.jsx("div",{className:"main-menu__user-avatar",children:d.jsx(KTe,{size:14})}),d.jsx("span",{className:"main-menu__user-name",children:i?.displayName||i?.email?.split("@")[0]}),d.jsxs("button",{className:"main-menu__user-logout",onClick:pe,disabled:N,children:[d.jsx(VF,{size:13}),d.jsx("span",{children:a(N?"mainMenu.loggingOut":"mainMenu.logout")})]})]}),d.jsxs("div",{className:"main-menu__content",children:[d.jsxs("div",{className:"main-menu__hero",children:[d.jsx("div",{className:"main-menu__ball",children:d.jsx("div",{className:"main-menu__ball-inner",children:d.jsx("span",{className:"hero-ball",role:"img","aria-label":"baln",children:""})})}),d.jsxs("h1",{className:"main-menu__title",children:[d.jsx("span",{className:"pc",children:"P C"}),d.jsx("span",{className:"futbol",children:a("mainMenu.title").split(" ")[1]||"GAFFER"})]}),a("mainMenu.subtitle")&&!a("mainMenu.subtitle").includes("mainMenu.")&&d.jsxs("div",{className:"main-menu__edition",children:[d.jsx("span",{className:"line"}),d.jsx("span",{className:"text",children:a("mainMenu.subtitle")}),d.jsx("span",{className:"line"})]}),a("mainMenu.season")&&!a("mainMenu.season").includes("mainMenu.")&&d.jsx("p",{className:"main-menu__season",children:a("mainMenu.season")})]}),d.jsxs("nav",{className:"main-menu__nav",children:[d.jsx("button",{className:"main-menu__btn main-menu__btn--primary",onClick:ue,disabled:l,style:{"--delay":e.gameStarted&&e.gameMode!=="contrarreloj"?"1":"0"},children:d.jsxs("div",{className:"btn-content",children:[d.jsx("span",{className:"icon-wrapper icon-wrapper--primary",children:s?d.jsx(jF,{size:22}):d.jsx(ZSe,{size:22})}),d.jsxs("div",{className:"text",children:[d.jsx("span",{className:"label",children:a(s?"mainMenu.playButton":"mainMenu.loginButton")}),d.jsx("span",{className:"sublabel",children:a(s?"mainMenu.loadOrCreate":"mainMenu.saveProgress")})]}),d.jsx(_r,{size:18,className:"chevron"})]})}),s&&d.jsx("button",{className:"main-menu__btn main-menu__btn--contrarreloj",onClick:Ee,style:{"--delay":e.gameStarted?"3":"1"},children:d.jsxs("div",{className:"btn-content",children:[d.jsx("span",{className:"icon-wrapper icon-wrapper--contrarreloj",children:d.jsx(tf,{size:22})}),d.jsxs("div",{className:"text",children:[d.jsx("span",{className:"label",children:a("mainMenu.contrarreloj")}),d.jsx("span",{className:"sublabel",children:F.hasActive?`${F.summary?.teamName}  ${a("common.season")} ${F.summary?.season}`:a("mainMenu.reachChampions")})]}),d.jsx(_r,{size:18,className:"chevron"})]})}),s&&d.jsx("button",{className:"main-menu__btn main-menu__btn--ranked",onClick:()=>n({type:"SET_SCREEN",payload:"ranked_lobby"}),style:{"--delay":e.gameStarted?"4":"2"},children:d.jsxs("div",{className:"btn-content",children:[d.jsx("span",{className:"icon-wrapper icon-wrapper--ranked",children:d.jsx(ef,{size:22})}),d.jsxs("div",{className:"text",children:[d.jsx("span",{className:"label",children:"Ranked 1v1"}),d.jsx("span",{className:"sublabel",children:"Duelo de temporada competitivo"})]}),d.jsx(_r,{size:18,className:"chevron"})]})}),s&&d.jsx("button",{className:"main-menu__btn main-menu__btn--promanager",onClick:Ae,style:{"--delay":e.gameStarted?"5":"3"},children:d.jsxs("div",{className:"btn-content",children:[d.jsx("span",{className:"icon-wrapper icon-wrapper--promanager",children:d.jsx(gu,{size:22})}),d.jsxs("div",{className:"text",children:[d.jsx("span",{className:"label",children:a("proManager.title")}),d.jsx("span",{className:"sublabel",children:U.hasActive?`${U.summary?.teamName}  ${a("proManager.prestige")} ${U.summary?.prestige}`:a("proManager.menuSubtitle")})]}),d.jsx(_r,{size:18,className:"chevron"})]})}),d.jsxs("div",{className:"main-menu__secondary",children:[d.jsxs("button",{className:"main-menu__btn main-menu__btn--small",onClick:()=>n({type:"SET_SCREEN",payload:"ranking"}),style:{"--delay":e.gameStarted?"4":"2"},children:[d.jsx(Ai,{size:20,className:"icon-svg"}),d.jsx("span",{className:"label",children:a("mainMenu.recordsButton")})]}),d.jsxs("button",{className:"main-menu__btn main-menu__btn--small",onClick:()=>f(!0),style:{"--delay":e.gameStarted?"5":"3"},children:[d.jsx(BT,{size:20,className:"icon-svg"}),d.jsx("span",{className:"label",children:a("mainMenu.optionsButton")})]})]})]}),O&&d.jsxs("div",{className:"main-menu__contrarreloj-prompt",children:[d.jsx("div",{className:"contrarreloj-prompt__overlay",onClick:()=>D(!1)}),d.jsxs("div",{className:"contrarreloj-prompt__card",children:[d.jsxs("div",{className:"contrarreloj-prompt__header",children:[d.jsx(tf,{size:24}),d.jsx("h3",{children:a("mainMenu.contrarrelojActive")})]}),d.jsxs("div",{className:"contrarreloj-prompt__info",children:[d.jsx("p",{className:"team-name",children:F.summary?.teamName}),d.jsxs("p",{className:"details",children:[a("common.season")," ",F.summary?.season," ",a("common.week")," ",F.summary?.week,F.summary?.trophies>0&&`   ${F.summary.trophies}`]})]}),d.jsxs("div",{className:"contrarreloj-prompt__actions",children:[d.jsxs("button",{className:"btn-continue",onClick:oe,disabled:j,children:[d.jsx(SN,{size:18}),a(j?"common.loading":"common.continue")]}),d.jsx("button",{className:"btn-new",onClick:ce,children:a("mainMenu.newGame")})]}),d.jsx("p",{className:"contrarreloj-prompt__warning",children:a("mainMenu.deleteWarning")})]})]}),K&&d.jsxs("div",{className:"main-menu__contrarreloj-prompt",children:[d.jsx("div",{className:"contrarreloj-prompt__overlay",onClick:()=>H(!1)}),d.jsxs("div",{className:"contrarreloj-prompt__card",children:[d.jsxs("div",{className:"contrarreloj-prompt__header",children:[d.jsx(gu,{size:24}),d.jsx("h3",{children:a("proManager.activeCareer")})]}),d.jsxs("div",{className:"contrarreloj-prompt__info",children:[d.jsx("p",{className:"team-name",children:U.summary?.teamName}),d.jsxs("p",{className:"details",children:[a("common.season")," ",U.summary?.season,U.summary?.prestige!=null&&`   ${U.summary.prestige}`]})]}),d.jsxs("div",{className:"contrarreloj-prompt__actions",children:[d.jsxs("button",{className:"btn-continue",onClick:be,disabled:X,children:[d.jsx(SN,{size:18}),a(X?"common.loading":"common.continue")]}),d.jsx("button",{className:"btn-new",onClick:Ce,children:a("mainMenu.newGame")})]}),d.jsx("p",{className:"contrarreloj-prompt__warning",children:a("mainMenu.deleteWarning")})]})]}),!s&&d.jsxs("div",{className:"main-menu__guest-notice",children:[d.jsx(KSe,{size:14,className:"notice-icon"}),d.jsx("p",{children:a("mainMenu.guestNotice")})]}),d.jsx("footer",{className:"main-menu__footer",children:d.jsx("p",{children:a("mainMenu.tribute")})})]})]})}function HF(a,e,n){const i=a.reputation||70;n.findIndex(c=>c.teamId===a.id)+1;let s="mid";i>=90?s="elite":i>=80?s="high":i>=70?s="mid":s="low";const r=[],o=vwe(s,e,n.length);return r.push(o),s==="elite"&&r.push({id:"title_contender",type:"league_position",nameKey:"objNames.titleContender",descKey:"objDescs.titleContender",target:2,priority:"high",reward:5e6,penalty:-2e6}),s!=="low"&&r.push({id:"goal_difference",type:"goal_difference",nameKey:"objNames.goalDifference",descKey:"objDescs.goalDifference",target:1,priority:"medium",reward:1e6,penalty:0}),r.push({id:"financial_stability",type:"financial",nameKey:"objNames.financialStability",descKey:"objDescs.financialStability",target:0,priority:"high",reward:2e6,penalty:-1e6}),(a.players?.filter(c=>c.age<=21)||[]).length>=3&&r.push({id:"youth_development",type:"youth_minutes",nameKey:"objNames.youthDevelopment",descKey:"objDescs.youthDevelopment",target:10,priority:"low",reward:5e5,penalty:0}),r}function vwe(a,e,n){const i=["segunda","primeraRFEF","segundaRFEF"].includes(e),s={elite:{nameKey:"objNames.championsQualification",descKey:"objDescs.championsQualification",target:4,priority:"critical",reward:1e7,penalty:-5e6},high:{nameKey:"objNames.europeanQualification",descKey:"objDescs.europeanQualification",target:6,priority:"critical",reward:5e6,penalty:-3e6},mid:{nameKey:"objNames.topHalf",descKey:"objDescs.topHalf",target:Math.ceil(n/2),priority:"critical",reward:2e6,penalty:-1e6},low:{nameKey:"objNames.avoidRelegation",descKey:"objDescs.avoidRelegation",target:n-3,priority:"critical",reward:3e6,penalty:-2e6}};return i&&a!=="low"?{id:"league_position",type:"league_position",nameKey:"objNames.promotion",descKey:"objDescs.promotion",target:e==="segunda"?2:4,priority:"critical",reward:8e6,penalty:-2e6}:{id:"league_position",type:"league_position",...s[a]}}const bk={laliga:{champions:[1,2,3,4],europaLeague:[5,6],conference:[7],relegation:[18,19,20]},segunda:{promotion:[1,2],playoff:[3,4,5,6],relegation:[20,21,22]},primeraRFEF:{promotion:[1],relegation:[]},segundaRFEF:{promotion:[1],relegation:[]},premierLeague:{champions:[1,2,3,4],europaLeague:[5,6],conference:[7],relegation:[18,19,20]},serieA:{champions:[1,2,3,4],europaLeague:[5,6],conference:[7],relegation:[18,19,20]},bundesliga:{champions:[1,2,3,4],europaLeague:[5,6],conference:[7],relegation:[16,17,18],playoffRelegation:[16]},ligue1:{champions:[1,2,3],europaLeague:[4],conference:[5],relegation:[16,17,18],playoffRelegation:[16]},argentinaPrimera:{libertadores:[1,2,3,4],sudamericana:[5,6],relegation:[25,26,27,28]},brasileiraoA:{libertadores:[1,2,3,4],sudamericana:[5,6,7,8],relegation:[17,18,19,20]},colombiaPrimera:{libertadores:[1,2,3],sudamericana:[4,5,6],relegation:[18,19,20]},chilePrimera:{libertadores:[1,2],sudamericana:[3,4],relegation:[14,15,16]},uruguayPrimera:{libertadores:[1,2],sudamericana:[3,4],relegation:[14,15,16]},ecuadorLigaPro:{libertadores:[1,2],sudamericana:[3,4],relegation:[14,15,16]},paraguayPrimera:{libertadores:[1],sudamericana:[2,3],relegation:[11,12]},peruLiga1:{libertadores:[1,2],sudamericana:[3,4],relegation:[16,17,18]},boliviaPrimera:{libertadores:[1],sudamericana:[2,3],relegation:[14,15,16]},venezuelaPrimera:{libertadores:[1,2],sudamericana:[3,4],relegation:[16,17,18]}},_we={laliga:38,segunda:42,premierLeague:38,serieA:38,bundesliga:34,ligue1:34,primeraRFEF:38,segundaRFEF:34};function Oq(a,e="laliga"){if(!a||a.length===0)return!1;const n=Math.max(...a.map(o=>o.week)),i=a.every(o=>o.played),s=a.filter(o=>o.week===n),r=s.length>0&&s.every(o=>o.played);return i||r}function xwe(a,e,n="laliga"){const i=a.findIndex(h=>h.teamId===e)+1,s=a.find(h=>h.teamId===e),r=bk[n]||bk.laliga;let o=null,l=!1,c=!1,u=!1;return r.champions?.includes(i)?o="champions":r.libertadores?.includes(i)?o="libertadores":r.europaLeague?.includes(i)?o="europaLeague":r.sudamericana?.includes(i)?o="sudamericana":r.conference?.includes(i)&&(o="conference"),r.relegation?.includes(i)&&(l=!0),r.promotion?.includes(i)&&(c=!0),r.playoff?.includes(i)&&(u=!0),{position:i,points:s?.points||0,goalsFor:s?.goalsFor||0,goalsAgainst:s?.goalsAgainst||0,goalDifference:(s?.goalsFor||0)-(s?.goalsAgainst||0),wins:s?.won||0,draws:s?.drawn||0,losses:s?.lost||0,qualification:o,relegation:l,promotion:c,playoff:u}}function SP(a,e,n){const s=[...a.filter(c=>c.id!==e.id&&c.players?.length>0)].sort(()=>Math.random()-.5),r=["Opcin A","Opcin B","Opcin C"],o=new Set;return r.map((c,u)=>{const h=[];for(const f of s){if(h.length>=5)break;o.has(f.id)||(h.push(f),o.add(f.id))}for(;h.length<5;){const f=s[Math.floor(Math.random()*s.length)];f&&!h.find(m=>m.id===f.id)&&h.push(f)}return{id:`option_${u}`,name:c,matches:bwe(h,e)}})}function bwe(a,e){const n=[];for(let s=0;s<4;s++){const r=a[s];n.push({id:`preseason_${s+1}`,week:s+1,homeTeam:r.id,awayTeam:e.id,homeTeamName:r.name,awayTeamName:e.name,isHome:!1,opponent:r,played:!1,isPreseason:!0})}const i=a[4];return n.push({id:"preseason_5",week:5,homeTeam:e.id,awayTeam:i.id,homeTeamName:e.name,awayTeamName:i.name,isHome:!0,opponent:i,played:!1,isPreseason:!0,isPresentationMatch:!0}),n}function Swe(a,e){let n=0,i=0;const s=[];return a.forEach(r=>{Twe(r,e)?(n+=r.reward||0,s.push({...r,status:"completed",amount:r.reward})):(i+=Math.abs(r.penalty||0),s.push({...r,status:"failed",amount:r.penalty}))}),{totalReward:n,totalPenalty:i,netResult:n-i,objectiveResults:s}}function Twe(a,e){switch(a.type){case"league_position":return e.position<=a.target;case"goal_difference":return e.goalDifference>=a.target;case"financial":return!0;default:return!1}}function wwe(a){switch(a){case"champions":return"Continental Champions Cup";case"europaLeague":return"Continental Shield";case"conference":return"Continental Trophy";case"libertadores":return"South American Champions Cup";case"sudamericana":return"Copa Sudamericana";default:return null}}function Ewe(a){switch(a){case"champions":return 15e6;case"europaLeague":return 8e6;case"conference":return 4e6;case"libertadores":return 3e6;case"sudamericana":return 9e5;default:return 0}}function Mwe(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i,s,r,o,l=[],c=!0,u=!1;try{if(r=(n=n.call(a)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function Cwe(a,e,n){return e=Owe(e),e in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}function Fq(a,e){return Pwe(a)||Mwe(a,e)||qZ(a,e)||Dwe()}function Nwe(a){return Rwe(a)||Iwe(a)||qZ(a)||Lwe()}function Rwe(a){if(Array.isArray(a))return Sk(a)}function Pwe(a){if(Array.isArray(a))return a}function Iwe(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function qZ(a,e){if(a){if(typeof a=="string")return Sk(a,e);var n=Object.prototype.toString.call(a).slice(8,-1);if(n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set")return Array.from(a);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sk(a,e)}}function Sk(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=a[n];return i}function Lwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kwe(a,e){if(typeof a!="object"||a===null)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var i=n.call(a,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function Owe(a){var e=kwe(a,"string");return typeof e=="symbol"?e:String(e)}var Fwe=function(e,n){var i=new Set(n);return Object.assign.apply(Object,[{}].concat(Nwe(Object.entries(e).filter(function(s){var r=Fq(s,1),o=r[0];return!i.has(o)}).map(function(s){var r=Fq(s,2),o=r[0],l=r[1];return Cwe({},o,l)}))))};function Tk(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=Array(e);n<e;n++)i[n]=a[n];return i}function jwe(a){if(Array.isArray(a))return a}function Bwe(a){if(Array.isArray(a))return Tk(a)}function Uwe(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Vwe(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i,s,r,o,l=[],c=!0,u=!1;try{if(r=(n=n.call(a)).next,e!==0)for(;!(c=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function zwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qwe(a,e){return jwe(a)||Vwe(a,e)||HZ(a,e)||zwe()}function jq(a){return Bwe(a)||Uwe(a)||HZ(a)||Gwe()}function HZ(a,e){if(a){if(typeof a=="string")return Tk(a,e);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tk(a,e):void 0}}function Hwe(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.wrapperElementType,i=n===void 0?"div":n,s=e.nodeMapper,r=s===void 0?function(h){return h}:s,o=e.methodNames,l=o===void 0?[]:o,c=e.initPropNames,u=c===void 0?[]:c;return ge.forwardRef(function(h,f){var m=ge.useRef(),A=ge.useMemo(function(){var E=Object.fromEntries(u.filter(function(M){return h.hasOwnProperty(M)}).map(function(M){return[M,h[M]]}));return a(E)},[]);Bq(function(){A(r(m.current))},ge.useLayoutEffect),Bq(function(){return A._destructor instanceof Function?A._destructor:void 0});var x=ge.useCallback(function(E){for(var M=arguments.length,N=new Array(M>1?M-1:0),I=1;I<M;I++)N[I-1]=arguments[I];return A[E]instanceof Function?A[E].apply(A,N):void 0},[A]),T=ge.useRef({});return Object.keys(Fwe(h,[].concat(jq(l),jq(u)))).filter(function(E){return T.current[E]!==h[E]}).forEach(function(E){return x(E,h[E])}),T.current=h,ge.useImperativeHandle(f,function(){return Object.fromEntries(l.map(function(E){return[E,function(){for(var M=arguments.length,N=new Array(M),I=0;I<M;I++)N[I]=arguments[I];return x.apply(void 0,[E].concat(N))}]}))},[x]),p8.createElement(i,{ref:m})})}function Bq(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ge.useEffect,n=ge.useRef(),i=ge.useRef(!1),s=ge.useRef(!1),r=ge.useState(0),o=qwe(r,2);o[0];var l=o[1];i.current&&(s.current=!0),e(function(){return i.current||(n.current=a(),i.current=!0),l(function(c){return c+1}),function(){s.current&&n.current&&n.current()}},[])}const w0="182",ou={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},UA={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},WF=0,TN=1,$F=2,Wwe=3,WZ=0,b_=1,$Z=2,Hh=3,Ac=0,Di=1,er=2,hl=0,fl=1,xy=2,by=3,Sy=4,QA=5,Co=100,TP=101,wP=102,KF=103,YF=104,Oh=200,EP=201,MP=202,CP=203,q_=204,H_=205,NP=206,RP=207,PP=208,IP=209,LP=210,KZ=211,YZ=212,XZ=213,QZ=214,W_=0,$_=1,K_=2,gm=3,Y_=4,X_=5,Q_=6,J_=7,Ox=0,XF=1,QF=2,lo=0,DP=1,kP=2,OP=3,FP=4,JF=5,jP=6,BP=7,wk="attached",JZ="detached",GT=300,xc=301,Wu=302,d0=303,h0=304,Am=306,ym=1e3,Ur=1001,vm=1002,Mi=1003,qT=1004,$we=1004,Od=1005,Kwe=1005,di=1006,Zg=1007,Ywe=1007,No=1008,ZZ=1008,os=1009,e0=1010,t0=1011,Bu=1012,jr=1013,Ei=1014,ls=1015,cs=1016,HT=1017,WT=1018,yc=1020,$T=35902,KT=35899,UP=1021,Fx=1022,fs=1023,ho=1026,rl=1027,r1=1028,E0=1029,ol=1030,o1=1031,eee=1032,l1=1033,Qp=33776,Jp=33777,Zp=33778,em=33779,Z_=35840,ex=35841,tx=35842,nx=35843,Ty=36196,wy=37492,Ey=37496,My=37488,Cy=37489,f0=37490,Ny=37491,Ry=37808,Py=37809,Iy=37810,Ly=37811,Dy=37812,ky=37813,Oy=37814,Fy=37815,jy=37816,By=37817,Uy=37818,Vy=37819,zy=37820,Gy=37821,qy=36492,wN=36494,EN=36495,Hy=36283,Wy=36284,p0=36285,$y=36286,tee=2200,nee=2201,aee=2202,US=2300,MN=2301,KC=2302,VA=2400,zA=2401,VS=2402,VP=2500,ZF=2501,iee=0,see=1,Ek=2,ree=3200,Xwe=3201,Qwe=3202,Jwe=3203,qd=0,ej=1,Il="",Fr="srgb",_m="srgb-linear",Ky="linear",An="srgb",YC="",tj="rg",oee="ga",lee=0,Tg=7680,cee=7681,uee=7682,dee=7683,hee=34055,fee=34056,pee=5386,mee=512,gee=513,Aee=514,yee=515,vee=516,_ee=517,xee=518,CN=519,zP=512,jx=513,GP=514,Bx=515,qP=516,HP=517,Ux=518,WP=519,m0=35044,Bg=35048,Zwe=35040,eEe=35045,tEe=35049,nEe=35041,aEe=35046,iEe=35050,sEe=35042,rEe="100",Mk="300 es",Ro=2e3,bc=2001,Fd={COMPUTE:"compute",RENDER:"render"},oEe={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},lEe={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function nj(a){for(let e=a.length-1;e>=0;--e)if(a[e]>=65535)return!0;return!1}const cEe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function i_(a,e){return new cEe[a](e)}function ax(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function zS(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}function aj(){const a=zS("canvas");return a.style.display="block",a}const Uq={};let g0=null;function uEe(a){g0=a}function dEe(){return g0}function ix(...a){const e="THREE."+a.shift();g0?g0("log",e,...a):console.log(e,...a)}function yt(...a){const e="THREE."+a.shift();g0?g0("warn",e,...a):console.warn(e,...a)}function Rt(...a){const e="THREE."+a.shift();g0?g0("error",e,...a):console.error(e,...a)}function ji(...a){const e=a.join(" ");e in Uq||(Uq[e]=!0,yt(...a))}function hEe(a,e,n){return new Promise(function(i,s){function r(){switch(a.clientWaitSync(e,a.SYNC_FLUSH_COMMANDS_BIT,0)){case a.WAIT_FAILED:s();break;case a.TIMEOUT_EXPIRED:setTimeout(r,n);break;default:i()}}setTimeout(r,n)})}class Cc{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){const i=this._listeners;if(i===void 0)return;const s=i[e];if(s!==void 0){const r=s.indexOf(n);r!==-1&&s.splice(r,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const i=n[e.type];if(i!==void 0){e.target=this;const s=i.slice(0);for(let r=0,o=s.length;r<o;r++)s[r].call(this,e);e.target=null}}}const Qo=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Vq=1234567;const JA=Math.PI/180,Yy=180/Math.PI;function lu(){const a=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Qo[a&255]+Qo[a>>8&255]+Qo[a>>16&255]+Qo[a>>24&255]+"-"+Qo[e&255]+Qo[e>>8&255]+"-"+Qo[e>>16&15|64]+Qo[e>>24&255]+"-"+Qo[n&63|128]+Qo[n>>8&255]+"-"+Qo[n>>16&255]+Qo[n>>24&255]+Qo[i&255]+Qo[i>>8&255]+Qo[i>>16&255]+Qo[i>>24&255]).toLowerCase()}function ma(a,e,n){return Math.max(e,Math.min(n,a))}function ij(a,e){return(a%e+e)%e}function fEe(a,e,n,i,s){return i+(a-e)*(s-i)/(n-e)}function pEe(a,e,n){return a!==e?(n-a)/(e-a):0}function oS(a,e,n){return(1-n)*a+n*e}function mEe(a,e,n,i){return oS(a,e,1-Math.exp(-n*i))}function gEe(a,e=1){return e-Math.abs(ij(a,e*2)-e)}function AEe(a,e,n){return a<=e?0:a>=n?1:(a=(a-e)/(n-e),a*a*(3-2*a))}function yEe(a,e,n){return a<=e?0:a>=n?1:(a=(a-e)/(n-e),a*a*a*(a*(a*6-15)+10))}function vEe(a,e){return a+Math.floor(Math.random()*(e-a+1))}function _Ee(a,e){return a+Math.random()*(e-a)}function xEe(a){return a*(.5-Math.random())}function bEe(a){a!==void 0&&(Vq=a);let e=Vq+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function SEe(a){return a*JA}function TEe(a){return a*Yy}function wEe(a){return(a&a-1)===0&&a!==0}function EEe(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function MEe(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}function CEe(a,e,n,i,s){const r=Math.cos,o=Math.sin,l=r(n/2),c=o(n/2),u=r((e+i)/2),h=o((e+i)/2),f=r((e-i)/2),m=o((e-i)/2),A=r((i-e)/2),x=o((i-e)/2);switch(s){case"XYX":a.set(l*h,c*f,c*m,l*u);break;case"YZY":a.set(c*m,l*h,c*f,l*u);break;case"ZXZ":a.set(c*f,c*m,l*h,l*u);break;case"XZX":a.set(l*h,c*x,c*A,l*u);break;case"YXY":a.set(c*A,l*h,c*x,l*u);break;case"ZYZ":a.set(c*x,c*A,l*h,l*u);break;default:yt("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Ll(a,e){switch(e.constructor){case Float32Array:return a;case Uint32Array:return a/4294967295;case Uint16Array:return a/65535;case Uint8Array:return a/255;case Int32Array:return Math.max(a/2147483647,-1);case Int16Array:return Math.max(a/32767,-1);case Int8Array:return Math.max(a/127,-1);default:throw new Error("Invalid component type.")}}function Da(a,e){switch(e.constructor){case Float32Array:return a;case Uint32Array:return Math.round(a*4294967295);case Uint16Array:return Math.round(a*65535);case Uint8Array:return Math.round(a*255);case Int32Array:return Math.round(a*2147483647);case Int16Array:return Math.round(a*32767);case Int8Array:return Math.round(a*127);default:throw new Error("Invalid component type.")}}const Xy={DEG2RAD:JA,RAD2DEG:Yy,generateUUID:lu,clamp:ma,euclideanModulo:ij,mapLinear:fEe,inverseLerp:pEe,lerp:oS,damp:mEe,pingpong:gEe,smoothstep:AEe,smootherstep:yEe,randInt:vEe,randFloat:_Ee,randFloatSpread:xEe,seededRandom:bEe,degToRad:SEe,radToDeg:TEe,isPowerOfTwo:wEe,ceilPowerOfTwo:EEe,floorPowerOfTwo:MEe,setQuaternionFromProperEuler:CEe,normalize:Da,denormalize:Ll};class Nt{constructor(e=0,n=0){Nt.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6],this.y=s[1]*n+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=ma(this.x,e.x,n.x),this.y=ma(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=ma(this.x,e,n),this.y=ma(this.y,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(ma(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(ma(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),s=Math.sin(n),r=this.x-e.x,o=this.y-e.y;return this.x=r*i-o*s+e.x,this.y=r*s+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Er{constructor(e=0,n=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=s}static slerpFlat(e,n,i,s,r,o,l){let c=i[s+0],u=i[s+1],h=i[s+2],f=i[s+3],m=r[o+0],A=r[o+1],x=r[o+2],T=r[o+3];if(l<=0){e[n+0]=c,e[n+1]=u,e[n+2]=h,e[n+3]=f;return}if(l>=1){e[n+0]=m,e[n+1]=A,e[n+2]=x,e[n+3]=T;return}if(f!==T||c!==m||u!==A||h!==x){let E=c*m+u*A+h*x+f*T;E<0&&(m=-m,A=-A,x=-x,T=-T,E=-E);let M=1-l;if(E<.9995){const N=Math.acos(E),I=Math.sin(N);M=Math.sin(M*N)/I,l=Math.sin(l*N)/I,c=c*M+m*l,u=u*M+A*l,h=h*M+x*l,f=f*M+T*l}else{c=c*M+m*l,u=u*M+A*l,h=h*M+x*l,f=f*M+T*l;const N=1/Math.sqrt(c*c+u*u+h*h+f*f);c*=N,u*=N,h*=N,f*=N}}e[n]=c,e[n+1]=u,e[n+2]=h,e[n+3]=f}static multiplyQuaternionsFlat(e,n,i,s,r,o){const l=i[s],c=i[s+1],u=i[s+2],h=i[s+3],f=r[o],m=r[o+1],A=r[o+2],x=r[o+3];return e[n]=l*x+h*f+c*A-u*m,e[n+1]=c*x+h*m+u*f-l*A,e[n+2]=u*x+h*A+l*m-c*f,e[n+3]=h*x-l*f-c*m-u*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,s){return this._x=e,this._y=n,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,s=e._y,r=e._z,o=e._order,l=Math.cos,c=Math.sin,u=l(i/2),h=l(s/2),f=l(r/2),m=c(i/2),A=c(s/2),x=c(r/2);switch(o){case"XYZ":this._x=m*h*f+u*A*x,this._y=u*A*f-m*h*x,this._z=u*h*x+m*A*f,this._w=u*h*f-m*A*x;break;case"YXZ":this._x=m*h*f+u*A*x,this._y=u*A*f-m*h*x,this._z=u*h*x-m*A*f,this._w=u*h*f+m*A*x;break;case"ZXY":this._x=m*h*f-u*A*x,this._y=u*A*f+m*h*x,this._z=u*h*x+m*A*f,this._w=u*h*f-m*A*x;break;case"ZYX":this._x=m*h*f-u*A*x,this._y=u*A*f+m*h*x,this._z=u*h*x-m*A*f,this._w=u*h*f+m*A*x;break;case"YZX":this._x=m*h*f+u*A*x,this._y=u*A*f+m*h*x,this._z=u*h*x-m*A*f,this._w=u*h*f-m*A*x;break;case"XZY":this._x=m*h*f-u*A*x,this._y=u*A*f-m*h*x,this._z=u*h*x+m*A*f,this._w=u*h*f+m*A*x;break;default:yt("Quaternion: .setFromEuler() encountered an unknown order: "+o)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],s=n[4],r=n[8],o=n[1],l=n[5],c=n[9],u=n[2],h=n[6],f=n[10],m=i+l+f;if(m>0){const A=.5/Math.sqrt(m+1);this._w=.25/A,this._x=(h-c)*A,this._y=(r-u)*A,this._z=(o-s)*A}else if(i>l&&i>f){const A=2*Math.sqrt(1+i-l-f);this._w=(h-c)/A,this._x=.25*A,this._y=(s+o)/A,this._z=(r+u)/A}else if(l>f){const A=2*Math.sqrt(1+l-i-f);this._w=(r-u)/A,this._x=(s+o)/A,this._y=.25*A,this._z=(c+h)/A}else{const A=2*Math.sqrt(1+f-i-l);this._w=(o-s)/A,this._x=(r+u)/A,this._y=(c+h)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<1e-8?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ma(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const s=Math.min(1,n/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,s=e._y,r=e._z,o=e._w,l=n._x,c=n._y,u=n._z,h=n._w;return this._x=i*h+o*l+s*u-r*c,this._y=s*h+o*c+r*l-i*u,this._z=r*h+o*u+i*c-s*l,this._w=o*h-i*l-s*c-r*u,this._onChangeCallback(),this}slerp(e,n){if(n<=0)return this;if(n>=1)return this.copy(e);let i=e._x,s=e._y,r=e._z,o=e._w,l=this.dot(e);l<0&&(i=-i,s=-s,r=-r,o=-o,l=-l);let c=1-n;if(l<.9995){const u=Math.acos(l),h=Math.sin(u);c=Math.sin(c*u)/h,n=Math.sin(n*u)/h,this._x=this._x*c+i*n,this._y=this._y*c+s*n,this._z=this._z*c+r*n,this._w=this._w*c+o*n,this._onChangeCallback()}else this._x=this._x*c+i*n,this._y=this._y*c+s*n,this._z=this._z*c+r*n,this._w=this._w*c+o*n,this.normalize();return this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),s=Math.sqrt(1-i),r=Math.sqrt(i);return this.set(s*Math.sin(e),s*Math.cos(e),r*Math.sin(n),r*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ye{constructor(e=0,n=0,i=0){ye.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(zq.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(zq.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,s=this.z,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6]*s,this.y=r[1]*n+r[4]*i+r[7]*s,this.z=r[2]*n+r[5]*i+r[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,s=this.z,r=e.elements,o=1/(r[3]*n+r[7]*i+r[11]*s+r[15]);return this.x=(r[0]*n+r[4]*i+r[8]*s+r[12])*o,this.y=(r[1]*n+r[5]*i+r[9]*s+r[13])*o,this.z=(r[2]*n+r[6]*i+r[10]*s+r[14])*o,this}applyQuaternion(e){const n=this.x,i=this.y,s=this.z,r=e.x,o=e.y,l=e.z,c=e.w,u=2*(o*s-l*i),h=2*(l*n-r*s),f=2*(r*i-o*n);return this.x=n+c*u+o*f-l*h,this.y=i+c*h+l*u-r*f,this.z=s+c*f+r*h-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,s=this.z,r=e.elements;return this.x=r[0]*n+r[4]*i+r[8]*s,this.y=r[1]*n+r[5]*i+r[9]*s,this.z=r[2]*n+r[6]*i+r[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=ma(this.x,e.x,n.x),this.y=ma(this.y,e.y,n.y),this.z=ma(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=ma(this.x,e,n),this.y=ma(this.y,e,n),this.z=ma(this.z,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(ma(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,s=e.y,r=e.z,o=n.x,l=n.y,c=n.z;return this.x=s*c-r*l,this.y=r*o-i*c,this.z=i*l-s*o,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return vD.copy(this).projectOnVector(e),this.sub(vD)}reflect(e){return this.sub(vD.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(ma(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return n*n+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const s=Math.sin(n)*e;return this.x=s*Math.sin(i),this.y=Math.cos(n)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=s,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const vD=new ye,zq=new Er;class ga{constructor(e,n,i,s,r,o,l,c,u){ga.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,s,r,o,l,c,u)}set(e,n,i,s,r,o,l,c,u){const h=this.elements;return h[0]=e,h[1]=s,h[2]=l,h[3]=n,h[4]=r,h[5]=c,h[6]=i,h[7]=o,h[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,s=n.elements,r=this.elements,o=i[0],l=i[3],c=i[6],u=i[1],h=i[4],f=i[7],m=i[2],A=i[5],x=i[8],T=s[0],E=s[3],M=s[6],N=s[1],I=s[4],F=s[7],G=s[2],O=s[5],D=s[8];return r[0]=o*T+l*N+c*G,r[3]=o*E+l*I+c*O,r[6]=o*M+l*F+c*D,r[1]=u*T+h*N+f*G,r[4]=u*E+h*I+f*O,r[7]=u*M+h*F+f*D,r[2]=m*T+A*N+x*G,r[5]=m*E+A*I+x*O,r[8]=m*M+A*F+x*D,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],s=e[2],r=e[3],o=e[4],l=e[5],c=e[6],u=e[7],h=e[8];return n*o*h-n*l*u-i*r*h+i*l*c+s*r*u-s*o*c}invert(){const e=this.elements,n=e[0],i=e[1],s=e[2],r=e[3],o=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=h*o-l*u,m=l*c-h*r,A=u*r-o*c,x=n*f+i*m+s*A;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const T=1/x;return e[0]=f*T,e[1]=(s*u-h*i)*T,e[2]=(l*i-s*o)*T,e[3]=m*T,e[4]=(h*n-s*c)*T,e[5]=(s*r-l*n)*T,e[6]=A*T,e[7]=(i*c-u*n)*T,e[8]=(o*n-i*r)*T,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,s,r,o,l){const c=Math.cos(r),u=Math.sin(r);return this.set(i*c,i*u,-i*(c*o+u*l)+o+e,-s*u,s*c,-s*(-u*o+c*l)+l+n,0,0,1),this}scale(e,n){return this.premultiply(_D.makeScale(e,n)),this}rotate(e){return this.premultiply(_D.makeRotation(-e)),this}translate(e,n){return this.premultiply(_D.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let s=0;s<9;s++)if(n[s]!==i[s])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const _D=new ga,Gq=new ga().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),qq=new ga().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function NEe(){const a={enabled:!0,workingColorSpace:_m,spaces:{},convert:function(s,r,o){return this.enabled===!1||r===o||!r||!o||(this.spaces[r].transfer===An&&(s.r=tm(s.r),s.g=tm(s.g),s.b=tm(s.b)),this.spaces[r].primaries!==this.spaces[o].primaries&&(s.applyMatrix3(this.spaces[r].toXYZ),s.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===An&&(s.r=S_(s.r),s.g=S_(s.g),s.b=S_(s.b))),s},workingToColorSpace:function(s,r){return this.convert(s,this.workingColorSpace,r)},colorSpaceToWorking:function(s,r){return this.convert(s,r,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===Il?Ky:this.spaces[s].transfer},getToneMappingMode:function(s){return this.spaces[s].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(s,r=this.workingColorSpace){return s.fromArray(this.spaces[r].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,r,o){return s.copy(this.spaces[r].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(s,r){return ji("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),a.workingToColorSpace(s,r)},toWorkingColorSpace:function(s,r){return ji("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),a.colorSpaceToWorking(s,r)}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return a.define({[_m]:{primaries:e,whitePoint:i,transfer:Ky,toXYZ:Gq,fromXYZ:qq,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Fr},outputColorSpaceConfig:{drawingBufferColorSpace:Fr}},[Fr]:{primaries:e,whitePoint:i,transfer:An,toXYZ:Gq,fromXYZ:qq,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Fr}}}),a}const Vn=NEe();function tm(a){return a<.04045?a*.0773993808:Math.pow(a*.9478672986+.0521327014,2.4)}function S_(a){return a<.0031308?a*12.92:1.055*Math.pow(a,.41666)-.055}let sv;class bee{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{sv===void 0&&(sv=zS("canvas")),sv.width=e.width,sv.height=e.height;const s=sv.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),i=sv}return i.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=zS("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),r=s.data;for(let o=0;o<r.length;o++)r[o]=tm(r[o]/255)*255;return i.putImageData(s,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(tm(n[i]/255)*255):n[i]=tm(n[i]);return{data:n,width:e.width,height:e.height}}else return yt("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let REe=0;class Ug{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:REe++}),this.uuid=lu(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const n=this.data;return typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement?e.set(n.videoWidth,n.videoHeight,0):typeof VideoFrame<"u"&&n instanceof VideoFrame?e.set(n.displayHeight,n.displayWidth,0):n!==null?e.set(n.width,n.height,n.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},s=this.data;if(s!==null){let r;if(Array.isArray(s)){r=[];for(let o=0,l=s.length;o<l;o++)s[o].isDataTexture?r.push(xD(s[o].image)):r.push(xD(s[o]))}else r=xD(s);i.url=r}return n||(e.images[this.uuid]=i),i}}function xD(a){return typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&a instanceof ImageBitmap?bee.getDataURL(a):a.data?{data:Array.from(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(yt("Texture: Unable to serialize Texture."),{})}let PEe=0;const bD=new ye;class _s extends Cc{constructor(e=_s.DEFAULT_IMAGE,n=_s.DEFAULT_MAPPING,i=Ur,s=Ur,r=di,o=No,l=fs,c=os,u=_s.DEFAULT_ANISOTROPY,h=Il){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:PEe++}),this.uuid=lu(),this.name="",this.source=new Ug(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=s,this.magFilter=r,this.minFilter=o,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new Nt(0,0),this.repeat=new Nt(1,1),this.center=new Nt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ga,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(bD).x}get height(){return this.source.getSize(bD).y}get depth(){return this.source.getSize(bD).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const n in e){const i=e[n];if(i===void 0){yt(`Texture.setValues(): parameter '${n}' has value of undefined.`);continue}const s=this[n];if(s===void 0){yt(`Texture.setValues(): property '${n}' does not exist.`);continue}s&&i&&s.isVector2&&i.isVector2||s&&i&&s.isVector3&&i.isVector3||s&&i&&s.isMatrix3&&i.isMatrix3?s.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==GT)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ym:e.x=e.x-Math.floor(e.x);break;case Ur:e.x=e.x<0?0:1;break;case vm:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case ym:e.y=e.y-Math.floor(e.y);break;case Ur:e.y=e.y<0?0:1;break;case vm:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}_s.DEFAULT_IMAGE=null;_s.DEFAULT_MAPPING=GT;_s.DEFAULT_ANISOTROPY=1;class qn{constructor(e=0,n=0,i=0,s=1){qn.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,s){return this.x=e,this.y=n,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,s=this.z,r=this.w,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*s+o[12]*r,this.y=o[1]*n+o[5]*i+o[9]*s+o[13]*r,this.z=o[2]*n+o[6]*i+o[10]*s+o[14]*r,this.w=o[3]*n+o[7]*i+o[11]*s+o[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,s,r;const c=e.elements,u=c[0],h=c[4],f=c[8],m=c[1],A=c[5],x=c[9],T=c[2],E=c[6],M=c[10];if(Math.abs(h-m)<.01&&Math.abs(f-T)<.01&&Math.abs(x-E)<.01){if(Math.abs(h+m)<.1&&Math.abs(f+T)<.1&&Math.abs(x+E)<.1&&Math.abs(u+A+M-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const I=(u+1)/2,F=(A+1)/2,G=(M+1)/2,O=(h+m)/4,D=(f+T)/4,j=(x+E)/4;return I>F&&I>G?I<.01?(i=0,s=.707106781,r=.707106781):(i=Math.sqrt(I),s=O/i,r=D/i):F>G?F<.01?(i=.707106781,s=0,r=.707106781):(s=Math.sqrt(F),i=O/s,r=j/s):G<.01?(i=.707106781,s=.707106781,r=0):(r=Math.sqrt(G),i=D/r,s=j/r),this.set(i,s,r,n),this}let N=Math.sqrt((E-x)*(E-x)+(f-T)*(f-T)+(m-h)*(m-h));return Math.abs(N)<.001&&(N=1),this.x=(E-x)/N,this.y=(f-T)/N,this.z=(m-h)/N,this.w=Math.acos((u+A+M-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=ma(this.x,e.x,n.x),this.y=ma(this.y,e.y,n.y),this.z=ma(this.z,e.z,n.z),this.w=ma(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=ma(this.x,e,n),this.y=ma(this.y,e,n),this.z=ma(this.z,e,n),this.w=ma(this.w,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(ma(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class th extends Cc{constructor(e=1,n=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:di,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=i.depth,this.scissor=new qn(0,0,e,n),this.scissorTest=!1,this.viewport=new qn(0,0,e,n);const s={width:e,height:n,depth:i.depth},r=new _s(s);this.textures=[];const o=i.count;for(let l=0;l<o;l++)this.textures[l]=r.clone(),this.textures[l].isRenderTargetTexture=!0,this.textures[l].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(e={}){const n={minFilter:di,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(n.mapping=e.mapping),e.wrapS!==void 0&&(n.wrapS=e.wrapS),e.wrapT!==void 0&&(n.wrapT=e.wrapT),e.wrapR!==void 0&&(n.wrapR=e.wrapR),e.magFilter!==void 0&&(n.magFilter=e.magFilter),e.minFilter!==void 0&&(n.minFilter=e.minFilter),e.format!==void 0&&(n.format=e.format),e.type!==void 0&&(n.type=e.type),e.anisotropy!==void 0&&(n.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(n.colorSpace=e.colorSpace),e.flipY!==void 0&&(n.flipY=e.flipY),e.generateMipmaps!==void 0&&(n.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(n.internalFormat=e.internalFormat);for(let i=0;i<this.textures.length;i++)this.textures[i].setValues(n)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let s=0,r=this.textures.length;s<r;s++)this.textures[s].image.width=e,this.textures[s].image.height=n,this.textures[s].image.depth=i,this.textures[s].isData3DTexture!==!0&&(this.textures[s].isArrayTexture=this.textures[s].image.depth>1);this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const s=Object.assign({},e.textures[n].image);this.textures[n].source=new Ug(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class vc extends th{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class YT extends _s{constructor(e=null,n=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:s},this.magFilter=Mi,this.minFilter=Mi,this.wrapR=Ur,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class IEe extends vc{constructor(e=1,n=1,i=1,s={}){super(e,n,s),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new YT(null,e,n,i),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class $P extends _s{constructor(e=null,n=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:s},this.magFilter=Mi,this.minFilter=Mi,this.wrapR=Ur,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class LEe extends vc{constructor(e=1,n=1,i=1,s={}){super(e,n,s),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new $P(null,e,n,i),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class Mr{constructor(e=new ye(1/0,1/0,1/0),n=new ye(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(xd.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(xd.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=xd.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const r=i.getAttribute("position");if(n===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let o=0,l=r.count;o<l;o++)e.isMesh===!0?e.getVertexPosition(o,xd):xd.fromBufferAttribute(r,o),xd.applyMatrix4(e.matrixWorld),this.expandByPoint(xd);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),BE.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),BE.copy(i.boundingBox)),BE.applyMatrix4(e.matrixWorld),this.union(BE)}const s=e.children;for(let r=0,o=s.length;r<o;r++)this.expandByObject(s[r],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,xd),xd.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(qb),UE.subVectors(this.max,qb),rv.subVectors(e.a,qb),ov.subVectors(e.b,qb),lv.subVectors(e.c,qb),sg.subVectors(ov,rv),rg.subVectors(lv,ov),aA.subVectors(rv,lv);let n=[0,-sg.z,sg.y,0,-rg.z,rg.y,0,-aA.z,aA.y,sg.z,0,-sg.x,rg.z,0,-rg.x,aA.z,0,-aA.x,-sg.y,sg.x,0,-rg.y,rg.x,0,-aA.y,aA.x,0];return!SD(n,rv,ov,lv,UE)||(n=[1,0,0,0,1,0,0,0,1],!SD(n,rv,ov,lv,UE))?!1:(VE.crossVectors(sg,rg),n=[VE.x,VE.y,VE.z],SD(n,rv,ov,lv,UE))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,xd).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(xd).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Lp[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Lp[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Lp[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Lp[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Lp[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Lp[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Lp[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Lp[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Lp),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Lp=[new ye,new ye,new ye,new ye,new ye,new ye,new ye,new ye],xd=new ye,BE=new Mr,rv=new ye,ov=new ye,lv=new ye,sg=new ye,rg=new ye,aA=new ye,qb=new ye,UE=new ye,VE=new ye,iA=new ye;function SD(a,e,n,i,s){for(let r=0,o=a.length-3;r<=o;r+=3){iA.fromArray(a,r);const l=s.x*Math.abs(iA.x)+s.y*Math.abs(iA.y)+s.z*Math.abs(iA.z),c=e.dot(iA),u=n.dot(iA),h=i.dot(iA);if(Math.max(-Math.max(c,u,h),Math.min(c,u,h))>l)return!1}return!0}const DEe=new Mr,Hb=new ye,TD=new ye;class Cr{constructor(e=new ye,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):DEe.setFromPoints(e).getCenter(i);let s=0;for(let r=0,o=e.length;r<o;r++)s=Math.max(s,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Hb.subVectors(e,this.center);const n=Hb.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),s=(i-this.radius)*.5;this.center.addScaledVector(Hb,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(TD.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Hb.copy(e.center).add(TD)),this.expandByPoint(Hb.copy(e.center).sub(TD))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Dp=new ye,wD=new ye,zE=new ye,og=new ye,ED=new ye,GE=new ye,MD=new ye;class c1{constructor(e=new ye,n=new ye(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Dp)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Dp.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Dp.copy(this.origin).addScaledVector(this.direction,n),Dp.distanceToSquared(e))}distanceSqToSegment(e,n,i,s){wD.copy(e).add(n).multiplyScalar(.5),zE.copy(n).sub(e).normalize(),og.copy(this.origin).sub(wD);const r=e.distanceTo(n)*.5,o=-this.direction.dot(zE),l=og.dot(this.direction),c=-og.dot(zE),u=og.lengthSq(),h=Math.abs(1-o*o);let f,m,A,x;if(h>0)if(f=o*c-l,m=o*l-c,x=r*h,f>=0)if(m>=-x)if(m<=x){const T=1/h;f*=T,m*=T,A=f*(f+o*m+2*l)+m*(o*f+m+2*c)+u}else m=r,f=Math.max(0,-(o*m+l)),A=-f*f+m*(m+2*c)+u;else m=-r,f=Math.max(0,-(o*m+l)),A=-f*f+m*(m+2*c)+u;else m<=-x?(f=Math.max(0,-(-o*r+l)),m=f>0?-r:Math.min(Math.max(-r,-c),r),A=-f*f+m*(m+2*c)+u):m<=x?(f=0,m=Math.min(Math.max(-r,-c),r),A=m*(m+2*c)+u):(f=Math.max(0,-(o*r+l)),m=f>0?r:Math.min(Math.max(-r,-c),r),A=-f*f+m*(m+2*c)+u);else m=o>0?-r:r,f=Math.max(0,-(o*m+l)),A=-f*f+m*(m+2*c)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,f),s&&s.copy(wD).addScaledVector(zE,m),A}intersectSphere(e,n){Dp.subVectors(e.center,this.origin);const i=Dp.dot(this.direction),s=Dp.dot(Dp)-i*i,r=e.radius*e.radius;if(s>r)return null;const o=Math.sqrt(r-s),l=i-o,c=i+o;return c<0?null:l<0?this.at(c,n):this.at(l,n)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,s,r,o,l,c;const u=1/this.direction.x,h=1/this.direction.y,f=1/this.direction.z,m=this.origin;return u>=0?(i=(e.min.x-m.x)*u,s=(e.max.x-m.x)*u):(i=(e.max.x-m.x)*u,s=(e.min.x-m.x)*u),h>=0?(r=(e.min.y-m.y)*h,o=(e.max.y-m.y)*h):(r=(e.max.y-m.y)*h,o=(e.min.y-m.y)*h),i>o||r>s||((r>i||isNaN(i))&&(i=r),(o<s||isNaN(s))&&(s=o),f>=0?(l=(e.min.z-m.z)*f,c=(e.max.z-m.z)*f):(l=(e.max.z-m.z)*f,c=(e.min.z-m.z)*f),i>c||l>s)||((l>i||i!==i)&&(i=l),(c<s||s!==s)&&(s=c),s<0)?null:this.at(i>=0?i:s,n)}intersectsBox(e){return this.intersectBox(e,Dp)!==null}intersectTriangle(e,n,i,s,r){ED.subVectors(n,e),GE.subVectors(i,e),MD.crossVectors(ED,GE);let o=this.direction.dot(MD),l;if(o>0){if(s)return null;l=1}else if(o<0)l=-1,o=-o;else return null;og.subVectors(this.origin,e);const c=l*this.direction.dot(GE.crossVectors(og,GE));if(c<0)return null;const u=l*this.direction.dot(ED.cross(og));if(u<0||c+u>o)return null;const h=-l*og.dot(MD);return h<0?null:this.at(h/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class _n{constructor(e,n,i,s,r,o,l,c,u,h,f,m,A,x,T,E){_n.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,s,r,o,l,c,u,h,f,m,A,x,T,E)}set(e,n,i,s,r,o,l,c,u,h,f,m,A,x,T,E){const M=this.elements;return M[0]=e,M[4]=n,M[8]=i,M[12]=s,M[1]=r,M[5]=o,M[9]=l,M[13]=c,M[2]=u,M[6]=h,M[10]=f,M[14]=m,M[3]=A,M[7]=x,M[11]=T,M[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new _n().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return this.determinant()===0?(e.set(1,0,0),n.set(0,1,0),i.set(0,0,1),this):(e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this)}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const n=this.elements,i=e.elements,s=1/cv.setFromMatrixColumn(e,0).length(),r=1/cv.setFromMatrixColumn(e,1).length(),o=1/cv.setFromMatrixColumn(e,2).length();return n[0]=i[0]*s,n[1]=i[1]*s,n[2]=i[2]*s,n[3]=0,n[4]=i[4]*r,n[5]=i[5]*r,n[6]=i[6]*r,n[7]=0,n[8]=i[8]*o,n[9]=i[9]*o,n[10]=i[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,s=e.y,r=e.z,o=Math.cos(i),l=Math.sin(i),c=Math.cos(s),u=Math.sin(s),h=Math.cos(r),f=Math.sin(r);if(e.order==="XYZ"){const m=o*h,A=o*f,x=l*h,T=l*f;n[0]=c*h,n[4]=-c*f,n[8]=u,n[1]=A+x*u,n[5]=m-T*u,n[9]=-l*c,n[2]=T-m*u,n[6]=x+A*u,n[10]=o*c}else if(e.order==="YXZ"){const m=c*h,A=c*f,x=u*h,T=u*f;n[0]=m+T*l,n[4]=x*l-A,n[8]=o*u,n[1]=o*f,n[5]=o*h,n[9]=-l,n[2]=A*l-x,n[6]=T+m*l,n[10]=o*c}else if(e.order==="ZXY"){const m=c*h,A=c*f,x=u*h,T=u*f;n[0]=m-T*l,n[4]=-o*f,n[8]=x+A*l,n[1]=A+x*l,n[5]=o*h,n[9]=T-m*l,n[2]=-o*u,n[6]=l,n[10]=o*c}else if(e.order==="ZYX"){const m=o*h,A=o*f,x=l*h,T=l*f;n[0]=c*h,n[4]=x*u-A,n[8]=m*u+T,n[1]=c*f,n[5]=T*u+m,n[9]=A*u-x,n[2]=-u,n[6]=l*c,n[10]=o*c}else if(e.order==="YZX"){const m=o*c,A=o*u,x=l*c,T=l*u;n[0]=c*h,n[4]=T-m*f,n[8]=x*f+A,n[1]=f,n[5]=o*h,n[9]=-l*h,n[2]=-u*h,n[6]=A*f+x,n[10]=m-T*f}else if(e.order==="XZY"){const m=o*c,A=o*u,x=l*c,T=l*u;n[0]=c*h,n[4]=-f,n[8]=u*h,n[1]=m*f+T,n[5]=o*h,n[9]=A*f-x,n[2]=x*f-A,n[6]=l*h,n[10]=T*f+m}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(kEe,e,OEe)}lookAt(e,n,i){const s=this.elements;return Wc.subVectors(e,n),Wc.lengthSq()===0&&(Wc.z=1),Wc.normalize(),lg.crossVectors(i,Wc),lg.lengthSq()===0&&(Math.abs(i.z)===1?Wc.x+=1e-4:Wc.z+=1e-4,Wc.normalize(),lg.crossVectors(i,Wc)),lg.normalize(),qE.crossVectors(Wc,lg),s[0]=lg.x,s[4]=qE.x,s[8]=Wc.x,s[1]=lg.y,s[5]=qE.y,s[9]=Wc.y,s[2]=lg.z,s[6]=qE.z,s[10]=Wc.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,s=n.elements,r=this.elements,o=i[0],l=i[4],c=i[8],u=i[12],h=i[1],f=i[5],m=i[9],A=i[13],x=i[2],T=i[6],E=i[10],M=i[14],N=i[3],I=i[7],F=i[11],G=i[15],O=s[0],D=s[4],j=s[8],L=s[12],U=s[1],q=s[5],K=s[9],H=s[13],X=s[2],ne=s[6],Q=s[10],Y=s[14],ue=s[3],pe=s[7],Ee=s[11],oe=s[15];return r[0]=o*O+l*U+c*X+u*ue,r[4]=o*D+l*q+c*ne+u*pe,r[8]=o*j+l*K+c*Q+u*Ee,r[12]=o*L+l*H+c*Y+u*oe,r[1]=h*O+f*U+m*X+A*ue,r[5]=h*D+f*q+m*ne+A*pe,r[9]=h*j+f*K+m*Q+A*Ee,r[13]=h*L+f*H+m*Y+A*oe,r[2]=x*O+T*U+E*X+M*ue,r[6]=x*D+T*q+E*ne+M*pe,r[10]=x*j+T*K+E*Q+M*Ee,r[14]=x*L+T*H+E*Y+M*oe,r[3]=N*O+I*U+F*X+G*ue,r[7]=N*D+I*q+F*ne+G*pe,r[11]=N*j+I*K+F*Q+G*Ee,r[15]=N*L+I*H+F*Y+G*oe,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],s=e[8],r=e[12],o=e[1],l=e[5],c=e[9],u=e[13],h=e[2],f=e[6],m=e[10],A=e[14],x=e[3],T=e[7],E=e[11],M=e[15],N=c*A-u*m,I=l*A-u*f,F=l*m-c*f,G=o*A-u*h,O=o*m-c*h,D=o*f-l*h;return n*(T*N-E*I+M*F)-i*(x*N-E*G+M*O)+s*(x*I-T*G+M*D)-r*(x*F-T*O+E*D)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=n,s[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],s=e[2],r=e[3],o=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],m=e[10],A=e[11],x=e[12],T=e[13],E=e[14],M=e[15],N=f*E*u-T*m*u+T*c*A-l*E*A-f*c*M+l*m*M,I=x*m*u-h*E*u-x*c*A+o*E*A+h*c*M-o*m*M,F=h*T*u-x*f*u+x*l*A-o*T*A-h*l*M+o*f*M,G=x*f*c-h*T*c-x*l*m+o*T*m+h*l*E-o*f*E,O=n*N+i*I+s*F+r*G;if(O===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const D=1/O;return e[0]=N*D,e[1]=(T*m*r-f*E*r-T*s*A+i*E*A+f*s*M-i*m*M)*D,e[2]=(l*E*r-T*c*r+T*s*u-i*E*u-l*s*M+i*c*M)*D,e[3]=(f*c*r-l*m*r-f*s*u+i*m*u+l*s*A-i*c*A)*D,e[4]=I*D,e[5]=(h*E*r-x*m*r+x*s*A-n*E*A-h*s*M+n*m*M)*D,e[6]=(x*c*r-o*E*r-x*s*u+n*E*u+o*s*M-n*c*M)*D,e[7]=(o*m*r-h*c*r+h*s*u-n*m*u-o*s*A+n*c*A)*D,e[8]=F*D,e[9]=(x*f*r-h*T*r-x*i*A+n*T*A+h*i*M-n*f*M)*D,e[10]=(o*T*r-x*l*r+x*i*u-n*T*u-o*i*M+n*l*M)*D,e[11]=(h*l*r-o*f*r-h*i*u+n*f*u+o*i*A-n*l*A)*D,e[12]=G*D,e[13]=(h*T*s-x*f*s+x*i*m-n*T*m-h*i*E+n*f*E)*D,e[14]=(x*l*s-o*T*s-x*i*c+n*T*c+o*i*E-n*l*E)*D,e[15]=(o*f*s-h*l*s+h*i*c-n*f*c-o*i*m+n*l*m)*D,this}scale(e){const n=this.elements,i=e.x,s=e.y,r=e.z;return n[0]*=i,n[4]*=s,n[8]*=r,n[1]*=i,n[5]*=s,n[9]*=r,n[2]*=i,n[6]*=s,n[10]*=r,n[3]*=i,n[7]*=s,n[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,s))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),s=Math.sin(n),r=1-i,o=e.x,l=e.y,c=e.z,u=r*o,h=r*l;return this.set(u*o+i,u*l-s*c,u*c+s*l,0,u*l+s*c,h*l+i,h*c-s*o,0,u*c-s*l,h*c+s*o,r*c*c+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,s,r,o){return this.set(1,i,r,0,e,1,o,0,n,s,1,0,0,0,0,1),this}compose(e,n,i){const s=this.elements,r=n._x,o=n._y,l=n._z,c=n._w,u=r+r,h=o+o,f=l+l,m=r*u,A=r*h,x=r*f,T=o*h,E=o*f,M=l*f,N=c*u,I=c*h,F=c*f,G=i.x,O=i.y,D=i.z;return s[0]=(1-(T+M))*G,s[1]=(A+F)*G,s[2]=(x-I)*G,s[3]=0,s[4]=(A-F)*O,s[5]=(1-(m+M))*O,s[6]=(E+N)*O,s[7]=0,s[8]=(x+I)*D,s[9]=(E-N)*D,s[10]=(1-(m+T))*D,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,n,i){const s=this.elements;if(e.x=s[12],e.y=s[13],e.z=s[14],this.determinant()===0)return i.set(1,1,1),n.identity(),this;let r=cv.set(s[0],s[1],s[2]).length();const o=cv.set(s[4],s[5],s[6]).length(),l=cv.set(s[8],s[9],s[10]).length();this.determinant()<0&&(r=-r),bd.copy(this);const u=1/r,h=1/o,f=1/l;return bd.elements[0]*=u,bd.elements[1]*=u,bd.elements[2]*=u,bd.elements[4]*=h,bd.elements[5]*=h,bd.elements[6]*=h,bd.elements[8]*=f,bd.elements[9]*=f,bd.elements[10]*=f,n.setFromRotationMatrix(bd),i.x=r,i.y=o,i.z=l,this}makePerspective(e,n,i,s,r,o,l=Ro,c=!1){const u=this.elements,h=2*r/(n-e),f=2*r/(i-s),m=(n+e)/(n-e),A=(i+s)/(i-s);let x,T;if(c)x=r/(o-r),T=o*r/(o-r);else if(l===Ro)x=-(o+r)/(o-r),T=-2*o*r/(o-r);else if(l===bc)x=-o/(o-r),T=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return u[0]=h,u[4]=0,u[8]=m,u[12]=0,u[1]=0,u[5]=f,u[9]=A,u[13]=0,u[2]=0,u[6]=0,u[10]=x,u[14]=T,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,n,i,s,r,o,l=Ro,c=!1){const u=this.elements,h=2/(n-e),f=2/(i-s),m=-(n+e)/(n-e),A=-(i+s)/(i-s);let x,T;if(c)x=1/(o-r),T=o/(o-r);else if(l===Ro)x=-2/(o-r),T=-(o+r)/(o-r);else if(l===bc)x=-1/(o-r),T=-r/(o-r);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return u[0]=h,u[4]=0,u[8]=0,u[12]=m,u[1]=0,u[5]=f,u[9]=0,u[13]=A,u[2]=0,u[6]=0,u[10]=x,u[14]=T,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let s=0;s<16;s++)if(n[s]!==i[s])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const cv=new ye,bd=new _n,kEe=new ye(0,0,0),OEe=new ye(1,1,1),lg=new ye,qE=new ye,Wc=new ye,Hq=new _n,Wq=new Er;class fo{constructor(e=0,n=0,i=0,s=fo.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,s=this._order){return this._x=e,this._y=n,this._z=i,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const s=e.elements,r=s[0],o=s[4],l=s[8],c=s[1],u=s[5],h=s[9],f=s[2],m=s[6],A=s[10];switch(n){case"XYZ":this._y=Math.asin(ma(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,A),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(m,u),this._z=0);break;case"YXZ":this._x=Math.asin(-ma(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(l,A),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-f,r),this._z=0);break;case"ZXY":this._x=Math.asin(ma(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-f,A),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(c,r));break;case"ZYX":this._y=Math.asin(-ma(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(m,A),this._z=Math.atan2(c,r)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(ma(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-f,r)):(this._x=0,this._y=Math.atan2(l,A));break;case"XZY":this._z=Math.asin(-ma(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(m,u),this._y=Math.atan2(l,r)):(this._x=Math.atan2(-h,A),this._y=0);break;default:yt("Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return Hq.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Hq,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return Wq.setFromEuler(this),this.setFromQuaternion(Wq,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}fo.DEFAULT_ORDER="XYZ";class KP{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let FEe=0;const $q=new ye,uv=new Er,kp=new _n,HE=new ye,Wb=new ye,jEe=new ye,BEe=new Er,Kq=new ye(1,0,0),Yq=new ye(0,1,0),Xq=new ye(0,0,1),Qq={type:"added"},UEe={type:"removed"},dv={type:"childadded",child:null},CD={type:"childremoved",child:null};class ni extends Cc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:FEe++}),this.uuid=lu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ni.DEFAULT_UP.clone();const e=new ye,n=new fo,i=new Er,s=new ye(1,1,1);function r(){i.setFromEuler(n,!1)}function o(){n.setFromQuaternion(i,void 0,!1)}n._onChange(r),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new _n},normalMatrix:{value:new ga}}),this.matrix=new _n,this.matrixWorld=new _n,this.matrixAutoUpdate=ni.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ni.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new KP,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return uv.setFromAxisAngle(e,n),this.quaternion.multiply(uv),this}rotateOnWorldAxis(e,n){return uv.setFromAxisAngle(e,n),this.quaternion.premultiply(uv),this}rotateX(e){return this.rotateOnAxis(Kq,e)}rotateY(e){return this.rotateOnAxis(Yq,e)}rotateZ(e){return this.rotateOnAxis(Xq,e)}translateOnAxis(e,n){return $q.copy(e).applyQuaternion(this.quaternion),this.position.add($q.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(Kq,e)}translateY(e){return this.translateOnAxis(Yq,e)}translateZ(e){return this.translateOnAxis(Xq,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(kp.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?HE.copy(e):HE.set(e,n,i);const s=this.parent;this.updateWorldMatrix(!0,!1),Wb.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?kp.lookAt(Wb,HE,this.up):kp.lookAt(HE,Wb,this.up),this.quaternion.setFromRotationMatrix(kp),s&&(kp.extractRotation(s.matrixWorld),uv.setFromRotationMatrix(kp),this.quaternion.premultiply(uv.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(Rt("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Qq),dv.child=e,this.dispatchEvent(dv),dv.child=null):Rt("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(UEe),CD.child=e,this.dispatchEvent(CD),CD.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),kp.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),kp.multiply(e.parent.matrixWorld)),e.applyMatrix4(kp),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Qq),dv.child=e,this.dispatchEvent(dv),dv.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,s=this.children.length;i<s;i++){const o=this.children[i].getObjectByProperty(e,n);if(o!==void 0)return o}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wb,e,jEe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wb,BEe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(l=>({...l,boundingBox:l.boundingBox?l.boundingBox.toJSON():void 0,boundingSphere:l.boundingSphere?l.boundingSphere.toJSON():void 0})),s.instanceInfo=this._instanceInfo.map(l=>({...l})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(s.boundingBox=this.boundingBox.toJSON()));function r(l,c){return l[c.uuid]===void 0&&(l[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=r(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const c=l.shapes;if(Array.isArray(c))for(let u=0,h=c.length;u<h;u++){const f=c[u];r(e.shapes,f)}else r(e.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(r(e.materials,this.material[c]));s.material=l}else s.material=r(e.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++){const c=this.animations[l];s.animations.push(r(e.animations,c))}}if(n){const l=o(e.geometries),c=o(e.materials),u=o(e.textures),h=o(e.images),f=o(e.shapes),m=o(e.skeletons),A=o(e.animations),x=o(e.nodes);l.length>0&&(i.geometries=l),c.length>0&&(i.materials=c),u.length>0&&(i.textures=u),h.length>0&&(i.images=h),f.length>0&&(i.shapes=f),m.length>0&&(i.skeletons=m),A.length>0&&(i.animations=A),x.length>0&&(i.nodes=x)}return i.object=s,i;function o(l){const c=[];for(const u in l){const h=l[u];delete h.metadata,c.push(h)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const s=e.children[i];this.add(s.clone())}return this}}ni.DEFAULT_UP=new ye(0,1,0);ni.DEFAULT_MATRIX_AUTO_UPDATE=!0;ni.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Sd=new ye,Op=new ye,ND=new ye,Fp=new ye,hv=new ye,fv=new ye,Jq=new ye,RD=new ye,PD=new ye,ID=new ye,LD=new qn,DD=new qn,kD=new qn;class uc{constructor(e=new ye,n=new ye,i=new ye){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,s){s.subVectors(i,n),Sd.subVectors(e,n),s.cross(Sd);const r=s.lengthSq();return r>0?s.multiplyScalar(1/Math.sqrt(r)):s.set(0,0,0)}static getBarycoord(e,n,i,s,r){Sd.subVectors(s,n),Op.subVectors(i,n),ND.subVectors(e,n);const o=Sd.dot(Sd),l=Sd.dot(Op),c=Sd.dot(ND),u=Op.dot(Op),h=Op.dot(ND),f=o*u-l*l;if(f===0)return r.set(0,0,0),null;const m=1/f,A=(u*c-l*h)*m,x=(o*h-l*c)*m;return r.set(1-A-x,x,A)}static containsPoint(e,n,i,s){return this.getBarycoord(e,n,i,s,Fp)===null?!1:Fp.x>=0&&Fp.y>=0&&Fp.x+Fp.y<=1}static getInterpolation(e,n,i,s,r,o,l,c){return this.getBarycoord(e,n,i,s,Fp)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(r,Fp.x),c.addScaledVector(o,Fp.y),c.addScaledVector(l,Fp.z),c)}static getInterpolatedAttribute(e,n,i,s,r,o){return LD.setScalar(0),DD.setScalar(0),kD.setScalar(0),LD.fromBufferAttribute(e,n),DD.fromBufferAttribute(e,i),kD.fromBufferAttribute(e,s),o.setScalar(0),o.addScaledVector(LD,r.x),o.addScaledVector(DD,r.y),o.addScaledVector(kD,r.z),o}static isFrontFacing(e,n,i,s){return Sd.subVectors(i,n),Op.subVectors(e,n),Sd.cross(Op).dot(s)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,s){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,n,i,s){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Sd.subVectors(this.c,this.b),Op.subVectors(this.a,this.b),Sd.cross(Op).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return uc.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return uc.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,s,r){return uc.getInterpolation(e,this.a,this.b,this.c,n,i,s,r)}containsPoint(e){return uc.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return uc.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,s=this.b,r=this.c;let o,l;hv.subVectors(s,i),fv.subVectors(r,i),RD.subVectors(e,i);const c=hv.dot(RD),u=fv.dot(RD);if(c<=0&&u<=0)return n.copy(i);PD.subVectors(e,s);const h=hv.dot(PD),f=fv.dot(PD);if(h>=0&&f<=h)return n.copy(s);const m=c*f-h*u;if(m<=0&&c>=0&&h<=0)return o=c/(c-h),n.copy(i).addScaledVector(hv,o);ID.subVectors(e,r);const A=hv.dot(ID),x=fv.dot(ID);if(x>=0&&A<=x)return n.copy(r);const T=A*u-c*x;if(T<=0&&u>=0&&x<=0)return l=u/(u-x),n.copy(i).addScaledVector(fv,l);const E=h*x-A*f;if(E<=0&&f-h>=0&&A-x>=0)return Jq.subVectors(r,s),l=(f-h)/(f-h+(A-x)),n.copy(s).addScaledVector(Jq,l);const M=1/(E+T+m);return o=T*M,l=m*M,n.copy(i).addScaledVector(hv,o).addScaledVector(fv,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const See={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},cg={h:0,s:0,l:0},WE={h:0,s:0,l:0};function OD(a,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?a+(e-a)*6*n:n<1/2?e:n<2/3?a+(e-a)*6*(2/3-n):a}let on=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Fr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Vn.colorSpaceToWorking(this,n),this}setRGB(e,n,i,s=Vn.workingColorSpace){return this.r=e,this.g=n,this.b=i,Vn.colorSpaceToWorking(this,s),this}setHSL(e,n,i,s=Vn.workingColorSpace){if(e=ij(e,1),n=ma(n,0,1),i=ma(i,0,1),n===0)this.r=this.g=this.b=i;else{const r=i<=.5?i*(1+n):i+n-i*n,o=2*i-r;this.r=OD(o,r,e+1/3),this.g=OD(o,r,e),this.b=OD(o,r,e-1/3)}return Vn.colorSpaceToWorking(this,s),this}setStyle(e,n=Fr){function i(r){r!==void 0&&parseFloat(r)<1&&yt("Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const o=s[1],l=s[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,n);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,n);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,n);break;default:yt("Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=s[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,n);if(o===6)return this.setHex(parseInt(r,16),n);yt("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Fr){const i=See[e.toLowerCase()];return i!==void 0?this.setHex(i,n):yt("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=tm(e.r),this.g=tm(e.g),this.b=tm(e.b),this}copyLinearToSRGB(e){return this.r=S_(e.r),this.g=S_(e.g),this.b=S_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Fr){return Vn.workingToColorSpace(Jo.copy(this),e),Math.round(ma(Jo.r*255,0,255))*65536+Math.round(ma(Jo.g*255,0,255))*256+Math.round(ma(Jo.b*255,0,255))}getHexString(e=Fr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Vn.workingColorSpace){Vn.workingToColorSpace(Jo.copy(this),n);const i=Jo.r,s=Jo.g,r=Jo.b,o=Math.max(i,s,r),l=Math.min(i,s,r);let c,u;const h=(l+o)/2;if(l===o)c=0,u=0;else{const f=o-l;switch(u=h<=.5?f/(o+l):f/(2-o-l),o){case i:c=(s-r)/f+(s<r?6:0);break;case s:c=(r-i)/f+2;break;case r:c=(i-s)/f+4;break}c/=6}return e.h=c,e.s=u,e.l=h,e}getRGB(e,n=Vn.workingColorSpace){return Vn.workingToColorSpace(Jo.copy(this),n),e.r=Jo.r,e.g=Jo.g,e.b=Jo.b,e}getStyle(e=Fr){Vn.workingToColorSpace(Jo.copy(this),e);const n=Jo.r,i=Jo.g,s=Jo.b;return e!==Fr?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(s*255)})`}offsetHSL(e,n,i){return this.getHSL(cg),this.setHSL(cg.h+e,cg.s+n,cg.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(cg),e.getHSL(WE);const i=oS(cg.h,WE.h,n),s=oS(cg.s,WE.s,n),r=oS(cg.l,WE.l,n);return this.setHSL(i,s,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,s=this.b,r=e.elements;return this.r=r[0]*n+r[3]*i+r[6]*s,this.g=r[1]*n+r[4]*i+r[7]*s,this.b=r[2]*n+r[5]*i+r[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Jo=new on;on.NAMES=See;let VEe=0;class po extends Cc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:VEe++}),this.uuid=lu(),this.name="",this.type="Material",this.blending=fl,this.side=Ac,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=q_,this.blendDst=H_,this.blendEquation=Co,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new on(0,0,0),this.blendAlpha=0,this.depthFunc=gm,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=CN,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Tg,this.stencilZFail=Tg,this.stencilZPass=Tg,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){yt(`Material: parameter '${n}' has value of undefined.`);continue}const s=this[n];if(s===void 0){yt(`Material: '${n}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(i.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(i.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==fl&&(i.blending=this.blending),this.side!==Ac&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==q_&&(i.blendSrc=this.blendSrc),this.blendDst!==H_&&(i.blendDst=this.blendDst),this.blendEquation!==Co&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==gm&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==CN&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Tg&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Tg&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Tg&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.allowOverride===!1&&(i.allowOverride=!1),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function s(r){const o=[];for(const l in r){const c=r[l];delete c.metadata,o.push(c)}return o}if(n){const r=s(e.textures),o=s(e.images);r.length>0&&(i.textures=r),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const s=n.length;i=new Array(s);for(let r=0;r!==s;++r)i[r]=n[r].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class oo extends po{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new on(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new fo,this.combine=Ox,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const qp=zEe();function zEe(){const a=new ArrayBuffer(4),e=new Float32Array(a),n=new Uint32Array(a),i=new Uint32Array(512),s=new Uint32Array(512);for(let c=0;c<256;++c){const u=c-127;u<-27?(i[c]=0,i[c|256]=32768,s[c]=24,s[c|256]=24):u<-14?(i[c]=1024>>-u-14,i[c|256]=1024>>-u-14|32768,s[c]=-u-1,s[c|256]=-u-1):u<=15?(i[c]=u+15<<10,i[c|256]=u+15<<10|32768,s[c]=13,s[c|256]=13):u<128?(i[c]=31744,i[c|256]=64512,s[c]=24,s[c|256]=24):(i[c]=31744,i[c|256]=64512,s[c]=13,s[c|256]=13)}const r=new Uint32Array(2048),o=new Uint32Array(64),l=new Uint32Array(64);for(let c=1;c<1024;++c){let u=c<<13,h=0;for(;(u&8388608)===0;)u<<=1,h-=8388608;u&=-8388609,h+=947912704,r[c]=u|h}for(let c=1024;c<2048;++c)r[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)o[c]=c<<23;o[31]=1199570944,o[32]=2147483648;for(let c=33;c<63;++c)o[c]=2147483648+(c-32<<23);o[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(l[c]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:s,mantissaTable:r,exponentTable:o,offsetTable:l}}function ic(a){Math.abs(a)>65504&&yt("DataUtils.toHalfFloat(): Value out of range."),a=ma(a,-65504,65504),qp.floatView[0]=a;const e=qp.uint32View[0],n=e>>23&511;return qp.baseTable[n]+((e&8388607)>>qp.shiftTable[n])}function F2(a){const e=a>>10;return qp.uint32View[0]=qp.mantissaTable[qp.offsetTable[e]+(a&1023)]+qp.exponentTable[e],qp.floatView[0]}class GEe{static toHalfFloat(e){return ic(e)}static fromHalfFloat(e){return F2(e)}}const gr=new ye,$E=new Nt;let qEe=0;class Ua{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:qEe++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=m0,this.updateRanges=[],this.gpuType=ls,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let s=0,r=this.itemSize;s<r;s++)this.array[e+s]=n.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)$E.fromBufferAttribute(this,n),$E.applyMatrix3(e),this.setXY(n,$E.x,$E.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)gr.fromBufferAttribute(this,n),gr.applyMatrix3(e),this.setXYZ(n,gr.x,gr.y,gr.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)gr.fromBufferAttribute(this,n),gr.applyMatrix4(e),this.setXYZ(n,gr.x,gr.y,gr.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)gr.fromBufferAttribute(this,n),gr.applyNormalMatrix(e),this.setXYZ(n,gr.x,gr.y,gr.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)gr.fromBufferAttribute(this,n),gr.transformDirection(e),this.setXYZ(n,gr.x,gr.y,gr.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Ll(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=Da(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Ll(n,this.array)),n}setX(e,n){return this.normalized&&(n=Da(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Ll(n,this.array)),n}setY(e,n){return this.normalized&&(n=Da(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Ll(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Da(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Ll(n,this.array)),n}setW(e,n){return this.normalized&&(n=Da(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=Da(n,this.array),i=Da(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,s){return e*=this.itemSize,this.normalized&&(n=Da(n,this.array),i=Da(i,this.array),s=Da(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,n,i,s,r){return e*=this.itemSize,this.normalized&&(n=Da(n,this.array),i=Da(i,this.array),s=Da(s,this.array),r=Da(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==m0&&(e.usage=this.usage),e}}class HEe extends Ua{constructor(e,n,i){super(new Int8Array(e),n,i)}}class WEe extends Ua{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class $Ee extends Ua{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class KEe extends Ua{constructor(e,n,i){super(new Int16Array(e),n,i)}}class YP extends Ua{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class YEe extends Ua{constructor(e,n,i){super(new Int32Array(e),n,i)}}class XP extends Ua{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class sj extends Ua{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=F2(this.array[e*this.itemSize]);return this.normalized&&(n=Ll(n,this.array)),n}setX(e,n){return this.normalized&&(n=Da(n,this.array)),this.array[e*this.itemSize]=ic(n),this}getY(e){let n=F2(this.array[e*this.itemSize+1]);return this.normalized&&(n=Ll(n,this.array)),n}setY(e,n){return this.normalized&&(n=Da(n,this.array)),this.array[e*this.itemSize+1]=ic(n),this}getZ(e){let n=F2(this.array[e*this.itemSize+2]);return this.normalized&&(n=Ll(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Da(n,this.array)),this.array[e*this.itemSize+2]=ic(n),this}getW(e){let n=F2(this.array[e*this.itemSize+3]);return this.normalized&&(n=Ll(n,this.array)),n}setW(e,n){return this.normalized&&(n=Da(n,this.array)),this.array[e*this.itemSize+3]=ic(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=Da(n,this.array),i=Da(i,this.array)),this.array[e+0]=ic(n),this.array[e+1]=ic(i),this}setXYZ(e,n,i,s){return e*=this.itemSize,this.normalized&&(n=Da(n,this.array),i=Da(i,this.array),s=Da(s,this.array)),this.array[e+0]=ic(n),this.array[e+1]=ic(i),this.array[e+2]=ic(s),this}setXYZW(e,n,i,s,r){return e*=this.itemSize,this.normalized&&(n=Da(n,this.array),i=Da(i,this.array),s=Da(s,this.array),r=Da(r,this.array)),this.array[e+0]=ic(n),this.array[e+1]=ic(i),this.array[e+2]=ic(s),this.array[e+3]=ic(r),this}}class mn extends Ua{constructor(e,n,i){super(new Float32Array(e),n,i)}}let XEe=0;const Du=new _n,FD=new ni,pv=new ye,$c=new Mr,$b=new Mr,to=new ye;class zn extends Cc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:XEe++}),this.uuid=lu(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(nj(e)?XP:YP)(e,1):this.index=e,this}setIndirect(e,n=0){return this.indirect=e,this.indirectOffset=n,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const r=new ga().getNormalMatrix(e);i.applyNormalMatrix(r),i.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Du.makeRotationFromQuaternion(e),this.applyMatrix4(Du),this}rotateX(e){return Du.makeRotationX(e),this.applyMatrix4(Du),this}rotateY(e){return Du.makeRotationY(e),this.applyMatrix4(Du),this}rotateZ(e){return Du.makeRotationZ(e),this.applyMatrix4(Du),this}translate(e,n,i){return Du.makeTranslation(e,n,i),this.applyMatrix4(Du),this}scale(e,n,i){return Du.makeScale(e,n,i),this.applyMatrix4(Du),this}lookAt(e){return FD.lookAt(e),FD.updateMatrix(),this.applyMatrix4(FD.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(pv).negate(),this.translate(pv.x,pv.y,pv.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const i=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new mn(i,3))}else{const i=Math.min(e.length,n.count);for(let s=0;s<i;s++){const r=e[s];n.setXYZ(s,r.x,r.y,r.z||0)}e.length>n.count&&yt("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Mr);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Rt("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ye(-1/0,-1/0,-1/0),new ye(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,s=n.length;i<s;i++){const r=n[i];$c.setFromBufferAttribute(r),this.morphTargetsRelative?(to.addVectors(this.boundingBox.min,$c.min),this.boundingBox.expandByPoint(to),to.addVectors(this.boundingBox.max,$c.max),this.boundingBox.expandByPoint(to)):(this.boundingBox.expandByPoint($c.min),this.boundingBox.expandByPoint($c.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Rt('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Cr);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Rt("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ye,1/0);return}if(e){const i=this.boundingSphere.center;if($c.setFromBufferAttribute(e),n)for(let r=0,o=n.length;r<o;r++){const l=n[r];$b.setFromBufferAttribute(l),this.morphTargetsRelative?(to.addVectors($c.min,$b.min),$c.expandByPoint(to),to.addVectors($c.max,$b.max),$c.expandByPoint(to)):($c.expandByPoint($b.min),$c.expandByPoint($b.max))}$c.getCenter(i);let s=0;for(let r=0,o=e.count;r<o;r++)to.fromBufferAttribute(e,r),s=Math.max(s,i.distanceToSquared(to));if(n)for(let r=0,o=n.length;r<o;r++){const l=n[r],c=this.morphTargetsRelative;for(let u=0,h=l.count;u<h;u++)to.fromBufferAttribute(l,u),c&&(pv.fromBufferAttribute(e,u),to.add(pv)),s=Math.max(s,i.distanceToSquared(to))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&Rt('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){Rt("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,s=n.normal,r=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ua(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),l=[],c=[];for(let j=0;j<i.count;j++)l[j]=new ye,c[j]=new ye;const u=new ye,h=new ye,f=new ye,m=new Nt,A=new Nt,x=new Nt,T=new ye,E=new ye;function M(j,L,U){u.fromBufferAttribute(i,j),h.fromBufferAttribute(i,L),f.fromBufferAttribute(i,U),m.fromBufferAttribute(r,j),A.fromBufferAttribute(r,L),x.fromBufferAttribute(r,U),h.sub(u),f.sub(u),A.sub(m),x.sub(m);const q=1/(A.x*x.y-x.x*A.y);isFinite(q)&&(T.copy(h).multiplyScalar(x.y).addScaledVector(f,-A.y).multiplyScalar(q),E.copy(f).multiplyScalar(A.x).addScaledVector(h,-x.x).multiplyScalar(q),l[j].add(T),l[L].add(T),l[U].add(T),c[j].add(E),c[L].add(E),c[U].add(E))}let N=this.groups;N.length===0&&(N=[{start:0,count:e.count}]);for(let j=0,L=N.length;j<L;++j){const U=N[j],q=U.start,K=U.count;for(let H=q,X=q+K;H<X;H+=3)M(e.getX(H+0),e.getX(H+1),e.getX(H+2))}const I=new ye,F=new ye,G=new ye,O=new ye;function D(j){G.fromBufferAttribute(s,j),O.copy(G);const L=l[j];I.copy(L),I.sub(G.multiplyScalar(G.dot(L))).normalize(),F.crossVectors(O,L);const q=F.dot(c[j])<0?-1:1;o.setXYZW(j,I.x,I.y,I.z,q)}for(let j=0,L=N.length;j<L;++j){const U=N[j],q=U.start,K=U.count;for(let H=q,X=q+K;H<X;H+=3)D(e.getX(H+0)),D(e.getX(H+1)),D(e.getX(H+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Ua(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let m=0,A=i.count;m<A;m++)i.setXYZ(m,0,0,0);const s=new ye,r=new ye,o=new ye,l=new ye,c=new ye,u=new ye,h=new ye,f=new ye;if(e)for(let m=0,A=e.count;m<A;m+=3){const x=e.getX(m+0),T=e.getX(m+1),E=e.getX(m+2);s.fromBufferAttribute(n,x),r.fromBufferAttribute(n,T),o.fromBufferAttribute(n,E),h.subVectors(o,r),f.subVectors(s,r),h.cross(f),l.fromBufferAttribute(i,x),c.fromBufferAttribute(i,T),u.fromBufferAttribute(i,E),l.add(h),c.add(h),u.add(h),i.setXYZ(x,l.x,l.y,l.z),i.setXYZ(T,c.x,c.y,c.z),i.setXYZ(E,u.x,u.y,u.z)}else for(let m=0,A=n.count;m<A;m+=3)s.fromBufferAttribute(n,m+0),r.fromBufferAttribute(n,m+1),o.fromBufferAttribute(n,m+2),h.subVectors(o,r),f.subVectors(s,r),h.cross(f),i.setXYZ(m+0,h.x,h.y,h.z),i.setXYZ(m+1,h.x,h.y,h.z),i.setXYZ(m+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)to.fromBufferAttribute(e,n),to.normalize(),e.setXYZ(n,to.x,to.y,to.z)}toNonIndexed(){function e(l,c){const u=l.array,h=l.itemSize,f=l.normalized,m=new u.constructor(c.length*h);let A=0,x=0;for(let T=0,E=c.length;T<E;T++){l.isInterleavedBufferAttribute?A=c[T]*l.data.stride+l.offset:A=c[T]*h;for(let M=0;M<h;M++)m[x++]=u[A++]}return new Ua(m,h,f)}if(this.index===null)return yt("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new zn,i=this.index.array,s=this.attributes;for(const l in s){const c=s[l],u=e(c,i);n.setAttribute(l,u)}const r=this.morphAttributes;for(const l in r){const c=[],u=r[l];for(let h=0,f=u.length;h<f;h++){const m=u[h],A=e(m,i);c.push(A)}n.morphAttributes[l]=c}n.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let l=0,c=o.length;l<c;l++){const u=o[l];n.addGroup(u.start,u.count,u.materialIndex)}return n}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const u in c)c[u]!==void 0&&(e[u]=c[u]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const c in i){const u=i[c];e.data.attributes[c]=u.toJSON(e.data)}const s={};let r=!1;for(const c in this.morphAttributes){const u=this.morphAttributes[c],h=[];for(let f=0,m=u.length;f<m;f++){const A=u[f];h.push(A.toJSON(e.data))}h.length>0&&(s[c]=h,r=!0)}r&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere=l.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const s=e.attributes;for(const u in s){const h=s[u];this.setAttribute(u,h.clone(n))}const r=e.morphAttributes;for(const u in r){const h=[],f=r[u];for(let m=0,A=f.length;m<A;m++)h.push(f[m].clone(n));this.morphAttributes[u]=h}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,h=o.length;u<h;u++){const f=o[u];this.addGroup(f.start,f.count,f.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Zq=new _n,sA=new c1,KE=new Cr,eH=new ye,YE=new ye,XE=new ye,QE=new ye,jD=new ye,JE=new ye,tH=new ye,ZE=new ye;class Na extends ni{constructor(e=new zn,n=new oo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const s=n[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const l=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=r}}}}getVertexPosition(e,n){const i=this.geometry,s=i.attributes.position,r=i.morphAttributes.position,o=i.morphTargetsRelative;n.fromBufferAttribute(s,e);const l=this.morphTargetInfluences;if(r&&l){JE.set(0,0,0);for(let c=0,u=r.length;c<u;c++){const h=l[c],f=r[c];h!==0&&(jD.fromBufferAttribute(f,e),o?JE.addScaledVector(jD,h):JE.addScaledVector(jD.sub(n),h))}n.add(JE)}return n}raycast(e,n){const i=this.geometry,s=this.material,r=this.matrixWorld;s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),KE.copy(i.boundingSphere),KE.applyMatrix4(r),sA.copy(e.ray).recast(e.near),!(KE.containsPoint(sA.origin)===!1&&(sA.intersectSphere(KE,eH)===null||sA.origin.distanceToSquared(eH)>(e.far-e.near)**2))&&(Zq.copy(r).invert(),sA.copy(e.ray).applyMatrix4(Zq),!(i.boundingBox!==null&&sA.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,sA)))}_computeIntersections(e,n,i){let s;const r=this.geometry,o=this.material,l=r.index,c=r.attributes.position,u=r.attributes.uv,h=r.attributes.uv1,f=r.attributes.normal,m=r.groups,A=r.drawRange;if(l!==null)if(Array.isArray(o))for(let x=0,T=m.length;x<T;x++){const E=m[x],M=o[E.materialIndex],N=Math.max(E.start,A.start),I=Math.min(l.count,Math.min(E.start+E.count,A.start+A.count));for(let F=N,G=I;F<G;F+=3){const O=l.getX(F),D=l.getX(F+1),j=l.getX(F+2);s=eM(this,M,e,i,u,h,f,O,D,j),s&&(s.faceIndex=Math.floor(F/3),s.face.materialIndex=E.materialIndex,n.push(s))}}else{const x=Math.max(0,A.start),T=Math.min(l.count,A.start+A.count);for(let E=x,M=T;E<M;E+=3){const N=l.getX(E),I=l.getX(E+1),F=l.getX(E+2);s=eM(this,o,e,i,u,h,f,N,I,F),s&&(s.faceIndex=Math.floor(E/3),n.push(s))}}else if(c!==void 0)if(Array.isArray(o))for(let x=0,T=m.length;x<T;x++){const E=m[x],M=o[E.materialIndex],N=Math.max(E.start,A.start),I=Math.min(c.count,Math.min(E.start+E.count,A.start+A.count));for(let F=N,G=I;F<G;F+=3){const O=F,D=F+1,j=F+2;s=eM(this,M,e,i,u,h,f,O,D,j),s&&(s.faceIndex=Math.floor(F/3),s.face.materialIndex=E.materialIndex,n.push(s))}}else{const x=Math.max(0,A.start),T=Math.min(c.count,A.start+A.count);for(let E=x,M=T;E<M;E+=3){const N=E,I=E+1,F=E+2;s=eM(this,o,e,i,u,h,f,N,I,F),s&&(s.faceIndex=Math.floor(E/3),n.push(s))}}}}function QEe(a,e,n,i,s,r,o,l){let c;if(e.side===Di?c=i.intersectTriangle(o,r,s,!0,l):c=i.intersectTriangle(s,r,o,e.side===Ac,l),c===null)return null;ZE.copy(l),ZE.applyMatrix4(a.matrixWorld);const u=n.ray.origin.distanceTo(ZE);return u<n.near||u>n.far?null:{distance:u,point:ZE.clone(),object:a}}function eM(a,e,n,i,s,r,o,l,c,u){a.getVertexPosition(l,YE),a.getVertexPosition(c,XE),a.getVertexPosition(u,QE);const h=QEe(a,e,n,i,YE,XE,QE,tH);if(h){const f=new ye;uc.getBarycoord(tH,YE,XE,QE,f),s&&(h.uv=uc.getInterpolatedAttribute(s,l,c,u,f,new Nt)),r&&(h.uv1=uc.getInterpolatedAttribute(r,l,c,u,f,new Nt)),o&&(h.normal=uc.getInterpolatedAttribute(o,l,c,u,f,new ye),h.normal.dot(i.direction)>0&&h.normal.multiplyScalar(-1));const m={a:l,b:c,c:u,normal:new ye,materialIndex:0};uc.getNormal(YE,XE,QE,m.normal),h.face=m,h.barycoord=f}return h}class Yf extends zn{constructor(e=1,n=1,i=1,s=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:s,heightSegments:r,depthSegments:o};const l=this;s=Math.floor(s),r=Math.floor(r),o=Math.floor(o);const c=[],u=[],h=[],f=[];let m=0,A=0;x("z","y","x",-1,-1,i,n,e,o,r,0),x("z","y","x",1,-1,i,n,-e,o,r,1),x("x","z","y",1,1,e,i,n,s,o,2),x("x","z","y",1,-1,e,i,-n,s,o,3),x("x","y","z",1,-1,e,n,i,s,r,4),x("x","y","z",-1,-1,e,n,-i,s,r,5),this.setIndex(c),this.setAttribute("position",new mn(u,3)),this.setAttribute("normal",new mn(h,3)),this.setAttribute("uv",new mn(f,2));function x(T,E,M,N,I,F,G,O,D,j,L){const U=F/D,q=G/j,K=F/2,H=G/2,X=O/2,ne=D+1,Q=j+1;let Y=0,ue=0;const pe=new ye;for(let Ee=0;Ee<Q;Ee++){const oe=Ee*q-H;for(let Ae=0;Ae<ne;Ae++){const be=Ae*U-K;pe[T]=be*N,pe[E]=oe*I,pe[M]=X,u.push(pe.x,pe.y,pe.z),pe[T]=0,pe[E]=0,pe[M]=O>0?1:-1,h.push(pe.x,pe.y,pe.z),f.push(Ae/D),f.push(1-Ee/j),Y+=1}}for(let Ee=0;Ee<j;Ee++)for(let oe=0;oe<D;oe++){const Ae=m+oe+ne*Ee,be=m+oe+ne*(Ee+1),Ce=m+(oe+1)+ne*(Ee+1),ce=m+(oe+1)+ne*Ee;c.push(Ae,be,ce),c.push(be,Ce,ce),ue+=6}l.addGroup(A,ue,L),A+=ue,m+=Y}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yf(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function sx(a){const e={};for(const n in a){e[n]={};for(const i in a[n]){const s=a[n][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(yt("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=s.clone():Array.isArray(s)?e[n][i]=s.slice():e[n][i]=s}}return e}function Sl(a){const e={};for(let n=0;n<a.length;n++){const i=sx(a[n]);for(const s in i)e[s]=i[s]}return e}function JEe(a){const e=[];for(let n=0;n<a.length;n++)e.push(a[n].clone());return e}function Tee(a){const e=a.getRenderTarget();return e===null?a.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Vn.workingColorSpace}const XT={clone:sx,merge:Sl};var ZEe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,eMe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class mo extends po{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=ZEe,this.fragmentShader=eMe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=sx(e.uniforms),this.uniformsGroups=JEe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const s in this.uniforms){const o=this.uniforms[s].value;o&&o.isTexture?n.uniforms[s]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?n.uniforms[s]={type:"c",value:o.getHex()}:o&&o.isVector2?n.uniforms[s]={type:"v2",value:o.toArray()}:o&&o.isVector3?n.uniforms[s]={type:"v3",value:o.toArray()}:o&&o.isVector4?n.uniforms[s]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?n.uniforms[s]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?n.uniforms[s]={type:"m4",value:o.toArray()}:n.uniforms[s]={value:o}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const s in this.extensions)this.extensions[s]===!0&&(i[s]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class u1 extends ni{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new _n,this.projectionMatrix=new _n,this.projectionMatrixInverse=new _n,this.coordinateSystem=Ro,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const ug=new ye,nH=new Nt,aH=new Nt;class Zs extends u1{constructor(e=50,n=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Yy*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(JA*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Yy*2*Math.atan(Math.tan(JA*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){ug.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(ug.x,ug.y).multiplyScalar(-e/ug.z),ug.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(ug.x,ug.y).multiplyScalar(-e/ug.z)}getViewSize(e,n){return this.getViewBounds(e,nH,aH),n.subVectors(aH,nH)}setViewOffset(e,n,i,s,r,o){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(JA*.5*this.fov)/this.zoom,i=2*n,s=this.aspect*i,r=-.5*s;const o=this.view;if(this.view!==null&&this.view.enabled){const c=o.fullWidth,u=o.fullHeight;r+=o.offsetX*s/c,n-=o.offsetY*i/u,s*=o.width/c,i*=o.height/u}const l=this.filmOffset;l!==0&&(r+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+s,n,n-i,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const mv=-90,gv=1;class rj extends ni{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Zs(mv,gv,e,n);s.layers=this.layers,this.add(s);const r=new Zs(mv,gv,e,n);r.layers=this.layers,this.add(r);const o=new Zs(mv,gv,e,n);o.layers=this.layers,this.add(o);const l=new Zs(mv,gv,e,n);l.layers=this.layers,this.add(l);const c=new Zs(mv,gv,e,n);c.layers=this.layers,this.add(c);const u=new Zs(mv,gv,e,n);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,s,r,o,l,c]=n;for(const u of n)this.remove(u);if(e===Ro)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===bc)i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of n)this.add(u),u.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,o,l,c,u,h]=this.children,f=e.getRenderTarget(),m=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),x=e.xr.enabled;e.xr.enabled=!1;const T=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,s),e.render(n,r),e.setRenderTarget(i,1,s),e.render(n,o),e.setRenderTarget(i,2,s),e.render(n,l),e.setRenderTarget(i,3,s),e.render(n,c),e.setRenderTarget(i,4,s),e.render(n,u),i.texture.generateMipmaps=T,e.setRenderTarget(i,5,s),e.render(n,h),e.setRenderTarget(f,m,A),e.xr.enabled=x,i.texture.needsPMREMUpdate=!0}}class M0 extends _s{constructor(e=[],n=xc,i,s,r,o,l,c,u,h){super(e,n,i,s,r,o,l,c,u,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class QP extends vc{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},s=[i,i,i,i,i,i];this.texture=new M0(s),this._setTextureOptions(n),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new Yf(5,5,5),r=new mo({name:"CubemapFromEquirect",uniforms:sx(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Di,blending:hl});r.uniforms.tEquirect.value=n;const o=new Na(s,r),l=n.minFilter;return n.minFilter===No&&(n.minFilter=di),new rj(1,10,this).update(e,o),n.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,n=!0,i=!0,s=!0){const r=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(n,i,s);e.setRenderTarget(r)}}let ll=class extends ni{constructor(){super(),this.isGroup=!0,this.type="Group"}};const tMe={type:"move"};class lS{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ll,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ll,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ye,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ye),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ll,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ye,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ye),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let s=null,r=null,o=null;const l=this._targetRay,c=this._grip,u=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const T of e.hand.values()){const E=n.getJointPose(T,i),M=this._getHandJoint(u,T);E!==null&&(M.matrix.fromArray(E.transform.matrix),M.matrix.decompose(M.position,M.rotation,M.scale),M.matrixWorldNeedsUpdate=!0,M.jointRadius=E.radius),M.visible=E!==null}const h=u.joints["index-finger-tip"],f=u.joints["thumb-tip"],m=h.position.distanceTo(f.position),A=.02,x=.005;u.inputState.pinching&&m>A+x?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&m<=A-x&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(r=n.getPose(e.gripSpace,i),r!==null&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1));l!==null&&(s=n.getPose(e.targetRaySpace,i),s===null&&r!==null&&(s=r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(tMe)))}return l!==null&&(l.visible=s!==null),c!==null&&(c.visible=r!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new ll;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}class JP{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new on(e),this.density=n}clone(){return new JP(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class ZP{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new on(e),this.near=n,this.far=i}clone(){return new ZP(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Vx extends ni{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new fo,this.environmentIntensity=1,this.environmentRotation=new fo,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class zx{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=m0,this.updateRanges=[],this.version=0,this.uuid=lu()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let s=0,r=this.stride;s<r;s++)this.array[e+s]=n.array[i+s];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=lu()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=lu()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const xl=new ye;class kl{constructor(e,n,i,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)xl.fromBufferAttribute(this,n),xl.applyMatrix4(e),this.setXYZ(n,xl.x,xl.y,xl.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)xl.fromBufferAttribute(this,n),xl.applyNormalMatrix(e),this.setXYZ(n,xl.x,xl.y,xl.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)xl.fromBufferAttribute(this,n),xl.transformDirection(e),this.setXYZ(n,xl.x,xl.y,xl.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=Ll(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=Da(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=Da(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=Da(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=Da(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=Da(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=Ll(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=Ll(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=Ll(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=Ll(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=Da(n,this.array),i=Da(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=Da(n,this.array),i=Da(i,this.array),s=Da(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=s,this}setXYZW(e,n,i,s,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=Da(n,this.array),i=Da(i,this.array),s=Da(s,this.array),r=Da(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=s,this.data.array[e+3]=r,this}clone(e){if(e===void 0){ix("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)n.push(this.data.array[s+r])}return new Ua(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new kl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){ix("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)n.push(this.data.array[s+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class e4 extends po{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new on(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Av;const Kb=new ye,yv=new ye,vv=new ye,_v=new Nt,Yb=new Nt,wee=new _n,tM=new ye,Xb=new ye,nM=new ye,iH=new Nt,BD=new Nt,sH=new Nt;class Eee extends ni{constructor(e=new e4){if(super(),this.isSprite=!0,this.type="Sprite",Av===void 0){Av=new zn;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new zx(n,5);Av.setIndex([0,1,2,0,2,3]),Av.setAttribute("position",new kl(i,3,0,!1)),Av.setAttribute("uv",new kl(i,2,3,!1))}this.geometry=Av,this.material=e,this.center=new Nt(.5,.5),this.count=1}raycast(e,n){e.camera===null&&Rt('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),yv.setFromMatrixScale(this.matrixWorld),wee.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),vv.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&yv.multiplyScalar(-vv.z);const i=this.material.rotation;let s,r;i!==0&&(r=Math.cos(i),s=Math.sin(i));const o=this.center;aM(tM.set(-.5,-.5,0),vv,o,yv,s,r),aM(Xb.set(.5,-.5,0),vv,o,yv,s,r),aM(nM.set(.5,.5,0),vv,o,yv,s,r),iH.set(0,0),BD.set(1,0),sH.set(1,1);let l=e.ray.intersectTriangle(tM,Xb,nM,!1,Kb);if(l===null&&(aM(Xb.set(-.5,.5,0),vv,o,yv,s,r),BD.set(0,1),l=e.ray.intersectTriangle(tM,nM,Xb,!1,Kb),l===null))return;const c=e.ray.origin.distanceTo(Kb);c<e.near||c>e.far||n.push({distance:c,point:Kb.clone(),uv:uc.getInterpolation(Kb,tM,Xb,nM,iH,BD,sH,new Nt),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function aM(a,e,n,i,s,r){_v.subVectors(a,n).addScalar(.5).multiply(i),s!==void 0?(Yb.x=r*_v.x-s*_v.y,Yb.y=s*_v.x+r*_v.y):Yb.copy(_v),a.copy(e),a.x+=Yb.x,a.y+=Yb.y,a.applyMatrix4(wee)}const iM=new ye,rH=new ye;class Mee extends ni{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,s=n.length;i<s;i++){const r=n[i];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const s=this.levels;let r;for(r=0;r<s.length&&!(n<s[r].distance);r++);return s.splice(r,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}removeLevel(e){const n=this.levels;for(let i=0;i<n.length;i++)if(n[i].distance===e){const s=n.splice(i,1);return this.remove(s[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,s;for(i=1,s=n.length;i<s;i++){let r=n[i].distance;if(n[i].object.visible&&(r-=r*n[i].hysteresis),e<r)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){iM.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(iM);this.getObjectForDistance(s).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){iM.setFromMatrixPosition(e.matrixWorld),rH.setFromMatrixPosition(this.matrixWorld);const i=iM.distanceTo(rH)/e.zoom;n[0].object.visible=!0;let s,r;for(s=1,r=n.length;s<r;s++){let o=n[s].distance;if(n[s].object.visible&&(o-=o*n[s].hysteresis),i>=o)n[s-1].object.visible=!1,n[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<r;s++)n[s].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let s=0,r=i.length;s<r;s++){const o=i[s];n.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return n}}const oH=new ye,lH=new qn,cH=new qn,nMe=new ye,uH=new _n,sM=new ye,UD=new Cr,dH=new _n,VD=new c1;class Cee extends Na{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=wk,this.bindMatrix=new _n,this.bindMatrixInverse=new _n,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Mr),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,sM),this.boundingBox.expandByPoint(sM)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Cr),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,sM),this.boundingSphere.expandByPoint(sM)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const i=this.material,s=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),UD.copy(this.boundingSphere),UD.applyMatrix4(s),e.ray.intersectsSphere(UD)!==!1&&(dH.copy(s).invert(),VD.copy(e.ray).applyMatrix4(dH),!(this.boundingBox!==null&&VD.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,VD)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new qn,n=this.geometry.attributes.skinWeight;for(let i=0,s=n.count;i<s;i++){e.fromBufferAttribute(n,i);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===wk?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===JZ?this.bindMatrixInverse.copy(this.bindMatrix).invert():yt("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,s=this.geometry;lH.fromBufferAttribute(s.attributes.skinIndex,e),cH.fromBufferAttribute(s.attributes.skinWeight,e),oH.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let r=0;r<4;r++){const o=cH.getComponent(r);if(o!==0){const l=lH.getComponent(r);uH.multiplyMatrices(i.bones[l].matrixWorld,i.boneInverses[l]),n.addScaledVector(nMe.copy(oH).applyMatrix4(uH),o)}}return n.applyMatrix4(this.bindMatrixInverse)}}class oj extends ni{constructor(){super(),this.isBone=!0,this.type="Bone"}}class cu extends _s{constructor(e=null,n=1,i=1,s,r,o,l,c,u=Mi,h=Mi,f,m){super(null,o,l,c,u,h,s,r,f,m),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const hH=new _n,aMe=new _n;class t4{constructor(e=[],n=[]){this.uuid=lu(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){yt("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,s=this.bones.length;i<s;i++)this.boneInverses.push(new _n)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new _n;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,s=this.boneTexture;for(let r=0,o=e.length;r<o;r++){const l=e[r]?e[r].matrixWorld:aMe;hH.multiplyMatrices(l,n[r]),hH.toArray(i,r*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new t4(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new cu(n,e,e,fs,ls);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const s=this.bones[n];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,s=e.bones.length;i<s;i++){const r=e.bones[i];let o=n[r];o===void 0&&(yt("Skeleton: No bone found with UUID:",r),o=new oj),this.bones.push(o),this.boneInverses.push(new _n().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let s=0,r=n.length;s<r;s++){const o=n[s];e.bones.push(o.uuid);const l=i[s];e.boneInverses.push(l.toArray())}return e}}class _c extends Ua{constructor(e,n,i,s=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const xv=new _n,fH=new _n,rM=[],pH=new Mr,iMe=new _n,Qb=new Na,Jb=new Cr;class Nee extends Na{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new _c(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<i;s++)this.setMatrixAt(s,iMe)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new Mr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,xv),pH.copy(e.boundingBox).applyMatrix4(xv),this.boundingBox.union(pH)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new Cr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,xv),Jb.copy(e.boundingSphere).applyMatrix4(xv),this.boundingSphere.union(Jb)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,n){const i=n.morphTargetInfluences,s=this.morphTexture.source.data.data,r=i.length+1,o=e*r+1;for(let l=0;l<i.length;l++)i[l]=s[o+l]}raycast(e,n){const i=this.matrixWorld,s=this.count;if(Qb.geometry=this.geometry,Qb.material=this.material,Qb.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Jb.copy(this.boundingSphere),Jb.applyMatrix4(i),e.ray.intersectsSphere(Jb)!==!1))for(let r=0;r<s;r++){this.getMatrixAt(r,xv),fH.multiplyMatrices(i,xv),Qb.matrixWorld=fH,Qb.raycast(e,rM);for(let o=0,l=rM.length;o<l;o++){const c=rM[o];c.instanceId=r,c.object=this,n.push(c)}rM.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new _c(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,n){const i=n.morphTargetInfluences,s=i.length+1;this.morphTexture===null&&(this.morphTexture=new cu(new Float32Array(s*this.count),s,this.count,r1,ls));const r=this.morphTexture.source.data.data;let o=0;for(let u=0;u<i.length;u++)o+=i[u];const l=this.geometry.morphTargetsRelative?1:1-o,c=s*e;r[c]=l,r.set(i,c+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const zD=new ye,sMe=new ye,rMe=new ga;class Nd{constructor(e=new ye(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,s){return this.normal.set(e,n,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const s=zD.subVectors(i,n).cross(sMe.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(zD),s=this.normal.dot(i);if(s===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/s;return r<0||r>1?null:n.copy(e.start).addScaledVector(i,r)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||rMe.getNormalMatrix(e),s=this.coplanarPoint(zD).applyMatrix4(e),r=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const rA=new Cr,oMe=new Nt(.5,.5),oM=new ye;class C0{constructor(e=new Nd,n=new Nd,i=new Nd,s=new Nd,r=new Nd,o=new Nd){this.planes=[e,n,i,s,r,o]}set(e,n,i,s,r,o){const l=this.planes;return l[0].copy(e),l[1].copy(n),l[2].copy(i),l[3].copy(s),l[4].copy(r),l[5].copy(o),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=Ro,i=!1){const s=this.planes,r=e.elements,o=r[0],l=r[1],c=r[2],u=r[3],h=r[4],f=r[5],m=r[6],A=r[7],x=r[8],T=r[9],E=r[10],M=r[11],N=r[12],I=r[13],F=r[14],G=r[15];if(s[0].setComponents(u-o,A-h,M-x,G-N).normalize(),s[1].setComponents(u+o,A+h,M+x,G+N).normalize(),s[2].setComponents(u+l,A+f,M+T,G+I).normalize(),s[3].setComponents(u-l,A-f,M-T,G-I).normalize(),i)s[4].setComponents(c,m,E,F).normalize(),s[5].setComponents(u-c,A-m,M-E,G-F).normalize();else if(s[4].setComponents(u-c,A-m,M-E,G-F).normalize(),n===Ro)s[5].setComponents(u+c,A+m,M+E,G+F).normalize();else if(n===bc)s[5].setComponents(c,m,E,F).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),rA.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),rA.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(rA)}intersectsSprite(e){rA.center.set(0,0,0);const n=oMe.distanceTo(e.center);return rA.radius=.7071067811865476+n,rA.applyMatrix4(e.matrixWorld),this.intersectsSphere(rA)}intersectsSphere(e){const n=this.planes,i=e.center,s=-e.radius;for(let r=0;r<6;r++)if(n[r].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const s=n[i];if(oM.x=s.normal.x>0?e.max.x:e.min.x,oM.y=s.normal.y>0?e.max.y:e.min.y,oM.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(oM)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const xh=new _n,bh=new C0;class QT{constructor(){this.coordinateSystem=Ro}intersectsObject(e,n){if(!n.isArrayCamera||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(xh.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),bh.setFromProjectionMatrix(xh,s.coordinateSystem,s.reversedDepth),bh.intersectsObject(e))return!0}return!1}intersectsSprite(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(xh.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),bh.setFromProjectionMatrix(xh,s.coordinateSystem,s.reversedDepth),bh.intersectsSprite(e))return!0}return!1}intersectsSphere(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(xh.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),bh.setFromProjectionMatrix(xh,s.coordinateSystem,s.reversedDepth),bh.intersectsSphere(e))return!0}return!1}intersectsBox(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(xh.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),bh.setFromProjectionMatrix(xh,s.coordinateSystem,s.reversedDepth),bh.intersectsBox(e))return!0}return!1}containsPoint(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(xh.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),bh.setFromProjectionMatrix(xh,s.coordinateSystem,s.reversedDepth),bh.containsPoint(e))return!0}return!1}clone(){return new QT}}function GD(a,e){return a-e}function lMe(a,e){return a.z-e.z}function cMe(a,e){return e.z-a.z}class uMe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,n,i,s){const r=this.pool,o=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const l=r[this.index];o.push(l),this.index++,l.start=e,l.count=n,l.z=i,l.index=s}reset(){this.list.length=0,this.index=0}}const nc=new _n,dMe=new on(1,1,1),mH=new C0,hMe=new QT,lM=new Mr,oA=new Cr,Zb=new ye,gH=new ye,fMe=new ye,qD=new uMe,Zo=new Na,cM=[];function pMe(a,e,n=0){const i=e.itemSize;if(a.isInterleavedBufferAttribute||a.array.constructor!==e.array.constructor){const s=a.count;for(let r=0;r<s;r++)for(let o=0;o<i;o++)e.setComponent(r+n,o,a.getComponent(r,o))}else e.array.set(a.array,n*i);e.needsUpdate=!0}function lA(a,e){if(a.constructor!==e.constructor){const n=Math.min(a.length,e.length);for(let i=0;i<n;i++)e[i]=a[i]}else{const n=Math.min(a.length,e.length);e.set(new a.constructor(a.buffer,0,n))}}class Ree extends Na{constructor(e,n,i=n*2,s){super(new zn,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=n,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4),i=new cu(n,e,e,fs,ls);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Uint32Array(e*e),i=new cu(n,e,e,E0,Ei);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Float32Array(e*e*4).fill(1),i=new cu(n,e,e,fs,ls);i.colorSpace=Vn.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const n=this.geometry,i=this._maxVertexCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const r in e.attributes){const o=e.getAttribute(r),{array:l,itemSize:c,normalized:u}=o,h=new l.constructor(i*c),f=new Ua(h,c,u);n.setAttribute(r,f)}if(e.getIndex()!==null){const r=i>65535?new Uint32Array(s):new Uint16Array(s);n.setIndex(new Ua(r,1))}this._geometryInitialized=!0}}_validateGeometry(e){const n=this.geometry;if(!!e.getIndex()!=!!n.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const i in n.attributes){if(!e.hasAttribute(i))throw new Error(`THREE.BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const s=e.getAttribute(i),r=n.getAttribute(i);if(s.itemSize!==r.itemSize||s.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const n=this._instanceInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const n=this._geometryInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Mr);const e=this.boundingBox,n=this._instanceInfo;e.makeEmpty();for(let i=0,s=n.length;i<s;i++){if(n[i].active===!1)continue;const r=n[i].geometryIndex;this.getMatrixAt(i,nc),this.getBoundingBoxAt(r,lM).applyMatrix4(nc),e.union(lM)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Cr);const e=this.boundingSphere,n=this._instanceInfo;e.makeEmpty();for(let i=0,s=n.length;i<s;i++){if(n[i].active===!1)continue;const r=n[i].geometryIndex;this.getMatrixAt(i,nc),this.getBoundingSphereAt(r,oA).applyMatrix4(nc),e.union(oA)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const i={visible:!0,active:!0,geometryIndex:e};let s=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(GD),s=this._availableInstanceIds.shift(),this._instanceInfo[s]=i):(s=this._instanceInfo.length,this._instanceInfo.push(i));const r=this._matricesTexture;nc.identity().toArray(r.image.data,s*16),r.needsUpdate=!0;const o=this._colorsTexture;return o&&(dMe.toArray(o.image.data,s*4),o.needsUpdate=!0),this._visibilityChanged=!0,s}addGeometry(e,n=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);const s={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;s.vertexStart=this._nextVertexStart,s.reservedVertexCount=n===-1?e.getAttribute("position").count:n;const o=e.getIndex();if(o!==null&&(s.indexStart=this._nextIndexStart,s.reservedIndexCount=i===-1?o.count:i),s.indexStart!==-1&&s.indexStart+s.reservedIndexCount>this._maxIndexCount||s.vertexStart+s.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let c;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(GD),c=this._availableGeometryIds.shift(),r[c]=s):(c=this._geometryCount,this._geometryCount++,r.push(s)),this.setGeometryAt(c,e),this._nextIndexStart=s.indexStart+s.reservedIndexCount,this._nextVertexStart=s.vertexStart+s.reservedVertexCount,c}setGeometryAt(e,n){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(n);const i=this.geometry,s=i.getIndex()!==null,r=i.getIndex(),o=n.getIndex(),l=this._geometryInfo[e];if(s&&o.count>l.reservedIndexCount||n.attributes.position.count>l.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const c=l.vertexStart,u=l.reservedVertexCount;l.vertexCount=n.getAttribute("position").count;for(const h in i.attributes){const f=n.getAttribute(h),m=i.getAttribute(h);pMe(f,m,c);const A=f.itemSize;for(let x=f.count,T=u;x<T;x++){const E=c+x;for(let M=0;M<A;M++)m.setComponent(E,M,0)}m.needsUpdate=!0,m.addUpdateRange(c*A,u*A)}if(s){const h=l.indexStart,f=l.reservedIndexCount;l.indexCount=n.getIndex().count;for(let m=0;m<o.count;m++)r.setX(h+m,c+o.getX(m));for(let m=o.count,A=f;m<A;m++)r.setX(h+m,c);r.needsUpdate=!0,r.addUpdateRange(h,l.reservedIndexCount)}return l.start=s?l.indexStart:l.vertexStart,l.count=s?l.indexCount:l.vertexCount,l.boundingBox=null,n.boundingBox!==null&&(l.boundingBox=n.boundingBox.clone()),l.boundingSphere=null,n.boundingSphere!==null&&(l.boundingSphere=n.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const n=this._geometryInfo;if(e>=n.length||n[e].active===!1)return this;const i=this._instanceInfo;for(let s=0,r=i.length;s<r;s++)i[s].active&&i[s].geometryIndex===e&&this.deleteInstance(s);return n[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,n=0;const i=this._geometryInfo,s=i.map((o,l)=>l).sort((o,l)=>i[o].vertexStart-i[l].vertexStart),r=this.geometry;for(let o=0,l=i.length;o<l;o++){const c=s[o],u=i[c];if(u.active!==!1){if(r.index!==null){if(u.indexStart!==n){const{indexStart:h,vertexStart:f,reservedIndexCount:m}=u,A=r.index,x=A.array,T=e-f;for(let E=h;E<h+m;E++)x[E]=x[E]+T;A.array.copyWithin(n,h,h+m),A.addUpdateRange(n,m),A.needsUpdate=!0,u.indexStart=n}n+=u.reservedIndexCount}if(u.vertexStart!==e){const{vertexStart:h,reservedVertexCount:f}=u,m=r.attributes;for(const A in m){const x=m[A],{array:T,itemSize:E}=x;T.copyWithin(e*E,h*E,(h+f)*E),x.addUpdateRange(e*E,f*E),x.needsUpdate=!0}u.vertexStart=e}e+=u.reservedVertexCount,u.start=r.index?u.indexStart:u.vertexStart,this._nextIndexStart=r.index?u.indexStart+u.reservedIndexCount:0,this._nextVertexStart=u.vertexStart+u.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,s=this._geometryInfo[e];if(s.boundingBox===null){const r=new Mr,o=i.index,l=i.attributes.position;for(let c=s.start,u=s.start+s.count;c<u;c++){let h=c;o&&(h=o.getX(h)),r.expandByPoint(Zb.fromBufferAttribute(l,h))}s.boundingBox=r}return n.copy(s.boundingBox),n}getBoundingSphereAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,s=this._geometryInfo[e];if(s.boundingSphere===null){const r=new Cr;this.getBoundingBoxAt(e,lM),lM.getCenter(r.center);const o=i.index,l=i.attributes.position;let c=0;for(let u=s.start,h=s.start+s.count;u<h;u++){let f=u;o&&(f=o.getX(f)),Zb.fromBufferAttribute(l,f),c=Math.max(c,r.center.distanceToSquared(Zb))}r.radius=Math.sqrt(c),s.boundingSphere=r}return n.copy(s.boundingSphere),n}setMatrixAt(e,n){this.validateInstanceId(e);const i=this._matricesTexture,s=this._matricesTexture.image.data;return n.toArray(s,e*16),i.needsUpdate=!0,this}getMatrixAt(e,n){return this.validateInstanceId(e),n.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,n){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),n.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,n){return this.validateInstanceId(e),n.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,n){return this.validateInstanceId(e),this._instanceInfo[e].visible===n?this:(this._instanceInfo[e].visible=n,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,n){return this.validateInstanceId(e),this.validateGeometryId(n),this._instanceInfo[e].geometryIndex=n,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,n={}){this.validateGeometryId(e);const i=this._geometryInfo[e];return n.vertexStart=i.vertexStart,n.vertexCount=i.vertexCount,n.reservedVertexCount=i.reservedVertexCount,n.indexStart=i.indexStart,n.indexCount=i.indexCount,n.reservedIndexCount=i.reservedIndexCount,n.start=i.start,n.count=i.count,n}setInstanceCount(e){const n=this._availableInstanceIds,i=this._instanceInfo;for(n.sort(GD);n[n.length-1]===i.length-1;)i.pop(),n.pop();if(e<i.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const s=new Int32Array(e),r=new Int32Array(e);lA(this._multiDrawCounts,s),lA(this._multiDrawStarts,r),this._multiDrawCounts=s,this._multiDrawStarts=r,this._maxInstanceCount=e;const o=this._indirectTexture,l=this._matricesTexture,c=this._colorsTexture;o.dispose(),this._initIndirectTexture(),lA(o.image.data,this._indirectTexture.image.data),l.dispose(),this._initMatricesTexture(),lA(l.image.data,this._matricesTexture.image.data),c&&(c.dispose(),this._initColorsTexture(),lA(c.image.data,this._colorsTexture.image.data))}setGeometrySize(e,n){const i=[...this._geometryInfo].filter(l=>l.active);if(Math.max(...i.map(l=>l.vertexStart+l.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${n}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...i.map(c=>c.indexStart+c.reservedIndexCount))>n)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${n}. Cannot shrink further.`);const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=n,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new zn,this._initializeGeometry(r));const o=this.geometry;r.index&&lA(r.index.array,o.index.array);for(const l in r.attributes)lA(r.attributes[l].array,o.attributes[l].array)}raycast(e,n){const i=this._instanceInfo,s=this._geometryInfo,r=this.matrixWorld,o=this.geometry;Zo.material=this.material,Zo.geometry.index=o.index,Zo.geometry.attributes=o.attributes,Zo.geometry.boundingBox===null&&(Zo.geometry.boundingBox=new Mr),Zo.geometry.boundingSphere===null&&(Zo.geometry.boundingSphere=new Cr);for(let l=0,c=i.length;l<c;l++){if(!i[l].visible||!i[l].active)continue;const u=i[l].geometryIndex,h=s[u];Zo.geometry.setDrawRange(h.start,h.count),this.getMatrixAt(l,Zo.matrixWorld).premultiply(r),this.getBoundingBoxAt(u,Zo.geometry.boundingBox),this.getBoundingSphereAt(u,Zo.geometry.boundingSphere),Zo.raycast(e,cM);for(let f=0,m=cM.length;f<m;f++){const A=cM[f];A.object=this,A.batchId=l,n.push(A)}cM.length=0}Zo.material=null,Zo.geometry.index=null,Zo.geometry.attributes={},Zo.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(n=>({...n,boundingBox:n.boundingBox!==null?n.boundingBox.clone():null,boundingSphere:n.boundingSphere!==null?n.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(n=>({...n})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,n,i,s,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=s.getIndex(),l=o===null?1:o.array.BYTES_PER_ELEMENT,c=this._instanceInfo,u=this._multiDrawStarts,h=this._multiDrawCounts,f=this._geometryInfo,m=this.perObjectFrustumCulled,A=this._indirectTexture,x=A.image.data,T=i.isArrayCamera?hMe:mH;m&&!i.isArrayCamera&&(nc.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),mH.setFromProjectionMatrix(nc,i.coordinateSystem,i.reversedDepth));let E=0;if(this.sortObjects){nc.copy(this.matrixWorld).invert(),Zb.setFromMatrixPosition(i.matrixWorld).applyMatrix4(nc),gH.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(nc);for(let I=0,F=c.length;I<F;I++)if(c[I].visible&&c[I].active){const G=c[I].geometryIndex;this.getMatrixAt(I,nc),this.getBoundingSphereAt(G,oA).applyMatrix4(nc);let O=!1;if(m&&(O=!T.intersectsSphere(oA,i)),!O){const D=f[G],j=fMe.subVectors(oA.center,Zb).dot(gH);qD.push(D.start,D.count,j,I)}}const M=qD.list,N=this.customSort;N===null?M.sort(r.transparent?cMe:lMe):N.call(this,M,i);for(let I=0,F=M.length;I<F;I++){const G=M[I];u[E]=G.start*l,h[E]=G.count,x[E]=G.index,E++}qD.reset()}else for(let M=0,N=c.length;M<N;M++)if(c[M].visible&&c[M].active){const I=c[M].geometryIndex;let F=!1;if(m&&(this.getMatrixAt(M,nc),this.getBoundingSphereAt(I,oA).applyMatrix4(nc),F=!T.intersectsSphere(oA,i)),!F){const G=f[I];u[E]=G.start*l,h[E]=G.count,x[E]=M,E++}}A.needsUpdate=!0,this._multiDrawCount=E,this._visibilityChanged=!1}onBeforeShadow(e,n,i,s,r,o){this.onBeforeRender(e,null,s,r,o)}}class Hr extends po{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new on(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const NN=new ye,RN=new ye,AH=new _n,e2=new c1,uM=new Cr,HD=new ye,yH=new ye;class Kd extends ni{constructor(e=new zn,n=new Hr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let s=1,r=n.count;s<r;s++)NN.fromBufferAttribute(n,s-1),RN.fromBufferAttribute(n,s),i[s]=i[s-1],i[s]+=NN.distanceTo(RN);e.setAttribute("lineDistance",new mn(i,1))}else yt("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,s=this.matrixWorld,r=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),uM.copy(i.boundingSphere),uM.applyMatrix4(s),uM.radius+=r,e.ray.intersectsSphere(uM)===!1)return;AH.copy(s).invert(),e2.copy(e.ray).applyMatrix4(AH);const l=r/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,u=this.isLineSegments?2:1,h=i.index,m=i.attributes.position;if(h!==null){const A=Math.max(0,o.start),x=Math.min(h.count,o.start+o.count);for(let T=A,E=x-1;T<E;T+=u){const M=h.getX(T),N=h.getX(T+1),I=dM(this,e,e2,c,M,N,T);I&&n.push(I)}if(this.isLineLoop){const T=h.getX(x-1),E=h.getX(A),M=dM(this,e,e2,c,T,E,x-1);M&&n.push(M)}}else{const A=Math.max(0,o.start),x=Math.min(m.count,o.start+o.count);for(let T=A,E=x-1;T<E;T+=u){const M=dM(this,e,e2,c,T,T+1,T);M&&n.push(M)}if(this.isLineLoop){const T=dM(this,e,e2,c,x-1,A,x-1);T&&n.push(T)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const s=n[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const l=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=r}}}}}function dM(a,e,n,i,s,r,o){const l=a.geometry.attributes.position;if(NN.fromBufferAttribute(l,s),RN.fromBufferAttribute(l,r),n.distanceSqToSegment(NN,RN,HD,yH)>i)return;HD.applyMatrix4(a.matrixWorld);const u=e.ray.origin.distanceTo(HD);if(!(u<e.near||u>e.far))return{distance:u,point:yH.clone().applyMatrix4(a.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:a}}const vH=new ye,_H=new ye;class Zu extends Kd{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let s=0,r=n.count;s<r;s+=2)vH.fromBufferAttribute(n,s),_H.fromBufferAttribute(n,s+1),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+vH.distanceTo(_H);e.setAttribute("lineDistance",new mn(i,1))}else yt("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Pee extends Kd{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class JT extends po{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new on(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const xH=new _n,Ck=new c1,hM=new Cr,fM=new ye;class lj extends ni{constructor(e=new zn,n=new JT){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,s=this.matrixWorld,r=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),hM.copy(i.boundingSphere),hM.applyMatrix4(s),hM.radius+=r,e.ray.intersectsSphere(hM)===!1)return;xH.copy(s).invert(),Ck.copy(e.ray).applyMatrix4(xH);const l=r/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,u=i.index,f=i.attributes.position;if(u!==null){const m=Math.max(0,o.start),A=Math.min(u.count,o.start+o.count);for(let x=m,T=A;x<T;x++){const E=u.getX(x);fM.fromBufferAttribute(f,E),bH(fM,E,c,s,e,n,this)}}else{const m=Math.max(0,o.start),A=Math.min(f.count,o.start+o.count);for(let x=m,T=A;x<T;x++)fM.fromBufferAttribute(f,x),bH(fM,x,c,s,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const s=n[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const l=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=r}}}}}function bH(a,e,n,i,s,r,o){const l=Ck.distanceSqToPoint(a);if(l<n){const c=new ye;Ck.closestPointToPoint(a,c),c.applyMatrix4(i);const u=s.ray.origin.distanceTo(c);if(u<s.near||u>s.far)return;r.push({distance:u,distanceToRay:Math.sqrt(l),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class Iee extends _s{constructor(e,n,i,s,r=di,o=di,l,c,u){super(e,n,i,s,r,o,l,c,u),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const h=this;function f(){h.needsUpdate=!0,h._requestVideoFrameCallbackId=e.requestVideoFrameCallback(f)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(f))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class mMe extends Iee{constructor(e,n,i,s,r,o,l,c){super({},e,n,i,s,r,o,l,c),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class n4 extends _s{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=Mi,this.minFilter=Mi,this.generateMipmaps=!1,this.needsUpdate=!0}}class a4 extends _s{constructor(e,n,i,s,r,o,l,c,u,h,f,m){super(null,o,l,c,u,h,s,r,f,m),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class gMe extends a4{constructor(e,n,i,s,r,o){super(e,n,i,r,o),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=Ur,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class AMe extends a4{constructor(e,n,i){super(void 0,e[0].width,e[0].height,n,i,xc),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class yMe extends _s{constructor(e,n,i,s,r,o,l,c,u){super(e,n,i,s,r,o,l,c,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Do extends _s{constructor(e,n,i=Ei,s,r,o,l=Mi,c=Mi,u,h=ho,f=1){if(h!==ho&&h!==rl)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const m={width:e,height:n,depth:f};super(m,s,r,o,l,c,h,i,u),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Ug(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class cj extends Do{constructor(e,n=Ei,i=xc,s,r,o=Mi,l=Mi,c,u=ho){const h={width:e,height:e,depth:1},f=[h,h,h,h,h,h];super(e,e,n,i,s,r,o,l,c,u),this.image=f,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class uj extends _s{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class i4 extends zn{constructor(e=1,n=1,i=4,s=8,r=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:i,radialSegments:s,heightSegments:r},n=Math.max(0,n),i=Math.max(1,Math.floor(i)),s=Math.max(3,Math.floor(s)),r=Math.max(1,Math.floor(r));const o=[],l=[],c=[],u=[],h=n/2,f=Math.PI/2*e,m=n,A=2*f+m,x=i*2+r,T=s+1,E=new ye,M=new ye;for(let N=0;N<=x;N++){let I=0,F=0,G=0,O=0;if(N<=i){const L=N/i,U=L*Math.PI/2;F=-h-e*Math.cos(U),G=e*Math.sin(U),O=-e*Math.cos(U),I=L*f}else if(N<=i+r){const L=(N-i)/r;F=-h+L*n,G=e,O=0,I=f+L*m}else{const L=(N-i-r)/i,U=L*Math.PI/2;F=h+e*Math.sin(U),G=e*Math.cos(U),O=e*Math.sin(U),I=f+m+L*f}const D=Math.max(0,Math.min(1,I/A));let j=0;N===0?j=.5/s:N===x&&(j=-.5/s);for(let L=0;L<=s;L++){const U=L/s,q=U*Math.PI*2,K=Math.sin(q),H=Math.cos(q);M.x=-G*H,M.y=F,M.z=G*K,l.push(M.x,M.y,M.z),E.set(-G*H,O,G*K),E.normalize(),c.push(E.x,E.y,E.z),u.push(U+j,D)}if(N>0){const L=(N-1)*T;for(let U=0;U<s;U++){const q=L+U,K=L+U+1,H=N*T+U,X=N*T+U+1;o.push(q,K,H),o.push(K,X,H)}}}this.setIndex(o),this.setAttribute("position",new mn(l,3)),this.setAttribute("normal",new mn(c,3)),this.setAttribute("uv",new mn(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i4(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class Gx extends zn{constructor(e=1,n=32,i=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:s},n=Math.max(3,n);const r=[],o=[],l=[],c=[],u=new ye,h=new Nt;o.push(0,0,0),l.push(0,0,1),c.push(.5,.5);for(let f=0,m=3;f<=n;f++,m+=3){const A=i+f/n*s;u.x=e*Math.cos(A),u.y=e*Math.sin(A),o.push(u.x,u.y,u.z),l.push(0,0,1),h.x=(o[m]/e+1)/2,h.y=(o[m+1]/e+1)/2,c.push(h.x,h.y)}for(let f=1;f<=n;f++)r.push(f,f+1,0);this.setIndex(r),this.setAttribute("position",new mn(o,3)),this.setAttribute("normal",new mn(l,3)),this.setAttribute("uv",new mn(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Gx(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class d1 extends zn{constructor(e=1,n=1,i=1,s=32,r=1,o=!1,l=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:s,heightSegments:r,openEnded:o,thetaStart:l,thetaLength:c};const u=this;s=Math.floor(s),r=Math.floor(r);const h=[],f=[],m=[],A=[];let x=0;const T=[],E=i/2;let M=0;N(),o===!1&&(e>0&&I(!0),n>0&&I(!1)),this.setIndex(h),this.setAttribute("position",new mn(f,3)),this.setAttribute("normal",new mn(m,3)),this.setAttribute("uv",new mn(A,2));function N(){const F=new ye,G=new ye;let O=0;const D=(n-e)/i;for(let j=0;j<=r;j++){const L=[],U=j/r,q=U*(n-e)+e;for(let K=0;K<=s;K++){const H=K/s,X=H*c+l,ne=Math.sin(X),Q=Math.cos(X);G.x=q*ne,G.y=-U*i+E,G.z=q*Q,f.push(G.x,G.y,G.z),F.set(ne,D,Q).normalize(),m.push(F.x,F.y,F.z),A.push(H,1-U),L.push(x++)}T.push(L)}for(let j=0;j<s;j++)for(let L=0;L<r;L++){const U=T[L][j],q=T[L+1][j],K=T[L+1][j+1],H=T[L][j+1];(e>0||L!==0)&&(h.push(U,q,H),O+=3),(n>0||L!==r-1)&&(h.push(q,K,H),O+=3)}u.addGroup(M,O,0),M+=O}function I(F){const G=x,O=new Nt,D=new ye;let j=0;const L=F===!0?e:n,U=F===!0?1:-1;for(let K=1;K<=s;K++)f.push(0,E*U,0),m.push(0,U,0),A.push(.5,.5),x++;const q=x;for(let K=0;K<=s;K++){const X=K/s*c+l,ne=Math.cos(X),Q=Math.sin(X);D.x=L*Q,D.y=E*U,D.z=L*ne,f.push(D.x,D.y,D.z),m.push(0,U,0),O.x=ne*.5+.5,O.y=Q*.5*U+.5,A.push(O.x,O.y),x++}for(let K=0;K<s;K++){const H=G+K,X=q+K;F===!0?h.push(X,X+1,H):h.push(X+1,X,H),j+=3}u.addGroup(M,j,F===!0?1:2),M+=j}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new d1(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ZT extends d1{constructor(e=1,n=1,i=32,s=1,r=!1,o=0,l=Math.PI*2){super(0,e,n,i,s,r,o,l),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:s,openEnded:r,thetaStart:o,thetaLength:l}}static fromJSON(e){return new ZT(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class N0 extends zn{constructor(e=[],n=[],i=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:s};const r=[],o=[];l(s),u(i),h(),this.setAttribute("position",new mn(r,3)),this.setAttribute("normal",new mn(r.slice(),3)),this.setAttribute("uv",new mn(o,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function l(N){const I=new ye,F=new ye,G=new ye;for(let O=0;O<n.length;O+=3)A(n[O+0],I),A(n[O+1],F),A(n[O+2],G),c(I,F,G,N)}function c(N,I,F,G){const O=G+1,D=[];for(let j=0;j<=O;j++){D[j]=[];const L=N.clone().lerp(F,j/O),U=I.clone().lerp(F,j/O),q=O-j;for(let K=0;K<=q;K++)K===0&&j===O?D[j][K]=L:D[j][K]=L.clone().lerp(U,K/q)}for(let j=0;j<O;j++)for(let L=0;L<2*(O-j)-1;L++){const U=Math.floor(L/2);L%2===0?(m(D[j][U+1]),m(D[j+1][U]),m(D[j][U])):(m(D[j][U+1]),m(D[j+1][U+1]),m(D[j+1][U]))}}function u(N){const I=new ye;for(let F=0;F<r.length;F+=3)I.x=r[F+0],I.y=r[F+1],I.z=r[F+2],I.normalize().multiplyScalar(N),r[F+0]=I.x,r[F+1]=I.y,r[F+2]=I.z}function h(){const N=new ye;for(let I=0;I<r.length;I+=3){N.x=r[I+0],N.y=r[I+1],N.z=r[I+2];const F=E(N)/2/Math.PI+.5,G=M(N)/Math.PI+.5;o.push(F,1-G)}x(),f()}function f(){for(let N=0;N<o.length;N+=6){const I=o[N+0],F=o[N+2],G=o[N+4],O=Math.max(I,F,G),D=Math.min(I,F,G);O>.9&&D<.1&&(I<.2&&(o[N+0]+=1),F<.2&&(o[N+2]+=1),G<.2&&(o[N+4]+=1))}}function m(N){r.push(N.x,N.y,N.z)}function A(N,I){const F=N*3;I.x=e[F+0],I.y=e[F+1],I.z=e[F+2]}function x(){const N=new ye,I=new ye,F=new ye,G=new ye,O=new Nt,D=new Nt,j=new Nt;for(let L=0,U=0;L<r.length;L+=9,U+=6){N.set(r[L+0],r[L+1],r[L+2]),I.set(r[L+3],r[L+4],r[L+5]),F.set(r[L+6],r[L+7],r[L+8]),O.set(o[U+0],o[U+1]),D.set(o[U+2],o[U+3]),j.set(o[U+4],o[U+5]),G.copy(N).add(I).add(F).divideScalar(3);const q=E(G);T(O,U+0,N,q),T(D,U+2,I,q),T(j,U+4,F,q)}}function T(N,I,F,G){G<0&&N.x===1&&(o[I]=N.x-1),F.x===0&&F.z===0&&(o[I]=G/2/Math.PI+.5)}function E(N){return Math.atan2(N.z,-N.x)}function M(N){return Math.atan2(-N.y,Math.sqrt(N.x*N.x+N.z*N.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new N0(e.vertices,e.indices,e.radius,e.detail)}}class s4 extends N0{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,s=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-i,0,-s,i,0,s,-i,0,s,i,-s,-i,0,-s,i,0,s,-i,0,s,i,0,-i,0,-s,i,0,-s,-i,0,s,i,0,s],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,o,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new s4(e.radius,e.detail)}}const pM=new ye,mM=new ye,WD=new ye,gM=new uc;class Lee extends zn{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const s=Math.pow(10,4),r=Math.cos(JA*n),o=e.getIndex(),l=e.getAttribute("position"),c=o?o.count:l.count,u=[0,0,0],h=["a","b","c"],f=new Array(3),m={},A=[];for(let x=0;x<c;x+=3){o?(u[0]=o.getX(x),u[1]=o.getX(x+1),u[2]=o.getX(x+2)):(u[0]=x,u[1]=x+1,u[2]=x+2);const{a:T,b:E,c:M}=gM;if(T.fromBufferAttribute(l,u[0]),E.fromBufferAttribute(l,u[1]),M.fromBufferAttribute(l,u[2]),gM.getNormal(WD),f[0]=`${Math.round(T.x*s)},${Math.round(T.y*s)},${Math.round(T.z*s)}`,f[1]=`${Math.round(E.x*s)},${Math.round(E.y*s)},${Math.round(E.z*s)}`,f[2]=`${Math.round(M.x*s)},${Math.round(M.y*s)},${Math.round(M.z*s)}`,!(f[0]===f[1]||f[1]===f[2]||f[2]===f[0]))for(let N=0;N<3;N++){const I=(N+1)%3,F=f[N],G=f[I],O=gM[h[N]],D=gM[h[I]],j=`${F}_${G}`,L=`${G}_${F}`;L in m&&m[L]?(WD.dot(m[L].normal)<=r&&(A.push(O.x,O.y,O.z),A.push(D.x,D.y,D.z)),m[L]=null):j in m||(m[j]={index0:u[N],index1:u[I],normal:WD.clone()})}}for(const x in m)if(m[x]){const{index0:T,index1:E}=m[x];pM.fromBufferAttribute(l,T),mM.fromBufferAttribute(l,E),A.push(pM.x,pM.y,pM.z),A.push(mM.x,mM.y,mM.z)}this.setAttribute("position",new mn(A,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class ed{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){yt("Curve: .getPoint() not implemented.")}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,s=this.getPoint(0),r=0;n.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),r+=i.distanceTo(s),n.push(r),s=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n=null){const i=this.getLengths();let s=0;const r=i.length;let o;n?o=n:o=e*i[r-1];let l=0,c=r-1,u;for(;l<=c;)if(s=Math.floor(l+(c-l)/2),u=i[s]-o,u<0)l=s+1;else if(u>0)c=s-1;else{c=s;break}if(s=c,i[s]===o)return s/(r-1);const h=i[s],m=i[s+1]-h,A=(o-h)/m;return(s+A)/(r-1)}getTangent(e,n){let s=e-1e-4,r=e+1e-4;s<0&&(s=0),r>1&&(r=1);const o=this.getPoint(s),l=this.getPoint(r),c=n||(o.isVector2?new Nt:new ye);return c.copy(l).sub(o).normalize(),c}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n=!1){const i=new ye,s=[],r=[],o=[],l=new ye,c=new _n;for(let A=0;A<=e;A++){const x=A/e;s[A]=this.getTangentAt(x,new ye)}r[0]=new ye,o[0]=new ye;let u=Number.MAX_VALUE;const h=Math.abs(s[0].x),f=Math.abs(s[0].y),m=Math.abs(s[0].z);h<=u&&(u=h,i.set(1,0,0)),f<=u&&(u=f,i.set(0,1,0)),m<=u&&i.set(0,0,1),l.crossVectors(s[0],i).normalize(),r[0].crossVectors(s[0],l),o[0].crossVectors(s[0],r[0]);for(let A=1;A<=e;A++){if(r[A]=r[A-1].clone(),o[A]=o[A-1].clone(),l.crossVectors(s[A-1],s[A]),l.length()>Number.EPSILON){l.normalize();const x=Math.acos(ma(s[A-1].dot(s[A]),-1,1));r[A].applyMatrix4(c.makeRotationAxis(l,x))}o[A].crossVectors(s[A],r[A])}if(n===!0){let A=Math.acos(ma(r[0].dot(r[e]),-1,1));A/=e,s[0].dot(l.crossVectors(r[0],r[e]))>0&&(A=-A);for(let x=1;x<=e;x++)r[x].applyMatrix4(c.makeRotationAxis(s[x],A*x)),o[x].crossVectors(s[x],r[x])}return{tangents:s,normals:r,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class r4 extends ed{constructor(e=0,n=0,i=1,s=1,r=0,o=Math.PI*2,l=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=s,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=l,this.aRotation=c}getPoint(e,n=new Nt){const i=n,s=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=s;for(;r>s;)r-=s;r<Number.EPSILON&&(o?r=0:r=s),this.aClockwise===!0&&!o&&(r===s?r=-s:r=r-s);const l=this.aStartAngle+e*r;let c=this.aX+this.xRadius*Math.cos(l),u=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const h=Math.cos(this.aRotation),f=Math.sin(this.aRotation),m=c-this.aX,A=u-this.aY;c=m*h-A*f+this.aX,u=m*f+A*h+this.aY}return i.set(c,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Dee extends r4{constructor(e,n,i,s,r,o){super(e,n,i,i,s,r,o),this.isArcCurve=!0,this.type="ArcCurve"}}function dj(){let a=0,e=0,n=0,i=0;function s(r,o,l,c){a=r,e=l,n=-3*r+3*o-2*l-c,i=2*r-2*o+l+c}return{initCatmullRom:function(r,o,l,c,u){s(o,l,u*(l-r),u*(c-o))},initNonuniformCatmullRom:function(r,o,l,c,u,h,f){let m=(o-r)/u-(l-r)/(u+h)+(l-o)/h,A=(l-o)/h-(c-o)/(h+f)+(c-l)/f;m*=h,A*=h,s(o,l,m,A)},calc:function(r){const o=r*r,l=o*r;return a+e*r+n*o+i*l}}}const AM=new ye,$D=new dj,KD=new dj,YD=new dj;class kee extends ed{constructor(e=[],n=!1,i="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=s}getPoint(e,n=new ye){const i=n,s=this.points,r=s.length,o=(r-(this.closed?0:1))*e;let l=Math.floor(o),c=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:c===0&&l===r-1&&(l=r-2,c=1);let u,h;this.closed||l>0?u=s[(l-1)%r]:(AM.subVectors(s[0],s[1]).add(s[0]),u=AM);const f=s[l%r],m=s[(l+1)%r];if(this.closed||l+2<r?h=s[(l+2)%r]:(AM.subVectors(s[r-1],s[r-2]).add(s[r-1]),h=AM),this.curveType==="centripetal"||this.curveType==="chordal"){const A=this.curveType==="chordal"?.5:.25;let x=Math.pow(u.distanceToSquared(f),A),T=Math.pow(f.distanceToSquared(m),A),E=Math.pow(m.distanceToSquared(h),A);T<1e-4&&(T=1),x<1e-4&&(x=T),E<1e-4&&(E=T),$D.initNonuniformCatmullRom(u.x,f.x,m.x,h.x,x,T,E),KD.initNonuniformCatmullRom(u.y,f.y,m.y,h.y,x,T,E),YD.initNonuniformCatmullRom(u.z,f.z,m.z,h.z,x,T,E)}else this.curveType==="catmullrom"&&($D.initCatmullRom(u.x,f.x,m.x,h.x,this.tension),KD.initCatmullRom(u.y,f.y,m.y,h.y,this.tension),YD.initCatmullRom(u.z,f.z,m.z,h.z,this.tension));return i.set($D.calc(c),KD.calc(c),YD.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const s=this.points[n];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(new ye().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function SH(a,e,n,i,s){const r=(i-e)*.5,o=(s-n)*.5,l=a*a,c=a*l;return(2*n-2*i+r+o)*c+(-3*n+3*i-2*r-o)*l+r*a+n}function vMe(a,e){const n=1-a;return n*n*e}function _Me(a,e){return 2*(1-a)*a*e}function xMe(a,e){return a*a*e}function cS(a,e,n,i){return vMe(a,e)+_Me(a,n)+xMe(a,i)}function bMe(a,e){const n=1-a;return n*n*n*e}function SMe(a,e){const n=1-a;return 3*n*n*a*e}function TMe(a,e){return 3*(1-a)*a*a*e}function wMe(a,e){return a*a*a*e}function uS(a,e,n,i,s){return bMe(a,e)+SMe(a,n)+TMe(a,i)+wMe(a,s)}class hj extends ed{constructor(e=new Nt,n=new Nt,i=new Nt,s=new Nt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=s}getPoint(e,n=new Nt){const i=n,s=this.v0,r=this.v1,o=this.v2,l=this.v3;return i.set(uS(e,s.x,r.x,o.x,l.x),uS(e,s.y,r.y,o.y,l.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class fj extends ed{constructor(e=new ye,n=new ye,i=new ye,s=new ye){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=s}getPoint(e,n=new ye){const i=n,s=this.v0,r=this.v1,o=this.v2,l=this.v3;return i.set(uS(e,s.x,r.x,o.x,l.x),uS(e,s.y,r.y,o.y,l.y),uS(e,s.z,r.z,o.z,l.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class pj extends ed{constructor(e=new Nt,n=new Nt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Nt){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Nt){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Oee extends ed{constructor(e=new ye,n=new ye){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new ye){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new ye){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class mj extends ed{constructor(e=new Nt,n=new Nt,i=new Nt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Nt){const i=n,s=this.v0,r=this.v1,o=this.v2;return i.set(cS(e,s.x,r.x,o.x),cS(e,s.y,r.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class gj extends ed{constructor(e=new ye,n=new ye,i=new ye){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new ye){const i=n,s=this.v0,r=this.v1,o=this.v2;return i.set(cS(e,s.x,r.x,o.x),cS(e,s.y,r.y,o.y),cS(e,s.z,r.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Aj extends ed{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Nt){const i=n,s=this.points,r=(s.length-1)*e,o=Math.floor(r),l=r-o,c=s[o===0?o:o-1],u=s[o],h=s[o>s.length-2?s.length-1:o+1],f=s[o>s.length-3?s.length-1:o+2];return i.set(SH(l,c.x,u.x,h.x,f.x),SH(l,c.y,u.y,h.y,f.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const s=this.points[n];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(new Nt().fromArray(s))}return this}}var PN=Object.freeze({__proto__:null,ArcCurve:Dee,CatmullRomCurve3:kee,CubicBezierCurve:hj,CubicBezierCurve3:fj,EllipseCurve:r4,LineCurve:pj,LineCurve3:Oee,QuadraticBezierCurve:mj,QuadraticBezierCurve3:gj,SplineCurve:Aj});class Fee extends ed{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new PN[i](n,e))}return this}getPoint(e,n){const i=e*this.getLength(),s=this.getCurveLengths();let r=0;for(;r<s.length;){if(s[r]>=i){const o=s[r]-i,l=this.curves[r],c=l.getLength(),u=c===0?0:1-o/c;return l.getPointAt(u,n)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,s=this.curves.length;i<s;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let s=0,r=this.curves;s<r.length;s++){const o=r[s],l=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,c=o.getPoints(l);for(let u=0;u<c.length;u++){const h=c[u];i&&i.equals(h)||(n.push(h),i=h)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const s=e.curves[n];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const s=this.curves[n];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const s=e.curves[n];this.curves.push(new PN[s.type]().fromJSON(s))}return this}}let IN=class extends Fee{constructor(e){super(),this.type="Path",this.currentPoint=new Nt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new pj(this.currentPoint.clone(),new Nt(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,s){const r=new mj(this.currentPoint.clone(),new Nt(e,n),new Nt(i,s));return this.curves.push(r),this.currentPoint.set(i,s),this}bezierCurveTo(e,n,i,s,r,o){const l=new hj(this.currentPoint.clone(),new Nt(e,n),new Nt(i,s),new Nt(r,o));return this.curves.push(l),this.currentPoint.set(r,o),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new Aj(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,s,r,o){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+l,n+c,i,s,r,o),this}absarc(e,n,i,s,r,o){return this.absellipse(e,n,i,i,s,r,o),this}ellipse(e,n,i,s,r,o,l,c){const u=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+u,n+h,i,s,r,o,l,c),this}absellipse(e,n,i,s,r,o,l,c){const u=new r4(e,n,i,s,r,o,l,c);if(this.curves.length>0){const f=u.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(u);const h=u.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};class ZA extends IN{constructor(e){super(e),this.uuid=lu(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,s=this.holes.length;i<s;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const s=e.holes[n];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const s=this.holes[n];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const s=e.holes[n];this.holes.push(new IN().fromJSON(s))}return this}}function EMe(a,e,n=2){const i=e&&e.length,s=i?e[0]*n:a.length;let r=jee(a,0,s,n,!0);const o=[];if(!r||r.next===r.prev)return o;let l,c,u;if(i&&(r=PMe(a,e,r,n)),a.length>80*n){l=a[0],c=a[1];let h=l,f=c;for(let m=n;m<s;m+=n){const A=a[m],x=a[m+1];A<l&&(l=A),x<c&&(c=x),A>h&&(h=A),x>f&&(f=x)}u=Math.max(h-l,f-c),u=u!==0?32767/u:0}return GS(r,o,n,l,c,u,0),o}function jee(a,e,n,i,s){let r;if(s===zMe(a,e,n,i)>0)for(let o=e;o<n;o+=i)r=TH(o/i|0,a[o],a[o+1],r);else for(let o=n-i;o>=e;o-=i)r=TH(o/i|0,a[o],a[o+1],r);return r&&rx(r,r.next)&&(HS(r),r=r.next),r}function Qy(a,e){if(!a)return a;e||(e=a);let n=a,i;do if(i=!1,!n.steiner&&(rx(n,n.next)||js(n.prev,n,n.next)===0)){if(HS(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function GS(a,e,n,i,s,r,o){if(!a)return;!o&&r&&OMe(a,i,s,r);let l=a;for(;a.prev!==a.next;){const c=a.prev,u=a.next;if(r?CMe(a,i,s,r):MMe(a)){e.push(c.i,a.i,u.i),HS(a),a=u.next,l=u.next;continue}if(a=u,a===l){o?o===1?(a=NMe(Qy(a),e),GS(a,e,n,i,s,r,2)):o===2&&RMe(a,e,n,i,s,r):GS(Qy(a),e,n,i,s,r,1);break}}}function MMe(a){const e=a.prev,n=a,i=a.next;if(js(e,n,i)>=0)return!1;const s=e.x,r=n.x,o=i.x,l=e.y,c=n.y,u=i.y,h=Math.min(s,r,o),f=Math.min(l,c,u),m=Math.max(s,r,o),A=Math.max(l,c,u);let x=i.next;for(;x!==e;){if(x.x>=h&&x.x<=m&&x.y>=f&&x.y<=A&&j2(s,l,r,c,o,u,x.x,x.y)&&js(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function CMe(a,e,n,i){const s=a.prev,r=a,o=a.next;if(js(s,r,o)>=0)return!1;const l=s.x,c=r.x,u=o.x,h=s.y,f=r.y,m=o.y,A=Math.min(l,c,u),x=Math.min(h,f,m),T=Math.max(l,c,u),E=Math.max(h,f,m),M=Nk(A,x,e,n,i),N=Nk(T,E,e,n,i);let I=a.prevZ,F=a.nextZ;for(;I&&I.z>=M&&F&&F.z<=N;){if(I.x>=A&&I.x<=T&&I.y>=x&&I.y<=E&&I!==s&&I!==o&&j2(l,h,c,f,u,m,I.x,I.y)&&js(I.prev,I,I.next)>=0||(I=I.prevZ,F.x>=A&&F.x<=T&&F.y>=x&&F.y<=E&&F!==s&&F!==o&&j2(l,h,c,f,u,m,F.x,F.y)&&js(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;I&&I.z>=M;){if(I.x>=A&&I.x<=T&&I.y>=x&&I.y<=E&&I!==s&&I!==o&&j2(l,h,c,f,u,m,I.x,I.y)&&js(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;F&&F.z<=N;){if(F.x>=A&&F.x<=T&&F.y>=x&&F.y<=E&&F!==s&&F!==o&&j2(l,h,c,f,u,m,F.x,F.y)&&js(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function NMe(a,e){let n=a;do{const i=n.prev,s=n.next.next;!rx(i,s)&&Uee(i,n,n.next,s)&&qS(i,s)&&qS(s,i)&&(e.push(i.i,n.i,s.i),HS(n),HS(n.next),n=a=s),n=n.next}while(n!==a);return Qy(n)}function RMe(a,e,n,i,s,r){let o=a;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&BMe(o,l)){let c=Vee(o,l);o=Qy(o,o.next),c=Qy(c,c.next),GS(o,e,n,i,s,r,0),GS(c,e,n,i,s,r,0);return}l=l.next}o=o.next}while(o!==a)}function PMe(a,e,n,i){const s=[];for(let r=0,o=e.length;r<o;r++){const l=e[r]*i,c=r<o-1?e[r+1]*i:a.length,u=jee(a,l,c,i,!1);u===u.next&&(u.steiner=!0),s.push(jMe(u))}s.sort(IMe);for(let r=0;r<s.length;r++)n=LMe(s[r],n);return n}function IMe(a,e){let n=a.x-e.x;if(n===0&&(n=a.y-e.y,n===0)){const i=(a.next.y-a.y)/(a.next.x-a.x),s=(e.next.y-e.y)/(e.next.x-e.x);n=i-s}return n}function LMe(a,e){const n=DMe(a,e);if(!n)return e;const i=Vee(n,a);return Qy(i,i.next),Qy(n,n.next)}function DMe(a,e){let n=e;const i=a.x,s=a.y;let r=-1/0,o;if(rx(a,n))return n;do{if(rx(a,n.next))return n.next;if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){const f=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(f<=i&&f>r&&(r=f,o=n.x<n.next.x?n:n.next,f===i))return o}n=n.next}while(n!==e);if(!o)return null;const l=o,c=o.x,u=o.y;let h=1/0;n=o;do{if(i>=n.x&&n.x>=c&&i!==n.x&&Bee(s<u?i:r,s,c,u,s<u?r:i,s,n.x,n.y)){const f=Math.abs(s-n.y)/(i-n.x);qS(n,a)&&(f<h||f===h&&(n.x>o.x||n.x===o.x&&kMe(o,n)))&&(o=n,h=f)}n=n.next}while(n!==l);return o}function kMe(a,e){return js(a.prev,a,e.prev)<0&&js(e.next,a,a.next)<0}function OMe(a,e,n,i){let s=a;do s.z===0&&(s.z=Nk(s.x,s.y,e,n,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==a);s.prevZ.nextZ=null,s.prevZ=null,FMe(s)}function FMe(a){let e,n=1;do{let i=a,s;a=null;let r=null;for(e=0;i;){e++;let o=i,l=0;for(let u=0;u<n&&(l++,o=o.nextZ,!!o);u++);let c=n;for(;l>0||c>0&&o;)l!==0&&(c===0||!o||i.z<=o.z)?(s=i,i=i.nextZ,l--):(s=o,o=o.nextZ,c--),r?r.nextZ=s:a=s,s.prevZ=r,r=s;i=o}r.nextZ=null,n*=2}while(e>1);return a}function Nk(a,e,n,i,s){return a=(a-n)*s|0,e=(e-i)*s|0,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,a|e<<1}function jMe(a){let e=a,n=a;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==a);return n}function Bee(a,e,n,i,s,r,o,l){return(s-o)*(e-l)>=(a-o)*(r-l)&&(a-o)*(i-l)>=(n-o)*(e-l)&&(n-o)*(r-l)>=(s-o)*(i-l)}function j2(a,e,n,i,s,r,o,l){return!(a===o&&e===l)&&Bee(a,e,n,i,s,r,o,l)}function BMe(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!UMe(a,e)&&(qS(a,e)&&qS(e,a)&&VMe(a,e)&&(js(a.prev,a,e.prev)||js(a,e.prev,e))||rx(a,e)&&js(a.prev,a,a.next)>0&&js(e.prev,e,e.next)>0)}function js(a,e,n){return(e.y-a.y)*(n.x-e.x)-(e.x-a.x)*(n.y-e.y)}function rx(a,e){return a.x===e.x&&a.y===e.y}function Uee(a,e,n,i){const s=vM(js(a,e,n)),r=vM(js(a,e,i)),o=vM(js(n,i,a)),l=vM(js(n,i,e));return!!(s!==r&&o!==l||s===0&&yM(a,n,e)||r===0&&yM(a,i,e)||o===0&&yM(n,a,i)||l===0&&yM(n,e,i))}function yM(a,e,n){return e.x<=Math.max(a.x,n.x)&&e.x>=Math.min(a.x,n.x)&&e.y<=Math.max(a.y,n.y)&&e.y>=Math.min(a.y,n.y)}function vM(a){return a>0?1:a<0?-1:0}function UMe(a,e){let n=a;do{if(n.i!==a.i&&n.next.i!==a.i&&n.i!==e.i&&n.next.i!==e.i&&Uee(n,n.next,a,e))return!0;n=n.next}while(n!==a);return!1}function qS(a,e){return js(a.prev,a,a.next)<0?js(a,e,a.next)>=0&&js(a,a.prev,e)>=0:js(a,e,a.prev)<0||js(a,a.next,e)<0}function VMe(a,e){let n=a,i=!1;const s=(a.x+e.x)/2,r=(a.y+e.y)/2;do n.y>r!=n.next.y>r&&n.next.y!==n.y&&s<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==a);return i}function Vee(a,e){const n=Rk(a.i,a.x,a.y),i=Rk(e.i,e.x,e.y),s=a.next,r=e.prev;return a.next=e,e.prev=a,n.next=s,s.prev=n,i.next=n,n.prev=i,r.next=i,i.prev=r,i}function TH(a,e,n,i){const s=Rk(a,e,n);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function HS(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Rk(a,e,n){return{i:a,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function zMe(a,e,n,i){let s=0;for(let r=e,o=n-i;r<n;r+=i)s+=(a[o]-a[r])*(a[r+1]+a[o+1]),o=r;return s}class GMe{static triangulate(e,n,i=2){return EMe(e,n,i)}}class jd{static area(e){const n=e.length;let i=0;for(let s=n-1,r=0;r<n;s=r++)i+=e[s].x*e[r].y-e[r].x*e[s].y;return i*.5}static isClockWise(e){return jd.area(e)<0}static triangulateShape(e,n){const i=[],s=[],r=[];wH(e),EH(i,e);let o=e.length;n.forEach(wH);for(let c=0;c<n.length;c++)s.push(o),o+=n[c].length,EH(i,n[c]);const l=GMe.triangulate(i,s);for(let c=0;c<l.length;c+=3)r.push(l.slice(c,c+3));return r}}function wH(a){const e=a.length;e>2&&a[e-1].equals(a[0])&&a.pop()}function EH(a,e){for(let n=0;n<e.length;n++)a.push(e[n].x),a.push(e[n].y)}class ew extends zn{constructor(e=new ZA([new Nt(.5,.5),new Nt(-.5,.5),new Nt(-.5,-.5),new Nt(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,s=[],r=[];for(let l=0,c=e.length;l<c;l++){const u=e[l];o(u)}this.setAttribute("position",new mn(s,3)),this.setAttribute("uv",new mn(r,2)),this.computeVertexNormals();function o(l){const c=[],u=n.curveSegments!==void 0?n.curveSegments:12,h=n.steps!==void 0?n.steps:1,f=n.depth!==void 0?n.depth:1;let m=n.bevelEnabled!==void 0?n.bevelEnabled:!0,A=n.bevelThickness!==void 0?n.bevelThickness:.2,x=n.bevelSize!==void 0?n.bevelSize:A-.1,T=n.bevelOffset!==void 0?n.bevelOffset:0,E=n.bevelSegments!==void 0?n.bevelSegments:3;const M=n.extrudePath,N=n.UVGenerator!==void 0?n.UVGenerator:qMe;let I,F=!1,G,O,D,j;if(M){I=M.getSpacedPoints(h),F=!0,m=!1;const Me=M.isCatmullRomCurve3?M.closed:!1;G=M.computeFrenetFrames(h,Me),O=new ye,D=new ye,j=new ye}m||(E=0,A=0,x=0,T=0);const L=l.extractPoints(u);let U=L.shape;const q=L.holes;if(!jd.isClockWise(U)){U=U.reverse();for(let Me=0,ze=q.length;Me<ze;Me++){const Je=q[Me];jd.isClockWise(Je)&&(q[Me]=Je.reverse())}}function H(Me){const Je=10000000000000001e-36;let rt=Me[0];for(let ve=1;ve<=Me.length;ve++){const Ue=ve%Me.length,it=Me[Ue],wt=it.x-rt.x,Mt=it.y-rt.y,_e=wt*wt+Mt*Mt,le=Math.max(Math.abs(it.x),Math.abs(it.y),Math.abs(rt.x),Math.abs(rt.y)),Ge=Je*le*le;if(_e<=Ge){Me.splice(Ue,1),ve--;continue}rt=it}}H(U),q.forEach(H);const X=q.length,ne=U;for(let Me=0;Me<X;Me++){const ze=q[Me];U=U.concat(ze)}function Q(Me,ze,Je){return ze||Rt("ExtrudeGeometry: vec does not exist"),Me.clone().addScaledVector(ze,Je)}const Y=U.length;function ue(Me,ze,Je){let rt,ve,Ue;const it=Me.x-ze.x,wt=Me.y-ze.y,Mt=Je.x-Me.x,_e=Je.y-Me.y,le=it*it+wt*wt,Ge=it*_e-wt*Mt;if(Math.abs(Ge)>Number.EPSILON){const tt=Math.sqrt(le),pt=Math.sqrt(Mt*Mt+_e*_e),Te=ze.x-wt/tt,st=ze.y+it/tt,mt=Je.x-_e/pt,ht=Je.y+Mt/pt,Qe=((mt-Te)*_e-(ht-st)*Mt)/(it*_e-wt*Mt);rt=Te+it*Qe-Me.x,ve=st+wt*Qe-Me.y;const Xe=rt*rt+ve*ve;if(Xe<=2)return new Nt(rt,ve);Ue=Math.sqrt(Xe/2)}else{let tt=!1;it>Number.EPSILON?Mt>Number.EPSILON&&(tt=!0):it<-Number.EPSILON?Mt<-Number.EPSILON&&(tt=!0):Math.sign(wt)===Math.sign(_e)&&(tt=!0),tt?(rt=-wt,ve=it,Ue=Math.sqrt(le)):(rt=it,ve=wt,Ue=Math.sqrt(le/2))}return new Nt(rt/Ue,ve/Ue)}const pe=[];for(let Me=0,ze=ne.length,Je=ze-1,rt=Me+1;Me<ze;Me++,Je++,rt++)Je===ze&&(Je=0),rt===ze&&(rt=0),pe[Me]=ue(ne[Me],ne[Je],ne[rt]);const Ee=[];let oe,Ae=pe.concat();for(let Me=0,ze=X;Me<ze;Me++){const Je=q[Me];oe=[];for(let rt=0,ve=Je.length,Ue=ve-1,it=rt+1;rt<ve;rt++,Ue++,it++)Ue===ve&&(Ue=0),it===ve&&(it=0),oe[rt]=ue(Je[rt],Je[Ue],Je[it]);Ee.push(oe),Ae=Ae.concat(oe)}let be;if(E===0)be=jd.triangulateShape(ne,q);else{const Me=[],ze=[];for(let Je=0;Je<E;Je++){const rt=Je/E,ve=A*Math.cos(rt*Math.PI/2),Ue=x*Math.sin(rt*Math.PI/2)+T;for(let it=0,wt=ne.length;it<wt;it++){const Mt=Q(ne[it],pe[it],Ue);Fe(Mt.x,Mt.y,-ve),rt===0&&Me.push(Mt)}for(let it=0,wt=X;it<wt;it++){const Mt=q[it];oe=Ee[it];const _e=[];for(let le=0,Ge=Mt.length;le<Ge;le++){const tt=Q(Mt[le],oe[le],Ue);Fe(tt.x,tt.y,-ve),rt===0&&_e.push(tt)}rt===0&&ze.push(_e)}}be=jd.triangulateShape(Me,ze)}const Ce=be.length,ce=x+T;for(let Me=0;Me<Y;Me++){const ze=m?Q(U[Me],Ae[Me],ce):U[Me];F?(D.copy(G.normals[0]).multiplyScalar(ze.x),O.copy(G.binormals[0]).multiplyScalar(ze.y),j.copy(I[0]).add(D).add(O),Fe(j.x,j.y,j.z)):Fe(ze.x,ze.y,0)}for(let Me=1;Me<=h;Me++)for(let ze=0;ze<Y;ze++){const Je=m?Q(U[ze],Ae[ze],ce):U[ze];F?(D.copy(G.normals[Me]).multiplyScalar(Je.x),O.copy(G.binormals[Me]).multiplyScalar(Je.y),j.copy(I[Me]).add(D).add(O),Fe(j.x,j.y,j.z)):Fe(Je.x,Je.y,f/h*Me)}for(let Me=E-1;Me>=0;Me--){const ze=Me/E,Je=A*Math.cos(ze*Math.PI/2),rt=x*Math.sin(ze*Math.PI/2)+T;for(let ve=0,Ue=ne.length;ve<Ue;ve++){const it=Q(ne[ve],pe[ve],rt);Fe(it.x,it.y,f+Je)}for(let ve=0,Ue=q.length;ve<Ue;ve++){const it=q[ve];oe=Ee[ve];for(let wt=0,Mt=it.length;wt<Mt;wt++){const _e=Q(it[wt],oe[wt],rt);F?Fe(_e.x,_e.y+I[h-1].y,I[h-1].x+Je):Fe(_e.x,_e.y,f+Je)}}}te(),fe();function te(){const Me=s.length/3;if(m){let ze=0,Je=Y*ze;for(let rt=0;rt<Ce;rt++){const ve=be[rt];Ie(ve[2]+Je,ve[1]+Je,ve[0]+Je)}ze=h+E*2,Je=Y*ze;for(let rt=0;rt<Ce;rt++){const ve=be[rt];Ie(ve[0]+Je,ve[1]+Je,ve[2]+Je)}}else{for(let ze=0;ze<Ce;ze++){const Je=be[ze];Ie(Je[2],Je[1],Je[0])}for(let ze=0;ze<Ce;ze++){const Je=be[ze];Ie(Je[0]+Y*h,Je[1]+Y*h,Je[2]+Y*h)}}i.addGroup(Me,s.length/3-Me,0)}function fe(){const Me=s.length/3;let ze=0;Le(ne,ze),ze+=ne.length;for(let Je=0,rt=q.length;Je<rt;Je++){const ve=q[Je];Le(ve,ze),ze+=ve.length}i.addGroup(Me,s.length/3-Me,1)}function Le(Me,ze){let Je=Me.length;for(;--Je>=0;){const rt=Je;let ve=Je-1;ve<0&&(ve=Me.length-1);for(let Ue=0,it=h+E*2;Ue<it;Ue++){const wt=Y*Ue,Mt=Y*(Ue+1),_e=ze+rt+wt,le=ze+ve+wt,Ge=ze+ve+Mt,tt=ze+rt+Mt;at(_e,le,Ge,tt)}}}function Fe(Me,ze,Je){c.push(Me),c.push(ze),c.push(Je)}function Ie(Me,ze,Je){je(Me),je(ze),je(Je);const rt=s.length/3,ve=N.generateTopUV(i,s,rt-3,rt-2,rt-1);Ve(ve[0]),Ve(ve[1]),Ve(ve[2])}function at(Me,ze,Je,rt){je(Me),je(ze),je(rt),je(ze),je(Je),je(rt);const ve=s.length/3,Ue=N.generateSideWallUV(i,s,ve-6,ve-3,ve-2,ve-1);Ve(Ue[0]),Ve(Ue[1]),Ve(Ue[3]),Ve(Ue[1]),Ve(Ue[2]),Ve(Ue[3])}function je(Me){s.push(c[Me*3+0]),s.push(c[Me*3+1]),s.push(c[Me*3+2])}function Ve(Me){r.push(Me.x),r.push(Me.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return HMe(n,i,e)}static fromJSON(e,n){const i=[];for(let r=0,o=e.shapes.length;r<o;r++){const l=n[e.shapes[r]];i.push(l)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new PN[s.type]().fromJSON(s)),new ew(i,e.options)}}const qMe={generateTopUV:function(a,e,n,i,s){const r=e[n*3],o=e[n*3+1],l=e[i*3],c=e[i*3+1],u=e[s*3],h=e[s*3+1];return[new Nt(r,o),new Nt(l,c),new Nt(u,h)]},generateSideWallUV:function(a,e,n,i,s,r){const o=e[n*3],l=e[n*3+1],c=e[n*3+2],u=e[i*3],h=e[i*3+1],f=e[i*3+2],m=e[s*3],A=e[s*3+1],x=e[s*3+2],T=e[r*3],E=e[r*3+1],M=e[r*3+2];return Math.abs(l-h)<Math.abs(o-u)?[new Nt(o,1-c),new Nt(u,1-f),new Nt(m,1-x),new Nt(T,1-M)]:[new Nt(l,1-c),new Nt(h,1-f),new Nt(A,1-x),new Nt(E,1-M)]}};function HMe(a,e,n){if(n.shapes=[],Array.isArray(a))for(let i=0,s=a.length;i<s;i++){const r=a[i];n.shapes.push(r.uuid)}else n.shapes.push(a.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class o4 extends N0{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,s=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,r,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new o4(e.radius,e.detail)}}class l4 extends zn{constructor(e=[new Nt(0,-.5),new Nt(.5,0),new Nt(0,.5)],n=12,i=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:s},n=Math.floor(n),s=ma(s,0,Math.PI*2);const r=[],o=[],l=[],c=[],u=[],h=1/n,f=new ye,m=new Nt,A=new ye,x=new ye,T=new ye;let E=0,M=0;for(let N=0;N<=e.length-1;N++)switch(N){case 0:E=e[N+1].x-e[N].x,M=e[N+1].y-e[N].y,A.x=M*1,A.y=-E,A.z=M*0,T.copy(A),A.normalize(),c.push(A.x,A.y,A.z);break;case e.length-1:c.push(T.x,T.y,T.z);break;default:E=e[N+1].x-e[N].x,M=e[N+1].y-e[N].y,A.x=M*1,A.y=-E,A.z=M*0,x.copy(A),A.x+=T.x,A.y+=T.y,A.z+=T.z,A.normalize(),c.push(A.x,A.y,A.z),T.copy(x)}for(let N=0;N<=n;N++){const I=i+N*h*s,F=Math.sin(I),G=Math.cos(I);for(let O=0;O<=e.length-1;O++){f.x=e[O].x*F,f.y=e[O].y,f.z=e[O].x*G,o.push(f.x,f.y,f.z),m.x=N/n,m.y=O/(e.length-1),l.push(m.x,m.y);const D=c[3*O+0]*F,j=c[3*O+1],L=c[3*O+0]*G;u.push(D,j,L)}}for(let N=0;N<n;N++)for(let I=0;I<e.length-1;I++){const F=I+N*e.length,G=F,O=F+e.length,D=F+e.length+1,j=F+1;r.push(G,O,j),r.push(D,j,O)}this.setIndex(r),this.setAttribute("position",new mn(o,3)),this.setAttribute("uv",new mn(l,2)),this.setAttribute("normal",new mn(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new l4(e.points,e.segments,e.phiStart,e.phiLength)}}class tw extends N0{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,s,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new tw(e.radius,e.detail)}}class h1 extends zn{constructor(e=1,n=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:s};const r=e/2,o=n/2,l=Math.floor(i),c=Math.floor(s),u=l+1,h=c+1,f=e/l,m=n/c,A=[],x=[],T=[],E=[];for(let M=0;M<h;M++){const N=M*m-o;for(let I=0;I<u;I++){const F=I*f-r;x.push(F,-N,0),T.push(0,0,1),E.push(I/l),E.push(1-M/c)}}for(let M=0;M<c;M++)for(let N=0;N<l;N++){const I=N+u*M,F=N+u*(M+1),G=N+1+u*(M+1),O=N+1+u*M;A.push(I,F,O),A.push(F,G,O)}this.setIndex(A),this.setAttribute("position",new mn(x,3)),this.setAttribute("normal",new mn(T,3)),this.setAttribute("uv",new mn(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new h1(e.width,e.height,e.widthSegments,e.heightSegments)}}class c4 extends zn{constructor(e=.5,n=1,i=32,s=1,r=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:s,thetaStart:r,thetaLength:o},i=Math.max(3,i),s=Math.max(1,s);const l=[],c=[],u=[],h=[];let f=e;const m=(n-e)/s,A=new ye,x=new Nt;for(let T=0;T<=s;T++){for(let E=0;E<=i;E++){const M=r+E/i*o;A.x=f*Math.cos(M),A.y=f*Math.sin(M),c.push(A.x,A.y,A.z),u.push(0,0,1),x.x=(A.x/n+1)/2,x.y=(A.y/n+1)/2,h.push(x.x,x.y)}f+=m}for(let T=0;T<s;T++){const E=T*(i+1);for(let M=0;M<i;M++){const N=M+E,I=N,F=N+i+1,G=N+i+2,O=N+1;l.push(I,F,O),l.push(F,G,O)}}this.setIndex(l),this.setAttribute("position",new mn(c,3)),this.setAttribute("normal",new mn(u,3)),this.setAttribute("uv",new mn(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new c4(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class u4 extends zn{constructor(e=new ZA([new Nt(0,.5),new Nt(-.5,-.5),new Nt(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],s=[],r=[],o=[];let l=0,c=0;if(Array.isArray(e)===!1)u(e);else for(let h=0;h<e.length;h++)u(e[h]),this.addGroup(l,c,h),l+=c,c=0;this.setIndex(i),this.setAttribute("position",new mn(s,3)),this.setAttribute("normal",new mn(r,3)),this.setAttribute("uv",new mn(o,2));function u(h){const f=s.length/3,m=h.extractPoints(n);let A=m.shape;const x=m.holes;jd.isClockWise(A)===!1&&(A=A.reverse());for(let E=0,M=x.length;E<M;E++){const N=x[E];jd.isClockWise(N)===!0&&(x[E]=N.reverse())}const T=jd.triangulateShape(A,x);for(let E=0,M=x.length;E<M;E++){const N=x[E];A=A.concat(N)}for(let E=0,M=A.length;E<M;E++){const N=A[E];s.push(N.x,N.y,0),r.push(0,0,1),o.push(N.x,N.y)}for(let E=0,M=T.length;E<M;E++){const N=T[E],I=N[0]+f,F=N[1]+f,G=N[2]+f;i.push(I,F,G),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return WMe(n,e)}static fromJSON(e,n){const i=[];for(let s=0,r=e.shapes.length;s<r;s++){const o=n[e.shapes[s]];i.push(o)}return new u4(i,e.curveSegments)}}function WMe(a,e){if(e.shapes=[],Array.isArray(a))for(let n=0,i=a.length;n<i;n++){const s=a[n];e.shapes.push(s.uuid)}else e.shapes.push(a.uuid);return e}class vu extends zn{constructor(e=1,n=32,i=16,s=0,r=Math.PI*2,o=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:s,phiLength:r,thetaStart:o,thetaLength:l},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const c=Math.min(o+l,Math.PI);let u=0;const h=[],f=new ye,m=new ye,A=[],x=[],T=[],E=[];for(let M=0;M<=i;M++){const N=[],I=M/i;let F=0;M===0&&o===0?F=.5/n:M===i&&c===Math.PI&&(F=-.5/n);for(let G=0;G<=n;G++){const O=G/n;f.x=-e*Math.cos(s+O*r)*Math.sin(o+I*l),f.y=e*Math.cos(o+I*l),f.z=e*Math.sin(s+O*r)*Math.sin(o+I*l),x.push(f.x,f.y,f.z),m.copy(f).normalize(),T.push(m.x,m.y,m.z),E.push(O+F,1-I),N.push(u++)}h.push(N)}for(let M=0;M<i;M++)for(let N=0;N<n;N++){const I=h[M][N+1],F=h[M][N],G=h[M+1][N],O=h[M+1][N+1];(M!==0||o>0)&&A.push(I,F,O),(M!==i-1||c<Math.PI)&&A.push(F,G,O)}this.setIndex(A),this.setAttribute("position",new mn(x,3)),this.setAttribute("normal",new mn(T,3)),this.setAttribute("uv",new mn(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vu(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class d4 extends N0{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,s,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new d4(e.radius,e.detail)}}class h4 extends zn{constructor(e=1,n=.4,i=12,s=48,r=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:s,arc:r},i=Math.floor(i),s=Math.floor(s);const o=[],l=[],c=[],u=[],h=new ye,f=new ye,m=new ye;for(let A=0;A<=i;A++)for(let x=0;x<=s;x++){const T=x/s*r,E=A/i*Math.PI*2;f.x=(e+n*Math.cos(E))*Math.cos(T),f.y=(e+n*Math.cos(E))*Math.sin(T),f.z=n*Math.sin(E),l.push(f.x,f.y,f.z),h.x=e*Math.cos(T),h.y=e*Math.sin(T),m.subVectors(f,h).normalize(),c.push(m.x,m.y,m.z),u.push(x/s),u.push(A/i)}for(let A=1;A<=i;A++)for(let x=1;x<=s;x++){const T=(s+1)*A+x-1,E=(s+1)*(A-1)+x-1,M=(s+1)*(A-1)+x,N=(s+1)*A+x;o.push(T,E,N),o.push(E,M,N)}this.setIndex(o),this.setAttribute("position",new mn(l,3)),this.setAttribute("normal",new mn(c,3)),this.setAttribute("uv",new mn(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new h4(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class f4 extends zn{constructor(e=1,n=.4,i=64,s=8,r=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:s,p:r,q:o},i=Math.floor(i),s=Math.floor(s);const l=[],c=[],u=[],h=[],f=new ye,m=new ye,A=new ye,x=new ye,T=new ye,E=new ye,M=new ye;for(let I=0;I<=i;++I){const F=I/i*r*Math.PI*2;N(F,r,o,e,A),N(F+.01,r,o,e,x),E.subVectors(x,A),M.addVectors(x,A),T.crossVectors(E,M),M.crossVectors(T,E),T.normalize(),M.normalize();for(let G=0;G<=s;++G){const O=G/s*Math.PI*2,D=-n*Math.cos(O),j=n*Math.sin(O);f.x=A.x+(D*M.x+j*T.x),f.y=A.y+(D*M.y+j*T.y),f.z=A.z+(D*M.z+j*T.z),c.push(f.x,f.y,f.z),m.subVectors(f,A).normalize(),u.push(m.x,m.y,m.z),h.push(I/i),h.push(G/s)}}for(let I=1;I<=i;I++)for(let F=1;F<=s;F++){const G=(s+1)*(I-1)+(F-1),O=(s+1)*I+(F-1),D=(s+1)*I+F,j=(s+1)*(I-1)+F;l.push(G,O,j),l.push(O,D,j)}this.setIndex(l),this.setAttribute("position",new mn(c,3)),this.setAttribute("normal",new mn(u,3)),this.setAttribute("uv",new mn(h,2));function N(I,F,G,O,D){const j=Math.cos(I),L=Math.sin(I),U=G/F*I,q=Math.cos(U);D.x=O*(2+q)*.5*j,D.y=O*(2+q)*L*.5,D.z=O*Math.sin(U)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new f4(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class nw extends zn{constructor(e=new gj(new ye(-1,-1,0),new ye(-1,1,0),new ye(1,1,0)),n=64,i=1,s=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:s,closed:r};const o=e.computeFrenetFrames(n,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const l=new ye,c=new ye,u=new Nt;let h=new ye;const f=[],m=[],A=[],x=[];T(),this.setIndex(x),this.setAttribute("position",new mn(f,3)),this.setAttribute("normal",new mn(m,3)),this.setAttribute("uv",new mn(A,2));function T(){for(let I=0;I<n;I++)E(I);E(r===!1?n:0),N(),M()}function E(I){h=e.getPointAt(I/n,h);const F=o.normals[I],G=o.binormals[I];for(let O=0;O<=s;O++){const D=O/s*Math.PI*2,j=Math.sin(D),L=-Math.cos(D);c.x=L*F.x+j*G.x,c.y=L*F.y+j*G.y,c.z=L*F.z+j*G.z,c.normalize(),m.push(c.x,c.y,c.z),l.x=h.x+i*c.x,l.y=h.y+i*c.y,l.z=h.z+i*c.z,f.push(l.x,l.y,l.z)}}function M(){for(let I=1;I<=n;I++)for(let F=1;F<=s;F++){const G=(s+1)*(I-1)+(F-1),O=(s+1)*I+(F-1),D=(s+1)*I+F,j=(s+1)*(I-1)+F;x.push(G,O,j),x.push(O,D,j)}}function N(){for(let I=0;I<=n;I++)for(let F=0;F<=s;F++)u.x=I/n,u.y=F/s,A.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new nw(new PN[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class yj extends zn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,s=new ye,r=new ye;if(e.index!==null){const o=e.attributes.position,l=e.index;let c=e.groups;c.length===0&&(c=[{start:0,count:l.count,materialIndex:0}]);for(let u=0,h=c.length;u<h;++u){const f=c[u],m=f.start,A=f.count;for(let x=m,T=m+A;x<T;x+=3)for(let E=0;E<3;E++){const M=l.getX(x+E),N=l.getX(x+(E+1)%3);s.fromBufferAttribute(o,M),r.fromBufferAttribute(o,N),MH(s,r,i)===!0&&(n.push(s.x,s.y,s.z),n.push(r.x,r.y,r.z))}}}else{const o=e.attributes.position;for(let l=0,c=o.count/3;l<c;l++)for(let u=0;u<3;u++){const h=3*l+u,f=3*l+(u+1)%3;s.fromBufferAttribute(o,h),r.fromBufferAttribute(o,f),MH(s,r,i)===!0&&(n.push(s.x,s.y,s.z),n.push(r.x,r.y,r.z))}}this.setAttribute("position",new mn(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function MH(a,e,n){const i=`${a.x},${a.y},${a.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${a.x},${a.y},${a.z}`;return n.has(i)===!0||n.has(s)===!0?!1:(n.add(i),n.add(s),!0)}var CH=Object.freeze({__proto__:null,BoxGeometry:Yf,CapsuleGeometry:i4,CircleGeometry:Gx,ConeGeometry:ZT,CylinderGeometry:d1,DodecahedronGeometry:s4,EdgesGeometry:Lee,ExtrudeGeometry:ew,IcosahedronGeometry:o4,LatheGeometry:l4,OctahedronGeometry:tw,PlaneGeometry:h1,PolyhedronGeometry:N0,RingGeometry:c4,ShapeGeometry:u4,SphereGeometry:vu,TetrahedronGeometry:d4,TorusGeometry:h4,TorusKnotGeometry:f4,TubeGeometry:nw,WireframeGeometry:yj});class vj extends po{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new on(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class _j extends mo{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class p4 extends po{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new on(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new on(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qd,this.normalScale=new Nt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new fo,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class xj extends p4{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Nt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ma(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new on(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new on(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new on(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class m4 extends po{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new on(16777215),this.specular=new on(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new on(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qd,this.normalScale=new Nt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new fo,this.combine=Ox,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class bj extends po{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new on(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new on(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qd,this.normalScale=new Nt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Sj extends po{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qd,this.normalScale=new Nt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class nh extends po{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new on(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new on(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qd,this.normalScale=new Nt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new fo,this.combine=Ox,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Tj extends po{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ree,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class wj extends po{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class Ej extends po{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new on(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qd,this.normalScale=new Nt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Mj extends Hr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function GA(a,e){return!a||a.constructor===e?a:typeof e.BYTES_PER_ELEMENT=="number"?new e(a):Array.prototype.slice.call(a)}function zee(a){function e(s,r){return a[s]-a[r]}const n=a.length,i=new Array(n);for(let s=0;s!==n;++s)i[s]=s;return i.sort(e),i}function Pk(a,e,n){const i=a.length,s=new a.constructor(i);for(let r=0,o=0;o!==i;++r){const l=n[r]*e;for(let c=0;c!==e;++c)s[o++]=a[l+c]}return s}function Cj(a,e,n,i){let s=1,r=a[0];for(;r!==void 0&&r[i]===void 0;)r=a[s++];if(r===void 0)return;let o=r[i];if(o!==void 0)if(Array.isArray(o))do o=r[i],o!==void 0&&(e.push(r.time),n.push(...o)),r=a[s++];while(r!==void 0);else if(o.toArray!==void 0)do o=r[i],o!==void 0&&(e.push(r.time),o.toArray(n,n.length)),r=a[s++];while(r!==void 0);else do o=r[i],o!==void 0&&(e.push(r.time),n.push(o)),r=a[s++];while(r!==void 0)}function $Me(a,e,n,i,s=30){const r=a.clone();r.name=e;const o=[];for(let c=0;c<r.tracks.length;++c){const u=r.tracks[c],h=u.getValueSize(),f=[],m=[];for(let A=0;A<u.times.length;++A){const x=u.times[A]*s;if(!(x<n||x>=i)){f.push(u.times[A]);for(let T=0;T<h;++T)m.push(u.values[A*h+T])}}f.length!==0&&(u.times=GA(f,u.times.constructor),u.values=GA(m,u.values.constructor),o.push(u))}r.tracks=o;let l=1/0;for(let c=0;c<r.tracks.length;++c)l>r.tracks[c].times[0]&&(l=r.tracks[c].times[0]);for(let c=0;c<r.tracks.length;++c)r.tracks[c].shift(-1*l);return r.resetDuration(),r}function KMe(a,e=0,n=a,i=30){i<=0&&(i=30);const s=n.tracks.length,r=e/i;for(let o=0;o<s;++o){const l=n.tracks[o],c=l.ValueTypeName;if(c==="bool"||c==="string")continue;const u=a.tracks.find(function(M){return M.name===l.name&&M.ValueTypeName===c});if(u===void 0)continue;let h=0;const f=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);let m=0;const A=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=A/3);const x=l.times.length-1;let T;if(r<=l.times[0]){const M=h,N=f-h;T=l.values.slice(M,N)}else if(r>=l.times[x]){const M=x*f+h,N=M+f-h;T=l.values.slice(M,N)}else{const M=l.createInterpolant(),N=h,I=f-h;M.evaluate(r),T=M.resultBuffer.slice(N,I)}c==="quaternion"&&new Er().fromArray(T).normalize().conjugate().toArray(T);const E=u.times.length;for(let M=0;M<E;++M){const N=M*A+m;if(c==="quaternion")Er.multiplyQuaternionsFlat(u.values,N,T,0,u.values,N);else{const I=A-m*2;for(let F=0;F<I;++F)u.values[N+F]-=T[F]}}}return a.blendMode=ZF,a}class YMe{static convertArray(e,n){return GA(e,n)}static isTypedArray(e){return ax(e)}static getKeyframeOrder(e){return zee(e)}static sortedArray(e,n,i){return Pk(e,n,i)}static flattenJSON(e,n,i,s){Cj(e,n,i,s)}static subclip(e,n,i,s,r=30){return $Me(e,n,i,s,r)}static makeClipAdditive(e,n=0,i=e,s=30){return KMe(e,n,i,s)}}class aw{constructor(e,n,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,s=n[i],r=n[i-1];e:{t:{let o;n:{a:if(!(e<s)){for(let l=i+2;;){if(s===void 0){if(e<r)break a;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===l)break;if(r=s,s=n[++i],e<s)break t}o=n.length;break n}if(!(e>=r)){const l=n[1];e<l&&(i=2,r=l);for(let c=i-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(s=r,r=n[--i-1],e>=r)break t}o=i,i=0;break n}break e}for(;i<o;){const l=i+o>>>1;e<n[l]?o=l:i=l+1}if(s=n[i],r=n[i-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,r,s)}return this.interpolate_(i,r,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,s=this.valueSize,r=e*s;for(let o=0;o!==s;++o)n[o]=i[r+o];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Gee extends aw{constructor(e,n,i,s){super(e,n,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:VA,endingEnd:VA}}intervalChanged_(e,n,i){const s=this.parameterPositions;let r=e-2,o=e+1,l=s[r],c=s[o];if(l===void 0)switch(this.getSettings_().endingStart){case zA:r=e,l=2*n-i;break;case VS:r=s.length-2,l=n+s[r]-s[r+1];break;default:r=e,l=i}if(c===void 0)switch(this.getSettings_().endingEnd){case zA:o=e,c=2*i-n;break;case VS:o=1,c=i+s[1]-s[0];break;default:o=e-1,c=n}const u=(i-n)*.5,h=this.valueSize;this._weightPrev=u/(n-l),this._weightNext=u/(c-i),this._offsetPrev=r*h,this._offsetNext=o*h}interpolate_(e,n,i,s){const r=this.resultBuffer,o=this.sampleValues,l=this.valueSize,c=e*l,u=c-l,h=this._offsetPrev,f=this._offsetNext,m=this._weightPrev,A=this._weightNext,x=(i-n)/(s-n),T=x*x,E=T*x,M=-m*E+2*m*T-m*x,N=(1+m)*E+(-1.5-2*m)*T+(-.5+m)*x+1,I=(-1-A)*E+(1.5+A)*T+.5*x,F=A*E-A*T;for(let G=0;G!==l;++G)r[G]=M*o[h+G]+N*o[u+G]+I*o[c+G]+F*o[f+G];return r}}class Nj extends aw{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e,n,i,s){const r=this.resultBuffer,o=this.sampleValues,l=this.valueSize,c=e*l,u=c-l,h=(i-n)/(s-n),f=1-h;for(let m=0;m!==l;++m)r[m]=o[u+m]*f+o[c+m]*h;return r}}class qee extends aw{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class td{constructor(e,n,i,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=GA(n,this.TimeBufferType),this.values=GA(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:GA(e.times,Array),values:GA(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new qee(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Nj(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Gee(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case US:n=this.InterpolantFactoryMethodDiscrete;break;case MN:n=this.InterpolantFactoryMethodLinear;break;case KC:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return yt("KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return US;case this.InterpolantFactoryMethodLinear:return MN;case this.InterpolantFactoryMethodSmooth:return KC}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,s=n.length;i!==s;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,s=n.length;i!==s;++i)n[i]*=e}return this}trim(e,n){const i=this.times,s=i.length;let r=0,o=s-1;for(;r!==s&&i[r]<e;)++r;for(;o!==-1&&i[o]>n;)--o;if(++o,r!==0||o!==s){r>=o&&(o=Math.max(o,1),r=o-1);const l=this.getValueSize();this.times=i.slice(r,o),this.values=this.values.slice(r*l,o*l)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(Rt("KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,s=this.values,r=i.length;r===0&&(Rt("KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let l=0;l!==r;l++){const c=i[l];if(typeof c=="number"&&isNaN(c)){Rt("KeyframeTrack: Time is not a valid number.",this,l,c),e=!1;break}if(o!==null&&o>c){Rt("KeyframeTrack: Out of order keys.",this,l,c,o),e=!1;break}o=c}if(s!==void 0&&ax(s))for(let l=0,c=s.length;l!==c;++l){const u=s[l];if(isNaN(u)){Rt("KeyframeTrack: Value is not a valid number.",this,l,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),s=this.getInterpolation()===KC,r=e.length-1;let o=1;for(let l=1;l<r;++l){let c=!1;const u=e[l],h=e[l+1];if(u!==h&&(l!==1||u!==e[0]))if(s)c=!0;else{const f=l*i,m=f-i,A=f+i;for(let x=0;x!==i;++x){const T=n[f+x];if(T!==n[m+x]||T!==n[A+x]){c=!0;break}}}if(c){if(l!==o){e[o]=e[l];const f=l*i,m=o*i;for(let A=0;A!==i;++A)n[m+A]=n[f+A]}++o}}if(r>0){e[o]=e[r];for(let l=r*i,c=o*i,u=0;u!==i;++u)n[c+u]=n[l+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=n.slice(0,o*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,s=new i(this.name,e,n);return s.createInterpolant=this.createInterpolant,s}}td.prototype.ValueTypeName="";td.prototype.TimeBufferType=Float32Array;td.prototype.ValueBufferType=Float32Array;td.prototype.DefaultInterpolation=MN;class f1 extends td{constructor(e,n,i){super(e,n,i)}}f1.prototype.ValueTypeName="bool";f1.prototype.ValueBufferType=Array;f1.prototype.DefaultInterpolation=US;f1.prototype.InterpolantFactoryMethodLinear=void 0;f1.prototype.InterpolantFactoryMethodSmooth=void 0;class Rj extends td{constructor(e,n,i,s){super(e,n,i,s)}}Rj.prototype.ValueTypeName="color";class WS extends td{constructor(e,n,i,s){super(e,n,i,s)}}WS.prototype.ValueTypeName="number";class Hee extends aw{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e,n,i,s){const r=this.resultBuffer,o=this.sampleValues,l=this.valueSize,c=(i-n)/(s-n);let u=e*l;for(let h=u+l;u!==h;u+=4)Er.slerpFlat(r,0,o,u-l,o,u,c);return r}}class iw extends td{constructor(e,n,i,s){super(e,n,i,s)}InterpolantFactoryMethodLinear(e){return new Hee(this.times,this.values,this.getValueSize(),e)}}iw.prototype.ValueTypeName="quaternion";iw.prototype.InterpolantFactoryMethodSmooth=void 0;class p1 extends td{constructor(e,n,i){super(e,n,i)}}p1.prototype.ValueTypeName="string";p1.prototype.ValueBufferType=Array;p1.prototype.DefaultInterpolation=US;p1.prototype.InterpolantFactoryMethodLinear=void 0;p1.prototype.InterpolantFactoryMethodSmooth=void 0;class $S extends td{constructor(e,n,i,s){super(e,n,i,s)}}$S.prototype.ValueTypeName="vector";class KS{constructor(e="",n=-1,i=[],s=VP){this.name=e,this.tracks=i,this.duration=n,this.blendMode=s,this.uuid=lu(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,s=1/(e.fps||1);for(let o=0,l=i.length;o!==l;++o)n.push(QMe(i[o]).scale(s));const r=new this(e.name,e.duration,n,e.blendMode);return r.uuid=e.uuid,r.userData=JSON.parse(e.userData||"{}"),r}static toJSON(e){const n=[],i=e.tracks,s={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let r=0,o=i.length;r!==o;++r)n.push(td.toJSON(i[r]));return s}static CreateFromMorphTargetSequence(e,n,i,s){const r=n.length,o=[];for(let l=0;l<r;l++){let c=[],u=[];c.push((l+r-1)%r,l,(l+1)%r),u.push(0,1,0);const h=zee(c);c=Pk(c,1,h),u=Pk(u,1,h),!s&&c[0]===0&&(c.push(r),u.push(u[0])),o.push(new WS(".morphTargetInfluences["+n[l].name+"]",c,u).scale(1/i))}return new this(e,-1,o)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const s=e;i=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<i.length;s++)if(i[s].name===n)return i[s];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const s={},r=/^([\w-]*?)([\d]+)$/;for(let l=0,c=e.length;l<c;l++){const u=e[l],h=u.name.match(r);if(h&&h.length>1){const f=h[1];let m=s[f];m||(s[f]=m=[]),m.push(u)}}const o=[];for(const l in s)o.push(this.CreateFromMorphTargetSequence(l,s[l],n,i));return o}static parseAnimation(e,n){if(yt("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return Rt("AnimationClip: No animation in JSONLoader data."),null;const i=function(f,m,A,x,T){if(A.length!==0){const E=[],M=[];Cj(A,E,M,x),E.length!==0&&T.push(new f(m,E,M))}},s=[],r=e.name||"default",o=e.fps||30,l=e.blendMode;let c=e.length||-1;const u=e.hierarchy||[];for(let f=0;f<u.length;f++){const m=u[f].keys;if(!(!m||m.length===0))if(m[0].morphTargets){const A={};let x;for(x=0;x<m.length;x++)if(m[x].morphTargets)for(let T=0;T<m[x].morphTargets.length;T++)A[m[x].morphTargets[T]]=-1;for(const T in A){const E=[],M=[];for(let N=0;N!==m[x].morphTargets.length;++N){const I=m[x];E.push(I.time),M.push(I.morphTarget===T?1:0)}s.push(new WS(".morphTargetInfluence["+T+"]",E,M))}c=A.length*o}else{const A=".bones["+n[f].name+"]";i($S,A+".position",m,"pos",s),i(iw,A+".quaternion",m,"rot",s),i($S,A+".scale",m,"scl",s)}}return s.length===0?null:new this(r,c,s,l)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,s=e.length;i!==s;++i){const r=this.tracks[i];n=Math.max(n,r.times[r.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());const n=new this.constructor(this.name,this.duration,e,this.blendMode);return n.userData=JSON.parse(JSON.stringify(this.userData)),n}toJSON(){return this.constructor.toJSON(this)}}function XMe(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return WS;case"vector":case"vector2":case"vector3":case"vector4":return $S;case"color":return Rj;case"quaternion":return iw;case"bool":case"boolean":return f1;case"string":return p1}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}function QMe(a){if(a.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=XMe(a.type);if(a.times===void 0){const n=[],i=[];Cj(a.keys,n,i,"value"),a.times=n,a.values=i}return e.parse!==void 0?e.parse(a):new e(a.name,a.times,a.values,a.interpolation)}const Wh={enabled:!1,files:{},add:function(a,e){this.enabled!==!1&&(this.files[a]=e)},get:function(a){if(this.enabled!==!1)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};class Pj{constructor(e,n,i){const s=this;let r=!1,o=0,l=0,c;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this._abortController=null,this.itemStart=function(h){l++,r===!1&&s.onStart!==void 0&&s.onStart(h,o,l),r=!0},this.itemEnd=function(h){o++,s.onProgress!==void 0&&s.onProgress(h,o,l),o===l&&(r=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(h){s.onError!==void 0&&s.onError(h)},this.resolveURL=function(h){return c?c(h):h},this.setURLModifier=function(h){return c=h,this},this.addHandler=function(h,f){return u.push(h,f),this},this.removeHandler=function(h){const f=u.indexOf(h);return f!==-1&&u.splice(f,2),this},this.getHandler=function(h){for(let f=0,m=u.length;f<m;f+=2){const A=u[f],x=u[f+1];if(A.global&&(A.lastIndex=0),A.test(h))return x}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const Wee=new Pj;class Nc{constructor(e){this.manager=e!==void 0?e:Wee,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(s,r){i.load(e,s,n,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}Nc.DEFAULT_MATERIAL_NAME="__DEFAULT";const jp={};class JMe extends Error{constructor(e,n){super(e),this.response=n}}class xm extends Nc{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,n,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=Wh.get(`file:${e}`);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(r),this.manager.itemEnd(e)},0),r;if(jp[e]!==void 0){jp[e].push({onLoad:n,onProgress:i,onError:s});return}jp[e]=[],jp[e].push({onLoad:n,onProgress:i,onError:s});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),l=this.mimeType,c=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&yt("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const h=jp[e],f=u.body.getReader(),m=u.headers.get("X-File-Size")||u.headers.get("Content-Length"),A=m?parseInt(m):0,x=A!==0;let T=0;const E=new ReadableStream({start(M){N();function N(){f.read().then(({done:I,value:F})=>{if(I)M.close();else{T+=F.byteLength;const G=new ProgressEvent("progress",{lengthComputable:x,loaded:T,total:A});for(let O=0,D=h.length;O<D;O++){const j=h[O];j.onProgress&&j.onProgress(G)}M.enqueue(F),N()}},I=>{M.error(I)})}}});return new Response(E)}else throw new JMe(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(c){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(h=>new DOMParser().parseFromString(h,l));case"json":return u.json();default:if(l==="")return u.text();{const f=/charset="?([^;"\s]*)"?/i.exec(l),m=f&&f[1]?f[1].toLowerCase():void 0,A=new TextDecoder(m);return u.arrayBuffer().then(x=>A.decode(x))}}}).then(u=>{Wh.add(`file:${e}`,u);const h=jp[e];delete jp[e];for(let f=0,m=h.length;f<m;f++){const A=h[f];A.onLoad&&A.onLoad(u)}}).catch(u=>{const h=jp[e];if(h===void 0)throw this.manager.itemError(e),u;delete jp[e];for(let f=0,m=h.length;f<m;f++){const A=h[f];A.onError&&A.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class ZMe extends Nc{constructor(e){super(e)}load(e,n,i,s){const r=this,o=new xm(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{n(r.parse(JSON.parse(l)))}catch(c){s?s(c):Rt(c),r.manager.itemError(e)}},i,s)}parse(e){const n=[];for(let i=0;i<e.length;i++){const s=KS.parse(e[i]);n.push(s)}return n}}class eCe extends Nc{constructor(e){super(e)}load(e,n,i,s){const r=this,o=[],l=new a4,c=new xm(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(r.withCredentials);let u=0;function h(f){c.load(e[f],function(m){const A=r.parse(m,!0);o[f]={width:A.width,height:A.height,format:A.format,mipmaps:A.mipmaps},u+=1,u===6&&(A.mipmapCount===1&&(l.minFilter=di),l.image=o,l.format=A.format,l.needsUpdate=!0,n&&n(l))},i,s)}if(Array.isArray(e))for(let f=0,m=e.length;f<m;++f)h(f);else c.load(e,function(f){const m=r.parse(f,!0);if(m.isCubemap){const A=m.mipmaps.length/m.mipmapCount;for(let x=0;x<A;x++){o[x]={mipmaps:[]};for(let T=0;T<m.mipmapCount;T++)o[x].mipmaps.push(m.mipmaps[x*m.mipmapCount+T]),o[x].format=m.format,o[x].width=m.width,o[x].height=m.height}l.image=o}else l.image.width=m.width,l.image.height=m.height,l.mipmaps=m.mipmaps;m.mipmapCount===1&&(l.minFilter=di),l.format=m.format,l.needsUpdate=!0,n&&n(l)},i,s);return l}}const bv=new WeakMap;class YS extends Nc{constructor(e){super(e)}load(e,n,i,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Wh.get(`image:${e}`);if(o!==void 0){if(o.complete===!0)r.manager.itemStart(e),setTimeout(function(){n&&n(o),r.manager.itemEnd(e)},0);else{let f=bv.get(o);f===void 0&&(f=[],bv.set(o,f)),f.push({onLoad:n,onError:s})}return o}const l=zS("img");function c(){h(),n&&n(this);const f=bv.get(this)||[];for(let m=0;m<f.length;m++){const A=f[m];A.onLoad&&A.onLoad(this)}bv.delete(this),r.manager.itemEnd(e)}function u(f){h(),s&&s(f),Wh.remove(`image:${e}`);const m=bv.get(this)||[];for(let A=0;A<m.length;A++){const x=m[A];x.onError&&x.onError(f)}bv.delete(this),r.manager.itemError(e),r.manager.itemEnd(e)}function h(){l.removeEventListener("load",c,!1),l.removeEventListener("error",u,!1)}return l.addEventListener("load",c,!1),l.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),Wh.add(`image:${e}`,l),r.manager.itemStart(e),l.src=e,l}}class tCe extends Nc{constructor(e){super(e)}load(e,n,i,s){const r=new M0;r.colorSpace=Fr;const o=new YS(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let l=0;function c(u){o.load(e[u],function(h){r.images[u]=h,l++,l===6&&(r.needsUpdate=!0,n&&n(r))},void 0,s)}for(let u=0;u<e.length;++u)c(u);return r}}class nCe extends Nc{constructor(e){super(e)}load(e,n,i,s){const r=this,o=new cu,l=new xm(this.manager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(r.withCredentials),l.load(e,function(c){let u;try{u=r.parse(c)}catch(h){if(s!==void 0)s(h);else{h(h);return}}u.image!==void 0?o.image=u.image:u.data!==void 0&&(o.image.width=u.width,o.image.height=u.height,o.image.data=u.data),o.wrapS=u.wrapS!==void 0?u.wrapS:Ur,o.wrapT=u.wrapT!==void 0?u.wrapT:Ur,o.magFilter=u.magFilter!==void 0?u.magFilter:di,o.minFilter=u.minFilter!==void 0?u.minFilter:di,o.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.colorSpace!==void 0&&(o.colorSpace=u.colorSpace),u.flipY!==void 0&&(o.flipY=u.flipY),u.format!==void 0&&(o.format=u.format),u.type!==void 0&&(o.type=u.type),u.mipmaps!==void 0&&(o.mipmaps=u.mipmaps,o.minFilter=No),u.mipmapCount===1&&(o.minFilter=di),u.generateMipmaps!==void 0&&(o.generateMipmaps=u.generateMipmaps),o.needsUpdate=!0,n&&n(o,u)},i,s),o}}class g4 extends Nc{constructor(e){super(e)}load(e,n,i,s){const r=new _s,o=new YS(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(l){r.image=l,r.needsUpdate=!0,n!==void 0&&n(r)},i,s),r}}class R0 extends ni{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new on(e),this.intensity=n}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,n}}class Ij extends R0{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ni.DEFAULT_UP),this.updateMatrix(),this.groundColor=new on(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}toJSON(e){const n=super.toJSON(e);return n.object.groundColor=this.groundColor.getHex(),n}}const XD=new _n,NH=new ye,RH=new ye;class Lj{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Nt(512,512),this.mapType=os,this.map=null,this.mapPass=null,this.matrix=new _n,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new C0,this._frameExtents=new Nt(1,1),this._viewportCount=1,this._viewports=[new qn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;NH.setFromMatrixPosition(e.matrixWorld),n.position.copy(NH),RH.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(RH),n.updateMatrixWorld(),XD.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(XD,n.coordinateSystem,n.reversedDepth),n.reversedDepth?i.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(XD)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class aCe extends Lj{constructor(){super(new Zs(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const n=this.camera,i=Yy*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height*this.aspect,r=e.distance||n.far;(i!==n.fov||s!==n.aspect||r!==n.far)&&(n.fov=i,n.aspect=s,n.far=r,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class sw extends R0{constructor(e,n,i=0,s=Math.PI/3,r=0,o=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ni.DEFAULT_UP),this.updateMatrix(),this.target=new ni,this.distance=i,this.angle=s,this.penumbra=r,this.decay=o,this.map=null,this.shadow=new aCe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const n=super.toJSON(e);return n.object.distance=this.distance,n.object.angle=this.angle,n.object.decay=this.decay,n.object.penumbra=this.penumbra,n.object.target=this.target.uuid,this.map&&this.map.isTexture&&(n.object.map=this.map.toJSON(e).uuid),n.object.shadow=this.shadow.toJSON(),n}}class iCe extends Lj{constructor(){super(new Zs(90,1,.5,500)),this.isPointLightShadow=!0}}class Dj extends R0{constructor(e,n,i=0,s=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=s,this.shadow=new iCe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const n=super.toJSON(e);return n.object.distance=this.distance,n.object.decay=this.decay,n.object.shadow=this.shadow.toJSON(),n}}class P0 extends u1{constructor(e=-1,n=1,i=1,s=-1,r=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=s,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,s,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let r=i-e,o=i+e,l=s+n,c=s-n;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=u*this.view.offsetX,o=r+u*this.view.width,l-=h*this.view.offsetY,c=l-h*this.view.height}this.projectionMatrix.makeOrthographic(r,o,l,c,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class sCe extends Lj{constructor(){super(new P0(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class A4 extends R0{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ni.DEFAULT_UP),this.updateMatrix(),this.target=new ni,this.shadow=new sCe}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const n=super.toJSON(e);return n.object.shadow=this.shadow.toJSON(),n.object.target=this.target.uuid,n}}class y4 extends R0{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class kj extends R0{constructor(e,n,i=10,s=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class Oj{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ye)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,s=e.y,r=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.282095),n.addScaledVector(o[1],.488603*s),n.addScaledVector(o[2],.488603*r),n.addScaledVector(o[3],.488603*i),n.addScaledVector(o[4],1.092548*(i*s)),n.addScaledVector(o[5],1.092548*(s*r)),n.addScaledVector(o[6],.315392*(3*r*r-1)),n.addScaledVector(o[7],1.092548*(i*r)),n.addScaledVector(o[8],.546274*(i*i-s*s)),n}getIrradianceAt(e,n){const i=e.x,s=e.y,r=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.886227),n.addScaledVector(o[1],2*.511664*s),n.addScaledVector(o[2],2*.511664*r),n.addScaledVector(o[3],2*.511664*i),n.addScaledVector(o[4],2*.429043*i*s),n.addScaledVector(o[5],2*.429043*s*r),n.addScaledVector(o[6],.743125*r*r-.247708),n.addScaledVector(o[7],2*.429043*i*r),n.addScaledVector(o[8],.429043*(i*i-s*s)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let s=0;s<9;s++)i[s].fromArray(e,n+s*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let s=0;s<9;s++)i[s].toArray(e,n+s*3);return e}static getBasisAt(e,n){const i=e.x,s=e.y,r=e.z;n[0]=.282095,n[1]=.488603*s,n[2]=.488603*r,n[3]=.488603*i,n[4]=1.092548*i*s,n[5]=1.092548*s*r,n[6]=.315392*(3*r*r-1),n[7]=1.092548*i*r,n[8]=.546274*(i*i-s*s)}}class Fj extends R0{constructor(e=new Oj,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class v4 extends Nc{constructor(e){super(e),this.textures={}}load(e,n,i,s){const r=this,o=new xm(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(l){try{n(r.parse(JSON.parse(l)))}catch(c){s?s(c):Rt(c),r.manager.itemError(e)}},i,s)}parse(e){const n=this.textures;function i(r){return n[r]===void 0&&yt("MaterialLoader: Undefined texture",r),n[r]}const s=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new on().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(s.allowOverride=e.allowOverride),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const o=e.uniforms[r];switch(s.uniforms[r]={},o.type){case"t":s.uniforms[r].value=i(o.value);break;case"c":s.uniforms[r].value=new on().setHex(o.value);break;case"v2":s.uniforms[r].value=new Nt().fromArray(o.value);break;case"v3":s.uniforms[r].value=new ye().fromArray(o.value);break;case"v4":s.uniforms[r].value=new qn().fromArray(o.value);break;case"m3":s.uniforms[r].value=new ga().fromArray(o.value);break;case"m4":s.uniforms[r].value=new _n().fromArray(o.value);break;default:s.uniforms[r].value=o.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const r in e.extensions)s.extensions[r]=e.extensions[r];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=i(e.map)),e.matcap!==void 0&&(s.matcap=i(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),s.normalScale=new Nt().fromArray(r)}return e.displacementMap!==void 0&&(s.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=i(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new Nt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=i(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return v4.createMaterialFromType(e)}static createMaterialFromType(e){const n={ShadowMaterial:vj,SpriteMaterial:e4,RawShaderMaterial:_j,ShaderMaterial:mo,PointsMaterial:JT,MeshPhysicalMaterial:xj,MeshStandardMaterial:p4,MeshPhongMaterial:m4,MeshToonMaterial:bj,MeshNormalMaterial:Sj,MeshLambertMaterial:nh,MeshDepthMaterial:Tj,MeshDistanceMaterial:wj,MeshBasicMaterial:oo,MeshMatcapMaterial:Ej,LineDashedMaterial:Mj,LineBasicMaterial:Hr,Material:po};return new n[e]}}class Ik{static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class jj extends zn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class $ee extends Nc{constructor(e){super(e)}load(e,n,i,s){const r=this,o=new xm(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(l){try{n(r.parse(JSON.parse(l)))}catch(c){s?s(c):Rt(c),r.manager.itemError(e)}},i,s)}parse(e){const n={},i={};function s(A,x){if(n[x]!==void 0)return n[x];const E=A.interleavedBuffers[x],M=r(A,E.buffer),N=i_(E.type,M),I=new zx(N,E.stride);return I.uuid=E.uuid,n[x]=I,I}function r(A,x){if(i[x]!==void 0)return i[x];const E=A.arrayBuffers[x],M=new Uint32Array(E).buffer;return i[x]=M,M}const o=e.isInstancedBufferGeometry?new jj:new zn,l=e.data.index;if(l!==void 0){const A=i_(l.type,l.array);o.setIndex(new Ua(A,1))}const c=e.data.attributes;for(const A in c){const x=c[A];let T;if(x.isInterleavedBufferAttribute){const E=s(e.data,x.data);T=new kl(E,x.itemSize,x.offset,x.normalized)}else{const E=i_(x.type,x.array),M=x.isInstancedBufferAttribute?_c:Ua;T=new M(E,x.itemSize,x.normalized)}x.name!==void 0&&(T.name=x.name),x.usage!==void 0&&T.setUsage(x.usage),o.setAttribute(A,T)}const u=e.data.morphAttributes;if(u)for(const A in u){const x=u[A],T=[];for(let E=0,M=x.length;E<M;E++){const N=x[E];let I;if(N.isInterleavedBufferAttribute){const F=s(e.data,N.data);I=new kl(F,N.itemSize,N.offset,N.normalized)}else{const F=i_(N.type,N.array);I=new Ua(F,N.itemSize,N.normalized)}N.name!==void 0&&(I.name=N.name),T.push(I)}o.morphAttributes[A]=T}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const f=e.data.groups||e.data.drawcalls||e.data.offsets;if(f!==void 0)for(let A=0,x=f.length;A!==x;++A){const T=f[A];o.addGroup(T.start,T.count,T.materialIndex)}const m=e.data.boundingSphere;return m!==void 0&&(o.boundingSphere=new Cr().fromJSON(m)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class rCe extends Nc{constructor(e){super(e)}load(e,n,i,s){const r=this,o=this.path===""?Ik.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const l=new xm(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){let u=null;try{u=JSON.parse(c)}catch(f){s!==void 0&&s(f),f("ObjectLoader: Can't parse "+e+".",f.message);return}const h=u.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),Rt("ObjectLoader: Can't load "+e);return}r.parse(u,n)},i,s)}async loadAsync(e,n){const i=this,s=this.path===""?Ik.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const r=new xm(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const o=await r.loadAsync(e,n),l=JSON.parse(o),c=l.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(l)}parse(e,n){const i=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,s),o=this.parseImages(e.images,function(){n!==void 0&&n(u)}),l=this.parseTextures(e.textures,o),c=this.parseMaterials(e.materials,l),u=this.parseObject(e.object,r,c,l,i),h=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,h),this.bindLightTargets(u),n!==void 0){let f=!1;for(const m in o)if(o[m].data instanceof HTMLImageElement){f=!0;break}f===!1&&n(u)}return u}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),r=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,r),l=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,s,l,o,n),u=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,u),this.bindLightTargets(c),c}parseShapes(e){const n={};if(e!==void 0)for(let i=0,s=e.length;i<s;i++){const r=new ZA().fromJSON(e[i]);n[r.uuid]=r}return n}parseSkeletons(e,n){const i={},s={};if(n.traverse(function(r){r.isBone&&(s[r.uuid]=r)}),e!==void 0)for(let r=0,o=e.length;r<o;r++){const l=new t4().fromJSON(e[r],s);i[l.uuid]=l}return i}parseGeometries(e,n){const i={};if(e!==void 0){const s=new $ee;for(let r=0,o=e.length;r<o;r++){let l;const c=e[r];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":l=s.parse(c);break;default:c.type in CH?l=CH[c.type].fromJSON(c,n):yt(`ObjectLoader: Unsupported geometry type "${c.type}"`)}l.uuid=c.uuid,c.name!==void 0&&(l.name=c.name),c.userData!==void 0&&(l.userData=c.userData),i[c.uuid]=l}}return i}parseMaterials(e,n){const i={},s={};if(e!==void 0){const r=new v4;r.setTextures(n);for(let o=0,l=e.length;o<l;o++){const c=e[o];i[c.uuid]===void 0&&(i[c.uuid]=r.parse(c)),s[c.uuid]=i[c.uuid]}}return s}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const s=e[i],r=KS.parse(s);n[r.uuid]=r}return n}parseImages(e,n){const i=this,s={};let r;function o(c){return i.manager.itemStart(c),r.load(c,function(){i.manager.itemEnd(c)},void 0,function(){i.manager.itemError(c),i.manager.itemEnd(c)})}function l(c){if(typeof c=="string"){const u=c,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:i.resourcePath+u;return o(h)}else return c.data?{data:i_(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new Pj(n);r=new YS(c),r.setCrossOrigin(this.crossOrigin);for(let u=0,h=e.length;u<h;u++){const f=e[u],m=f.url;if(Array.isArray(m)){const A=[];for(let x=0,T=m.length;x<T;x++){const E=m[x],M=l(E);M!==null&&(M instanceof HTMLImageElement?A.push(M):A.push(new cu(M.data,M.width,M.height)))}s[f.uuid]=new Ug(A)}else{const A=l(f.url);s[f.uuid]=new Ug(A)}}}return s}async parseImagesAsync(e){const n=this,i={};let s;async function r(o){if(typeof o=="string"){const l=o,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:n.resourcePath+l;return await s.loadAsync(c)}else return o.data?{data:i_(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){s=new YS(this.manager),s.setCrossOrigin(this.crossOrigin);for(let o=0,l=e.length;o<l;o++){const c=e[o],u=c.url;if(Array.isArray(u)){const h=[];for(let f=0,m=u.length;f<m;f++){const A=u[f],x=await r(A);x!==null&&(x instanceof HTMLImageElement?h.push(x):h.push(new cu(x.data,x.width,x.height)))}i[c.uuid]=new Ug(h)}else{const h=await r(c.url);i[c.uuid]=new Ug(h)}}}return i}parseTextures(e,n){function i(r,o){return typeof r=="number"?r:(yt("ObjectLoader.parseTexture: Constant should be in numeric form.",r),o[r])}const s={};if(e!==void 0)for(let r=0,o=e.length;r<o;r++){const l=e[r];l.image===void 0&&yt('ObjectLoader: No "image" specified for',l.uuid),n[l.image]===void 0&&yt("ObjectLoader: Undefined image",l.image);const c=n[l.image],u=c.data;let h;Array.isArray(u)?(h=new M0,u.length===6&&(h.needsUpdate=!0)):(u&&u.data?h=new cu:h=new _s,u&&(h.needsUpdate=!0)),h.source=c,h.uuid=l.uuid,l.name!==void 0&&(h.name=l.name),l.mapping!==void 0&&(h.mapping=i(l.mapping,oCe)),l.channel!==void 0&&(h.channel=l.channel),l.offset!==void 0&&h.offset.fromArray(l.offset),l.repeat!==void 0&&h.repeat.fromArray(l.repeat),l.center!==void 0&&h.center.fromArray(l.center),l.rotation!==void 0&&(h.rotation=l.rotation),l.wrap!==void 0&&(h.wrapS=i(l.wrap[0],PH),h.wrapT=i(l.wrap[1],PH)),l.format!==void 0&&(h.format=l.format),l.internalFormat!==void 0&&(h.internalFormat=l.internalFormat),l.type!==void 0&&(h.type=l.type),l.colorSpace!==void 0&&(h.colorSpace=l.colorSpace),l.minFilter!==void 0&&(h.minFilter=i(l.minFilter,IH)),l.magFilter!==void 0&&(h.magFilter=i(l.magFilter,IH)),l.anisotropy!==void 0&&(h.anisotropy=l.anisotropy),l.flipY!==void 0&&(h.flipY=l.flipY),l.generateMipmaps!==void 0&&(h.generateMipmaps=l.generateMipmaps),l.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=l.premultiplyAlpha),l.unpackAlignment!==void 0&&(h.unpackAlignment=l.unpackAlignment),l.compareFunction!==void 0&&(h.compareFunction=l.compareFunction),l.userData!==void 0&&(h.userData=l.userData),s[l.uuid]=h}return s}parseObject(e,n,i,s,r){let o;function l(m){return n[m]===void 0&&yt("ObjectLoader: Undefined geometry",m),n[m]}function c(m){if(m!==void 0){if(Array.isArray(m)){const A=[];for(let x=0,T=m.length;x<T;x++){const E=m[x];i[E]===void 0&&yt("ObjectLoader: Undefined material",E),A.push(i[E])}return A}return i[m]===void 0&&yt("ObjectLoader: Undefined material",m),i[m]}}function u(m){return s[m]===void 0&&yt("ObjectLoader: Undefined texture",m),s[m]}let h,f;switch(e.type){case"Scene":o=new Vx,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new on(e.background):o.background=u(e.background)),e.environment!==void 0&&(o.environment=u(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new ZP(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new JP(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Zs(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new P0(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new y4(e.color,e.intensity);break;case"DirectionalLight":o=new A4(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new Dj(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new kj(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new sw(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new Ij(e.color,e.groundColor,e.intensity);break;case"LightProbe":const m=new Oj().fromArray(e.sh);o=new Fj(m,e.intensity);break;case"SkinnedMesh":h=l(e.geometry),f=c(e.material),o=new Cee(h,f),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":h=l(e.geometry),f=c(e.material),o=new Na(h,f);break;case"InstancedMesh":h=l(e.geometry),f=c(e.material);const A=e.count,x=e.instanceMatrix,T=e.instanceColor;o=new Nee(h,f,A),o.instanceMatrix=new _c(new Float32Array(x.array),16),T!==void 0&&(o.instanceColor=new _c(new Float32Array(T.array),T.itemSize));break;case"BatchedMesh":h=l(e.geometry),f=c(e.material),o=new Ree(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,f),o.geometry=h,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._geometryInfo=e.geometryInfo.map(E=>{let M=null,N=null;return E.boundingBox!==void 0&&(M=new Mr().fromJSON(E.boundingBox)),E.boundingSphere!==void 0&&(N=new Cr().fromJSON(E.boundingSphere)),{...E,boundingBox:M,boundingSphere:N}}),o._instanceInfo=e.instanceInfo,o._availableInstanceIds=e._availableInstanceIds,o._availableGeometryIds=e._availableGeometryIds,o._nextIndexStart=e.nextIndexStart,o._nextVertexStart=e.nextVertexStart,o._geometryCount=e.geometryCount,o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._matricesTexture=u(e.matricesTexture.uuid),o._indirectTexture=u(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=u(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(o.boundingSphere=new Cr().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(o.boundingBox=new Mr().fromJSON(e.boundingBox));break;case"LOD":o=new Mee;break;case"Line":o=new Kd(l(e.geometry),c(e.material));break;case"LineLoop":o=new Pee(l(e.geometry),c(e.material));break;case"LineSegments":o=new Zu(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":o=new lj(l(e.geometry),c(e.material));break;case"Sprite":o=new Eee(c(e.material));break;case"Group":o=new ll;break;case"Bone":o=new oj;break;default:o=new ni}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const m=e.children;for(let A=0;A<m.length;A++)o.add(this.parseObject(m[A],n,i,s,r))}if(e.animations!==void 0){const m=e.animations;for(let A=0;A<m.length;A++){const x=m[A];o.animations.push(r[x])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const m=e.levels;for(let A=0;A<m.length;A++){const x=m[A],T=o.getObjectByProperty("uuid",x.object);T!==void 0&&o.addLevel(T,x.distance,x.hysteresis)}}return o}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const s=n[i.skeleton];s===void 0?yt("ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(s,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(n){if(n.isDirectionalLight||n.isSpotLight){const i=n.target,s=e.getObjectByProperty("uuid",i);s!==void 0?n.target=s:n.target=new ni}})}}const oCe={UVMapping:GT,CubeReflectionMapping:xc,CubeRefractionMapping:Wu,EquirectangularReflectionMapping:d0,EquirectangularRefractionMapping:h0,CubeUVReflectionMapping:Am},PH={RepeatWrapping:ym,ClampToEdgeWrapping:Ur,MirroredRepeatWrapping:vm},IH={NearestFilter:Mi,NearestMipmapNearestFilter:qT,NearestMipmapLinearFilter:Od,LinearFilter:di,LinearMipmapNearestFilter:Zg,LinearMipmapLinearFilter:No},QD=new WeakMap;class lCe extends Nc{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&yt("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&yt("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,n,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Wh.get(`image-bitmap:${e}`);if(o!==void 0){if(r.manager.itemStart(e),o.then){o.then(u=>{if(QD.has(o)===!0)s&&s(QD.get(o)),r.manager.itemError(e),r.manager.itemEnd(e);else return n&&n(u),r.manager.itemEnd(e),u});return}return setTimeout(function(){n&&n(o),r.manager.itemEnd(e)},0),o}const l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",l.headers=this.requestHeader,l.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const c=fetch(e,l).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(u){return Wh.add(`image-bitmap:${e}`,u),n&&n(u),r.manager.itemEnd(e),u}).catch(function(u){s&&s(u),QD.set(c,u),Wh.remove(`image-bitmap:${e}`),r.manager.itemError(e),r.manager.itemEnd(e)});Wh.add(`image-bitmap:${e}`,c),r.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let _M;class Bj{static getContext(){return _M===void 0&&(_M=new(window.AudioContext||window.webkitAudioContext)),_M}static setContext(e){_M=e}}class cCe extends Nc{constructor(e){super(e)}load(e,n,i,s){const r=this,o=new xm(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{const u=c.slice(0);Bj.getContext().decodeAudioData(u,function(f){n(f)}).catch(l)}catch(u){l(u)}},i,s);function l(c){s?s(c):Rt(c),r.manager.itemError(e)}}}const LH=new _n,DH=new _n,cA=new _n;class uCe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Zs,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Zs,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,cA.copy(e.projectionMatrix);const s=n.eyeSep/2,r=s*n.near/n.focus,o=n.near*Math.tan(JA*n.fov*.5)/n.zoom;let l,c;DH.elements[12]=-s,LH.elements[12]=s,l=-o*n.aspect+r,c=o*n.aspect+r,cA.elements[0]=2*n.near/(c-l),cA.elements[8]=(c+l)/(c-l),this.cameraL.projectionMatrix.copy(cA),l=-o*n.aspect-r,c=o*n.aspect-r,cA.elements[0]=2*n.near/(c-l),cA.elements[8]=(c+l)/(c-l),this.cameraR.projectionMatrix.copy(cA)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(DH),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(LH)}}class Uj extends Zs{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class _4{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=performance.now();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}const uA=new ye,JD=new Er,dCe=new ye,dA=new ye,hA=new ye;class hCe extends ni{constructor(){super(),this.type="AudioListener",this.context=Bj.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new _4}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(uA,JD,dCe),dA.set(0,0,-1).applyQuaternion(JD),hA.set(0,1,0).applyQuaternion(JD),n.positionX){const i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(uA.x,i),n.positionY.linearRampToValueAtTime(uA.y,i),n.positionZ.linearRampToValueAtTime(uA.z,i),n.forwardX.linearRampToValueAtTime(dA.x,i),n.forwardY.linearRampToValueAtTime(dA.y,i),n.forwardZ.linearRampToValueAtTime(dA.z,i),n.upX.linearRampToValueAtTime(hA.x,i),n.upY.linearRampToValueAtTime(hA.y,i),n.upZ.linearRampToValueAtTime(hA.z,i)}else n.setPosition(uA.x,uA.y,uA.z),n.setOrientation(dA.x,dA.y,dA.z,hA.x,hA.y,hA.z)}}let Kee=class extends ni{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){yt("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){yt("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){yt("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){yt("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){yt("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(yt("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){yt("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,n){return super.copy(e,n),e.sourceType!=="buffer"?(yt("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}};const fA=new ye,kH=new Er,fCe=new ye,pA=new ye;class pCe extends Kee{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(fA,kH,fCe),pA.set(0,0,1).applyQuaternion(kH);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(fA.x,i),n.positionY.linearRampToValueAtTime(fA.y,i),n.positionZ.linearRampToValueAtTime(fA.z,i),n.orientationX.linearRampToValueAtTime(pA.x,i),n.orientationY.linearRampToValueAtTime(pA.y,i),n.orientationZ.linearRampToValueAtTime(pA.z,i)}else n.setPosition(fA.x,fA.y,fA.z),n.setOrientation(pA.x,pA.y,pA.z)}}class mCe{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class Yee{constructor(e,n,i){this.binding=e,this.valueSize=i;let s,r,o;switch(n){case"quaternion":s=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":s=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:s=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,s=this.valueSize,r=e*s+s;let o=this.cumulativeWeight;if(o===0){for(let l=0;l!==s;++l)i[r+l]=i[l];o=n}else{o+=n;const l=n/o;this._mixBufferRegion(i,r,0,l,s)}this.cumulativeWeight=o}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,s=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,s,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,s=e*n+n,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,l=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const c=n*this._origIndex;this._mixBufferRegion(i,s,c,1-r,n)}o>0&&this._mixBufferRegionAdditive(i,s,this._addIndex*n,1,n);for(let c=n,u=n+n;c!==u;++c)if(i[c]!==i[c+n]){l.setValue(i,s);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,s=i*this._origIndex;e.getValue(n,s);for(let r=i,o=s;r!==o;++r)n[r]=n[s+r%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,s,r){if(s>=.5)for(let o=0;o!==r;++o)e[n+o]=e[i+o]}_slerp(e,n,i,s){Er.slerpFlat(e,n,e,n,e,i,s)}_slerpAdditive(e,n,i,s,r){const o=this._workIndex*r;Er.multiplyQuaternionsFlat(e,o,e,n,e,i),Er.slerpFlat(e,n,e,n,e,o,s)}_lerp(e,n,i,s,r){const o=1-s;for(let l=0;l!==r;++l){const c=n+l;e[c]=e[c]*o+e[i+l]*s}}_lerpAdditive(e,n,i,s,r){for(let o=0;o!==r;++o){const l=n+o;e[l]=e[l]+e[i+o]*s}}}const Vj="\\[\\]\\.:\\/",gCe=new RegExp("["+Vj+"]","g"),zj="[^"+Vj+"]",ACe="[^"+Vj.replace("\\.","")+"]",yCe=/((?:WC+[\/:])*)/.source.replace("WC",zj),vCe=/(WCOD+)?/.source.replace("WCOD",ACe),_Ce=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",zj),xCe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",zj),bCe=new RegExp("^"+yCe+vCe+_Ce+xCe+"$"),SCe=["material","materials","bones","map"];class TCe{constructor(e,n,i){const s=i||_i.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,s)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,s=this._bindings[i];s!==void 0&&s.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,r=i.length;s!==r;++s)i[s].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class _i{constructor(e,n,i){this.path=n,this.parsedPath=i||_i.parseTrackName(n),this.node=_i.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new _i.Composite(e,n,i):new _i(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(gCe,"")}static parseTrackName(e){const n=bCe.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=i.nodeName&&i.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const r=i.nodeName.substring(s+1);SCe.indexOf(r)!==-1&&(i.nodeName=i.nodeName.substring(0,s),i.objectName=r)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(r){for(let o=0;o<r.length;o++){const l=r[o];if(l.name===n||l.uuid===n)return l;const c=i(l.children);if(c)return c}return null},s=i(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)e[n++]=i[s]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)i[s]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)i[s]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)i[s]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,s=n.propertyName;let r=n.propertyIndex;if(e||(e=_i.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){yt("PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let u=n.objectIndex;switch(i){case"materials":if(!e.material){Rt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){Rt("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){Rt("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===u){u=h;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){Rt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){Rt("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){Rt("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(u!==void 0){if(e[u]===void 0){Rt("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[s];if(o===void 0){const u=n.nodeName;Rt("PropertyBinding: Trying to update property for track: "+u+"."+s+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?l=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(r!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){Rt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){Rt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else o.fromArray!==void 0&&o.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}_i.Composite=TCe;_i.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};_i.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};_i.prototype.GetterByBindingType=[_i.prototype._getValue_direct,_i.prototype._getValue_array,_i.prototype._getValue_arrayElement,_i.prototype._getValue_toArray];_i.prototype.SetterByBindingTypeAndVersioning=[[_i.prototype._setValue_direct,_i.prototype._setValue_direct_setNeedsUpdate,_i.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[_i.prototype._setValue_array,_i.prototype._setValue_array_setNeedsUpdate,_i.prototype._setValue_array_setMatrixWorldNeedsUpdate],[_i.prototype._setValue_arrayElement,_i.prototype._setValue_arrayElement_setNeedsUpdate,_i.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[_i.prototype._setValue_fromArray,_i.prototype._setValue_fromArray_setNeedsUpdate,_i.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class wCe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=lu(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,s=arguments.length;i!==s;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,s=this._parsedPaths,r=this._bindings,o=r.length;let l,c=e.length,u=this.nCachedObjects_;for(let h=0,f=arguments.length;h!==f;++h){const m=arguments[h],A=m.uuid;let x=n[A];if(x===void 0){x=c++,n[A]=x,e.push(m);for(let T=0,E=o;T!==E;++T)r[T].push(new _i(m,i[T],s[T]))}else if(x<u){l=e[x];const T=--u,E=e[T];n[E.uuid]=x,e[x]=E,n[A]=T,e[T]=m;for(let M=0,N=o;M!==N;++M){const I=r[M],F=I[T];let G=I[x];I[x]=F,G===void 0&&(G=new _i(m,i[M],s[M])),I[T]=G}}else e[x]!==l&&Rt("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,s=i.length;let r=this.nCachedObjects_;for(let o=0,l=arguments.length;o!==l;++o){const c=arguments[o],u=c.uuid,h=n[u];if(h!==void 0&&h>=r){const f=r++,m=e[f];n[m.uuid]=h,e[h]=m,n[u]=f,e[f]=c;for(let A=0,x=s;A!==x;++A){const T=i[A],E=T[f],M=T[h];T[h]=E,T[f]=M}}}this.nCachedObjects_=r}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,s=i.length;let r=this.nCachedObjects_,o=e.length;for(let l=0,c=arguments.length;l!==c;++l){const u=arguments[l],h=u.uuid,f=n[h];if(f!==void 0)if(delete n[h],f<r){const m=--r,A=e[m],x=--o,T=e[x];n[A.uuid]=f,e[f]=A,n[T.uuid]=m,e[m]=T,e.pop();for(let E=0,M=s;E!==M;++E){const N=i[E],I=N[m],F=N[x];N[f]=I,N[m]=F,N.pop()}}else{const m=--o,A=e[m];m>0&&(n[A.uuid]=f),e[f]=A,e.pop();for(let x=0,T=s;x!==T;++x){const E=i[x];E[f]=E[m],E.pop()}}}this.nCachedObjects_=r}subscribe_(e,n){const i=this._bindingsIndicesByPath;let s=i[e];const r=this._bindings;if(s!==void 0)return r[s];const o=this._paths,l=this._parsedPaths,c=this._objects,u=c.length,h=this.nCachedObjects_,f=new Array(u);s=r.length,i[e]=s,o.push(e),l.push(n),r.push(f);for(let m=h,A=c.length;m!==A;++m){const x=c[m];f[m]=new _i(x,e,n)}return f}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const s=this._paths,r=this._parsedPaths,o=this._bindings,l=o.length-1,c=o[l],u=e[l];n[u]=i,o[i]=c,o.pop(),r[i]=r[l],r.pop(),s[i]=s[l],s.pop()}}}class Xee{constructor(e,n,i=null,s=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=s;const r=n.tracks,o=r.length,l=new Array(o),c={endingStart:VA,endingEnd:VA};for(let u=0;u!==o;++u){const h=r[u].createInterpolant(null);l[u]=h,h.settings=c}this._interpolantSettings=c,this._interpolants=l,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=nee,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i=!1){if(e.fadeOut(n),this.fadeIn(n),i===!0){const s=this._clip.duration,r=e._clip.duration,o=r/s,l=s/r;e.warp(1,o,n),this.warp(l,1,n)}return this}crossFadeTo(e,n,i=!1){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const s=this._mixer,r=s.time,o=this.timeScale;let l=this._timeScaleInterpolant;l===null&&(l=s._lendControlInterpolant(),this._timeScaleInterpolant=l);const c=l.parameterPositions,u=l.sampleValues;return c[0]=r,c[1]=r+i,u[0]=e/o,u[1]=n/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,s){if(!this.enabled){this._updateWeight(e);return}const r=this._startTime;if(r!==null){const c=(e-r)*i;c<0||i===0?n=0:(this._startTime=null,n=i*c)}n*=this._updateTimeScale(e);const o=this._updateTime(n),l=this._updateWeight(e);if(l>0){const c=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case ZF:for(let h=0,f=c.length;h!==f;++h)c[h].evaluate(o),u[h].accumulateAdditive(l);break;case VP:default:for(let h=0,f=c.length;h!==f;++h)c[h].evaluate(o),u[h].accumulate(s,l)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const s=i.evaluate(e)[0];n*=s,e>i.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const s=i.evaluate(e)[0];n*=s,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let s=this.time+e,r=this._loopCount;const o=i===aee;if(e===0)return r===-1?s:o&&(r&1)===1?n-s:s;if(i===tee){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=n)s=n;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),s>=n||s<0){const l=Math.floor(s/n);s-=n*l,r+=Math.abs(l);const c=this.repetitions-r;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?n:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=s;if(o&&(r&1)===1)return n-s}return s}_setEndings(e,n,i){const s=this._interpolantSettings;i?(s.endingStart=zA,s.endingEnd=zA):(e?s.endingStart=this.zeroSlopeAtStart?zA:VA:s.endingStart=VS,n?s.endingEnd=this.zeroSlopeAtEnd?zA:VA:s.endingEnd=VS)}_scheduleFading(e,n,i){const s=this._mixer,r=s.time;let o=this._weightInterpolant;o===null&&(o=s._lendControlInterpolant(),this._weightInterpolant=o);const l=o.parameterPositions,c=o.sampleValues;return l[0]=r,c[0]=n,l[1]=r+e,c[1]=i,this}}const ECe=new Float32Array(1);class MCe extends Cc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,s=e._clip.tracks,r=s.length,o=e._propertyBindings,l=e._interpolants,c=i.uuid,u=this._bindingsByRootAndName;let h=u[c];h===void 0&&(h={},u[c]=h);for(let f=0;f!==r;++f){const m=s[f],A=m.name;let x=h[A];if(x!==void 0)++x.referenceCount,o[f]=x;else{if(x=o[f],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,c,A));continue}const T=n&&n._propertyBindings[f].binding.parsedPath;x=new Yee(_i.create(i,A,T),m.ValueTypeName,m.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,c,A),o[f]=x}l[f].resultBuffer=x.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,s=e._clip.uuid,r=this._actionsByClip[s];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,s,i)}const n=e._propertyBindings;for(let i=0,s=n.length;i!==s;++i){const r=n[i];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,s=n.length;i!==s;++i){const r=n[i];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const s=this._actions,r=this._actionsByClip;let o=r[n];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[n]=o;else{const l=o.knownActions;e._byClipCacheIndex=l.length,l.push(e)}e._cacheIndex=s.length,s.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],s=e._cacheIndex;i._cacheIndex=s,n[s]=i,n.pop(),e._cacheIndex=null;const r=e._clip.uuid,o=this._actionsByClip,l=o[r],c=l.knownActions,u=c[c.length-1],h=e._byClipCacheIndex;u._byClipCacheIndex=h,c[h]=u,c.pop(),e._byClipCacheIndex=null;const f=l.actionByRoot,m=(e._localRoot||this._root).uuid;delete f[m],c.length===0&&delete o[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,s=n.length;i!==s;++i){const r=n[i];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,s=this._nActiveActions++,r=n[s];e._cacheIndex=s,n[s]=e,r._cacheIndex=i,n[i]=r}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,s=--this._nActiveActions,r=n[s];e._cacheIndex=s,n[s]=e,r._cacheIndex=i,n[i]=r}_addInactiveBinding(e,n,i){const s=this._bindingsByRootAndName,r=this._bindings;let o=s[n];o===void 0&&(o={},s[n]=o),o[i]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,s=i.rootNode.uuid,r=i.path,o=this._bindingsByRootAndName,l=o[s],c=n[n.length-1],u=e._cacheIndex;c._cacheIndex=u,n[u]=c,n.pop(),delete l[r],Object.keys(l).length===0&&delete o[s]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,s=this._nActiveBindings++,r=n[s];e._cacheIndex=s,n[s]=e,r._cacheIndex=i,n[i]=r}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,s=--this._nActiveBindings,r=n[s];e._cacheIndex=s,n[s]=e,r._cacheIndex=i,n[i]=r}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new Nj(new Float32Array(2),new Float32Array(2),1,ECe),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,s=--this._nActiveControlInterpolants,r=n[s];e.__cacheIndex=s,n[s]=e,r.__cacheIndex=i,n[i]=r}clipAction(e,n,i){const s=n||this._root,r=s.uuid;let o=typeof e=="string"?KS.findByName(s,e):e;const l=o!==null?o.uuid:e,c=this._actionsByClip[l];let u=null;if(i===void 0&&(o!==null?i=o.blendMode:i=VP),c!==void 0){const f=c.actionByRoot[r];if(f!==void 0&&f.blendMode===i)return f;u=c.knownActions[0],o===null&&(o=u._clip)}if(o===null)return null;const h=new Xee(this,o,n,i);return this._bindAction(h,u),this._addInactiveAction(h,l,r),h}existingAction(e,n){const i=n||this._root,s=i.uuid,r=typeof e=="string"?KS.findByName(i,e):e,o=r?r.uuid:e,l=this._actionsByClip[o];return l!==void 0&&l.actionByRoot[s]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,s=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1;for(let u=0;u!==i;++u)n[u]._update(s,e,r,o);const l=this._bindings,c=this._nActiveBindings;for(let u=0;u!==c;++u)l[u].apply(o);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,s=this._actionsByClip,r=s[i];if(r!==void 0){const o=r.knownActions;for(let l=0,c=o.length;l!==c;++l){const u=o[l];this._deactivateAction(u);const h=u._cacheIndex,f=n[n.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,f._cacheIndex=h,n[h]=f,n.pop(),this._removeInactiveBindingsForAction(u)}delete s[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const o in i){const l=i[o].actionByRoot,c=l[n];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const s=this._bindingsByRootAndName,r=s[n];if(r!==void 0)for(const o in r){const l=r[o];l.restoreOriginalState(),this._removeInactiveBinding(l)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class CCe extends th{constructor(e=1,n=1,i=1,s={}){super(e,n,s),this.isRenderTarget3D=!0,this.depth=i,this.texture=new $P(null,e,n,i),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}let NCe=class Qee{constructor(e){this.value=e}clone(){return new Qee(this.value.clone===void 0?this.value:this.value.clone())}},RCe=0,PCe=class extends Cc{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:RCe++}),this.name="",this.usage=m0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,s=n.length;i<s;i++){const r=Array.isArray(n[i])?n[i]:[n[i]];for(let o=0;o<r.length;o++)this.uniforms.push(r[o].clone())}return this}clone(){return new this.constructor().copy(this)}};class XS extends zx{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class ICe{constructor(e,n,i,s,r,o=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=s,this.count=r,this.normalized=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const OH=new _n;class Jee{constructor(e,n,i=0,s=1/0){this.ray=new c1(e,n),this.near=i,this.far=s,this.camera=null,this.layers=new KP,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):Rt("Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return OH.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(OH),this}intersectObject(e,n=!0,i=[]){return Lk(e,this,i,n),i.sort(FH),i}intersectObjects(e,n=!0,i=[]){for(let s=0,r=e.length;s<r;s++)Lk(e[s],this,i,n);return i.sort(FH),i}}function FH(a,e){return a.distance-e.distance}function Lk(a,e,n,i){let s=!0;if(a.layers.test(e.layers)&&a.raycast(e,n)===!1&&(s=!1),s===!0&&i===!0){const r=a.children;for(let o=0,l=r.length;o<l;o++)Lk(r[o],e,n,!0)}}class LCe{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=DCe.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function DCe(){this._document.hidden===!1&&this.reset()}class Dk{constructor(e=1,n=0,i=0){this.radius=e,this.phi=n,this.theta=i}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=ma(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(ma(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class kCe{constructor(e=1,n=0,i=0){this.radius=e,this.theta=n,this.y=i}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}class rw{constructor(e,n,i,s){rw.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,i,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let i=0;i<4;i++)this.elements[i]=e[i+n];return this}set(e,n,i,s){const r=this.elements;return r[0]=e,r[2]=n,r[1]=i,r[3]=s,this}}const jH=new Nt;class OCe{constructor(e=new Nt(1/0,1/0),n=new Nt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=jH.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,jH).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const BH=new ye,xM=new ye,Sv=new ye,Tv=new ye,ZD=new ye,FCe=new ye,jCe=new ye;class Zee{constructor(e=new ye,n=new ye){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){BH.subVectors(e,this.start),xM.subVectors(this.end,this.start);const i=xM.dot(xM);let r=xM.dot(BH)/i;return n&&(r=ma(r,0,1)),r}closestPointToPoint(e,n,i){const s=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(s).add(this.start)}distanceSqToLine3(e,n=FCe,i=jCe){const s=10000000000000001e-32;let r,o;const l=this.start,c=e.start,u=this.end,h=e.end;Sv.subVectors(u,l),Tv.subVectors(h,c),ZD.subVectors(l,c);const f=Sv.dot(Sv),m=Tv.dot(Tv),A=Tv.dot(ZD);if(f<=s&&m<=s)return n.copy(l),i.copy(c),n.sub(i),n.dot(n);if(f<=s)r=0,o=A/m,o=ma(o,0,1);else{const x=Sv.dot(ZD);if(m<=s)o=0,r=ma(-x/f,0,1);else{const T=Sv.dot(Tv),E=f*m-T*T;E!==0?r=ma((T*A-x*m)/E,0,1):r=0,o=(T*r+A)/m,o<0?(o=0,r=ma(-x/f,0,1)):o>1&&(o=1,r=ma((T-x)/f,0,1))}}return n.copy(l).add(Sv.multiplyScalar(r)),i.copy(c).add(Tv.multiplyScalar(o)),n.sub(i),n.dot(n)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const UH=new ye;class BCe extends ni{constructor(e,n){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new zn,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,l=1,c=32;o<c;o++,l++){const u=o/c*Math.PI*2,h=l/c*Math.PI*2;s.push(Math.cos(u),Math.sin(u),1,Math.cos(h),Math.sin(h),1)}i.setAttribute("position",new mn(s,3));const r=new Hr({fog:!1,toneMapped:!1});this.cone=new Zu(i,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),UH.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(UH),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const dg=new ye,bM=new _n,e5=new _n;class UCe extends Zu{constructor(e){const n=ete(e),i=new zn,s=[],r=[];for(let u=0;u<n.length;u++){const h=n[u];h.parent&&h.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),r.push(0,0,0),r.push(0,0,0))}i.setAttribute("position",new mn(s,3)),i.setAttribute("color",new mn(r,3));const o=new Hr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,o),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const l=new on(255),c=new on(65280);this.setColors(l,c)}updateMatrixWorld(e){const n=this.bones,i=this.geometry,s=i.getAttribute("position");e5.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<n.length;r++){const l=n[r];l.parent&&l.parent.isBone&&(bM.multiplyMatrices(e5,l.matrixWorld),dg.setFromMatrixPosition(bM),s.setXYZ(o,dg.x,dg.y,dg.z),bM.multiplyMatrices(e5,l.parent.matrixWorld),dg.setFromMatrixPosition(bM),s.setXYZ(o+1,dg.x,dg.y,dg.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,n){const s=this.geometry.getAttribute("color");for(let r=0;r<s.count;r+=2)s.setXYZ(r,e.r,e.g,e.b),s.setXYZ(r+1,n.r,n.g,n.b);return s.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function ete(a){const e=[];a.isBone===!0&&e.push(a);for(let n=0;n<a.children.length;n++)e.push(...ete(a.children[n]));return e}class VCe extends Na{constructor(e,n,i){const s=new vu(n,4,2),r=new oo({wireframe:!0,fog:!1,toneMapped:!1});super(s,r),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const zCe=new ye,VH=new on,zH=new on;class GCe extends ni{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const s=new tw(n);s.rotateY(Math.PI*.5),this.material=new oo({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=s.getAttribute("position"),o=new Float32Array(r.count*3);s.setAttribute("color",new Ua(o,3)),this.add(new Na(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");VH.copy(this.light.color),zH.copy(this.light.groundColor);for(let i=0,s=n.count;i<s;i++){const r=i<s/2?VH:zH;n.setXYZ(i,r.r,r.g,r.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(zCe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class qCe extends Zu{constructor(e=10,n=10,i=4473924,s=8947848){i=new on(i),s=new on(s);const r=n/2,o=e/n,l=e/2,c=[],u=[];for(let m=0,A=0,x=-l;m<=n;m++,x+=o){c.push(-l,0,x,l,0,x),c.push(x,0,-l,x,0,l);const T=m===r?i:s;T.toArray(u,A),A+=3,T.toArray(u,A),A+=3,T.toArray(u,A),A+=3,T.toArray(u,A),A+=3}const h=new zn;h.setAttribute("position",new mn(c,3)),h.setAttribute("color",new mn(u,3));const f=new Hr({vertexColors:!0,toneMapped:!1});super(h,f),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class HCe extends Zu{constructor(e=10,n=16,i=8,s=64,r=4473924,o=8947848){r=new on(r),o=new on(o);const l=[],c=[];if(n>1)for(let f=0;f<n;f++){const m=f/n*(Math.PI*2),A=Math.sin(m)*e,x=Math.cos(m)*e;l.push(0,0,0),l.push(A,0,x);const T=f&1?r:o;c.push(T.r,T.g,T.b),c.push(T.r,T.g,T.b)}for(let f=0;f<i;f++){const m=f&1?r:o,A=e-e/i*f;for(let x=0;x<s;x++){let T=x/s*(Math.PI*2),E=Math.sin(T)*A,M=Math.cos(T)*A;l.push(E,0,M),c.push(m.r,m.g,m.b),T=(x+1)/s*(Math.PI*2),E=Math.sin(T)*A,M=Math.cos(T)*A,l.push(E,0,M),c.push(m.r,m.g,m.b)}}const u=new zn;u.setAttribute("position",new mn(l,3)),u.setAttribute("color",new mn(c,3));const h=new Hr({vertexColors:!0,toneMapped:!1});super(u,h),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const GH=new ye,SM=new ye,qH=new ye;class WCe extends ni{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let s=new zn;s.setAttribute("position",new mn([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const r=new Hr({fog:!1,toneMapped:!1});this.lightPlane=new Kd(s,r),this.add(this.lightPlane),s=new zn,s.setAttribute("position",new mn([0,0,0,0,0,1],3)),this.targetLine=new Kd(s,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),GH.setFromMatrixPosition(this.light.matrixWorld),SM.setFromMatrixPosition(this.light.target.matrixWorld),qH.subVectors(SM,GH),this.lightPlane.lookAt(SM),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(SM),this.targetLine.scale.z=qH.length()}}const TM=new ye,Xs=new u1;class $Ce extends Zu{constructor(e){const n=new zn,i=new Hr({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],r=[],o={};l("n1","n2"),l("n2","n4"),l("n4","n3"),l("n3","n1"),l("f1","f2"),l("f2","f4"),l("f4","f3"),l("f3","f1"),l("n1","f1"),l("n2","f2"),l("n3","f3"),l("n4","f4"),l("p","n1"),l("p","n2"),l("p","n3"),l("p","n4"),l("u1","u2"),l("u2","u3"),l("u3","u1"),l("c","t"),l("p","c"),l("cn1","cn2"),l("cn3","cn4"),l("cf1","cf2"),l("cf3","cf4");function l(x,T){c(x),c(T)}function c(x){s.push(0,0,0),r.push(0,0,0),o[x]===void 0&&(o[x]=[]),o[x].push(s.length/3-1)}n.setAttribute("position",new mn(s,3)),n.setAttribute("color",new mn(r,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const u=new on(16755200),h=new on(16711680),f=new on(43775),m=new on(16777215),A=new on(3355443);this.setColors(u,h,f,m,A)}setColors(e,n,i,s,r){const l=this.geometry.getAttribute("color");return l.setXYZ(0,e.r,e.g,e.b),l.setXYZ(1,e.r,e.g,e.b),l.setXYZ(2,e.r,e.g,e.b),l.setXYZ(3,e.r,e.g,e.b),l.setXYZ(4,e.r,e.g,e.b),l.setXYZ(5,e.r,e.g,e.b),l.setXYZ(6,e.r,e.g,e.b),l.setXYZ(7,e.r,e.g,e.b),l.setXYZ(8,e.r,e.g,e.b),l.setXYZ(9,e.r,e.g,e.b),l.setXYZ(10,e.r,e.g,e.b),l.setXYZ(11,e.r,e.g,e.b),l.setXYZ(12,e.r,e.g,e.b),l.setXYZ(13,e.r,e.g,e.b),l.setXYZ(14,e.r,e.g,e.b),l.setXYZ(15,e.r,e.g,e.b),l.setXYZ(16,e.r,e.g,e.b),l.setXYZ(17,e.r,e.g,e.b),l.setXYZ(18,e.r,e.g,e.b),l.setXYZ(19,e.r,e.g,e.b),l.setXYZ(20,e.r,e.g,e.b),l.setXYZ(21,e.r,e.g,e.b),l.setXYZ(22,e.r,e.g,e.b),l.setXYZ(23,e.r,e.g,e.b),l.setXYZ(24,n.r,n.g,n.b),l.setXYZ(25,n.r,n.g,n.b),l.setXYZ(26,n.r,n.g,n.b),l.setXYZ(27,n.r,n.g,n.b),l.setXYZ(28,n.r,n.g,n.b),l.setXYZ(29,n.r,n.g,n.b),l.setXYZ(30,n.r,n.g,n.b),l.setXYZ(31,n.r,n.g,n.b),l.setXYZ(32,i.r,i.g,i.b),l.setXYZ(33,i.r,i.g,i.b),l.setXYZ(34,i.r,i.g,i.b),l.setXYZ(35,i.r,i.g,i.b),l.setXYZ(36,i.r,i.g,i.b),l.setXYZ(37,i.r,i.g,i.b),l.setXYZ(38,s.r,s.g,s.b),l.setXYZ(39,s.r,s.g,s.b),l.setXYZ(40,r.r,r.g,r.b),l.setXYZ(41,r.r,r.g,r.b),l.setXYZ(42,r.r,r.g,r.b),l.setXYZ(43,r.r,r.g,r.b),l.setXYZ(44,r.r,r.g,r.b),l.setXYZ(45,r.r,r.g,r.b),l.setXYZ(46,r.r,r.g,r.b),l.setXYZ(47,r.r,r.g,r.b),l.setXYZ(48,r.r,r.g,r.b),l.setXYZ(49,r.r,r.g,r.b),l.needsUpdate=!0,this}update(){const e=this.geometry,n=this.pointMap,i=1,s=1;let r,o;if(Xs.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)r=1,o=0;else if(this.camera.coordinateSystem===Ro)r=-1,o=1;else if(this.camera.coordinateSystem===bc)r=0,o=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);sr("c",n,e,Xs,0,0,r),sr("t",n,e,Xs,0,0,o),sr("n1",n,e,Xs,-i,-s,r),sr("n2",n,e,Xs,i,-s,r),sr("n3",n,e,Xs,-i,s,r),sr("n4",n,e,Xs,i,s,r),sr("f1",n,e,Xs,-i,-s,o),sr("f2",n,e,Xs,i,-s,o),sr("f3",n,e,Xs,-i,s,o),sr("f4",n,e,Xs,i,s,o),sr("u1",n,e,Xs,i*.7,s*1.1,r),sr("u2",n,e,Xs,-i*.7,s*1.1,r),sr("u3",n,e,Xs,0,s*2,r),sr("cf1",n,e,Xs,-i,0,o),sr("cf2",n,e,Xs,i,0,o),sr("cf3",n,e,Xs,0,-s,o),sr("cf4",n,e,Xs,0,s,o),sr("cn1",n,e,Xs,-i,0,r),sr("cn2",n,e,Xs,i,0,r),sr("cn3",n,e,Xs,0,-s,r),sr("cn4",n,e,Xs,0,s,r),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function sr(a,e,n,i,s,r,o){TM.set(s,r,o).unproject(i);const l=e[a];if(l!==void 0){const c=n.getAttribute("position");for(let u=0,h=l.length;u<h;u++)c.setXYZ(l[u],TM.x,TM.y,TM.z)}}const wM=new Mr;class KCe extends Zu{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(24),r=new zn;r.setIndex(new Ua(i,1)),r.setAttribute("position",new Ua(s,3)),super(r,new Hr({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&wM.setFromObject(this.object),wM.isEmpty())return;const e=wM.min,n=wM.max,i=this.geometry.attributes.position,s=i.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=e.x,s[4]=n.y,s[5]=n.z,s[6]=e.x,s[7]=e.y,s[8]=n.z,s[9]=n.x,s[10]=e.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=e.z,s[15]=e.x,s[16]=n.y,s[17]=e.z,s[18]=e.x,s[19]=e.y,s[20]=e.z,s[21]=n.x,s[22]=e.y,s[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class YCe extends Zu{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new zn;r.setIndex(new Ua(i,1)),r.setAttribute("position",new mn(s,3)),super(r,new Hr({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class XCe extends Kd{constructor(e,n=1,i=16776960){const s=i,r=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new zn;o.setAttribute("position",new mn(r,3)),o.computeBoundingSphere(),super(o,new Hr({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const l=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new zn;c.setAttribute("position",new mn(l,3)),c.computeBoundingSphere(),this.add(new Na(c,new oo({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const HH=new ye;let EM,t5;class QCe extends ni{constructor(e=new ye(0,0,1),n=new ye(0,0,0),i=1,s=16776960,r=i*.2,o=r*.2){super(),this.type="ArrowHelper",EM===void 0&&(EM=new zn,EM.setAttribute("position",new mn([0,0,0,0,1,0],3)),t5=new ZT(.5,1,5,1),t5.translate(0,-.5,0)),this.position.copy(n),this.line=new Kd(EM,new Hr({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Na(t5,new oo({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,r,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{HH.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(HH,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class JCe extends Zu{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new zn;s.setAttribute("position",new mn(n,3)),s.setAttribute("color",new mn(i,3));const r=new Hr({vertexColors:!0,toneMapped:!1});super(s,r),this.type="AxesHelper"}setColors(e,n,i){const s=new on,r=this.geometry.attributes.color.array;return s.set(e),s.toArray(r,0),s.toArray(r,3),s.set(n),s.toArray(r,6),s.toArray(r,9),s.set(i),s.toArray(r,12),s.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class tte{constructor(){this.type="ShapePath",this.color=new on,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new IN,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,s){return this.currentPath.quadraticCurveTo(e,n,i,s),this}bezierCurveTo(e,n,i,s,r,o){return this.currentPath.bezierCurveTo(e,n,i,s,r,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(M){const N=[];for(let I=0,F=M.length;I<F;I++){const G=M[I],O=new ZA;O.curves=G.curves,N.push(O)}return N}function i(M,N){const I=N.length;let F=!1;for(let G=I-1,O=0;O<I;G=O++){let D=N[G],j=N[O],L=j.x-D.x,U=j.y-D.y;if(Math.abs(U)>Number.EPSILON){if(U<0&&(D=N[O],L=-L,j=N[G],U=-U),M.y<D.y||M.y>j.y)continue;if(M.y===D.y){if(M.x===D.x)return!0}else{const q=U*(M.x-D.x)-L*(M.y-D.y);if(q===0)return!0;if(q<0)continue;F=!F}}else{if(M.y!==D.y)continue;if(j.x<=M.x&&M.x<=D.x||D.x<=M.x&&M.x<=j.x)return!0}}return F}const s=jd.isClockWise,r=this.subPaths;if(r.length===0)return[];let o,l,c;const u=[];if(r.length===1)return l=r[0],c=new ZA,c.curves=l.curves,u.push(c),u;let h=!s(r[0].getPoints());h=e?!h:h;const f=[],m=[];let A=[],x=0,T;m[x]=void 0,A[x]=[];for(let M=0,N=r.length;M<N;M++)l=r[M],T=l.getPoints(),o=s(T),o=e?!o:o,o?(!h&&m[x]&&x++,m[x]={s:new ZA,p:T},m[x].s.curves=l.curves,h&&x++,A[x]=[]):A[x].push({h:l,p:T[0]});if(!m[0])return n(r);if(m.length>1){let M=!1,N=0;for(let I=0,F=m.length;I<F;I++)f[I]=[];for(let I=0,F=m.length;I<F;I++){const G=A[I];for(let O=0;O<G.length;O++){const D=G[O];let j=!0;for(let L=0;L<m.length;L++)i(D.p,m[L].p)&&(I!==L&&N++,j?(j=!1,f[L].push(D)):M=!0);j&&f[I].push(D)}}N>0&&M===!1&&(A=f)}let E;for(let M=0,N=m.length;M<N;M++){c=m[M].s,u.push(c),E=A[M];for(let I=0,F=E.length;I<F;I++)c.holes.push(E[I].h)}return u}}class x4 extends Cc{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){yt("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function ZCe(a,e){const n=a.image&&a.image.width?a.image.width/a.image.height:1;return n>e?(a.repeat.x=1,a.repeat.y=n/e,a.offset.x=0,a.offset.y=(1-a.repeat.y)/2):(a.repeat.x=e/n,a.repeat.y=1,a.offset.x=(1-a.repeat.x)/2,a.offset.y=0),a}function e3e(a,e){const n=a.image&&a.image.width?a.image.width/a.image.height:1;return n>e?(a.repeat.x=e/n,a.repeat.y=1,a.offset.x=(1-a.repeat.x)/2,a.offset.y=0):(a.repeat.x=1,a.repeat.y=n/e,a.offset.x=0,a.offset.y=(1-a.repeat.y)/2),a}function t3e(a){return a.repeat.x=1,a.repeat.y=1,a.offset.x=0,a.offset.y=0,a}function LN(a,e,n,i){const s=n3e(i);switch(n){case UP:return a*e;case r1:return a*e/s.components*s.byteLength;case E0:return a*e/s.components*s.byteLength;case ol:return a*e*2/s.components*s.byteLength;case o1:return a*e*2/s.components*s.byteLength;case Fx:return a*e*3/s.components*s.byteLength;case fs:return a*e*4/s.components*s.byteLength;case l1:return a*e*4/s.components*s.byteLength;case Qp:case Jp:return Math.floor((a+3)/4)*Math.floor((e+3)/4)*8;case Zp:case em:return Math.floor((a+3)/4)*Math.floor((e+3)/4)*16;case ex:case nx:return Math.max(a,16)*Math.max(e,8)/4;case Z_:case tx:return Math.max(a,8)*Math.max(e,8)/2;case Ty:case wy:case My:case Cy:return Math.floor((a+3)/4)*Math.floor((e+3)/4)*8;case Ey:case f0:case Ny:return Math.floor((a+3)/4)*Math.floor((e+3)/4)*16;case Ry:return Math.floor((a+3)/4)*Math.floor((e+3)/4)*16;case Py:return Math.floor((a+4)/5)*Math.floor((e+3)/4)*16;case Iy:return Math.floor((a+4)/5)*Math.floor((e+4)/5)*16;case Ly:return Math.floor((a+5)/6)*Math.floor((e+4)/5)*16;case Dy:return Math.floor((a+5)/6)*Math.floor((e+5)/6)*16;case ky:return Math.floor((a+7)/8)*Math.floor((e+4)/5)*16;case Oy:return Math.floor((a+7)/8)*Math.floor((e+5)/6)*16;case Fy:return Math.floor((a+7)/8)*Math.floor((e+7)/8)*16;case jy:return Math.floor((a+9)/10)*Math.floor((e+4)/5)*16;case By:return Math.floor((a+9)/10)*Math.floor((e+5)/6)*16;case Uy:return Math.floor((a+9)/10)*Math.floor((e+7)/8)*16;case Vy:return Math.floor((a+9)/10)*Math.floor((e+9)/10)*16;case zy:return Math.floor((a+11)/12)*Math.floor((e+9)/10)*16;case Gy:return Math.floor((a+11)/12)*Math.floor((e+11)/12)*16;case qy:case wN:case EN:return Math.ceil(a/4)*Math.ceil(e/4)*16;case Hy:case Wy:return Math.ceil(a/4)*Math.ceil(e/4)*8;case p0:case $y:return Math.ceil(a/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function n3e(a){switch(a){case os:case e0:return{byteLength:1,components:1};case Bu:case t0:case cs:return{byteLength:2,components:1};case HT:case WT:return{byteLength:2,components:4};case Ei:case jr:case ls:return{byteLength:4,components:1};case $T:case KT:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${a}.`)}class a3e{static contain(e,n){return ZCe(e,n)}static cover(e,n){return e3e(e,n)}static fill(e){return t3e(e)}static getByteLength(e,n,i,s){return LN(e,n,i,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:w0}}));typeof window<"u"&&(window.__THREE__?yt("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=w0);function nte(){let a=null,e=!1,n=null,i=null;function s(r,o){n(r,o),i=a.requestAnimationFrame(s)}return{start:function(){e!==!0&&n!==null&&(i=a.requestAnimationFrame(s),e=!0)},stop:function(){a.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(r){n=r},setContext:function(r){a=r}}}function i3e(a){const e=new WeakMap;function n(l,c){const u=l.array,h=l.usage,f=u.byteLength,m=a.createBuffer();a.bindBuffer(c,m),a.bufferData(c,u,h),l.onUploadCallback();let A;if(u instanceof Float32Array)A=a.FLOAT;else if(typeof Float16Array<"u"&&u instanceof Float16Array)A=a.HALF_FLOAT;else if(u instanceof Uint16Array)l.isFloat16BufferAttribute?A=a.HALF_FLOAT:A=a.UNSIGNED_SHORT;else if(u instanceof Int16Array)A=a.SHORT;else if(u instanceof Uint32Array)A=a.UNSIGNED_INT;else if(u instanceof Int32Array)A=a.INT;else if(u instanceof Int8Array)A=a.BYTE;else if(u instanceof Uint8Array)A=a.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)A=a.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:m,type:A,bytesPerElement:u.BYTES_PER_ELEMENT,version:l.version,size:f}}function i(l,c,u){const h=c.array,f=c.updateRanges;if(a.bindBuffer(u,l),f.length===0)a.bufferSubData(u,0,h);else{f.sort((A,x)=>A.start-x.start);let m=0;for(let A=1;A<f.length;A++){const x=f[m],T=f[A];T.start<=x.start+x.count+1?x.count=Math.max(x.count,T.start+T.count-x.start):(++m,f[m]=T)}f.length=m+1;for(let A=0,x=f.length;A<x;A++){const T=f[A];a.bufferSubData(u,T.start*h.BYTES_PER_ELEMENT,h,T.start,T.count)}c.clearUpdateRanges()}c.onUploadCallback()}function s(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}function r(l){l.isInterleavedBufferAttribute&&(l=l.data);const c=e.get(l);c&&(a.deleteBuffer(c.buffer),e.delete(l))}function o(l,c){if(l.isInterleavedBufferAttribute&&(l=l.data),l.isGLBufferAttribute){const h=e.get(l);(!h||h.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}const u=e.get(l);if(u===void 0)e.set(l,n(l,c));else if(u.version<l.version){if(u.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(u.buffer,l,c),u.version=l.version}}return{get:s,remove:r,update:o}}var s3e=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,r3e=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,o3e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,l3e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,c3e=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,u3e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,d3e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,h3e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,f3e=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,p3e=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,m3e=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,g3e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,A3e=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,y3e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,v3e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,_3e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,x3e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,b3e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,S3e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,T3e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,w3e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,E3e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,M3e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,C3e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,N3e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,R3e=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,P3e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,I3e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,L3e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,D3e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,k3e="gl_FragColor = linearToOutputTexel( gl_FragColor );",O3e=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,F3e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,j3e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,B3e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,U3e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,V3e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,z3e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,G3e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,q3e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,H3e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,W3e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,$3e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,K3e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Y3e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,X3e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Q3e=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,J3e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Z3e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,eNe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,tNe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,nNe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,aNe=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,iNe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,sNe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,rNe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,oNe=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,lNe=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,cNe=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,uNe=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,dNe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,hNe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,fNe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,pNe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,mNe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,gNe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,ANe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,yNe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,vNe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,_Ne=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,xNe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,bNe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,SNe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,TNe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,wNe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,ENe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,MNe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,CNe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,NNe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,RNe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,PNe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,INe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,LNe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,DNe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,kNe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,ONe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,FNe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,jNe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,BNe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,UNe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,VNe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,zNe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,GNe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,qNe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,HNe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,WNe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,$Ne=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,KNe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,YNe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,XNe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,QNe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,JNe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,ZNe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,eRe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,tRe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,nRe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,aRe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const iRe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,sRe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,rRe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,oRe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,lRe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cRe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,uRe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,dRe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,hRe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fRe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,pRe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,mRe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,gRe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ARe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,yRe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,vRe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_Re=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xRe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bRe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,SRe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,TRe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,wRe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,ERe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,MRe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,CRe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,NRe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,RRe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,PRe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,IRe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,LRe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,DRe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kRe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ORe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,FRe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,_a={alphahash_fragment:s3e,alphahash_pars_fragment:r3e,alphamap_fragment:o3e,alphamap_pars_fragment:l3e,alphatest_fragment:c3e,alphatest_pars_fragment:u3e,aomap_fragment:d3e,aomap_pars_fragment:h3e,batching_pars_vertex:f3e,batching_vertex:p3e,begin_vertex:m3e,beginnormal_vertex:g3e,bsdfs:A3e,iridescence_fragment:y3e,bumpmap_pars_fragment:v3e,clipping_planes_fragment:_3e,clipping_planes_pars_fragment:x3e,clipping_planes_pars_vertex:b3e,clipping_planes_vertex:S3e,color_fragment:T3e,color_pars_fragment:w3e,color_pars_vertex:E3e,color_vertex:M3e,common:C3e,cube_uv_reflection_fragment:N3e,defaultnormal_vertex:R3e,displacementmap_pars_vertex:P3e,displacementmap_vertex:I3e,emissivemap_fragment:L3e,emissivemap_pars_fragment:D3e,colorspace_fragment:k3e,colorspace_pars_fragment:O3e,envmap_fragment:F3e,envmap_common_pars_fragment:j3e,envmap_pars_fragment:B3e,envmap_pars_vertex:U3e,envmap_physical_pars_fragment:Q3e,envmap_vertex:V3e,fog_vertex:z3e,fog_pars_vertex:G3e,fog_fragment:q3e,fog_pars_fragment:H3e,gradientmap_pars_fragment:W3e,lightmap_pars_fragment:$3e,lights_lambert_fragment:K3e,lights_lambert_pars_fragment:Y3e,lights_pars_begin:X3e,lights_toon_fragment:J3e,lights_toon_pars_fragment:Z3e,lights_phong_fragment:eNe,lights_phong_pars_fragment:tNe,lights_physical_fragment:nNe,lights_physical_pars_fragment:aNe,lights_fragment_begin:iNe,lights_fragment_maps:sNe,lights_fragment_end:rNe,logdepthbuf_fragment:oNe,logdepthbuf_pars_fragment:lNe,logdepthbuf_pars_vertex:cNe,logdepthbuf_vertex:uNe,map_fragment:dNe,map_pars_fragment:hNe,map_particle_fragment:fNe,map_particle_pars_fragment:pNe,metalnessmap_fragment:mNe,metalnessmap_pars_fragment:gNe,morphinstance_vertex:ANe,morphcolor_vertex:yNe,morphnormal_vertex:vNe,morphtarget_pars_vertex:_Ne,morphtarget_vertex:xNe,normal_fragment_begin:bNe,normal_fragment_maps:SNe,normal_pars_fragment:TNe,normal_pars_vertex:wNe,normal_vertex:ENe,normalmap_pars_fragment:MNe,clearcoat_normal_fragment_begin:CNe,clearcoat_normal_fragment_maps:NNe,clearcoat_pars_fragment:RNe,iridescence_pars_fragment:PNe,opaque_fragment:INe,packing:LNe,premultiplied_alpha_fragment:DNe,project_vertex:kNe,dithering_fragment:ONe,dithering_pars_fragment:FNe,roughnessmap_fragment:jNe,roughnessmap_pars_fragment:BNe,shadowmap_pars_fragment:UNe,shadowmap_pars_vertex:VNe,shadowmap_vertex:zNe,shadowmask_pars_fragment:GNe,skinbase_vertex:qNe,skinning_pars_vertex:HNe,skinning_vertex:WNe,skinnormal_vertex:$Ne,specularmap_fragment:KNe,specularmap_pars_fragment:YNe,tonemapping_fragment:XNe,tonemapping_pars_fragment:QNe,transmission_fragment:JNe,transmission_pars_fragment:ZNe,uv_pars_fragment:eRe,uv_pars_vertex:tRe,uv_vertex:nRe,worldpos_vertex:aRe,background_vert:iRe,background_frag:sRe,backgroundCube_vert:rRe,backgroundCube_frag:oRe,cube_vert:lRe,cube_frag:cRe,depth_vert:uRe,depth_frag:dRe,distance_vert:hRe,distance_frag:fRe,equirect_vert:pRe,equirect_frag:mRe,linedashed_vert:gRe,linedashed_frag:ARe,meshbasic_vert:yRe,meshbasic_frag:vRe,meshlambert_vert:_Re,meshlambert_frag:xRe,meshmatcap_vert:bRe,meshmatcap_frag:SRe,meshnormal_vert:TRe,meshnormal_frag:wRe,meshphong_vert:ERe,meshphong_frag:MRe,meshphysical_vert:CRe,meshphysical_frag:NRe,meshtoon_vert:RRe,meshtoon_frag:PRe,points_vert:IRe,points_frag:LRe,shadow_vert:DRe,shadow_frag:kRe,sprite_vert:ORe,sprite_frag:FRe},hn={common:{diffuse:{value:new on(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ga},alphaMap:{value:null},alphaMapTransform:{value:new ga},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ga}},envmap:{envMap:{value:null},envMapRotation:{value:new ga},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ga}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ga}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ga},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ga},normalScale:{value:new Nt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ga},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ga}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ga}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ga}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new on(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new on(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ga},alphaTest:{value:0},uvTransform:{value:new ga}},sprite:{diffuse:{value:new on(16777215)},opacity:{value:1},center:{value:new Nt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ga},alphaMap:{value:null},alphaMapTransform:{value:new ga},alphaTest:{value:0}}},El={basic:{uniforms:Sl([hn.common,hn.specularmap,hn.envmap,hn.aomap,hn.lightmap,hn.fog]),vertexShader:_a.meshbasic_vert,fragmentShader:_a.meshbasic_frag},lambert:{uniforms:Sl([hn.common,hn.specularmap,hn.envmap,hn.aomap,hn.lightmap,hn.emissivemap,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.fog,hn.lights,{emissive:{value:new on(0)}}]),vertexShader:_a.meshlambert_vert,fragmentShader:_a.meshlambert_frag},phong:{uniforms:Sl([hn.common,hn.specularmap,hn.envmap,hn.aomap,hn.lightmap,hn.emissivemap,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.fog,hn.lights,{emissive:{value:new on(0)},specular:{value:new on(1118481)},shininess:{value:30}}]),vertexShader:_a.meshphong_vert,fragmentShader:_a.meshphong_frag},standard:{uniforms:Sl([hn.common,hn.envmap,hn.aomap,hn.lightmap,hn.emissivemap,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.roughnessmap,hn.metalnessmap,hn.fog,hn.lights,{emissive:{value:new on(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:_a.meshphysical_vert,fragmentShader:_a.meshphysical_frag},toon:{uniforms:Sl([hn.common,hn.aomap,hn.lightmap,hn.emissivemap,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.gradientmap,hn.fog,hn.lights,{emissive:{value:new on(0)}}]),vertexShader:_a.meshtoon_vert,fragmentShader:_a.meshtoon_frag},matcap:{uniforms:Sl([hn.common,hn.bumpmap,hn.normalmap,hn.displacementmap,hn.fog,{matcap:{value:null}}]),vertexShader:_a.meshmatcap_vert,fragmentShader:_a.meshmatcap_frag},points:{uniforms:Sl([hn.points,hn.fog]),vertexShader:_a.points_vert,fragmentShader:_a.points_frag},dashed:{uniforms:Sl([hn.common,hn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:_a.linedashed_vert,fragmentShader:_a.linedashed_frag},depth:{uniforms:Sl([hn.common,hn.displacementmap]),vertexShader:_a.depth_vert,fragmentShader:_a.depth_frag},normal:{uniforms:Sl([hn.common,hn.bumpmap,hn.normalmap,hn.displacementmap,{opacity:{value:1}}]),vertexShader:_a.meshnormal_vert,fragmentShader:_a.meshnormal_frag},sprite:{uniforms:Sl([hn.sprite,hn.fog]),vertexShader:_a.sprite_vert,fragmentShader:_a.sprite_frag},background:{uniforms:{uvTransform:{value:new ga},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:_a.background_vert,fragmentShader:_a.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ga}},vertexShader:_a.backgroundCube_vert,fragmentShader:_a.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:_a.cube_vert,fragmentShader:_a.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:_a.equirect_vert,fragmentShader:_a.equirect_frag},distance:{uniforms:Sl([hn.common,hn.displacementmap,{referencePosition:{value:new ye},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:_a.distance_vert,fragmentShader:_a.distance_frag},shadow:{uniforms:Sl([hn.lights,hn.fog,{color:{value:new on(0)},opacity:{value:1}}]),vertexShader:_a.shadow_vert,fragmentShader:_a.shadow_frag}};El.physical={uniforms:Sl([El.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ga},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ga},clearcoatNormalScale:{value:new Nt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ga},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ga},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ga},sheen:{value:0},sheenColor:{value:new on(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ga},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ga},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ga},transmissionSamplerSize:{value:new Nt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ga},attenuationDistance:{value:0},attenuationColor:{value:new on(0)},specularColor:{value:new on(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ga},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ga},anisotropyVector:{value:new Nt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ga}}]),vertexShader:_a.meshphysical_vert,fragmentShader:_a.meshphysical_frag};const MM={r:0,b:0,g:0},mA=new fo,jRe=new _n;function BRe(a,e,n,i,s,r,o){const l=new on(0);let c=r===!0?0:1,u,h,f=null,m=0,A=null;function x(I){let F=I.isScene===!0?I.background:null;return F&&F.isTexture&&(F=(I.backgroundBlurriness>0?n:e).get(F)),F}function T(I){let F=!1;const G=x(I);G===null?M(l,c):G&&G.isColor&&(M(G,1),F=!0);const O=a.xr.getEnvironmentBlendMode();O==="additive"?i.buffers.color.setClear(0,0,0,1,o):O==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(a.autoClear||F)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil))}function E(I,F){const G=x(F);G&&(G.isCubeTexture||G.mapping===Am)?(h===void 0&&(h=new Na(new Yf(1,1,1),new mo({name:"BackgroundCubeMaterial",uniforms:sx(El.backgroundCube.uniforms),vertexShader:El.backgroundCube.vertexShader,fragmentShader:El.backgroundCube.fragmentShader,side:Di,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(O,D,j){this.matrixWorld.copyPosition(j.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(h)),mA.copy(F.backgroundRotation),mA.x*=-1,mA.y*=-1,mA.z*=-1,G.isCubeTexture&&G.isRenderTargetTexture===!1&&(mA.y*=-1,mA.z*=-1),h.material.uniforms.envMap.value=G,h.material.uniforms.flipEnvMap.value=G.isCubeTexture&&G.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=F.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=F.backgroundIntensity,h.material.uniforms.backgroundRotation.value.setFromMatrix4(jRe.makeRotationFromEuler(mA)),h.material.toneMapped=Vn.getTransfer(G.colorSpace)!==An,(f!==G||m!==G.version||A!==a.toneMapping)&&(h.material.needsUpdate=!0,f=G,m=G.version,A=a.toneMapping),h.layers.enableAll(),I.unshift(h,h.geometry,h.material,0,0,null)):G&&G.isTexture&&(u===void 0&&(u=new Na(new h1(2,2),new mo({name:"BackgroundMaterial",uniforms:sx(El.background.uniforms),vertexShader:El.background.vertexShader,fragmentShader:El.background.fragmentShader,side:Ac,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(u)),u.material.uniforms.t2D.value=G,u.material.uniforms.backgroundIntensity.value=F.backgroundIntensity,u.material.toneMapped=Vn.getTransfer(G.colorSpace)!==An,G.matrixAutoUpdate===!0&&G.updateMatrix(),u.material.uniforms.uvTransform.value.copy(G.matrix),(f!==G||m!==G.version||A!==a.toneMapping)&&(u.material.needsUpdate=!0,f=G,m=G.version,A=a.toneMapping),u.layers.enableAll(),I.unshift(u,u.geometry,u.material,0,0,null))}function M(I,F){I.getRGB(MM,Tee(a)),i.buffers.color.setClear(MM.r,MM.g,MM.b,F,o)}function N(){h!==void 0&&(h.geometry.dispose(),h.material.dispose(),h=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return l},setClearColor:function(I,F=1){l.set(I),c=F,M(l,c)},getClearAlpha:function(){return c},setClearAlpha:function(I){c=I,M(l,c)},render:T,addToRenderList:E,dispose:N}}function URe(a,e){const n=a.getParameter(a.MAX_VERTEX_ATTRIBS),i={},s=m(null);let r=s,o=!1;function l(U,q,K,H,X){let ne=!1;const Q=f(H,K,q);r!==Q&&(r=Q,u(r.object)),ne=A(U,H,K,X),ne&&x(U,H,K,X),X!==null&&e.update(X,a.ELEMENT_ARRAY_BUFFER),(ne||o)&&(o=!1,F(U,q,K,H),X!==null&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e.get(X).buffer))}function c(){return a.createVertexArray()}function u(U){return a.bindVertexArray(U)}function h(U){return a.deleteVertexArray(U)}function f(U,q,K){const H=K.wireframe===!0;let X=i[U.id];X===void 0&&(X={},i[U.id]=X);let ne=X[q.id];ne===void 0&&(ne={},X[q.id]=ne);let Q=ne[H];return Q===void 0&&(Q=m(c()),ne[H]=Q),Q}function m(U){const q=[],K=[],H=[];for(let X=0;X<n;X++)q[X]=0,K[X]=0,H[X]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:q,enabledAttributes:K,attributeDivisors:H,object:U,attributes:{},index:null}}function A(U,q,K,H){const X=r.attributes,ne=q.attributes;let Q=0;const Y=K.getAttributes();for(const ue in Y)if(Y[ue].location>=0){const Ee=X[ue];let oe=ne[ue];if(oe===void 0&&(ue==="instanceMatrix"&&U.instanceMatrix&&(oe=U.instanceMatrix),ue==="instanceColor"&&U.instanceColor&&(oe=U.instanceColor)),Ee===void 0||Ee.attribute!==oe||oe&&Ee.data!==oe.data)return!0;Q++}return r.attributesNum!==Q||r.index!==H}function x(U,q,K,H){const X={},ne=q.attributes;let Q=0;const Y=K.getAttributes();for(const ue in Y)if(Y[ue].location>=0){let Ee=ne[ue];Ee===void 0&&(ue==="instanceMatrix"&&U.instanceMatrix&&(Ee=U.instanceMatrix),ue==="instanceColor"&&U.instanceColor&&(Ee=U.instanceColor));const oe={};oe.attribute=Ee,Ee&&Ee.data&&(oe.data=Ee.data),X[ue]=oe,Q++}r.attributes=X,r.attributesNum=Q,r.index=H}function T(){const U=r.newAttributes;for(let q=0,K=U.length;q<K;q++)U[q]=0}function E(U){M(U,0)}function M(U,q){const K=r.newAttributes,H=r.enabledAttributes,X=r.attributeDivisors;K[U]=1,H[U]===0&&(a.enableVertexAttribArray(U),H[U]=1),X[U]!==q&&(a.vertexAttribDivisor(U,q),X[U]=q)}function N(){const U=r.newAttributes,q=r.enabledAttributes;for(let K=0,H=q.length;K<H;K++)q[K]!==U[K]&&(a.disableVertexAttribArray(K),q[K]=0)}function I(U,q,K,H,X,ne,Q){Q===!0?a.vertexAttribIPointer(U,q,K,X,ne):a.vertexAttribPointer(U,q,K,H,X,ne)}function F(U,q,K,H){T();const X=H.attributes,ne=K.getAttributes(),Q=q.defaultAttributeValues;for(const Y in ne){const ue=ne[Y];if(ue.location>=0){let pe=X[Y];if(pe===void 0&&(Y==="instanceMatrix"&&U.instanceMatrix&&(pe=U.instanceMatrix),Y==="instanceColor"&&U.instanceColor&&(pe=U.instanceColor)),pe!==void 0){const Ee=pe.normalized,oe=pe.itemSize,Ae=e.get(pe);if(Ae===void 0)continue;const be=Ae.buffer,Ce=Ae.type,ce=Ae.bytesPerElement,te=Ce===a.INT||Ce===a.UNSIGNED_INT||pe.gpuType===jr;if(pe.isInterleavedBufferAttribute){const fe=pe.data,Le=fe.stride,Fe=pe.offset;if(fe.isInstancedInterleavedBuffer){for(let Ie=0;Ie<ue.locationSize;Ie++)M(ue.location+Ie,fe.meshPerAttribute);U.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let Ie=0;Ie<ue.locationSize;Ie++)E(ue.location+Ie);a.bindBuffer(a.ARRAY_BUFFER,be);for(let Ie=0;Ie<ue.locationSize;Ie++)I(ue.location+Ie,oe/ue.locationSize,Ce,Ee,Le*ce,(Fe+oe/ue.locationSize*Ie)*ce,te)}else{if(pe.isInstancedBufferAttribute){for(let fe=0;fe<ue.locationSize;fe++)M(ue.location+fe,pe.meshPerAttribute);U.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=pe.meshPerAttribute*pe.count)}else for(let fe=0;fe<ue.locationSize;fe++)E(ue.location+fe);a.bindBuffer(a.ARRAY_BUFFER,be);for(let fe=0;fe<ue.locationSize;fe++)I(ue.location+fe,oe/ue.locationSize,Ce,Ee,oe*ce,oe/ue.locationSize*fe*ce,te)}}else if(Q!==void 0){const Ee=Q[Y];if(Ee!==void 0)switch(Ee.length){case 2:a.vertexAttrib2fv(ue.location,Ee);break;case 3:a.vertexAttrib3fv(ue.location,Ee);break;case 4:a.vertexAttrib4fv(ue.location,Ee);break;default:a.vertexAttrib1fv(ue.location,Ee)}}}}N()}function G(){j();for(const U in i){const q=i[U];for(const K in q){const H=q[K];for(const X in H)h(H[X].object),delete H[X];delete q[K]}delete i[U]}}function O(U){if(i[U.id]===void 0)return;const q=i[U.id];for(const K in q){const H=q[K];for(const X in H)h(H[X].object),delete H[X];delete q[K]}delete i[U.id]}function D(U){for(const q in i){const K=i[q];if(K[U.id]===void 0)continue;const H=K[U.id];for(const X in H)h(H[X].object),delete H[X];delete K[U.id]}}function j(){L(),o=!0,r!==s&&(r=s,u(r.object))}function L(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:l,reset:j,resetDefaultState:L,dispose:G,releaseStatesOfGeometry:O,releaseStatesOfProgram:D,initAttributes:T,enableAttribute:E,disableUnusedAttributes:N}}function VRe(a,e,n){let i;function s(u){i=u}function r(u,h){a.drawArrays(i,u,h),n.update(h,i,1)}function o(u,h,f){f!==0&&(a.drawArraysInstanced(i,u,h,f),n.update(h,i,f))}function l(u,h,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,u,0,h,0,f);let A=0;for(let x=0;x<f;x++)A+=h[x];n.update(A,i,1)}function c(u,h,f,m){if(f===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let x=0;x<u.length;x++)o(u[x],h[x],m[x]);else{A.multiDrawArraysInstancedWEBGL(i,u,0,h,0,m,0,f);let x=0;for(let T=0;T<f;T++)x+=h[T]*m[T];n.update(x,i,1)}}this.setMode=s,this.render=r,this.renderInstances=o,this.renderMultiDraw=l,this.renderMultiDrawInstances=c}function zRe(a,e,n,i){let s;function r(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const D=e.get("EXT_texture_filter_anisotropic");s=a.getParameter(D.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function o(D){return!(D!==fs&&i.convert(D)!==a.getParameter(a.IMPLEMENTATION_COLOR_READ_FORMAT))}function l(D){const j=D===cs&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(D!==os&&i.convert(D)!==a.getParameter(a.IMPLEMENTATION_COLOR_READ_TYPE)&&D!==ls&&!j)}function c(D){if(D==="highp"){if(a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision>0)return"highp";D="mediump"}return D==="mediump"&&a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=n.precision!==void 0?n.precision:"highp";const h=c(u);h!==u&&(yt("WebGLRenderer:",u,"not supported, using",h,"instead."),u=h);const f=n.logarithmicDepthBuffer===!0,m=n.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),A=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),x=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),T=a.getParameter(a.MAX_TEXTURE_SIZE),E=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),M=a.getParameter(a.MAX_VERTEX_ATTRIBS),N=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),I=a.getParameter(a.MAX_VARYING_VECTORS),F=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),G=a.getParameter(a.MAX_SAMPLES),O=a.getParameter(a.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:c,textureFormatReadable:o,textureTypeReadable:l,precision:u,logarithmicDepthBuffer:f,reversedDepthBuffer:m,maxTextures:A,maxVertexTextures:x,maxTextureSize:T,maxCubemapSize:E,maxAttributes:M,maxVertexUniforms:N,maxVaryings:I,maxFragmentUniforms:F,maxSamples:G,samples:O}}function GRe(a){const e=this;let n=null,i=0,s=!1,r=!1;const o=new Nd,l=new ga,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(f,m){const A=f.length!==0||m||i!==0||s;return s=m,i=f.length,A},this.beginShadows=function(){r=!0,h(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(f,m){n=h(f,m,0)},this.setState=function(f,m,A){const x=f.clippingPlanes,T=f.clipIntersection,E=f.clipShadows,M=a.get(f);if(!s||x===null||x.length===0||r&&!E)r?h(null):u();else{const N=r?0:i,I=N*4;let F=M.clippingState||null;c.value=F,F=h(x,m,I,A);for(let G=0;G!==I;++G)F[G]=n[G];M.clippingState=F,this.numIntersection=T?this.numPlanes:0,this.numPlanes+=N}};function u(){c.value!==n&&(c.value=n,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function h(f,m,A,x){const T=f!==null?f.length:0;let E=null;if(T!==0){if(E=c.value,x!==!0||E===null){const M=A+T*4,N=m.matrixWorldInverse;l.getNormalMatrix(N),(E===null||E.length<M)&&(E=new Float32Array(M));for(let I=0,F=A;I!==T;++I,F+=4)o.copy(f[I]).applyMatrix4(N,l),o.normal.toArray(E,F),E[F+3]=o.constant}c.value=E,c.needsUpdate=!0}return e.numPlanes=T,e.numIntersection=0,E}}function qRe(a){let e=new WeakMap;function n(o,l){return l===d0?o.mapping=xc:l===h0&&(o.mapping=Wu),o}function i(o){if(o&&o.isTexture){const l=o.mapping;if(l===d0||l===h0)if(e.has(o)){const c=e.get(o).texture;return n(c,o.mapping)}else{const c=o.image;if(c&&c.height>0){const u=new QP(c.height);return u.fromEquirectangularTexture(a,o),e.set(o,u),o.addEventListener("dispose",s),n(u.texture,o.mapping)}else return null}}return o}function s(o){const l=o.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function r(){e=new WeakMap}return{get:i,dispose:r}}const Vg=4,WH=[.125,.215,.35,.446,.526,.582],PA=20,HRe=256,t2=new P0,$H=new on;let n5=null,a5=0,i5=0,s5=!1;const WRe=new ye;let kk=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,n=0,i=.1,s=100,r={}){const{size:o=256,position:l=WRe}=r;n5=this._renderer.getRenderTarget(),a5=this._renderer.getActiveCubeFace(),i5=this._renderer.getActiveMipmapLevel(),s5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,i,s,c,l),n>0&&this._blur(c,0,0,n),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=XH(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=YH(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(n5,a5,i5),this._renderer.xr.enabled=s5,e.scissorTest=!1,wv(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===xc||e.mapping===Wu?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),n5=this._renderer.getRenderTarget(),a5=this._renderer.getActiveCubeFace(),i5=this._renderer.getActiveMipmapLevel(),s5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:di,minFilter:di,generateMipmaps:!1,type:cs,format:fs,colorSpace:_m,depthBuffer:!1},s=KH(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=KH(e,n,i);const{_lodMax:r}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=$Re(r)),this._blurMaterial=YRe(r,e,n),this._ggxMaterial=KRe(r,e,n)}return s}_compileMaterial(e){const n=new Na(new zn,e);this._renderer.compile(n,t2)}_sceneToCubeUV(e,n,i,s,r){const c=new Zs(90,1,n,i),u=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],f=this._renderer,m=f.autoClear,A=f.toneMapping;f.getClearColor($H),f.toneMapping=lo,f.autoClear=!1,f.state.buffers.depth.getReversed()&&(f.setRenderTarget(s),f.clearDepth(),f.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new Na(new Yf,new oo({name:"PMREM.Background",side:Di,depthWrite:!1,depthTest:!1})));const T=this._backgroundBox,E=T.material;let M=!1;const N=e.background;N?N.isColor&&(E.color.copy(N),e.background=null,M=!0):(E.color.copy($H),M=!0);for(let I=0;I<6;I++){const F=I%3;F===0?(c.up.set(0,u[I],0),c.position.set(r.x,r.y,r.z),c.lookAt(r.x+h[I],r.y,r.z)):F===1?(c.up.set(0,0,u[I]),c.position.set(r.x,r.y,r.z),c.lookAt(r.x,r.y+h[I],r.z)):(c.up.set(0,u[I],0),c.position.set(r.x,r.y,r.z),c.lookAt(r.x,r.y,r.z+h[I]));const G=this._cubeSize;wv(s,F*G,I>2?G:0,G,G),f.setRenderTarget(s),M&&f.render(T,c),f.render(e,c)}f.toneMapping=A,f.autoClear=m,e.background=N}_textureToCubeUV(e,n){const i=this._renderer,s=e.mapping===xc||e.mapping===Wu;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=XH()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=YH());const r=s?this._cubemapMaterial:this._equirectMaterial,o=this._lodMeshes[0];o.material=r;const l=r.uniforms;l.envMap.value=e;const c=this._cubeSize;wv(n,0,0,3*c,2*c),i.setRenderTarget(n),i.render(o,t2)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const s=this._lodMeshes.length;for(let r=1;r<s;r++)this._applyGGXFilter(e,r-1,r);n.autoClear=i}_applyGGXFilter(e,n,i){const s=this._renderer,r=this._pingPongRenderTarget,o=this._ggxMaterial,l=this._lodMeshes[i];l.material=o;const c=o.uniforms,u=i/(this._lodMeshes.length-1),h=n/(this._lodMeshes.length-1),f=Math.sqrt(u*u-h*h),m=0+u*1.25,A=f*m,{_lodMax:x}=this,T=this._sizeLods[i],E=3*T*(i>x-Vg?i-x+Vg:0),M=4*(this._cubeSize-T);c.envMap.value=e.texture,c.roughness.value=A,c.mipInt.value=x-n,wv(r,E,M,3*T,2*T),s.setRenderTarget(r),s.render(l,t2),c.envMap.value=r.texture,c.roughness.value=0,c.mipInt.value=x-i,wv(e,E,M,3*T,2*T),s.setRenderTarget(e),s.render(l,t2)}_blur(e,n,i,s,r){const o=this._pingPongRenderTarget;this._halfBlur(e,o,n,i,s,"latitudinal",r),this._halfBlur(o,e,i,i,s,"longitudinal",r)}_halfBlur(e,n,i,s,r,o,l){const c=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&Rt("blur direction must be either latitudinal or longitudinal!");const h=3,f=this._lodMeshes[s];f.material=u;const m=u.uniforms,A=this._sizeLods[i]-1,x=isFinite(r)?Math.PI/(2*A):2*Math.PI/(2*PA-1),T=r/x,E=isFinite(r)?1+Math.floor(h*T):PA;E>PA&&yt(`sigmaRadians, ${r}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${PA}`);const M=[];let N=0;for(let D=0;D<PA;++D){const j=D/T,L=Math.exp(-j*j/2);M.push(L),D===0?N+=L:D<E&&(N+=2*L)}for(let D=0;D<M.length;D++)M[D]=M[D]/N;m.envMap.value=e.texture,m.samples.value=E,m.weights.value=M,m.latitudinal.value=o==="latitudinal",l&&(m.poleAxis.value=l);const{_lodMax:I}=this;m.dTheta.value=x,m.mipInt.value=I-i;const F=this._sizeLods[s],G=3*F*(s>I-Vg?s-I+Vg:0),O=4*(this._cubeSize-F);wv(n,G,O,3*F,2*F),c.setRenderTarget(n),c.render(f,t2)}};function $Re(a){const e=[],n=[],i=[];let s=a;const r=a-Vg+1+WH.length;for(let o=0;o<r;o++){const l=Math.pow(2,s);e.push(l);let c=1/l;o>a-Vg?c=WH[o-a+Vg-1]:o===0&&(c=0),n.push(c);const u=1/(l-2),h=-u,f=1+u,m=[h,h,f,h,f,f,h,h,f,f,h,f],A=6,x=6,T=3,E=2,M=1,N=new Float32Array(T*x*A),I=new Float32Array(E*x*A),F=new Float32Array(M*x*A);for(let O=0;O<A;O++){const D=O%3*2/3-1,j=O>2?0:-1,L=[D,j,0,D+2/3,j,0,D+2/3,j+1,0,D,j,0,D+2/3,j+1,0,D,j+1,0];N.set(L,T*x*O),I.set(m,E*x*O);const U=[O,O,O,O,O,O];F.set(U,M*x*O)}const G=new zn;G.setAttribute("position",new Ua(N,T)),G.setAttribute("uv",new Ua(I,E)),G.setAttribute("faceIndex",new Ua(F,M)),i.push(new Na(G,null)),s>Vg&&s--}return{lodMeshes:i,sizeLods:e,sigmas:n}}function KH(a,e,n){const i=new vc(a,e,n);return i.texture.mapping=Am,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function wv(a,e,n,i,s){a.viewport.set(e,n,i,s),a.scissor.set(e,n,i,s)}function KRe(a,e,n){return new mo({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:HRe,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${a}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:b4(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:hl,depthTest:!1,depthWrite:!1})}function YRe(a,e,n){const i=new Float32Array(PA),s=new ye(0,1,0);return new mo({name:"SphericalGaussianBlur",defines:{n:PA,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${a}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:b4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:hl,depthTest:!1,depthWrite:!1})}function YH(){return new mo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:b4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:hl,depthTest:!1,depthWrite:!1})}function XH(){return new mo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:b4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:hl,depthTest:!1,depthWrite:!1})}function b4(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function XRe(a){let e=new WeakMap,n=null;function i(l){if(l&&l.isTexture){const c=l.mapping,u=c===d0||c===h0,h=c===xc||c===Wu;if(u||h){let f=e.get(l);const m=f!==void 0?f.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==m)return n===null&&(n=new kk(a)),f=u?n.fromEquirectangular(l,f):n.fromCubemap(l,f),f.texture.pmremVersion=l.pmremVersion,e.set(l,f),f.texture;if(f!==void 0)return f.texture;{const A=l.image;return u&&A&&A.height>0||h&&A&&s(A)?(n===null&&(n=new kk(a)),f=u?n.fromEquirectangular(l):n.fromCubemap(l),f.texture.pmremVersion=l.pmremVersion,e.set(l,f),l.addEventListener("dispose",r),f.texture):null}}}return l}function s(l){let c=0;const u=6;for(let h=0;h<u;h++)l[h]!==void 0&&c++;return c===u}function r(l){const c=l.target;c.removeEventListener("dispose",r);const u=e.get(c);u!==void 0&&(e.delete(c),u.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:o}}function QRe(a){const e={};function n(i){if(e[i]!==void 0)return e[i];const s=a.getExtension(i);return e[i]=s,s}return{has:function(i){return n(i)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(i){const s=n(i);return s===null&&ji("WebGLRenderer: "+i+" extension not supported."),s}}}function JRe(a,e,n,i){const s={},r=new WeakMap;function o(f){const m=f.target;m.index!==null&&e.remove(m.index);for(const x in m.attributes)e.remove(m.attributes[x]);m.removeEventListener("dispose",o),delete s[m.id];const A=r.get(m);A&&(e.remove(A),r.delete(m)),i.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,n.memory.geometries--}function l(f,m){return s[m.id]===!0||(m.addEventListener("dispose",o),s[m.id]=!0,n.memory.geometries++),m}function c(f){const m=f.attributes;for(const A in m)e.update(m[A],a.ARRAY_BUFFER)}function u(f){const m=[],A=f.index,x=f.attributes.position;let T=0;if(A!==null){const N=A.array;T=A.version;for(let I=0,F=N.length;I<F;I+=3){const G=N[I+0],O=N[I+1],D=N[I+2];m.push(G,O,O,D,D,G)}}else if(x!==void 0){const N=x.array;T=x.version;for(let I=0,F=N.length/3-1;I<F;I+=3){const G=I+0,O=I+1,D=I+2;m.push(G,O,O,D,D,G)}}else return;const E=new(nj(m)?XP:YP)(m,1);E.version=T;const M=r.get(f);M&&e.remove(M),r.set(f,E)}function h(f){const m=r.get(f);if(m){const A=f.index;A!==null&&m.version<A.version&&u(f)}else u(f);return r.get(f)}return{get:l,update:c,getWireframeAttribute:h}}function ZRe(a,e,n){let i;function s(m){i=m}let r,o;function l(m){r=m.type,o=m.bytesPerElement}function c(m,A){a.drawElements(i,A,r,m*o),n.update(A,i,1)}function u(m,A,x){x!==0&&(a.drawElementsInstanced(i,A,r,m*o,x),n.update(A,i,x))}function h(m,A,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,A,0,r,m,0,x);let E=0;for(let M=0;M<x;M++)E+=A[M];n.update(E,i,1)}function f(m,A,x,T){if(x===0)return;const E=e.get("WEBGL_multi_draw");if(E===null)for(let M=0;M<m.length;M++)u(m[M]/o,A[M],T[M]);else{E.multiDrawElementsInstancedWEBGL(i,A,0,r,m,0,T,0,x);let M=0;for(let N=0;N<x;N++)M+=A[N]*T[N];n.update(M,i,1)}}this.setMode=s,this.setIndex=l,this.render=c,this.renderInstances=u,this.renderMultiDraw=h,this.renderMultiDrawInstances=f}function ePe(a){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(r,o,l){switch(n.calls++,o){case a.TRIANGLES:n.triangles+=l*(r/3);break;case a.LINES:n.lines+=l*(r/2);break;case a.LINE_STRIP:n.lines+=l*(r-1);break;case a.LINE_LOOP:n.lines+=l*r;break;case a.POINTS:n.points+=l*r;break;default:Rt("WebGLInfo: Unknown draw mode:",o);break}}function s(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:s,update:i}}function tPe(a,e,n){const i=new WeakMap,s=new qn;function r(o,l,c){const u=o.morphTargetInfluences,h=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,f=h!==void 0?h.length:0;let m=i.get(l);if(m===void 0||m.count!==f){let L=function(){D.dispose(),i.delete(l),l.removeEventListener("dispose",L)};m!==void 0&&m.texture.dispose();const A=l.morphAttributes.position!==void 0,x=l.morphAttributes.normal!==void 0,T=l.morphAttributes.color!==void 0,E=l.morphAttributes.position||[],M=l.morphAttributes.normal||[],N=l.morphAttributes.color||[];let I=0;A===!0&&(I=1),x===!0&&(I=2),T===!0&&(I=3);let F=l.attributes.position.count*I,G=1;F>e.maxTextureSize&&(G=Math.ceil(F/e.maxTextureSize),F=e.maxTextureSize);const O=new Float32Array(F*G*4*f),D=new YT(O,F,G,f);D.type=ls,D.needsUpdate=!0;const j=I*4;for(let U=0;U<f;U++){const q=E[U],K=M[U],H=N[U],X=F*G*4*U;for(let ne=0;ne<q.count;ne++){const Q=ne*j;A===!0&&(s.fromBufferAttribute(q,ne),O[X+Q+0]=s.x,O[X+Q+1]=s.y,O[X+Q+2]=s.z,O[X+Q+3]=0),x===!0&&(s.fromBufferAttribute(K,ne),O[X+Q+4]=s.x,O[X+Q+5]=s.y,O[X+Q+6]=s.z,O[X+Q+7]=0),T===!0&&(s.fromBufferAttribute(H,ne),O[X+Q+8]=s.x,O[X+Q+9]=s.y,O[X+Q+10]=s.z,O[X+Q+11]=H.itemSize===4?s.w:1)}}m={count:f,texture:D,size:new Nt(F,G)},i.set(l,m),l.addEventListener("dispose",L)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)c.getUniforms().setValue(a,"morphTexture",o.morphTexture,n);else{let A=0;for(let T=0;T<u.length;T++)A+=u[T];const x=l.morphTargetsRelative?1:1-A;c.getUniforms().setValue(a,"morphTargetBaseInfluence",x),c.getUniforms().setValue(a,"morphTargetInfluences",u)}c.getUniforms().setValue(a,"morphTargetsTexture",m.texture,n),c.getUniforms().setValue(a,"morphTargetsTextureSize",m.size)}return{update:r}}function nPe(a,e,n,i){let s=new WeakMap;function r(c){const u=i.render.frame,h=c.geometry,f=e.get(c,h);if(s.get(f)!==u&&(e.update(f),s.set(f,u)),c.isInstancedMesh&&(c.hasEventListener("dispose",l)===!1&&c.addEventListener("dispose",l),s.get(c)!==u&&(n.update(c.instanceMatrix,a.ARRAY_BUFFER),c.instanceColor!==null&&n.update(c.instanceColor,a.ARRAY_BUFFER),s.set(c,u))),c.isSkinnedMesh){const m=c.skeleton;s.get(m)!==u&&(m.update(),s.set(m,u))}return f}function o(){s=new WeakMap}function l(c){const u=c.target;u.removeEventListener("dispose",l),n.remove(u.instanceMatrix),u.instanceColor!==null&&n.remove(u.instanceColor)}return{update:r,dispose:o}}const aPe={[DP]:"LINEAR_TONE_MAPPING",[kP]:"REINHARD_TONE_MAPPING",[OP]:"CINEON_TONE_MAPPING",[FP]:"ACES_FILMIC_TONE_MAPPING",[jP]:"AGX_TONE_MAPPING",[BP]:"NEUTRAL_TONE_MAPPING",[JF]:"CUSTOM_TONE_MAPPING"};function iPe(a,e,n,i,s){const r=new vc(e,n,{type:a,depthBuffer:i,stencilBuffer:s}),o=new vc(e,n,{type:cs,depthBuffer:!1,stencilBuffer:!1}),l=new zn;l.setAttribute("position",new mn([-1,3,0,-1,-1,0,3,-1,0],3)),l.setAttribute("uv",new mn([0,2,0,0,2,0],2));const c=new _j({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),u=new Na(l,c),h=new P0(-1,1,1,-1,0,1);let f=null,m=null,A=!1,x,T=null,E=[],M=!1;this.setSize=function(N,I){r.setSize(N,I),o.setSize(N,I);for(let F=0;F<E.length;F++){const G=E[F];G.setSize&&G.setSize(N,I)}},this.setEffects=function(N){E=N,M=E.length>0&&E[0].isRenderPass===!0;const I=r.width,F=r.height;for(let G=0;G<E.length;G++){const O=E[G];O.setSize&&O.setSize(I,F)}},this.begin=function(N,I){if(A||N.toneMapping===lo&&E.length===0)return!1;if(T=I,I!==null){const F=I.width,G=I.height;(r.width!==F||r.height!==G)&&this.setSize(F,G)}return M===!1&&N.setRenderTarget(r),x=N.toneMapping,N.toneMapping=lo,!0},this.hasRenderPass=function(){return M},this.end=function(N,I){N.toneMapping=x,A=!0;let F=r,G=o;for(let O=0;O<E.length;O++){const D=E[O];if(D.enabled!==!1&&(D.render(N,G,F,I),D.needsSwap!==!1)){const j=F;F=G,G=j}}if(f!==N.outputColorSpace||m!==N.toneMapping){f=N.outputColorSpace,m=N.toneMapping,c.defines={},Vn.getTransfer(f)===An&&(c.defines.SRGB_TRANSFER="");const O=aPe[m];O&&(c.defines[O]=""),c.needsUpdate=!0}c.uniforms.tDiffuse.value=F.texture,N.setRenderTarget(T),N.render(u,h),T=null,A=!1},this.isCompositing=function(){return A},this.dispose=function(){r.dispose(),o.dispose(),l.dispose(),c.dispose()}}const ate=new _s,Ok=new Do(1,1),ite=new YT,ste=new $P,rte=new M0,QH=[],JH=[],ZH=new Float32Array(16),eW=new Float32Array(9),tW=new Float32Array(4);function qx(a,e,n){const i=a[0];if(i<=0||i>0)return a;const s=e*n;let r=QH[s];if(r===void 0&&(r=new Float32Array(s),QH[s]=r),e!==0){i.toArray(r,0);for(let o=1,l=0;o!==e;++o)l+=n,a[o].toArray(r,l)}return r}function Gr(a,e){if(a.length!==e.length)return!1;for(let n=0,i=a.length;n<i;n++)if(a[n]!==e[n])return!1;return!0}function qr(a,e){for(let n=0,i=e.length;n<i;n++)a[n]=e[n]}function S4(a,e){let n=JH[e];n===void 0&&(n=new Int32Array(e),JH[e]=n);for(let i=0;i!==e;++i)n[i]=a.allocateTextureUnit();return n}function sPe(a,e){const n=this.cache;n[0]!==e&&(a.uniform1f(this.addr,e),n[0]=e)}function rPe(a,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(a.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Gr(n,e))return;a.uniform2fv(this.addr,e),qr(n,e)}}function oPe(a,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(a.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(a.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Gr(n,e))return;a.uniform3fv(this.addr,e),qr(n,e)}}function lPe(a,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(a.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Gr(n,e))return;a.uniform4fv(this.addr,e),qr(n,e)}}function cPe(a,e){const n=this.cache,i=e.elements;if(i===void 0){if(Gr(n,e))return;a.uniformMatrix2fv(this.addr,!1,e),qr(n,e)}else{if(Gr(n,i))return;tW.set(i),a.uniformMatrix2fv(this.addr,!1,tW),qr(n,i)}}function uPe(a,e){const n=this.cache,i=e.elements;if(i===void 0){if(Gr(n,e))return;a.uniformMatrix3fv(this.addr,!1,e),qr(n,e)}else{if(Gr(n,i))return;eW.set(i),a.uniformMatrix3fv(this.addr,!1,eW),qr(n,i)}}function dPe(a,e){const n=this.cache,i=e.elements;if(i===void 0){if(Gr(n,e))return;a.uniformMatrix4fv(this.addr,!1,e),qr(n,e)}else{if(Gr(n,i))return;ZH.set(i),a.uniformMatrix4fv(this.addr,!1,ZH),qr(n,i)}}function hPe(a,e){const n=this.cache;n[0]!==e&&(a.uniform1i(this.addr,e),n[0]=e)}function fPe(a,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(a.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Gr(n,e))return;a.uniform2iv(this.addr,e),qr(n,e)}}function pPe(a,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(a.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Gr(n,e))return;a.uniform3iv(this.addr,e),qr(n,e)}}function mPe(a,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(a.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Gr(n,e))return;a.uniform4iv(this.addr,e),qr(n,e)}}function gPe(a,e){const n=this.cache;n[0]!==e&&(a.uniform1ui(this.addr,e),n[0]=e)}function APe(a,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(a.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Gr(n,e))return;a.uniform2uiv(this.addr,e),qr(n,e)}}function yPe(a,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(a.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Gr(n,e))return;a.uniform3uiv(this.addr,e),qr(n,e)}}function vPe(a,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(a.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Gr(n,e))return;a.uniform4uiv(this.addr,e),qr(n,e)}}function _Pe(a,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(a.uniform1i(this.addr,s),i[0]=s);let r;this.type===a.SAMPLER_2D_SHADOW?(Ok.compareFunction=n.isReversedDepthBuffer()?Ux:Bx,r=Ok):r=ate,n.setTexture2D(e||r,s)}function xPe(a,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(a.uniform1i(this.addr,s),i[0]=s),n.setTexture3D(e||ste,s)}function bPe(a,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(a.uniform1i(this.addr,s),i[0]=s),n.setTextureCube(e||rte,s)}function SPe(a,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(a.uniform1i(this.addr,s),i[0]=s),n.setTexture2DArray(e||ite,s)}function TPe(a){switch(a){case 5126:return sPe;case 35664:return rPe;case 35665:return oPe;case 35666:return lPe;case 35674:return cPe;case 35675:return uPe;case 35676:return dPe;case 5124:case 35670:return hPe;case 35667:case 35671:return fPe;case 35668:case 35672:return pPe;case 35669:case 35673:return mPe;case 5125:return gPe;case 36294:return APe;case 36295:return yPe;case 36296:return vPe;case 35678:case 36198:case 36298:case 36306:case 35682:return _Pe;case 35679:case 36299:case 36307:return xPe;case 35680:case 36300:case 36308:case 36293:return bPe;case 36289:case 36303:case 36311:case 36292:return SPe}}function wPe(a,e){a.uniform1fv(this.addr,e)}function EPe(a,e){const n=qx(e,this.size,2);a.uniform2fv(this.addr,n)}function MPe(a,e){const n=qx(e,this.size,3);a.uniform3fv(this.addr,n)}function CPe(a,e){const n=qx(e,this.size,4);a.uniform4fv(this.addr,n)}function NPe(a,e){const n=qx(e,this.size,4);a.uniformMatrix2fv(this.addr,!1,n)}function RPe(a,e){const n=qx(e,this.size,9);a.uniformMatrix3fv(this.addr,!1,n)}function PPe(a,e){const n=qx(e,this.size,16);a.uniformMatrix4fv(this.addr,!1,n)}function IPe(a,e){a.uniform1iv(this.addr,e)}function LPe(a,e){a.uniform2iv(this.addr,e)}function DPe(a,e){a.uniform3iv(this.addr,e)}function kPe(a,e){a.uniform4iv(this.addr,e)}function OPe(a,e){a.uniform1uiv(this.addr,e)}function FPe(a,e){a.uniform2uiv(this.addr,e)}function jPe(a,e){a.uniform3uiv(this.addr,e)}function BPe(a,e){a.uniform4uiv(this.addr,e)}function UPe(a,e,n){const i=this.cache,s=e.length,r=S4(n,s);Gr(i,r)||(a.uniform1iv(this.addr,r),qr(i,r));let o;this.type===a.SAMPLER_2D_SHADOW?o=Ok:o=ate;for(let l=0;l!==s;++l)n.setTexture2D(e[l]||o,r[l])}function VPe(a,e,n){const i=this.cache,s=e.length,r=S4(n,s);Gr(i,r)||(a.uniform1iv(this.addr,r),qr(i,r));for(let o=0;o!==s;++o)n.setTexture3D(e[o]||ste,r[o])}function zPe(a,e,n){const i=this.cache,s=e.length,r=S4(n,s);Gr(i,r)||(a.uniform1iv(this.addr,r),qr(i,r));for(let o=0;o!==s;++o)n.setTextureCube(e[o]||rte,r[o])}function GPe(a,e,n){const i=this.cache,s=e.length,r=S4(n,s);Gr(i,r)||(a.uniform1iv(this.addr,r),qr(i,r));for(let o=0;o!==s;++o)n.setTexture2DArray(e[o]||ite,r[o])}function qPe(a){switch(a){case 5126:return wPe;case 35664:return EPe;case 35665:return MPe;case 35666:return CPe;case 35674:return NPe;case 35675:return RPe;case 35676:return PPe;case 5124:case 35670:return IPe;case 35667:case 35671:return LPe;case 35668:case 35672:return DPe;case 35669:case 35673:return kPe;case 5125:return OPe;case 36294:return FPe;case 36295:return jPe;case 36296:return BPe;case 35678:case 36198:case 36298:case 36306:case 35682:return UPe;case 35679:case 36299:case 36307:return VPe;case 35680:case 36300:case 36308:case 36293:return zPe;case 36289:case 36303:case 36311:case 36292:return GPe}}class HPe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=TPe(n.type)}}class WPe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=qPe(n.type)}}class $Pe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const s=this.seq;for(let r=0,o=s.length;r!==o;++r){const l=s[r];l.setValue(e,n[l.id],i)}}}const r5=/(\w+)(\])?(\[|\.)?/g;function nW(a,e){a.seq.push(e),a.map[e.id]=e}function KPe(a,e,n){const i=a.name,s=i.length;for(r5.lastIndex=0;;){const r=r5.exec(i),o=r5.lastIndex;let l=r[1];const c=r[2]==="]",u=r[3];if(c&&(l=l|0),u===void 0||u==="["&&o+2===s){nW(n,u===void 0?new HPe(l,a,e):new WPe(l,a,e));break}else{let f=n.map[l];f===void 0&&(f=new $Pe(l),nW(n,f)),n=f}}}class XC{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let o=0;o<i;++o){const l=e.getActiveUniform(n,o),c=e.getUniformLocation(n,l.name);KPe(l,c,this)}const s=[],r=[];for(const o of this.seq)o.type===e.SAMPLER_2D_SHADOW||o.type===e.SAMPLER_CUBE_SHADOW||o.type===e.SAMPLER_2D_ARRAY_SHADOW?s.push(o):r.push(o);s.length>0&&(this.seq=s.concat(r))}setValue(e,n,i,s){const r=this.map[n];r!==void 0&&r.setValue(e,i,s)}setOptional(e,n,i){const s=n[i];s!==void 0&&this.setValue(e,i,s)}static upload(e,n,i,s){for(let r=0,o=n.length;r!==o;++r){const l=n[r],c=i[l.id];c.needsUpdate!==!1&&l.setValue(e,c.value,s)}}static seqWithValue(e,n){const i=[];for(let s=0,r=e.length;s!==r;++s){const o=e[s];o.id in n&&i.push(o)}return i}}function aW(a,e,n){const i=a.createShader(e);return a.shaderSource(i,n),a.compileShader(i),i}const YPe=37297;let XPe=0;function QPe(a,e){const n=a.split(`
`),i=[],s=Math.max(e-6,0),r=Math.min(e+6,n.length);for(let o=s;o<r;o++){const l=o+1;i.push(`${l===e?">":" "} ${l}: ${n[o]}`)}return i.join(`
`)}const iW=new ga;function JPe(a){Vn._getMatrix(iW,Vn.workingColorSpace,a);const e=`mat3( ${iW.elements.map(n=>n.toFixed(4))} )`;switch(Vn.getTransfer(a)){case Ky:return[e,"LinearTransferOETF"];case An:return[e,"sRGBTransferOETF"];default:return yt("WebGLProgram: Unsupported color space: ",a),[e,"LinearTransferOETF"]}}function sW(a,e,n){const i=a.getShaderParameter(e,a.COMPILE_STATUS),r=(a.getShaderInfoLog(e)||"").trim();if(i&&r==="")return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const l=parseInt(o[1]);return n.toUpperCase()+`

`+r+`

`+QPe(a.getShaderSource(e),l)}else return r}function ZPe(a,e){const n=JPe(e);return[`vec4 ${a}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}const e4e={[DP]:"Linear",[kP]:"Reinhard",[OP]:"Cineon",[FP]:"ACESFilmic",[jP]:"AgX",[BP]:"Neutral",[JF]:"Custom"};function t4e(a,e){const n=e4e[e];return n===void 0?(yt("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+a+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+a+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const CM=new ye;function n4e(){Vn.getLuminanceCoefficients(CM);const a=CM.x.toFixed(4),e=CM.y.toFixed(4),n=CM.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${a}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function a4e(a){return[a.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",a.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(B2).join(`
`)}function i4e(a){const e=[];for(const n in a){const i=a[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function s4e(a,e){const n={},i=a.getProgramParameter(e,a.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const r=a.getActiveAttrib(e,s),o=r.name;let l=1;r.type===a.FLOAT_MAT2&&(l=2),r.type===a.FLOAT_MAT3&&(l=3),r.type===a.FLOAT_MAT4&&(l=4),n[o]={type:r.type,location:a.getAttribLocation(e,o),locationSize:l}}return n}function B2(a){return a!==""}function rW(a,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return a.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function oW(a,e){return a.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const r4e=/^[ \t]*#include +<([\w\d./]+)>/gm;function Fk(a){return a.replace(r4e,l4e)}const o4e=new Map;function l4e(a,e){let n=_a[e];if(n===void 0){const i=o4e.get(e);if(i!==void 0)n=_a[i],yt('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return Fk(n)}const c4e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function lW(a){return a.replace(c4e,u4e)}function u4e(a,e,n,i){let s="";for(let r=parseInt(e);r<parseInt(n);r++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return s}function cW(a){let e=`precision ${a.precision} float;
	precision ${a.precision} int;
	precision ${a.precision} sampler2D;
	precision ${a.precision} samplerCube;
	precision ${a.precision} sampler3D;
	precision ${a.precision} sampler2DArray;
	precision ${a.precision} sampler2DShadow;
	precision ${a.precision} samplerCubeShadow;
	precision ${a.precision} sampler2DArrayShadow;
	precision ${a.precision} isampler2D;
	precision ${a.precision} isampler3D;
	precision ${a.precision} isamplerCube;
	precision ${a.precision} isampler2DArray;
	precision ${a.precision} usampler2D;
	precision ${a.precision} usampler3D;
	precision ${a.precision} usamplerCube;
	precision ${a.precision} usampler2DArray;
	`;return a.precision==="highp"?e+=`
#define HIGH_PRECISION`:a.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:a.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const d4e={[b_]:"SHADOWMAP_TYPE_PCF",[Hh]:"SHADOWMAP_TYPE_VSM"};function h4e(a){return d4e[a.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const f4e={[xc]:"ENVMAP_TYPE_CUBE",[Wu]:"ENVMAP_TYPE_CUBE",[Am]:"ENVMAP_TYPE_CUBE_UV"};function p4e(a){return a.envMap===!1?"ENVMAP_TYPE_CUBE":f4e[a.envMapMode]||"ENVMAP_TYPE_CUBE"}const m4e={[Wu]:"ENVMAP_MODE_REFRACTION"};function g4e(a){return a.envMap===!1?"ENVMAP_MODE_REFLECTION":m4e[a.envMapMode]||"ENVMAP_MODE_REFLECTION"}const A4e={[Ox]:"ENVMAP_BLENDING_MULTIPLY",[XF]:"ENVMAP_BLENDING_MIX",[QF]:"ENVMAP_BLENDING_ADD"};function y4e(a){return a.envMap===!1?"ENVMAP_BLENDING_NONE":A4e[a.combine]||"ENVMAP_BLENDING_NONE"}function v4e(a){const e=a.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}function _4e(a,e,n,i){const s=a.getContext(),r=n.defines;let o=n.vertexShader,l=n.fragmentShader;const c=h4e(n),u=p4e(n),h=g4e(n),f=y4e(n),m=v4e(n),A=a4e(n),x=i4e(r),T=s.createProgram();let E,M,N=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(E=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x].filter(B2).join(`
`),E.length>0&&(E+=`
`),M=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x].filter(B2).join(`
`),M.length>0&&(M+=`
`)):(E=[cW(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(B2).join(`
`),M=[cW(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",n.envMap?"#define "+f:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==lo?"#define TONE_MAPPING":"",n.toneMapping!==lo?_a.tonemapping_pars_fragment:"",n.toneMapping!==lo?t4e("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",_a.colorspace_pars_fragment,ZPe("linearToOutputTexel",n.outputColorSpace),n4e(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(B2).join(`
`)),o=Fk(o),o=rW(o,n),o=oW(o,n),l=Fk(l),l=rW(l,n),l=oW(l,n),o=lW(o),l=lW(l),n.isRawShaderMaterial!==!0&&(N=`#version 300 es
`,E=[A,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+E,M=["#define varying in",n.glslVersion===Mk?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Mk?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+M);const I=N+E+o,F=N+M+l,G=aW(s,s.VERTEX_SHADER,I),O=aW(s,s.FRAGMENT_SHADER,F);s.attachShader(T,G),s.attachShader(T,O),n.index0AttributeName!==void 0?s.bindAttribLocation(T,0,n.index0AttributeName):n.morphTargets===!0&&s.bindAttribLocation(T,0,"position"),s.linkProgram(T);function D(q){if(a.debug.checkShaderErrors){const K=s.getProgramInfoLog(T)||"",H=s.getShaderInfoLog(G)||"",X=s.getShaderInfoLog(O)||"",ne=K.trim(),Q=H.trim(),Y=X.trim();let ue=!0,pe=!0;if(s.getProgramParameter(T,s.LINK_STATUS)===!1)if(ue=!1,typeof a.debug.onShaderError=="function")a.debug.onShaderError(s,T,G,O);else{const Ee=sW(s,G,"vertex"),oe=sW(s,O,"fragment");Rt("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(T,s.VALIDATE_STATUS)+`

Material Name: `+q.name+`
Material Type: `+q.type+`

Program Info Log: `+ne+`
`+Ee+`
`+oe)}else ne!==""?yt("WebGLProgram: Program Info Log:",ne):(Q===""||Y==="")&&(pe=!1);pe&&(q.diagnostics={runnable:ue,programLog:ne,vertexShader:{log:Q,prefix:E},fragmentShader:{log:Y,prefix:M}})}s.deleteShader(G),s.deleteShader(O),j=new XC(s,T),L=s4e(s,T)}let j;this.getUniforms=function(){return j===void 0&&D(this),j};let L;this.getAttributes=function(){return L===void 0&&D(this),L};let U=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return U===!1&&(U=s.getProgramParameter(T,YPe)),U},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(T),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=XPe++,this.cacheKey=e,this.usedTimes=1,this.program=T,this.vertexShader=G,this.fragmentShader=O,this}let x4e=0;class b4e{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,s=this._getShaderStage(n),r=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(s)===!1&&(o.add(s),s.usedTimes++),o.has(r)===!1&&(o.add(r),r.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new S4e(e),n.set(e,i)),i}}class S4e{constructor(e){this.id=x4e++,this.code=e,this.usedTimes=0}}function T4e(a,e,n,i,s,r,o){const l=new KP,c=new b4e,u=new Set,h=[],f=new Map,m=s.logarithmicDepthBuffer;let A=s.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function T(L){return u.add(L),L===0?"uv":`uv${L}`}function E(L,U,q,K,H){const X=K.fog,ne=H.geometry,Q=L.isMeshStandardMaterial?K.environment:null,Y=(L.isMeshStandardMaterial?n:e).get(L.envMap||Q),ue=Y&&Y.mapping===Am?Y.image.height:null,pe=x[L.type];L.precision!==null&&(A=s.getMaxPrecision(L.precision),A!==L.precision&&yt("WebGLProgram.getParameters:",L.precision,"not supported, using",A,"instead."));const Ee=ne.morphAttributes.position||ne.morphAttributes.normal||ne.morphAttributes.color,oe=Ee!==void 0?Ee.length:0;let Ae=0;ne.morphAttributes.position!==void 0&&(Ae=1),ne.morphAttributes.normal!==void 0&&(Ae=2),ne.morphAttributes.color!==void 0&&(Ae=3);let be,Ce,ce,te;if(pe){const Ta=El[pe];be=Ta.vertexShader,Ce=Ta.fragmentShader}else be=L.vertexShader,Ce=L.fragmentShader,c.update(L),ce=c.getVertexShaderID(L),te=c.getFragmentShaderID(L);const fe=a.getRenderTarget(),Le=a.state.buffers.depth.getReversed(),Fe=H.isInstancedMesh===!0,Ie=H.isBatchedMesh===!0,at=!!L.map,je=!!L.matcap,Ve=!!Y,Me=!!L.aoMap,ze=!!L.lightMap,Je=!!L.bumpMap,rt=!!L.normalMap,ve=!!L.displacementMap,Ue=!!L.emissiveMap,it=!!L.metalnessMap,wt=!!L.roughnessMap,Mt=L.anisotropy>0,_e=L.clearcoat>0,le=L.dispersion>0,Ge=L.iridescence>0,tt=L.sheen>0,pt=L.transmission>0,Te=Mt&&!!L.anisotropyMap,st=_e&&!!L.clearcoatMap,mt=_e&&!!L.clearcoatNormalMap,ht=_e&&!!L.clearcoatRoughnessMap,Qe=Ge&&!!L.iridescenceMap,Xe=Ge&&!!L.iridescenceThicknessMap,ct=tt&&!!L.sheenColorMap,Tt=tt&&!!L.sheenRoughnessMap,kt=!!L.specularMap,vt=!!L.specularColorMap,Tn=!!L.specularIntensityMap,Ne=pt&&!!L.transmissionMap,Xt=pt&&!!L.thicknessMap,Ht=!!L.gradientMap,$t=!!L.alphaMap,zt=L.alphaTest>0,Ot=!!L.alphaHash,an=!!L.extensions;let jn=lo;L.toneMapped&&(fe===null||fe.isXRRenderTarget===!0)&&(jn=a.toneMapping);const ai={shaderID:pe,shaderType:L.type,shaderName:L.name,vertexShader:be,fragmentShader:Ce,defines:L.defines,customVertexShaderID:ce,customFragmentShaderID:te,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:A,batching:Ie,batchingColor:Ie&&H._colorsTexture!==null,instancing:Fe,instancingColor:Fe&&H.instanceColor!==null,instancingMorph:Fe&&H.morphTexture!==null,outputColorSpace:fe===null?a.outputColorSpace:fe.isXRRenderTarget===!0?fe.texture.colorSpace:_m,alphaToCoverage:!!L.alphaToCoverage,map:at,matcap:je,envMap:Ve,envMapMode:Ve&&Y.mapping,envMapCubeUVHeight:ue,aoMap:Me,lightMap:ze,bumpMap:Je,normalMap:rt,displacementMap:ve,emissiveMap:Ue,normalMapObjectSpace:rt&&L.normalMapType===ej,normalMapTangentSpace:rt&&L.normalMapType===qd,metalnessMap:it,roughnessMap:wt,anisotropy:Mt,anisotropyMap:Te,clearcoat:_e,clearcoatMap:st,clearcoatNormalMap:mt,clearcoatRoughnessMap:ht,dispersion:le,iridescence:Ge,iridescenceMap:Qe,iridescenceThicknessMap:Xe,sheen:tt,sheenColorMap:ct,sheenRoughnessMap:Tt,specularMap:kt,specularColorMap:vt,specularIntensityMap:Tn,transmission:pt,transmissionMap:Ne,thicknessMap:Xt,gradientMap:Ht,opaque:L.transparent===!1&&L.blending===fl&&L.alphaToCoverage===!1,alphaMap:$t,alphaTest:zt,alphaHash:Ot,combine:L.combine,mapUv:at&&T(L.map.channel),aoMapUv:Me&&T(L.aoMap.channel),lightMapUv:ze&&T(L.lightMap.channel),bumpMapUv:Je&&T(L.bumpMap.channel),normalMapUv:rt&&T(L.normalMap.channel),displacementMapUv:ve&&T(L.displacementMap.channel),emissiveMapUv:Ue&&T(L.emissiveMap.channel),metalnessMapUv:it&&T(L.metalnessMap.channel),roughnessMapUv:wt&&T(L.roughnessMap.channel),anisotropyMapUv:Te&&T(L.anisotropyMap.channel),clearcoatMapUv:st&&T(L.clearcoatMap.channel),clearcoatNormalMapUv:mt&&T(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ht&&T(L.clearcoatRoughnessMap.channel),iridescenceMapUv:Qe&&T(L.iridescenceMap.channel),iridescenceThicknessMapUv:Xe&&T(L.iridescenceThicknessMap.channel),sheenColorMapUv:ct&&T(L.sheenColorMap.channel),sheenRoughnessMapUv:Tt&&T(L.sheenRoughnessMap.channel),specularMapUv:kt&&T(L.specularMap.channel),specularColorMapUv:vt&&T(L.specularColorMap.channel),specularIntensityMapUv:Tn&&T(L.specularIntensityMap.channel),transmissionMapUv:Ne&&T(L.transmissionMap.channel),thicknessMapUv:Xt&&T(L.thicknessMap.channel),alphaMapUv:$t&&T(L.alphaMap.channel),vertexTangents:!!ne.attributes.tangent&&(rt||Mt),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!ne.attributes.color&&ne.attributes.color.itemSize===4,pointsUvs:H.isPoints===!0&&!!ne.attributes.uv&&(at||$t),fog:!!X,useFog:L.fog===!0,fogExp2:!!X&&X.isFogExp2,flatShading:L.flatShading===!0&&L.wireframe===!1,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:m,reversedDepthBuffer:Le,skinning:H.isSkinnedMesh===!0,morphTargets:ne.morphAttributes.position!==void 0,morphNormals:ne.morphAttributes.normal!==void 0,morphColors:ne.morphAttributes.color!==void 0,morphTargetsCount:oe,morphTextureStride:Ae,numDirLights:U.directional.length,numPointLights:U.point.length,numSpotLights:U.spot.length,numSpotLightMaps:U.spotLightMap.length,numRectAreaLights:U.rectArea.length,numHemiLights:U.hemi.length,numDirLightShadows:U.directionalShadowMap.length,numPointLightShadows:U.pointShadowMap.length,numSpotLightShadows:U.spotShadowMap.length,numSpotLightShadowsWithMaps:U.numSpotLightShadowsWithMaps,numLightProbes:U.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:L.dithering,shadowMapEnabled:a.shadowMap.enabled&&q.length>0,shadowMapType:a.shadowMap.type,toneMapping:jn,decodeVideoTexture:at&&L.map.isVideoTexture===!0&&Vn.getTransfer(L.map.colorSpace)===An,decodeVideoTextureEmissive:Ue&&L.emissiveMap.isVideoTexture===!0&&Vn.getTransfer(L.emissiveMap.colorSpace)===An,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===er,flipSided:L.side===Di,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:an&&L.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(an&&L.extensions.multiDraw===!0||Ie)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return ai.vertexUv1s=u.has(1),ai.vertexUv2s=u.has(2),ai.vertexUv3s=u.has(3),u.clear(),ai}function M(L){const U=[];if(L.shaderID?U.push(L.shaderID):(U.push(L.customVertexShaderID),U.push(L.customFragmentShaderID)),L.defines!==void 0)for(const q in L.defines)U.push(q),U.push(L.defines[q]);return L.isRawShaderMaterial===!1&&(N(U,L),I(U,L),U.push(a.outputColorSpace)),U.push(L.customProgramCacheKey),U.join()}function N(L,U){L.push(U.precision),L.push(U.outputColorSpace),L.push(U.envMapMode),L.push(U.envMapCubeUVHeight),L.push(U.mapUv),L.push(U.alphaMapUv),L.push(U.lightMapUv),L.push(U.aoMapUv),L.push(U.bumpMapUv),L.push(U.normalMapUv),L.push(U.displacementMapUv),L.push(U.emissiveMapUv),L.push(U.metalnessMapUv),L.push(U.roughnessMapUv),L.push(U.anisotropyMapUv),L.push(U.clearcoatMapUv),L.push(U.clearcoatNormalMapUv),L.push(U.clearcoatRoughnessMapUv),L.push(U.iridescenceMapUv),L.push(U.iridescenceThicknessMapUv),L.push(U.sheenColorMapUv),L.push(U.sheenRoughnessMapUv),L.push(U.specularMapUv),L.push(U.specularColorMapUv),L.push(U.specularIntensityMapUv),L.push(U.transmissionMapUv),L.push(U.thicknessMapUv),L.push(U.combine),L.push(U.fogExp2),L.push(U.sizeAttenuation),L.push(U.morphTargetsCount),L.push(U.morphAttributeCount),L.push(U.numDirLights),L.push(U.numPointLights),L.push(U.numSpotLights),L.push(U.numSpotLightMaps),L.push(U.numHemiLights),L.push(U.numRectAreaLights),L.push(U.numDirLightShadows),L.push(U.numPointLightShadows),L.push(U.numSpotLightShadows),L.push(U.numSpotLightShadowsWithMaps),L.push(U.numLightProbes),L.push(U.shadowMapType),L.push(U.toneMapping),L.push(U.numClippingPlanes),L.push(U.numClipIntersection),L.push(U.depthPacking)}function I(L,U){l.disableAll(),U.instancing&&l.enable(0),U.instancingColor&&l.enable(1),U.instancingMorph&&l.enable(2),U.matcap&&l.enable(3),U.envMap&&l.enable(4),U.normalMapObjectSpace&&l.enable(5),U.normalMapTangentSpace&&l.enable(6),U.clearcoat&&l.enable(7),U.iridescence&&l.enable(8),U.alphaTest&&l.enable(9),U.vertexColors&&l.enable(10),U.vertexAlphas&&l.enable(11),U.vertexUv1s&&l.enable(12),U.vertexUv2s&&l.enable(13),U.vertexUv3s&&l.enable(14),U.vertexTangents&&l.enable(15),U.anisotropy&&l.enable(16),U.alphaHash&&l.enable(17),U.batching&&l.enable(18),U.dispersion&&l.enable(19),U.batchingColor&&l.enable(20),U.gradientMap&&l.enable(21),L.push(l.mask),l.disableAll(),U.fog&&l.enable(0),U.useFog&&l.enable(1),U.flatShading&&l.enable(2),U.logarithmicDepthBuffer&&l.enable(3),U.reversedDepthBuffer&&l.enable(4),U.skinning&&l.enable(5),U.morphTargets&&l.enable(6),U.morphNormals&&l.enable(7),U.morphColors&&l.enable(8),U.premultipliedAlpha&&l.enable(9),U.shadowMapEnabled&&l.enable(10),U.doubleSided&&l.enable(11),U.flipSided&&l.enable(12),U.useDepthPacking&&l.enable(13),U.dithering&&l.enable(14),U.transmission&&l.enable(15),U.sheen&&l.enable(16),U.opaque&&l.enable(17),U.pointsUvs&&l.enable(18),U.decodeVideoTexture&&l.enable(19),U.decodeVideoTextureEmissive&&l.enable(20),U.alphaToCoverage&&l.enable(21),L.push(l.mask)}function F(L){const U=x[L.type];let q;if(U){const K=El[U];q=XT.clone(K.uniforms)}else q=L.uniforms;return q}function G(L,U){let q=f.get(U);return q!==void 0?++q.usedTimes:(q=new _4e(a,U,L,r),h.push(q),f.set(U,q)),q}function O(L){if(--L.usedTimes===0){const U=h.indexOf(L);h[U]=h[h.length-1],h.pop(),f.delete(L.cacheKey),L.destroy()}}function D(L){c.remove(L)}function j(){c.dispose()}return{getParameters:E,getProgramCacheKey:M,getUniforms:F,acquireProgram:G,releaseProgram:O,releaseShaderCache:D,programs:h,dispose:j}}function w4e(){let a=new WeakMap;function e(o){return a.has(o)}function n(o){let l=a.get(o);return l===void 0&&(l={},a.set(o,l)),l}function i(o){a.delete(o)}function s(o,l,c){a.get(o)[l]=c}function r(){a=new WeakMap}return{has:e,get:n,remove:i,update:s,dispose:r}}function E4e(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.material.id!==e.material.id?a.material.id-e.material.id:a.z!==e.z?a.z-e.z:a.id-e.id}function uW(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.z!==e.z?e.z-a.z:a.id-e.id}function dW(){const a=[];let e=0;const n=[],i=[],s=[];function r(){e=0,n.length=0,i.length=0,s.length=0}function o(f,m,A,x,T,E){let M=a[e];return M===void 0?(M={id:f.id,object:f,geometry:m,material:A,groupOrder:x,renderOrder:f.renderOrder,z:T,group:E},a[e]=M):(M.id=f.id,M.object=f,M.geometry=m,M.material=A,M.groupOrder=x,M.renderOrder=f.renderOrder,M.z=T,M.group=E),e++,M}function l(f,m,A,x,T,E){const M=o(f,m,A,x,T,E);A.transmission>0?i.push(M):A.transparent===!0?s.push(M):n.push(M)}function c(f,m,A,x,T,E){const M=o(f,m,A,x,T,E);A.transmission>0?i.unshift(M):A.transparent===!0?s.unshift(M):n.unshift(M)}function u(f,m){n.length>1&&n.sort(f||E4e),i.length>1&&i.sort(m||uW),s.length>1&&s.sort(m||uW)}function h(){for(let f=e,m=a.length;f<m;f++){const A=a[f];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.group=null}}return{opaque:n,transmissive:i,transparent:s,init:r,push:l,unshift:c,finish:h,sort:u}}function M4e(){let a=new WeakMap;function e(i,s){const r=a.get(i);let o;return r===void 0?(o=new dW,a.set(i,[o])):s>=r.length?(o=new dW,r.push(o)):o=r[s],o}function n(){a=new WeakMap}return{get:e,dispose:n}}function C4e(){const a={};return{get:function(e){if(a[e.id]!==void 0)return a[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new ye,color:new on};break;case"SpotLight":n={position:new ye,direction:new ye,color:new on,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ye,color:new on,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ye,skyColor:new on,groundColor:new on};break;case"RectAreaLight":n={color:new on,position:new ye,halfWidth:new ye,halfHeight:new ye};break}return a[e.id]=n,n}}}function N4e(){const a={};return{get:function(e){if(a[e.id]!==void 0)return a[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Nt};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Nt};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Nt,shadowCameraNear:1,shadowCameraFar:1e3};break}return a[e.id]=n,n}}}let R4e=0;function P4e(a,e){return(e.castShadow?2:0)-(a.castShadow?2:0)+(e.map?1:0)-(a.map?1:0)}function I4e(a){const e=new C4e,n=N4e(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new ye);const s=new ye,r=new _n,o=new _n;function l(u){let h=0,f=0,m=0;for(let L=0;L<9;L++)i.probe[L].set(0,0,0);let A=0,x=0,T=0,E=0,M=0,N=0,I=0,F=0,G=0,O=0,D=0;u.sort(P4e);for(let L=0,U=u.length;L<U;L++){const q=u[L],K=q.color,H=q.intensity,X=q.distance;let ne=null;if(q.shadow&&q.shadow.map&&(q.shadow.map.texture.format===ol?ne=q.shadow.map.texture:ne=q.shadow.map.depthTexture||q.shadow.map.texture),q.isAmbientLight)h+=K.r*H,f+=K.g*H,m+=K.b*H;else if(q.isLightProbe){for(let Q=0;Q<9;Q++)i.probe[Q].addScaledVector(q.sh.coefficients[Q],H);D++}else if(q.isDirectionalLight){const Q=e.get(q);if(Q.color.copy(q.color).multiplyScalar(q.intensity),q.castShadow){const Y=q.shadow,ue=n.get(q);ue.shadowIntensity=Y.intensity,ue.shadowBias=Y.bias,ue.shadowNormalBias=Y.normalBias,ue.shadowRadius=Y.radius,ue.shadowMapSize=Y.mapSize,i.directionalShadow[A]=ue,i.directionalShadowMap[A]=ne,i.directionalShadowMatrix[A]=q.shadow.matrix,N++}i.directional[A]=Q,A++}else if(q.isSpotLight){const Q=e.get(q);Q.position.setFromMatrixPosition(q.matrixWorld),Q.color.copy(K).multiplyScalar(H),Q.distance=X,Q.coneCos=Math.cos(q.angle),Q.penumbraCos=Math.cos(q.angle*(1-q.penumbra)),Q.decay=q.decay,i.spot[T]=Q;const Y=q.shadow;if(q.map&&(i.spotLightMap[G]=q.map,G++,Y.updateMatrices(q),q.castShadow&&O++),i.spotLightMatrix[T]=Y.matrix,q.castShadow){const ue=n.get(q);ue.shadowIntensity=Y.intensity,ue.shadowBias=Y.bias,ue.shadowNormalBias=Y.normalBias,ue.shadowRadius=Y.radius,ue.shadowMapSize=Y.mapSize,i.spotShadow[T]=ue,i.spotShadowMap[T]=ne,F++}T++}else if(q.isRectAreaLight){const Q=e.get(q);Q.color.copy(K).multiplyScalar(H),Q.halfWidth.set(q.width*.5,0,0),Q.halfHeight.set(0,q.height*.5,0),i.rectArea[E]=Q,E++}else if(q.isPointLight){const Q=e.get(q);if(Q.color.copy(q.color).multiplyScalar(q.intensity),Q.distance=q.distance,Q.decay=q.decay,q.castShadow){const Y=q.shadow,ue=n.get(q);ue.shadowIntensity=Y.intensity,ue.shadowBias=Y.bias,ue.shadowNormalBias=Y.normalBias,ue.shadowRadius=Y.radius,ue.shadowMapSize=Y.mapSize,ue.shadowCameraNear=Y.camera.near,ue.shadowCameraFar=Y.camera.far,i.pointShadow[x]=ue,i.pointShadowMap[x]=ne,i.pointShadowMatrix[x]=q.shadow.matrix,I++}i.point[x]=Q,x++}else if(q.isHemisphereLight){const Q=e.get(q);Q.skyColor.copy(q.color).multiplyScalar(H),Q.groundColor.copy(q.groundColor).multiplyScalar(H),i.hemi[M]=Q,M++}}E>0&&(a.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=hn.LTC_FLOAT_1,i.rectAreaLTC2=hn.LTC_FLOAT_2):(i.rectAreaLTC1=hn.LTC_HALF_1,i.rectAreaLTC2=hn.LTC_HALF_2)),i.ambient[0]=h,i.ambient[1]=f,i.ambient[2]=m;const j=i.hash;(j.directionalLength!==A||j.pointLength!==x||j.spotLength!==T||j.rectAreaLength!==E||j.hemiLength!==M||j.numDirectionalShadows!==N||j.numPointShadows!==I||j.numSpotShadows!==F||j.numSpotMaps!==G||j.numLightProbes!==D)&&(i.directional.length=A,i.spot.length=T,i.rectArea.length=E,i.point.length=x,i.hemi.length=M,i.directionalShadow.length=N,i.directionalShadowMap.length=N,i.pointShadow.length=I,i.pointShadowMap.length=I,i.spotShadow.length=F,i.spotShadowMap.length=F,i.directionalShadowMatrix.length=N,i.pointShadowMatrix.length=I,i.spotLightMatrix.length=F+G-O,i.spotLightMap.length=G,i.numSpotLightShadowsWithMaps=O,i.numLightProbes=D,j.directionalLength=A,j.pointLength=x,j.spotLength=T,j.rectAreaLength=E,j.hemiLength=M,j.numDirectionalShadows=N,j.numPointShadows=I,j.numSpotShadows=F,j.numSpotMaps=G,j.numLightProbes=D,i.version=R4e++)}function c(u,h){let f=0,m=0,A=0,x=0,T=0;const E=h.matrixWorldInverse;for(let M=0,N=u.length;M<N;M++){const I=u[M];if(I.isDirectionalLight){const F=i.directional[f];F.direction.setFromMatrixPosition(I.matrixWorld),s.setFromMatrixPosition(I.target.matrixWorld),F.direction.sub(s),F.direction.transformDirection(E),f++}else if(I.isSpotLight){const F=i.spot[A];F.position.setFromMatrixPosition(I.matrixWorld),F.position.applyMatrix4(E),F.direction.setFromMatrixPosition(I.matrixWorld),s.setFromMatrixPosition(I.target.matrixWorld),F.direction.sub(s),F.direction.transformDirection(E),A++}else if(I.isRectAreaLight){const F=i.rectArea[x];F.position.setFromMatrixPosition(I.matrixWorld),F.position.applyMatrix4(E),o.identity(),r.copy(I.matrixWorld),r.premultiply(E),o.extractRotation(r),F.halfWidth.set(I.width*.5,0,0),F.halfHeight.set(0,I.height*.5,0),F.halfWidth.applyMatrix4(o),F.halfHeight.applyMatrix4(o),x++}else if(I.isPointLight){const F=i.point[m];F.position.setFromMatrixPosition(I.matrixWorld),F.position.applyMatrix4(E),m++}else if(I.isHemisphereLight){const F=i.hemi[T];F.direction.setFromMatrixPosition(I.matrixWorld),F.direction.transformDirection(E),T++}}}return{setup:l,setupView:c,state:i}}function hW(a){const e=new I4e(a),n=[],i=[];function s(h){u.camera=h,n.length=0,i.length=0}function r(h){n.push(h)}function o(h){i.push(h)}function l(){e.setup(n)}function c(h){e.setupView(n,h)}const u={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:u,setupLights:l,setupLightsView:c,pushLight:r,pushShadow:o}}function L4e(a){let e=new WeakMap;function n(s,r=0){const o=e.get(s);let l;return o===void 0?(l=new hW(a),e.set(s,[l])):r>=o.length?(l=new hW(a),o.push(l)):l=o[r],l}function i(){e=new WeakMap}return{get:n,dispose:i}}const D4e=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,k4e=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,O4e=[new ye(1,0,0),new ye(-1,0,0),new ye(0,1,0),new ye(0,-1,0),new ye(0,0,1),new ye(0,0,-1)],F4e=[new ye(0,-1,0),new ye(0,-1,0),new ye(0,0,1),new ye(0,0,-1),new ye(0,-1,0),new ye(0,-1,0)],fW=new _n,n2=new ye,o5=new ye;function j4e(a,e,n){let i=new C0;const s=new Nt,r=new Nt,o=new qn,l=new Tj,c=new wj,u={},h=n.maxTextureSize,f={[Ac]:Di,[Di]:Ac,[er]:er},m=new mo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Nt},radius:{value:4}},vertexShader:D4e,fragmentShader:k4e}),A=m.clone();A.defines.HORIZONTAL_PASS=1;const x=new zn;x.setAttribute("position",new Ua(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const T=new Na(x,m),E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=b_;let M=this.type;this.render=function(O,D,j){if(E.enabled===!1||E.autoUpdate===!1&&E.needsUpdate===!1||O.length===0)return;O.type===$Z&&(yt("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),O.type=b_);const L=a.getRenderTarget(),U=a.getActiveCubeFace(),q=a.getActiveMipmapLevel(),K=a.state;K.setBlending(hl),K.buffers.depth.getReversed()===!0?K.buffers.color.setClear(0,0,0,0):K.buffers.color.setClear(1,1,1,1),K.buffers.depth.setTest(!0),K.setScissorTest(!1);const H=M!==this.type;H&&D.traverse(function(X){X.material&&(Array.isArray(X.material)?X.material.forEach(ne=>ne.needsUpdate=!0):X.material.needsUpdate=!0)});for(let X=0,ne=O.length;X<ne;X++){const Q=O[X],Y=Q.shadow;if(Y===void 0){yt("WebGLShadowMap:",Q,"has no shadow.");continue}if(Y.autoUpdate===!1&&Y.needsUpdate===!1)continue;s.copy(Y.mapSize);const ue=Y.getFrameExtents();if(s.multiply(ue),r.copy(Y.mapSize),(s.x>h||s.y>h)&&(s.x>h&&(r.x=Math.floor(h/ue.x),s.x=r.x*ue.x,Y.mapSize.x=r.x),s.y>h&&(r.y=Math.floor(h/ue.y),s.y=r.y*ue.y,Y.mapSize.y=r.y)),Y.map===null||H===!0){if(Y.map!==null&&(Y.map.depthTexture!==null&&(Y.map.depthTexture.dispose(),Y.map.depthTexture=null),Y.map.dispose()),this.type===Hh){if(Q.isPointLight){yt("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}Y.map=new vc(s.x,s.y,{format:ol,type:cs,minFilter:di,magFilter:di,generateMipmaps:!1}),Y.map.texture.name=Q.name+".shadowMap",Y.map.depthTexture=new Do(s.x,s.y,ls),Y.map.depthTexture.name=Q.name+".shadowMapDepth",Y.map.depthTexture.format=ho,Y.map.depthTexture.compareFunction=null,Y.map.depthTexture.minFilter=Mi,Y.map.depthTexture.magFilter=Mi}else{Q.isPointLight?(Y.map=new QP(s.x),Y.map.depthTexture=new cj(s.x,Ei)):(Y.map=new vc(s.x,s.y),Y.map.depthTexture=new Do(s.x,s.y,Ei)),Y.map.depthTexture.name=Q.name+".shadowMap",Y.map.depthTexture.format=ho;const Ee=a.state.buffers.depth.getReversed();this.type===b_?(Y.map.depthTexture.compareFunction=Ee?Ux:Bx,Y.map.depthTexture.minFilter=di,Y.map.depthTexture.magFilter=di):(Y.map.depthTexture.compareFunction=null,Y.map.depthTexture.minFilter=Mi,Y.map.depthTexture.magFilter=Mi)}Y.camera.updateProjectionMatrix()}const pe=Y.map.isWebGLCubeRenderTarget?6:1;for(let Ee=0;Ee<pe;Ee++){if(Y.map.isWebGLCubeRenderTarget)a.setRenderTarget(Y.map,Ee),a.clear();else{Ee===0&&(a.setRenderTarget(Y.map),a.clear());const oe=Y.getViewport(Ee);o.set(r.x*oe.x,r.y*oe.y,r.x*oe.z,r.y*oe.w),K.viewport(o)}if(Q.isPointLight){const oe=Y.camera,Ae=Y.matrix,be=Q.distance||oe.far;be!==oe.far&&(oe.far=be,oe.updateProjectionMatrix()),n2.setFromMatrixPosition(Q.matrixWorld),oe.position.copy(n2),o5.copy(oe.position),o5.add(O4e[Ee]),oe.up.copy(F4e[Ee]),oe.lookAt(o5),oe.updateMatrixWorld(),Ae.makeTranslation(-n2.x,-n2.y,-n2.z),fW.multiplyMatrices(oe.projectionMatrix,oe.matrixWorldInverse),Y._frustum.setFromProjectionMatrix(fW,oe.coordinateSystem,oe.reversedDepth)}else Y.updateMatrices(Q);i=Y.getFrustum(),F(D,j,Y.camera,Q,this.type)}Y.isPointLightShadow!==!0&&this.type===Hh&&N(Y,j),Y.needsUpdate=!1}M=this.type,E.needsUpdate=!1,a.setRenderTarget(L,U,q)};function N(O,D){const j=e.update(T);m.defines.VSM_SAMPLES!==O.blurSamples&&(m.defines.VSM_SAMPLES=O.blurSamples,A.defines.VSM_SAMPLES=O.blurSamples,m.needsUpdate=!0,A.needsUpdate=!0),O.mapPass===null&&(O.mapPass=new vc(s.x,s.y,{format:ol,type:cs})),m.uniforms.shadow_pass.value=O.map.depthTexture,m.uniforms.resolution.value=O.mapSize,m.uniforms.radius.value=O.radius,a.setRenderTarget(O.mapPass),a.clear(),a.renderBufferDirect(D,null,j,m,T,null),A.uniforms.shadow_pass.value=O.mapPass.texture,A.uniforms.resolution.value=O.mapSize,A.uniforms.radius.value=O.radius,a.setRenderTarget(O.map),a.clear(),a.renderBufferDirect(D,null,j,A,T,null)}function I(O,D,j,L){let U=null;const q=j.isPointLight===!0?O.customDistanceMaterial:O.customDepthMaterial;if(q!==void 0)U=q;else if(U=j.isPointLight===!0?c:l,a.localClippingEnabled&&D.clipShadows===!0&&Array.isArray(D.clippingPlanes)&&D.clippingPlanes.length!==0||D.displacementMap&&D.displacementScale!==0||D.alphaMap&&D.alphaTest>0||D.map&&D.alphaTest>0||D.alphaToCoverage===!0){const K=U.uuid,H=D.uuid;let X=u[K];X===void 0&&(X={},u[K]=X);let ne=X[H];ne===void 0&&(ne=U.clone(),X[H]=ne,D.addEventListener("dispose",G)),U=ne}if(U.visible=D.visible,U.wireframe=D.wireframe,L===Hh?U.side=D.shadowSide!==null?D.shadowSide:D.side:U.side=D.shadowSide!==null?D.shadowSide:f[D.side],U.alphaMap=D.alphaMap,U.alphaTest=D.alphaToCoverage===!0?.5:D.alphaTest,U.map=D.map,U.clipShadows=D.clipShadows,U.clippingPlanes=D.clippingPlanes,U.clipIntersection=D.clipIntersection,U.displacementMap=D.displacementMap,U.displacementScale=D.displacementScale,U.displacementBias=D.displacementBias,U.wireframeLinewidth=D.wireframeLinewidth,U.linewidth=D.linewidth,j.isPointLight===!0&&U.isMeshDistanceMaterial===!0){const K=a.properties.get(U);K.light=j}return U}function F(O,D,j,L,U){if(O.visible===!1)return;if(O.layers.test(D.layers)&&(O.isMesh||O.isLine||O.isPoints)&&(O.castShadow||O.receiveShadow&&U===Hh)&&(!O.frustumCulled||i.intersectsObject(O))){O.modelViewMatrix.multiplyMatrices(j.matrixWorldInverse,O.matrixWorld);const H=e.update(O),X=O.material;if(Array.isArray(X)){const ne=H.groups;for(let Q=0,Y=ne.length;Q<Y;Q++){const ue=ne[Q],pe=X[ue.materialIndex];if(pe&&pe.visible){const Ee=I(O,pe,L,U);O.onBeforeShadow(a,O,D,j,H,Ee,ue),a.renderBufferDirect(j,null,H,Ee,O,ue),O.onAfterShadow(a,O,D,j,H,Ee,ue)}}}else if(X.visible){const ne=I(O,X,L,U);O.onBeforeShadow(a,O,D,j,H,ne,null),a.renderBufferDirect(j,null,H,ne,O,null),O.onAfterShadow(a,O,D,j,H,ne,null)}}const K=O.children;for(let H=0,X=K.length;H<X;H++)F(K[H],D,j,L,U)}function G(O){O.target.removeEventListener("dispose",G);for(const j in u){const L=u[j],U=O.target.uuid;U in L&&(L[U].dispose(),delete L[U])}}}const B4e={[W_]:$_,[K_]:Q_,[Y_]:J_,[gm]:X_,[$_]:W_,[Q_]:K_,[J_]:Y_,[X_]:gm};function U4e(a,e){function n(){let Ne=!1;const Xt=new qn;let Ht=null;const $t=new qn(0,0,0,0);return{setMask:function(zt){Ht!==zt&&!Ne&&(a.colorMask(zt,zt,zt,zt),Ht=zt)},setLocked:function(zt){Ne=zt},setClear:function(zt,Ot,an,jn,ai){ai===!0&&(zt*=jn,Ot*=jn,an*=jn),Xt.set(zt,Ot,an,jn),$t.equals(Xt)===!1&&(a.clearColor(zt,Ot,an,jn),$t.copy(Xt))},reset:function(){Ne=!1,Ht=null,$t.set(-1,0,0,0)}}}function i(){let Ne=!1,Xt=!1,Ht=null,$t=null,zt=null;return{setReversed:function(Ot){if(Xt!==Ot){const an=e.get("EXT_clip_control");Ot?an.clipControlEXT(an.LOWER_LEFT_EXT,an.ZERO_TO_ONE_EXT):an.clipControlEXT(an.LOWER_LEFT_EXT,an.NEGATIVE_ONE_TO_ONE_EXT),Xt=Ot;const jn=zt;zt=null,this.setClear(jn)}},getReversed:function(){return Xt},setTest:function(Ot){Ot?fe(a.DEPTH_TEST):Le(a.DEPTH_TEST)},setMask:function(Ot){Ht!==Ot&&!Ne&&(a.depthMask(Ot),Ht=Ot)},setFunc:function(Ot){if(Xt&&(Ot=B4e[Ot]),$t!==Ot){switch(Ot){case W_:a.depthFunc(a.NEVER);break;case $_:a.depthFunc(a.ALWAYS);break;case K_:a.depthFunc(a.LESS);break;case gm:a.depthFunc(a.LEQUAL);break;case Y_:a.depthFunc(a.EQUAL);break;case X_:a.depthFunc(a.GEQUAL);break;case Q_:a.depthFunc(a.GREATER);break;case J_:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}$t=Ot}},setLocked:function(Ot){Ne=Ot},setClear:function(Ot){zt!==Ot&&(Xt&&(Ot=1-Ot),a.clearDepth(Ot),zt=Ot)},reset:function(){Ne=!1,Ht=null,$t=null,zt=null,Xt=!1}}}function s(){let Ne=!1,Xt=null,Ht=null,$t=null,zt=null,Ot=null,an=null,jn=null,ai=null;return{setTest:function(Ta){Ne||(Ta?fe(a.STENCIL_TEST):Le(a.STENCIL_TEST))},setMask:function(Ta){Xt!==Ta&&!Ne&&(a.stencilMask(Ta),Xt=Ta)},setFunc:function(Ta,Gs,dr){(Ht!==Ta||$t!==Gs||zt!==dr)&&(a.stencilFunc(Ta,Gs,dr),Ht=Ta,$t=Gs,zt=dr)},setOp:function(Ta,Gs,dr){(Ot!==Ta||an!==Gs||jn!==dr)&&(a.stencilOp(Ta,Gs,dr),Ot=Ta,an=Gs,jn=dr)},setLocked:function(Ta){Ne=Ta},setClear:function(Ta){ai!==Ta&&(a.clearStencil(Ta),ai=Ta)},reset:function(){Ne=!1,Xt=null,Ht=null,$t=null,zt=null,Ot=null,an=null,jn=null,ai=null}}}const r=new n,o=new i,l=new s,c=new WeakMap,u=new WeakMap;let h={},f={},m=new WeakMap,A=[],x=null,T=!1,E=null,M=null,N=null,I=null,F=null,G=null,O=null,D=new on(0,0,0),j=0,L=!1,U=null,q=null,K=null,H=null,X=null;const ne=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Q=!1,Y=0;const ue=a.getParameter(a.VERSION);ue.indexOf("WebGL")!==-1?(Y=parseFloat(/^WebGL (\d)/.exec(ue)[1]),Q=Y>=1):ue.indexOf("OpenGL ES")!==-1&&(Y=parseFloat(/^OpenGL ES (\d)/.exec(ue)[1]),Q=Y>=2);let pe=null,Ee={};const oe=a.getParameter(a.SCISSOR_BOX),Ae=a.getParameter(a.VIEWPORT),be=new qn().fromArray(oe),Ce=new qn().fromArray(Ae);function ce(Ne,Xt,Ht,$t){const zt=new Uint8Array(4),Ot=a.createTexture();a.bindTexture(Ne,Ot),a.texParameteri(Ne,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(Ne,a.TEXTURE_MAG_FILTER,a.NEAREST);for(let an=0;an<Ht;an++)Ne===a.TEXTURE_3D||Ne===a.TEXTURE_2D_ARRAY?a.texImage3D(Xt,0,a.RGBA,1,1,$t,0,a.RGBA,a.UNSIGNED_BYTE,zt):a.texImage2D(Xt+an,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,zt);return Ot}const te={};te[a.TEXTURE_2D]=ce(a.TEXTURE_2D,a.TEXTURE_2D,1),te[a.TEXTURE_CUBE_MAP]=ce(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,6),te[a.TEXTURE_2D_ARRAY]=ce(a.TEXTURE_2D_ARRAY,a.TEXTURE_2D_ARRAY,1,1),te[a.TEXTURE_3D]=ce(a.TEXTURE_3D,a.TEXTURE_3D,1,1),r.setClear(0,0,0,1),o.setClear(1),l.setClear(0),fe(a.DEPTH_TEST),o.setFunc(gm),Je(!1),rt(TN),fe(a.CULL_FACE),Me(hl);function fe(Ne){h[Ne]!==!0&&(a.enable(Ne),h[Ne]=!0)}function Le(Ne){h[Ne]!==!1&&(a.disable(Ne),h[Ne]=!1)}function Fe(Ne,Xt){return f[Ne]!==Xt?(a.bindFramebuffer(Ne,Xt),f[Ne]=Xt,Ne===a.DRAW_FRAMEBUFFER&&(f[a.FRAMEBUFFER]=Xt),Ne===a.FRAMEBUFFER&&(f[a.DRAW_FRAMEBUFFER]=Xt),!0):!1}function Ie(Ne,Xt){let Ht=A,$t=!1;if(Ne){Ht=m.get(Xt),Ht===void 0&&(Ht=[],m.set(Xt,Ht));const zt=Ne.textures;if(Ht.length!==zt.length||Ht[0]!==a.COLOR_ATTACHMENT0){for(let Ot=0,an=zt.length;Ot<an;Ot++)Ht[Ot]=a.COLOR_ATTACHMENT0+Ot;Ht.length=zt.length,$t=!0}}else Ht[0]!==a.BACK&&(Ht[0]=a.BACK,$t=!0);$t&&a.drawBuffers(Ht)}function at(Ne){return x!==Ne?(a.useProgram(Ne),x=Ne,!0):!1}const je={[Co]:a.FUNC_ADD,[TP]:a.FUNC_SUBTRACT,[wP]:a.FUNC_REVERSE_SUBTRACT};je[KF]=a.MIN,je[YF]=a.MAX;const Ve={[Oh]:a.ZERO,[EP]:a.ONE,[MP]:a.SRC_COLOR,[q_]:a.SRC_ALPHA,[LP]:a.SRC_ALPHA_SATURATE,[PP]:a.DST_COLOR,[NP]:a.DST_ALPHA,[CP]:a.ONE_MINUS_SRC_COLOR,[H_]:a.ONE_MINUS_SRC_ALPHA,[IP]:a.ONE_MINUS_DST_COLOR,[RP]:a.ONE_MINUS_DST_ALPHA,[KZ]:a.CONSTANT_COLOR,[YZ]:a.ONE_MINUS_CONSTANT_COLOR,[XZ]:a.CONSTANT_ALPHA,[QZ]:a.ONE_MINUS_CONSTANT_ALPHA};function Me(Ne,Xt,Ht,$t,zt,Ot,an,jn,ai,Ta){if(Ne===hl){T===!0&&(Le(a.BLEND),T=!1);return}if(T===!1&&(fe(a.BLEND),T=!0),Ne!==QA){if(Ne!==E||Ta!==L){if((M!==Co||F!==Co)&&(a.blendEquation(a.FUNC_ADD),M=Co,F=Co),Ta)switch(Ne){case fl:a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case xy:a.blendFunc(a.ONE,a.ONE);break;case by:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case Sy:a.blendFuncSeparate(a.DST_COLOR,a.ONE_MINUS_SRC_ALPHA,a.ZERO,a.ONE);break;default:Rt("WebGLState: Invalid blending: ",Ne);break}else switch(Ne){case fl:a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case xy:a.blendFuncSeparate(a.SRC_ALPHA,a.ONE,a.ONE,a.ONE);break;case by:Rt("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Sy:Rt("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Rt("WebGLState: Invalid blending: ",Ne);break}N=null,I=null,G=null,O=null,D.set(0,0,0),j=0,E=Ne,L=Ta}return}zt=zt||Xt,Ot=Ot||Ht,an=an||$t,(Xt!==M||zt!==F)&&(a.blendEquationSeparate(je[Xt],je[zt]),M=Xt,F=zt),(Ht!==N||$t!==I||Ot!==G||an!==O)&&(a.blendFuncSeparate(Ve[Ht],Ve[$t],Ve[Ot],Ve[an]),N=Ht,I=$t,G=Ot,O=an),(jn.equals(D)===!1||ai!==j)&&(a.blendColor(jn.r,jn.g,jn.b,ai),D.copy(jn),j=ai),E=Ne,L=!1}function ze(Ne,Xt){Ne.side===er?Le(a.CULL_FACE):fe(a.CULL_FACE);let Ht=Ne.side===Di;Xt&&(Ht=!Ht),Je(Ht),Ne.blending===fl&&Ne.transparent===!1?Me(hl):Me(Ne.blending,Ne.blendEquation,Ne.blendSrc,Ne.blendDst,Ne.blendEquationAlpha,Ne.blendSrcAlpha,Ne.blendDstAlpha,Ne.blendColor,Ne.blendAlpha,Ne.premultipliedAlpha),o.setFunc(Ne.depthFunc),o.setTest(Ne.depthTest),o.setMask(Ne.depthWrite),r.setMask(Ne.colorWrite);const $t=Ne.stencilWrite;l.setTest($t),$t&&(l.setMask(Ne.stencilWriteMask),l.setFunc(Ne.stencilFunc,Ne.stencilRef,Ne.stencilFuncMask),l.setOp(Ne.stencilFail,Ne.stencilZFail,Ne.stencilZPass)),Ue(Ne.polygonOffset,Ne.polygonOffsetFactor,Ne.polygonOffsetUnits),Ne.alphaToCoverage===!0?fe(a.SAMPLE_ALPHA_TO_COVERAGE):Le(a.SAMPLE_ALPHA_TO_COVERAGE)}function Je(Ne){U!==Ne&&(Ne?a.frontFace(a.CW):a.frontFace(a.CCW),U=Ne)}function rt(Ne){Ne!==WF?(fe(a.CULL_FACE),Ne!==q&&(Ne===TN?a.cullFace(a.BACK):Ne===$F?a.cullFace(a.FRONT):a.cullFace(a.FRONT_AND_BACK))):Le(a.CULL_FACE),q=Ne}function ve(Ne){Ne!==K&&(Q&&a.lineWidth(Ne),K=Ne)}function Ue(Ne,Xt,Ht){Ne?(fe(a.POLYGON_OFFSET_FILL),(H!==Xt||X!==Ht)&&(a.polygonOffset(Xt,Ht),H=Xt,X=Ht)):Le(a.POLYGON_OFFSET_FILL)}function it(Ne){Ne?fe(a.SCISSOR_TEST):Le(a.SCISSOR_TEST)}function wt(Ne){Ne===void 0&&(Ne=a.TEXTURE0+ne-1),pe!==Ne&&(a.activeTexture(Ne),pe=Ne)}function Mt(Ne,Xt,Ht){Ht===void 0&&(pe===null?Ht=a.TEXTURE0+ne-1:Ht=pe);let $t=Ee[Ht];$t===void 0&&($t={type:void 0,texture:void 0},Ee[Ht]=$t),($t.type!==Ne||$t.texture!==Xt)&&(pe!==Ht&&(a.activeTexture(Ht),pe=Ht),a.bindTexture(Ne,Xt||te[Ne]),$t.type=Ne,$t.texture=Xt)}function _e(){const Ne=Ee[pe];Ne!==void 0&&Ne.type!==void 0&&(a.bindTexture(Ne.type,null),Ne.type=void 0,Ne.texture=void 0)}function le(){try{a.compressedTexImage2D(...arguments)}catch(Ne){Rt("WebGLState:",Ne)}}function Ge(){try{a.compressedTexImage3D(...arguments)}catch(Ne){Rt("WebGLState:",Ne)}}function tt(){try{a.texSubImage2D(...arguments)}catch(Ne){Rt("WebGLState:",Ne)}}function pt(){try{a.texSubImage3D(...arguments)}catch(Ne){Rt("WebGLState:",Ne)}}function Te(){try{a.compressedTexSubImage2D(...arguments)}catch(Ne){Rt("WebGLState:",Ne)}}function st(){try{a.compressedTexSubImage3D(...arguments)}catch(Ne){Rt("WebGLState:",Ne)}}function mt(){try{a.texStorage2D(...arguments)}catch(Ne){Rt("WebGLState:",Ne)}}function ht(){try{a.texStorage3D(...arguments)}catch(Ne){Rt("WebGLState:",Ne)}}function Qe(){try{a.texImage2D(...arguments)}catch(Ne){Rt("WebGLState:",Ne)}}function Xe(){try{a.texImage3D(...arguments)}catch(Ne){Rt("WebGLState:",Ne)}}function ct(Ne){be.equals(Ne)===!1&&(a.scissor(Ne.x,Ne.y,Ne.z,Ne.w),be.copy(Ne))}function Tt(Ne){Ce.equals(Ne)===!1&&(a.viewport(Ne.x,Ne.y,Ne.z,Ne.w),Ce.copy(Ne))}function kt(Ne,Xt){let Ht=u.get(Xt);Ht===void 0&&(Ht=new WeakMap,u.set(Xt,Ht));let $t=Ht.get(Ne);$t===void 0&&($t=a.getUniformBlockIndex(Xt,Ne.name),Ht.set(Ne,$t))}function vt(Ne,Xt){const $t=u.get(Xt).get(Ne);c.get(Xt)!==$t&&(a.uniformBlockBinding(Xt,$t,Ne.__bindingPointIndex),c.set(Xt,$t))}function Tn(){a.disable(a.BLEND),a.disable(a.CULL_FACE),a.disable(a.DEPTH_TEST),a.disable(a.POLYGON_OFFSET_FILL),a.disable(a.SCISSOR_TEST),a.disable(a.STENCIL_TEST),a.disable(a.SAMPLE_ALPHA_TO_COVERAGE),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ONE,a.ZERO),a.blendFuncSeparate(a.ONE,a.ZERO,a.ONE,a.ZERO),a.blendColor(0,0,0,0),a.colorMask(!0,!0,!0,!0),a.clearColor(0,0,0,0),a.depthMask(!0),a.depthFunc(a.LESS),o.setReversed(!1),a.clearDepth(1),a.stencilMask(4294967295),a.stencilFunc(a.ALWAYS,0,4294967295),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),a.clearStencil(0),a.cullFace(a.BACK),a.frontFace(a.CCW),a.polygonOffset(0,0),a.activeTexture(a.TEXTURE0),a.bindFramebuffer(a.FRAMEBUFFER,null),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),a.bindFramebuffer(a.READ_FRAMEBUFFER,null),a.useProgram(null),a.lineWidth(1),a.scissor(0,0,a.canvas.width,a.canvas.height),a.viewport(0,0,a.canvas.width,a.canvas.height),h={},pe=null,Ee={},f={},m=new WeakMap,A=[],x=null,T=!1,E=null,M=null,N=null,I=null,F=null,G=null,O=null,D=new on(0,0,0),j=0,L=!1,U=null,q=null,K=null,H=null,X=null,be.set(0,0,a.canvas.width,a.canvas.height),Ce.set(0,0,a.canvas.width,a.canvas.height),r.reset(),o.reset(),l.reset()}return{buffers:{color:r,depth:o,stencil:l},enable:fe,disable:Le,bindFramebuffer:Fe,drawBuffers:Ie,useProgram:at,setBlending:Me,setMaterial:ze,setFlipSided:Je,setCullFace:rt,setLineWidth:ve,setPolygonOffset:Ue,setScissorTest:it,activeTexture:wt,bindTexture:Mt,unbindTexture:_e,compressedTexImage2D:le,compressedTexImage3D:Ge,texImage2D:Qe,texImage3D:Xe,updateUBOMapping:kt,uniformBlockBinding:vt,texStorage2D:mt,texStorage3D:ht,texSubImage2D:tt,texSubImage3D:pt,compressedTexSubImage2D:Te,compressedTexSubImage3D:st,scissor:ct,viewport:Tt,reset:Tn}}function V4e(a,e,n,i,s,r,o){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new Nt,h=new WeakMap;let f;const m=new WeakMap;let A=!1;try{A=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(_e,le){return A?new OffscreenCanvas(_e,le):zS("canvas")}function T(_e,le,Ge){let tt=1;const pt=Mt(_e);if((pt.width>Ge||pt.height>Ge)&&(tt=Ge/Math.max(pt.width,pt.height)),tt<1)if(typeof HTMLImageElement<"u"&&_e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_e instanceof ImageBitmap||typeof VideoFrame<"u"&&_e instanceof VideoFrame){const Te=Math.floor(tt*pt.width),st=Math.floor(tt*pt.height);f===void 0&&(f=x(Te,st));const mt=le?x(Te,st):f;return mt.width=Te,mt.height=st,mt.getContext("2d").drawImage(_e,0,0,Te,st),yt("WebGLRenderer: Texture has been resized from ("+pt.width+"x"+pt.height+") to ("+Te+"x"+st+")."),mt}else return"data"in _e&&yt("WebGLRenderer: Image in DataTexture is too big ("+pt.width+"x"+pt.height+")."),_e;return _e}function E(_e){return _e.generateMipmaps}function M(_e){a.generateMipmap(_e)}function N(_e){return _e.isWebGLCubeRenderTarget?a.TEXTURE_CUBE_MAP:_e.isWebGL3DRenderTarget?a.TEXTURE_3D:_e.isWebGLArrayRenderTarget||_e.isCompressedArrayTexture?a.TEXTURE_2D_ARRAY:a.TEXTURE_2D}function I(_e,le,Ge,tt,pt=!1){if(_e!==null){if(a[_e]!==void 0)return a[_e];yt("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+_e+"'")}let Te=le;if(le===a.RED&&(Ge===a.FLOAT&&(Te=a.R32F),Ge===a.HALF_FLOAT&&(Te=a.R16F),Ge===a.UNSIGNED_BYTE&&(Te=a.R8)),le===a.RED_INTEGER&&(Ge===a.UNSIGNED_BYTE&&(Te=a.R8UI),Ge===a.UNSIGNED_SHORT&&(Te=a.R16UI),Ge===a.UNSIGNED_INT&&(Te=a.R32UI),Ge===a.BYTE&&(Te=a.R8I),Ge===a.SHORT&&(Te=a.R16I),Ge===a.INT&&(Te=a.R32I)),le===a.RG&&(Ge===a.FLOAT&&(Te=a.RG32F),Ge===a.HALF_FLOAT&&(Te=a.RG16F),Ge===a.UNSIGNED_BYTE&&(Te=a.RG8)),le===a.RG_INTEGER&&(Ge===a.UNSIGNED_BYTE&&(Te=a.RG8UI),Ge===a.UNSIGNED_SHORT&&(Te=a.RG16UI),Ge===a.UNSIGNED_INT&&(Te=a.RG32UI),Ge===a.BYTE&&(Te=a.RG8I),Ge===a.SHORT&&(Te=a.RG16I),Ge===a.INT&&(Te=a.RG32I)),le===a.RGB_INTEGER&&(Ge===a.UNSIGNED_BYTE&&(Te=a.RGB8UI),Ge===a.UNSIGNED_SHORT&&(Te=a.RGB16UI),Ge===a.UNSIGNED_INT&&(Te=a.RGB32UI),Ge===a.BYTE&&(Te=a.RGB8I),Ge===a.SHORT&&(Te=a.RGB16I),Ge===a.INT&&(Te=a.RGB32I)),le===a.RGBA_INTEGER&&(Ge===a.UNSIGNED_BYTE&&(Te=a.RGBA8UI),Ge===a.UNSIGNED_SHORT&&(Te=a.RGBA16UI),Ge===a.UNSIGNED_INT&&(Te=a.RGBA32UI),Ge===a.BYTE&&(Te=a.RGBA8I),Ge===a.SHORT&&(Te=a.RGBA16I),Ge===a.INT&&(Te=a.RGBA32I)),le===a.RGB&&(Ge===a.UNSIGNED_INT_5_9_9_9_REV&&(Te=a.RGB9_E5),Ge===a.UNSIGNED_INT_10F_11F_11F_REV&&(Te=a.R11F_G11F_B10F)),le===a.RGBA){const st=pt?Ky:Vn.getTransfer(tt);Ge===a.FLOAT&&(Te=a.RGBA32F),Ge===a.HALF_FLOAT&&(Te=a.RGBA16F),Ge===a.UNSIGNED_BYTE&&(Te=st===An?a.SRGB8_ALPHA8:a.RGBA8),Ge===a.UNSIGNED_SHORT_4_4_4_4&&(Te=a.RGBA4),Ge===a.UNSIGNED_SHORT_5_5_5_1&&(Te=a.RGB5_A1)}return(Te===a.R16F||Te===a.R32F||Te===a.RG16F||Te===a.RG32F||Te===a.RGBA16F||Te===a.RGBA32F)&&e.get("EXT_color_buffer_float"),Te}function F(_e,le){let Ge;return _e?le===null||le===Ei||le===yc?Ge=a.DEPTH24_STENCIL8:le===ls?Ge=a.DEPTH32F_STENCIL8:le===Bu&&(Ge=a.DEPTH24_STENCIL8,yt("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):le===null||le===Ei||le===yc?Ge=a.DEPTH_COMPONENT24:le===ls?Ge=a.DEPTH_COMPONENT32F:le===Bu&&(Ge=a.DEPTH_COMPONENT16),Ge}function G(_e,le){return E(_e)===!0||_e.isFramebufferTexture&&_e.minFilter!==Mi&&_e.minFilter!==di?Math.log2(Math.max(le.width,le.height))+1:_e.mipmaps!==void 0&&_e.mipmaps.length>0?_e.mipmaps.length:_e.isCompressedTexture&&Array.isArray(_e.image)?le.mipmaps.length:1}function O(_e){const le=_e.target;le.removeEventListener("dispose",O),j(le),le.isVideoTexture&&h.delete(le)}function D(_e){const le=_e.target;le.removeEventListener("dispose",D),U(le)}function j(_e){const le=i.get(_e);if(le.__webglInit===void 0)return;const Ge=_e.source,tt=m.get(Ge);if(tt){const pt=tt[le.__cacheKey];pt.usedTimes--,pt.usedTimes===0&&L(_e),Object.keys(tt).length===0&&m.delete(Ge)}i.remove(_e)}function L(_e){const le=i.get(_e);a.deleteTexture(le.__webglTexture);const Ge=_e.source,tt=m.get(Ge);delete tt[le.__cacheKey],o.memory.textures--}function U(_e){const le=i.get(_e);if(_e.depthTexture&&(_e.depthTexture.dispose(),i.remove(_e.depthTexture)),_e.isWebGLCubeRenderTarget)for(let tt=0;tt<6;tt++){if(Array.isArray(le.__webglFramebuffer[tt]))for(let pt=0;pt<le.__webglFramebuffer[tt].length;pt++)a.deleteFramebuffer(le.__webglFramebuffer[tt][pt]);else a.deleteFramebuffer(le.__webglFramebuffer[tt]);le.__webglDepthbuffer&&a.deleteRenderbuffer(le.__webglDepthbuffer[tt])}else{if(Array.isArray(le.__webglFramebuffer))for(let tt=0;tt<le.__webglFramebuffer.length;tt++)a.deleteFramebuffer(le.__webglFramebuffer[tt]);else a.deleteFramebuffer(le.__webglFramebuffer);if(le.__webglDepthbuffer&&a.deleteRenderbuffer(le.__webglDepthbuffer),le.__webglMultisampledFramebuffer&&a.deleteFramebuffer(le.__webglMultisampledFramebuffer),le.__webglColorRenderbuffer)for(let tt=0;tt<le.__webglColorRenderbuffer.length;tt++)le.__webglColorRenderbuffer[tt]&&a.deleteRenderbuffer(le.__webglColorRenderbuffer[tt]);le.__webglDepthRenderbuffer&&a.deleteRenderbuffer(le.__webglDepthRenderbuffer)}const Ge=_e.textures;for(let tt=0,pt=Ge.length;tt<pt;tt++){const Te=i.get(Ge[tt]);Te.__webglTexture&&(a.deleteTexture(Te.__webglTexture),o.memory.textures--),i.remove(Ge[tt])}i.remove(_e)}let q=0;function K(){q=0}function H(){const _e=q;return _e>=s.maxTextures&&yt("WebGLTextures: Trying to use "+_e+" texture units while this GPU supports only "+s.maxTextures),q+=1,_e}function X(_e){const le=[];return le.push(_e.wrapS),le.push(_e.wrapT),le.push(_e.wrapR||0),le.push(_e.magFilter),le.push(_e.minFilter),le.push(_e.anisotropy),le.push(_e.internalFormat),le.push(_e.format),le.push(_e.type),le.push(_e.generateMipmaps),le.push(_e.premultiplyAlpha),le.push(_e.flipY),le.push(_e.unpackAlignment),le.push(_e.colorSpace),le.join()}function ne(_e,le){const Ge=i.get(_e);if(_e.isVideoTexture&&it(_e),_e.isRenderTargetTexture===!1&&_e.isExternalTexture!==!0&&_e.version>0&&Ge.__version!==_e.version){const tt=_e.image;if(tt===null)yt("WebGLRenderer: Texture marked for update but no image data found.");else if(tt.complete===!1)yt("WebGLRenderer: Texture marked for update but image is incomplete");else{te(Ge,_e,le);return}}else _e.isExternalTexture&&(Ge.__webglTexture=_e.sourceTexture?_e.sourceTexture:null);n.bindTexture(a.TEXTURE_2D,Ge.__webglTexture,a.TEXTURE0+le)}function Q(_e,le){const Ge=i.get(_e);if(_e.isRenderTargetTexture===!1&&_e.version>0&&Ge.__version!==_e.version){te(Ge,_e,le);return}else _e.isExternalTexture&&(Ge.__webglTexture=_e.sourceTexture?_e.sourceTexture:null);n.bindTexture(a.TEXTURE_2D_ARRAY,Ge.__webglTexture,a.TEXTURE0+le)}function Y(_e,le){const Ge=i.get(_e);if(_e.isRenderTargetTexture===!1&&_e.version>0&&Ge.__version!==_e.version){te(Ge,_e,le);return}n.bindTexture(a.TEXTURE_3D,Ge.__webglTexture,a.TEXTURE0+le)}function ue(_e,le){const Ge=i.get(_e);if(_e.isCubeDepthTexture!==!0&&_e.version>0&&Ge.__version!==_e.version){fe(Ge,_e,le);return}n.bindTexture(a.TEXTURE_CUBE_MAP,Ge.__webglTexture,a.TEXTURE0+le)}const pe={[ym]:a.REPEAT,[Ur]:a.CLAMP_TO_EDGE,[vm]:a.MIRRORED_REPEAT},Ee={[Mi]:a.NEAREST,[qT]:a.NEAREST_MIPMAP_NEAREST,[Od]:a.NEAREST_MIPMAP_LINEAR,[di]:a.LINEAR,[Zg]:a.LINEAR_MIPMAP_NEAREST,[No]:a.LINEAR_MIPMAP_LINEAR},oe={[zP]:a.NEVER,[WP]:a.ALWAYS,[jx]:a.LESS,[Bx]:a.LEQUAL,[GP]:a.EQUAL,[Ux]:a.GEQUAL,[qP]:a.GREATER,[HP]:a.NOTEQUAL};function Ae(_e,le){if(le.type===ls&&e.has("OES_texture_float_linear")===!1&&(le.magFilter===di||le.magFilter===Zg||le.magFilter===Od||le.magFilter===No||le.minFilter===di||le.minFilter===Zg||le.minFilter===Od||le.minFilter===No)&&yt("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),a.texParameteri(_e,a.TEXTURE_WRAP_S,pe[le.wrapS]),a.texParameteri(_e,a.TEXTURE_WRAP_T,pe[le.wrapT]),(_e===a.TEXTURE_3D||_e===a.TEXTURE_2D_ARRAY)&&a.texParameteri(_e,a.TEXTURE_WRAP_R,pe[le.wrapR]),a.texParameteri(_e,a.TEXTURE_MAG_FILTER,Ee[le.magFilter]),a.texParameteri(_e,a.TEXTURE_MIN_FILTER,Ee[le.minFilter]),le.compareFunction&&(a.texParameteri(_e,a.TEXTURE_COMPARE_MODE,a.COMPARE_REF_TO_TEXTURE),a.texParameteri(_e,a.TEXTURE_COMPARE_FUNC,oe[le.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(le.magFilter===Mi||le.minFilter!==Od&&le.minFilter!==No||le.type===ls&&e.has("OES_texture_float_linear")===!1)return;if(le.anisotropy>1||i.get(le).__currentAnisotropy){const Ge=e.get("EXT_texture_filter_anisotropic");a.texParameterf(_e,Ge.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(le.anisotropy,s.getMaxAnisotropy())),i.get(le).__currentAnisotropy=le.anisotropy}}}function be(_e,le){let Ge=!1;_e.__webglInit===void 0&&(_e.__webglInit=!0,le.addEventListener("dispose",O));const tt=le.source;let pt=m.get(tt);pt===void 0&&(pt={},m.set(tt,pt));const Te=X(le);if(Te!==_e.__cacheKey){pt[Te]===void 0&&(pt[Te]={texture:a.createTexture(),usedTimes:0},o.memory.textures++,Ge=!0),pt[Te].usedTimes++;const st=pt[_e.__cacheKey];st!==void 0&&(pt[_e.__cacheKey].usedTimes--,st.usedTimes===0&&L(le)),_e.__cacheKey=Te,_e.__webglTexture=pt[Te].texture}return Ge}function Ce(_e,le,Ge){return Math.floor(Math.floor(_e/Ge)/le)}function ce(_e,le,Ge,tt){const Te=_e.updateRanges;if(Te.length===0)n.texSubImage2D(a.TEXTURE_2D,0,0,0,le.width,le.height,Ge,tt,le.data);else{Te.sort((Xe,ct)=>Xe.start-ct.start);let st=0;for(let Xe=1;Xe<Te.length;Xe++){const ct=Te[st],Tt=Te[Xe],kt=ct.start+ct.count,vt=Ce(Tt.start,le.width,4),Tn=Ce(ct.start,le.width,4);Tt.start<=kt+1&&vt===Tn&&Ce(Tt.start+Tt.count-1,le.width,4)===vt?ct.count=Math.max(ct.count,Tt.start+Tt.count-ct.start):(++st,Te[st]=Tt)}Te.length=st+1;const mt=a.getParameter(a.UNPACK_ROW_LENGTH),ht=a.getParameter(a.UNPACK_SKIP_PIXELS),Qe=a.getParameter(a.UNPACK_SKIP_ROWS);a.pixelStorei(a.UNPACK_ROW_LENGTH,le.width);for(let Xe=0,ct=Te.length;Xe<ct;Xe++){const Tt=Te[Xe],kt=Math.floor(Tt.start/4),vt=Math.ceil(Tt.count/4),Tn=kt%le.width,Ne=Math.floor(kt/le.width),Xt=vt,Ht=1;a.pixelStorei(a.UNPACK_SKIP_PIXELS,Tn),a.pixelStorei(a.UNPACK_SKIP_ROWS,Ne),n.texSubImage2D(a.TEXTURE_2D,0,Tn,Ne,Xt,Ht,Ge,tt,le.data)}_e.clearUpdateRanges(),a.pixelStorei(a.UNPACK_ROW_LENGTH,mt),a.pixelStorei(a.UNPACK_SKIP_PIXELS,ht),a.pixelStorei(a.UNPACK_SKIP_ROWS,Qe)}}function te(_e,le,Ge){let tt=a.TEXTURE_2D;(le.isDataArrayTexture||le.isCompressedArrayTexture)&&(tt=a.TEXTURE_2D_ARRAY),le.isData3DTexture&&(tt=a.TEXTURE_3D);const pt=be(_e,le),Te=le.source;n.bindTexture(tt,_e.__webglTexture,a.TEXTURE0+Ge);const st=i.get(Te);if(Te.version!==st.__version||pt===!0){n.activeTexture(a.TEXTURE0+Ge);const mt=Vn.getPrimaries(Vn.workingColorSpace),ht=le.colorSpace===Il?null:Vn.getPrimaries(le.colorSpace),Qe=le.colorSpace===Il||mt===ht?a.NONE:a.BROWSER_DEFAULT_WEBGL;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,le.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,le.unpackAlignment),a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,Qe);let Xe=T(le.image,!1,s.maxTextureSize);Xe=wt(le,Xe);const ct=r.convert(le.format,le.colorSpace),Tt=r.convert(le.type);let kt=I(le.internalFormat,ct,Tt,le.colorSpace,le.isVideoTexture);Ae(tt,le);let vt;const Tn=le.mipmaps,Ne=le.isVideoTexture!==!0,Xt=st.__version===void 0||pt===!0,Ht=Te.dataReady,$t=G(le,Xe);if(le.isDepthTexture)kt=F(le.format===rl,le.type),Xt&&(Ne?n.texStorage2D(a.TEXTURE_2D,1,kt,Xe.width,Xe.height):n.texImage2D(a.TEXTURE_2D,0,kt,Xe.width,Xe.height,0,ct,Tt,null));else if(le.isDataTexture)if(Tn.length>0){Ne&&Xt&&n.texStorage2D(a.TEXTURE_2D,$t,kt,Tn[0].width,Tn[0].height);for(let zt=0,Ot=Tn.length;zt<Ot;zt++)vt=Tn[zt],Ne?Ht&&n.texSubImage2D(a.TEXTURE_2D,zt,0,0,vt.width,vt.height,ct,Tt,vt.data):n.texImage2D(a.TEXTURE_2D,zt,kt,vt.width,vt.height,0,ct,Tt,vt.data);le.generateMipmaps=!1}else Ne?(Xt&&n.texStorage2D(a.TEXTURE_2D,$t,kt,Xe.width,Xe.height),Ht&&ce(le,Xe,ct,Tt)):n.texImage2D(a.TEXTURE_2D,0,kt,Xe.width,Xe.height,0,ct,Tt,Xe.data);else if(le.isCompressedTexture)if(le.isCompressedArrayTexture){Ne&&Xt&&n.texStorage3D(a.TEXTURE_2D_ARRAY,$t,kt,Tn[0].width,Tn[0].height,Xe.depth);for(let zt=0,Ot=Tn.length;zt<Ot;zt++)if(vt=Tn[zt],le.format!==fs)if(ct!==null)if(Ne){if(Ht)if(le.layerUpdates.size>0){const an=LN(vt.width,vt.height,le.format,le.type);for(const jn of le.layerUpdates){const ai=vt.data.subarray(jn*an/vt.data.BYTES_PER_ELEMENT,(jn+1)*an/vt.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,zt,0,0,jn,vt.width,vt.height,1,ct,ai)}le.clearLayerUpdates()}else n.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,zt,0,0,0,vt.width,vt.height,Xe.depth,ct,vt.data)}else n.compressedTexImage3D(a.TEXTURE_2D_ARRAY,zt,kt,vt.width,vt.height,Xe.depth,0,vt.data,0,0);else yt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Ne?Ht&&n.texSubImage3D(a.TEXTURE_2D_ARRAY,zt,0,0,0,vt.width,vt.height,Xe.depth,ct,Tt,vt.data):n.texImage3D(a.TEXTURE_2D_ARRAY,zt,kt,vt.width,vt.height,Xe.depth,0,ct,Tt,vt.data)}else{Ne&&Xt&&n.texStorage2D(a.TEXTURE_2D,$t,kt,Tn[0].width,Tn[0].height);for(let zt=0,Ot=Tn.length;zt<Ot;zt++)vt=Tn[zt],le.format!==fs?ct!==null?Ne?Ht&&n.compressedTexSubImage2D(a.TEXTURE_2D,zt,0,0,vt.width,vt.height,ct,vt.data):n.compressedTexImage2D(a.TEXTURE_2D,zt,kt,vt.width,vt.height,0,vt.data):yt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ne?Ht&&n.texSubImage2D(a.TEXTURE_2D,zt,0,0,vt.width,vt.height,ct,Tt,vt.data):n.texImage2D(a.TEXTURE_2D,zt,kt,vt.width,vt.height,0,ct,Tt,vt.data)}else if(le.isDataArrayTexture)if(Ne){if(Xt&&n.texStorage3D(a.TEXTURE_2D_ARRAY,$t,kt,Xe.width,Xe.height,Xe.depth),Ht)if(le.layerUpdates.size>0){const zt=LN(Xe.width,Xe.height,le.format,le.type);for(const Ot of le.layerUpdates){const an=Xe.data.subarray(Ot*zt/Xe.data.BYTES_PER_ELEMENT,(Ot+1)*zt/Xe.data.BYTES_PER_ELEMENT);n.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,Ot,Xe.width,Xe.height,1,ct,Tt,an)}le.clearLayerUpdates()}else n.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,0,Xe.width,Xe.height,Xe.depth,ct,Tt,Xe.data)}else n.texImage3D(a.TEXTURE_2D_ARRAY,0,kt,Xe.width,Xe.height,Xe.depth,0,ct,Tt,Xe.data);else if(le.isData3DTexture)Ne?(Xt&&n.texStorage3D(a.TEXTURE_3D,$t,kt,Xe.width,Xe.height,Xe.depth),Ht&&n.texSubImage3D(a.TEXTURE_3D,0,0,0,0,Xe.width,Xe.height,Xe.depth,ct,Tt,Xe.data)):n.texImage3D(a.TEXTURE_3D,0,kt,Xe.width,Xe.height,Xe.depth,0,ct,Tt,Xe.data);else if(le.isFramebufferTexture){if(Xt)if(Ne)n.texStorage2D(a.TEXTURE_2D,$t,kt,Xe.width,Xe.height);else{let zt=Xe.width,Ot=Xe.height;for(let an=0;an<$t;an++)n.texImage2D(a.TEXTURE_2D,an,kt,zt,Ot,0,ct,Tt,null),zt>>=1,Ot>>=1}}else if(Tn.length>0){if(Ne&&Xt){const zt=Mt(Tn[0]);n.texStorage2D(a.TEXTURE_2D,$t,kt,zt.width,zt.height)}for(let zt=0,Ot=Tn.length;zt<Ot;zt++)vt=Tn[zt],Ne?Ht&&n.texSubImage2D(a.TEXTURE_2D,zt,0,0,ct,Tt,vt):n.texImage2D(a.TEXTURE_2D,zt,kt,ct,Tt,vt);le.generateMipmaps=!1}else if(Ne){if(Xt){const zt=Mt(Xe);n.texStorage2D(a.TEXTURE_2D,$t,kt,zt.width,zt.height)}Ht&&n.texSubImage2D(a.TEXTURE_2D,0,0,0,ct,Tt,Xe)}else n.texImage2D(a.TEXTURE_2D,0,kt,ct,Tt,Xe);E(le)&&M(tt),st.__version=Te.version,le.onUpdate&&le.onUpdate(le)}_e.__version=le.version}function fe(_e,le,Ge){if(le.image.length!==6)return;const tt=be(_e,le),pt=le.source;n.bindTexture(a.TEXTURE_CUBE_MAP,_e.__webglTexture,a.TEXTURE0+Ge);const Te=i.get(pt);if(pt.version!==Te.__version||tt===!0){n.activeTexture(a.TEXTURE0+Ge);const st=Vn.getPrimaries(Vn.workingColorSpace),mt=le.colorSpace===Il?null:Vn.getPrimaries(le.colorSpace),ht=le.colorSpace===Il||st===mt?a.NONE:a.BROWSER_DEFAULT_WEBGL;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,le.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,le.unpackAlignment),a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,ht);const Qe=le.isCompressedTexture||le.image[0].isCompressedTexture,Xe=le.image[0]&&le.image[0].isDataTexture,ct=[];for(let Ot=0;Ot<6;Ot++)!Qe&&!Xe?ct[Ot]=T(le.image[Ot],!0,s.maxCubemapSize):ct[Ot]=Xe?le.image[Ot].image:le.image[Ot],ct[Ot]=wt(le,ct[Ot]);const Tt=ct[0],kt=r.convert(le.format,le.colorSpace),vt=r.convert(le.type),Tn=I(le.internalFormat,kt,vt,le.colorSpace),Ne=le.isVideoTexture!==!0,Xt=Te.__version===void 0||tt===!0,Ht=pt.dataReady;let $t=G(le,Tt);Ae(a.TEXTURE_CUBE_MAP,le);let zt;if(Qe){Ne&&Xt&&n.texStorage2D(a.TEXTURE_CUBE_MAP,$t,Tn,Tt.width,Tt.height);for(let Ot=0;Ot<6;Ot++){zt=ct[Ot].mipmaps;for(let an=0;an<zt.length;an++){const jn=zt[an];le.format!==fs?kt!==null?Ne?Ht&&n.compressedTexSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,an,0,0,jn.width,jn.height,kt,jn.data):n.compressedTexImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,an,Tn,jn.width,jn.height,0,jn.data):yt("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ne?Ht&&n.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,an,0,0,jn.width,jn.height,kt,vt,jn.data):n.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,an,Tn,jn.width,jn.height,0,kt,vt,jn.data)}}}else{if(zt=le.mipmaps,Ne&&Xt){zt.length>0&&$t++;const Ot=Mt(ct[0]);n.texStorage2D(a.TEXTURE_CUBE_MAP,$t,Tn,Ot.width,Ot.height)}for(let Ot=0;Ot<6;Ot++)if(Xe){Ne?Ht&&n.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,0,0,0,ct[Ot].width,ct[Ot].height,kt,vt,ct[Ot].data):n.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,0,Tn,ct[Ot].width,ct[Ot].height,0,kt,vt,ct[Ot].data);for(let an=0;an<zt.length;an++){const ai=zt[an].image[Ot].image;Ne?Ht&&n.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,an+1,0,0,ai.width,ai.height,kt,vt,ai.data):n.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,an+1,Tn,ai.width,ai.height,0,kt,vt,ai.data)}}else{Ne?Ht&&n.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,0,0,0,kt,vt,ct[Ot]):n.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,0,Tn,kt,vt,ct[Ot]);for(let an=0;an<zt.length;an++){const jn=zt[an];Ne?Ht&&n.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,an+1,0,0,kt,vt,jn.image[Ot]):n.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,an+1,Tn,kt,vt,jn.image[Ot])}}}E(le)&&M(a.TEXTURE_CUBE_MAP),Te.__version=pt.version,le.onUpdate&&le.onUpdate(le)}_e.__version=le.version}function Le(_e,le,Ge,tt,pt,Te){const st=r.convert(Ge.format,Ge.colorSpace),mt=r.convert(Ge.type),ht=I(Ge.internalFormat,st,mt,Ge.colorSpace),Qe=i.get(le),Xe=i.get(Ge);if(Xe.__renderTarget=le,!Qe.__hasExternalTextures){const ct=Math.max(1,le.width>>Te),Tt=Math.max(1,le.height>>Te);pt===a.TEXTURE_3D||pt===a.TEXTURE_2D_ARRAY?n.texImage3D(pt,Te,ht,ct,Tt,le.depth,0,st,mt,null):n.texImage2D(pt,Te,ht,ct,Tt,0,st,mt,null)}n.bindFramebuffer(a.FRAMEBUFFER,_e),Ue(le)?l.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,tt,pt,Xe.__webglTexture,0,ve(le)):(pt===a.TEXTURE_2D||pt>=a.TEXTURE_CUBE_MAP_POSITIVE_X&&pt<=a.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&a.framebufferTexture2D(a.FRAMEBUFFER,tt,pt,Xe.__webglTexture,Te),n.bindFramebuffer(a.FRAMEBUFFER,null)}function Fe(_e,le,Ge){if(a.bindRenderbuffer(a.RENDERBUFFER,_e),le.depthBuffer){const tt=le.depthTexture,pt=tt&&tt.isDepthTexture?tt.type:null,Te=F(le.stencilBuffer,pt),st=le.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT;Ue(le)?l.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,ve(le),Te,le.width,le.height):Ge?a.renderbufferStorageMultisample(a.RENDERBUFFER,ve(le),Te,le.width,le.height):a.renderbufferStorage(a.RENDERBUFFER,Te,le.width,le.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,st,a.RENDERBUFFER,_e)}else{const tt=le.textures;for(let pt=0;pt<tt.length;pt++){const Te=tt[pt],st=r.convert(Te.format,Te.colorSpace),mt=r.convert(Te.type),ht=I(Te.internalFormat,st,mt,Te.colorSpace);Ue(le)?l.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,ve(le),ht,le.width,le.height):Ge?a.renderbufferStorageMultisample(a.RENDERBUFFER,ve(le),ht,le.width,le.height):a.renderbufferStorage(a.RENDERBUFFER,ht,le.width,le.height)}}a.bindRenderbuffer(a.RENDERBUFFER,null)}function Ie(_e,le,Ge){const tt=le.isWebGLCubeRenderTarget===!0;if(n.bindFramebuffer(a.FRAMEBUFFER,_e),!(le.depthTexture&&le.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const pt=i.get(le.depthTexture);if(pt.__renderTarget=le,(!pt.__webglTexture||le.depthTexture.image.width!==le.width||le.depthTexture.image.height!==le.height)&&(le.depthTexture.image.width=le.width,le.depthTexture.image.height=le.height,le.depthTexture.needsUpdate=!0),tt){if(pt.__webglInit===void 0&&(pt.__webglInit=!0,le.depthTexture.addEventListener("dispose",O)),pt.__webglTexture===void 0){pt.__webglTexture=a.createTexture(),n.bindTexture(a.TEXTURE_CUBE_MAP,pt.__webglTexture),Ae(a.TEXTURE_CUBE_MAP,le.depthTexture);const Qe=r.convert(le.depthTexture.format),Xe=r.convert(le.depthTexture.type);let ct;le.depthTexture.format===ho?ct=a.DEPTH_COMPONENT24:le.depthTexture.format===rl&&(ct=a.DEPTH24_STENCIL8);for(let Tt=0;Tt<6;Tt++)a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Tt,0,ct,le.width,le.height,0,Qe,Xe,null)}}else ne(le.depthTexture,0);const Te=pt.__webglTexture,st=ve(le),mt=tt?a.TEXTURE_CUBE_MAP_POSITIVE_X+Ge:a.TEXTURE_2D,ht=le.depthTexture.format===rl?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT;if(le.depthTexture.format===ho)Ue(le)?l.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,ht,mt,Te,0,st):a.framebufferTexture2D(a.FRAMEBUFFER,ht,mt,Te,0);else if(le.depthTexture.format===rl)Ue(le)?l.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,ht,mt,Te,0,st):a.framebufferTexture2D(a.FRAMEBUFFER,ht,mt,Te,0);else throw new Error("Unknown depthTexture format")}function at(_e){const le=i.get(_e),Ge=_e.isWebGLCubeRenderTarget===!0;if(le.__boundDepthTexture!==_e.depthTexture){const tt=_e.depthTexture;if(le.__depthDisposeCallback&&le.__depthDisposeCallback(),tt){const pt=()=>{delete le.__boundDepthTexture,delete le.__depthDisposeCallback,tt.removeEventListener("dispose",pt)};tt.addEventListener("dispose",pt),le.__depthDisposeCallback=pt}le.__boundDepthTexture=tt}if(_e.depthTexture&&!le.__autoAllocateDepthBuffer)if(Ge)for(let tt=0;tt<6;tt++)Ie(le.__webglFramebuffer[tt],_e,tt);else{const tt=_e.texture.mipmaps;tt&&tt.length>0?Ie(le.__webglFramebuffer[0],_e,0):Ie(le.__webglFramebuffer,_e,0)}else if(Ge){le.__webglDepthbuffer=[];for(let tt=0;tt<6;tt++)if(n.bindFramebuffer(a.FRAMEBUFFER,le.__webglFramebuffer[tt]),le.__webglDepthbuffer[tt]===void 0)le.__webglDepthbuffer[tt]=a.createRenderbuffer(),Fe(le.__webglDepthbuffer[tt],_e,!1);else{const pt=_e.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,Te=le.__webglDepthbuffer[tt];a.bindRenderbuffer(a.RENDERBUFFER,Te),a.framebufferRenderbuffer(a.FRAMEBUFFER,pt,a.RENDERBUFFER,Te)}}else{const tt=_e.texture.mipmaps;if(tt&&tt.length>0?n.bindFramebuffer(a.FRAMEBUFFER,le.__webglFramebuffer[0]):n.bindFramebuffer(a.FRAMEBUFFER,le.__webglFramebuffer),le.__webglDepthbuffer===void 0)le.__webglDepthbuffer=a.createRenderbuffer(),Fe(le.__webglDepthbuffer,_e,!1);else{const pt=_e.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,Te=le.__webglDepthbuffer;a.bindRenderbuffer(a.RENDERBUFFER,Te),a.framebufferRenderbuffer(a.FRAMEBUFFER,pt,a.RENDERBUFFER,Te)}}n.bindFramebuffer(a.FRAMEBUFFER,null)}function je(_e,le,Ge){const tt=i.get(_e);le!==void 0&&Le(tt.__webglFramebuffer,_e,_e.texture,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,0),Ge!==void 0&&at(_e)}function Ve(_e){const le=_e.texture,Ge=i.get(_e),tt=i.get(le);_e.addEventListener("dispose",D);const pt=_e.textures,Te=_e.isWebGLCubeRenderTarget===!0,st=pt.length>1;if(st||(tt.__webglTexture===void 0&&(tt.__webglTexture=a.createTexture()),tt.__version=le.version,o.memory.textures++),Te){Ge.__webglFramebuffer=[];for(let mt=0;mt<6;mt++)if(le.mipmaps&&le.mipmaps.length>0){Ge.__webglFramebuffer[mt]=[];for(let ht=0;ht<le.mipmaps.length;ht++)Ge.__webglFramebuffer[mt][ht]=a.createFramebuffer()}else Ge.__webglFramebuffer[mt]=a.createFramebuffer()}else{if(le.mipmaps&&le.mipmaps.length>0){Ge.__webglFramebuffer=[];for(let mt=0;mt<le.mipmaps.length;mt++)Ge.__webglFramebuffer[mt]=a.createFramebuffer()}else Ge.__webglFramebuffer=a.createFramebuffer();if(st)for(let mt=0,ht=pt.length;mt<ht;mt++){const Qe=i.get(pt[mt]);Qe.__webglTexture===void 0&&(Qe.__webglTexture=a.createTexture(),o.memory.textures++)}if(_e.samples>0&&Ue(_e)===!1){Ge.__webglMultisampledFramebuffer=a.createFramebuffer(),Ge.__webglColorRenderbuffer=[],n.bindFramebuffer(a.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer);for(let mt=0;mt<pt.length;mt++){const ht=pt[mt];Ge.__webglColorRenderbuffer[mt]=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,Ge.__webglColorRenderbuffer[mt]);const Qe=r.convert(ht.format,ht.colorSpace),Xe=r.convert(ht.type),ct=I(ht.internalFormat,Qe,Xe,ht.colorSpace,_e.isXRRenderTarget===!0),Tt=ve(_e);a.renderbufferStorageMultisample(a.RENDERBUFFER,Tt,ct,_e.width,_e.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+mt,a.RENDERBUFFER,Ge.__webglColorRenderbuffer[mt])}a.bindRenderbuffer(a.RENDERBUFFER,null),_e.depthBuffer&&(Ge.__webglDepthRenderbuffer=a.createRenderbuffer(),Fe(Ge.__webglDepthRenderbuffer,_e,!0)),n.bindFramebuffer(a.FRAMEBUFFER,null)}}if(Te){n.bindTexture(a.TEXTURE_CUBE_MAP,tt.__webglTexture),Ae(a.TEXTURE_CUBE_MAP,le);for(let mt=0;mt<6;mt++)if(le.mipmaps&&le.mipmaps.length>0)for(let ht=0;ht<le.mipmaps.length;ht++)Le(Ge.__webglFramebuffer[mt][ht],_e,le,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+mt,ht);else Le(Ge.__webglFramebuffer[mt],_e,le,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+mt,0);E(le)&&M(a.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(st){for(let mt=0,ht=pt.length;mt<ht;mt++){const Qe=pt[mt],Xe=i.get(Qe);let ct=a.TEXTURE_2D;(_e.isWebGL3DRenderTarget||_e.isWebGLArrayRenderTarget)&&(ct=_e.isWebGL3DRenderTarget?a.TEXTURE_3D:a.TEXTURE_2D_ARRAY),n.bindTexture(ct,Xe.__webglTexture),Ae(ct,Qe),Le(Ge.__webglFramebuffer,_e,Qe,a.COLOR_ATTACHMENT0+mt,ct,0),E(Qe)&&M(ct)}n.unbindTexture()}else{let mt=a.TEXTURE_2D;if((_e.isWebGL3DRenderTarget||_e.isWebGLArrayRenderTarget)&&(mt=_e.isWebGL3DRenderTarget?a.TEXTURE_3D:a.TEXTURE_2D_ARRAY),n.bindTexture(mt,tt.__webglTexture),Ae(mt,le),le.mipmaps&&le.mipmaps.length>0)for(let ht=0;ht<le.mipmaps.length;ht++)Le(Ge.__webglFramebuffer[ht],_e,le,a.COLOR_ATTACHMENT0,mt,ht);else Le(Ge.__webglFramebuffer,_e,le,a.COLOR_ATTACHMENT0,mt,0);E(le)&&M(mt),n.unbindTexture()}_e.depthBuffer&&at(_e)}function Me(_e){const le=_e.textures;for(let Ge=0,tt=le.length;Ge<tt;Ge++){const pt=le[Ge];if(E(pt)){const Te=N(_e),st=i.get(pt).__webglTexture;n.bindTexture(Te,st),M(Te),n.unbindTexture()}}}const ze=[],Je=[];function rt(_e){if(_e.samples>0){if(Ue(_e)===!1){const le=_e.textures,Ge=_e.width,tt=_e.height;let pt=a.COLOR_BUFFER_BIT;const Te=_e.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,st=i.get(_e),mt=le.length>1;if(mt)for(let Qe=0;Qe<le.length;Qe++)n.bindFramebuffer(a.FRAMEBUFFER,st.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+Qe,a.RENDERBUFFER,null),n.bindFramebuffer(a.FRAMEBUFFER,st.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+Qe,a.TEXTURE_2D,null,0);n.bindFramebuffer(a.READ_FRAMEBUFFER,st.__webglMultisampledFramebuffer);const ht=_e.texture.mipmaps;ht&&ht.length>0?n.bindFramebuffer(a.DRAW_FRAMEBUFFER,st.__webglFramebuffer[0]):n.bindFramebuffer(a.DRAW_FRAMEBUFFER,st.__webglFramebuffer);for(let Qe=0;Qe<le.length;Qe++){if(_e.resolveDepthBuffer&&(_e.depthBuffer&&(pt|=a.DEPTH_BUFFER_BIT),_e.stencilBuffer&&_e.resolveStencilBuffer&&(pt|=a.STENCIL_BUFFER_BIT)),mt){a.framebufferRenderbuffer(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,st.__webglColorRenderbuffer[Qe]);const Xe=i.get(le[Qe]).__webglTexture;a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,Xe,0)}a.blitFramebuffer(0,0,Ge,tt,0,0,Ge,tt,pt,a.NEAREST),c===!0&&(ze.length=0,Je.length=0,ze.push(a.COLOR_ATTACHMENT0+Qe),_e.depthBuffer&&_e.resolveDepthBuffer===!1&&(ze.push(Te),Je.push(Te),a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,Je)),a.invalidateFramebuffer(a.READ_FRAMEBUFFER,ze))}if(n.bindFramebuffer(a.READ_FRAMEBUFFER,null),n.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),mt)for(let Qe=0;Qe<le.length;Qe++){n.bindFramebuffer(a.FRAMEBUFFER,st.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+Qe,a.RENDERBUFFER,st.__webglColorRenderbuffer[Qe]);const Xe=i.get(le[Qe]).__webglTexture;n.bindFramebuffer(a.FRAMEBUFFER,st.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+Qe,a.TEXTURE_2D,Xe,0)}n.bindFramebuffer(a.DRAW_FRAMEBUFFER,st.__webglMultisampledFramebuffer)}else if(_e.depthBuffer&&_e.resolveDepthBuffer===!1&&c){const le=_e.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT;a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,[le])}}}function ve(_e){return Math.min(s.maxSamples,_e.samples)}function Ue(_e){const le=i.get(_e);return _e.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&le.__useRenderToTexture!==!1}function it(_e){const le=o.render.frame;h.get(_e)!==le&&(h.set(_e,le),_e.update())}function wt(_e,le){const Ge=_e.colorSpace,tt=_e.format,pt=_e.type;return _e.isCompressedTexture===!0||_e.isVideoTexture===!0||Ge!==_m&&Ge!==Il&&(Vn.getTransfer(Ge)===An?(tt!==fs||pt!==os)&&yt("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Rt("WebGLTextures: Unsupported texture color space:",Ge)),le}function Mt(_e){return typeof HTMLImageElement<"u"&&_e instanceof HTMLImageElement?(u.width=_e.naturalWidth||_e.width,u.height=_e.naturalHeight||_e.height):typeof VideoFrame<"u"&&_e instanceof VideoFrame?(u.width=_e.displayWidth,u.height=_e.displayHeight):(u.width=_e.width,u.height=_e.height),u}this.allocateTextureUnit=H,this.resetTextureUnits=K,this.setTexture2D=ne,this.setTexture2DArray=Q,this.setTexture3D=Y,this.setTextureCube=ue,this.rebindTextures=je,this.setupRenderTarget=Ve,this.updateRenderTargetMipmap=Me,this.updateMultisampleRenderTarget=rt,this.setupDepthRenderbuffer=at,this.setupFrameBufferTexture=Le,this.useMultisampledRTT=Ue,this.isReversedDepthBuffer=function(){return n.buffers.depth.getReversed()}}function ote(a,e){function n(i,s=Il){let r;const o=Vn.getTransfer(s);if(i===os)return a.UNSIGNED_BYTE;if(i===HT)return a.UNSIGNED_SHORT_4_4_4_4;if(i===WT)return a.UNSIGNED_SHORT_5_5_5_1;if(i===$T)return a.UNSIGNED_INT_5_9_9_9_REV;if(i===KT)return a.UNSIGNED_INT_10F_11F_11F_REV;if(i===e0)return a.BYTE;if(i===t0)return a.SHORT;if(i===Bu)return a.UNSIGNED_SHORT;if(i===jr)return a.INT;if(i===Ei)return a.UNSIGNED_INT;if(i===ls)return a.FLOAT;if(i===cs)return a.HALF_FLOAT;if(i===UP)return a.ALPHA;if(i===Fx)return a.RGB;if(i===fs)return a.RGBA;if(i===ho)return a.DEPTH_COMPONENT;if(i===rl)return a.DEPTH_STENCIL;if(i===r1)return a.RED;if(i===E0)return a.RED_INTEGER;if(i===ol)return a.RG;if(i===o1)return a.RG_INTEGER;if(i===l1)return a.RGBA_INTEGER;if(i===Qp||i===Jp||i===Zp||i===em)if(o===An)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(i===Qp)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===Jp)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Zp)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===em)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(i===Qp)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===Jp)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Zp)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===em)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===Z_||i===ex||i===tx||i===nx)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(i===Z_)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===ex)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===tx)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===nx)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===Ty||i===wy||i===Ey||i===My||i===Cy||i===f0||i===Ny)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(i===Ty||i===wy)return o===An?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(i===Ey)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC;if(i===My)return r.COMPRESSED_R11_EAC;if(i===Cy)return r.COMPRESSED_SIGNED_R11_EAC;if(i===f0)return r.COMPRESSED_RG11_EAC;if(i===Ny)return r.COMPRESSED_SIGNED_RG11_EAC}else return null;if(i===Ry||i===Py||i===Iy||i===Ly||i===Dy||i===ky||i===Oy||i===Fy||i===jy||i===By||i===Uy||i===Vy||i===zy||i===Gy)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(i===Ry)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===Py)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===Iy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===Ly)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===Dy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===ky)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===Oy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===Fy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===jy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===By)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===Uy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===Vy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===zy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===Gy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===qy||i===wN||i===EN)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(i===qy)return o===An?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===wN)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===EN)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===Hy||i===Wy||i===p0||i===$y)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(i===Hy)return r.COMPRESSED_RED_RGTC1_EXT;if(i===Wy)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===p0)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===$y)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===yc?a.UNSIGNED_INT_24_8:a[i]!==void 0?a[i]:null}return{convert:n}}const z4e=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,G4e=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class q4e{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n){if(this.texture===null){const i=new uj(e.texture);(e.depthNear!==n.depthNear||e.depthFar!==n.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,i=new mo({vertexShader:z4e,fragmentShader:G4e,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Na(new h1(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class H4e extends Cc{constructor(e,n){super();const i=this;let s=null,r=1,o=null,l="local-floor",c=1,u=null,h=null,f=null,m=null,A=null,x=null;const T=typeof XRWebGLBinding<"u",E=new q4e,M={},N=n.getContextAttributes();let I=null,F=null;const G=[],O=[],D=new Nt;let j=null;const L=new Zs;L.viewport=new qn;const U=new Zs;U.viewport=new qn;const q=[L,U],K=new Uj;let H=null,X=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(te){let fe=G[te];return fe===void 0&&(fe=new lS,G[te]=fe),fe.getTargetRaySpace()},this.getControllerGrip=function(te){let fe=G[te];return fe===void 0&&(fe=new lS,G[te]=fe),fe.getGripSpace()},this.getHand=function(te){let fe=G[te];return fe===void 0&&(fe=new lS,G[te]=fe),fe.getHandSpace()};function ne(te){const fe=O.indexOf(te.inputSource);if(fe===-1)return;const Le=G[fe];Le!==void 0&&(Le.update(te.inputSource,te.frame,u||o),Le.dispatchEvent({type:te.type,data:te.inputSource}))}function Q(){s.removeEventListener("select",ne),s.removeEventListener("selectstart",ne),s.removeEventListener("selectend",ne),s.removeEventListener("squeeze",ne),s.removeEventListener("squeezestart",ne),s.removeEventListener("squeezeend",ne),s.removeEventListener("end",Q),s.removeEventListener("inputsourceschange",Y);for(let te=0;te<G.length;te++){const fe=O[te];fe!==null&&(O[te]=null,G[te].disconnect(fe))}H=null,X=null,E.reset();for(const te in M)delete M[te];e.setRenderTarget(I),A=null,m=null,f=null,s=null,F=null,ce.stop(),i.isPresenting=!1,e.setPixelRatio(j),e.setSize(D.width,D.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(te){r=te,i.isPresenting===!0&&yt("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(te){l=te,i.isPresenting===!0&&yt("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(te){u=te},this.getBaseLayer=function(){return m!==null?m:A},this.getBinding=function(){return f===null&&T&&(f=new XRWebGLBinding(s,n)),f},this.getFrame=function(){return x},this.getSession=function(){return s},this.setSession=async function(te){if(s=te,s!==null){if(I=e.getRenderTarget(),s.addEventListener("select",ne),s.addEventListener("selectstart",ne),s.addEventListener("selectend",ne),s.addEventListener("squeeze",ne),s.addEventListener("squeezestart",ne),s.addEventListener("squeezeend",ne),s.addEventListener("end",Q),s.addEventListener("inputsourceschange",Y),N.xrCompatible!==!0&&await n.makeXRCompatible(),j=e.getPixelRatio(),e.getSize(D),T&&"createProjectionLayer"in XRWebGLBinding.prototype){let Le=null,Fe=null,Ie=null;N.depth&&(Ie=N.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,Le=N.stencil?rl:ho,Fe=N.stencil?yc:Ei);const at={colorFormat:n.RGBA8,depthFormat:Ie,scaleFactor:r};f=this.getBinding(),m=f.createProjectionLayer(at),s.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),F=new vc(m.textureWidth,m.textureHeight,{format:fs,type:os,depthTexture:new Do(m.textureWidth,m.textureHeight,Fe,void 0,void 0,void 0,void 0,void 0,void 0,Le),stencilBuffer:N.stencil,colorSpace:e.outputColorSpace,samples:N.antialias?4:0,resolveDepthBuffer:m.ignoreDepthValues===!1,resolveStencilBuffer:m.ignoreDepthValues===!1})}else{const Le={antialias:N.antialias,alpha:!0,depth:N.depth,stencil:N.stencil,framebufferScaleFactor:r};A=new XRWebGLLayer(s,n,Le),s.updateRenderState({baseLayer:A}),e.setPixelRatio(1),e.setSize(A.framebufferWidth,A.framebufferHeight,!1),F=new vc(A.framebufferWidth,A.framebufferHeight,{format:fs,type:os,colorSpace:e.outputColorSpace,stencilBuffer:N.stencil,resolveDepthBuffer:A.ignoreDepthValues===!1,resolveStencilBuffer:A.ignoreDepthValues===!1})}F.isXRRenderTarget=!0,this.setFoveation(c),u=null,o=await s.requestReferenceSpace(l),ce.setContext(s),ce.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return E.getDepthTexture()};function Y(te){for(let fe=0;fe<te.removed.length;fe++){const Le=te.removed[fe],Fe=O.indexOf(Le);Fe>=0&&(O[Fe]=null,G[Fe].disconnect(Le))}for(let fe=0;fe<te.added.length;fe++){const Le=te.added[fe];let Fe=O.indexOf(Le);if(Fe===-1){for(let at=0;at<G.length;at++)if(at>=O.length){O.push(Le),Fe=at;break}else if(O[at]===null){O[at]=Le,Fe=at;break}if(Fe===-1)break}const Ie=G[Fe];Ie&&Ie.connect(Le)}}const ue=new ye,pe=new ye;function Ee(te,fe,Le){ue.setFromMatrixPosition(fe.matrixWorld),pe.setFromMatrixPosition(Le.matrixWorld);const Fe=ue.distanceTo(pe),Ie=fe.projectionMatrix.elements,at=Le.projectionMatrix.elements,je=Ie[14]/(Ie[10]-1),Ve=Ie[14]/(Ie[10]+1),Me=(Ie[9]+1)/Ie[5],ze=(Ie[9]-1)/Ie[5],Je=(Ie[8]-1)/Ie[0],rt=(at[8]+1)/at[0],ve=je*Je,Ue=je*rt,it=Fe/(-Je+rt),wt=it*-Je;if(fe.matrixWorld.decompose(te.position,te.quaternion,te.scale),te.translateX(wt),te.translateZ(it),te.matrixWorld.compose(te.position,te.quaternion,te.scale),te.matrixWorldInverse.copy(te.matrixWorld).invert(),Ie[10]===-1)te.projectionMatrix.copy(fe.projectionMatrix),te.projectionMatrixInverse.copy(fe.projectionMatrixInverse);else{const Mt=je+it,_e=Ve+it,le=ve-wt,Ge=Ue+(Fe-wt),tt=Me*Ve/_e*Mt,pt=ze*Ve/_e*Mt;te.projectionMatrix.makePerspective(le,Ge,tt,pt,Mt,_e),te.projectionMatrixInverse.copy(te.projectionMatrix).invert()}}function oe(te,fe){fe===null?te.matrixWorld.copy(te.matrix):te.matrixWorld.multiplyMatrices(fe.matrixWorld,te.matrix),te.matrixWorldInverse.copy(te.matrixWorld).invert()}this.updateCamera=function(te){if(s===null)return;let fe=te.near,Le=te.far;E.texture!==null&&(E.depthNear>0&&(fe=E.depthNear),E.depthFar>0&&(Le=E.depthFar)),K.near=U.near=L.near=fe,K.far=U.far=L.far=Le,(H!==K.near||X!==K.far)&&(s.updateRenderState({depthNear:K.near,depthFar:K.far}),H=K.near,X=K.far),K.layers.mask=te.layers.mask|6,L.layers.mask=K.layers.mask&3,U.layers.mask=K.layers.mask&5;const Fe=te.parent,Ie=K.cameras;oe(K,Fe);for(let at=0;at<Ie.length;at++)oe(Ie[at],Fe);Ie.length===2?Ee(K,L,U):K.projectionMatrix.copy(L.projectionMatrix),Ae(te,K,Fe)};function Ae(te,fe,Le){Le===null?te.matrix.copy(fe.matrixWorld):(te.matrix.copy(Le.matrixWorld),te.matrix.invert(),te.matrix.multiply(fe.matrixWorld)),te.matrix.decompose(te.position,te.quaternion,te.scale),te.updateMatrixWorld(!0),te.projectionMatrix.copy(fe.projectionMatrix),te.projectionMatrixInverse.copy(fe.projectionMatrixInverse),te.isPerspectiveCamera&&(te.fov=Yy*2*Math.atan(1/te.projectionMatrix.elements[5]),te.zoom=1)}this.getCamera=function(){return K},this.getFoveation=function(){if(!(m===null&&A===null))return c},this.setFoveation=function(te){c=te,m!==null&&(m.fixedFoveation=te),A!==null&&A.fixedFoveation!==void 0&&(A.fixedFoveation=te)},this.hasDepthSensing=function(){return E.texture!==null},this.getDepthSensingMesh=function(){return E.getMesh(K)},this.getCameraTexture=function(te){return M[te]};let be=null;function Ce(te,fe){if(h=fe.getViewerPose(u||o),x=fe,h!==null){const Le=h.views;A!==null&&(e.setRenderTargetFramebuffer(F,A.framebuffer),e.setRenderTarget(F));let Fe=!1;Le.length!==K.cameras.length&&(K.cameras.length=0,Fe=!0);for(let Ve=0;Ve<Le.length;Ve++){const Me=Le[Ve];let ze=null;if(A!==null)ze=A.getViewport(Me);else{const rt=f.getViewSubImage(m,Me);ze=rt.viewport,Ve===0&&(e.setRenderTargetTextures(F,rt.colorTexture,rt.depthStencilTexture),e.setRenderTarget(F))}let Je=q[Ve];Je===void 0&&(Je=new Zs,Je.layers.enable(Ve),Je.viewport=new qn,q[Ve]=Je),Je.matrix.fromArray(Me.transform.matrix),Je.matrix.decompose(Je.position,Je.quaternion,Je.scale),Je.projectionMatrix.fromArray(Me.projectionMatrix),Je.projectionMatrixInverse.copy(Je.projectionMatrix).invert(),Je.viewport.set(ze.x,ze.y,ze.width,ze.height),Ve===0&&(K.matrix.copy(Je.matrix),K.matrix.decompose(K.position,K.quaternion,K.scale)),Fe===!0&&K.cameras.push(Je)}const Ie=s.enabledFeatures;if(Ie&&Ie.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&T){f=i.getBinding();const Ve=f.getDepthInformation(Le[0]);Ve&&Ve.isValid&&Ve.texture&&E.init(Ve,s.renderState)}if(Ie&&Ie.includes("camera-access")&&T){e.state.unbindTexture(),f=i.getBinding();for(let Ve=0;Ve<Le.length;Ve++){const Me=Le[Ve].camera;if(Me){let ze=M[Me];ze||(ze=new uj,M[Me]=ze);const Je=f.getCameraImage(Me);ze.sourceTexture=Je}}}}for(let Le=0;Le<G.length;Le++){const Fe=O[Le],Ie=G[Le];Fe!==null&&Ie!==void 0&&Ie.update(Fe,fe,u||o)}be&&be(te,fe),fe.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:fe}),x=null}const ce=new nte;ce.setAnimationLoop(Ce),this.setAnimationLoop=function(te){be=te},this.dispose=function(){}}}const gA=new fo,W4e=new _n;function $4e(a,e){function n(E,M){E.matrixAutoUpdate===!0&&E.updateMatrix(),M.value.copy(E.matrix)}function i(E,M){M.color.getRGB(E.fogColor.value,Tee(a)),M.isFog?(E.fogNear.value=M.near,E.fogFar.value=M.far):M.isFogExp2&&(E.fogDensity.value=M.density)}function s(E,M,N,I,F){M.isMeshBasicMaterial||M.isMeshLambertMaterial?r(E,M):M.isMeshToonMaterial?(r(E,M),f(E,M)):M.isMeshPhongMaterial?(r(E,M),h(E,M)):M.isMeshStandardMaterial?(r(E,M),m(E,M),M.isMeshPhysicalMaterial&&A(E,M,F)):M.isMeshMatcapMaterial?(r(E,M),x(E,M)):M.isMeshDepthMaterial?r(E,M):M.isMeshDistanceMaterial?(r(E,M),T(E,M)):M.isMeshNormalMaterial?r(E,M):M.isLineBasicMaterial?(o(E,M),M.isLineDashedMaterial&&l(E,M)):M.isPointsMaterial?c(E,M,N,I):M.isSpriteMaterial?u(E,M):M.isShadowMaterial?(E.color.value.copy(M.color),E.opacity.value=M.opacity):M.isShaderMaterial&&(M.uniformsNeedUpdate=!1)}function r(E,M){E.opacity.value=M.opacity,M.color&&E.diffuse.value.copy(M.color),M.emissive&&E.emissive.value.copy(M.emissive).multiplyScalar(M.emissiveIntensity),M.map&&(E.map.value=M.map,n(M.map,E.mapTransform)),M.alphaMap&&(E.alphaMap.value=M.alphaMap,n(M.alphaMap,E.alphaMapTransform)),M.bumpMap&&(E.bumpMap.value=M.bumpMap,n(M.bumpMap,E.bumpMapTransform),E.bumpScale.value=M.bumpScale,M.side===Di&&(E.bumpScale.value*=-1)),M.normalMap&&(E.normalMap.value=M.normalMap,n(M.normalMap,E.normalMapTransform),E.normalScale.value.copy(M.normalScale),M.side===Di&&E.normalScale.value.negate()),M.displacementMap&&(E.displacementMap.value=M.displacementMap,n(M.displacementMap,E.displacementMapTransform),E.displacementScale.value=M.displacementScale,E.displacementBias.value=M.displacementBias),M.emissiveMap&&(E.emissiveMap.value=M.emissiveMap,n(M.emissiveMap,E.emissiveMapTransform)),M.specularMap&&(E.specularMap.value=M.specularMap,n(M.specularMap,E.specularMapTransform)),M.alphaTest>0&&(E.alphaTest.value=M.alphaTest);const N=e.get(M),I=N.envMap,F=N.envMapRotation;I&&(E.envMap.value=I,gA.copy(F),gA.x*=-1,gA.y*=-1,gA.z*=-1,I.isCubeTexture&&I.isRenderTargetTexture===!1&&(gA.y*=-1,gA.z*=-1),E.envMapRotation.value.setFromMatrix4(W4e.makeRotationFromEuler(gA)),E.flipEnvMap.value=I.isCubeTexture&&I.isRenderTargetTexture===!1?-1:1,E.reflectivity.value=M.reflectivity,E.ior.value=M.ior,E.refractionRatio.value=M.refractionRatio),M.lightMap&&(E.lightMap.value=M.lightMap,E.lightMapIntensity.value=M.lightMapIntensity,n(M.lightMap,E.lightMapTransform)),M.aoMap&&(E.aoMap.value=M.aoMap,E.aoMapIntensity.value=M.aoMapIntensity,n(M.aoMap,E.aoMapTransform))}function o(E,M){E.diffuse.value.copy(M.color),E.opacity.value=M.opacity,M.map&&(E.map.value=M.map,n(M.map,E.mapTransform))}function l(E,M){E.dashSize.value=M.dashSize,E.totalSize.value=M.dashSize+M.gapSize,E.scale.value=M.scale}function c(E,M,N,I){E.diffuse.value.copy(M.color),E.opacity.value=M.opacity,E.size.value=M.size*N,E.scale.value=I*.5,M.map&&(E.map.value=M.map,n(M.map,E.uvTransform)),M.alphaMap&&(E.alphaMap.value=M.alphaMap,n(M.alphaMap,E.alphaMapTransform)),M.alphaTest>0&&(E.alphaTest.value=M.alphaTest)}function u(E,M){E.diffuse.value.copy(M.color),E.opacity.value=M.opacity,E.rotation.value=M.rotation,M.map&&(E.map.value=M.map,n(M.map,E.mapTransform)),M.alphaMap&&(E.alphaMap.value=M.alphaMap,n(M.alphaMap,E.alphaMapTransform)),M.alphaTest>0&&(E.alphaTest.value=M.alphaTest)}function h(E,M){E.specular.value.copy(M.specular),E.shininess.value=Math.max(M.shininess,1e-4)}function f(E,M){M.gradientMap&&(E.gradientMap.value=M.gradientMap)}function m(E,M){E.metalness.value=M.metalness,M.metalnessMap&&(E.metalnessMap.value=M.metalnessMap,n(M.metalnessMap,E.metalnessMapTransform)),E.roughness.value=M.roughness,M.roughnessMap&&(E.roughnessMap.value=M.roughnessMap,n(M.roughnessMap,E.roughnessMapTransform)),M.envMap&&(E.envMapIntensity.value=M.envMapIntensity)}function A(E,M,N){E.ior.value=M.ior,M.sheen>0&&(E.sheenColor.value.copy(M.sheenColor).multiplyScalar(M.sheen),E.sheenRoughness.value=M.sheenRoughness,M.sheenColorMap&&(E.sheenColorMap.value=M.sheenColorMap,n(M.sheenColorMap,E.sheenColorMapTransform)),M.sheenRoughnessMap&&(E.sheenRoughnessMap.value=M.sheenRoughnessMap,n(M.sheenRoughnessMap,E.sheenRoughnessMapTransform))),M.clearcoat>0&&(E.clearcoat.value=M.clearcoat,E.clearcoatRoughness.value=M.clearcoatRoughness,M.clearcoatMap&&(E.clearcoatMap.value=M.clearcoatMap,n(M.clearcoatMap,E.clearcoatMapTransform)),M.clearcoatRoughnessMap&&(E.clearcoatRoughnessMap.value=M.clearcoatRoughnessMap,n(M.clearcoatRoughnessMap,E.clearcoatRoughnessMapTransform)),M.clearcoatNormalMap&&(E.clearcoatNormalMap.value=M.clearcoatNormalMap,n(M.clearcoatNormalMap,E.clearcoatNormalMapTransform),E.clearcoatNormalScale.value.copy(M.clearcoatNormalScale),M.side===Di&&E.clearcoatNormalScale.value.negate())),M.dispersion>0&&(E.dispersion.value=M.dispersion),M.iridescence>0&&(E.iridescence.value=M.iridescence,E.iridescenceIOR.value=M.iridescenceIOR,E.iridescenceThicknessMinimum.value=M.iridescenceThicknessRange[0],E.iridescenceThicknessMaximum.value=M.iridescenceThicknessRange[1],M.iridescenceMap&&(E.iridescenceMap.value=M.iridescenceMap,n(M.iridescenceMap,E.iridescenceMapTransform)),M.iridescenceThicknessMap&&(E.iridescenceThicknessMap.value=M.iridescenceThicknessMap,n(M.iridescenceThicknessMap,E.iridescenceThicknessMapTransform))),M.transmission>0&&(E.transmission.value=M.transmission,E.transmissionSamplerMap.value=N.texture,E.transmissionSamplerSize.value.set(N.width,N.height),M.transmissionMap&&(E.transmissionMap.value=M.transmissionMap,n(M.transmissionMap,E.transmissionMapTransform)),E.thickness.value=M.thickness,M.thicknessMap&&(E.thicknessMap.value=M.thicknessMap,n(M.thicknessMap,E.thicknessMapTransform)),E.attenuationDistance.value=M.attenuationDistance,E.attenuationColor.value.copy(M.attenuationColor)),M.anisotropy>0&&(E.anisotropyVector.value.set(M.anisotropy*Math.cos(M.anisotropyRotation),M.anisotropy*Math.sin(M.anisotropyRotation)),M.anisotropyMap&&(E.anisotropyMap.value=M.anisotropyMap,n(M.anisotropyMap,E.anisotropyMapTransform))),E.specularIntensity.value=M.specularIntensity,E.specularColor.value.copy(M.specularColor),M.specularColorMap&&(E.specularColorMap.value=M.specularColorMap,n(M.specularColorMap,E.specularColorMapTransform)),M.specularIntensityMap&&(E.specularIntensityMap.value=M.specularIntensityMap,n(M.specularIntensityMap,E.specularIntensityMapTransform))}function x(E,M){M.matcap&&(E.matcap.value=M.matcap)}function T(E,M){const N=e.get(M).light;E.referencePosition.value.setFromMatrixPosition(N.matrixWorld),E.nearDistance.value=N.shadow.camera.near,E.farDistance.value=N.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:s}}function K4e(a,e,n,i){let s={},r={},o=[];const l=a.getParameter(a.MAX_UNIFORM_BUFFER_BINDINGS);function c(N,I){const F=I.program;i.uniformBlockBinding(N,F)}function u(N,I){let F=s[N.id];F===void 0&&(x(N),F=h(N),s[N.id]=F,N.addEventListener("dispose",E));const G=I.program;i.updateUBOMapping(N,G);const O=e.render.frame;r[N.id]!==O&&(m(N),r[N.id]=O)}function h(N){const I=f();N.__bindingPointIndex=I;const F=a.createBuffer(),G=N.__size,O=N.usage;return a.bindBuffer(a.UNIFORM_BUFFER,F),a.bufferData(a.UNIFORM_BUFFER,G,O),a.bindBuffer(a.UNIFORM_BUFFER,null),a.bindBufferBase(a.UNIFORM_BUFFER,I,F),F}function f(){for(let N=0;N<l;N++)if(o.indexOf(N)===-1)return o.push(N),N;return Rt("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(N){const I=s[N.id],F=N.uniforms,G=N.__cache;a.bindBuffer(a.UNIFORM_BUFFER,I);for(let O=0,D=F.length;O<D;O++){const j=Array.isArray(F[O])?F[O]:[F[O]];for(let L=0,U=j.length;L<U;L++){const q=j[L];if(A(q,O,L,G)===!0){const K=q.__offset,H=Array.isArray(q.value)?q.value:[q.value];let X=0;for(let ne=0;ne<H.length;ne++){const Q=H[ne],Y=T(Q);typeof Q=="number"||typeof Q=="boolean"?(q.__data[0]=Q,a.bufferSubData(a.UNIFORM_BUFFER,K+X,q.__data)):Q.isMatrix3?(q.__data[0]=Q.elements[0],q.__data[1]=Q.elements[1],q.__data[2]=Q.elements[2],q.__data[3]=0,q.__data[4]=Q.elements[3],q.__data[5]=Q.elements[4],q.__data[6]=Q.elements[5],q.__data[7]=0,q.__data[8]=Q.elements[6],q.__data[9]=Q.elements[7],q.__data[10]=Q.elements[8],q.__data[11]=0):(Q.toArray(q.__data,X),X+=Y.storage/Float32Array.BYTES_PER_ELEMENT)}a.bufferSubData(a.UNIFORM_BUFFER,K,q.__data)}}}a.bindBuffer(a.UNIFORM_BUFFER,null)}function A(N,I,F,G){const O=N.value,D=I+"_"+F;if(G[D]===void 0)return typeof O=="number"||typeof O=="boolean"?G[D]=O:G[D]=O.clone(),!0;{const j=G[D];if(typeof O=="number"||typeof O=="boolean"){if(j!==O)return G[D]=O,!0}else if(j.equals(O)===!1)return j.copy(O),!0}return!1}function x(N){const I=N.uniforms;let F=0;const G=16;for(let D=0,j=I.length;D<j;D++){const L=Array.isArray(I[D])?I[D]:[I[D]];for(let U=0,q=L.length;U<q;U++){const K=L[U],H=Array.isArray(K.value)?K.value:[K.value];for(let X=0,ne=H.length;X<ne;X++){const Q=H[X],Y=T(Q),ue=F%G,pe=ue%Y.boundary,Ee=ue+pe;F+=pe,Ee!==0&&G-Ee<Y.storage&&(F+=G-Ee),K.__data=new Float32Array(Y.storage/Float32Array.BYTES_PER_ELEMENT),K.__offset=F,F+=Y.storage}}}const O=F%G;return O>0&&(F+=G-O),N.__size=F,N.__cache={},this}function T(N){const I={boundary:0,storage:0};return typeof N=="number"||typeof N=="boolean"?(I.boundary=4,I.storage=4):N.isVector2?(I.boundary=8,I.storage=8):N.isVector3||N.isColor?(I.boundary=16,I.storage=12):N.isVector4?(I.boundary=16,I.storage=16):N.isMatrix3?(I.boundary=48,I.storage=48):N.isMatrix4?(I.boundary=64,I.storage=64):N.isTexture?yt("WebGLRenderer: Texture samplers can not be part of an uniforms group."):yt("WebGLRenderer: Unsupported uniform value type.",N),I}function E(N){const I=N.target;I.removeEventListener("dispose",E);const F=o.indexOf(I.__bindingPointIndex);o.splice(F,1),a.deleteBuffer(s[I.id]),delete s[I.id],delete r[I.id]}function M(){for(const N in s)a.deleteBuffer(s[N]);o=[],s={},r={}}return{bind:c,update:u,dispose:M}}const Y4e=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let Sh=null;function X4e(){return Sh===null&&(Sh=new cu(Y4e,16,16,ol,cs),Sh.name="DFG_LUT",Sh.minFilter=di,Sh.magFilter=di,Sh.wrapS=Ur,Sh.wrapT=Ur,Sh.generateMipmaps=!1,Sh.needsUpdate=!0),Sh}class lte{constructor(e={}){const{canvas:n=aj(),context:i=null,depth:s=!0,stencil:r=!1,alpha:o=!1,antialias:l=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:u=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:f=!1,reversedDepthBuffer:m=!1,outputBufferType:A=os}=e;this.isWebGLRenderer=!0;let x;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");x=i.getContextAttributes().alpha}else x=o;const T=A,E=new Set([l1,o1,E0]),M=new Set([os,Ei,Bu,yc,HT,WT]),N=new Uint32Array(4),I=new Int32Array(4);let F=null,G=null;const O=[],D=[];let j=null;this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=lo,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const L=this;let U=!1;this._outputColorSpace=Fr;let q=0,K=0,H=null,X=-1,ne=null;const Q=new qn,Y=new qn;let ue=null;const pe=new on(0);let Ee=0,oe=n.width,Ae=n.height,be=1,Ce=null,ce=null;const te=new qn(0,0,oe,Ae),fe=new qn(0,0,oe,Ae);let Le=!1;const Fe=new C0;let Ie=!1,at=!1;const je=new _n,Ve=new ye,Me=new qn,ze={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Je=!1;function rt(){return H===null?be:1}let ve=i;function Ue(Se,ot){return n.getContext(Se,ot)}try{const Se={alpha:!0,depth:s,stencil:r,antialias:l,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:h,failIfMajorPerformanceCaveat:f};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${w0}`),n.addEventListener("webglcontextlost",jn,!1),n.addEventListener("webglcontextrestored",ai,!1),n.addEventListener("webglcontextcreationerror",Ta,!1),ve===null){const ot="webgl2";if(ve=Ue(ot,Se),ve===null)throw Ue(ot)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Se){throw Rt("WebGLRenderer: "+Se.message),Se}let it,wt,Mt,_e,le,Ge,tt,pt,Te,st,mt,ht,Qe,Xe,ct,Tt,kt,vt,Tn,Ne,Xt,Ht,$t,zt;function Ot(){it=new QRe(ve),it.init(),Ht=new ote(ve,it),wt=new zRe(ve,it,e,Ht),Mt=new U4e(ve,it),wt.reversedDepthBuffer&&m&&Mt.buffers.depth.setReversed(!0),_e=new ePe(ve),le=new w4e,Ge=new V4e(ve,it,Mt,le,wt,Ht,_e),tt=new qRe(L),pt=new XRe(L),Te=new i3e(ve),$t=new URe(ve,Te),st=new JRe(ve,Te,_e,$t),mt=new nPe(ve,st,Te,_e),Tn=new tPe(ve,wt,Ge),Tt=new GRe(le),ht=new T4e(L,tt,pt,it,wt,$t,Tt),Qe=new $4e(L,le),Xe=new M4e,ct=new L4e(it),vt=new BRe(L,tt,pt,Mt,mt,x,c),kt=new j4e(L,mt,wt),zt=new K4e(ve,_e,wt,Mt),Ne=new VRe(ve,it,_e),Xt=new ZRe(ve,it,_e),_e.programs=ht.programs,L.capabilities=wt,L.extensions=it,L.properties=le,L.renderLists=Xe,L.shadowMap=kt,L.state=Mt,L.info=_e}Ot(),T!==os&&(j=new iPe(T,n.width,n.height,s,r));const an=new H4e(L,ve);this.xr=an,this.getContext=function(){return ve},this.getContextAttributes=function(){return ve.getContextAttributes()},this.forceContextLoss=function(){const Se=it.get("WEBGL_lose_context");Se&&Se.loseContext()},this.forceContextRestore=function(){const Se=it.get("WEBGL_lose_context");Se&&Se.restoreContext()},this.getPixelRatio=function(){return be},this.setPixelRatio=function(Se){Se!==void 0&&(be=Se,this.setSize(oe,Ae,!1))},this.getSize=function(Se){return Se.set(oe,Ae)},this.setSize=function(Se,ot,St=!0){if(an.isPresenting){yt("WebGLRenderer: Can't change size while VR device is presenting.");return}oe=Se,Ae=ot,n.width=Math.floor(Se*be),n.height=Math.floor(ot*be),St===!0&&(n.style.width=Se+"px",n.style.height=ot+"px"),j!==null&&j.setSize(n.width,n.height),this.setViewport(0,0,Se,ot)},this.getDrawingBufferSize=function(Se){return Se.set(oe*be,Ae*be).floor()},this.setDrawingBufferSize=function(Se,ot,St){oe=Se,Ae=ot,be=St,n.width=Math.floor(Se*St),n.height=Math.floor(ot*St),this.setViewport(0,0,Se,ot)},this.setEffects=function(Se){if(T===os){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(Se){for(let ot=0;ot<Se.length;ot++)if(Se[ot].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}j.setEffects(Se||[])},this.getCurrentViewport=function(Se){return Se.copy(Q)},this.getViewport=function(Se){return Se.copy(te)},this.setViewport=function(Se,ot,St,Ze){Se.isVector4?te.set(Se.x,Se.y,Se.z,Se.w):te.set(Se,ot,St,Ze),Mt.viewport(Q.copy(te).multiplyScalar(be).round())},this.getScissor=function(Se){return Se.copy(fe)},this.setScissor=function(Se,ot,St,Ze){Se.isVector4?fe.set(Se.x,Se.y,Se.z,Se.w):fe.set(Se,ot,St,Ze),Mt.scissor(Y.copy(fe).multiplyScalar(be).round())},this.getScissorTest=function(){return Le},this.setScissorTest=function(Se){Mt.setScissorTest(Le=Se)},this.setOpaqueSort=function(Se){Ce=Se},this.setTransparentSort=function(Se){ce=Se},this.getClearColor=function(Se){return Se.copy(vt.getClearColor())},this.setClearColor=function(){vt.setClearColor(...arguments)},this.getClearAlpha=function(){return vt.getClearAlpha()},this.setClearAlpha=function(){vt.setClearAlpha(...arguments)},this.clear=function(Se=!0,ot=!0,St=!0){let Ze=0;if(Se){let se=!1;if(H!==null){const Dt=H.texture.format;se=E.has(Dt)}if(se){const Dt=H.texture.type,gn=M.has(Dt),dn=vt.getClearColor(),bn=vt.getClearAlpha(),Mn=dn.r,Dn=dn.g,de=dn.b;gn?(N[0]=Mn,N[1]=Dn,N[2]=de,N[3]=bn,ve.clearBufferuiv(ve.COLOR,0,N)):(I[0]=Mn,I[1]=Dn,I[2]=de,I[3]=bn,ve.clearBufferiv(ve.COLOR,0,I))}else Ze|=ve.COLOR_BUFFER_BIT}ot&&(Ze|=ve.DEPTH_BUFFER_BIT),St&&(Ze|=ve.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ve.clear(Ze)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",jn,!1),n.removeEventListener("webglcontextrestored",ai,!1),n.removeEventListener("webglcontextcreationerror",Ta,!1),vt.dispose(),Xe.dispose(),ct.dispose(),le.dispose(),tt.dispose(),pt.dispose(),mt.dispose(),$t.dispose(),zt.dispose(),ht.dispose(),an.dispose(),an.removeEventListener("sessionstart",_),an.removeEventListener("sessionend",me),Yn.stop()};function jn(Se){Se.preventDefault(),ix("WebGLRenderer: Context Lost."),U=!0}function ai(){ix("WebGLRenderer: Context Restored."),U=!1;const Se=_e.autoReset,ot=kt.enabled,St=kt.autoUpdate,Ze=kt.needsUpdate,se=kt.type;Ot(),_e.autoReset=Se,kt.enabled=ot,kt.autoUpdate=St,kt.needsUpdate=Ze,kt.type=se}function Ta(Se){Rt("WebGLRenderer: A WebGL context could not be created. Reason: ",Se.statusMessage)}function Gs(Se){const ot=Se.target;ot.removeEventListener("dispose",Gs),dr(ot)}function dr(Se){bt(Se),le.remove(Se)}function bt(Se){const ot=le.get(Se).programs;ot!==void 0&&(ot.forEach(function(St){ht.releaseProgram(St)}),Se.isShaderMaterial&&ht.releaseShaderCache(Se))}this.renderBufferDirect=function(Se,ot,St,Ze,se,Dt){ot===null&&(ot=ze);const gn=se.isMesh&&se.matrixWorld.determinant()<0,dn=yo(Se,ot,St,Ze,se);Mt.setMaterial(Ze,gn);let bn=St.index,Mn=1;if(Ze.wireframe===!0){if(bn=st.getWireframeAttribute(St),bn===void 0)return;Mn=2}const Dn=St.drawRange,de=St.attributes.position;let Bn=Dn.start*Mn,ja=(Dn.start+Dn.count)*Mn;Dt!==null&&(Bn=Math.max(Bn,Dt.start*Mn),ja=Math.min(ja,(Dt.start+Dt.count)*Mn)),bn!==null?(Bn=Math.max(Bn,0),ja=Math.min(ja,bn.count)):de!=null&&(Bn=Math.max(Bn,0),ja=Math.min(ja,de.count));const ki=ja-Bn;if(ki<0||ki===1/0)return;$t.setup(se,Ze,dn,St,bn);let Xn,Ya=Ne;if(bn!==null&&(Xn=Te.get(bn),Ya=Xt,Ya.setIndex(Xn)),se.isMesh)Ze.wireframe===!0?(Mt.setLineWidth(Ze.wireframeLinewidth*rt()),Ya.setMode(ve.LINES)):Ya.setMode(ve.TRIANGLES);else if(se.isLine){let Pn=Ze.linewidth;Pn===void 0&&(Pn=1),Mt.setLineWidth(Pn*rt()),se.isLineSegments?Ya.setMode(ve.LINES):se.isLineLoop?Ya.setMode(ve.LINE_LOOP):Ya.setMode(ve.LINE_STRIP)}else se.isPoints?Ya.setMode(ve.POINTS):se.isSprite&&Ya.setMode(ve.TRIANGLES);if(se.isBatchedMesh)if(se._multiDrawInstances!==null)ji("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Ya.renderMultiDrawInstances(se._multiDrawStarts,se._multiDrawCounts,se._multiDrawCount,se._multiDrawInstances);else if(it.get("WEBGL_multi_draw"))Ya.renderMultiDraw(se._multiDrawStarts,se._multiDrawCounts,se._multiDrawCount);else{const Pn=se._multiDrawStarts,Fa=se._multiDrawCounts,ca=se._multiDrawCount,Is=bn?Te.get(bn).bytesPerElement:1,Hs=le.get(Ze).currentProgram.getUniforms();for(let za=0;za<ca;za++)Hs.setValue(ve,"_gl_DrawID",za),Ya.render(Pn[za]/Is,Fa[za])}else if(se.isInstancedMesh)Ya.renderInstances(Bn,ki,se.count);else if(St.isInstancedBufferGeometry){const Pn=St._maxInstanceCount!==void 0?St._maxInstanceCount:1/0,Fa=Math.min(St.instanceCount,Pn);Ya.renderInstances(Bn,ki,Fa)}else Ya.render(Bn,ki)};function Bt(Se,ot,St){Se.transparent===!0&&Se.side===er&&Se.forceSinglePass===!1?(Se.side=Di,Se.needsUpdate=!0,ka(Se,ot,St),Se.side=Ac,Se.needsUpdate=!0,ka(Se,ot,St),Se.side=er):ka(Se,ot,St)}this.compile=function(Se,ot,St=null){St===null&&(St=Se),G=ct.get(St),G.init(ot),D.push(G),St.traverseVisible(function(se){se.isLight&&se.layers.test(ot.layers)&&(G.pushLight(se),se.castShadow&&G.pushShadow(se))}),Se!==St&&Se.traverseVisible(function(se){se.isLight&&se.layers.test(ot.layers)&&(G.pushLight(se),se.castShadow&&G.pushShadow(se))}),G.setupLights();const Ze=new Set;return Se.traverse(function(se){if(!(se.isMesh||se.isPoints||se.isLine||se.isSprite))return;const Dt=se.material;if(Dt)if(Array.isArray(Dt))for(let gn=0;gn<Dt.length;gn++){const dn=Dt[gn];Bt(dn,St,se),Ze.add(dn)}else Bt(Dt,St,se),Ze.add(Dt)}),G=D.pop(),Ze},this.compileAsync=function(Se,ot,St=null){const Ze=this.compile(Se,ot,St);return new Promise(se=>{function Dt(){if(Ze.forEach(function(gn){le.get(gn).currentProgram.isReady()&&Ze.delete(gn)}),Ze.size===0){se(Se);return}setTimeout(Dt,10)}it.get("KHR_parallel_shader_compile")!==null?Dt():setTimeout(Dt,10)})};let ln=null;function Ut(Se){ln&&ln(Se)}function _(){Yn.stop()}function me(){Yn.start()}const Yn=new nte;Yn.setAnimationLoop(Ut),typeof self<"u"&&Yn.setContext(self),this.setAnimationLoop=function(Se){ln=Se,an.setAnimationLoop(Se),Se===null?Yn.stop():Yn.start()},an.addEventListener("sessionstart",_),an.addEventListener("sessionend",me),this.render=function(Se,ot){if(ot!==void 0&&ot.isCamera!==!0){Rt("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(U===!0)return;const St=an.enabled===!0&&an.isPresenting===!0,Ze=j!==null&&(H===null||St)&&j.begin(L,H);if(Se.matrixWorldAutoUpdate===!0&&Se.updateMatrixWorld(),ot.parent===null&&ot.matrixWorldAutoUpdate===!0&&ot.updateMatrixWorld(),an.enabled===!0&&an.isPresenting===!0&&(j===null||j.isCompositing()===!1)&&(an.cameraAutoUpdate===!0&&an.updateCamera(ot),ot=an.getCamera()),Se.isScene===!0&&Se.onBeforeRender(L,Se,ot,H),G=ct.get(Se,D.length),G.init(ot),D.push(G),je.multiplyMatrices(ot.projectionMatrix,ot.matrixWorldInverse),Fe.setFromProjectionMatrix(je,Ro,ot.reversedDepth),at=this.localClippingEnabled,Ie=Tt.init(this.clippingPlanes,at),F=Xe.get(Se,O.length),F.init(),O.push(F),an.enabled===!0&&an.isPresenting===!0){const gn=L.xr.getDepthSensingMesh();gn!==null&&va(gn,ot,-1/0,L.sortObjects)}va(Se,ot,0,L.sortObjects),F.finish(),L.sortObjects===!0&&F.sort(Ce,ce),Je=an.enabled===!1||an.isPresenting===!1||an.hasDepthSensing()===!1,Je&&vt.addToRenderList(F,Se),this.info.render.frame++,Ie===!0&&Tt.beginShadows();const se=G.state.shadowsArray;if(kt.render(se,Se,ot),Ie===!0&&Tt.endShadows(),this.info.autoReset===!0&&this.info.reset(),(Ze&&j.hasRenderPass())===!1){const gn=F.opaque,dn=F.transmissive;if(G.setupLights(),ot.isArrayCamera){const bn=ot.cameras;if(dn.length>0)for(let Mn=0,Dn=bn.length;Mn<Dn;Mn++){const de=bn[Mn];Ln(gn,dn,Se,de)}Je&&vt.render(Se);for(let Mn=0,Dn=bn.length;Mn<Dn;Mn++){const de=bn[Mn];Pa(F,Se,de,de.viewport)}}else dn.length>0&&Ln(gn,dn,Se,ot),Je&&vt.render(Se),Pa(F,Se,ot)}H!==null&&K===0&&(Ge.updateMultisampleRenderTarget(H),Ge.updateRenderTargetMipmap(H)),Ze&&j.end(L),Se.isScene===!0&&Se.onAfterRender(L,Se,ot),$t.resetDefaultState(),X=-1,ne=null,D.pop(),D.length>0?(G=D[D.length-1],Ie===!0&&Tt.setGlobalState(L.clippingPlanes,G.state.camera)):G=null,O.pop(),O.length>0?F=O[O.length-1]:F=null};function va(Se,ot,St,Ze){if(Se.visible===!1)return;if(Se.layers.test(ot.layers)){if(Se.isGroup)St=Se.renderOrder;else if(Se.isLOD)Se.autoUpdate===!0&&Se.update(ot);else if(Se.isLight)G.pushLight(Se),Se.castShadow&&G.pushShadow(Se);else if(Se.isSprite){if(!Se.frustumCulled||Fe.intersectsSprite(Se)){Ze&&Me.setFromMatrixPosition(Se.matrixWorld).applyMatrix4(je);const gn=mt.update(Se),dn=Se.material;dn.visible&&F.push(Se,gn,dn,St,Me.z,null)}}else if((Se.isMesh||Se.isLine||Se.isPoints)&&(!Se.frustumCulled||Fe.intersectsObject(Se))){const gn=mt.update(Se),dn=Se.material;if(Ze&&(Se.boundingSphere!==void 0?(Se.boundingSphere===null&&Se.computeBoundingSphere(),Me.copy(Se.boundingSphere.center)):(gn.boundingSphere===null&&gn.computeBoundingSphere(),Me.copy(gn.boundingSphere.center)),Me.applyMatrix4(Se.matrixWorld).applyMatrix4(je)),Array.isArray(dn)){const bn=gn.groups;for(let Mn=0,Dn=bn.length;Mn<Dn;Mn++){const de=bn[Mn],Bn=dn[de.materialIndex];Bn&&Bn.visible&&F.push(Se,gn,Bn,St,Me.z,de)}}else dn.visible&&F.push(Se,gn,dn,St,Me.z,null)}}const Dt=Se.children;for(let gn=0,dn=Dt.length;gn<dn;gn++)va(Dt[gn],ot,St,Ze)}function Pa(Se,ot,St,Ze){const{opaque:se,transmissive:Dt,transparent:gn}=Se;G.setupLightsView(St),Ie===!0&&Tt.setGlobalState(L.clippingPlanes,St),Ze&&Mt.viewport(Q.copy(Ze)),se.length>0&&oa(se,ot,St),Dt.length>0&&oa(Dt,ot,St),gn.length>0&&oa(gn,ot,St),Mt.buffers.depth.setTest(!0),Mt.buffers.depth.setMask(!0),Mt.buffers.color.setMask(!0),Mt.setPolygonOffset(!1)}function Ln(Se,ot,St,Ze){if((St.isScene===!0?St.overrideMaterial:null)!==null)return;if(G.state.transmissionRenderTarget[Ze.id]===void 0){const Bn=it.has("EXT_color_buffer_half_float")||it.has("EXT_color_buffer_float");G.state.transmissionRenderTarget[Ze.id]=new vc(1,1,{generateMipmaps:!0,type:Bn?cs:os,minFilter:No,samples:wt.samples,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Vn.workingColorSpace})}const Dt=G.state.transmissionRenderTarget[Ze.id],gn=Ze.viewport||Q;Dt.setSize(gn.z*L.transmissionResolutionScale,gn.w*L.transmissionResolutionScale);const dn=L.getRenderTarget(),bn=L.getActiveCubeFace(),Mn=L.getActiveMipmapLevel();L.setRenderTarget(Dt),L.getClearColor(pe),Ee=L.getClearAlpha(),Ee<1&&L.setClearColor(16777215,.5),L.clear(),Je&&vt.render(St);const Dn=L.toneMapping;L.toneMapping=lo;const de=Ze.viewport;if(Ze.viewport!==void 0&&(Ze.viewport=void 0),G.setupLightsView(Ze),Ie===!0&&Tt.setGlobalState(L.clippingPlanes,Ze),oa(Se,St,Ze),Ge.updateMultisampleRenderTarget(Dt),Ge.updateRenderTargetMipmap(Dt),it.has("WEBGL_multisampled_render_to_texture")===!1){let Bn=!1;for(let ja=0,ki=ot.length;ja<ki;ja++){const Xn=ot[ja],{object:Ya,geometry:Pn,material:Fa,group:ca}=Xn;if(Fa.side===er&&Ya.layers.test(Ze.layers)){const Is=Fa.side;Fa.side=Di,Fa.needsUpdate=!0,Kr(Ya,St,Ze,Pn,Fa,ca),Fa.side=Is,Fa.needsUpdate=!0,Bn=!0}}Bn===!0&&(Ge.updateMultisampleRenderTarget(Dt),Ge.updateRenderTargetMipmap(Dt))}L.setRenderTarget(dn,bn,Mn),L.setClearColor(pe,Ee),de!==void 0&&(Ze.viewport=de),L.toneMapping=Dn}function oa(Se,ot,St){const Ze=ot.isScene===!0?ot.overrideMaterial:null;for(let se=0,Dt=Se.length;se<Dt;se++){const gn=Se[se],{object:dn,geometry:bn,group:Mn}=gn;let Dn=gn.material;Dn.allowOverride===!0&&Ze!==null&&(Dn=Ze),dn.layers.test(St.layers)&&Kr(dn,ot,St,bn,Dn,Mn)}}function Kr(Se,ot,St,Ze,se,Dt){Se.onBeforeRender(L,ot,St,Ze,se,Dt),Se.modelViewMatrix.multiplyMatrices(St.matrixWorldInverse,Se.matrixWorld),Se.normalMatrix.getNormalMatrix(Se.modelViewMatrix),se.onBeforeRender(L,ot,St,Ze,Se,Dt),se.transparent===!0&&se.side===er&&se.forceSinglePass===!1?(se.side=Di,se.needsUpdate=!0,L.renderBufferDirect(St,ot,Ze,se,Se,Dt),se.side=Ac,se.needsUpdate=!0,L.renderBufferDirect(St,ot,Ze,se,Se,Dt),se.side=er):L.renderBufferDirect(St,ot,Ze,se,Se,Dt),Se.onAfterRender(L,ot,St,Ze,se,Dt)}function ka(Se,ot,St){ot.isScene!==!0&&(ot=ze);const Ze=le.get(Se),se=G.state.lights,Dt=G.state.shadowsArray,gn=se.state.version,dn=ht.getParameters(Se,se.state,Dt,ot,St),bn=ht.getProgramCacheKey(dn);let Mn=Ze.programs;Ze.environment=Se.isMeshStandardMaterial?ot.environment:null,Ze.fog=ot.fog,Ze.envMap=(Se.isMeshStandardMaterial?pt:tt).get(Se.envMap||Ze.environment),Ze.envMapRotation=Ze.environment!==null&&Se.envMap===null?ot.environmentRotation:Se.envMapRotation,Mn===void 0&&(Se.addEventListener("dispose",Gs),Mn=new Map,Ze.programs=Mn);let Dn=Mn.get(bn);if(Dn!==void 0){if(Ze.currentProgram===Dn&&Ze.lightsStateVersion===gn)return hr(Se,dn),Dn}else dn.uniforms=ht.getUniforms(Se),Se.onBeforeCompile(dn,L),Dn=ht.acquireProgram(dn,bn),Mn.set(bn,Dn),Ze.uniforms=dn.uniforms;const de=Ze.uniforms;return(!Se.isShaderMaterial&&!Se.isRawShaderMaterial||Se.clipping===!0)&&(de.clippingPlanes=Tt.uniform),hr(Se,dn),Ze.needsLights=Uo(Se),Ze.lightsStateVersion=gn,Ze.needsLights&&(de.ambientLightColor.value=se.state.ambient,de.lightProbe.value=se.state.probe,de.directionalLights.value=se.state.directional,de.directionalLightShadows.value=se.state.directionalShadow,de.spotLights.value=se.state.spot,de.spotLightShadows.value=se.state.spotShadow,de.rectAreaLights.value=se.state.rectArea,de.ltc_1.value=se.state.rectAreaLTC1,de.ltc_2.value=se.state.rectAreaLTC2,de.pointLights.value=se.state.point,de.pointLightShadows.value=se.state.pointShadow,de.hemisphereLights.value=se.state.hemi,de.directionalShadowMap.value=se.state.directionalShadowMap,de.directionalShadowMatrix.value=se.state.directionalShadowMatrix,de.spotShadowMap.value=se.state.spotShadowMap,de.spotLightMatrix.value=se.state.spotLightMatrix,de.spotLightMap.value=se.state.spotLightMap,de.pointShadowMap.value=se.state.pointShadowMap,de.pointShadowMatrix.value=se.state.pointShadowMatrix),Ze.currentProgram=Dn,Ze.uniformsList=null,Dn}function la(Se){if(Se.uniformsList===null){const ot=Se.currentProgram.getUniforms();Se.uniformsList=XC.seqWithValue(ot.seq,Se.uniforms)}return Se.uniformsList}function hr(Se,ot){const St=le.get(Se);St.outputColorSpace=ot.outputColorSpace,St.batching=ot.batching,St.batchingColor=ot.batchingColor,St.instancing=ot.instancing,St.instancingColor=ot.instancingColor,St.instancingMorph=ot.instancingMorph,St.skinning=ot.skinning,St.morphTargets=ot.morphTargets,St.morphNormals=ot.morphNormals,St.morphColors=ot.morphColors,St.morphTargetsCount=ot.morphTargetsCount,St.numClippingPlanes=ot.numClippingPlanes,St.numIntersection=ot.numClipIntersection,St.vertexAlphas=ot.vertexAlphas,St.vertexTangents=ot.vertexTangents,St.toneMapping=ot.toneMapping}function yo(Se,ot,St,Ze,se){ot.isScene!==!0&&(ot=ze),Ge.resetTextureUnits();const Dt=ot.fog,gn=Ze.isMeshStandardMaterial?ot.environment:null,dn=H===null?L.outputColorSpace:H.isXRRenderTarget===!0?H.texture.colorSpace:_m,bn=(Ze.isMeshStandardMaterial?pt:tt).get(Ze.envMap||gn),Mn=Ze.vertexColors===!0&&!!St.attributes.color&&St.attributes.color.itemSize===4,Dn=!!St.attributes.tangent&&(!!Ze.normalMap||Ze.anisotropy>0),de=!!St.morphAttributes.position,Bn=!!St.morphAttributes.normal,ja=!!St.morphAttributes.color;let ki=lo;Ze.toneMapped&&(H===null||H.isXRRenderTarget===!0)&&(ki=L.toneMapping);const Xn=St.morphAttributes.position||St.morphAttributes.normal||St.morphAttributes.color,Ya=Xn!==void 0?Xn.length:0,Pn=le.get(Ze),Fa=G.state.lights;if(Ie===!0&&(at===!0||Se!==ne)){const Ws=Se===ne&&Ze.id===X;Tt.setState(Ze,Se,Ws)}let ca=!1;Ze.version===Pn.__version?(Pn.needsLights&&Pn.lightsStateVersion!==Fa.state.version||Pn.outputColorSpace!==dn||se.isBatchedMesh&&Pn.batching===!1||!se.isBatchedMesh&&Pn.batching===!0||se.isBatchedMesh&&Pn.batchingColor===!0&&se.colorTexture===null||se.isBatchedMesh&&Pn.batchingColor===!1&&se.colorTexture!==null||se.isInstancedMesh&&Pn.instancing===!1||!se.isInstancedMesh&&Pn.instancing===!0||se.isSkinnedMesh&&Pn.skinning===!1||!se.isSkinnedMesh&&Pn.skinning===!0||se.isInstancedMesh&&Pn.instancingColor===!0&&se.instanceColor===null||se.isInstancedMesh&&Pn.instancingColor===!1&&se.instanceColor!==null||se.isInstancedMesh&&Pn.instancingMorph===!0&&se.morphTexture===null||se.isInstancedMesh&&Pn.instancingMorph===!1&&se.morphTexture!==null||Pn.envMap!==bn||Ze.fog===!0&&Pn.fog!==Dt||Pn.numClippingPlanes!==void 0&&(Pn.numClippingPlanes!==Tt.numPlanes||Pn.numIntersection!==Tt.numIntersection)||Pn.vertexAlphas!==Mn||Pn.vertexTangents!==Dn||Pn.morphTargets!==de||Pn.morphNormals!==Bn||Pn.morphColors!==ja||Pn.toneMapping!==ki||Pn.morphTargetsCount!==Ya)&&(ca=!0):(ca=!0,Pn.__version=Ze.version);let Is=Pn.currentProgram;ca===!0&&(Is=ka(Ze,ot,se));let Hs=!1,za=!1,Vo=!1;const pi=Is.getUniforms(),ps=Pn.uniforms;if(Mt.useProgram(Is.program)&&(Hs=!0,za=!0,Vo=!0),Ze.id!==X&&(X=Ze.id,za=!0),Hs||ne!==Se){Mt.buffers.depth.getReversed()&&Se.reversedDepth!==!0&&(Se._reversedDepth=!0,Se.updateProjectionMatrix()),pi.setValue(ve,"projectionMatrix",Se.projectionMatrix),pi.setValue(ve,"viewMatrix",Se.matrixWorldInverse);const Ls=pi.map.cameraPosition;Ls!==void 0&&Ls.setValue(ve,Ve.setFromMatrixPosition(Se.matrixWorld)),wt.logarithmicDepthBuffer&&pi.setValue(ve,"logDepthBufFC",2/(Math.log(Se.far+1)/Math.LN2)),(Ze.isMeshPhongMaterial||Ze.isMeshToonMaterial||Ze.isMeshLambertMaterial||Ze.isMeshBasicMaterial||Ze.isMeshStandardMaterial||Ze.isShaderMaterial)&&pi.setValue(ve,"isOrthographic",Se.isOrthographicCamera===!0),ne!==Se&&(ne=Se,za=!0,Vo=!0)}if(Pn.needsLights&&(Fa.state.directionalShadowMap.length>0&&pi.setValue(ve,"directionalShadowMap",Fa.state.directionalShadowMap,Ge),Fa.state.spotShadowMap.length>0&&pi.setValue(ve,"spotShadowMap",Fa.state.spotShadowMap,Ge),Fa.state.pointShadowMap.length>0&&pi.setValue(ve,"pointShadowMap",Fa.state.pointShadowMap,Ge)),se.isSkinnedMesh){pi.setOptional(ve,se,"bindMatrix"),pi.setOptional(ve,se,"bindMatrixInverse");const Ws=se.skeleton;Ws&&(Ws.boneTexture===null&&Ws.computeBoneTexture(),pi.setValue(ve,"boneTexture",Ws.boneTexture,Ge))}se.isBatchedMesh&&(pi.setOptional(ve,se,"batchingTexture"),pi.setValue(ve,"batchingTexture",se._matricesTexture,Ge),pi.setOptional(ve,se,"batchingIdTexture"),pi.setValue(ve,"batchingIdTexture",se._indirectTexture,Ge),pi.setOptional(ve,se,"batchingColorTexture"),se._colorsTexture!==null&&pi.setValue(ve,"batchingColorTexture",se._colorsTexture,Ge));const Ci=St.morphAttributes;if((Ci.position!==void 0||Ci.normal!==void 0||Ci.color!==void 0)&&Tn.update(se,St,Is),(za||Pn.receiveShadow!==se.receiveShadow)&&(Pn.receiveShadow=se.receiveShadow,pi.setValue(ve,"receiveShadow",se.receiveShadow)),Ze.isMeshGouraudMaterial&&Ze.envMap!==null&&(ps.envMap.value=bn,ps.flipEnvMap.value=bn.isCubeTexture&&bn.isRenderTargetTexture===!1?-1:1),Ze.isMeshStandardMaterial&&Ze.envMap===null&&ot.environment!==null&&(ps.envMapIntensity.value=ot.environmentIntensity),ps.dfgLUT!==void 0&&(ps.dfgLUT.value=X4e()),za&&(pi.setValue(ve,"toneMappingExposure",L.toneMappingExposure),Pn.needsLights&&ah(ps,Vo),Dt&&Ze.fog===!0&&Qe.refreshFogUniforms(ps,Dt),Qe.refreshMaterialUniforms(ps,Ze,be,Ae,G.state.transmissionRenderTarget[Se.id]),XC.upload(ve,la(Pn),ps,Ge)),Ze.isShaderMaterial&&Ze.uniformsNeedUpdate===!0&&(XC.upload(ve,la(Pn),ps,Ge),Ze.uniformsNeedUpdate=!1),Ze.isSpriteMaterial&&pi.setValue(ve,"center",se.center),pi.setValue(ve,"modelViewMatrix",se.modelViewMatrix),pi.setValue(ve,"normalMatrix",se.normalMatrix),pi.setValue(ve,"modelMatrix",se.matrixWorld),Ze.isShaderMaterial||Ze.isRawShaderMaterial){const Ws=Ze.uniformsGroups;for(let Ls=0,id=Ws.length;Ls<id;Ls++){const zo=Ws[Ls];zt.update(zo,Is),zt.bind(zo,Is)}}return Is}function ah(Se,ot){Se.ambientLightColor.needsUpdate=ot,Se.lightProbe.needsUpdate=ot,Se.directionalLights.needsUpdate=ot,Se.directionalLightShadows.needsUpdate=ot,Se.pointLights.needsUpdate=ot,Se.pointLightShadows.needsUpdate=ot,Se.spotLights.needsUpdate=ot,Se.spotLightShadows.needsUpdate=ot,Se.rectAreaLights.needsUpdate=ot,Se.hemisphereLights.needsUpdate=ot}function Uo(Se){return Se.isMeshLambertMaterial||Se.isMeshToonMaterial||Se.isMeshPhongMaterial||Se.isMeshStandardMaterial||Se.isShadowMaterial||Se.isShaderMaterial&&Se.lights===!0}this.getActiveCubeFace=function(){return q},this.getActiveMipmapLevel=function(){return K},this.getRenderTarget=function(){return H},this.setRenderTargetTextures=function(Se,ot,St){const Ze=le.get(Se);Ze.__autoAllocateDepthBuffer=Se.resolveDepthBuffer===!1,Ze.__autoAllocateDepthBuffer===!1&&(Ze.__useRenderToTexture=!1),le.get(Se.texture).__webglTexture=ot,le.get(Se.depthTexture).__webglTexture=Ze.__autoAllocateDepthBuffer?void 0:St,Ze.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(Se,ot){const St=le.get(Se);St.__webglFramebuffer=ot,St.__useDefaultFramebuffer=ot===void 0};const ts=ve.createFramebuffer();this.setRenderTarget=function(Se,ot=0,St=0){H=Se,q=ot,K=St;let Ze=null,se=!1,Dt=!1;if(Se){const dn=le.get(Se);if(dn.__useDefaultFramebuffer!==void 0){Mt.bindFramebuffer(ve.FRAMEBUFFER,dn.__webglFramebuffer),Q.copy(Se.viewport),Y.copy(Se.scissor),ue=Se.scissorTest,Mt.viewport(Q),Mt.scissor(Y),Mt.setScissorTest(ue),X=-1;return}else if(dn.__webglFramebuffer===void 0)Ge.setupRenderTarget(Se);else if(dn.__hasExternalTextures)Ge.rebindTextures(Se,le.get(Se.texture).__webglTexture,le.get(Se.depthTexture).__webglTexture);else if(Se.depthBuffer){const Dn=Se.depthTexture;if(dn.__boundDepthTexture!==Dn){if(Dn!==null&&le.has(Dn)&&(Se.width!==Dn.image.width||Se.height!==Dn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Ge.setupDepthRenderbuffer(Se)}}const bn=Se.texture;(bn.isData3DTexture||bn.isDataArrayTexture||bn.isCompressedArrayTexture)&&(Dt=!0);const Mn=le.get(Se).__webglFramebuffer;Se.isWebGLCubeRenderTarget?(Array.isArray(Mn[ot])?Ze=Mn[ot][St]:Ze=Mn[ot],se=!0):Se.samples>0&&Ge.useMultisampledRTT(Se)===!1?Ze=le.get(Se).__webglMultisampledFramebuffer:Array.isArray(Mn)?Ze=Mn[St]:Ze=Mn,Q.copy(Se.viewport),Y.copy(Se.scissor),ue=Se.scissorTest}else Q.copy(te).multiplyScalar(be).floor(),Y.copy(fe).multiplyScalar(be).floor(),ue=Le;if(St!==0&&(Ze=ts),Mt.bindFramebuffer(ve.FRAMEBUFFER,Ze)&&Mt.drawBuffers(Se,Ze),Mt.viewport(Q),Mt.scissor(Y),Mt.setScissorTest(ue),se){const dn=le.get(Se.texture);ve.framebufferTexture2D(ve.FRAMEBUFFER,ve.COLOR_ATTACHMENT0,ve.TEXTURE_CUBE_MAP_POSITIVE_X+ot,dn.__webglTexture,St)}else if(Dt){const dn=ot;for(let bn=0;bn<Se.textures.length;bn++){const Mn=le.get(Se.textures[bn]);ve.framebufferTextureLayer(ve.FRAMEBUFFER,ve.COLOR_ATTACHMENT0+bn,Mn.__webglTexture,St,dn)}}else if(Se!==null&&St!==0){const dn=le.get(Se.texture);ve.framebufferTexture2D(ve.FRAMEBUFFER,ve.COLOR_ATTACHMENT0,ve.TEXTURE_2D,dn.__webglTexture,St)}X=-1},this.readRenderTargetPixels=function(Se,ot,St,Ze,se,Dt,gn,dn=0){if(!(Se&&Se.isWebGLRenderTarget)){Rt("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let bn=le.get(Se).__webglFramebuffer;if(Se.isWebGLCubeRenderTarget&&gn!==void 0&&(bn=bn[gn]),bn){Mt.bindFramebuffer(ve.FRAMEBUFFER,bn);try{const Mn=Se.textures[dn],Dn=Mn.format,de=Mn.type;if(!wt.textureFormatReadable(Dn)){Rt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!wt.textureTypeReadable(de)){Rt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ot>=0&&ot<=Se.width-Ze&&St>=0&&St<=Se.height-se&&(Se.textures.length>1&&ve.readBuffer(ve.COLOR_ATTACHMENT0+dn),ve.readPixels(ot,St,Ze,se,Ht.convert(Dn),Ht.convert(de),Dt))}finally{const Mn=H!==null?le.get(H).__webglFramebuffer:null;Mt.bindFramebuffer(ve.FRAMEBUFFER,Mn)}}},this.readRenderTargetPixelsAsync=async function(Se,ot,St,Ze,se,Dt,gn,dn=0){if(!(Se&&Se.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let bn=le.get(Se).__webglFramebuffer;if(Se.isWebGLCubeRenderTarget&&gn!==void 0&&(bn=bn[gn]),bn)if(ot>=0&&ot<=Se.width-Ze&&St>=0&&St<=Se.height-se){Mt.bindFramebuffer(ve.FRAMEBUFFER,bn);const Mn=Se.textures[dn],Dn=Mn.format,de=Mn.type;if(!wt.textureFormatReadable(Dn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!wt.textureTypeReadable(de))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Bn=ve.createBuffer();ve.bindBuffer(ve.PIXEL_PACK_BUFFER,Bn),ve.bufferData(ve.PIXEL_PACK_BUFFER,Dt.byteLength,ve.STREAM_READ),Se.textures.length>1&&ve.readBuffer(ve.COLOR_ATTACHMENT0+dn),ve.readPixels(ot,St,Ze,se,Ht.convert(Dn),Ht.convert(de),0);const ja=H!==null?le.get(H).__webglFramebuffer:null;Mt.bindFramebuffer(ve.FRAMEBUFFER,ja);const ki=ve.fenceSync(ve.SYNC_GPU_COMMANDS_COMPLETE,0);return ve.flush(),await hEe(ve,ki,4),ve.bindBuffer(ve.PIXEL_PACK_BUFFER,Bn),ve.getBufferSubData(ve.PIXEL_PACK_BUFFER,0,Dt),ve.deleteBuffer(Bn),ve.deleteSync(ki),Dt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(Se,ot=null,St=0){const Ze=Math.pow(2,-St),se=Math.floor(Se.image.width*Ze),Dt=Math.floor(Se.image.height*Ze),gn=ot!==null?ot.x:0,dn=ot!==null?ot.y:0;Ge.setTexture2D(Se,0),ve.copyTexSubImage2D(ve.TEXTURE_2D,St,0,0,gn,dn,se,Dt),Mt.unbindTexture()};const qs=ve.createFramebuffer(),Ps=ve.createFramebuffer();this.copyTextureToTexture=function(Se,ot,St=null,Ze=null,se=0,Dt=null){Dt===null&&(se!==0?(ji("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Dt=se,se=0):Dt=0);let gn,dn,bn,Mn,Dn,de,Bn,ja,ki;const Xn=Se.isCompressedTexture?Se.mipmaps[Dt]:Se.image;if(St!==null)gn=St.max.x-St.min.x,dn=St.max.y-St.min.y,bn=St.isBox3?St.max.z-St.min.z:1,Mn=St.min.x,Dn=St.min.y,de=St.isBox3?St.min.z:0;else{const Ci=Math.pow(2,-se);gn=Math.floor(Xn.width*Ci),dn=Math.floor(Xn.height*Ci),Se.isDataArrayTexture?bn=Xn.depth:Se.isData3DTexture?bn=Math.floor(Xn.depth*Ci):bn=1,Mn=0,Dn=0,de=0}Ze!==null?(Bn=Ze.x,ja=Ze.y,ki=Ze.z):(Bn=0,ja=0,ki=0);const Ya=Ht.convert(ot.format),Pn=Ht.convert(ot.type);let Fa;ot.isData3DTexture?(Ge.setTexture3D(ot,0),Fa=ve.TEXTURE_3D):ot.isDataArrayTexture||ot.isCompressedArrayTexture?(Ge.setTexture2DArray(ot,0),Fa=ve.TEXTURE_2D_ARRAY):(Ge.setTexture2D(ot,0),Fa=ve.TEXTURE_2D),ve.pixelStorei(ve.UNPACK_FLIP_Y_WEBGL,ot.flipY),ve.pixelStorei(ve.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ot.premultiplyAlpha),ve.pixelStorei(ve.UNPACK_ALIGNMENT,ot.unpackAlignment);const ca=ve.getParameter(ve.UNPACK_ROW_LENGTH),Is=ve.getParameter(ve.UNPACK_IMAGE_HEIGHT),Hs=ve.getParameter(ve.UNPACK_SKIP_PIXELS),za=ve.getParameter(ve.UNPACK_SKIP_ROWS),Vo=ve.getParameter(ve.UNPACK_SKIP_IMAGES);ve.pixelStorei(ve.UNPACK_ROW_LENGTH,Xn.width),ve.pixelStorei(ve.UNPACK_IMAGE_HEIGHT,Xn.height),ve.pixelStorei(ve.UNPACK_SKIP_PIXELS,Mn),ve.pixelStorei(ve.UNPACK_SKIP_ROWS,Dn),ve.pixelStorei(ve.UNPACK_SKIP_IMAGES,de);const pi=Se.isDataArrayTexture||Se.isData3DTexture,ps=ot.isDataArrayTexture||ot.isData3DTexture;if(Se.isDepthTexture){const Ci=le.get(Se),Ws=le.get(ot),Ls=le.get(Ci.__renderTarget),id=le.get(Ws.__renderTarget);Mt.bindFramebuffer(ve.READ_FRAMEBUFFER,Ls.__webglFramebuffer),Mt.bindFramebuffer(ve.DRAW_FRAMEBUFFER,id.__webglFramebuffer);for(let zo=0;zo<bn;zo++)pi&&(ve.framebufferTextureLayer(ve.READ_FRAMEBUFFER,ve.COLOR_ATTACHMENT0,le.get(Se).__webglTexture,se,de+zo),ve.framebufferTextureLayer(ve.DRAW_FRAMEBUFFER,ve.COLOR_ATTACHMENT0,le.get(ot).__webglTexture,Dt,ki+zo)),ve.blitFramebuffer(Mn,Dn,gn,dn,Bn,ja,gn,dn,ve.DEPTH_BUFFER_BIT,ve.NEAREST);Mt.bindFramebuffer(ve.READ_FRAMEBUFFER,null),Mt.bindFramebuffer(ve.DRAW_FRAMEBUFFER,null)}else if(se!==0||Se.isRenderTargetTexture||le.has(Se)){const Ci=le.get(Se),Ws=le.get(ot);Mt.bindFramebuffer(ve.READ_FRAMEBUFFER,qs),Mt.bindFramebuffer(ve.DRAW_FRAMEBUFFER,Ps);for(let Ls=0;Ls<bn;Ls++)pi?ve.framebufferTextureLayer(ve.READ_FRAMEBUFFER,ve.COLOR_ATTACHMENT0,Ci.__webglTexture,se,de+Ls):ve.framebufferTexture2D(ve.READ_FRAMEBUFFER,ve.COLOR_ATTACHMENT0,ve.TEXTURE_2D,Ci.__webglTexture,se),ps?ve.framebufferTextureLayer(ve.DRAW_FRAMEBUFFER,ve.COLOR_ATTACHMENT0,Ws.__webglTexture,Dt,ki+Ls):ve.framebufferTexture2D(ve.DRAW_FRAMEBUFFER,ve.COLOR_ATTACHMENT0,ve.TEXTURE_2D,Ws.__webglTexture,Dt),se!==0?ve.blitFramebuffer(Mn,Dn,gn,dn,Bn,ja,gn,dn,ve.COLOR_BUFFER_BIT,ve.NEAREST):ps?ve.copyTexSubImage3D(Fa,Dt,Bn,ja,ki+Ls,Mn,Dn,gn,dn):ve.copyTexSubImage2D(Fa,Dt,Bn,ja,Mn,Dn,gn,dn);Mt.bindFramebuffer(ve.READ_FRAMEBUFFER,null),Mt.bindFramebuffer(ve.DRAW_FRAMEBUFFER,null)}else ps?Se.isDataTexture||Se.isData3DTexture?ve.texSubImage3D(Fa,Dt,Bn,ja,ki,gn,dn,bn,Ya,Pn,Xn.data):ot.isCompressedArrayTexture?ve.compressedTexSubImage3D(Fa,Dt,Bn,ja,ki,gn,dn,bn,Ya,Xn.data):ve.texSubImage3D(Fa,Dt,Bn,ja,ki,gn,dn,bn,Ya,Pn,Xn):Se.isDataTexture?ve.texSubImage2D(ve.TEXTURE_2D,Dt,Bn,ja,gn,dn,Ya,Pn,Xn.data):Se.isCompressedTexture?ve.compressedTexSubImage2D(ve.TEXTURE_2D,Dt,Bn,ja,Xn.width,Xn.height,Ya,Xn.data):ve.texSubImage2D(ve.TEXTURE_2D,Dt,Bn,ja,gn,dn,Ya,Pn,Xn);ve.pixelStorei(ve.UNPACK_ROW_LENGTH,ca),ve.pixelStorei(ve.UNPACK_IMAGE_HEIGHT,Is),ve.pixelStorei(ve.UNPACK_SKIP_PIXELS,Hs),ve.pixelStorei(ve.UNPACK_SKIP_ROWS,za),ve.pixelStorei(ve.UNPACK_SKIP_IMAGES,Vo),Dt===0&&ot.generateMipmaps&&ve.generateMipmap(Fa),Mt.unbindTexture()},this.initRenderTarget=function(Se){le.get(Se).__webglFramebuffer===void 0&&Ge.setupRenderTarget(Se)},this.initTexture=function(Se){Se.isCubeTexture?Ge.setTextureCube(Se,0):Se.isData3DTexture?Ge.setTexture3D(Se,0):Se.isDataArrayTexture||Se.isCompressedArrayTexture?Ge.setTexture2DArray(Se,0):Ge.setTexture2D(Se,0),Mt.unbindTexture()},this.resetState=function(){q=0,K=0,H=null,Mt.reset(),$t.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ro}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=Vn._getDrawingBufferColorSpace(e),n.unpackColorSpace=Vn._getUnpackColorSpace()}}const net=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:FP,AddEquation:Co,AddOperation:QF,AdditiveAnimationBlendMode:ZF,AdditiveBlending:xy,AgXToneMapping:jP,AlphaFormat:UP,AlwaysCompare:WP,AlwaysDepth:$_,AlwaysStencilFunc:CN,AmbientLight:y4,AnimationAction:Xee,AnimationClip:KS,AnimationLoader:ZMe,AnimationMixer:MCe,AnimationObjectGroup:wCe,AnimationUtils:YMe,ArcCurve:Dee,ArrayCamera:Uj,ArrowHelper:QCe,AttachedBindMode:wk,Audio:Kee,AudioAnalyser:mCe,AudioContext:Bj,AudioListener:hCe,AudioLoader:cCe,AxesHelper:JCe,BackSide:Di,BasicDepthPacking:ree,BasicShadowMap:WZ,BatchedMesh:Ree,Bone:oj,BooleanKeyframeTrack:f1,Box2:OCe,Box3:Mr,Box3Helper:YCe,BoxGeometry:Yf,BoxHelper:KCe,BufferAttribute:Ua,BufferGeometry:zn,BufferGeometryLoader:$ee,ByteType:e0,Cache:Wh,Camera:u1,CameraHelper:$Ce,CanvasTexture:yMe,CapsuleGeometry:i4,CatmullRomCurve3:kee,CineonToneMapping:OP,CircleGeometry:Gx,ClampToEdgeWrapping:Ur,Clock:_4,Color:on,ColorKeyframeTrack:Rj,ColorManagement:Vn,CompressedArrayTexture:gMe,CompressedCubeTexture:AMe,CompressedTexture:a4,CompressedTextureLoader:eCe,ConeGeometry:ZT,ConstantAlphaFactor:XZ,ConstantColorFactor:KZ,Controls:x4,CubeCamera:rj,CubeDepthTexture:cj,CubeReflectionMapping:xc,CubeRefractionMapping:Wu,CubeTexture:M0,CubeTextureLoader:tCe,CubeUVReflectionMapping:Am,CubicBezierCurve:hj,CubicBezierCurve3:fj,CubicInterpolant:Gee,CullFaceBack:TN,CullFaceFront:$F,CullFaceFrontBack:Wwe,CullFaceNone:WF,Curve:ed,CurvePath:Fee,CustomBlending:QA,CustomToneMapping:JF,CylinderGeometry:d1,Cylindrical:kCe,Data3DTexture:$P,DataArrayTexture:YT,DataTexture:cu,DataTextureLoader:nCe,DataUtils:GEe,DecrementStencilOp:dee,DecrementWrapStencilOp:fee,DefaultLoadingManager:Wee,DepthFormat:ho,DepthStencilFormat:rl,DepthTexture:Do,DetachedBindMode:JZ,DirectionalLight:A4,DirectionalLightHelper:WCe,DiscreteInterpolant:qee,DodecahedronGeometry:s4,DoubleSide:er,DstAlphaFactor:NP,DstColorFactor:PP,DynamicCopyUsage:iEe,DynamicDrawUsage:Bg,DynamicReadUsage:tEe,EdgesGeometry:Lee,EllipseCurve:r4,EqualCompare:GP,EqualDepth:Y_,EqualStencilFunc:Aee,EquirectangularReflectionMapping:d0,EquirectangularRefractionMapping:h0,Euler:fo,EventDispatcher:Cc,ExternalTexture:uj,ExtrudeGeometry:ew,FileLoader:xm,Float16BufferAttribute:sj,Float32BufferAttribute:mn,FloatType:ls,Fog:ZP,FogExp2:JP,FramebufferTexture:n4,FrontSide:Ac,Frustum:C0,FrustumArray:QT,GLBufferAttribute:ICe,GLSL1:rEe,GLSL3:Mk,GreaterCompare:qP,GreaterDepth:Q_,GreaterEqualCompare:Ux,GreaterEqualDepth:X_,GreaterEqualStencilFunc:xee,GreaterStencilFunc:vee,GridHelper:qCe,Group:ll,HalfFloatType:cs,HemisphereLight:Ij,HemisphereLightHelper:GCe,IcosahedronGeometry:o4,ImageBitmapLoader:lCe,ImageLoader:YS,ImageUtils:bee,IncrementStencilOp:uee,IncrementWrapStencilOp:hee,InstancedBufferAttribute:_c,InstancedBufferGeometry:jj,InstancedInterleavedBuffer:XS,InstancedMesh:Nee,Int16BufferAttribute:KEe,Int32BufferAttribute:YEe,Int8BufferAttribute:HEe,IntType:jr,InterleavedBuffer:zx,InterleavedBufferAttribute:kl,Interpolant:aw,InterpolateDiscrete:US,InterpolateLinear:MN,InterpolateSmooth:KC,InterpolationSamplingMode:lEe,InterpolationSamplingType:oEe,InvertStencilOp:pee,KeepStencilOp:Tg,KeyframeTrack:td,LOD:Mee,LatheGeometry:l4,Layers:KP,LessCompare:jx,LessDepth:K_,LessEqualCompare:Bx,LessEqualDepth:gm,LessEqualStencilFunc:yee,LessStencilFunc:gee,Light:R0,LightProbe:Fj,Line:Kd,Line3:Zee,LineBasicMaterial:Hr,LineCurve:pj,LineCurve3:Oee,LineDashedMaterial:Mj,LineLoop:Pee,LineSegments:Zu,LinearFilter:di,LinearInterpolant:Nj,LinearMipMapLinearFilter:ZZ,LinearMipMapNearestFilter:Ywe,LinearMipmapLinearFilter:No,LinearMipmapNearestFilter:Zg,LinearSRGBColorSpace:_m,LinearToneMapping:DP,LinearTransfer:Ky,Loader:Nc,LoaderUtils:Ik,LoadingManager:Pj,LoopOnce:tee,LoopPingPong:aee,LoopRepeat:nee,MOUSE:ou,Material:po,MaterialLoader:v4,MathUtils:Xy,Matrix2:rw,Matrix3:ga,Matrix4:_n,MaxEquation:YF,Mesh:Na,MeshBasicMaterial:oo,MeshDepthMaterial:Tj,MeshDistanceMaterial:wj,MeshLambertMaterial:nh,MeshMatcapMaterial:Ej,MeshNormalMaterial:Sj,MeshPhongMaterial:m4,MeshPhysicalMaterial:xj,MeshStandardMaterial:p4,MeshToonMaterial:bj,MinEquation:KF,MirroredRepeatWrapping:vm,MixOperation:XF,MultiplyBlending:Sy,MultiplyOperation:Ox,NearestFilter:Mi,NearestMipMapLinearFilter:Kwe,NearestMipMapNearestFilter:$we,NearestMipmapLinearFilter:Od,NearestMipmapNearestFilter:qT,NeutralToneMapping:BP,NeverCompare:zP,NeverDepth:W_,NeverStencilFunc:mee,NoBlending:hl,NoColorSpace:Il,NoNormalPacking:YC,NoToneMapping:lo,NormalAnimationBlendMode:VP,NormalBlending:fl,NormalGAPacking:oee,NormalRGPacking:tj,NotEqualCompare:HP,NotEqualDepth:J_,NotEqualStencilFunc:_ee,NumberKeyframeTrack:WS,Object3D:ni,ObjectLoader:rCe,ObjectSpaceNormalMap:ej,OctahedronGeometry:tw,OneFactor:EP,OneMinusConstantAlphaFactor:QZ,OneMinusConstantColorFactor:YZ,OneMinusDstAlphaFactor:RP,OneMinusDstColorFactor:IP,OneMinusSrcAlphaFactor:H_,OneMinusSrcColorFactor:CP,OrthographicCamera:P0,PCFShadowMap:b_,PCFSoftShadowMap:$Z,PMREMGenerator:kk,Path:IN,PerspectiveCamera:Zs,Plane:Nd,PlaneGeometry:h1,PlaneHelper:XCe,PointLight:Dj,PointLightHelper:VCe,Points:lj,PointsMaterial:JT,PolarGridHelper:HCe,PolyhedronGeometry:N0,PositionalAudio:pCe,PropertyBinding:_i,PropertyMixer:Yee,QuadraticBezierCurve:mj,QuadraticBezierCurve3:gj,Quaternion:Er,QuaternionKeyframeTrack:iw,QuaternionLinearInterpolant:Hee,R11_EAC_Format:My,RED_GREEN_RGTC2_Format:p0,RED_RGTC1_Format:Hy,REVISION:w0,RG11_EAC_Format:f0,RGBADepthPacking:Xwe,RGBAFormat:fs,RGBAIntegerFormat:l1,RGBA_ASTC_10x10_Format:Vy,RGBA_ASTC_10x5_Format:jy,RGBA_ASTC_10x6_Format:By,RGBA_ASTC_10x8_Format:Uy,RGBA_ASTC_12x10_Format:zy,RGBA_ASTC_12x12_Format:Gy,RGBA_ASTC_4x4_Format:Ry,RGBA_ASTC_5x4_Format:Py,RGBA_ASTC_5x5_Format:Iy,RGBA_ASTC_6x5_Format:Ly,RGBA_ASTC_6x6_Format:Dy,RGBA_ASTC_8x5_Format:ky,RGBA_ASTC_8x6_Format:Oy,RGBA_ASTC_8x8_Format:Fy,RGBA_BPTC_Format:qy,RGBA_ETC2_EAC_Format:Ey,RGBA_PVRTC_2BPPV1_Format:nx,RGBA_PVRTC_4BPPV1_Format:tx,RGBA_S3TC_DXT1_Format:Jp,RGBA_S3TC_DXT3_Format:Zp,RGBA_S3TC_DXT5_Format:em,RGBDepthPacking:Qwe,RGBFormat:Fx,RGBIntegerFormat:eee,RGB_BPTC_SIGNED_Format:wN,RGB_BPTC_UNSIGNED_Format:EN,RGB_ETC1_Format:Ty,RGB_ETC2_Format:wy,RGB_PVRTC_2BPPV1_Format:ex,RGB_PVRTC_4BPPV1_Format:Z_,RGB_S3TC_DXT1_Format:Qp,RGDepthPacking:Jwe,RGFormat:ol,RGIntegerFormat:o1,RawShaderMaterial:_j,Ray:c1,Raycaster:Jee,RectAreaLight:kj,RedFormat:r1,RedIntegerFormat:E0,ReinhardToneMapping:kP,RenderTarget:th,RenderTarget3D:CCe,RepeatWrapping:ym,ReplaceStencilOp:cee,ReverseSubtractEquation:wP,RingGeometry:c4,SIGNED_R11_EAC_Format:Cy,SIGNED_RED_GREEN_RGTC2_Format:$y,SIGNED_RED_RGTC1_Format:Wy,SIGNED_RG11_EAC_Format:Ny,SRGBColorSpace:Fr,SRGBTransfer:An,Scene:Vx,ShaderChunk:_a,ShaderLib:El,ShaderMaterial:mo,ShadowMaterial:vj,Shape:ZA,ShapeGeometry:u4,ShapePath:tte,ShapeUtils:jd,ShortType:t0,Skeleton:t4,SkeletonHelper:UCe,SkinnedMesh:Cee,Source:Ug,Sphere:Cr,SphereGeometry:vu,Spherical:Dk,SphericalHarmonics3:Oj,SplineCurve:Aj,SpotLight:sw,SpotLightHelper:BCe,Sprite:Eee,SpriteMaterial:e4,SrcAlphaFactor:q_,SrcAlphaSaturateFactor:LP,SrcColorFactor:MP,StaticCopyUsage:aEe,StaticDrawUsage:m0,StaticReadUsage:eEe,StereoCamera:uCe,StreamCopyUsage:sEe,StreamDrawUsage:Zwe,StreamReadUsage:nEe,StringKeyframeTrack:p1,SubtractEquation:TP,SubtractiveBlending:by,TOUCH:UA,TangentSpaceNormalMap:qd,TetrahedronGeometry:d4,Texture:_s,TextureLoader:g4,TextureUtils:a3e,Timer:LCe,TimestampQuery:Fd,TorusGeometry:h4,TorusKnotGeometry:f4,Triangle:uc,TriangleFanDrawMode:Ek,TriangleStripDrawMode:see,TrianglesDrawMode:iee,TubeGeometry:nw,UVMapping:GT,Uint16BufferAttribute:YP,Uint32BufferAttribute:XP,Uint8BufferAttribute:WEe,Uint8ClampedBufferAttribute:$Ee,Uniform:NCe,UniformsGroup:PCe,UniformsLib:hn,UniformsUtils:XT,UnsignedByteType:os,UnsignedInt101111Type:KT,UnsignedInt248Type:yc,UnsignedInt5999Type:$T,UnsignedIntType:Ei,UnsignedShort4444Type:HT,UnsignedShort5551Type:WT,UnsignedShortType:Bu,VSMShadowMap:Hh,Vector2:Nt,Vector3:ye,Vector4:qn,VectorKeyframeTrack:$S,VideoFrameTexture:mMe,VideoTexture:Iee,WebGL3DRenderTarget:LEe,WebGLArrayRenderTarget:IEe,WebGLCoordinateSystem:Ro,WebGLCubeRenderTarget:QP,WebGLRenderTarget:vc,WebGLRenderer:lte,WebGLUtils:ote,WebGPUCoordinateSystem:bc,WebXRController:lS,WireframeGeometry:yj,WrapAroundEnding:VS,ZeroCurvatureEnding:VA,ZeroFactor:Oh,ZeroSlopeEnding:zA,ZeroStencilOp:lee,createCanvasElement:aj,error:Rt,getConsoleFunction:dEe,log:ix,setConsoleFunction:uEe,warn:yt,warnOnce:ji},Symbol.toStringTag,{value:"Module"}));class Q4e extends ni{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Nt(.5,.5),this.addEventListener("removed",function(){this.traverse(function(n){n.element&&n.element instanceof n.element.ownerDocument.defaultView.Element&&n.element.parentNode!==null&&n.element.remove()})})}copy(e,n){return super.copy(e,n),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const Ev=new ye,pW=new _n,mW=new _n,gW=new ye,AW=new ye;class J4e{constructor(e={}){const n=this;let i,s,r,o;const l={objects:new WeakMap},c=e.element!==void 0?e.element:document.createElement("div");c.style.overflow="hidden",this.domElement=c,this.sortObjects=!0,this.getSize=function(){return{width:i,height:s}},this.render=function(x,T){x.matrixWorldAutoUpdate===!0&&x.updateMatrixWorld(),T.parent===null&&T.matrixWorldAutoUpdate===!0&&T.updateMatrixWorld(),pW.copy(T.matrixWorldInverse),mW.multiplyMatrices(T.projectionMatrix,pW),h(x,x,T),this.sortObjects&&A(x)},this.setSize=function(x,T){i=x,s=T,r=i/2,o=s/2,c.style.width=x+"px",c.style.height=T+"px"};function u(x){x.isCSS2DObject&&(x.element.style.display="none");for(let T=0,E=x.children.length;T<E;T++)u(x.children[T])}function h(x,T,E){if(x.visible===!1){u(x);return}if(x.isCSS2DObject){Ev.setFromMatrixPosition(x.matrixWorld),Ev.applyMatrix4(mW);const M=Ev.z>=-1&&Ev.z<=1&&x.layers.test(E.layers)===!0,N=x.element;N.style.display=M===!0?"":"none",M===!0&&(x.onBeforeRender(n,T,E),N.style.transform="translate("+-100*x.center.x+"%,"+-100*x.center.y+"%)translate("+(Ev.x*r+r)+"px,"+(-Ev.y*o+o)+"px)",N.parentNode!==c&&c.appendChild(N),x.onAfterRender(n,T,E));const I={distanceToCameraSquared:f(E,x)};l.objects.set(x,I)}for(let M=0,N=x.children.length;M<N;M++)h(x.children[M],T,E)}function f(x,T){return gW.setFromMatrixPosition(x.matrixWorld),AW.setFromMatrixPosition(T.matrixWorld),gW.distanceToSquared(AW)}function m(x){const T=[];return x.traverseVisible(function(E){E.isCSS2DObject&&T.push(E)}),T}function A(x){const T=m(x).sort(function(M,N){if(M.renderOrder!==N.renderOrder)return N.renderOrder-M.renderOrder;const I=l.objects.get(M).distanceToCameraSquared,F=l.objects.get(N).distanceToCameraSquared;return I-F}),E=T.length;for(let M=0,N=T.length;M<N;M++)T[M].element.style.zIndex=E-M}}}function jk(a){var e=typeof a;return a!=null&&(e=="object"||e=="function")}var Z4e=typeof global=="object"&&global&&global.Object===Object&&global,eIe=typeof self=="object"&&self&&self.Object===Object&&self,cte=Z4e||eIe||Function("return this")(),l5=function(){return cte.Date.now()},tIe=/\s/;function nIe(a){for(var e=a.length;e--&&tIe.test(a.charAt(e)););return e}var aIe=/^\s+/;function iIe(a){return a&&a.slice(0,nIe(a)+1).replace(aIe,"")}var DN=cte.Symbol,ute=Object.prototype,sIe=ute.hasOwnProperty,rIe=ute.toString,a2=DN?DN.toStringTag:void 0;function oIe(a){var e=sIe.call(a,a2),n=a[a2];try{a[a2]=void 0;var i=!0}catch{}var s=rIe.call(a);return i&&(e?a[a2]=n:delete a[a2]),s}var lIe=Object.prototype,cIe=lIe.toString;function uIe(a){return cIe.call(a)}var dIe="[object Null]",hIe="[object Undefined]",yW=DN?DN.toStringTag:void 0;function fIe(a){return a==null?a===void 0?hIe:dIe:yW&&yW in Object(a)?oIe(a):uIe(a)}function pIe(a){return a!=null&&typeof a=="object"}var mIe="[object Symbol]";function gIe(a){return typeof a=="symbol"||pIe(a)&&fIe(a)==mIe}var vW=NaN,AIe=/^[-+]0x[0-9a-f]+$/i,yIe=/^0b[01]+$/i,vIe=/^0o[0-7]+$/i,_Ie=parseInt;function _W(a){if(typeof a=="number")return a;if(gIe(a))return vW;if(jk(a)){var e=typeof a.valueOf=="function"?a.valueOf():a;a=jk(e)?e+"":e}if(typeof a!="string")return a===0?a:+a;a=iIe(a);var n=yIe.test(a);return n||vIe.test(a)?_Ie(a.slice(2),n?2:8):AIe.test(a)?vW:+a}var xIe="Expected a function",bIe=Math.max,SIe=Math.min;function TIe(a,e,n){var i,s,r,o,l,c,u=0,h=!1,f=!1,m=!0;if(typeof a!="function")throw new TypeError(xIe);e=_W(e)||0,jk(n)&&(h=!!n.leading,f="maxWait"in n,r=f?bIe(_W(n.maxWait)||0,e):r,m="trailing"in n?!!n.trailing:m);function A(O){var D=i,j=s;return i=s=void 0,u=O,o=a.apply(j,D),o}function x(O){return u=O,l=setTimeout(M,e),h?A(O):o}function T(O){var D=O-c,j=O-u,L=e-D;return f?SIe(L,r-j):L}function E(O){var D=O-c,j=O-u;return c===void 0||D>=e||D<0||f&&j>=r}function M(){var O=l5();if(E(O))return N(O);l=setTimeout(M,T(O))}function N(O){return l=void 0,m&&i?A(O):(i=s=void 0,o)}function I(){l!==void 0&&clearTimeout(l),u=0,i=c=s=l=void 0}function F(){return l===void 0?o:N(l5())}function G(){var O=l5(),D=E(O);if(i=arguments,s=this,c=O,D){if(l===void 0)return x(c);if(f)return clearTimeout(l),l=setTimeout(M,e),A(c)}return l===void 0&&(l=setTimeout(M,e)),o}return G.cancel=I,G.flush=F,G}function xW(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=Array(e);n<e;n++)i[n]=a[n];return i}function wIe(a){if(Array.isArray(a))return a}function EIe(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function MIe(a,e,n){return Object.defineProperty(a,"prototype",{writable:!1}),a}function CIe(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i,s,r,o,l=[],c=!0,u=!1;try{if(r=(n=n.call(a)).next,e!==0)for(;!(c=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function NIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RIe(a,e){return wIe(a)||CIe(a,e)||PIe(a,e)||NIe()}function PIe(a,e){if(a){if(typeof a=="string")return xW(a,e);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xW(a,e):void 0}}var IIe=MIe(function a(e,n){var i=n.default,s=i===void 0?null:i,r=n.triggerUpdate,o=r===void 0?!0:r,l=n.onChange,c=l===void 0?function(u,h){}:l;EIe(this,a),this.name=e,this.defaultVal=s,this.triggerUpdate=o,this.onChange=c});function Wr(a){var e=a.stateInit,n=e===void 0?function(){return{}}:e,i=a.props,s=i===void 0?{}:i,r=a.methods,o=r===void 0?{}:r,l=a.aliases,c=l===void 0?{}:l,u=a.init,h=u===void 0?function(){}:u,f=a.update,m=f===void 0?function(){}:f,A=Object.keys(s).map(function(x){return new IIe(x,s[x])});return function x(){for(var T=arguments.length,E=new Array(T),M=0;M<T;M++)E[M]=arguments[M];var N=!!(this instanceof x&&this.constructor),I=N?E.shift():void 0,F=E[0],G=F===void 0?{}:F,O=Object.assign({},n instanceof Function?n(G):n,{initialised:!1}),D={};function j(q){return L(q,G),U(),j}var L=function(K,H){h.call(j,K,O,H),O.initialised=!0},U=TIe(function(){O.initialised&&(m.call(j,O,D),D={})},1);return A.forEach(function(q){j[q.name]=K(q);function K(H){var X=H.name,ne=H.triggerUpdate,Q=ne===void 0?!1:ne,Y=H.onChange,ue=Y===void 0?function(oe,Ae){}:Y,pe=H.defaultVal,Ee=pe===void 0?null:pe;return function(oe){var Ae=O[X];if(!arguments.length)return Ae;var be=oe===void 0?Ee:oe;return O[X]=be,ue.call(j,be,O,Ae),!D.hasOwnProperty(X)&&(D[X]=Ae),Q&&U(),j}}}),Object.keys(o).forEach(function(q){j[q]=function(){for(var K,H=arguments.length,X=new Array(H),ne=0;ne<H;ne++)X[ne]=arguments[ne];return(K=o[q]).call.apply(K,[j,O].concat(X))}}),Object.entries(c).forEach(function(q){var K=RIe(q,2),H=K[0],X=K[1];return j[H]=j[X]}),j.resetProps=function(){return A.forEach(function(q){j[q.name](q.defaultVal)}),j},j.resetProps(),O._rerender=U,N&&I&&j(I),j}}var Nr=Object.freeze({Linear:Object.freeze({None:function(a){return a},In:function(a){return a},Out:function(a){return a},InOut:function(a){return a}}),Quadratic:Object.freeze({In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return(a*=2)<1?.5*a*a:-.5*(--a*(a-2)-1)}}),Cubic:Object.freeze({In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a:.5*((a-=2)*a*a+2)}}),Quartic:Object.freeze({In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return(a*=2)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}}),Quintic:Object.freeze({In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}}),Sinusoidal:Object.freeze({In:function(a){return 1-Math.sin((1-a)*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return .5*(1-Math.sin(Math.PI*(.5-a)))}}),Exponential:Object.freeze({In:function(a){return a===0?0:Math.pow(1024,a-1)},Out:function(a){return a===1?1:1-Math.pow(2,-10*a)},InOut:function(a){return a===0?0:a===1?1:(a*=2)<1?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}}),Circular:Object.freeze({In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return(a*=2)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}}),Elastic:Object.freeze({In:function(a){return a===0?0:a===1?1:-Math.pow(2,10*(a-1))*Math.sin((a-1.1)*5*Math.PI)},Out:function(a){return a===0?0:a===1?1:Math.pow(2,-10*a)*Math.sin((a-.1)*5*Math.PI)+1},InOut:function(a){return a===0?0:a===1?1:(a*=2,a<1?-.5*Math.pow(2,10*(a-1))*Math.sin((a-1.1)*5*Math.PI):.5*Math.pow(2,-10*(a-1))*Math.sin((a-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(a){var e=1.70158;return a===1?1:a*a*((e+1)*a-e)},Out:function(a){var e=1.70158;return a===0?0:--a*a*((e+1)*a+e)+1},InOut:function(a){var e=2.5949095;return(a*=2)<1?.5*(a*a*((e+1)*a-e)):.5*((a-=2)*a*((e+1)*a+e)+2)}}),Bounce:Object.freeze({In:function(a){return 1-Nr.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return a<.5?Nr.Bounce.In(a*2)*.5:Nr.Bounce.Out(a*2-1)*.5+.5}}),generatePow:function(a){return a===void 0&&(a=4),a=a<Number.EPSILON?Number.EPSILON:a,a=a>1e4?1e4:a,{In:function(e){return Math.pow(e,a)},Out:function(e){return 1-Math.pow(1-e,a)},InOut:function(e){return e<.5?Math.pow(e*2,a)/2:(1-Math.pow(2-e*2,a))/2+.5}}}}),U2=function(){return performance.now()},T4=(function(){function a(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return a.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(n){return e._tweens[n]})},a.prototype.removeAll=function(){this._tweens={}},a.prototype.add=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];for(var s=0,r=n;s<r.length;s++){var o=r[s];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},a.prototype.remove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var i=0,s=e;i<s.length;i++){var r=s[i];r._group=void 0,delete this._tweens[r.getId()],delete this._tweensAddedDuringUpdate[r.getId()]}},a.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},a.prototype.update=function(e,n){e===void 0&&(e=U2()),n===void 0&&(n=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<i.length;s++){var r=this._tweens[i[s]],o=!n;r&&r.update(e,o)===!1&&!n&&this.remove(r)}i=Object.keys(this._tweensAddedDuringUpdate)}},a})(),Bk={Linear:function(a,e){var n=a.length-1,i=n*e,s=Math.floor(i),r=Bk.Utils.Linear;return e<0?r(a[0],a[1],i):e>1?r(a[n],a[n-1],n-i):r(a[s],a[s+1>n?n:s+1],i-s)},Utils:{Linear:function(a,e,n){return(e-a)*n+a}}},dte=(function(){function a(){}return a.nextId=function(){return a._nextId++},a._nextId=0,a})(),Uk=new T4,gl=(function(){function a(e,n){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Nr.Linear.None,this._interpolationFunction=Bk.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=dte.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof n=="object"?(this._group=n,n.add(this)):n===!0&&(this._group=Uk,Uk.add(this))}return a.prototype.getId=function(){return this._id},a.prototype.isPlaying=function(){return this._isPlaying},a.prototype.isPaused=function(){return this._isPaused},a.prototype.getDuration=function(){return this._duration},a.prototype.to=function(e,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},a.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},a.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},a.prototype.start=function(e,n){if(e===void 0&&(e=U2()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var s={};for(var r in this._valuesEnd)s[r]=this._valuesEnd[r];this._valuesEnd=s}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},a.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},a.prototype._setupProperties=function(e,n,i,s,r){for(var o in i){var l=e[o],c=Array.isArray(l),u=c?"array":typeof l,h=!c&&Array.isArray(i[o]);if(!(u==="undefined"||u==="function")){if(h){var f=i[o];if(f.length===0)continue;for(var m=[l],A=0,x=f.length;A<x;A+=1){var T=this._handleRelativeValue(l,f[A]);if(isNaN(T)){h=!1,console.warn("Found invalid interpolation list. Skipping.");break}m.push(T)}h&&(i[o]=m)}if((u==="object"||c)&&l&&!h){n[o]=c?[]:{};var E=l;for(var M in E)n[o][M]=E[M];s[o]=c?[]:{};var f=i[o];if(!this._isDynamic){var N={};for(var M in f)N[M]=f[M];i[o]=f=N}this._setupProperties(E,n[o],f,s[o],r)}else(typeof n[o]>"u"||r)&&(n[o]=l),c||(n[o]*=1),h?s[o]=i[o].slice().reverse():s[o]=n[o]||0}}},a.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},a.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},a.prototype.pause=function(e){return e===void 0&&(e=U2()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},a.prototype.resume=function(e){return e===void 0&&(e=U2()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},a.prototype.stopChainedTweens=function(){for(var e=0,n=this._chainedTweens.length;e<n;e++)this._chainedTweens[e].stop();return this},a.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},a.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},a.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},a.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},a.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},a.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},a.prototype.easing=function(e){return e===void 0&&(e=Nr.Linear.None),this._easingFunction=e,this},a.prototype.interpolation=function(e){return e===void 0&&(e=Bk.Linear),this._interpolationFunction=e,this},a.prototype.chain=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._chainedTweens=e,this},a.prototype.onStart=function(e){return this._onStartCallback=e,this},a.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},a.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},a.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},a.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},a.prototype.onStop=function(e){return this._onStopCallback=e,this},a.prototype.update=function(e,n){var i=this,s;if(e===void 0&&(e=U2()),n===void 0&&(n=a.autoStartOnUpdate),this._isPaused)return!0;var r;if(!this._goToEnd&&!this._isPlaying)if(n)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,l=this._duration+((s=this._repeatDelayTime)!==null&&s!==void 0?s:this._delayTime),c=this._duration+this._repeat*l,u=function(){if(i._duration===0||o>c)return 1;var T=Math.trunc(o/l),E=o-T*l,M=Math.min(E/i._duration,1);return M===0&&o===i._duration?1:M},h=u(),f=this._easingFunction(h);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,f),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),this._duration===0||o>=this._duration)if(this._repeat>0){var m=Math.min(Math.trunc((o-this._duration)/l)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=m);for(r in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[r]=="string"&&(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=l*m,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var A=0,x=this._chainedTweens.length;A<x;A++)this._chainedTweens[A].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},a.prototype._updateProperties=function(e,n,i,s){for(var r in i)if(n[r]!==void 0){var o=n[r]||0,l=i[r],c=Array.isArray(e[r]),u=Array.isArray(l),h=!c&&u;h?e[r]=this._interpolationFunction(l,s):typeof l=="object"&&l?this._updateProperties(e[r],o,l,s):(l=this._handleRelativeValue(o,l),typeof l=="number"&&(e[r]=o+(l-o)*s))}},a.prototype._handleRelativeValue=function(e,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?e+parseFloat(n):parseFloat(n)},a.prototype._swapEndStartRepeatValues=function(e){var n=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=n},a.autoStartOnUpdate=!1,a})();dte.nextId;var Gf=Uk;Gf.getAll.bind(Gf);Gf.removeAll.bind(Gf);Gf.add.bind(Gf);Gf.remove.bind(Gf);Gf.update.bind(Gf);function LIe(a){const e=+this._x.call(null,a),n=+this._y.call(null,a),i=+this._z.call(null,a);return hte(this.cover(e,n,i),e,n,i,a)}function hte(a,e,n,i,s){if(isNaN(e)||isNaN(n)||isNaN(i))return a;var r,o=a._root,l={data:s},c=a._x0,u=a._y0,h=a._z0,f=a._x1,m=a._y1,A=a._z1,x,T,E,M,N,I,F,G,O,D,j;if(!o)return a._root=l,a;for(;o.length;)if((F=e>=(x=(c+f)/2))?c=x:f=x,(G=n>=(T=(u+m)/2))?u=T:m=T,(O=i>=(E=(h+A)/2))?h=E:A=E,r=o,!(o=o[D=O<<2|G<<1|F]))return r[D]=l,a;if(M=+a._x.call(null,o.data),N=+a._y.call(null,o.data),I=+a._z.call(null,o.data),e===M&&n===N&&i===I)return l.next=o,r?r[D]=l:a._root=l,a;do r=r?r[D]=new Array(8):a._root=new Array(8),(F=e>=(x=(c+f)/2))?c=x:f=x,(G=n>=(T=(u+m)/2))?u=T:m=T,(O=i>=(E=(h+A)/2))?h=E:A=E;while((D=O<<2|G<<1|F)===(j=(I>=E)<<2|(N>=T)<<1|M>=x));return r[j]=o,r[D]=l,a}function DIe(a){Array.isArray(a)||(a=Array.from(a));const e=a.length,n=new Float64Array(e),i=new Float64Array(e),s=new Float64Array(e);let r=1/0,o=1/0,l=1/0,c=-1/0,u=-1/0,h=-1/0;for(let f=0,m,A,x,T;f<e;++f)isNaN(A=+this._x.call(null,m=a[f]))||isNaN(x=+this._y.call(null,m))||isNaN(T=+this._z.call(null,m))||(n[f]=A,i[f]=x,s[f]=T,A<r&&(r=A),A>c&&(c=A),x<o&&(o=x),x>u&&(u=x),T<l&&(l=T),T>h&&(h=T));if(r>c||o>u||l>h)return this;this.cover(r,o,l).cover(c,u,h);for(let f=0;f<e;++f)hte(this,n[f],i[f],s[f],a[f]);return this}function kIe(a,e,n){if(isNaN(a=+a)||isNaN(e=+e)||isNaN(n=+n))return this;var i=this._x0,s=this._y0,r=this._z0,o=this._x1,l=this._y1,c=this._z1;if(isNaN(i))o=(i=Math.floor(a))+1,l=(s=Math.floor(e))+1,c=(r=Math.floor(n))+1;else{for(var u=o-i||1,h=this._root,f,m;i>a||a>=o||s>e||e>=l||r>n||n>=c;)switch(m=(n<r)<<2|(e<s)<<1|a<i,f=new Array(8),f[m]=h,h=f,u*=2,m){case 0:o=i+u,l=s+u,c=r+u;break;case 1:i=o-u,l=s+u,c=r+u;break;case 2:o=i+u,s=l-u,c=r+u;break;case 3:i=o-u,s=l-u,c=r+u;break;case 4:o=i+u,l=s+u,r=c-u;break;case 5:i=o-u,l=s+u,r=c-u;break;case 6:o=i+u,s=l-u,r=c-u;break;case 7:i=o-u,s=l-u,r=c-u;break}this._root&&this._root.length&&(this._root=h)}return this._x0=i,this._y0=s,this._z0=r,this._x1=o,this._y1=l,this._z1=c,this}function OIe(){var a=[];return this.visit(function(e){if(!e.length)do a.push(e.data);while(e=e.next)}),a}function FIe(a){return arguments.length?this.cover(+a[0][0],+a[0][1],+a[0][2]).cover(+a[1][0],+a[1][1],+a[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function rs(a,e,n,i,s,r,o){this.node=a,this.x0=e,this.y0=n,this.z0=i,this.x1=s,this.y1=r,this.z1=o}function jIe(a,e,n,i){var s,r=this._x0,o=this._y0,l=this._z0,c,u,h,f,m,A,x=this._x1,T=this._y1,E=this._z1,M=[],N=this._root,I,F;for(N&&M.push(new rs(N,r,o,l,x,T,E)),i==null?i=1/0:(r=a-i,o=e-i,l=n-i,x=a+i,T=e+i,E=n+i,i*=i);I=M.pop();)if(!(!(N=I.node)||(c=I.x0)>x||(u=I.y0)>T||(h=I.z0)>E||(f=I.x1)<r||(m=I.y1)<o||(A=I.z1)<l))if(N.length){var G=(c+f)/2,O=(u+m)/2,D=(h+A)/2;M.push(new rs(N[7],G,O,D,f,m,A),new rs(N[6],c,O,D,G,m,A),new rs(N[5],G,u,D,f,O,A),new rs(N[4],c,u,D,G,O,A),new rs(N[3],G,O,h,f,m,D),new rs(N[2],c,O,h,G,m,D),new rs(N[1],G,u,h,f,O,D),new rs(N[0],c,u,h,G,O,D)),(F=(n>=D)<<2|(e>=O)<<1|a>=G)&&(I=M[M.length-1],M[M.length-1]=M[M.length-1-F],M[M.length-1-F]=I)}else{var j=a-+this._x.call(null,N.data),L=e-+this._y.call(null,N.data),U=n-+this._z.call(null,N.data),q=j*j+L*L+U*U;if(q<i){var K=Math.sqrt(i=q);r=a-K,o=e-K,l=n-K,x=a+K,T=e+K,E=n+K,s=N.data}}return s}const BIe=(a,e,n,i,s,r)=>Math.sqrt((a-i)**2+(e-s)**2+(n-r)**2);function UIe(a,e,n,i){const s=[],r=a-i,o=e-i,l=n-i,c=a+i,u=e+i,h=n+i;return this.visit((f,m,A,x,T,E,M)=>{if(!f.length)do{const N=f.data;BIe(a,e,n,this._x(N),this._y(N),this._z(N))<=i&&s.push(N)}while(f=f.next);return m>c||A>u||x>h||T<r||E<o||M<l}),s}function VIe(a){if(isNaN(m=+this._x.call(null,a))||isNaN(A=+this._y.call(null,a))||isNaN(x=+this._z.call(null,a)))return this;var e,n=this._root,i,s,r,o=this._x0,l=this._y0,c=this._z0,u=this._x1,h=this._y1,f=this._z1,m,A,x,T,E,M,N,I,F,G,O;if(!n)return this;if(n.length)for(;;){if((N=m>=(T=(o+u)/2))?o=T:u=T,(I=A>=(E=(l+h)/2))?l=E:h=E,(F=x>=(M=(c+f)/2))?c=M:f=M,e=n,!(n=n[G=F<<2|I<<1|N]))return this;if(!n.length)break;(e[G+1&7]||e[G+2&7]||e[G+3&7]||e[G+4&7]||e[G+5&7]||e[G+6&7]||e[G+7&7])&&(i=e,O=G)}for(;n.data!==a;)if(s=n,!(n=n.next))return this;return(r=n.next)&&delete n.next,s?(r?s.next=r:delete s.next,this):e?(r?e[G]=r:delete e[G],(n=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&n===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[O]=n:this._root=n),this):(this._root=r,this)}function zIe(a){for(var e=0,n=a.length;e<n;++e)this.remove(a[e]);return this}function GIe(){return this._root}function qIe(){var a=0;return this.visit(function(e){if(!e.length)do++a;while(e=e.next)}),a}function HIe(a){var e=[],n,i=this._root,s,r,o,l,c,u,h;for(i&&e.push(new rs(i,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();)if(!a(i=n.node,r=n.x0,o=n.y0,l=n.z0,c=n.x1,u=n.y1,h=n.z1)&&i.length){var f=(r+c)/2,m=(o+u)/2,A=(l+h)/2;(s=i[7])&&e.push(new rs(s,f,m,A,c,u,h)),(s=i[6])&&e.push(new rs(s,r,m,A,f,u,h)),(s=i[5])&&e.push(new rs(s,f,o,A,c,m,h)),(s=i[4])&&e.push(new rs(s,r,o,A,f,m,h)),(s=i[3])&&e.push(new rs(s,f,m,l,c,u,A)),(s=i[2])&&e.push(new rs(s,r,m,l,f,u,A)),(s=i[1])&&e.push(new rs(s,f,o,l,c,m,A)),(s=i[0])&&e.push(new rs(s,r,o,l,f,m,A))}return this}function WIe(a){var e=[],n=[],i;for(this._root&&e.push(new rs(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=e.pop();){var s=i.node;if(s.length){var r,o=i.x0,l=i.y0,c=i.z0,u=i.x1,h=i.y1,f=i.z1,m=(o+u)/2,A=(l+h)/2,x=(c+f)/2;(r=s[0])&&e.push(new rs(r,o,l,c,m,A,x)),(r=s[1])&&e.push(new rs(r,m,l,c,u,A,x)),(r=s[2])&&e.push(new rs(r,o,A,c,m,h,x)),(r=s[3])&&e.push(new rs(r,m,A,c,u,h,x)),(r=s[4])&&e.push(new rs(r,o,l,x,m,A,f)),(r=s[5])&&e.push(new rs(r,m,l,x,u,A,f)),(r=s[6])&&e.push(new rs(r,o,A,x,m,h,f)),(r=s[7])&&e.push(new rs(r,m,A,x,u,h,f))}n.push(i)}for(;i=n.pop();)a(i.node,i.x0,i.y0,i.z0,i.x1,i.y1,i.z1);return this}function $Ie(a){return a[0]}function KIe(a){return arguments.length?(this._x=a,this):this._x}function YIe(a){return a[1]}function XIe(a){return arguments.length?(this._y=a,this):this._y}function QIe(a){return a[2]}function JIe(a){return arguments.length?(this._z=a,this):this._z}function fte(a,e,n,i){var s=new Gj(e??$Ie,n??YIe,i??QIe,NaN,NaN,NaN,NaN,NaN,NaN);return a==null?s:s.addAll(a)}function Gj(a,e,n,i,s,r,o,l,c){this._x=a,this._y=e,this._z=n,this._x0=i,this._y0=s,this._z0=r,this._x1=o,this._y1=l,this._z1=c,this._root=void 0}function bW(a){for(var e={data:a.data},n=e;a=a.next;)n=n.next={data:a.data};return e}var jo=fte.prototype=Gj.prototype;jo.copy=function(){var a=new Gj(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,n,i;if(!e)return a;if(!e.length)return a._root=bW(e),a;for(n=[{source:e,target:a._root=new Array(8)}];e=n.pop();)for(var s=0;s<8;++s)(i=e.source[s])&&(i.length?n.push({source:i,target:e.target[s]=new Array(8)}):e.target[s]=bW(i));return a};jo.add=LIe;jo.addAll=DIe;jo.cover=kIe;jo.data=OIe;jo.extent=FIe;jo.find=jIe;jo.findAllWithinRadius=UIe;jo.remove=VIe;jo.removeAll=zIe;jo.root=GIe;jo.size=qIe;jo.visit=HIe;jo.visitAfter=WIe;jo.x=KIe;jo.y=XIe;jo.z=JIe;function QC(a,e){return a==null||e==null?NaN:a<e?-1:a>e?1:a>=e?0:NaN}function ZIe(a,e){return a==null||e==null?NaN:e<a?-1:e>a?1:e>=a?0:NaN}function pte(a){let e,n,i;a.length!==2?(e=QC,n=(l,c)=>QC(a(l),c),i=(l,c)=>a(l)-c):(e=a===QC||a===ZIe?a:eLe,n=a,i=a);function s(l,c,u=0,h=l.length){if(u<h){if(e(c,c)!==0)return h;do{const f=u+h>>>1;n(l[f],c)<0?u=f+1:h=f}while(u<h)}return u}function r(l,c,u=0,h=l.length){if(u<h){if(e(c,c)!==0)return h;do{const f=u+h>>>1;n(l[f],c)<=0?u=f+1:h=f}while(u<h)}return u}function o(l,c,u=0,h=l.length){const f=s(l,c,u,h-1);return f>u&&i(l[f-1],c)>-i(l[f],c)?f-1:f}return{left:s,center:o,right:r}}function eLe(){return 0}function tLe(a){return a===null?NaN:+a}const nLe=pte(QC),mte=nLe.right;pte(tLe).center;function kN(a,e){let n,i;if(e===void 0)for(const s of a)s!=null&&(n===void 0?s>=s&&(n=i=s):(n>s&&(n=s),i<s&&(i=s)));else{let s=-1;for(let r of a)(r=e(r,++s,a))!=null&&(n===void 0?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)))}return[n,i]}class nm{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let i=0;for(let s=0;s<this._n&&s<32;s++){const r=n[s],o=e+r,l=Math.abs(e)<Math.abs(r)?e-(o-r):r-(o-e);l&&(n[i++]=l),e=o}return n[i]=e,this._n=i+1,this}valueOf(){const e=this._partials;let n=this._n,i,s,r,o=0;if(n>0){for(o=e[--n];n>0&&(i=o,s=e[--n],o=i+s,r=s-(o-i),!r););n>0&&(r<0&&e[n-1]<0||r>0&&e[n-1]>0)&&(s=r*2,i=o+s,s==i-o&&(o=i))}return o}}const aLe=Math.sqrt(50),iLe=Math.sqrt(10),sLe=Math.sqrt(2);function ON(a,e,n){const i=(e-a)/Math.max(0,n),s=Math.floor(Math.log10(i)),r=i/Math.pow(10,s),o=r>=aLe?10:r>=iLe?5:r>=sLe?2:1;let l,c,u;return s<0?(u=Math.pow(10,-s)/o,l=Math.round(a*u),c=Math.round(e*u),l/u<a&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,s)*o,l=Math.round(a/u),c=Math.round(e/u),l*u<a&&++l,c*u>e&&--c),c<l&&.5<=n&&n<2?ON(a,e,n*2):[l,c,u]}function rLe(a,e,n){if(e=+e,a=+a,n=+n,!(n>0))return[];if(a===e)return[a];const i=e<a,[s,r,o]=i?ON(e,a,n):ON(a,e,n);if(!(r>=s))return[];const l=r-s+1,c=new Array(l);if(i)if(o<0)for(let u=0;u<l;++u)c[u]=(r-u)/-o;else for(let u=0;u<l;++u)c[u]=(r-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(s+u)/-o;else for(let u=0;u<l;++u)c[u]=(s+u)*o;return c}function Vk(a,e,n){return e=+e,a=+a,n=+n,ON(a,e,n)[2]}function oLe(a,e,n){e=+e,a=+a,n=+n;const i=e<a,s=i?Vk(e,a,n):Vk(a,e,n);return(i?-1:1)*(s<0?1/-s:s)}function lLe(a,e){let n;for(const i of a)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);return n}function cLe(a,e){let n=0,i=0;if(e===void 0)for(let s of a)s!=null&&(s=+s)>=s&&(++n,i+=s);else{let s=-1;for(let r of a)(r=e(r,++s,a))!=null&&(r=+r)>=r&&(++n,i+=r)}if(n)return i/n}function*uLe(a){for(const e of a)yield*e}function QS(a){return Array.from(uLe(a))}function s_(a,e,n){a=+a,e=+e,n=(s=arguments.length)<2?(e=a,a=0,1):s<3?1:+n;for(var i=-1,s=Math.max(0,Math.ceil((e-a)/n))|0,r=new Array(s);++i<s;)r[i]=a+i*n;return r}function dLe(a,e){let n=0;for(let i of a)(i=+i)&&(n+=i);return n}function gte(a,e){switch(arguments.length){case 0:break;case 1:this.range(a);break;default:this.range(e).domain(a);break}return this}function qj(a,e,n){a.prototype=e.prototype=n,n.constructor=a}function Ate(a,e){var n=Object.create(a.prototype);for(var i in e)n[i]=e[i];return n}function ow(){}var JS=.7,FN=1/JS,T_="\\s*([+-]?\\d+)\\s*",ZS="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hLe=/^#([0-9a-f]{3,8})$/,fLe=new RegExp(`^rgb\\(${T_},${T_},${T_}\\)$`),pLe=new RegExp(`^rgb\\(${nf},${nf},${nf}\\)$`),mLe=new RegExp(`^rgba\\(${T_},${T_},${T_},${ZS}\\)$`),gLe=new RegExp(`^rgba\\(${nf},${nf},${nf},${ZS}\\)$`),ALe=new RegExp(`^hsl\\(${ZS},${nf},${nf}\\)$`),yLe=new RegExp(`^hsla\\(${ZS},${nf},${nf},${ZS}\\)$`),SW={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qj(ow,Jy,{copy(a){return Object.assign(new this.constructor,this,a)},displayable(){return this.rgb().displayable()},hex:TW,formatHex:TW,formatHex8:vLe,formatHsl:_Le,formatRgb:wW,toString:wW});function TW(){return this.rgb().formatHex()}function vLe(){return this.rgb().formatHex8()}function _Le(){return yte(this).formatHsl()}function wW(){return this.rgb().formatRgb()}function Jy(a){var e,n;return a=(a+"").trim().toLowerCase(),(e=hLe.exec(a))?(n=e[1].length,e=parseInt(e[1],16),n===6?EW(e):n===3?new hc(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?NM(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?NM(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=fLe.exec(a))?new hc(e[1],e[2],e[3],1):(e=pLe.exec(a))?new hc(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=mLe.exec(a))?NM(e[1],e[2],e[3],e[4]):(e=gLe.exec(a))?NM(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ALe.exec(a))?NW(e[1],e[2]/100,e[3]/100,1):(e=yLe.exec(a))?NW(e[1],e[2]/100,e[3]/100,e[4]):SW.hasOwnProperty(a)?EW(SW[a]):a==="transparent"?new hc(NaN,NaN,NaN,0):null}function EW(a){return new hc(a>>16&255,a>>8&255,a&255,1)}function NM(a,e,n,i){return i<=0&&(a=e=n=NaN),new hc(a,e,n,i)}function xLe(a){return a instanceof ow||(a=Jy(a)),a?(a=a.rgb(),new hc(a.r,a.g,a.b,a.opacity)):new hc}function zk(a,e,n,i){return arguments.length===1?xLe(a):new hc(a,e,n,i??1)}function hc(a,e,n,i){this.r=+a,this.g=+e,this.b=+n,this.opacity=+i}qj(hc,zk,Ate(ow,{brighter(a){return a=a==null?FN:Math.pow(FN,a),new hc(this.r*a,this.g*a,this.b*a,this.opacity)},darker(a){return a=a==null?JS:Math.pow(JS,a),new hc(this.r*a,this.g*a,this.b*a,this.opacity)},rgb(){return this},clamp(){return new hc(ey(this.r),ey(this.g),ey(this.b),jN(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:MW,formatHex:MW,formatHex8:bLe,formatRgb:CW,toString:CW}));function MW(){return`#${qA(this.r)}${qA(this.g)}${qA(this.b)}`}function bLe(){return`#${qA(this.r)}${qA(this.g)}${qA(this.b)}${qA((isNaN(this.opacity)?1:this.opacity)*255)}`}function CW(){const a=jN(this.opacity);return`${a===1?"rgb(":"rgba("}${ey(this.r)}, ${ey(this.g)}, ${ey(this.b)}${a===1?")":`, ${a})`}`}function jN(a){return isNaN(a)?1:Math.max(0,Math.min(1,a))}function ey(a){return Math.max(0,Math.min(255,Math.round(a)||0))}function qA(a){return a=ey(a),(a<16?"0":"")+a.toString(16)}function NW(a,e,n,i){return i<=0?a=e=n=NaN:n<=0||n>=1?a=e=NaN:e<=0&&(a=NaN),new Pd(a,e,n,i)}function yte(a){if(a instanceof Pd)return new Pd(a.h,a.s,a.l,a.opacity);if(a instanceof ow||(a=Jy(a)),!a)return new Pd;if(a instanceof Pd)return a;a=a.rgb();var e=a.r/255,n=a.g/255,i=a.b/255,s=Math.min(e,n,i),r=Math.max(e,n,i),o=NaN,l=r-s,c=(r+s)/2;return l?(e===r?o=(n-i)/l+(n<i)*6:n===r?o=(i-e)/l+2:o=(e-n)/l+4,l/=c<.5?r+s:2-r-s,o*=60):l=c>0&&c<1?0:o,new Pd(o,l,c,a.opacity)}function SLe(a,e,n,i){return arguments.length===1?yte(a):new Pd(a,e,n,i??1)}function Pd(a,e,n,i){this.h=+a,this.s=+e,this.l=+n,this.opacity=+i}qj(Pd,SLe,Ate(ow,{brighter(a){return a=a==null?FN:Math.pow(FN,a),new Pd(this.h,this.s,this.l*a,this.opacity)},darker(a){return a=a==null?JS:Math.pow(JS,a),new Pd(this.h,this.s,this.l*a,this.opacity)},rgb(){var a=this.h%360+(this.h<0)*360,e=isNaN(a)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,s=2*n-i;return new hc(c5(a>=240?a-240:a+120,s,i),c5(a,s,i),c5(a<120?a+240:a-120,s,i),this.opacity)},clamp(){return new Pd(RW(this.h),RM(this.s),RM(this.l),jN(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const a=jN(this.opacity);return`${a===1?"hsl(":"hsla("}${RW(this.h)}, ${RM(this.s)*100}%, ${RM(this.l)*100}%${a===1?")":`, ${a})`}`}}));function RW(a){return a=(a||0)%360,a<0?a+360:a}function RM(a){return Math.max(0,Math.min(1,a||0))}function c5(a,e,n){return(a<60?e+(n-e)*a/60:a<180?n:a<240?e+(n-e)*(240-a)/60:e)*255}const Hj=a=>()=>a;function TLe(a,e){return function(n){return a+n*e}}function wLe(a,e,n){return a=Math.pow(a,n),e=Math.pow(e,n)-a,n=1/n,function(i){return Math.pow(a+i*e,n)}}function ELe(a){return(a=+a)==1?vte:function(e,n){return n-e?wLe(e,n,a):Hj(isNaN(e)?n:e)}}function vte(a,e){var n=e-a;return n?TLe(a,n):Hj(isNaN(a)?e:a)}const PW=(function a(e){var n=ELe(e);function i(s,r){var o=n((s=zk(s)).r,(r=zk(r)).r),l=n(s.g,r.g),c=n(s.b,r.b),u=vte(s.opacity,r.opacity);return function(h){return s.r=o(h),s.g=l(h),s.b=c(h),s.opacity=u(h),s+""}}return i.gamma=a,i})(1);function _te(a,e){e||(e=[]);var n=a?Math.min(e.length,a.length):0,i=e.slice(),s;return function(r){for(s=0;s<n;++s)i[s]=a[s]*(1-r)+e[s]*r;return i}}function xte(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function MLe(a,e){return(xte(e)?_te:bte)(a,e)}function bte(a,e){var n=e?e.length:0,i=a?Math.min(n,a.length):0,s=new Array(i),r=new Array(n),o;for(o=0;o<i;++o)s[o]=Wj(a[o],e[o]);for(;o<n;++o)r[o]=e[o];return function(l){for(o=0;o<i;++o)r[o]=s[o](l);return r}}function CLe(a,e){var n=new Date;return a=+a,e=+e,function(i){return n.setTime(a*(1-i)+e*i),n}}function eT(a,e){return a=+a,e=+e,function(n){return a*(1-n)+e*n}}function NLe(a,e){var n={},i={},s;(a===null||typeof a!="object")&&(a={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in a?n[s]=Wj(a[s],e[s]):i[s]=e[s];return function(r){for(s in n)i[s]=n[s](r);return i}}var Gk=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,u5=new RegExp(Gk.source,"g");function RLe(a){return function(){return a}}function PLe(a){return function(e){return a(e)+""}}function ILe(a,e){var n=Gk.lastIndex=u5.lastIndex=0,i,s,r,o=-1,l=[],c=[];for(a=a+"",e=e+"";(i=Gk.exec(a))&&(s=u5.exec(e));)(r=s.index)>n&&(r=e.slice(n,r),l[o]?l[o]+=r:l[++o]=r),(i=i[0])===(s=s[0])?l[o]?l[o]+=s:l[++o]=s:(l[++o]=null,c.push({i:o,x:eT(i,s)})),n=u5.lastIndex;return n<e.length&&(r=e.slice(n),l[o]?l[o]+=r:l[++o]=r),l.length<2?c[0]?PLe(c[0].x):RLe(e):(e=c.length,function(u){for(var h=0,f;h<e;++h)l[(f=c[h]).i]=f.x(u);return l.join("")})}function Wj(a,e){var n=typeof e,i;return e==null||n==="boolean"?Hj(e):(n==="number"?eT:n==="string"?(i=Jy(e))?(e=i,PW):ILe:e instanceof Jy?PW:e instanceof Date?CLe:xte(e)?_te:Array.isArray(e)?bte:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?NLe:eT)(a,e)}function LLe(a,e){return a=+a,e=+e,function(n){return Math.round(a*(1-n)+e*n)}}function DLe(a){return function(){return a}}function kLe(a){return+a}var IW=[0,1];function r_(a){return a}function qk(a,e){return(e-=a=+a)?function(n){return(n-a)/e}:DLe(isNaN(e)?NaN:.5)}function OLe(a,e){var n;return a>e&&(n=a,a=e,e=n),function(i){return Math.max(a,Math.min(e,i))}}function FLe(a,e,n){var i=a[0],s=a[1],r=e[0],o=e[1];return s<i?(i=qk(s,i),r=n(o,r)):(i=qk(i,s),r=n(r,o)),function(l){return r(i(l))}}function jLe(a,e,n){var i=Math.min(a.length,e.length)-1,s=new Array(i),r=new Array(i),o=-1;for(a[i]<a[0]&&(a=a.slice().reverse(),e=e.slice().reverse());++o<i;)s[o]=qk(a[o],a[o+1]),r[o]=n(e[o],e[o+1]);return function(l){var c=mte(a,l,1,i)-1;return r[c](s[c](l))}}function BLe(a,e){return e.domain(a.domain()).range(a.range()).interpolate(a.interpolate()).clamp(a.clamp()).unknown(a.unknown())}function ULe(){var a=IW,e=IW,n=Wj,i,s,r,o=r_,l,c,u;function h(){var m=Math.min(a.length,e.length);return o!==r_&&(o=OLe(a[0],a[m-1])),l=m>2?jLe:FLe,c=u=null,f}function f(m){return m==null||isNaN(m=+m)?r:(c||(c=l(a.map(i),e,n)))(i(o(m)))}return f.invert=function(m){return o(s((u||(u=l(e,a.map(i),eT)))(m)))},f.domain=function(m){return arguments.length?(a=Array.from(m,kLe),h()):a.slice()},f.range=function(m){return arguments.length?(e=Array.from(m),h()):e.slice()},f.rangeRound=function(m){return e=Array.from(m),n=LLe,h()},f.clamp=function(m){return arguments.length?(o=m?!0:r_,h()):o!==r_},f.interpolate=function(m){return arguments.length?(n=m,h()):n},f.unknown=function(m){return arguments.length?(r=m,f):r},function(m,A){return i=m,s=A,h()}}function VLe(){return ULe()(r_,r_)}function zLe(a){return Math.abs(a=Math.round(a))>=1e21?a.toLocaleString("en").replace(/,/g,""):a.toString(10)}function BN(a,e){if(!isFinite(a)||a===0)return null;var n=(a=e?a.toExponential(e-1):a.toExponential()).indexOf("e"),i=a.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+a.slice(n+1)]}function ox(a){return a=BN(Math.abs(a)),a?a[1]:NaN}function GLe(a,e){return function(n,i){for(var s=n.length,r=[],o=0,l=a[0],c=0;s>0&&l>0&&(c+l+1>i&&(l=Math.max(1,i-c)),r.push(n.substring(s-=l,s+l)),!((c+=l+1)>i));)l=a[o=(o+1)%a.length];return r.reverse().join(e)}}function qLe(a){return function(e){return e.replace(/[0-9]/g,function(n){return a[+n]})}}var HLe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function UN(a){if(!(e=HLe.exec(a)))throw new Error("invalid format: "+a);var e;return new $j({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}UN.prototype=$j.prototype;function $j(a){this.fill=a.fill===void 0?" ":a.fill+"",this.align=a.align===void 0?">":a.align+"",this.sign=a.sign===void 0?"-":a.sign+"",this.symbol=a.symbol===void 0?"":a.symbol+"",this.zero=!!a.zero,this.width=a.width===void 0?void 0:+a.width,this.comma=!!a.comma,this.precision=a.precision===void 0?void 0:+a.precision,this.trim=!!a.trim,this.type=a.type===void 0?"":a.type+""}$j.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function WLe(a){e:for(var e=a.length,n=1,i=-1,s;n<e;++n)switch(a[n]){case".":i=s=n;break;case"0":i===0&&(i=n),s=n;break;default:if(!+a[n])break e;i>0&&(i=0);break}return i>0?a.slice(0,i)+a.slice(s+1):a}var VN;function $Le(a,e){var n=BN(a,e);if(!n)return VN=void 0,a.toPrecision(e);var i=n[0],s=n[1],r=s-(VN=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=i.length;return r===o?i:r>o?i+new Array(r-o+1).join("0"):r>0?i.slice(0,r)+"."+i.slice(r):"0."+new Array(1-r).join("0")+BN(a,Math.max(0,e+r-1))[0]}function LW(a,e){var n=BN(a,e);if(!n)return a+"";var i=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+i:i.length>s+1?i.slice(0,s+1)+"."+i.slice(s+1):i+new Array(s-i.length+2).join("0")}const DW={"%":(a,e)=>(a*100).toFixed(e),b:a=>Math.round(a).toString(2),c:a=>a+"",d:zLe,e:(a,e)=>a.toExponential(e),f:(a,e)=>a.toFixed(e),g:(a,e)=>a.toPrecision(e),o:a=>Math.round(a).toString(8),p:(a,e)=>LW(a*100,e),r:LW,s:$Le,X:a=>Math.round(a).toString(16).toUpperCase(),x:a=>Math.round(a).toString(16)};function kW(a){return a}var OW=Array.prototype.map,FW=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function KLe(a){var e=a.grouping===void 0||a.thousands===void 0?kW:GLe(OW.call(a.grouping,Number),a.thousands+""),n=a.currency===void 0?"":a.currency[0]+"",i=a.currency===void 0?"":a.currency[1]+"",s=a.decimal===void 0?".":a.decimal+"",r=a.numerals===void 0?kW:qLe(OW.call(a.numerals,String)),o=a.percent===void 0?"%":a.percent+"",l=a.minus===void 0?"":a.minus+"",c=a.nan===void 0?"NaN":a.nan+"";function u(f,m){f=UN(f);var A=f.fill,x=f.align,T=f.sign,E=f.symbol,M=f.zero,N=f.width,I=f.comma,F=f.precision,G=f.trim,O=f.type;O==="n"?(I=!0,O="g"):DW[O]||(F===void 0&&(F=12),G=!0,O="g"),(M||A==="0"&&x==="=")&&(M=!0,A="0",x="=");var D=(m&&m.prefix!==void 0?m.prefix:"")+(E==="$"?n:E==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():""),j=(E==="$"?i:/[%p]/.test(O)?o:"")+(m&&m.suffix!==void 0?m.suffix:""),L=DW[O],U=/[defgprs%]/.test(O);F=F===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,F)):Math.max(0,Math.min(20,F));function q(K){var H=D,X=j,ne,Q,Y;if(O==="c")X=L(K)+X,K="";else{K=+K;var ue=K<0||1/K<0;if(K=isNaN(K)?c:L(Math.abs(K),F),G&&(K=WLe(K)),ue&&+K==0&&T!=="+"&&(ue=!1),H=(ue?T==="("?T:l:T==="-"||T==="("?"":T)+H,X=(O==="s"&&!isNaN(K)&&VN!==void 0?FW[8+VN/3]:"")+X+(ue&&T==="("?")":""),U){for(ne=-1,Q=K.length;++ne<Q;)if(Y=K.charCodeAt(ne),48>Y||Y>57){X=(Y===46?s+K.slice(ne+1):K.slice(ne))+X,K=K.slice(0,ne);break}}}I&&!M&&(K=e(K,1/0));var pe=H.length+K.length+X.length,Ee=pe<N?new Array(N-pe+1).join(A):"";switch(I&&M&&(K=e(Ee+K,Ee.length?N-X.length:1/0),Ee=""),x){case"<":K=H+K+X+Ee;break;case"=":K=H+Ee+K+X;break;case"^":K=Ee.slice(0,pe=Ee.length>>1)+H+K+X+Ee.slice(pe);break;default:K=Ee+H+K+X;break}return r(K)}return q.toString=function(){return f+""},q}function h(f,m){var A=Math.max(-8,Math.min(8,Math.floor(ox(m)/3)))*3,x=Math.pow(10,-A),T=u((f=UN(f),f.type="f",f),{suffix:FW[8+A/3]});return function(E){return T(x*E)}}return{format:u,formatPrefix:h}}var PM,Ste,Tte;YLe({thousands:",",grouping:[3],currency:["$",""]});function YLe(a){return PM=KLe(a),Ste=PM.format,Tte=PM.formatPrefix,PM}function XLe(a){return Math.max(0,-ox(Math.abs(a)))}function QLe(a,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ox(e)/3)))*3-ox(Math.abs(a)))}function JLe(a,e){return a=Math.abs(a),e=Math.abs(e)-a,Math.max(0,ox(e)-ox(a))+1}function ZLe(a,e,n,i){var s=oLe(a,e,n),r;switch(i=UN(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(a),Math.abs(e));return i.precision==null&&!isNaN(r=QLe(s,o))&&(i.precision=r),Tte(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(r=JLe(s,Math.max(Math.abs(a),Math.abs(e))))&&(i.precision=r-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(r=XLe(s))&&(i.precision=r-(i.type==="%")*2);break}}return Ste(i)}function wte(a){var e=a.domain;return a.ticks=function(n){var i=e();return rLe(i[0],i[i.length-1],n??10)},a.tickFormat=function(n,i){var s=e();return ZLe(s[0],s[s.length-1],n??10,i)},a.nice=function(n){n==null&&(n=10);var i=e(),s=0,r=i.length-1,o=i[s],l=i[r],c,u,h=10;for(l<o&&(u=o,o=l,l=u,u=s,s=r,r=u);h-- >0;){if(u=Vk(o,l,n),u===c)return i[s]=o,i[r]=l,e(i);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return a},a}function bm(){var a=VLe();return a.copy=function(){return BLe(a,bm())},gte.apply(a,arguments),wte(a)}function Ete(){var a=0,e=1,n=1,i=[.5],s=[0,1],r;function o(c){return c!=null&&c<=c?s[mte(i,c,0,n)]:r}function l(){var c=-1;for(i=new Array(n);++c<n;)i[c]=((c+1)*e-(c-n)*a)/(n+1);return o}return o.domain=function(c){return arguments.length?([a,e]=c,a=+a,e=+e,l()):[a,e]},o.range=function(c){return arguments.length?(n=(s=Array.from(c)).length-1,l()):s.slice()},o.invertExtent=function(c){var u=s.indexOf(c);return u<0?[NaN,NaN]:u<1?[a,i[0]]:u>=n?[i[n-1],e]:[i[u-1],i[u]]},o.unknown=function(c){return arguments.length&&(r=c),o},o.thresholds=function(){return i.slice()},o.copy=function(){return Ete().domain([a,e]).range(s).unknown(r)},gte.apply(wte(o),arguments)}var $a=1e-6,zN=1e-12,xi=Math.PI,fc=xi/2,GN=xi/4,Au=xi*2,Js=180/xi,ba=xi/180,es=Math.abs,Kj=Math.atan,$u=Math.atan2,Ca=Math.cos,IM=Math.ceil,eDe=Math.exp,Hk=Math.hypot,tDe=Math.log,Aa=Math.sin,nDe=Math.sign||function(a){return a>0?1:a<0?-1:0},Sm=Math.sqrt,aDe=Math.tan;function iDe(a){return a>1?0:a<-1?xi:Math.acos(a)}function Tm(a){return a>1?fc:a<-1?-fc:Math.asin(a)}function jW(a){return(a=Aa(a/2))*a}function il(){}function qN(a,e){a&&UW.hasOwnProperty(a.type)&&UW[a.type](a,e)}var BW={Feature:function(a,e){qN(a.geometry,e)},FeatureCollection:function(a,e){for(var n=a.features,i=-1,s=n.length;++i<s;)qN(n[i].geometry,e)}},UW={Sphere:function(a,e){e.sphere()},Point:function(a,e){a=a.coordinates,e.point(a[0],a[1],a[2])},MultiPoint:function(a,e){for(var n=a.coordinates,i=-1,s=n.length;++i<s;)a=n[i],e.point(a[0],a[1],a[2])},LineString:function(a,e){Wk(a.coordinates,e,0)},MultiLineString:function(a,e){for(var n=a.coordinates,i=-1,s=n.length;++i<s;)Wk(n[i],e,0)},Polygon:function(a,e){VW(a.coordinates,e)},MultiPolygon:function(a,e){for(var n=a.coordinates,i=-1,s=n.length;++i<s;)VW(n[i],e)},GeometryCollection:function(a,e){for(var n=a.geometries,i=-1,s=n.length;++i<s;)qN(n[i],e)}};function Wk(a,e,n){var i=-1,s=a.length-n,r;for(e.lineStart();++i<s;)r=a[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function VW(a,e){var n=-1,i=a.length;for(e.polygonStart();++n<i;)Wk(a[n],e,1);e.polygonEnd()}function w4(a,e){a&&BW.hasOwnProperty(a.type)?BW[a.type](a,e):qN(a,e)}var HN=new nm,zW=new nm,Mte,Cte,$k,Kk,Yk,wm={point:il,lineStart:il,lineEnd:il,polygonStart:function(){HN=new nm,wm.lineStart=sDe,wm.lineEnd=rDe},polygonEnd:function(){var a=+HN;zW.add(a<0?Au+a:a),this.lineStart=this.lineEnd=this.point=il},sphere:function(){zW.add(Au)}};function sDe(){wm.point=oDe}function rDe(){Nte(Mte,Cte)}function oDe(a,e){wm.point=Nte,Mte=a,Cte=e,a*=ba,e*=ba,$k=a,Kk=Ca(e=e/2+GN),Yk=Aa(e)}function Nte(a,e){a*=ba,e*=ba,e=e/2+GN;var n=a-$k,i=n>=0?1:-1,s=i*n,r=Ca(e),o=Aa(e),l=Yk*o,c=Kk*r+l*Ca(s),u=l*i*Aa(s);HN.add($u(u,c)),$k=a,Kk=r,Yk=o}function WN(a){return[$u(a[1],a[0]),Tm(a[2])]}function Zy(a){var e=a[0],n=a[1],i=Ca(n);return[i*Ca(e),i*Aa(e),Aa(n)]}function LM(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]}function lx(a,e){return[a[1]*e[2]-a[2]*e[1],a[2]*e[0]-a[0]*e[2],a[0]*e[1]-a[1]*e[0]]}function d5(a,e){a[0]+=e[0],a[1]+=e[1],a[2]+=e[2]}function DM(a,e){return[a[0]*e,a[1]*e,a[2]*e]}function $N(a){var e=Sm(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=e,a[1]/=e,a[2]/=e}var ks,lc,Qs,tu,NA,Rte,Pte,w_,dS,wg,Em,zp={point:Xk,lineStart:GW,lineEnd:qW,polygonStart:function(){zp.point=Lte,zp.lineStart=lDe,zp.lineEnd=cDe,dS=new nm,wm.polygonStart()},polygonEnd:function(){wm.polygonEnd(),zp.point=Xk,zp.lineStart=GW,zp.lineEnd=qW,HN<0?(ks=-(Qs=180),lc=-(tu=90)):dS>$a?tu=90:dS<-$a&&(lc=-90),Em[0]=ks,Em[1]=Qs},sphere:function(){ks=-(Qs=180),lc=-(tu=90)}};function Xk(a,e){wg.push(Em=[ks=a,Qs=a]),e<lc&&(lc=e),e>tu&&(tu=e)}function Ite(a,e){var n=Zy([a*ba,e*ba]);if(w_){var i=lx(w_,n),s=[i[1],-i[0],0],r=lx(s,i);$N(r),r=WN(r);var o=a-NA,l=o>0?1:-1,c=r[0]*Js*l,u,h=es(o)>180;h^(l*NA<c&&c<l*a)?(u=r[1]*Js,u>tu&&(tu=u)):(c=(c+360)%360-180,h^(l*NA<c&&c<l*a)?(u=-r[1]*Js,u<lc&&(lc=u)):(e<lc&&(lc=e),e>tu&&(tu=e))),h?a<NA?Jc(ks,a)>Jc(ks,Qs)&&(Qs=a):Jc(a,Qs)>Jc(ks,Qs)&&(ks=a):Qs>=ks?(a<ks&&(ks=a),a>Qs&&(Qs=a)):a>NA?Jc(ks,a)>Jc(ks,Qs)&&(Qs=a):Jc(a,Qs)>Jc(ks,Qs)&&(ks=a)}else wg.push(Em=[ks=a,Qs=a]);e<lc&&(lc=e),e>tu&&(tu=e),w_=n,NA=a}function GW(){zp.point=Ite}function qW(){Em[0]=ks,Em[1]=Qs,zp.point=Xk,w_=null}function Lte(a,e){if(w_){var n=a-NA;dS.add(es(n)>180?n+(n>0?360:-360):n)}else Rte=a,Pte=e;wm.point(a,e),Ite(a,e)}function lDe(){wm.lineStart()}function cDe(){Lte(Rte,Pte),wm.lineEnd(),es(dS)>$a&&(ks=-(Qs=180)),Em[0]=ks,Em[1]=Qs,w_=null}function Jc(a,e){return(e-=a)<0?e+360:e}function uDe(a,e){return a[0]-e[0]}function HW(a,e){return a[0]<=a[1]?a[0]<=e&&e<=a[1]:e<a[0]||a[1]<e}function Dte(a){var e,n,i,s,r,o,l;if(tu=Qs=-(ks=lc=1/0),wg=[],w4(a,zp),n=wg.length){for(wg.sort(uDe),e=1,i=wg[0],r=[i];e<n;++e)s=wg[e],HW(i,s[0])||HW(i,s[1])?(Jc(i[0],s[1])>Jc(i[0],i[1])&&(i[1]=s[1]),Jc(s[0],i[1])>Jc(i[0],i[1])&&(i[0]=s[0])):r.push(i=s);for(o=-1/0,n=r.length-1,e=0,i=r[n];e<=n;i=s,++e)s=r[e],(l=Jc(i[1],s[0]))>o&&(o=l,ks=s[0],Qs=i[1])}return wg=Em=null,ks===1/0||lc===1/0?[[NaN,NaN],[NaN,NaN]]:[[ks,lc],[Qs,tu]]}var V2,KN,YN,XN,QN,JN,ZN,eR,Qk,Jk,Zk,kte,Ote,Ml,Cl,Nl,Bd={sphere:il,point:Yj,lineStart:WW,lineEnd:$W,polygonStart:function(){Bd.lineStart=fDe,Bd.lineEnd=pDe},polygonEnd:function(){Bd.lineStart=WW,Bd.lineEnd=$W}};function Yj(a,e){a*=ba,e*=ba;var n=Ca(e);lw(n*Ca(a),n*Aa(a),Aa(e))}function lw(a,e,n){++V2,YN+=(a-YN)/V2,XN+=(e-XN)/V2,QN+=(n-QN)/V2}function WW(){Bd.point=dDe}function dDe(a,e){a*=ba,e*=ba;var n=Ca(e);Ml=n*Ca(a),Cl=n*Aa(a),Nl=Aa(e),Bd.point=hDe,lw(Ml,Cl,Nl)}function hDe(a,e){a*=ba,e*=ba;var n=Ca(e),i=n*Ca(a),s=n*Aa(a),r=Aa(e),o=$u(Sm((o=Cl*r-Nl*s)*o+(o=Nl*i-Ml*r)*o+(o=Ml*s-Cl*i)*o),Ml*i+Cl*s+Nl*r);KN+=o,JN+=o*(Ml+(Ml=i)),ZN+=o*(Cl+(Cl=s)),eR+=o*(Nl+(Nl=r)),lw(Ml,Cl,Nl)}function $W(){Bd.point=Yj}function fDe(){Bd.point=mDe}function pDe(){Fte(kte,Ote),Bd.point=Yj}function mDe(a,e){kte=a,Ote=e,a*=ba,e*=ba,Bd.point=Fte;var n=Ca(e);Ml=n*Ca(a),Cl=n*Aa(a),Nl=Aa(e),lw(Ml,Cl,Nl)}function Fte(a,e){a*=ba,e*=ba;var n=Ca(e),i=n*Ca(a),s=n*Aa(a),r=Aa(e),o=Cl*r-Nl*s,l=Nl*i-Ml*r,c=Ml*s-Cl*i,u=Hk(o,l,c),h=Tm(u),f=u&&-h/u;Qk.add(f*o),Jk.add(f*l),Zk.add(f*c),KN+=h,JN+=h*(Ml+(Ml=i)),ZN+=h*(Cl+(Cl=s)),eR+=h*(Nl+(Nl=r)),lw(Ml,Cl,Nl)}function KW(a){V2=KN=YN=XN=QN=JN=ZN=eR=0,Qk=new nm,Jk=new nm,Zk=new nm,w4(a,Bd);var e=+Qk,n=+Jk,i=+Zk,s=Hk(e,n,i);return s<zN&&(e=JN,n=ZN,i=eR,KN<$a&&(e=YN,n=XN,i=QN),s=Hk(e,n,i),s<zN)?[NaN,NaN]:[$u(n,e)*Js,Tm(i/s)*Js]}function eO(a,e){function n(i,s){return i=a(i,s),e(i[0],i[1])}return a.invert&&e.invert&&(n.invert=function(i,s){return i=e.invert(i,s),i&&a.invert(i[0],i[1])}),n}function tO(a,e){return es(a)>xi&&(a-=Math.round(a/Au)*Au),[a,e]}tO.invert=tO;function jte(a,e,n){return(a%=Au)?e||n?eO(XW(a),QW(e,n)):XW(a):e||n?QW(e,n):tO}function YW(a){return function(e,n){return e+=a,es(e)>xi&&(e-=Math.round(e/Au)*Au),[e,n]}}function XW(a){var e=YW(a);return e.invert=YW(-a),e}function QW(a,e){var n=Ca(a),i=Aa(a),s=Ca(e),r=Aa(e);function o(l,c){var u=Ca(c),h=Ca(l)*u,f=Aa(l)*u,m=Aa(c),A=m*n+h*i;return[$u(f*s-A*r,h*n-m*i),Tm(A*s+f*r)]}return o.invert=function(l,c){var u=Ca(c),h=Ca(l)*u,f=Aa(l)*u,m=Aa(c),A=m*s-f*r;return[$u(f*s+m*r,h*n+A*i),Tm(A*n-h*i)]},o}function gDe(a){a=jte(a[0]*ba,a[1]*ba,a.length>2?a[2]*ba:0);function e(n){return n=a(n[0]*ba,n[1]*ba),n[0]*=Js,n[1]*=Js,n}return e.invert=function(n){return n=a.invert(n[0]*ba,n[1]*ba),n[0]*=Js,n[1]*=Js,n},e}function ADe(a,e,n,i,s,r){if(n){var o=Ca(e),l=Aa(e),c=i*n;s==null?(s=e+i*Au,r=e-c/2):(s=JW(o,s),r=JW(o,r),(i>0?s<r:s>r)&&(s+=i*Au));for(var u,h=s;i>0?h>r:h<r;h-=c)u=WN([o,-l*Ca(h),-l*Aa(h)]),a.point(u[0],u[1])}}function JW(a,e){e=Zy(e),e[0]-=a,$N(e);var n=iDe(-e[1]);return((-e[2]<0?-n:n)+Au-$a)%Au}function Bte(){var a=[],e;return{point:function(n,i,s){e.push([n,i,s])},lineStart:function(){a.push(e=[])},lineEnd:il,rejoin:function(){a.length>1&&a.push(a.pop().concat(a.shift()))},result:function(){var n=a;return a=[],e=null,n}}}function JC(a,e){return es(a[0]-e[0])<$a&&es(a[1]-e[1])<$a}function kM(a,e,n,i){this.x=a,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Ute(a,e,n,i,s){var r=[],o=[],l,c;if(a.forEach(function(x){if(!((T=x.length-1)<=0)){var T,E=x[0],M=x[T],N;if(JC(E,M)){if(!E[2]&&!M[2]){for(s.lineStart(),l=0;l<T;++l)s.point((E=x[l])[0],E[1]);s.lineEnd();return}M[0]+=2*$a}r.push(N=new kM(E,x,null,!0)),o.push(N.o=new kM(E,null,N,!1)),r.push(N=new kM(M,x,null,!1)),o.push(N.o=new kM(M,null,N,!0))}}),!!r.length){for(o.sort(e),ZW(r),ZW(o),l=0,c=o.length;l<c;++l)o[l].e=n=!n;for(var u=r[0],h,f;;){for(var m=u,A=!0;m.v;)if((m=m.n)===u)return;h=m.z,s.lineStart();do{if(m.v=m.o.v=!0,m.e){if(A)for(l=0,c=h.length;l<c;++l)s.point((f=h[l])[0],f[1]);else i(m.x,m.n.x,1,s);m=m.n}else{if(A)for(h=m.p.z,l=h.length-1;l>=0;--l)s.point((f=h[l])[0],f[1]);else i(m.x,m.p.x,-1,s);m=m.p}m=m.o,h=m.z,A=!A}while(!m.v);s.lineEnd()}}}function ZW(a){if(e=a.length){for(var e,n=0,i=a[0],s;++n<e;)i.n=s=a[n],s.p=i,i=s;i.n=s=a[0],s.p=i}}function h5(a){return es(a[0])<=xi?a[0]:nDe(a[0])*((es(a[0])+xi)%Au-xi)}function Vte(a,e){var n=h5(e),i=e[1],s=Aa(i),r=[Aa(n),-Ca(n),0],o=0,l=0,c=new nm;s===1?i=fc+$a:s===-1&&(i=-fc-$a);for(var u=0,h=a.length;u<h;++u)if(m=(f=a[u]).length)for(var f,m,A=f[m-1],x=h5(A),T=A[1]/2+GN,E=Aa(T),M=Ca(T),N=0;N<m;++N,x=F,E=O,M=D,A=I){var I=f[N],F=h5(I),G=I[1]/2+GN,O=Aa(G),D=Ca(G),j=F-x,L=j>=0?1:-1,U=L*j,q=U>xi,K=E*O;if(c.add($u(K*L*Aa(U),M*D+K*Ca(U))),o+=q?j+L*Au:j,q^x>=n^F>=n){var H=lx(Zy(A),Zy(I));$N(H);var X=lx(r,H);$N(X);var ne=(q^j>=0?-1:1)*Tm(X[2]);(i>ne||i===ne&&(H[0]||H[1]))&&(l+=q^j>=0?1:-1)}}return(o<-$a||o<$a&&c<-zN)^l&1}function zte(a,e,n,i){return function(s){var r=e(s),o=Bte(),l=e(o),c=!1,u,h,f,m={point:A,lineStart:T,lineEnd:E,polygonStart:function(){m.point=M,m.lineStart=N,m.lineEnd=I,h=[],u=[]},polygonEnd:function(){m.point=A,m.lineStart=T,m.lineEnd=E,h=QS(h);var F=Vte(u,i);h.length?(c||(s.polygonStart(),c=!0),Ute(h,vDe,F,n,s)):F&&(c||(s.polygonStart(),c=!0),s.lineStart(),n(null,null,1,s),s.lineEnd()),c&&(s.polygonEnd(),c=!1),h=u=null},sphere:function(){s.polygonStart(),s.lineStart(),n(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function A(F,G){a(F,G)&&s.point(F,G)}function x(F,G){r.point(F,G)}function T(){m.point=x,r.lineStart()}function E(){m.point=A,r.lineEnd()}function M(F,G){f.push([F,G]),l.point(F,G)}function N(){l.lineStart(),f=[]}function I(){M(f[0][0],f[0][1]),l.lineEnd();var F=l.clean(),G=o.result(),O,D=G.length,j,L,U;if(f.pop(),u.push(f),f=null,!!D){if(F&1){if(L=G[0],(j=L.length-1)>0){for(c||(s.polygonStart(),c=!0),s.lineStart(),O=0;O<j;++O)s.point((U=L[O])[0],U[1]);s.lineEnd()}return}D>1&&F&2&&G.push(G.pop().concat(G.shift())),h.push(G.filter(yDe))}}return m}}function yDe(a){return a.length>1}function vDe(a,e){return((a=a.x)[0]<0?a[1]-fc-$a:fc-a[1])-((e=e.x)[0]<0?e[1]-fc-$a:fc-e[1])}const e$=zte(function(){return!0},_De,bDe,[-xi,-fc]);function _De(a){var e=NaN,n=NaN,i=NaN,s;return{lineStart:function(){a.lineStart(),s=1},point:function(r,o){var l=r>0?xi:-xi,c=es(r-e);es(c-xi)<$a?(a.point(e,n=(n+o)/2>0?fc:-fc),a.point(i,n),a.lineEnd(),a.lineStart(),a.point(l,n),a.point(r,n),s=0):i!==l&&c>=xi&&(es(e-i)<$a&&(e-=i*$a),es(r-l)<$a&&(r-=l*$a),n=xDe(e,n,r,o),a.point(i,n),a.lineEnd(),a.lineStart(),a.point(l,n),s=0),a.point(e=r,n=o),i=l},lineEnd:function(){a.lineEnd(),e=n=NaN},clean:function(){return 2-s}}}function xDe(a,e,n,i){var s,r,o=Aa(a-n);return es(o)>$a?Kj((Aa(e)*(r=Ca(i))*Aa(n)-Aa(i)*(s=Ca(e))*Aa(a))/(s*r*o)):(e+i)/2}function bDe(a,e,n,i){var s;if(a==null)s=n*fc,i.point(-xi,s),i.point(0,s),i.point(xi,s),i.point(xi,0),i.point(xi,-s),i.point(0,-s),i.point(-xi,-s),i.point(-xi,0),i.point(-xi,s);else if(es(a[0]-e[0])>$a){var r=a[0]<e[0]?xi:-xi;s=n*r/2,i.point(-r,s),i.point(0,s),i.point(r,s)}else i.point(e[0],e[1])}function SDe(a){var e=Ca(a),n=2*ba,i=e>0,s=es(e)>$a;function r(h,f,m,A){ADe(A,a,n,m,h,f)}function o(h,f){return Ca(h)*Ca(f)>e}function l(h){var f,m,A,x,T;return{lineStart:function(){x=A=!1,T=1},point:function(E,M){var N=[E,M],I,F=o(E,M),G=i?F?0:u(E,M):F?u(E+(E<0?xi:-xi),M):0;if(!f&&(x=A=F)&&h.lineStart(),F!==A&&(I=c(f,N),(!I||JC(f,I)||JC(N,I))&&(N[2]=1)),F!==A)T=0,F?(h.lineStart(),I=c(N,f),h.point(I[0],I[1])):(I=c(f,N),h.point(I[0],I[1],2),h.lineEnd()),f=I;else if(s&&f&&i^F){var O;!(G&m)&&(O=c(N,f,!0))&&(T=0,i?(h.lineStart(),h.point(O[0][0],O[0][1]),h.point(O[1][0],O[1][1]),h.lineEnd()):(h.point(O[1][0],O[1][1]),h.lineEnd(),h.lineStart(),h.point(O[0][0],O[0][1],3)))}F&&(!f||!JC(f,N))&&h.point(N[0],N[1]),f=N,A=F,m=G},lineEnd:function(){A&&h.lineEnd(),f=null},clean:function(){return T|(x&&A)<<1}}}function c(h,f,m){var A=Zy(h),x=Zy(f),T=[1,0,0],E=lx(A,x),M=LM(E,E),N=E[0],I=M-N*N;if(!I)return!m&&h;var F=e*M/I,G=-e*N/I,O=lx(T,E),D=DM(T,F),j=DM(E,G);d5(D,j);var L=O,U=LM(D,L),q=LM(L,L),K=U*U-q*(LM(D,D)-1);if(!(K<0)){var H=Sm(K),X=DM(L,(-U-H)/q);if(d5(X,D),X=WN(X),!m)return X;var ne=h[0],Q=f[0],Y=h[1],ue=f[1],pe;Q<ne&&(pe=ne,ne=Q,Q=pe);var Ee=Q-ne,oe=es(Ee-xi)<$a,Ae=oe||Ee<$a;if(!oe&&ue<Y&&(pe=Y,Y=ue,ue=pe),Ae?oe?Y+ue>0^X[1]<(es(X[0]-ne)<$a?Y:ue):Y<=X[1]&&X[1]<=ue:Ee>xi^(ne<=X[0]&&X[0]<=Q)){var be=DM(L,(-U+H)/q);return d5(be,D),[X,WN(be)]}}}function u(h,f){var m=i?a:xi-a,A=0;return h<-m?A|=1:h>m&&(A|=2),f<-m?A|=4:f>m&&(A|=8),A}return zte(o,l,r,i?[0,-a]:[-xi,a-xi])}function TDe(a,e,n,i,s,r){var o=a[0],l=a[1],c=e[0],u=e[1],h=0,f=1,m=c-o,A=u-l,x;if(x=n-o,!(!m&&x>0)){if(x/=m,m<0){if(x<h)return;x<f&&(f=x)}else if(m>0){if(x>f)return;x>h&&(h=x)}if(x=s-o,!(!m&&x<0)){if(x/=m,m<0){if(x>f)return;x>h&&(h=x)}else if(m>0){if(x<h)return;x<f&&(f=x)}if(x=i-l,!(!A&&x>0)){if(x/=A,A<0){if(x<h)return;x<f&&(f=x)}else if(A>0){if(x>f)return;x>h&&(h=x)}if(x=r-l,!(!A&&x<0)){if(x/=A,A<0){if(x>f)return;x>h&&(h=x)}else if(A>0){if(x<h)return;x<f&&(f=x)}return h>0&&(a[0]=o+h*m,a[1]=l+h*A),f<1&&(e[0]=o+f*m,e[1]=l+f*A),!0}}}}}var z2=1e9,OM=-z2;function wDe(a,e,n,i){function s(u,h){return a<=u&&u<=n&&e<=h&&h<=i}function r(u,h,f,m){var A=0,x=0;if(u==null||(A=o(u,f))!==(x=o(h,f))||c(u,h)<0^f>0)do m.point(A===0||A===3?a:n,A>1?i:e);while((A=(A+f+4)%4)!==x);else m.point(h[0],h[1])}function o(u,h){return es(u[0]-a)<$a?h>0?0:3:es(u[0]-n)<$a?h>0?2:1:es(u[1]-e)<$a?h>0?1:0:h>0?3:2}function l(u,h){return c(u.x,h.x)}function c(u,h){var f=o(u,1),m=o(h,1);return f!==m?f-m:f===0?h[1]-u[1]:f===1?u[0]-h[0]:f===2?u[1]-h[1]:h[0]-u[0]}return function(u){var h=u,f=Bte(),m,A,x,T,E,M,N,I,F,G,O,D={point:j,lineStart:K,lineEnd:H,polygonStart:U,polygonEnd:q};function j(ne,Q){s(ne,Q)&&h.point(ne,Q)}function L(){for(var ne=0,Q=0,Y=A.length;Q<Y;++Q)for(var ue=A[Q],pe=1,Ee=ue.length,oe=ue[0],Ae,be,Ce=oe[0],ce=oe[1];pe<Ee;++pe)Ae=Ce,be=ce,oe=ue[pe],Ce=oe[0],ce=oe[1],be<=i?ce>i&&(Ce-Ae)*(i-be)>(ce-be)*(a-Ae)&&++ne:ce<=i&&(Ce-Ae)*(i-be)<(ce-be)*(a-Ae)&&--ne;return ne}function U(){h=f,m=[],A=[],O=!0}function q(){var ne=L(),Q=O&&ne,Y=(m=QS(m)).length;(Q||Y)&&(u.polygonStart(),Q&&(u.lineStart(),r(null,null,1,u),u.lineEnd()),Y&&Ute(m,l,ne,r,u),u.polygonEnd()),h=u,m=A=x=null}function K(){D.point=X,A&&A.push(x=[]),G=!0,F=!1,N=I=NaN}function H(){m&&(X(T,E),M&&F&&f.rejoin(),m.push(f.result())),D.point=j,F&&h.lineEnd()}function X(ne,Q){var Y=s(ne,Q);if(A&&x.push([ne,Q]),G)T=ne,E=Q,M=Y,G=!1,Y&&(h.lineStart(),h.point(ne,Q));else if(Y&&F)h.point(ne,Q);else{var ue=[N=Math.max(OM,Math.min(z2,N)),I=Math.max(OM,Math.min(z2,I))],pe=[ne=Math.max(OM,Math.min(z2,ne)),Q=Math.max(OM,Math.min(z2,Q))];TDe(ue,pe,a,e,n,i)?(F||(h.lineStart(),h.point(ue[0],ue[1])),h.point(pe[0],pe[1]),Y||h.lineEnd(),O=!1):Y&&(h.lineStart(),h.point(ne,Q),O=!1)}N=ne,I=Q,F=Y}return D}}var nO,aO,ZC,e3,cx={sphere:il,point:il,lineStart:EDe,lineEnd:il,polygonStart:il,polygonEnd:il};function EDe(){cx.point=CDe,cx.lineEnd=MDe}function MDe(){cx.point=cx.lineEnd=il}function CDe(a,e){a*=ba,e*=ba,aO=a,ZC=Aa(e),e3=Ca(e),cx.point=NDe}function NDe(a,e){a*=ba,e*=ba;var n=Aa(e),i=Ca(e),s=es(a-aO),r=Ca(s),o=Aa(s),l=i*o,c=e3*n-ZC*i*r,u=ZC*n+e3*i*r;nO.add($u(Sm(l*l+c*c),u)),aO=a,ZC=n,e3=i}function RDe(a){return nO=new nm,w4(a,cx),+nO}var iO=[null,null],PDe={type:"LineString",coordinates:iO};function A0(a,e){return iO[0]=a,iO[1]=e,RDe(PDe)}var t$={Feature:function(a,e){return tR(a.geometry,e)},FeatureCollection:function(a,e){for(var n=a.features,i=-1,s=n.length;++i<s;)if(tR(n[i].geometry,e))return!0;return!1}},n$={Sphere:function(){return!0},Point:function(a,e){return a$(a.coordinates,e)},MultiPoint:function(a,e){for(var n=a.coordinates,i=-1,s=n.length;++i<s;)if(a$(n[i],e))return!0;return!1},LineString:function(a,e){return i$(a.coordinates,e)},MultiLineString:function(a,e){for(var n=a.coordinates,i=-1,s=n.length;++i<s;)if(i$(n[i],e))return!0;return!1},Polygon:function(a,e){return s$(a.coordinates,e)},MultiPolygon:function(a,e){for(var n=a.coordinates,i=-1,s=n.length;++i<s;)if(s$(n[i],e))return!0;return!1},GeometryCollection:function(a,e){for(var n=a.geometries,i=-1,s=n.length;++i<s;)if(tR(n[i],e))return!0;return!1}};function tR(a,e){return a&&n$.hasOwnProperty(a.type)?n$[a.type](a,e):!1}function a$(a,e){return A0(a,e)===0}function i$(a,e){for(var n,i,s,r=0,o=a.length;r<o;r++){if(i=A0(a[r],e),i===0||r>0&&(s=A0(a[r],a[r-1]),s>0&&n<=s&&i<=s&&(n+i-s)*(1-Math.pow((n-i)/s,2))<zN*s))return!0;n=i}return!1}function s$(a,e){return!!Vte(a.map(IDe),Gte(e))}function IDe(a){return a=a.map(Gte),a.pop(),a}function Gte(a){return[a[0]*ba,a[1]*ba]}function LDe(a,e){return(a&&t$.hasOwnProperty(a.type)?t$[a.type]:tR)(a,e)}function r$(a,e,n){var i=s_(a,e-$a,n).concat(e);return function(s){return i.map(function(r){return[s,r]})}}function o$(a,e,n){var i=s_(a,e-$a,n).concat(e);return function(s){return i.map(function(r){return[r,s]})}}function DDe(){var a,e,n,i,s,r,o,l,c=10,u=c,h=90,f=360,m,A,x,T,E=2.5;function M(){return{type:"MultiLineString",coordinates:N()}}function N(){return s_(IM(i/h)*h,n,h).map(x).concat(s_(IM(l/f)*f,o,f).map(T)).concat(s_(IM(e/c)*c,a,c).filter(function(I){return es(I%h)>$a}).map(m)).concat(s_(IM(r/u)*u,s,u).filter(function(I){return es(I%f)>$a}).map(A))}return M.lines=function(){return N().map(function(I){return{type:"LineString",coordinates:I}})},M.outline=function(){return{type:"Polygon",coordinates:[x(i).concat(T(o).slice(1),x(n).reverse().slice(1),T(l).reverse().slice(1))]}},M.extent=function(I){return arguments.length?M.extentMajor(I).extentMinor(I):M.extentMinor()},M.extentMajor=function(I){return arguments.length?(i=+I[0][0],n=+I[1][0],l=+I[0][1],o=+I[1][1],i>n&&(I=i,i=n,n=I),l>o&&(I=l,l=o,o=I),M.precision(E)):[[i,l],[n,o]]},M.extentMinor=function(I){return arguments.length?(e=+I[0][0],a=+I[1][0],r=+I[0][1],s=+I[1][1],e>a&&(I=e,e=a,a=I),r>s&&(I=r,r=s,s=I),M.precision(E)):[[e,r],[a,s]]},M.step=function(I){return arguments.length?M.stepMajor(I).stepMinor(I):M.stepMinor()},M.stepMajor=function(I){return arguments.length?(h=+I[0],f=+I[1],M):[h,f]},M.stepMinor=function(I){return arguments.length?(c=+I[0],u=+I[1],M):[c,u]},M.precision=function(I){return arguments.length?(E=+I,m=r$(r,s,90),A=o$(e,a,E),x=r$(l,o,90),T=o$(i,n,E),M):E},M.extentMajor([[-180,-90+$a],[180,90-$a]]).extentMinor([[-180,-80-$a],[180,80+$a]])}function kDe(){return DDe()()}function Xj(a,e){var n=a[0]*ba,i=a[1]*ba,s=e[0]*ba,r=e[1]*ba,o=Ca(i),l=Aa(i),c=Ca(r),u=Aa(r),h=o*Ca(n),f=o*Aa(n),m=c*Ca(s),A=c*Aa(s),x=2*Tm(Sm(jW(r-i)+o*c*jW(s-n))),T=Aa(x),E=x?function(M){var N=Aa(M*=x)/T,I=Aa(x-M)/T,F=I*h+N*m,G=I*f+N*A,O=I*l+N*u;return[$u(G,F)*Js,$u(O,Sm(F*F+G*G))*Js]}:function(){return[n*Js,i*Js]};return E.distance=x,E}const l$=a=>a;var ux=1/0,nR=ux,tT=-ux,aR=tT,c$={point:ODe,lineStart:il,lineEnd:il,polygonStart:il,polygonEnd:il,result:function(){var a=[[ux,nR],[tT,aR]];return tT=aR=-(nR=ux=1/0),a}};function ODe(a,e){a<ux&&(ux=a),a>tT&&(tT=a),e<nR&&(nR=e),e>aR&&(aR=e)}function Qj(a){return function(e){var n=new sO;for(var i in a)n[i]=a[i];return n.stream=e,n}}function sO(){}sO.prototype={constructor:sO,point:function(a,e){this.stream.point(a,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Jj(a,e,n){var i=a.clipExtent&&a.clipExtent();return a.scale(150).translate([0,0]),i!=null&&a.clipExtent(null),w4(n,a.stream(c$)),e(c$.result()),i!=null&&a.clipExtent(i),a}function qte(a,e,n){return Jj(a,function(i){var s=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=Math.min(s/(i[1][0]-i[0][0]),r/(i[1][1]-i[0][1])),l=+e[0][0]+(s-o*(i[1][0]+i[0][0]))/2,c=+e[0][1]+(r-o*(i[1][1]+i[0][1]))/2;a.scale(150*o).translate([l,c])},n)}function FDe(a,e,n){return qte(a,[[0,0],e],n)}function jDe(a,e,n){return Jj(a,function(i){var s=+e,r=s/(i[1][0]-i[0][0]),o=(s-r*(i[1][0]+i[0][0]))/2,l=-r*i[0][1];a.scale(150*r).translate([o,l])},n)}function BDe(a,e,n){return Jj(a,function(i){var s=+e,r=s/(i[1][1]-i[0][1]),o=-r*i[0][0],l=(s-r*(i[1][1]+i[0][1]))/2;a.scale(150*r).translate([o,l])},n)}var u$=16,UDe=Ca(30*ba);function d$(a,e){return+e?zDe(a,e):VDe(a)}function VDe(a){return Qj({point:function(e,n){e=a(e,n),this.stream.point(e[0],e[1])}})}function zDe(a,e){function n(i,s,r,o,l,c,u,h,f,m,A,x,T,E){var M=u-i,N=h-s,I=M*M+N*N;if(I>4*e&&T--){var F=o+m,G=l+A,O=c+x,D=Sm(F*F+G*G+O*O),j=Tm(O/=D),L=es(es(O)-1)<$a||es(r-f)<$a?(r+f)/2:$u(G,F),U=a(L,j),q=U[0],K=U[1],H=q-i,X=K-s,ne=N*H-M*X;(ne*ne/I>e||es((M*H+N*X)/I-.5)>.3||o*m+l*A+c*x<UDe)&&(n(i,s,r,o,l,c,q,K,L,F/=D,G/=D,O,T,E),E.point(q,K),n(q,K,L,F,G,O,u,h,f,m,A,x,T,E))}}return function(i){var s,r,o,l,c,u,h,f,m,A,x,T,E={point:M,lineStart:N,lineEnd:F,polygonStart:function(){i.polygonStart(),E.lineStart=G},polygonEnd:function(){i.polygonEnd(),E.lineStart=N}};function M(j,L){j=a(j,L),i.point(j[0],j[1])}function N(){f=NaN,E.point=I,i.lineStart()}function I(j,L){var U=Zy([j,L]),q=a(j,L);n(f,m,h,A,x,T,f=q[0],m=q[1],h=j,A=U[0],x=U[1],T=U[2],u$,i),i.point(f,m)}function F(){E.point=M,i.lineEnd()}function G(){N(),E.point=O,E.lineEnd=D}function O(j,L){I(s=j,L),r=f,o=m,l=A,c=x,u=T,E.point=I}function D(){n(f,m,h,A,x,T,r,o,s,l,c,u,u$,i),E.lineEnd=F,F()}return E}}var GDe=Qj({point:function(a,e){this.stream.point(a*ba,e*ba)}});function qDe(a){return Qj({point:function(e,n){var i=a(e,n);return this.stream.point(i[0],i[1])}})}function HDe(a,e,n,i,s){function r(o,l){return o*=i,l*=s,[e+a*o,n-a*l]}return r.invert=function(o,l){return[(o-e)/a*i,(n-l)/a*s]},r}function h$(a,e,n,i,s,r){if(!r)return HDe(a,e,n,i,s);var o=Ca(r),l=Aa(r),c=o*a,u=l*a,h=o/a,f=l/a,m=(l*n-o*e)/a,A=(l*e+o*n)/a;function x(T,E){return T*=i,E*=s,[c*T-u*E+e,n-u*T-c*E]}return x.invert=function(T,E){return[i*(h*T-f*E+m),s*(A-f*T-h*E)]},x}function WDe(a){return $De(function(){return a})()}function $De(a){var e,n=150,i=480,s=250,r=0,o=0,l=0,c=0,u=0,h,f=0,m=1,A=1,x=null,T=e$,E=null,M,N,I,F=l$,G=.5,O,D,j,L,U;function q(ne){return j(ne[0]*ba,ne[1]*ba)}function K(ne){return ne=j.invert(ne[0],ne[1]),ne&&[ne[0]*Js,ne[1]*Js]}q.stream=function(ne){return L&&U===ne?L:L=GDe(qDe(h)(T(O(F(U=ne)))))},q.preclip=function(ne){return arguments.length?(T=ne,x=void 0,X()):T},q.postclip=function(ne){return arguments.length?(F=ne,E=M=N=I=null,X()):F},q.clipAngle=function(ne){return arguments.length?(T=+ne?SDe(x=ne*ba):(x=null,e$),X()):x*Js},q.clipExtent=function(ne){return arguments.length?(F=ne==null?(E=M=N=I=null,l$):wDe(E=+ne[0][0],M=+ne[0][1],N=+ne[1][0],I=+ne[1][1]),X()):E==null?null:[[E,M],[N,I]]},q.scale=function(ne){return arguments.length?(n=+ne,H()):n},q.translate=function(ne){return arguments.length?(i=+ne[0],s=+ne[1],H()):[i,s]},q.center=function(ne){return arguments.length?(r=ne[0]%360*ba,o=ne[1]%360*ba,H()):[r*Js,o*Js]},q.rotate=function(ne){return arguments.length?(l=ne[0]%360*ba,c=ne[1]%360*ba,u=ne.length>2?ne[2]%360*ba:0,H()):[l*Js,c*Js,u*Js]},q.angle=function(ne){return arguments.length?(f=ne%360*ba,H()):f*Js},q.reflectX=function(ne){return arguments.length?(m=ne?-1:1,H()):m<0},q.reflectY=function(ne){return arguments.length?(A=ne?-1:1,H()):A<0},q.precision=function(ne){return arguments.length?(O=d$(D,G=ne*ne),X()):Sm(G)},q.fitExtent=function(ne,Q){return qte(q,ne,Q)},q.fitSize=function(ne,Q){return FDe(q,ne,Q)},q.fitWidth=function(ne,Q){return jDe(q,ne,Q)},q.fitHeight=function(ne,Q){return BDe(q,ne,Q)};function H(){var ne=h$(n,0,0,m,A,f).apply(null,e(r,o)),Q=h$(n,i-ne[0],s-ne[1],m,A,f);return h=jte(l,c,u),D=eO(e,Q),j=eO(h,D),O=d$(D,G),X()}function X(){return L=U=null,q}return function(){return e=a.apply(this,arguments),q.invert=e.invert&&K,H()}}function KDe(a){return function(e,n){var i=Sm(e*e+n*n),s=a(i),r=Aa(s),o=Ca(s);return[$u(e*r,i*o),Tm(i&&n*r/i)]}}function Zj(a,e){return[a,tDe(aDe((fc+e)/2))]}Zj.invert=function(a,e){return[a,2*Kj(eDe(e))-fc]};function Hte(a,e){var n=Ca(e),i=1+Ca(a)*n;return[n*Aa(a)/i,Aa(e)/i]}Hte.invert=KDe(function(a){return 2*Kj(a)});function YDe(){return WDe(Hte).scale(250).clipAngle(142)}function rO(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=Array(e);n<e;n++)i[n]=a[n];return i}function XDe(a){if(Array.isArray(a))return a}function QDe(a){if(Array.isArray(a))return rO(a)}function hS(a,e,n){if(typeof a=="function"?a===e:a.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function JDe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function ZDe(a,e,n){return e=iR(e),c5e(a,$te()?Reflect.construct(e,[],iR(a).constructor):e.apply(a,n))}function Wte(a,e){if(e.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function e5e(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function Ga(a,e){return a.get(hS(a,e))}function hg(a,e,n){Wte(a,e),e.set(a,n)}function fg(a,e,n){return a.set(hS(a,e),n),n}function t5e(a,e){Wte(a,e),e.add(a)}function n5e(a,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,Yte(i.key),i)}}function a5e(a,e,n){return e&&n5e(a.prototype,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Mv(a,e,n){return(e=Yte(e))in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}function iR(a){return iR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},iR(a)}function i5e(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&oO(a,e)}function $te(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($te=function(){return!!a})()}function s5e(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function r5e(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i,s,r,o,l=[],c=!0,u=!1;try{if(r=(n=n.call(a)).next,e!==0)for(;!(c=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function o5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c5e(a,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JDe(a)}function oO(a,e){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oO(a,e)}function t3(a,e){return XDe(a)||r5e(a,e)||Xte(a,e)||o5e()}function Kte(a){return QDe(a)||s5e(a)||Xte(a)||l5e()}function u5e(a,e){if(typeof a!="object"||!a)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var i=n.call(a,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}function Yte(a){var e=u5e(a,"string");return typeof e=="symbol"?e:e+""}function Xte(a,e){if(a){if(typeof a=="string")return rO(a,e);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rO(a,e):void 0}}var Qte=function(e){e instanceof Array?e.forEach(Qte):(e.map&&e.map.dispose(),e.dispose())},Jte=function(e){e.geometry&&e.geometry.dispose(),e.material&&Qte(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(Jte)},f$=function(e){if(e&&e.children)for(;e.children.length;){var n=e.children[0];e.remove(n),Jte(n)}};function Zte(a,e,n){var i=(90-a)*Math.PI/180,s=(90-e)*Math.PI/180;return{x:n*Math.sin(i)*Math.cos(s),y:n*Math.cos(i),z:n*Math.sin(i)*Math.sin(s)}}function d5e(a){var e=a.x,n=a.y,i=a.z,s=Math.sqrt(e*e+n*n+i*i),r=Math.acos(n/s),o=Math.atan2(i,e);return{lat:90-r*180/Math.PI,lng:90-o*180/Math.PI-(o<-Math.PI/2?360:0),r:s}}function AA(a){return a*Math.PI/180}var ene=function(e){return 1-(Zj(0,(.5-e)*Math.PI)[1]/Math.PI+1)/2},f5=function(e){return Math.max(0,Math.min(1,ene(e)))},p$=function(e){return .5-Zj.invert(0,(2*(1-e)-1)*Math.PI)[1]/Math.PI},h5e=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=bm().domain([1,0]).range([n,i]).clamp(!0),r=bm().domain([f5(n),f5(i)]).range([1,0]).clamp(!0),o=function(f){return r(f5(s(f)))},l=e.array,c=0,u=l.length;c<u;c+=2)l[c+1]=o(l[c+1]);e.needsUpdate=!0},m$=function(e,n,i,s){var r=Math.pow(2,e),o=Math.max(0,Math.min(r-1,Math.floor((i+180)*r/360))),l=(90-s)/180;n&&(l=Math.max(0,Math.min(1,ene(l))));var c=Math.floor(l*r);return[o,c]},lO=function(e,n){for(var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,l=[],c=Math.pow(2,e),u=360/c,h=180/c,f=r===void 0?c-1:r,m=o===void 0?c-1:o,A=i,x=Math.min(c-1,f);A<=x;A++)for(var T=s,E=Math.min(c-1,m);T<=E;T++){var M=T,N=h;if(n){M=T===0?T:p$(T/c)*c;var I=T+1===c?T+1:p$((T+1)/c)*c;N=(I-M)*180/c}var F=-180+(A+.5)*u,G=90-(M*180/c+N/2),O=N;l.push({x:A,y:T,lng:F,lat:G,latLen:O})}return l},f5e=6,p5e=7,m5e=3,g5e=90,Fh=new WeakMap,Pg=new WeakMap,p5=new WeakMap,FM=new WeakMap,ku=new WeakMap,sR=new WeakMap,E_=new WeakMap,yA=new WeakMap,jM=new WeakSet,A5e=(function(a){function e(n){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=s.tileUrl,o=s.minLevel,l=o===void 0?0:o,c=s.maxLevel,u=c===void 0?17:c,h=s.mercatorProjection,f=h===void 0?!0:h;return e5e(this,e),i=ZDe(this,e),t5e(i,jM),hg(i,Fh,void 0),hg(i,Pg,void 0),hg(i,p5,void 0),hg(i,FM,void 0),hg(i,ku,{}),hg(i,sR,void 0),hg(i,E_,void 0),hg(i,yA,void 0),Mv(i,"minLevel",void 0),Mv(i,"maxLevel",void 0),Mv(i,"thresholds",Kte(new Array(30)).map(function(m,A){return 8/Math.pow(2,A)})),Mv(i,"curvatureResolution",5),Mv(i,"tileMargin",0),Mv(i,"clearTiles",function(){Object.values(Ga(ku,i)).forEach(function(m){m.forEach(function(A){A.obj&&(i.remove(A.obj),f$(A.obj),delete A.obj)})}),fg(ku,i,{})}),fg(Fh,i,n),i.tileUrl=r,fg(Pg,i,f),i.minLevel=l,i.maxLevel=u,i.level=0,i.add(fg(yA,i,new Na(new vu(Ga(Fh,i)*.99,180,90),new oo({color:0})))),Ga(yA,i).visible=!1,Ga(yA,i).material.polygonOffset=!0,Ga(yA,i).material.polygonOffsetUnits=3,Ga(yA,i).material.polygonOffsetFactor=1,i}return i5e(e,a),a5e(e,[{key:"tileUrl",get:function(){return Ga(p5,this)},set:function(i){fg(p5,this,i),this.updatePov(Ga(E_,this))}},{key:"level",get:function(){return Ga(FM,this)},set:function(i){var s,r=this;Ga(ku,this)[i]||hS(jM,this,y5e).call(this,i);var o=Ga(FM,this);if(fg(FM,this,i),!(i===o||o===void 0)){if(Ga(yA,this).visible=i>0,Ga(ku,this)[i].forEach(function(c){return c.obj&&(c.obj.material.depthWrite=!0)}),o<i&&((s=Ga(ku,this)[o])===null||s===void 0||s.forEach(function(c){return c.obj&&(c.obj.material.depthWrite=!1)})),o>i)for(var l=i+1;l<=o;l++)Ga(ku,this)[l]&&Ga(ku,this)[l].forEach(function(c){c.obj&&(r.remove(c.obj),f$(c.obj),delete c.obj)});hS(jM,this,g$).call(this)}}},{key:"updatePov",value:function(i){var s=this;if(!(!i||!(i instanceof u1))){fg(E_,this,i);var r;if(fg(sR,this,function(h){if(!h.hullPnts){var f=360/Math.pow(2,s.level),m=h.lng,A=h.lat,x=h.latLen,T=m-f/2,E=m+f/2,M=A-x/2,N=A+x/2;h.hullPnts=[[A,m],[M,T],[N,T],[M,E],[N,E]].map(function(I){var F=t3(I,2),G=F[0],O=F[1];return Zte(G,O,Ga(Fh,s))}).map(function(I){var F=I.x,G=I.y,O=I.z;return new ye(F,G,O)})}return r||(r=new C0,i.updateMatrix(),i.updateMatrixWorld(),r.setFromProjectionMatrix(new _n().multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse))),h.hullPnts.some(function(I){return r.containsPoint(I.clone().applyMatrix4(s.matrixWorld))})}),this.tileUrl){var o=i.position.clone(),l=o.distanceTo(this.getWorldPosition(new ye)),c=(l-Ga(Fh,this))/Ga(Fh,this),u=this.thresholds.findIndex(function(h){return h&&h<=c});this.level=Math.min(this.maxLevel,Math.max(this.minLevel,u<0?this.thresholds.length:u)),hS(jM,this,g$).call(this)}}}}])})(ll);function y5e(a){var e=this;if(a>p5e){Ga(ku,this)[a]=[];return}var n=Ga(ku,this)[a]=lO(a,Ga(Pg,this));n.forEach(function(i){return i.centroid=Zte(i.lat,i.lng,Ga(Fh,e))}),n.octree=fte().x(function(i){return i.centroid.x}).y(function(i){return i.centroid.y}).z(function(i){return i.centroid.z}).addAll(n)}function g$(){var a=this;if(!(!this.tileUrl||this.level===void 0||!Ga(ku,this).hasOwnProperty(this.level))&&!(!Ga(sR,this)&&this.level>f5e)){var e=Ga(ku,this)[this.level];if(Ga(E_,this)){var n=this.worldToLocal(Ga(E_,this).position.clone());if(e.octree){var i,s=this.worldToLocal(Ga(E_,this).position.clone()),r=(s.length()-Ga(Fh,this))*m5e;e=(i=e.octree).findAllWithinRadius.apply(i,Kte(s).concat([r]))}else{var o=d5e(n),l=(o.r/Ga(Fh,this)-1)*g5e,c=l/Math.cos(AA(o.lat)),u=[o.lng-c,o.lng+c],h=[o.lat+l,o.lat-l],f=m$(this.level,Ga(Pg,this),u[0],h[0]),m=t3(f,2),A=m[0],x=m[1],T=m$(this.level,Ga(Pg,this),u[1],h[1]),E=t3(T,2),M=E[0],N=E[1];!e.record&&(e.record={});var I=e.record;if(!I.hasOwnProperty("".concat(Math.round((A+M)/2),"_").concat(Math.round((x+N)/2))))e=lO(this.level,Ga(Pg,this),A,x,M,N).map(function(j){var L="".concat(j.x,"_").concat(j.y);return I.hasOwnProperty(L)?I[L]:(I[L]=j,e.push(j),j)});else{for(var F=[],G=A;G<=M;G++)for(var O=x;O<=N;O++){var D="".concat(G,"_").concat(O);I.hasOwnProperty(D)||(I[D]=lO(this.level,Ga(Pg,this),G,O,G,O)[0],e.push(I[D])),F.push(I[D])}e=F}}}e.filter(function(j){return!j.obj}).filter(Ga(sR,this)||function(){return!0}).forEach(function(j){var L=j.x,U=j.y,q=j.lng,K=j.lat,H=j.latLen,X=360/Math.pow(2,a.level);if(!j.obj){var ne=X*(1-a.tileMargin),Q=H*(1-a.tileMargin),Y=AA(q),ue=AA(-K),pe=new Na(new vu(Ga(Fh,a),Math.ceil(ne/a.curvatureResolution),Math.ceil(Q/a.curvatureResolution),AA(90-ne/2)+Y,AA(ne),AA(90-Q/2)+ue,AA(Q)),new nh);if(Ga(Pg,a)){var Ee=[K+H/2,K-H/2].map(function(Ce){return .5-Ce/180}),oe=t3(Ee,2),Ae=oe[0],be=oe[1];h5e(pe.geometry.attributes.uv,Ae,be)}j.obj=pe}j.loading||(j.loading=!0,new g4().load(a.tileUrl(L,U,a.level),function(Ce){var ce=j.obj;ce&&(Ce.colorSpace=Fr,ce.material.map=Ce,ce.material.color=null,ce.material.needsUpdate=!0,a.add(ce)),j.loading=!1}))})}}function v5e(a,e,n=2){const i=e&&e.length,s=i?e[0]*n:a.length;let r=tne(a,0,s,n,!0);const o=[];if(!r||r.next===r.prev)return o;let l,c,u;if(i&&(r=T5e(a,e,r,n)),a.length>80*n){l=a[0],c=a[1];let h=l,f=c;for(let m=n;m<s;m+=n){const A=a[m],x=a[m+1];A<l&&(l=A),x<c&&(c=x),A>h&&(h=A),x>f&&(f=x)}u=Math.max(h-l,f-c),u=u!==0?32767/u:0}return nT(r,o,n,l,c,u,0),o}function tne(a,e,n,i,s){let r;if(s===k5e(a,e,n,i)>0)for(let o=e;o<n;o+=i)r=A$(o/i|0,a[o],a[o+1],r);else for(let o=n-i;o>=e;o-=i)r=A$(o/i|0,a[o],a[o+1],r);return r&&dx(r,r.next)&&(iT(r),r=r.next),r}function e1(a,e){if(!a)return a;e||(e=a);let n=a,i;do if(i=!1,!n.steiner&&(dx(n,n.next)||Bs(n.prev,n,n.next)===0)){if(iT(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function nT(a,e,n,i,s,r,o){if(!a)return;!o&&r&&N5e(a,i,s,r);let l=a;for(;a.prev!==a.next;){const c=a.prev,u=a.next;if(r?x5e(a,i,s,r):_5e(a)){e.push(c.i,a.i,u.i),iT(a),a=u.next,l=u.next;continue}if(a=u,a===l){o?o===1?(a=b5e(e1(a),e),nT(a,e,n,i,s,r,2)):o===2&&S5e(a,e,n,i,s,r):nT(e1(a),e,n,i,s,r,1);break}}}function _5e(a){const e=a.prev,n=a,i=a.next;if(Bs(e,n,i)>=0)return!1;const s=e.x,r=n.x,o=i.x,l=e.y,c=n.y,u=i.y,h=Math.min(s,r,o),f=Math.min(l,c,u),m=Math.max(s,r,o),A=Math.max(l,c,u);let x=i.next;for(;x!==e;){if(x.x>=h&&x.x<=m&&x.y>=f&&x.y<=A&&G2(s,l,r,c,o,u,x.x,x.y)&&Bs(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function x5e(a,e,n,i){const s=a.prev,r=a,o=a.next;if(Bs(s,r,o)>=0)return!1;const l=s.x,c=r.x,u=o.x,h=s.y,f=r.y,m=o.y,A=Math.min(l,c,u),x=Math.min(h,f,m),T=Math.max(l,c,u),E=Math.max(h,f,m),M=cO(A,x,e,n,i),N=cO(T,E,e,n,i);let I=a.prevZ,F=a.nextZ;for(;I&&I.z>=M&&F&&F.z<=N;){if(I.x>=A&&I.x<=T&&I.y>=x&&I.y<=E&&I!==s&&I!==o&&G2(l,h,c,f,u,m,I.x,I.y)&&Bs(I.prev,I,I.next)>=0||(I=I.prevZ,F.x>=A&&F.x<=T&&F.y>=x&&F.y<=E&&F!==s&&F!==o&&G2(l,h,c,f,u,m,F.x,F.y)&&Bs(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;I&&I.z>=M;){if(I.x>=A&&I.x<=T&&I.y>=x&&I.y<=E&&I!==s&&I!==o&&G2(l,h,c,f,u,m,I.x,I.y)&&Bs(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;F&&F.z<=N;){if(F.x>=A&&F.x<=T&&F.y>=x&&F.y<=E&&F!==s&&F!==o&&G2(l,h,c,f,u,m,F.x,F.y)&&Bs(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function b5e(a,e){let n=a;do{const i=n.prev,s=n.next.next;!dx(i,s)&&ane(i,n,n.next,s)&&aT(i,s)&&aT(s,i)&&(e.push(i.i,n.i,s.i),iT(n),iT(n.next),n=a=s),n=n.next}while(n!==a);return e1(n)}function S5e(a,e,n,i,s,r){let o=a;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&I5e(o,l)){let c=ine(o,l);o=e1(o,o.next),c=e1(c,c.next),nT(o,e,n,i,s,r,0),nT(c,e,n,i,s,r,0);return}l=l.next}o=o.next}while(o!==a)}function T5e(a,e,n,i){const s=[];for(let r=0,o=e.length;r<o;r++){const l=e[r]*i,c=r<o-1?e[r+1]*i:a.length,u=tne(a,l,c,i,!1);u===u.next&&(u.steiner=!0),s.push(P5e(u))}s.sort(w5e);for(let r=0;r<s.length;r++)n=E5e(s[r],n);return n}function w5e(a,e){let n=a.x-e.x;if(n===0&&(n=a.y-e.y,n===0)){const i=(a.next.y-a.y)/(a.next.x-a.x),s=(e.next.y-e.y)/(e.next.x-e.x);n=i-s}return n}function E5e(a,e){const n=M5e(a,e);if(!n)return e;const i=ine(n,a);return e1(i,i.next),e1(n,n.next)}function M5e(a,e){let n=e;const i=a.x,s=a.y;let r=-1/0,o;if(dx(a,n))return n;do{if(dx(a,n.next))return n.next;if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){const f=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(f<=i&&f>r&&(r=f,o=n.x<n.next.x?n:n.next,f===i))return o}n=n.next}while(n!==e);if(!o)return null;const l=o,c=o.x,u=o.y;let h=1/0;n=o;do{if(i>=n.x&&n.x>=c&&i!==n.x&&nne(s<u?i:r,s,c,u,s<u?r:i,s,n.x,n.y)){const f=Math.abs(s-n.y)/(i-n.x);aT(n,a)&&(f<h||f===h&&(n.x>o.x||n.x===o.x&&C5e(o,n)))&&(o=n,h=f)}n=n.next}while(n!==l);return o}function C5e(a,e){return Bs(a.prev,a,e.prev)<0&&Bs(e.next,a,a.next)<0}function N5e(a,e,n,i){let s=a;do s.z===0&&(s.z=cO(s.x,s.y,e,n,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==a);s.prevZ.nextZ=null,s.prevZ=null,R5e(s)}function R5e(a){let e,n=1;do{let i=a,s;a=null;let r=null;for(e=0;i;){e++;let o=i,l=0;for(let u=0;u<n&&(l++,o=o.nextZ,!!o);u++);let c=n;for(;l>0||c>0&&o;)l!==0&&(c===0||!o||i.z<=o.z)?(s=i,i=i.nextZ,l--):(s=o,o=o.nextZ,c--),r?r.nextZ=s:a=s,s.prevZ=r,r=s;i=o}r.nextZ=null,n*=2}while(e>1);return a}function cO(a,e,n,i,s){return a=(a-n)*s|0,e=(e-i)*s|0,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,a|e<<1}function P5e(a){let e=a,n=a;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==a);return n}function nne(a,e,n,i,s,r,o,l){return(s-o)*(e-l)>=(a-o)*(r-l)&&(a-o)*(i-l)>=(n-o)*(e-l)&&(n-o)*(r-l)>=(s-o)*(i-l)}function G2(a,e,n,i,s,r,o,l){return!(a===o&&e===l)&&nne(a,e,n,i,s,r,o,l)}function I5e(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!L5e(a,e)&&(aT(a,e)&&aT(e,a)&&D5e(a,e)&&(Bs(a.prev,a,e.prev)||Bs(a,e.prev,e))||dx(a,e)&&Bs(a.prev,a,a.next)>0&&Bs(e.prev,e,e.next)>0)}function Bs(a,e,n){return(e.y-a.y)*(n.x-e.x)-(e.x-a.x)*(n.y-e.y)}function dx(a,e){return a.x===e.x&&a.y===e.y}function ane(a,e,n,i){const s=UM(Bs(a,e,n)),r=UM(Bs(a,e,i)),o=UM(Bs(n,i,a)),l=UM(Bs(n,i,e));return!!(s!==r&&o!==l||s===0&&BM(a,n,e)||r===0&&BM(a,i,e)||o===0&&BM(n,a,i)||l===0&&BM(n,e,i))}function BM(a,e,n){return e.x<=Math.max(a.x,n.x)&&e.x>=Math.min(a.x,n.x)&&e.y<=Math.max(a.y,n.y)&&e.y>=Math.min(a.y,n.y)}function UM(a){return a>0?1:a<0?-1:0}function L5e(a,e){let n=a;do{if(n.i!==a.i&&n.next.i!==a.i&&n.i!==e.i&&n.next.i!==e.i&&ane(n,n.next,a,e))return!0;n=n.next}while(n!==a);return!1}function aT(a,e){return Bs(a.prev,a,a.next)<0?Bs(a,e,a.next)>=0&&Bs(a,a.prev,e)>=0:Bs(a,e,a.prev)<0||Bs(a,a.next,e)<0}function D5e(a,e){let n=a,i=!1;const s=(a.x+e.x)/2,r=(a.y+e.y)/2;do n.y>r!=n.next.y>r&&n.next.y!==n.y&&s<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==a);return i}function ine(a,e){const n=uO(a.i,a.x,a.y),i=uO(e.i,e.x,e.y),s=a.next,r=e.prev;return a.next=e,e.prev=a,n.next=s,s.prev=n,i.next=n,n.prev=i,r.next=i,i.prev=r,i}function A$(a,e,n,i){const s=uO(a,e,n);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function iT(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function uO(a,e,n){return{i:a,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function k5e(a,e,n,i){let s=0;for(let r=e,o=n-i;r<n;r+=i)s+=(a[o]-a[r])*(a[r+1]+a[o+1]),o=r;return s}function rR(a){const e=[],n=[],i=a[0][0].length;let s=0,r=0;for(const o of a){for(const l of o)for(let c=0;c<i;c++)e.push(l[c]);r&&(s+=r,n.push(s)),r=o.length}return{vertices:e,holes:n,dimensions:i}}function dO(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=Array(e);n<e;n++)i[n]=a[n];return i}function O5e(a){if(Array.isArray(a))return a}function F5e(a){if(Array.isArray(a))return dO(a)}function j5e(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function B5e(a,e,n){return e=oR(e),K5e(a,sne()?Reflect.construct(e,[],oR(a).constructor):e.apply(a,n))}function U5e(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function V5e(a,e,n){return Object.defineProperty(a,"prototype",{writable:!1}),a}function z5e(a,e){var n=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!n){if(Array.isArray(a)||(n=eB(a))||e){n&&(a=n);var i=0,s=function(){};return{s,n:function(){return i>=a.length?{done:!0}:{done:!1,value:a[i++]}},e:function(c){throw c},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var r,o=!0,l=!1;return{s:function(){n=n.call(a)},n:function(){var c=n.next();return o=c.done,c},e:function(c){l=!0,r=c},f:function(){try{o||n.return==null||n.return()}finally{if(l)throw r}}}}function oR(a){return oR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oR(a)}function G5e(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&hO(a,e)}function sne(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sne=function(){return!!a})()}function q5e(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function H5e(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i,s,r,o,l=[],c=!0,u=!1;try{if(r=(n=n.call(a)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function W5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function K5e(a,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j5e(a)}function hO(a,e){return hO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hO(a,e)}function i2(a,e){return O5e(a)||H5e(a,e)||eB(a,e)||W5e()}function Y5e(a){return F5e(a)||q5e(a)||eB(a)||$5e()}function eB(a,e){if(a){if(typeof a=="string")return dO(a,e);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dO(a,e):void 0}}var y$=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=[],s=null;return e.forEach(function(r){if(s){var o=A0(r,s)*180/Math.PI;if(o>n)for(var l=Xj(s,r),c=s.length>2||r.length>2?eT(s[2]||0,r[2]||0):null,u=c?function(m){return[].concat(Y5e(l(m)),[c(m)])}:l,h=1/Math.ceil(o/n),f=h;f<1;)i.push(u(f)),f+=h}i.push(s=r)}),i},fO=typeof window<"u"&&window.THREE?window.THREE:{BufferGeometry:zn,Float32BufferAttribute:mn},X5e=new fO.BufferGeometry().setAttribute?"setAttribute":"addAttribute",rne=(function(a){function e(n){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;U5e(this,e),i=B5e(this,e),i.type="GeoJsonGeometry",i.parameters={geoJson:n,radius:s,resolution:r};var o=({Point:h,MultiPoint:f,LineString:m,MultiLineString:A,Polygon:x,MultiPolygon:T}[n.type]||function(){return[]})(n.coordinates,s),l=[],c=[],u=0;o.forEach(function(E){var M=l.length;s2({indices:l,vertices:c},E),i.addGroup(M,l.length-M,u++)}),l.length&&i.setIndex(l),c.length&&i[X5e]("position",new fO.Float32BufferAttribute(c,3));function h(E,M){var N=m5(E[1],E[0],M+(E[2]||0)),I=[];return[{vertices:N,indices:I}]}function f(E,M){var N={vertices:[],indices:[]};return E.map(function(I){return h(I,M)}).forEach(function(I){var F=i2(I,1),G=F[0];s2(N,G)}),[N]}function m(E,M){for(var N=y$(E,r).map(function(j){var L=i2(j,3),U=L[0],q=L[1],K=L[2],H=K===void 0?0:K;return m5(q,U,M+H)}),I=rR([N]),F=I.vertices,G=Math.round(F.length/3),O=[],D=1;D<G;D++)O.push(D-1,D);return[{vertices:F,indices:O}]}function A(E,M){var N={vertices:[],indices:[]};return E.map(function(I){return m(I,M)}).forEach(function(I){var F=i2(I,1),G=F[0];s2(N,G)}),[N]}function x(E,M){for(var N=E.map(function(ne){return y$(ne,r).map(function(Q){var Y=i2(Q,3),ue=Y[0],pe=Y[1],Ee=Y[2],oe=Ee===void 0?0:Ee;return m5(pe,ue,M+oe)})}),I=rR(N),F=I.vertices,G=I.holes,O=G[0]||1/0,D=F.slice(0,O*3),j=F.slice(O*3),L=new Set(G),U=Math.round(F.length/3),q=[],K=[],H=1;H<U;H++)L.has(H)||(H<O?q.push(H-1,H):K.push(H-1-O,H-O));var X=[{indices:q,vertices:D}];return G.length&&X.push({indices:K,vertices:j}),X}function T(E,M){var N={vertices:[],indices:[]},I={vertices:[],indices:[]};E.map(function(G){return x(G,M)}).forEach(function(G){var O=i2(G,2),D=O[0],j=O[1];s2(N,D),j&&s2(I,j)});var F=[N];return I.vertices.length&&F.push(I),F}return i}return G5e(e,a),V5e(e)})(fO.BufferGeometry);function s2(a,e){var n=Math.round(a.vertices.length/3);v$(a.vertices,e.vertices),v$(a.indices,e.indices.map(function(i){return i+n}))}function v$(a,e){var n=z5e(e),i;try{for(n.s();!(i=n.n()).done;){var s=i.value;a.push(s)}}catch(r){n.e(r)}finally{n.f()}}function m5(a,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-a)*Math.PI/180,s=(90-e)*Math.PI/180;return[n*Math.sin(i)*Math.cos(s),n*Math.cos(i),n*Math.sin(i)*Math.sin(s)]}function Q5e(a,e,n=!0){if(!e||!e.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!a.hasAttribute("position")||!a.hasAttribute("normal")||!a.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function i(o){if(o.normalized||o.isInterleavedBufferAttribute){const l=new Float32Array(o.count*o.itemSize);for(let c=0,u=0;c<o.count;c++)l[u++]=o.getX(c),l[u++]=o.getY(c),o.itemSize>2&&(l[u++]=o.getZ(c));return l}return o.array instanceof Float32Array?o.array:new Float32Array(o.array)}const s=a.index?a.toNonIndexed():a,r=e.generateTangents(i(s.attributes.position),i(s.attributes.normal),i(s.attributes.uv));if(n)for(let o=3;o<r.length;o+=4)r[o]*=-1;return s.setAttribute("tangent",new Ua(r,4)),a!==s&&a.copy(s),a}function J5e(a,e=!1){const n=a[0].index!==null,i=new Set(Object.keys(a[0].attributes)),s=new Set(Object.keys(a[0].morphAttributes)),r={},o={},l=a[0].morphTargetsRelative,c=new zn;let u=0;for(let h=0;h<a.length;++h){const f=a[h];let m=0;if(n!==(f.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const A in f.attributes){if(!i.has(A))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+A+'" attribute exists among all geometries, or in none of them.'),null;r[A]===void 0&&(r[A]=[]),r[A].push(f.attributes[A]),m++}if(m!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(l!==f.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const A in f.morphAttributes){if(!s.has(A))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;o[A]===void 0&&(o[A]=[]),o[A].push(f.morphAttributes[A])}if(e){let A;if(n)A=f.index.count;else if(f.attributes.position!==void 0)A=f.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;c.addGroup(u,A,h),u+=A}}if(n){let h=0;const f=[];for(let m=0;m<a.length;++m){const A=a[m].index;for(let x=0;x<A.count;++x)f.push(A.getX(x)+h);h+=a[m].attributes.position.count}c.setIndex(f)}for(const h in r){const f=pO(r[h]);if(!f)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+h+" attribute."),null;c.setAttribute(h,f)}for(const h in o){const f=o[h][0].length;if(f===0)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[h]=[];for(let m=0;m<f;++m){const A=[];for(let T=0;T<o[h].length;++T)A.push(o[h][T][m]);const x=pO(A);if(!x)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+h+" morphAttribute."),null;c.morphAttributes[h].push(x)}}return c}function pO(a){let e,n,i,s=-1,r=0;for(let u=0;u<a.length;++u){const h=a[u];if(e===void 0&&(e=h.array.constructor),e!==h.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(n===void 0&&(n=h.itemSize),n!==h.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=h.normalized),i!==h.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(s===-1&&(s=h.gpuType),s!==h.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;r+=h.count*n}const o=new e(r),l=new Ua(o,n,i);let c=0;for(let u=0;u<a.length;++u){const h=a[u];if(h.isInterleavedBufferAttribute){const f=c/n;for(let m=0,A=h.count;m<A;m++)for(let x=0;x<n;x++){const T=h.getComponent(m,x);l.setComponent(m+f,x,T)}}else o.set(h.array,c);c+=h.count*n}return s!==void 0&&(l.gpuType=s),l}function Z5e(a){return a.isInstancedInterleavedBufferAttribute||a.isInterleavedBufferAttribute?lR(a):a.isInstancedBufferAttribute?new _c().copy(a):new Ua().copy(a)}function e6e(a){let e,n=0,i=0;for(let u=0,h=a.length;u<h;++u){const f=a[u];if(e===void 0&&(e=f.array.constructor),e!==f.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;n+=f.array.length,i+=f.itemSize}const s=new zx(new e(n),i);let r=0;const o=[],l=["getX","getY","getZ","getW"],c=["setX","setY","setZ","setW"];for(let u=0,h=a.length;u<h;u++){const f=a[u],m=f.itemSize,A=f.count,x=new kl(s,m,r,f.normalized);o.push(x),r+=m;for(let T=0;T<A;T++)for(let E=0;E<m;E++)x[c[E]](T,f[l[E]](T))}return o}function lR(a){const e=a.data.array.constructor,n=a.count,i=a.itemSize,s=a.normalized,r=new e(n*i);let o;a.isInstancedInterleavedBufferAttribute?o=new _c(r,i,s,a.meshPerAttribute):o=new Ua(r,i,s);for(let l=0;l<n;l++)o.setX(l,a.getX(l)),i>=2&&o.setY(l,a.getY(l)),i>=3&&o.setZ(l,a.getZ(l)),i>=4&&o.setW(l,a.getW(l));return o}function t6e(a){const e=a.attributes,n=a.morphTargets,i=new Map;for(const s in e){const r=e[s];r.isInterleavedBufferAttribute&&(i.has(r)||i.set(r,lR(r)),e[s]=i.get(r))}for(const s in n){const r=n[s];r.isInterleavedBufferAttribute&&(i.has(r)||i.set(r,lR(r)),n[s]=i.get(r))}}function n6e(a){let e=0;for(const i in a.attributes){const s=a.getAttribute(i);e+=s.count*s.itemSize*s.array.BYTES_PER_ELEMENT}const n=a.getIndex();return e+=n?n.count*n.itemSize*n.array.BYTES_PER_ELEMENT:0,e}function a6e(a,e=1e-4){e=Math.max(e,Number.EPSILON);const n={},i=a.getIndex(),s=a.getAttribute("position"),r=i?i.count:s.count;let o=0;const l=Object.keys(a.attributes),c={},u={},h=[],f=["getX","getY","getZ","getW"],m=["setX","setY","setZ","setW"];for(let N=0,I=l.length;N<I;N++){const F=l[N],G=a.attributes[F];c[F]=new G.constructor(new G.array.constructor(G.count*G.itemSize),G.itemSize,G.normalized);const O=a.morphAttributes[F];O&&(u[F]||(u[F]=[]),O.forEach((D,j)=>{const L=new D.array.constructor(D.count*D.itemSize);u[F][j]=new D.constructor(L,D.itemSize,D.normalized)}))}const A=e*.5,x=Math.log10(1/e),T=Math.pow(10,x),E=A*T;for(let N=0;N<r;N++){const I=i?i.getX(N):N;let F="";for(let G=0,O=l.length;G<O;G++){const D=l[G],j=a.getAttribute(D),L=j.itemSize;for(let U=0;U<L;U++)F+=`${~~(j[f[U]](I)*T+E)},`}if(F in n)h.push(n[F]);else{for(let G=0,O=l.length;G<O;G++){const D=l[G],j=a.getAttribute(D),L=a.morphAttributes[D],U=j.itemSize,q=c[D],K=u[D];for(let H=0;H<U;H++){const X=f[H],ne=m[H];if(q[ne](o,j[X](I)),L)for(let Q=0,Y=L.length;Q<Y;Q++)K[Q][ne](o,L[Q][X](I))}}n[F]=o,h.push(o),o++}}const M=a.clone();for(const N in a.attributes){const I=c[N];if(M.setAttribute(N,new I.constructor(I.array.slice(0,o*I.itemSize),I.itemSize,I.normalized)),N in u)for(let F=0;F<u[N].length;F++){const G=u[N][F];M.morphAttributes[N][F]=new G.constructor(G.array.slice(0,o*G.itemSize),G.itemSize,G.normalized)}}return M.setIndex(h),M}function i6e(a,e){if(e===iee)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),a;if(e===Ek||e===see){let n=a.getIndex();if(n===null){const o=[],l=a.getAttribute("position");if(l!==void 0){for(let c=0;c<l.count;c++)o.push(c);a.setIndex(o),n=a.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),a}const i=n.count-2,s=[];if(e===Ek)for(let o=1;o<=i;o++)s.push(n.getX(0)),s.push(n.getX(o)),s.push(n.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(s.push(n.getX(o)),s.push(n.getX(o+1)),s.push(n.getX(o+2))):(s.push(n.getX(o+2)),s.push(n.getX(o+1)),s.push(n.getX(o)));s.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=a.clone();return r.setIndex(s),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),a}function s6e(a){const e=new ye,n=new ye,i=new ye,s=new ye,r=new ye,o=new ye,l=new ye,c=new ye,u=new ye;function h(pe,Ee,oe,Ae,be,Ce,ce,te){e.fromBufferAttribute(Ee,be),n.fromBufferAttribute(Ee,Ce),i.fromBufferAttribute(Ee,ce);const fe=pe.morphTargetInfluences;if(oe&&fe){l.set(0,0,0),c.set(0,0,0),u.set(0,0,0);for(let Le=0,Fe=oe.length;Le<Fe;Le++){const Ie=fe[Le],at=oe[Le];Ie!==0&&(s.fromBufferAttribute(at,be),r.fromBufferAttribute(at,Ce),o.fromBufferAttribute(at,ce),Ae?(l.addScaledVector(s,Ie),c.addScaledVector(r,Ie),u.addScaledVector(o,Ie)):(l.addScaledVector(s.sub(e),Ie),c.addScaledVector(r.sub(n),Ie),u.addScaledVector(o.sub(i),Ie)))}e.add(l),n.add(c),i.add(u)}pe.isSkinnedMesh&&(pe.applyBoneTransform(be,e),pe.applyBoneTransform(Ce,n),pe.applyBoneTransform(ce,i)),te[be*3+0]=e.x,te[be*3+1]=e.y,te[be*3+2]=e.z,te[Ce*3+0]=n.x,te[Ce*3+1]=n.y,te[Ce*3+2]=n.z,te[ce*3+0]=i.x,te[ce*3+1]=i.y,te[ce*3+2]=i.z}const f=a.geometry,m=a.material;let A,x,T;const E=f.index,M=f.attributes.position,N=f.morphAttributes.position,I=f.morphTargetsRelative,F=f.attributes.normal,G=f.morphAttributes.position,O=f.groups,D=f.drawRange;let j,L,U,q,K,H,X;const ne=new Float32Array(M.count*M.itemSize),Q=new Float32Array(F.count*F.itemSize);if(E!==null)if(Array.isArray(m))for(j=0,U=O.length;j<U;j++)for(K=O[j],H=Math.max(K.start,D.start),X=Math.min(K.start+K.count,D.start+D.count),L=H,q=X;L<q;L+=3)A=E.getX(L),x=E.getX(L+1),T=E.getX(L+2),h(a,M,N,I,A,x,T,ne),h(a,F,G,I,A,x,T,Q);else for(H=Math.max(0,D.start),X=Math.min(E.count,D.start+D.count),j=H,U=X;j<U;j+=3)A=E.getX(j),x=E.getX(j+1),T=E.getX(j+2),h(a,M,N,I,A,x,T,ne),h(a,F,G,I,A,x,T,Q);else if(Array.isArray(m))for(j=0,U=O.length;j<U;j++)for(K=O[j],H=Math.max(K.start,D.start),X=Math.min(K.start+K.count,D.start+D.count),L=H,q=X;L<q;L+=3)A=L,x=L+1,T=L+2,h(a,M,N,I,A,x,T,ne),h(a,F,G,I,A,x,T,Q);else for(H=Math.max(0,D.start),X=Math.min(M.count,D.start+D.count),j=H,U=X;j<U;j+=3)A=j,x=j+1,T=j+2,h(a,M,N,I,A,x,T,ne),h(a,F,G,I,A,x,T,Q);const Y=new mn(ne,3),ue=new mn(Q,3);return{positionAttribute:M,normalAttribute:F,morphedPositionAttribute:Y,morphedNormalAttribute:ue}}function r6e(a){if(a.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),a;let e=a.groups;if(e=e.sort((o,l)=>o.materialIndex!==l.materialIndex?o.materialIndex-l.materialIndex:o.start-l.start),a.getIndex()===null){const o=a.getAttribute("position"),l=[];for(let c=0;c<o.count;c+=3)l.push(c,c+1,c+2);a.setIndex(l)}const n=a.getIndex(),i=[];for(let o=0;o<e.length;o++){const l=e[o],c=l.start,u=c+l.count;for(let h=c;h<u;h++)i.push(n.getX(h))}a.dispose(),a.setIndex(i);let s=0;for(let o=0;o<e.length;o++){const l=e[o];l.start=s,s+=l.count}let r=e[0];a.groups=[r];for(let o=1;o<e.length;o++){const l=e[o];r.materialIndex===l.materialIndex?r.count+=l.count:(r=l,a.groups.push(r))}return a}function o6e(a,e=Math.PI/3){const n=Math.cos(e),i=(1+1e-10)*100,s=[new ye,new ye,new ye],r=new ye,o=new ye,l=new ye,c=new ye;function u(T){const E=~~(T.x*i),M=~~(T.y*i),N=~~(T.z*i);return`${E},${M},${N}`}const h=a.index?a.toNonIndexed():a,f=h.attributes.position,m={};for(let T=0,E=f.count/3;T<E;T++){const M=3*T,N=s[0].fromBufferAttribute(f,M+0),I=s[1].fromBufferAttribute(f,M+1),F=s[2].fromBufferAttribute(f,M+2);r.subVectors(F,I),o.subVectors(N,I);const G=new ye().crossVectors(r,o).normalize();for(let O=0;O<3;O++){const D=s[O],j=u(D);j in m||(m[j]=[]),m[j].push(G)}}const A=new Float32Array(f.count*3),x=new Ua(A,3,!1);for(let T=0,E=f.count/3;T<E;T++){const M=3*T,N=s[0].fromBufferAttribute(f,M+0),I=s[1].fromBufferAttribute(f,M+1),F=s[2].fromBufferAttribute(f,M+2);r.subVectors(F,I),o.subVectors(N,I),l.crossVectors(r,o).normalize();for(let G=0;G<3;G++){const O=s[G],D=u(O),j=m[D];c.set(0,0,0);for(let L=0,U=j.length;L<U;L++){const q=j[L];l.dot(q)>n&&c.add(q)}c.normalize(),x.setXYZ(M+G,c.x,c.y,c.z)}}return h.setAttribute("normal",x),h}const tB=Object.freeze(Object.defineProperty({__proto__:null,computeMikkTSpaceTangents:Q5e,computeMorphedAttributes:s6e,deepCloneAttribute:Z5e,deinterleaveAttribute:lR,deinterleaveGeometry:t6e,estimateBytesUsed:n6e,interleaveAttributes:e6e,mergeAttributes:pO,mergeGeometries:J5e,mergeGroups:r6e,mergeVertices:a6e,toCreasedNormals:o6e,toTrianglesDrawMode:i6e},Symbol.toStringTag,{value:"Module"}));var Yt=(function(a){return typeof a=="function"?a:typeof a=="string"?function(e){return e[a]}:function(e){return a}});function cR(a){"@babel/helpers - typeof";return cR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cR(a)}var l6e=/^\s+/,c6e=/\s+$/;function Hn(a,e){if(a=a||"",e=e||{},a instanceof Hn)return a;if(!(this instanceof Hn))return new Hn(a,e);var n=u6e(a);this._originalInput=a,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}Hn.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),n,i,s,r,o,l;return n=e.r/255,i=e.g/255,s=e.b/255,n<=.03928?r=n/12.92:r=Math.pow((n+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),s<=.03928?l=s/12.92:l=Math.pow((s+.055)/1.055,2.4),.2126*r+.7152*o+.0722*l},setAlpha:function(e){return this._a=one(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=x$(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=x$(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),s=Math.round(e.v*100);return this._a==1?"hsv("+n+", "+i+"%, "+s+"%)":"hsva("+n+", "+i+"%, "+s+"%, "+this._roundA+")"},toHsl:function(){var e=_$(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=_$(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),s=Math.round(e.l*100);return this._a==1?"hsl("+n+", "+i+"%, "+s+"%)":"hsla("+n+", "+i+"%, "+s+"%, "+this._roundA+")"},toHex:function(e){return b$(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return p6e(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ws(this._r,255)*100)+"%",g:Math.round(ws(this._g,255)*100)+"%",b:Math.round(ws(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ws(this._r,255)*100)+"%, "+Math.round(ws(this._g,255)*100)+"%, "+Math.round(ws(this._b,255)*100)+"%)":"rgba("+Math.round(ws(this._r,255)*100)+"%, "+Math.round(ws(this._g,255)*100)+"%, "+Math.round(ws(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:E6e[b$(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var n="#"+S$(this._r,this._g,this._b,this._a),i=n,s=this._gradientType?"GradientType = 1, ":"";if(e){var r=Hn(e);i="#"+S$(r._r,r._g,r._b,r._a)}return"progid:DXImageTransform.Microsoft.gradient("+s+"startColorstr="+n+",endColorstr="+i+")"},toString:function(e){var n=!!e;e=e||this._format;var i=!1,s=this._a<1&&this._a>=0,r=!n&&s&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return r?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return Hn(this.toString())},_applyModification:function(e,n){var i=e.apply(null,[this].concat([].slice.call(n)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(y6e,arguments)},brighten:function(){return this._applyModification(v6e,arguments)},darken:function(){return this._applyModification(_6e,arguments)},desaturate:function(){return this._applyModification(m6e,arguments)},saturate:function(){return this._applyModification(g6e,arguments)},greyscale:function(){return this._applyModification(A6e,arguments)},spin:function(){return this._applyModification(x6e,arguments)},_applyCombination:function(e,n){return e.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(T6e,arguments)},complement:function(){return this._applyCombination(b6e,arguments)},monochromatic:function(){return this._applyCombination(w6e,arguments)},splitcomplement:function(){return this._applyCombination(S6e,arguments)},triad:function(){return this._applyCombination(T$,[3])},tetrad:function(){return this._applyCombination(T$,[4])}};Hn.fromRatio=function(a,e){if(cR(a)=="object"){var n={};for(var i in a)a.hasOwnProperty(i)&&(i==="a"?n[i]=a[i]:n[i]=q2(a[i]));a=n}return Hn(a,e)};function u6e(a){var e={r:0,g:0,b:0},n=1,i=null,s=null,r=null,o=!1,l=!1;return typeof a=="string"&&(a=R6e(a)),cR(a)=="object"&&(Bp(a.r)&&Bp(a.g)&&Bp(a.b)?(e=d6e(a.r,a.g,a.b),o=!0,l=String(a.r).substr(-1)==="%"?"prgb":"rgb"):Bp(a.h)&&Bp(a.s)&&Bp(a.v)?(i=q2(a.s),s=q2(a.v),e=f6e(a.h,i,s),o=!0,l="hsv"):Bp(a.h)&&Bp(a.s)&&Bp(a.l)&&(i=q2(a.s),r=q2(a.l),e=h6e(a.h,i,r),o=!0,l="hsl"),a.hasOwnProperty("a")&&(n=a.a)),n=one(n),{ok:o,format:a.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}function d6e(a,e,n){return{r:ws(a,255)*255,g:ws(e,255)*255,b:ws(n,255)*255}}function _$(a,e,n){a=ws(a,255),e=ws(e,255),n=ws(n,255);var i=Math.max(a,e,n),s=Math.min(a,e,n),r,o,l=(i+s)/2;if(i==s)r=o=0;else{var c=i-s;switch(o=l>.5?c/(2-i-s):c/(i+s),i){case a:r=(e-n)/c+(e<n?6:0);break;case e:r=(n-a)/c+2;break;case n:r=(a-e)/c+4;break}r/=6}return{h:r,s:o,l}}function h6e(a,e,n){var i,s,r;a=ws(a,360),e=ws(e,100),n=ws(n,100);function o(u,h,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?u+(h-u)*6*f:f<1/2?h:f<2/3?u+(h-u)*(2/3-f)*6:u}if(e===0)i=s=r=n;else{var l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;i=o(c,l,a+1/3),s=o(c,l,a),r=o(c,l,a-1/3)}return{r:i*255,g:s*255,b:r*255}}function x$(a,e,n){a=ws(a,255),e=ws(e,255),n=ws(n,255);var i=Math.max(a,e,n),s=Math.min(a,e,n),r,o,l=i,c=i-s;if(o=i===0?0:c/i,i==s)r=0;else{switch(i){case a:r=(e-n)/c+(e<n?6:0);break;case e:r=(n-a)/c+2;break;case n:r=(a-e)/c+4;break}r/=6}return{h:r,s:o,v:l}}function f6e(a,e,n){a=ws(a,360)*6,e=ws(e,100),n=ws(n,100);var i=Math.floor(a),s=a-i,r=n*(1-e),o=n*(1-s*e),l=n*(1-(1-s)*e),c=i%6,u=[n,o,r,r,l,n][c],h=[l,n,n,o,r,r][c],f=[r,r,l,n,n,o][c];return{r:u*255,g:h*255,b:f*255}}function b$(a,e,n,i){var s=[Ud(Math.round(a).toString(16)),Ud(Math.round(e).toString(16)),Ud(Math.round(n).toString(16))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function p6e(a,e,n,i,s){var r=[Ud(Math.round(a).toString(16)),Ud(Math.round(e).toString(16)),Ud(Math.round(n).toString(16)),Ud(lne(i))];return s&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)&&r[3].charAt(0)==r[3].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0)+r[3].charAt(0):r.join("")}function S$(a,e,n,i){var s=[Ud(lne(i)),Ud(Math.round(a).toString(16)),Ud(Math.round(e).toString(16)),Ud(Math.round(n).toString(16))];return s.join("")}Hn.equals=function(a,e){return!a||!e?!1:Hn(a).toRgbString()==Hn(e).toRgbString()};Hn.random=function(){return Hn.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function m6e(a,e){e=e===0?0:e||10;var n=Hn(a).toHsl();return n.s-=e/100,n.s=E4(n.s),Hn(n)}function g6e(a,e){e=e===0?0:e||10;var n=Hn(a).toHsl();return n.s+=e/100,n.s=E4(n.s),Hn(n)}function A6e(a){return Hn(a).desaturate(100)}function y6e(a,e){e=e===0?0:e||10;var n=Hn(a).toHsl();return n.l+=e/100,n.l=E4(n.l),Hn(n)}function v6e(a,e){e=e===0?0:e||10;var n=Hn(a).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),Hn(n)}function _6e(a,e){e=e===0?0:e||10;var n=Hn(a).toHsl();return n.l-=e/100,n.l=E4(n.l),Hn(n)}function x6e(a,e){var n=Hn(a).toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,Hn(n)}function b6e(a){var e=Hn(a).toHsl();return e.h=(e.h+180)%360,Hn(e)}function T$(a,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=Hn(a).toHsl(),i=[Hn(a)],s=360/e,r=1;r<e;r++)i.push(Hn({h:(n.h+r*s)%360,s:n.s,l:n.l}));return i}function S6e(a){var e=Hn(a).toHsl(),n=e.h;return[Hn(a),Hn({h:(n+72)%360,s:e.s,l:e.l}),Hn({h:(n+216)%360,s:e.s,l:e.l})]}function T6e(a,e,n){e=e||6,n=n||30;var i=Hn(a).toHsl(),s=360/n,r=[Hn(a)];for(i.h=(i.h-(s*e>>1)+720)%360;--e;)i.h=(i.h+s)%360,r.push(Hn(i));return r}function w6e(a,e){e=e||6;for(var n=Hn(a).toHsv(),i=n.h,s=n.s,r=n.v,o=[],l=1/e;e--;)o.push(Hn({h:i,s,v:r})),r=(r+l)%1;return o}Hn.mix=function(a,e,n){n=n===0?0:n||50;var i=Hn(a).toRgb(),s=Hn(e).toRgb(),r=n/100,o={r:(s.r-i.r)*r+i.r,g:(s.g-i.g)*r+i.g,b:(s.b-i.b)*r+i.b,a:(s.a-i.a)*r+i.a};return Hn(o)};Hn.readability=function(a,e){var n=Hn(a),i=Hn(e);return(Math.max(n.getLuminance(),i.getLuminance())+.05)/(Math.min(n.getLuminance(),i.getLuminance())+.05)};Hn.isReadable=function(a,e,n){var i=Hn.readability(a,e),s,r;switch(r=!1,s=P6e(n),s.level+s.size){case"AAsmall":case"AAAlarge":r=i>=4.5;break;case"AAlarge":r=i>=3;break;case"AAAsmall":r=i>=7;break}return r};Hn.mostReadable=function(a,e,n){var i=null,s=0,r,o,l,c;n=n||{},o=n.includeFallbackColors,l=n.level,c=n.size;for(var u=0;u<e.length;u++)r=Hn.readability(a,e[u]),r>s&&(s=r,i=Hn(e[u]));return Hn.isReadable(a,i,{level:l,size:c})||!o?i:(n.includeFallbackColors=!1,Hn.mostReadable(a,["#fff","#000"],n))};var mO=Hn.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},E6e=Hn.hexNames=M6e(mO);function M6e(a){var e={};for(var n in a)a.hasOwnProperty(n)&&(e[a[n]]=n);return e}function one(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function ws(a,e){C6e(a)&&(a="100%");var n=N6e(a);return a=Math.min(e,Math.max(0,parseFloat(a))),n&&(a=parseInt(a*e,10)/100),Math.abs(a-e)<1e-6?1:a%e/parseFloat(e)}function E4(a){return Math.min(1,Math.max(0,a))}function Yc(a){return parseInt(a,16)}function C6e(a){return typeof a=="string"&&a.indexOf(".")!=-1&&parseFloat(a)===1}function N6e(a){return typeof a=="string"&&a.indexOf("%")!=-1}function Ud(a){return a.length==1?"0"+a:""+a}function q2(a){return a<=1&&(a=a*100+"%"),a}function lne(a){return Math.round(parseFloat(a)*255).toString(16)}function w$(a){return Yc(a)/255}var Cd=(function(){var a="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+a+")",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",s="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+s),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+s),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+s),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function Bp(a){return!!Cd.CSS_UNIT.exec(a)}function R6e(a){a=a.replace(l6e,"").replace(c6e,"").toLowerCase();var e=!1;if(mO[a])a=mO[a],e=!0;else if(a=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=Cd.rgb.exec(a))?{r:n[1],g:n[2],b:n[3]}:(n=Cd.rgba.exec(a))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Cd.hsl.exec(a))?{h:n[1],s:n[2],l:n[3]}:(n=Cd.hsla.exec(a))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Cd.hsv.exec(a))?{h:n[1],s:n[2],v:n[3]}:(n=Cd.hsva.exec(a))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Cd.hex8.exec(a))?{r:Yc(n[1]),g:Yc(n[2]),b:Yc(n[3]),a:w$(n[4]),format:e?"name":"hex8"}:(n=Cd.hex6.exec(a))?{r:Yc(n[1]),g:Yc(n[2]),b:Yc(n[3]),format:e?"name":"hex"}:(n=Cd.hex4.exec(a))?{r:Yc(n[1]+""+n[1]),g:Yc(n[2]+""+n[2]),b:Yc(n[3]+""+n[3]),a:w$(n[4]+""+n[4]),format:e?"name":"hex8"}:(n=Cd.hex3.exec(a))?{r:Yc(n[1]+""+n[1]),g:Yc(n[2]+""+n[2]),b:Yc(n[3]+""+n[3]),format:e?"name":"hex"}:!1}function P6e(a){var e,n;return a=a||{level:"AA",size:"small"},e=(a.level||"AA").toUpperCase(),n=(a.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:e,size:n}}function gO(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=Array(e);n<e;n++)i[n]=a[n];return i}function I6e(a){if(Array.isArray(a))return a}function L6e(a){if(Array.isArray(a))return gO(a)}function cne(a,e,n){if(typeof a=="function"?a===e:a.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function D6e(a,e){if(e.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function k6e(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function el(a,e){return a.get(cne(a,e))}function Cv(a,e,n){D6e(a,e),e.set(a,n)}function VM(a,e,n){return a.set(cne(a,e),n),n}function O6e(a,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,H6e(i.key),i)}}function F6e(a,e,n){return e&&O6e(a.prototype,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function j6e(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function B6e(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i,s,r,o,l=[],c=!0,u=!1;try{if(r=(n=n.call(a)).next,e!==0)for(;!(c=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function U6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z6e(a,e){return I6e(a)||B6e(a,e)||une(a,e)||U6e()}function G6e(a){return L6e(a)||j6e(a)||une(a)||V6e()}function q6e(a,e){if(typeof a!="object"||!a)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var i=n.call(a,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}function H6e(a){var e=q6e(a,"string");return typeof e=="symbol"?e:e+""}function une(a,e){if(a){if(typeof a=="string")return gO(a,e);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gO(a,e):void 0}}var Nv=new WeakMap,r2=new WeakMap,Rv=new WeakMap,g5=new WeakMap,A5=new WeakMap,y5=new WeakMap,W6e=(function(){function a(){k6e(this,a),Cv(this,Nv,new Map),Cv(this,r2,new Map),Cv(this,Rv,function(e){return e}),Cv(this,g5,function(){return{}}),Cv(this,A5,function(){}),Cv(this,y5,function(){})}return F6e(a,[{key:"getObj",value:function(n){return el(Nv,this).get(el(Rv,this).call(this,n))}},{key:"getData",value:function(n){return el(r2,this).get(n)}},{key:"entries",value:function(){return G6e(el(r2,this).entries()).map(function(n){var i=z6e(n,2),s=i[0],r=i[1];return[r,s]})}},{key:"id",value:function(n){return VM(Rv,this,Yt(n)),this}},{key:"onCreateObj",value:function(n){return VM(g5,this,n),this}},{key:"onUpdateObj",value:function(n){return VM(A5,this,n),this}},{key:"onRemoveObj",value:function(n){return VM(y5,this,n),this}},{key:"digest",value:function(n){var i=this;n.filter(function(r){return!el(Nv,i).has(el(Rv,i).call(i,r))}).forEach(function(r){var o=el(g5,i).call(i,r);el(Nv,i).set(el(Rv,i).call(i,r),o),el(r2,i).set(o,r)});var s=new Map(n.map(function(r){return[el(Rv,i).call(i,r),r]}));return el(Nv,this).forEach(function(r,o){s.has(o)?el(A5,i).call(i,r,s.get(o)):(el(y5,i).call(i,r,o),el(Nv,i).delete(o),el(r2,i).delete(r))}),this}},{key:"clear",value:function(){return this.digest([]),this}}])})(),n3={exports:{}},$6e=n3.exports,E$;function K6e(){return E$||(E$=1,(function(a,e){(function(n,i){a.exports=i()})($6e,function(){return(function(n){function i(r){if(s[r])return s[r].exports;var o=s[r]={exports:{},id:r,loaded:!1};return n[r].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var s={};return i.m=n,i.c=s,i.p="",i(0)})([function(n,i,s){var r=s(1),o=(function(){function l(c,u,h){c===void 0&&(c=NaN),u===void 0&&(u=NaN),h===void 0&&(h=!1),this._minFPS=u,this._maxFPS=c,this._timeScale=1,this._currentTick=0,this._currentTime=0,this._tickDeltaTime=0,this._isRunning=!1,this._maxInterval=isNaN(this._minFPS)?NaN:1e3/this._minFPS,this._minInterval=isNaN(this._maxFPS)?NaN:1e3/this._maxFPS,this._onResume=new r.default,this._onPause=new r.default,this._onTick=new r.default,this._onTickOncePerFrame=new r.default,h||this.resume()}return l.prototype.updateOnce=function(c){c(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},l.prototype.resume=function(){this._isRunning||(this._isRunning=!0,this._lastTimeUpdated=this.getTimer(),this._onResume.dispatch(),this.animateOnce())},l.prototype.pause=function(){this._isRunning&&(this._isRunning=!1,this._onPause.dispatch(),window.cancelAnimationFrame(this._animationFrameHandle))},l.prototype.dispose=function(){this.pause(),this._onResume.removeAll(),this._onPause.removeAll(),this._onTick.removeAll()},Object.defineProperty(l.prototype,"currentTick",{get:function(){return this._currentTick},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"currentTimeSeconds",{get:function(){return this._currentTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"tickDeltaTimeSeconds",{get:function(){return this._tickDeltaTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"timeScale",{get:function(){return this._timeScale},set:function(c){this._timeScale!==c&&(this._timeScale=c)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"onResume",{get:function(){return this._onResume},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"onPause",{get:function(){return this._onPause},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"onTickOncePerFrame",{get:function(){return this._onTickOncePerFrame},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),l.prototype.animateOnce=function(){var c=this;this._animationFrameHandle=window.requestAnimationFrame(function(){return c.onFrame()})},l.prototype.onFrame=function(){if(this._now=this.getTimer(),this._frameDeltaTime=this._now-this._lastTimeUpdated,isNaN(this._minInterval)||this._frameDeltaTime>=this._minInterval)if(isNaN(this._maxInterval))this.update(this._frameDeltaTime*this._timeScale,!0),this._lastTimeUpdated=this._now;else for(this._interval=Math.min(this._frameDeltaTime,this._maxInterval);this._now>=this._lastTimeUpdated+this._interval;)this.update(this._interval*this._timeScale,this._now<=this._lastTimeUpdated+2*this._maxInterval),this._lastTimeUpdated+=this._interval;this._isRunning&&this.animateOnce()},l.prototype.update=function(c,u){u===void 0&&(u=!0),this._currentTick++,this._currentTime+=c,this._tickDeltaTime=c,this._onTick.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick),u&&this._onTickOncePerFrame.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},l.prototype.getTimer=function(){return Date.now()},l})();Object.defineProperty(i,"__esModule",{value:!0}),i.default=o},function(n,i,s){(function(r,o){n.exports=o()})(this,function(){return(function(r){function o(c){if(l[c])return l[c].exports;var u=l[c]={exports:{},id:c,loaded:!1};return r[c].call(u.exports,u,u.exports,o),u.loaded=!0,u.exports}var l={};return o.m=r,o.c=l,o.p="",o(0)})([function(r,o){var l=(function(){function c(){this.functions=[]}return c.prototype.add=function(u){return this.functions.indexOf(u)===-1&&(this.functions.push(u),!0)},c.prototype.remove=function(u){var h=this.functions.indexOf(u);return h>-1&&(this.functions.splice(h,1),!0)},c.prototype.removeAll=function(){return this.functions.length>0&&(this.functions.length=0,!0)},c.prototype.dispatch=function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];var f=this.functions.concat();f.forEach(function(m){m.apply(void 0,u)})},Object.defineProperty(c.prototype,"numItems",{get:function(){return this.functions.length},enumerable:!0,configurable:!0}),c})();Object.defineProperty(o,"__esModule",{value:!0}),o.default=l}])})}])})})(n3)),n3.exports}var Y6e=K6e();const hx=f8(Y6e),am=11102230246251565e-32,tl=134217729,X6e=(3+8*am)*am;function v5(a,e,n,i,s){let r,o,l,c,u=e[0],h=i[0],f=0,m=0;h>u==h>-u?(r=u,u=e[++f]):(r=h,h=i[++m]);let A=0;if(f<a&&m<n)for(h>u==h>-u?(o=u+r,l=r-(o-u),u=e[++f]):(o=h+r,l=r-(o-h),h=i[++m]),r=o,l!==0&&(s[A++]=l);f<a&&m<n;)h>u==h>-u?(o=r+u,c=o-r,l=r-(o-c)+(u-c),u=e[++f]):(o=r+h,c=o-r,l=r-(o-c)+(h-c),h=i[++m]),r=o,l!==0&&(s[A++]=l);for(;f<a;)o=r+u,c=o-r,l=r-(o-c)+(u-c),u=e[++f],r=o,l!==0&&(s[A++]=l);for(;m<n;)o=r+h,c=o-r,l=r-(o-c)+(h-c),h=i[++m],r=o,l!==0&&(s[A++]=l);return(r!==0||A===0)&&(s[A++]=r),A}function Q6e(a,e){let n=e[0];for(let i=1;i<a;i++)n+=e[i];return n}function cw(a){return new Float64Array(a)}const J6e=(3+16*am)*am,Z6e=(2+12*am)*am,eke=(9+64*am)*am*am,Pv=cw(4),M$=cw(8),C$=cw(12),N$=cw(16),bl=cw(4);function tke(a,e,n,i,s,r,o){let l,c,u,h,f,m,A,x,T,E,M,N,I,F,G,O,D,j;const L=a-s,U=n-s,q=e-r,K=i-r;F=L*K,m=tl*L,A=m-(m-L),x=L-A,m=tl*K,T=m-(m-K),E=K-T,G=x*E-(F-A*T-x*T-A*E),O=q*U,m=tl*q,A=m-(m-q),x=q-A,m=tl*U,T=m-(m-U),E=U-T,D=x*E-(O-A*T-x*T-A*E),M=G-D,f=G-M,Pv[0]=G-(M+f)+(f-D),N=F+M,f=N-F,I=F-(N-f)+(M-f),M=I-O,f=I-M,Pv[1]=I-(M+f)+(f-O),j=N+M,f=j-N,Pv[2]=N-(j-f)+(M-f),Pv[3]=j;let H=Q6e(4,Pv),X=Z6e*o;if(H>=X||-H>=X||(f=a-L,l=a-(L+f)+(f-s),f=n-U,u=n-(U+f)+(f-s),f=e-q,c=e-(q+f)+(f-r),f=i-K,h=i-(K+f)+(f-r),l===0&&c===0&&u===0&&h===0)||(X=eke*o+X6e*Math.abs(H),H+=L*h+K*l-(q*u+U*c),H>=X||-H>=X))return H;F=l*K,m=tl*l,A=m-(m-l),x=l-A,m=tl*K,T=m-(m-K),E=K-T,G=x*E-(F-A*T-x*T-A*E),O=c*U,m=tl*c,A=m-(m-c),x=c-A,m=tl*U,T=m-(m-U),E=U-T,D=x*E-(O-A*T-x*T-A*E),M=G-D,f=G-M,bl[0]=G-(M+f)+(f-D),N=F+M,f=N-F,I=F-(N-f)+(M-f),M=I-O,f=I-M,bl[1]=I-(M+f)+(f-O),j=N+M,f=j-N,bl[2]=N-(j-f)+(M-f),bl[3]=j;const ne=v5(4,Pv,4,bl,M$);F=L*h,m=tl*L,A=m-(m-L),x=L-A,m=tl*h,T=m-(m-h),E=h-T,G=x*E-(F-A*T-x*T-A*E),O=q*u,m=tl*q,A=m-(m-q),x=q-A,m=tl*u,T=m-(m-u),E=u-T,D=x*E-(O-A*T-x*T-A*E),M=G-D,f=G-M,bl[0]=G-(M+f)+(f-D),N=F+M,f=N-F,I=F-(N-f)+(M-f),M=I-O,f=I-M,bl[1]=I-(M+f)+(f-O),j=N+M,f=j-N,bl[2]=N-(j-f)+(M-f),bl[3]=j;const Q=v5(ne,M$,4,bl,C$);F=l*h,m=tl*l,A=m-(m-l),x=l-A,m=tl*h,T=m-(m-h),E=h-T,G=x*E-(F-A*T-x*T-A*E),O=c*u,m=tl*c,A=m-(m-c),x=c-A,m=tl*u,T=m-(m-u),E=u-T,D=x*E-(O-A*T-x*T-A*E),M=G-D,f=G-M,bl[0]=G-(M+f)+(f-D),N=F+M,f=N-F,I=F-(N-f)+(M-f),M=I-O,f=I-M,bl[1]=I-(M+f)+(f-O),j=N+M,f=j-N,bl[2]=N-(j-f)+(M-f),bl[3]=j;const Y=v5(Q,C$,4,bl,N$);return N$[Y-1]}function H2(a,e,n,i,s,r){const o=(e-r)*(n-s),l=(a-s)*(i-r),c=o-l,u=Math.abs(o+l);return Math.abs(c)>=J6e*u?c:-tke(a,e,n,i,s,r,u)}const R$=Math.pow(2,-52),zM=new Uint32Array(512);class sT{static from(e,n=rke,i=oke){const s=e.length,r=new Float64Array(s*2);for(let o=0;o<s;o++){const l=e[o];r[2*o]=n(l),r[2*o+1]=i(l)}return new sT(r)}constructor(e){const n=e.length>>1;if(n>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:e,_hullPrev:n,_hullNext:i,_hullTri:s,_hullHash:r}=this,o=e.length>>1;let l=1/0,c=1/0,u=-1/0,h=-1/0;for(let L=0;L<o;L++){const U=e[2*L],q=e[2*L+1];U<l&&(l=U),q<c&&(c=q),U>u&&(u=U),q>h&&(h=q),this._ids[L]=L}const f=(l+u)/2,m=(c+h)/2;let A,x,T;for(let L=0,U=1/0;L<o;L++){const q=_5(f,m,e[2*L],e[2*L+1]);q<U&&(A=L,U=q)}const E=e[2*A],M=e[2*A+1];for(let L=0,U=1/0;L<o;L++){if(L===A)continue;const q=_5(E,M,e[2*L],e[2*L+1]);q<U&&q>0&&(x=L,U=q)}let N=e[2*x],I=e[2*x+1],F=1/0;for(let L=0;L<o;L++){if(L===A||L===x)continue;const U=ike(E,M,N,I,e[2*L],e[2*L+1]);U<F&&(T=L,F=U)}let G=e[2*T],O=e[2*T+1];if(F===1/0){for(let q=0;q<o;q++)this._dists[q]=e[2*q]-e[0]||e[2*q+1]-e[1];o_(this._ids,this._dists,0,o-1);const L=new Uint32Array(o);let U=0;for(let q=0,K=-1/0;q<o;q++){const H=this._ids[q],X=this._dists[H];X>K&&(L[U++]=H,K=X)}this.hull=L.subarray(0,U),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(H2(E,M,N,I,G,O)<0){const L=x,U=N,q=I;x=T,N=G,I=O,T=L,G=U,O=q}const D=ske(E,M,N,I,G,O);this._cx=D.x,this._cy=D.y;for(let L=0;L<o;L++)this._dists[L]=_5(e[2*L],e[2*L+1],D.x,D.y);o_(this._ids,this._dists,0,o-1),this._hullStart=A;let j=3;i[A]=n[T]=x,i[x]=n[A]=T,i[T]=n[x]=A,s[A]=0,s[x]=1,s[T]=2,r.fill(-1),r[this._hashKey(E,M)]=A,r[this._hashKey(N,I)]=x,r[this._hashKey(G,O)]=T,this.trianglesLen=0,this._addTriangle(A,x,T,-1,-1,-1);for(let L=0,U,q;L<this._ids.length;L++){const K=this._ids[L],H=e[2*K],X=e[2*K+1];if(L>0&&Math.abs(H-U)<=R$&&Math.abs(X-q)<=R$||(U=H,q=X,K===A||K===x||K===T))continue;let ne=0;for(let Ee=0,oe=this._hashKey(H,X);Ee<this._hashSize&&(ne=r[(oe+Ee)%this._hashSize],!(ne!==-1&&ne!==i[ne]));Ee++);ne=n[ne];let Q=ne,Y;for(;Y=i[Q],H2(H,X,e[2*Q],e[2*Q+1],e[2*Y],e[2*Y+1])>=0;)if(Q=Y,Q===ne){Q=-1;break}if(Q===-1)continue;let ue=this._addTriangle(Q,K,i[Q],-1,-1,s[Q]);s[K]=this._legalize(ue+2),s[Q]=ue,j++;let pe=i[Q];for(;Y=i[pe],H2(H,X,e[2*pe],e[2*pe+1],e[2*Y],e[2*Y+1])<0;)ue=this._addTriangle(pe,K,Y,s[K],-1,s[pe]),s[K]=this._legalize(ue+2),i[pe]=pe,j--,pe=Y;if(Q===ne)for(;Y=n[Q],H2(H,X,e[2*Y],e[2*Y+1],e[2*Q],e[2*Q+1])<0;)ue=this._addTriangle(Y,K,Q,-1,s[Q],s[Y]),this._legalize(ue+2),s[Y]=ue,i[Q]=Q,j--,Q=Y;this._hullStart=n[K]=Q,i[Q]=n[pe]=K,i[K]=pe,r[this._hashKey(H,X)]=K,r[this._hashKey(e[2*Q],e[2*Q+1])]=Q}this.hull=new Uint32Array(j);for(let L=0,U=this._hullStart;L<j;L++)this.hull[L]=U,U=i[U];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,n){return Math.floor(nke(e-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:n,_halfedges:i,coords:s}=this;let r=0,o=0;for(;;){const l=i[e],c=e-e%3;if(o=c+(e+2)%3,l===-1){if(r===0)break;e=zM[--r];continue}const u=l-l%3,h=c+(e+1)%3,f=u+(l+2)%3,m=n[o],A=n[e],x=n[h],T=n[f];if(ake(s[2*m],s[2*m+1],s[2*A],s[2*A+1],s[2*x],s[2*x+1],s[2*T],s[2*T+1])){n[e]=T,n[l]=m;const M=i[f];if(M===-1){let I=this._hullStart;do{if(this._hullTri[I]===f){this._hullTri[I]=e;break}I=this._hullPrev[I]}while(I!==this._hullStart)}this._link(e,M),this._link(l,i[o]),this._link(o,f);const N=u+(l+1)%3;r<zM.length&&(zM[r++]=N)}else{if(r===0)break;e=zM[--r]}}return o}_link(e,n){this._halfedges[e]=n,n!==-1&&(this._halfedges[n]=e)}_addTriangle(e,n,i,s,r,o){const l=this.trianglesLen;return this._triangles[l]=e,this._triangles[l+1]=n,this._triangles[l+2]=i,this._link(l,s),this._link(l+1,r),this._link(l+2,o),this.trianglesLen+=3,l}}function nke(a,e){const n=a/(Math.abs(a)+Math.abs(e));return(e>0?3-n:1+n)/4}function _5(a,e,n,i){const s=a-n,r=e-i;return s*s+r*r}function ake(a,e,n,i,s,r,o,l){const c=a-o,u=e-l,h=n-o,f=i-l,m=s-o,A=r-l,x=c*c+u*u,T=h*h+f*f,E=m*m+A*A;return c*(f*E-T*A)-u*(h*E-T*m)+x*(h*A-f*m)<0}function ike(a,e,n,i,s,r){const o=n-a,l=i-e,c=s-a,u=r-e,h=o*o+l*l,f=c*c+u*u,m=.5/(o*u-l*c),A=(u*h-l*f)*m,x=(o*f-c*h)*m;return A*A+x*x}function ske(a,e,n,i,s,r){const o=n-a,l=i-e,c=s-a,u=r-e,h=o*o+l*l,f=c*c+u*u,m=.5/(o*u-l*c),A=a+(u*h-l*f)*m,x=e+(o*f-c*h)*m;return{x:A,y:x}}function o_(a,e,n,i){if(i-n<=20)for(let s=n+1;s<=i;s++){const r=a[s],o=e[r];let l=s-1;for(;l>=n&&e[a[l]]>o;)a[l+1]=a[l--];a[l+1]=r}else{const s=n+i>>1;let r=n+1,o=i;o2(a,s,r),e[a[n]]>e[a[i]]&&o2(a,n,i),e[a[r]]>e[a[i]]&&o2(a,r,i),e[a[n]]>e[a[r]]&&o2(a,n,r);const l=a[r],c=e[l];for(;;){do r++;while(e[a[r]]<c);do o--;while(e[a[o]]>c);if(o<r)break;o2(a,r,o)}a[n+1]=a[o],a[o]=l,i-r+1>=o-n?(o_(a,e,r,i),o_(a,e,n,o-1)):(o_(a,e,n,o-1),o_(a,e,r,i))}}function o2(a,e,n){const i=a[e];a[e]=a[n],a[n]=i}function rke(a){return a[0]}function oke(a){return a[1]}function lke(a,e){var n,i,s=0,r,o,l,c,u,h,f,m=a[0],A=a[1],x=e.length;for(n=0;n<x;n++){i=0;var T=e[n],E=T.length-1;if(h=T[0],h[0]!==T[E][0]&&h[1]!==T[E][1])throw new Error("First and last coordinates in a ring must be the same");for(o=h[0]-m,l=h[1]-A,i;i<E;i++){if(f=T[i+1],c=f[0]-m,u=f[1]-A,l===0&&u===0){if(c<=0&&o>=0||o<=0&&c>=0)return 0}else if(u>=0&&l<=0||u<=0&&l>=0){if(r=H2(o,c,l,u,0,0),r===0)return 0;(r>0&&u>0&&l<=0||r<0&&u<=0&&l>0)&&s++}h=f,l=u,o=c}}return s%2!==0}function cke(a){if(!a)throw new Error("coord is required");if(!Array.isArray(a)){if(a.type==="Feature"&&a.geometry!==null&&a.geometry.type==="Point")return[...a.geometry.coordinates];if(a.type==="Point")return[...a.coordinates]}if(Array.isArray(a)&&a.length>=2&&!Array.isArray(a[0])&&!Array.isArray(a[1]))return[...a];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function uke(a){return a.type==="Feature"?a.geometry:a}function dke(a,e,n={}){if(!a)throw new Error("point is required");if(!e)throw new Error("polygon is required");const i=cke(a),s=uke(e),r=s.type,o=e.bbox;let l=s.coordinates;if(o&&hke(i,o)===!1)return!1;r==="Polygon"&&(l=[l]);let c=!1;for(var u=0;u<l.length;++u){const h=lke(i,l[u]);if(h===0)return!n.ignoreBoundary;h&&(c=!0)}return c}function hke(a,e){return e[0]<=a[0]&&e[1]<=a[1]&&e[2]>=a[0]&&e[3]>=a[1]}var fke=dke;const P$=1e-6;class HA{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,n){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,n){this._+=`L${this._x1=+e},${this._y1=+n}`}arc(e,n,i){e=+e,n=+n,i=+i;const s=e+i,r=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${s},${r}`:(Math.abs(this._x1-s)>P$||Math.abs(this._y1-r)>P$)&&(this._+="L"+s+","+r),i&&(this._+=`A${i},${i},0,1,1,${e-i},${n}A${i},${i},0,1,1,${this._x1=s},${this._y1=r}`)}rect(e,n,i,s){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${+i}v${+s}h${-i}Z`}value(){return this._||null}}class AO{constructor(){this._=[]}moveTo(e,n){this._.push([e,n])}closePath(){this._.push(this._[0].slice())}lineTo(e,n){this._.push([e,n])}value(){return this._.length?this._:null}}class pke{constructor(e,[n,i,s,r]=[0,0,960,500]){if(!((s=+s)>=(n=+n))||!((r=+r)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=s,this.xmin=n,this.ymax=r,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:n,triangles:i},vectors:s}=this;let r,o;const l=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let T=0,E=0,M=i.length,N,I;T<M;T+=3,E+=2){const F=i[T]*2,G=i[T+1]*2,O=i[T+2]*2,D=e[F],j=e[F+1],L=e[G],U=e[G+1],q=e[O],K=e[O+1],H=L-D,X=U-j,ne=q-D,Q=K-j,Y=(H*Q-X*ne)*2;if(Math.abs(Y)<1e-9){if(r===void 0){r=o=0;for(const pe of n)r+=e[pe*2],o+=e[pe*2+1];r/=n.length,o/=n.length}const ue=1e9*Math.sign((r-D)*Q-(o-j)*ne);N=(D+q)/2-ue*Q,I=(j+K)/2+ue*ne}else{const ue=1/Y,pe=H*H+X*X,Ee=ne*ne+Q*Q;N=D+(Q*pe-X*Ee)*ue,I=j+(H*Ee-ne*pe)*ue}l[E]=N,l[E+1]=I}let c=n[n.length-1],u,h=c*4,f,m=e[2*c],A,x=e[2*c+1];s.fill(0);for(let T=0;T<n.length;++T)c=n[T],u=h,f=m,A=x,h=c*4,m=e[2*c],x=e[2*c+1],s[u+2]=s[h]=A-x,s[u+3]=s[h+1]=m-f}render(e){const n=e==null?e=new HA:void 0,{delaunay:{halfedges:i,inedges:s,hull:r},circumcenters:o,vectors:l}=this;if(r.length<=1)return null;for(let h=0,f=i.length;h<f;++h){const m=i[h];if(m<h)continue;const A=Math.floor(h/3)*2,x=Math.floor(m/3)*2,T=o[A],E=o[A+1],M=o[x],N=o[x+1];this._renderSegment(T,E,M,N,e)}let c,u=r[r.length-1];for(let h=0;h<r.length;++h){c=u,u=r[h];const f=Math.floor(s[u]/3)*2,m=o[f],A=o[f+1],x=c*4,T=this._project(m,A,l[x+2],l[x+3]);T&&this._renderSegment(m,A,T[0],T[1],e)}return n&&n.value()}renderBounds(e){const n=e==null?e=new HA:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(e,n){const i=n==null?n=new HA:void 0,s=this._clip(e);if(s===null||!s.length)return;n.moveTo(s[0],s[1]);let r=s.length;for(;s[0]===s[r-2]&&s[1]===s[r-1]&&r>1;)r-=2;for(let o=2;o<r;o+=2)(s[o]!==s[o-2]||s[o+1]!==s[o-1])&&n.lineTo(s[o],s[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let n=0,i=e.length/2;n<i;++n){const s=this.cellPolygon(n);s&&(s.index=n,yield s)}}cellPolygon(e){const n=new AO;return this.renderCell(e,n),n.value()}_renderSegment(e,n,i,s,r){let o;const l=this._regioncode(e,n),c=this._regioncode(i,s);l===0&&c===0?(r.moveTo(e,n),r.lineTo(i,s)):(o=this._clipSegment(e,n,i,s,l,c))&&(r.moveTo(o[0],o[1]),r.lineTo(o[2],o[3]))}contains(e,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(e,n,i)===e}*neighbors(e){const n=this._clip(e);if(n)for(const i of this.delaunay.neighbors(e)){const s=this._clip(i);if(s){e:for(let r=0,o=n.length;r<o;r+=2)for(let l=0,c=s.length;l<c;l+=2)if(n[r]===s[l]&&n[r+1]===s[l+1]&&n[(r+2)%o]===s[(l+c-2)%c]&&n[(r+3)%o]===s[(l+c-1)%c]){yield i;break e}}}}_cell(e){const{circumcenters:n,delaunay:{inedges:i,halfedges:s,triangles:r}}=this,o=i[e];if(o===-1)return null;const l=[];let c=o;do{const u=Math.floor(c/3);if(l.push(n[u*2],n[u*2+1]),c=c%3===2?c-2:c+1,r[c]!==e)break;c=s[c]}while(c!==o&&c!==-1);return l}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(e);if(n===null)return null;const{vectors:i}=this,s=e*4;return this._simplify(i[s]||i[s+1]?this._clipInfinite(e,n,i[s],i[s+1],i[s+2],i[s+3]):this._clipFinite(e,n))}_clipFinite(e,n){const i=n.length;let s=null,r,o,l=n[i-2],c=n[i-1],u,h=this._regioncode(l,c),f,m=0;for(let A=0;A<i;A+=2)if(r=l,o=c,l=n[A],c=n[A+1],u=h,h=this._regioncode(l,c),u===0&&h===0)f=m,m=0,s?s.push(l,c):s=[l,c];else{let x,T,E,M,N;if(u===0){if((x=this._clipSegment(r,o,l,c,u,h))===null)continue;[T,E,M,N]=x}else{if((x=this._clipSegment(l,c,r,o,h,u))===null)continue;[M,N,T,E]=x,f=m,m=this._edgecode(T,E),f&&m&&this._edge(e,f,m,s,s.length),s?s.push(T,E):s=[T,E]}f=m,m=this._edgecode(M,N),f&&m&&this._edge(e,f,m,s,s.length),s?s.push(M,N):s=[M,N]}if(s)f=m,m=this._edgecode(s[0],s[1]),f&&m&&this._edge(e,f,m,s,s.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(e,n,i,s,r,o){const l=r<o;for(l&&([e,n,i,s,r,o]=[i,s,e,n,o,r]);;){if(r===0&&o===0)return l?[i,s,e,n]:[e,n,i,s];if(r&o)return null;let c,u,h=r||o;h&8?(c=e+(i-e)*(this.ymax-n)/(s-n),u=this.ymax):h&4?(c=e+(i-e)*(this.ymin-n)/(s-n),u=this.ymin):h&2?(u=n+(s-n)*(this.xmax-e)/(i-e),c=this.xmax):(u=n+(s-n)*(this.xmin-e)/(i-e),c=this.xmin),r?(e=c,n=u,r=this._regioncode(e,n)):(i=c,s=u,o=this._regioncode(i,s))}}_clipInfinite(e,n,i,s,r,o){let l=Array.from(n),c;if((c=this._project(l[0],l[1],i,s))&&l.unshift(c[0],c[1]),(c=this._project(l[l.length-2],l[l.length-1],r,o))&&l.push(c[0],c[1]),l=this._clipFinite(e,l))for(let u=0,h=l.length,f,m=this._edgecode(l[h-2],l[h-1]);u<h;u+=2)f=m,m=this._edgecode(l[u],l[u+1]),f&&m&&(u=this._edge(e,f,m,l,u),h=l.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(l=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return l}_edge(e,n,i,s,r){for(;n!==i;){let o,l;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,l=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,l=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,l=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,l=this.ymin;break}(s[r]!==o||s[r+1]!==l)&&this.contains(e,o,l)&&(s.splice(r,0,o,l),r+=2)}return r}_project(e,n,i,s){let r=1/0,o,l,c;if(s<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/s)<r&&(c=this.ymin,l=e+(r=o)*i)}else if(s>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/s)<r&&(c=this.ymax,l=e+(r=o)*i)}if(i>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/i)<r&&(l=this.xmax,c=n+(r=o)*s)}else if(i<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/i)<r&&(l=this.xmin,c=n+(r=o)*s)}return[l,c]}_edgecode(e,n){return(e===this.xmin?1:e===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(e,n){return(e<this.xmin?1:e>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let n=0;n<e.length;n+=2){const i=(n+2)%e.length,s=(n+4)%e.length;(e[n]===e[i]&&e[i]===e[s]||e[n+1]===e[i+1]&&e[i+1]===e[s+1])&&(e.splice(i,2),n-=2)}e.length||(e=null)}return e}}const mke=2*Math.PI,Iv=Math.pow;function gke(a){return a[0]}function Ake(a){return a[1]}function yke(a){const{triangles:e,coords:n}=a;for(let i=0;i<e.length;i+=3){const s=2*e[i],r=2*e[i+1],o=2*e[i+2];if((n[o]-n[s])*(n[r+1]-n[s+1])-(n[r]-n[s])*(n[o+1]-n[s+1])>1e-10)return!1}return!0}function vke(a,e,n){return[a+Math.sin(a+e)*n,e+Math.cos(a-e)*n]}class nB{static from(e,n=gke,i=Ake,s){return new nB("length"in e?_ke(e,n,i,s):Float64Array.from(xke(e,n,i,s)))}constructor(e){this._delaunator=new sT(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,n=this.points;if(e.hull&&e.hull.length>2&&yke(e)){this.collinear=Int32Array.from({length:n.length/2},(m,A)=>A).sort((m,A)=>n[2*m]-n[2*A]||n[2*m+1]-n[2*A+1]);const c=this.collinear[0],u=this.collinear[this.collinear.length-1],h=[n[2*c],n[2*c+1],n[2*u],n[2*u+1]],f=1e-8*Math.hypot(h[3]-h[1],h[2]-h[0]);for(let m=0,A=n.length/2;m<A;++m){const x=vke(n[2*m],n[2*m+1],f);n[2*m]=x[0],n[2*m+1]=x[1]}this._delaunator=new sT(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,s=this.hull=this._delaunator.hull,r=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),l=this._hullIndex.fill(-1);for(let c=0,u=i.length;c<u;++c){const h=r[c%3===2?c-2:c+1];(i[c]===-1||o[h]===-1)&&(o[h]=c)}for(let c=0,u=s.length;c<u;++c)l[s[c]]=c;s.length<=2&&s.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=s[0],o[s[0]]=1,s.length===2&&(o[s[1]]=0,this.triangles[1]=s[1],this.triangles[2]=s[1]))}voronoi(e){return new pke(this,e)}*neighbors(e){const{inedges:n,hull:i,_hullIndex:s,halfedges:r,triangles:o,collinear:l}=this;if(l){const f=l.indexOf(e);f>0&&(yield l[f-1]),f<l.length-1&&(yield l[f+1]);return}const c=n[e];if(c===-1)return;let u=c,h=-1;do{if(yield h=o[u],u=u%3===2?u-2:u+1,o[u]!==e)return;if(u=r[u],u===-1){const f=i[(s[e]+1)%i.length];f!==h&&(yield f);return}}while(u!==c)}find(e,n,i=0){if(e=+e,e!==e||(n=+n,n!==n))return-1;const s=i;let r;for(;(r=this._step(i,e,n))>=0&&r!==i&&r!==s;)i=r;return r}_step(e,n,i){const{inedges:s,hull:r,_hullIndex:o,halfedges:l,triangles:c,points:u}=this;if(s[e]===-1||!u.length)return(e+1)%(u.length>>1);let h=e,f=Iv(n-u[e*2],2)+Iv(i-u[e*2+1],2);const m=s[e];let A=m;do{let x=c[A];const T=Iv(n-u[x*2],2)+Iv(i-u[x*2+1],2);if(T<f&&(f=T,h=x),A=A%3===2?A-2:A+1,c[A]!==e)break;if(A=l[A],A===-1){if(A=r[(o[e]+1)%r.length],A!==x&&Iv(n-u[A*2],2)+Iv(i-u[A*2+1],2)<f)return A;break}}while(A!==m);return h}render(e){const n=e==null?e=new HA:void 0,{points:i,halfedges:s,triangles:r}=this;for(let o=0,l=s.length;o<l;++o){const c=s[o];if(c<o)continue;const u=r[o]*2,h=r[c]*2;e.moveTo(i[u],i[u+1]),e.lineTo(i[h],i[h+1])}return this.renderHull(e),n&&n.value()}renderPoints(e,n){n===void 0&&(!e||typeof e.moveTo!="function")&&(n=e,e=null),n=n==null?2:+n;const i=e==null?e=new HA:void 0,{points:s}=this;for(let r=0,o=s.length;r<o;r+=2){const l=s[r],c=s[r+1];e.moveTo(l+n,c),e.arc(l,c,n,0,mke)}return i&&i.value()}renderHull(e){const n=e==null?e=new HA:void 0,{hull:i,points:s}=this,r=i[0]*2,o=i.length;e.moveTo(s[r],s[r+1]);for(let l=1;l<o;++l){const c=2*i[l];e.lineTo(s[c],s[c+1])}return e.closePath(),n&&n.value()}hullPolygon(){const e=new AO;return this.renderHull(e),e.value()}renderTriangle(e,n){const i=n==null?n=new HA:void 0,{points:s,triangles:r}=this,o=r[e*=3]*2,l=r[e+1]*2,c=r[e+2]*2;return n.moveTo(s[o],s[o+1]),n.lineTo(s[l],s[l+1]),n.lineTo(s[c],s[c+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:e}=this;for(let n=0,i=e.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(e){const n=new AO;return this.renderTriangle(e,n),n.value()}}function _ke(a,e,n,i){const s=a.length,r=new Float64Array(s*2);for(let o=0;o<s;++o){const l=a[o];r[o*2]=e.call(i,l,o,a),r[o*2+1]=n.call(i,l,o,a)}return r}function*xke(a,e,n,i){let s=0;for(const r of a)yield e.call(i,r,s,a),yield n.call(i,r,s,a),++s}const aB=Math.PI,I$=aB/2,L$=180/aB,D$=aB/180,bke=Math.atan2,k$=Math.cos,Ske=Math.max,Tke=Math.min,O$=Math.sin,wke=Math.sign||function(a){return a>0?1:a<0?-1:0},dne=Math.sqrt;function Eke(a){return a>1?I$:a<-1?-I$:Math.asin(a)}function hne(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]}function Zc(a,e){return[a[1]*e[2]-a[2]*e[1],a[2]*e[0]-a[0]*e[2],a[0]*e[1]-a[1]*e[0]]}function uR(a,e){return[a[0]+e[0],a[1]+e[1],a[2]+e[2]]}function dR(a){var e=dne(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/e,a[1]/e,a[2]/e]}function iB(a){return[bke(a[1],a[0])*L$,Eke(Ske(-1,Tke(1,a[2])))*L$]}function af(a){const e=a[0]*D$,n=a[1]*D$,i=k$(n);return[i*k$(e),i*O$(e),O$(n)]}function sB(a){return a=a.map(e=>af(e)),hne(a[0],Zc(a[2],a[1]))}function Mke(a){const e=Nke(a),n=Pke(e),i=Rke(n,a),s=Lke(n,a.length),r=Cke(s,a),o=Ike(n,a),{polygons:l,centers:c}=Dke(o,n,a),u=kke(l),h=Fke(n,a),f=Oke(i,n);return{delaunay:e,edges:i,triangles:n,centers:c,neighbors:s,polygons:l,mesh:u,hull:h,urquhart:f,find:r}}function Cke(a,e){function n(i,s){let r=i[0]-s[0],o=i[1]-s[1],l=i[2]-s[2];return r*r+o*o+l*l}return function(s,r,o){o===void 0&&(o=0);let l,c,u=o;const h=af([s,r]);do l=o,o=null,c=n(h,af(e[l])),a[l].forEach(f=>{let m=n(h,af(e[f]));if(m<c){c=m,o=f,u=f;return}});while(o!==null);return u}}function Nke(a){if(a.length<2)return{};let e=0;for(;isNaN(a[e][0]+a[e][1])&&e++<a.length;);const n=gDe(a[e]),i=YDe().translate([0,0]).scale(1).rotate(n.invert([180,0]));a=a.map(i);const s=[];let r=1;for(let f=0,m=a.length;f<m;f++){let A=a[f][0]**2+a[f][1]**2;!isFinite(A)||A>1e32?s.push(f):A>r&&(r=A)}const o=1e6*dne(r);s.forEach(f=>a[f]=[o,0]),a.push([0,o]),a.push([-o,0]),a.push([0,-o]);const l=nB.from(a);l.projection=i;const{triangles:c,halfedges:u,inedges:h}=l;for(let f=0,m=u.length;f<m;f++)if(u[f]<0){const A=f%3==2?f-2:f+1,x=f%3==0?f+2:f-1,T=u[A],E=u[x];u[T]=E,u[E]=T,u[A]=u[x]=-1,c[f]=c[A]=c[x]=e,h[c[T]]=T%3==0?T+2:T-1,h[c[E]]=E%3==0?E+2:E-1,f+=2-f%3}else c[f]>a.length-3-1&&(c[f]=e);return l}function Rke(a,e){const n=new Set;return e.length===2?[[0,1]]:(a.forEach(i=>{if(i[0]!==i[1]&&!(sB(i.map(s=>e[s]))<0))for(let s=0,r;s<3;s++)r=(s+1)%3,n.add(kN([i[s],i[r]]).join("-"))}),Array.from(n,i=>i.split("-").map(Number)))}function Pke(a){const{triangles:e}=a;if(!e)return[];const n=[];for(let i=0,s=e.length/3;i<s;i++){const r=e[3*i],o=e[3*i+1],l=e[3*i+2];r!==o&&o!==l&&n.push([r,l,o])}return n}function Ike(a,e){return a.map(n=>{const i=n.map(r=>e[r]).map(af),s=uR(uR(Zc(i[1],i[0]),Zc(i[2],i[1])),Zc(i[0],i[2]));return iB(dR(s))})}function Lke(a,e){const n=[];return a.forEach(i=>{for(let s=0;s<3;s++){const r=i[s],o=i[(s+1)%3];n[r]=n[r]||[],n[r].push(o)}}),a.length===0&&(e===2?(n[0]=[1],n[1]=[0]):e===1&&(n[0]=[])),n}function Dke(a,e,n){const i=[],s=a.slice();if(e.length===0){if(n.length<2)return{polygons:i,centers:s};if(n.length===2){const l=af(n[0]),c=af(n[1]),u=dR(uR(l,c)),h=dR(Zc(l,c)),f=Zc(u,h),m=[u,Zc(u,f),Zc(Zc(u,f),f),Zc(Zc(Zc(u,f),f),f)].map(iB).map(o);return i.push(m),i.push(m.slice().reverse()),{polygons:i,centers:s}}}e.forEach((l,c)=>{for(let u=0;u<3;u++){const h=l[u],f=l[(u+1)%3],m=l[(u+2)%3];i[h]=i[h]||[],i[h].push([f,m,c,[h,f,m]])}});const r=i.map(l=>{const c=[l[0][2]];let u=l[0][1];for(let h=1;h<l.length;h++)for(let f=0;f<l.length;f++)if(l[f][0]==u){u=l[f][1],c.push(l[f][2]);break}if(c.length>2)return c;if(c.length==2){const h=F$(n[l[0][3][0]],n[l[0][3][1]],s[c[0]]),f=F$(n[l[0][3][2]],n[l[0][3][0]],s[c[0]]),m=o(h),A=o(f);return[c[0],A,c[1],m]}});function o(l){let c=-1;return s.slice(e.length,1/0).forEach((u,h)=>{u[0]===l[0]&&u[1]===l[1]&&(c=h+e.length)}),c<0&&(c=s.length,s.push(l)),c}return{polygons:r,centers:s}}function F$(a,e,n){a=af(a),e=af(e),n=af(n);const i=wke(hne(Zc(e,a),n));return iB(dR(uR(a,e)).map(s=>i*s))}function kke(a){const e=[];return a.forEach(n=>{if(!n)return;let i=n[n.length-1];for(let s of n)s>i&&e.push([i,s]),i=s}),e}function Oke(a,e){return function(n){const i=new Map,s=new Map;return a.forEach((r,o)=>{const l=r.join("-");i.set(l,n[o]),s.set(l,!0)}),e.forEach(r=>{let o=0,l=-1;for(let c=0;c<3;c++){let u=kN([r[c],r[(c+1)%3]]).join("-");i.get(u)>o&&(o=i.get(u),l=u)}s.set(l,!1)}),a.map(r=>s.get(r.join("-")))}}function Fke(a,e){const n=new Set,i=[];a.map(l=>{if(!(sB(l.map(c=>e[c>e.length?0:c]))>1e-12))for(let c=0;c<3;c++){let u=[l[c],l[(c+1)%3]],h=`${u[0]}-${u[1]}`;n.has(h)?n.delete(h):n.add(`${u[1]}-${u[0]}`)}});const s=new Map;let r;if(n.forEach(l=>{l=l.split("-").map(Number),s.set(l[0],l[1]),r=l[0]}),r===void 0)return i;let o=r;do{i.push(o);let l=s.get(o);s.set(o,-1),o=l}while(o>-1&&o!==r);return i}function jke(a){const e=function(n){if(e.delaunay=null,e._data=n,typeof e._data=="object"&&e._data.type==="FeatureCollection"&&(e._data=e._data.features),typeof e._data=="object"){const i=e._data.map(s=>[e._vx(s),e._vy(s),s]).filter(s=>isFinite(s[0]+s[1]));e.points=i.map(s=>[s[0],s[1]]),e.valid=i.map(s=>s[2]),e.delaunay=Mke(e.points)}return e};return e._vx=function(n){if(typeof n=="object"&&"type"in n)return KW(n)[0];if(0 in n)return n[0]},e._vy=function(n){if(typeof n=="object"&&"type"in n)return KW(n)[1];if(1 in n)return n[1]},e.x=function(n){return n?(e._vx=n,e):e._vx},e.y=function(n){return n?(e._vy=n,e):e._vy},e.polygons=function(n){if(n!==void 0&&e(n),!e.delaunay)return!1;const i={type:"FeatureCollection",features:[]};return e.valid.length===0||(e.delaunay.polygons.forEach((s,r)=>i.features.push({type:"Feature",geometry:s?{type:"Polygon",coordinates:[[...s,s[0]].map(o=>e.delaunay.centers[o])]}:null,properties:{site:e.valid[r],sitecoordinates:e.points[r],neighbours:e.delaunay.neighbors[r]}})),e.valid.length===1&&i.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:e.valid[0],sitecoordinates:e.points[0],neighbours:[]}})),i},e.triangles=function(n){return n!==void 0&&e(n),e.delaunay?{type:"FeatureCollection",features:e.delaunay.triangles.map((i,s)=>(i=i.map(r=>e.points[r]),i.center=e.delaunay.centers[s],i)).filter(i=>sB(i)>0).map(i=>({type:"Feature",properties:{circumcenter:i.center},geometry:{type:"Polygon",coordinates:[[...i,i[0]]]}}))}:!1},e.links=function(n){if(n!==void 0&&e(n),!e.delaunay)return!1;const i=e.delaunay.edges.map(r=>A0(e.points[r[0]],e.points[r[1]])),s=e.delaunay.urquhart(i);return{type:"FeatureCollection",features:e.delaunay.edges.map((r,o)=>({type:"Feature",properties:{source:e.valid[r[0]],target:e.valid[r[1]],length:i[o],urquhart:!!s[o]},geometry:{type:"LineString",coordinates:[e.points[r[0]],e.points[r[1]]]}}))}},e.mesh=function(n){return n!==void 0&&e(n),e.delaunay?{type:"MultiLineString",coordinates:e.delaunay.edges.map(i=>[e.points[i[0]],e.points[i[1]]])}:!1},e.cellMesh=function(n){if(n!==void 0&&e(n),!e.delaunay)return!1;const{centers:i,polygons:s}=e.delaunay,r=[];for(const o of s)if(o)for(let l=o.length,c=o[l-1],u=o[0],h=0;h<l;c=u,u=o[++h])u>c&&r.push([i[c],i[u]]);return{type:"MultiLineString",coordinates:r}},e._found=void 0,e.find=function(n,i,s){if(e._found=e.delaunay.find(n,i,e._found),!s||A0([n,i],e.points[e._found])<s)return e._found},e.hull=function(n){n!==void 0&&e(n);const i=e.delaunay.hull,s=e.points;return i.length===0?null:{type:"Polygon",coordinates:[[...i.map(r=>s[r]),s[i[0]]]]}},a?e(a):e}function yO(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=Array(e);n<e;n++)i[n]=a[n];return i}function Bke(a){if(Array.isArray(a))return a}function Uke(a){if(Array.isArray(a))return yO(a)}function Vke(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function zke(a,e,n){return e=hR(e),Xke(a,fne()?Reflect.construct(e,[],hR(a).constructor):e.apply(a,n))}function Gke(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function qke(a,e,n){return Object.defineProperty(a,"prototype",{writable:!1}),a}function hR(a){return hR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hR(a)}function Hke(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&vO(a,e)}function fne(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fne=function(){return!!a})()}function Wke(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function $ke(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i,s,r,o,l=[],c=!0,u=!1;try{if(r=(n=n.call(a)).next,e!==0)for(;!(c=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function Kke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xke(a,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vke(a)}function vO(a,e){return vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vO(a,e)}function jh(a,e){return Bke(a)||$ke(a,e)||pne(a,e)||Kke()}function x5(a){return Uke(a)||Wke(a)||pne(a)||Yke()}function pne(a,e){if(a){if(typeof a=="string")return yO(a,e);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yO(a,e):void 0}}function Qke(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.resolution,i=n===void 0?1/0:n,s=Jke(a,i),r=QS(s),o=Zke(a,i),l=[].concat(x5(r),x5(o)),c={type:"Polygon",coordinates:a},u=Dte(c),h=jh(u,2),f=jh(h[0],2),m=f[0],A=f[1],x=jh(h[1],2),T=x[0],E=x[1],M=m>T||E>=89||A<=-89,N=[];if(M){var I=jke(l).triangles(),F=new Map(l.map(function(Y,ue){var pe=jh(Y,2),Ee=pe[0],oe=pe[1];return["".concat(Ee,"-").concat(oe),ue]}));I.features.forEach(function(Y){var ue,pe=Y.geometry.coordinates[0].slice(0,3).reverse(),Ee=[];if(pe.forEach(function(Ae){var be=jh(Ae,2),Ce=be[0],ce=be[1],te="".concat(Ce,"-").concat(ce);F.has(te)&&Ee.push(F.get(te))}),Ee.length===3){if(Ee.some(function(Ae){return Ae<r.length})){var oe=Y.properties.circumcenter;if(!_O(oe,c,M))return}(ue=N).push.apply(ue,Ee)}})}else if(o.length)for(var L=sT.from(l),U=function(ue){var pe,Ee=[2,1,0].map(function(be){return L.triangles[ue+be]}),oe=Ee.map(function(be){return l[be]});if(Ee.some(function(be){return be<r.length})){var Ae=[0,1].map(function(be){return cLe(oe,function(Ce){return Ce[be]})});if(!_O(Ae,c,M))return 1}(pe=N).push.apply(pe,x5(Ee))},q=0,K=L.triangles.length;q<K;q+=3)U(q);else{var G=rR(s),O=G.vertices,D=G.holes,j=D===void 0?[]:D;N=v5e(O,j,2)}var H=bm(kN(l,function(Y){return Y[0]}),[0,1]),X=bm(kN(l,function(Y){return Y[1]}),[0,1]),ne=l.map(function(Y){var ue=jh(Y,2),pe=ue[0],Ee=ue[1];return[H(pe),X(Ee)]}),Q={points:l,indices:N,uvs:ne};return{contour:s,triangles:Q}}function Jke(a,e){return a.map(function(n){var i=[],s;return n.forEach(function(r){if(s){var o=A0(r,s)*180/Math.PI;if(o>e)for(var l=Xj(s,r),c=1/Math.ceil(o/e),u=c;u<1;)i.push(l(u)),u+=c}i.push(s=r)}),i})}function Zke(a,e){var n={type:"Polygon",coordinates:a},i=Dte(n),s=jh(i,2),r=jh(s[0],2),o=r[0],l=r[1],c=jh(s[1],2),u=c[0],h=c[1];if(Math.min(Math.abs(u-o),Math.abs(h-l))<e)return[];var f=o>u||h>=89||l<=-89;return eOe(e,{minLng:o,maxLng:u,minLat:l,maxLat:h}).filter(function(m){return _O(m,n,f)})}function eOe(a){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.minLng,i=e.maxLng,s=e.minLat,r=e.maxLat,o=Math.round(Math.pow(360/a,2)/Math.PI),l=(1+Math.sqrt(5))/2,c=function(M){return M/l*360%360-180},u=function(M){return Math.acos(2*M/o-1)/Math.PI*180-90},h=function(M){return o*(Math.cos((M+90)*Math.PI/180)+1)/2},f=[r!==void 0?Math.ceil(h(r)):0,s!==void 0?Math.floor(h(s)):o-1],m=n===void 0&&i===void 0?function(){return!0}:n===void 0?function(E){return E<=i}:i===void 0?function(E){return E>=n}:i>=n?function(E){return E>=n&&E<=i}:function(E){return E>=n||E<=i},A=[],x=f[0];x<=f[1];x++){var T=c(x);m(T)&&A.push([T,u(x)])}return A}function _O(a,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return n?LDe(e,a):fke(a,e)}var a3=window.THREE?window.THREE:{BufferGeometry:zn,Float32BufferAttribute:mn},j$=new a3.BufferGeometry().setAttribute?"setAttribute":"addAttribute",rB=(function(a){function e(n,i,s,r,o,l,c){var u;Gke(this,e),u=zke(this,e),u.type="ConicPolygonGeometry",u.parameters={polygonGeoJson:n,bottomHeight:i,topHeight:s,closedBottom:r,closedTop:o,includeSides:l,curvatureResolution:c},i=i||0,s=s||1,r=r!==void 0?r:!0,o=o!==void 0?o:!0,l=l!==void 0?l:!0,c=c||5;var h=Qke(n,{resolution:c}),f=h.contour,m=h.triangles,A=QS(m.uvs),x=[],T=[],E=[],M=0,N=function(D){var j=Math.round(x.length/3),L=E.length;x=x.concat(D.vertices),T=T.concat(D.uvs),E=E.concat(j?D.indices.map(function(U){return U+j}):D.indices),u.addGroup(L,E.length-L,M++)};l&&N(F()),r&&N(G(i,!1)),o&&N(G(s,!0)),u.setIndex(E),u[j$]("position",new a3.Float32BufferAttribute(x,3)),u[j$]("uv",new a3.Float32BufferAttribute(T,2)),u.computeVertexNormals();function I(O,D){var j=typeof D=="function"?D:function(){return D},L=O.map(function(U){return U.map(function(q){var K=jh(q,2),H=K[0],X=K[1];return tOe(X,H,j(H,X))})});return rR(L)}function F(){for(var O=I(f,i),D=O.vertices,j=O.holes,L=I(f,s),U=L.vertices,q=QS([U,D]),K=Math.round(U.length/3),H=new Set(j),X=0,ne=[],Q=0;Q<K;Q++){var Y=Q+1;if(Y===K)Y=X;else if(H.has(Y)){var ue=Y;Y=X,X=ue}ne.push(Q,Q+K,Y+K),ne.push(Y+K,Y,Q)}for(var pe=[],Ee=1;Ee>=0;Ee--)for(var oe=0;oe<K;oe+=1)pe.push(oe/(K-1),Ee);return{indices:ne,vertices:q,uvs:pe}}function G(O){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{indices:D?m.indices:m.indices.slice().reverse(),vertices:I([m.points],O).vertices,uvs:A}}return u}return Hke(e,a),qke(e)})(a3.BufferGeometry);function tOe(a,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-a)*Math.PI/180,s=(90-e)*Math.PI/180;return[n*Math.sin(i)*Math.cos(s),n*Math.cos(i),n*Math.sin(i)*Math.sin(s)]}function xO(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=Array(e);n<e;n++)i[n]=a[n];return i}function nOe(a){if(Array.isArray(a))return a}function aOe(a){if(Array.isArray(a))return xO(a)}function iOe(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function sOe(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i,s,r,o,l=[],c=!0,u=!1;try{if(r=(n=n.call(a)).next,e!==0)for(;!(c=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function rOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lOe(a,e){if(a==null)return{};var n,i,s=cOe(a,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);for(i=0;i<r.length;i++)n=r[i],e.includes(n)||{}.propertyIsEnumerable.call(a,n)&&(s[n]=a[n])}return s}function cOe(a,e){if(a==null)return{};var n={};for(var i in a)if({}.hasOwnProperty.call(a,i)){if(e.includes(i))continue;n[i]=a[i]}return n}function uOe(a,e){return nOe(a)||sOe(a,e)||mne(a,e)||rOe()}function dOe(a){return aOe(a)||iOe(a)||mne(a)||oOe()}function hOe(a,e){if(typeof a!="object"||!a)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var i=n.call(a,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}function fOe(a){var e=hOe(a,"string");return typeof e=="symbol"?e:e+""}function mne(a,e){if(a){if(typeof a=="string")return xO(a,e);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xO(a,e):void 0}}var pOe=(function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(l){return{keyAccessor:l,isProp:!(l instanceof Function)}}),r=a.reduce(function(l,c){var u=l,h=c;return s.forEach(function(f,m){var A=f.keyAccessor,x=f.isProp,T;if(x){var E=h,M=E[A],N=lOe(E,[A].map(fOe));T=M,h=N}else T=A(h,m);m+1<s.length?(u.hasOwnProperty(T)||(u[T]={}),u=u[T]):n?(u.hasOwnProperty(T)||(u[T]=[]),u[T].push(h)):u[T]=h}),l},{});n instanceof Function&&(function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;u===s.length?Object.keys(c).forEach(function(h){return c[h]=n(c[h])}):Object.values(c).forEach(function(h){return l(h,u+1)})})(r);var o=r;return i&&(o=[],(function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];u.length===s.length?o.push({keys:u,vals:c}):Object.entries(c).forEach(function(h){var f=uOe(h,2),m=f[0],A=f[1];return l(A,[].concat(dOe(u),[m]))})})(r),e instanceof Array&&e.length===0&&o.length===1&&(o[0].keys=[])),o}),ci=(function(a){a=a||{};var e=typeof a<"u"?a:{},n={},i;for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);var s="";function r(bt){return e.locateFile?e.locateFile(bt,s):s+bt}var o;typeof document<"u"&&document.currentScript&&(s=document.currentScript.src),s.indexOf("blob:")!==0?s=s.substr(0,s.lastIndexOf("/")+1):s="",o=function(Bt,ln,Ut){var _=new XMLHttpRequest;_.open("GET",Bt,!0),_.responseType="arraybuffer",_.onload=function(){if(_.status==200||_.status==0&&_.response){ln(_.response);return}var Yn=kt(Bt);if(Yn){ln(Yn.buffer);return}Ut()},_.onerror=Ut,_.send(null)};var l=e.print||console.log.bind(console),c=e.printErr||console.warn.bind(console);for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i]);n=null,e.arguments&&e.arguments;var u=0,h=function(bt){u=bt},f=function(){return u},m=8;function A(bt,Bt,ln,Ut){switch(ln=ln||"i8",ln.charAt(ln.length-1)==="*"&&(ln="i32"),ln){case"i1":K[bt>>0]=Bt;break;case"i8":K[bt>>0]=Bt;break;case"i16":X[bt>>1]=Bt;break;case"i32":ne[bt>>2]=Bt;break;case"i64":Ge=[Bt>>>0,(le=Bt,+Ve(le)>=1?le>0?(Je(+ze(le/4294967296),4294967295)|0)>>>0:~~+Me((le-+(~~le>>>0))/4294967296)>>>0:0)],ne[bt>>2]=Ge[0],ne[bt+4>>2]=Ge[1];break;case"float":Q[bt>>2]=Bt;break;case"double":Y[bt>>3]=Bt;break;default:dr("invalid type for setValue: "+ln)}}function x(bt,Bt,ln){switch(Bt=Bt||"i8",Bt.charAt(Bt.length-1)==="*"&&(Bt="i32"),Bt){case"i1":return K[bt>>0];case"i8":return K[bt>>0];case"i16":return X[bt>>1];case"i32":return ne[bt>>2];case"i64":return ne[bt>>2];case"float":return Q[bt>>2];case"double":return Y[bt>>3];default:dr("invalid type for getValue: "+Bt)}return null}var T=!1;function E(bt,Bt){bt||dr("Assertion failed: "+Bt)}function M(bt){var Bt=e["_"+bt];return E(Bt,"Cannot call unknown function "+bt+", make sure it is exported"),Bt}function N(bt,Bt,ln,Ut,_){var me={string:function(la){var hr=0;if(la!=null&&la!==0){var yo=(la.length<<2)+1;hr=Ht(yo),j(la,hr,yo)}return hr},array:function(la){var hr=Ht(la.length);return L(la,hr),hr}};function Yn(la){return Bt==="string"?O(la):Bt==="boolean"?!!la:la}var va=M(bt),Pa=[],Ln=0;if(Ut)for(var oa=0;oa<Ut.length;oa++){var Kr=me[ln[oa]];Kr?(Ln===0&&(Ln=zt()),Pa[oa]=Kr(Ut[oa])):Pa[oa]=Ut[oa]}var ka=va.apply(null,Pa);return ka=Yn(ka),Ln!==0&&$t(Ln),ka}function I(bt,Bt,ln,Ut){ln=ln||[];var _=ln.every(function(Yn){return Yn==="number"}),me=Bt!=="string";return me&&_&&!Ut?M(bt):function(){return N(bt,Bt,ln,arguments)}}var F=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function G(bt,Bt,ln){for(var Ut=Bt+ln,_=Bt;bt[_]&&!(_>=Ut);)++_;if(_-Bt>16&&bt.subarray&&F)return F.decode(bt.subarray(Bt,_));for(var me="";Bt<_;){var Yn=bt[Bt++];if(!(Yn&128)){me+=String.fromCharCode(Yn);continue}var va=bt[Bt++]&63;if((Yn&224)==192){me+=String.fromCharCode((Yn&31)<<6|va);continue}var Pa=bt[Bt++]&63;if((Yn&240)==224?Yn=(Yn&15)<<12|va<<6|Pa:Yn=(Yn&7)<<18|va<<12|Pa<<6|bt[Bt++]&63,Yn<65536)me+=String.fromCharCode(Yn);else{var Ln=Yn-65536;me+=String.fromCharCode(55296|Ln>>10,56320|Ln&1023)}}return me}function O(bt,Bt){return bt?G(H,bt,Bt):""}function D(bt,Bt,ln,Ut){if(!(Ut>0))return 0;for(var _=ln,me=ln+Ut-1,Yn=0;Yn<bt.length;++Yn){var va=bt.charCodeAt(Yn);if(va>=55296&&va<=57343){var Pa=bt.charCodeAt(++Yn);va=65536+((va&1023)<<10)|Pa&1023}if(va<=127){if(ln>=me)break;Bt[ln++]=va}else if(va<=2047){if(ln+1>=me)break;Bt[ln++]=192|va>>6,Bt[ln++]=128|va&63}else if(va<=65535){if(ln+2>=me)break;Bt[ln++]=224|va>>12,Bt[ln++]=128|va>>6&63,Bt[ln++]=128|va&63}else{if(ln+3>=me)break;Bt[ln++]=240|va>>18,Bt[ln++]=128|va>>12&63,Bt[ln++]=128|va>>6&63,Bt[ln++]=128|va&63}}return Bt[ln]=0,ln-_}function j(bt,Bt,ln){return D(bt,H,Bt,ln)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function L(bt,Bt){K.set(bt,Bt)}function U(bt,Bt){return bt%Bt>0&&(bt+=Bt-bt%Bt),bt}var q,K,H,X,ne,Q,Y;function ue(bt){q=bt,e.HEAP8=K=new Int8Array(bt),e.HEAP16=X=new Int16Array(bt),e.HEAP32=ne=new Int32Array(bt),e.HEAPU8=H=new Uint8Array(bt),e.HEAPU16=new Uint16Array(bt),e.HEAPU32=new Uint32Array(bt),e.HEAPF32=Q=new Float32Array(bt),e.HEAPF64=Y=new Float64Array(bt)}var pe=5271536,Ee=28624,oe=e.TOTAL_MEMORY||33554432;e.buffer?q=e.buffer:q=new ArrayBuffer(oe),oe=q.byteLength,ue(q),ne[Ee>>2]=pe;function Ae(bt){for(;bt.length>0;){var Bt=bt.shift();if(typeof Bt=="function"){Bt();continue}var ln=Bt.func;typeof ln=="number"?Bt.arg===void 0?e.dynCall_v(ln):e.dynCall_vi(ln,Bt.arg):ln(Bt.arg===void 0?null:Bt.arg)}}var be=[],Ce=[],ce=[],te=[];function fe(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)at(e.preRun.shift());Ae(be)}function Le(){Ae(Ce)}function Fe(){Ae(ce)}function Ie(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)je(e.postRun.shift());Ae(te)}function at(bt){be.unshift(bt)}function je(bt){te.unshift(bt)}var Ve=Math.abs,Me=Math.ceil,ze=Math.floor,Je=Math.min,rt=0,ve=null;function Ue(bt){rt++,e.monitorRunDependencies&&e.monitorRunDependencies(rt)}function it(bt){if(rt--,e.monitorRunDependencies&&e.monitorRunDependencies(rt),rt==0&&ve){var Bt=ve;ve=null,Bt()}}e.preloadedImages={},e.preloadedAudios={};var wt=null,Mt="data:application/octet-stream;base64,";function _e(bt){return String.prototype.startsWith?bt.startsWith(Mt):bt.indexOf(Mt)===0}var le,Ge;wt="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAdmVydGV4Um90YXRpb25zAGNlbGxUb1ZlcnRleABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var tt=28640;function pt(bt,Bt,ln,Ut){dr("Assertion failed: "+O(bt)+", at: "+[Bt?O(Bt):"unknown filename",ln,Ut?O(Ut):"unknown function"])}function Te(){return K.length}function st(bt,Bt,ln){H.set(H.subarray(Bt,Bt+ln),bt)}function mt(bt){return e.___errno_location&&(ne[e.___errno_location()>>2]=bt),bt}function ht(bt){dr("OOM")}function Qe(bt){try{var Bt=new ArrayBuffer(bt);return Bt.byteLength!=bt?void 0:(new Int8Array(Bt).set(K),Xt(Bt),ue(Bt),1)}catch{}}function Xe(bt){var Bt=Te(),ln=16777216,Ut=2147483648-ln;if(bt>Ut)return!1;for(var _=16777216,me=Math.max(Bt,_);me<bt;)me<=536870912?me=U(2*me,ln):me=Math.min(U((3*me+2147483648)/4,ln),Ut);var Yn=Qe(me);return!!Yn}var ct=typeof atob=="function"?atob:function(bt){var Bt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ln="",Ut,_,me,Yn,va,Pa,Ln,oa=0;bt=bt.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Yn=Bt.indexOf(bt.charAt(oa++)),va=Bt.indexOf(bt.charAt(oa++)),Pa=Bt.indexOf(bt.charAt(oa++)),Ln=Bt.indexOf(bt.charAt(oa++)),Ut=Yn<<2|va>>4,_=(va&15)<<4|Pa>>2,me=(Pa&3)<<6|Ln,ln=ln+String.fromCharCode(Ut),Pa!==64&&(ln=ln+String.fromCharCode(_)),Ln!==64&&(ln=ln+String.fromCharCode(me));while(oa<bt.length);return ln};function Tt(bt){try{for(var Bt=ct(bt),ln=new Uint8Array(Bt.length),Ut=0;Ut<Bt.length;++Ut)ln[Ut]=Bt.charCodeAt(Ut);return ln}catch{throw new Error("Converting base64 string to bytes failed.")}}function kt(bt){if(_e(bt))return Tt(bt.slice(Mt.length))}var vt={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Tn={b:h,c:f,d:pt,e:mt,f:Te,g:st,h:Xe,i:ht,o:tt,p:Ee},Ne=(function(bt,Bt,ln){"almost asm";var Ut=new bt.Int8Array(ln),_=new bt.Int32Array(ln);new bt.Uint8Array(ln),new bt.Float32Array(ln);var me=new bt.Float64Array(ln),Yn=Bt.o|0,va=Bt.p|0,Pa=bt.Math.floor,Ln=bt.Math.abs,oa=bt.Math.sqrt,Kr=bt.Math.pow,ka=bt.Math.cos,la=bt.Math.sin,hr=bt.Math.tan,yo=bt.Math.acos,ah=bt.Math.asin,Uo=bt.Math.atan,ts=bt.Math.atan2,qs=bt.Math.ceil,Ps=bt.Math.imul,Se=bt.Math.min,ot=bt.Math.max,St=bt.Math.clz32,Ze=Bt.b,se=Bt.c,Dt=Bt.d,gn=Bt.e,dn=Bt.f,bn=Bt.g,Mn=Bt.h,Dn=Bt.i,de=28656;function Bn(v){return Ut=new Int8Array(v),_=new Int32Array(v),me=new Float64Array(v),ln=v,!0}function ja(v){v=v|0;var y=0;return y=de,de=de+v|0,de=de+15&-16,y|0}function ki(){return de|0}function Xn(v){v=v|0,de=v}function Ya(v,y){v=v|0,de=v}function Pn(v,y){v=v|0,y=y|0;var b=0,w=0,C=0;return(v|0)<0?(y=2,y|0):(v|0)>13780509?(y=dp(15,y)|0,y|0):(b=((v|0)<0)<<31>>31,C=gs(v|0,b|0,3,0)|0,w=se()|0,b=fn(v|0,b|0,1,0)|0,b=gs(C|0,w|0,b|0,se()|0)|0,b=fn(b|0,se()|0,1,0)|0,v=se()|0,_[y>>2]=b,_[y+4>>2]=v,y=0,y|0)}function Fa(v,y,b,w){return v=v|0,y=y|0,b=b|0,w=w|0,ca(v,y,b,w,0)|0}function ca(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0,J=0;if($=de,de=de+16|0,k=$,!(Is(v,y,b,w,C)|0))return w=0,de=$,w|0;do if((b|0)>=0){if((b|0)>13780509){if(P=dp(15,k)|0,P|0)break;V=k,k=_[V>>2]|0,V=_[V+4>>2]|0}else P=((b|0)<0)<<31>>31,J=gs(b|0,P|0,3,0)|0,V=se()|0,P=fn(b|0,P|0,1,0)|0,P=gs(J|0,V|0,P|0,se()|0)|0,P=fn(P|0,se()|0,1,0)|0,V=se()|0,_[k>>2]=P,_[k+4>>2]=V,k=P;if(Vc(w|0,0,k<<3|0)|0,C|0){Vc(C|0,0,k<<2|0)|0,P=Hs(v,y,b,w,C,k,V,0)|0;break}P=Ko(k,4)|0,P?(J=Hs(v,y,b,w,P,k,V,0)|0,Un(P),P=J):P=13}else P=2;while(!1);return J=P,de=$,J|0}function Is(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0;if($e=de,de=de+16|0,De=$e,Oe=$e+8|0,ke=De,_[ke>>2]=v,_[ke+4>>2]=y,(b|0)<0)return Oe=2,de=$e,Oe|0;if(P=w,_[P>>2]=v,_[P+4>>2]=y,P=(C|0)!=0,P&&(_[C>>2]=0),yi(v,y)|0)return Oe=9,de=$e,Oe|0;_[Oe>>2]=0;e:do if((b|0)>=1)if(P)for(ae=1,J=0,xe=0,ke=1,P=v;;){if(!(J|xe)){if(P=za(P,y,4,Oe,De)|0,P|0)break e;if(y=De,P=_[y>>2]|0,y=_[y+4>>2]|0,yi(P,y)|0){P=9;break e}}if(P=za(P,y,_[26800+(xe<<2)>>2]|0,Oe,De)|0,P|0)break e;if(y=De,P=_[y>>2]|0,y=_[y+4>>2]|0,v=w+(ae<<3)|0,_[v>>2]=P,_[v+4>>2]=y,_[C+(ae<<2)>>2]=ke,v=J+1|0,k=(v|0)==(ke|0),V=xe+1|0,$=(V|0)==6,yi(P,y)|0){P=9;break e}if(ke=ke+($&k&1)|0,(ke|0)>(b|0)){P=0;break}else ae=ae+1|0,J=k?0:v,xe=k?$?0:V:xe}else for(ae=1,J=0,xe=0,ke=1,P=v;;){if(!(J|xe)){if(P=za(P,y,4,Oe,De)|0,P|0)break e;if(y=De,P=_[y>>2]|0,y=_[y+4>>2]|0,yi(P,y)|0){P=9;break e}}if(P=za(P,y,_[26800+(xe<<2)>>2]|0,Oe,De)|0,P|0)break e;if(y=De,P=_[y>>2]|0,y=_[y+4>>2]|0,v=w+(ae<<3)|0,_[v>>2]=P,_[v+4>>2]=y,v=J+1|0,k=(v|0)==(ke|0),V=xe+1|0,$=(V|0)==6,yi(P,y)|0){P=9;break e}if(ke=ke+($&k&1)|0,(ke|0)>(b|0)){P=0;break}else ae=ae+1|0,J=k?0:v,xe=k?$?0:V:xe}else P=0;while(!1);return Oe=P,de=$e,Oe|0}function Hs(v,y,b,w,C,P,k,V){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0,P=P|0,k=k|0,V=V|0;var $=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0;if($e=de,de=de+16|0,De=$e+8|0,Oe=$e,$=xp(v|0,y|0,P|0,k|0)|0,ae=se()|0,xe=w+($<<3)|0,nt=xe,At=_[nt>>2]|0,nt=_[nt+4>>2]|0,J=(At|0)==(v|0)&(nt|0)==(y|0),!((At|0)==0&(nt|0)==0|J))do $=fn($|0,ae|0,1,0)|0,$=Gm($|0,se()|0,P|0,k|0)|0,ae=se()|0,xe=w+($<<3)|0,At=xe,nt=_[At>>2]|0,At=_[At+4>>2]|0,J=(nt|0)==(v|0)&(At|0)==(y|0);while(!((nt|0)==0&(At|0)==0|J));if($=C+($<<2)|0,J&&(_[$>>2]|0)<=(V|0)||(At=xe,_[At>>2]=v,_[At+4>>2]=y,_[$>>2]=V,(V|0)>=(b|0)))return At=0,de=$e,At|0;switch(J=V+1|0,_[De>>2]=0,$=za(v,y,2,De,Oe)|0,$|0){case 9:{ke=9;break}case 0:{$=Oe,$=Hs(_[$>>2]|0,_[$+4>>2]|0,b,w,C,P,k,J)|0,$||(ke=9);break}}e:do if((ke|0)==9){switch(_[De>>2]=0,$=za(v,y,3,De,Oe)|0,$|0){case 9:break;case 0:{if($=Oe,$=Hs(_[$>>2]|0,_[$+4>>2]|0,b,w,C,P,k,J)|0,$|0)break e;break}default:break e}switch(_[De>>2]=0,$=za(v,y,1,De,Oe)|0,$|0){case 9:break;case 0:{if($=Oe,$=Hs(_[$>>2]|0,_[$+4>>2]|0,b,w,C,P,k,J)|0,$|0)break e;break}default:break e}switch(_[De>>2]=0,$=za(v,y,5,De,Oe)|0,$|0){case 9:break;case 0:{if($=Oe,$=Hs(_[$>>2]|0,_[$+4>>2]|0,b,w,C,P,k,J)|0,$|0)break e;break}default:break e}switch(_[De>>2]=0,$=za(v,y,4,De,Oe)|0,$|0){case 9:break;case 0:{if($=Oe,$=Hs(_[$>>2]|0,_[$+4>>2]|0,b,w,C,P,k,J)|0,$|0)break e;break}default:break e}switch(_[De>>2]=0,$=za(v,y,6,De,Oe)|0,$|0){case 9:break;case 0:{if($=Oe,$=Hs(_[$>>2]|0,_[$+4>>2]|0,b,w,C,P,k,J)|0,$|0)break e;break}default:break e}return At=0,de=$e,At|0}while(!1);return At=$,de=$e,At|0}function za(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0;if(b>>>0>6)return C=1,C|0;if(xe=(_[w>>2]|0)%6|0,_[w>>2]=xe,(xe|0)>0){P=0;do b=Tu(b)|0,P=P+1|0;while((P|0)<(_[w>>2]|0))}if(xe=Gt(v|0,y|0,45)|0,se()|0,ae=xe&127,ae>>>0>121)return C=5,C|0;$=qo(v,y)|0,P=Gt(v|0,y|0,52)|0,se()|0,P=P&15;e:do if(!P)J=8;else{for(;;){if(k=(15-P|0)*3|0,V=Gt(v|0,y|0,k|0)|0,se()|0,V=V&7,(V|0)==7){y=5;break}if(Oe=(Qr(P)|0)==0,P=P+-1|0,ke=Jt(7,0,k|0)|0,y=y&~(se()|0),De=Jt(_[(Oe?432:16)+(V*28|0)+(b<<2)>>2]|0,0,k|0)|0,k=se()|0,b=_[(Oe?640:224)+(V*28|0)+(b<<2)>>2]|0,v=De|v&~ke,y=k|y,!b){b=0;break e}if(!P){J=8;break e}}return y|0}while(!1);(J|0)==8&&(Oe=_[848+(ae*28|0)+(b<<2)>>2]|0,De=Jt(Oe|0,0,45)|0,v=De|v,y=se()|0|y&-1040385,b=_[4272+(ae*28|0)+(b<<2)>>2]|0,(Oe&127|0)==127&&(Oe=Jt(_[848+(ae*28|0)+20>>2]|0,0,45)|0,y=se()|0|y&-1040385,b=_[4272+(ae*28|0)+20>>2]|0,v=rp(Oe|v,y)|0,y=se()|0,_[w>>2]=(_[w>>2]|0)+1)),V=Gt(v|0,y|0,45)|0,se()|0,V=V&127;e:do if(mi(V)|0){t:do if((qo(v,y)|0)==1){if((ae|0)!=(V|0))if(Pc(V,_[7696+(ae*28|0)>>2]|0)|0){v=eb(v,y)|0,k=1,y=se()|0;break}else Dt(27795,26864,533,26872);switch($|0){case 3:{v=rp(v,y)|0,y=se()|0,_[w>>2]=(_[w>>2]|0)+1,k=0;break t}case 5:{v=eb(v,y)|0,y=se()|0,_[w>>2]=(_[w>>2]|0)+5,k=0;break t}case 0:return Oe=9,Oe|0;default:return Oe=1,Oe|0}}else k=0;while(!1);if((b|0)>0){P=0;do v=Zx(v,y)|0,y=se()|0,P=P+1|0;while((P|0)!=(b|0))}if((ae|0)!=(V|0)){if(!(ih(V)|0)){if((k|0)!=0|(qo(v,y)|0)!=5)break;_[w>>2]=(_[w>>2]|0)+1;break}switch(xe&127){case 8:case 118:break e}(qo(v,y)|0)!=3&&(_[w>>2]=(_[w>>2]|0)+1)}}else if((b|0)>0){P=0;do v=rp(v,y)|0,y=se()|0,P=P+1|0;while((P|0)!=(b|0))}while(!1);return _[w>>2]=((_[w>>2]|0)+b|0)%6|0,Oe=C,_[Oe>>2]=v,_[Oe+4>>2]=y,Oe=0,Oe|0}function Vo(v,y,b,w){return v=v|0,y=y|0,b=b|0,w=w|0,pi(v,y,b,w)|0?(Vc(w|0,0,b*48|0)|0,w=ps(v,y,b,w)|0,w|0):(w=0,w|0)}function pi(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0;if(Oe=de,de=de+16|0,ke=Oe,De=Oe+8|0,xe=ke,_[xe>>2]=v,_[xe+4>>2]=y,(b|0)<0)return De=2,de=Oe,De|0;if(!b)return De=w,_[De>>2]=v,_[De+4>>2]=y,De=0,de=Oe,De|0;_[De>>2]=0;e:do if(yi(v,y)|0)v=9;else{C=0,xe=v;do{if(v=za(xe,y,4,De,ke)|0,v|0)break e;if(y=ke,xe=_[y>>2]|0,y=_[y+4>>2]|0,C=C+1|0,yi(xe,y)|0){v=9;break e}}while((C|0)<(b|0));ae=w,_[ae>>2]=xe,_[ae+4>>2]=y,ae=b+-1|0,J=0,v=1;do{if(C=26800+(J<<2)|0,(J|0)==5)for(k=_[C>>2]|0,P=0,C=v;;){if(v=ke,v=za(_[v>>2]|0,_[v+4>>2]|0,k,De,ke)|0,v|0)break e;if((P|0)!=(ae|0))if($=ke,V=_[$>>2]|0,$=_[$+4>>2]|0,v=w+(C<<3)|0,_[v>>2]=V,_[v+4>>2]=$,!(yi(V,$)|0))v=C+1|0;else{v=9;break e}else v=C;if(P=P+1|0,(P|0)>=(b|0))break;C=v}else for(k=ke,$=_[C>>2]|0,V=0,C=v,P=_[k>>2]|0,k=_[k+4>>2]|0;;){if(v=za(P,k,$,De,ke)|0,v|0)break e;if(k=ke,P=_[k>>2]|0,k=_[k+4>>2]|0,v=w+(C<<3)|0,_[v>>2]=P,_[v+4>>2]=k,v=C+1|0,yi(P,k)|0){v=9;break e}if(V=V+1|0,(V|0)>=(b|0))break;C=v}J=J+1|0}while(J>>>0<6);v=ke,v=(xe|0)==(_[v>>2]|0)&&(y|0)==(_[v+4>>2]|0)?0:9}while(!1);return De=v,de=Oe,De|0}function ps(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0;if(xe=de,de=de+16|0,k=xe,!b)return _[w>>2]=v,_[w+4>>2]=y,w=0,de=xe,w|0;do if((b|0)>=0){if((b|0)>13780509){if(C=dp(15,k)|0,C|0)break;P=k,C=_[P>>2]|0,P=_[P+4>>2]|0}else C=((b|0)<0)<<31>>31,ae=gs(b|0,C|0,3,0)|0,P=se()|0,C=fn(b|0,C|0,1,0)|0,C=gs(ae|0,P|0,C|0,se()|0)|0,C=fn(C|0,se()|0,1,0)|0,P=se()|0,ae=k,_[ae>>2]=C,_[ae+4>>2]=P;if(J=Ko(C,8)|0,!J)C=13;else{if(ae=Ko(C,4)|0,!ae){Un(J),C=13;break}if(C=Hs(v,y,b,J,ae,C,P,0)|0,C|0){Un(J),Un(ae);break}if(y=_[k>>2]|0,k=_[k+4>>2]|0,(k|0)>0|(k|0)==0&y>>>0>0){C=0,V=0,$=0;do v=J+(V<<3)|0,P=_[v>>2]|0,v=_[v+4>>2]|0,!((P|0)==0&(v|0)==0)&&(_[ae+(V<<2)>>2]|0)==(b|0)&&(ke=w+(C<<3)|0,_[ke>>2]=P,_[ke+4>>2]=v,C=C+1|0),V=fn(V|0,$|0,1,0)|0,$=se()|0;while(($|0)<(k|0)|($|0)==(k|0)&V>>>0<y>>>0)}Un(J),Un(ae),C=0}}else C=2;while(!1);return ke=C,de=xe,ke|0}function Ci(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0;for(V=de,de=de+16|0,P=V,k=V+8|0,C=(yi(v,y)|0)==0,C=C?1:2;;){if(_[k>>2]=0,J=(za(v,y,C,k,P)|0)==0,$=P,J&((_[$>>2]|0)==(b|0)?(_[$+4>>2]|0)==(w|0):0)){v=4;break}if(C=C+1|0,C>>>0>=7){C=7,v=4;break}}return(v|0)==4?(de=V,C|0):0}function Ws(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0;if(V=de,de=de+48|0,C=V+16|0,P=V+8|0,k=V,b=$l(b)|0,b|0)return k=b,de=V,k|0;if(J=v,$=_[J+4>>2]|0,b=P,_[b>>2]=_[J>>2],_[b+4>>2]=$,vl(P,C),b=xu(C,y,k)|0,!b){if(y=_[P>>2]|0,P=_[v+8>>2]|0,(P|0)>0){C=_[v+12>>2]|0,b=0;do y=(_[C+(b<<3)>>2]|0)+y|0,b=b+1|0;while((b|0)<(P|0))}b=k,C=_[b>>2]|0,b=_[b+4>>2]|0,P=((y|0)<0)<<31>>31,(b|0)<(P|0)|(b|0)==(P|0)&C>>>0<y>>>0?(b=k,_[b>>2]=y,_[b+4>>2]=P,b=P):y=C,$=fn(y|0,b|0,12,0)|0,J=se()|0,b=k,_[b>>2]=$,_[b+4>>2]=J,b=w,_[b>>2]=$,_[b+4>>2]=J,b=0}return J=b,de=V,J|0}function Ls(v,y,b,w,C,P,k){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0,P=P|0,k=k|0;var V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0,Ke=0,en=0,wn=0,vn=0,ua=0,ea=0,wa=0,Qn=0,Cn=0,tn=0,Gn=0,Ia=0,Jn=0,vi=0,Zr=0,yd=0;if(Ia=de,de=de+64|0,Qn=Ia+48|0,Cn=Ia+32|0,tn=Ia+24|0,en=Ia+8|0,wn=Ia,$=_[v>>2]|0,($|0)<=0)return Gn=0,de=Ia,Gn|0;for(vn=v+4|0,ua=Qn+8|0,ea=Cn+8|0,wa=en+8|0,V=0,lt=0;;){J=_[vn>>2]|0,ut=J+(lt<<4)|0,_[Qn>>2]=_[ut>>2],_[Qn+4>>2]=_[ut+4>>2],_[Qn+8>>2]=_[ut+8>>2],_[Qn+12>>2]=_[ut+12>>2],(lt|0)==($+-1|0)?(_[Cn>>2]=_[J>>2],_[Cn+4>>2]=_[J+4>>2],_[Cn+8>>2]=_[J+8>>2],_[Cn+12>>2]=_[J+12>>2]):(ut=J+(lt+1<<4)|0,_[Cn>>2]=_[ut>>2],_[Cn+4>>2]=_[ut+4>>2],_[Cn+8>>2]=_[ut+8>>2],_[Cn+12>>2]=_[ut+12>>2]),$=Lc(Qn,Cn,w,tn)|0;e:do if($)J=0,V=$;else if($=tn,J=_[$>>2]|0,$=_[$+4>>2]|0,($|0)>0|($|0)==0&J>>>0>0){At=0,ut=0;t:for(;;){if(vi=1/(+(J>>>0)+4294967296*+($|0)),yd=+me[Qn>>3],$=$s(J|0,$|0,At|0,ut|0)|0,Zr=+($>>>0)+4294967296*+(se()|0),Jn=+(At>>>0)+4294967296*+(ut|0),me[en>>3]=vi*(yd*Zr)+vi*(+me[Cn>>3]*Jn),me[wa>>3]=vi*(+me[ua>>3]*Zr)+vi*(+me[ea>>3]*Jn),$=M1(en,w,wn)|0,$|0){V=$;break}nt=wn,$e=_[nt>>2]|0,nt=_[nt+4>>2]|0,ke=xp($e|0,nt|0,y|0,b|0)|0,ae=se()|0,$=k+(ke<<3)|0,xe=$,J=_[xe>>2]|0,xe=_[xe+4>>2]|0;n:do if((J|0)==0&(xe|0)==0)Ke=$,Gn=16;else for(De=0,Oe=0;;){if((De|0)>(b|0)|(De|0)==(b|0)&Oe>>>0>y>>>0){V=1;break t}if((J|0)==($e|0)&(xe|0)==(nt|0))break n;if($=fn(ke|0,ae|0,1,0)|0,ke=Gm($|0,se()|0,y|0,b|0)|0,ae=se()|0,Oe=fn(Oe|0,De|0,1,0)|0,De=se()|0,$=k+(ke<<3)|0,xe=$,J=_[xe>>2]|0,xe=_[xe+4>>2]|0,(J|0)==0&(xe|0)==0){Ke=$,Gn=16;break}}while(!1);if((Gn|0)==16&&(Gn=0,!(($e|0)==0&(nt|0)==0))&&(Oe=Ke,_[Oe>>2]=$e,_[Oe+4>>2]=nt,Oe=P+(_[C>>2]<<3)|0,_[Oe>>2]=$e,_[Oe+4>>2]=nt,Oe=C,Oe=fn(_[Oe>>2]|0,_[Oe+4>>2]|0,1,0)|0,$e=se()|0,nt=C,_[nt>>2]=Oe,_[nt+4>>2]=$e),At=fn(At|0,ut|0,1,0)|0,ut=se()|0,$=tn,J=_[$>>2]|0,$=_[$+4>>2]|0,!(($|0)>(ut|0)|($|0)==(ut|0)&J>>>0>At>>>0)){J=1;break e}}J=0}else J=1;while(!1);if(lt=lt+1|0,!J){Gn=21;break}if($=_[v>>2]|0,(lt|0)>=($|0)){V=0,Gn=21;break}}return(Gn|0)==21?(de=Ia,V|0):0}function id(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0,Ke=0,en=0,wn=0,vn=0,ua=0,ea=0,wa=0,Qn=0,Cn=0,tn=0,Gn=0,Ia=0,Jn=0,vi=0,Zr=0;if(Zr=de,de=de+112|0,Gn=Zr+80|0,$=Zr+72|0,Ia=Zr,Jn=Zr+56|0,C=$l(b)|0,C|0)return vi=C,de=Zr,vi|0;if(J=v+8|0,vi=Nu((_[J>>2]<<5)+32|0)|0,!vi)return vi=13,de=Zr,vi|0;if(Kl(v,vi),C=$l(b)|0,!C){if(Cn=v,tn=_[Cn+4>>2]|0,C=$,_[C>>2]=_[Cn>>2],_[C+4>>2]=tn,vl($,Gn),C=xu(Gn,y,Ia)|0,C)Cn=0,tn=0;else{if(C=_[$>>2]|0,P=_[J>>2]|0,(P|0)>0){k=_[v+12>>2]|0,b=0;do C=(_[k+(b<<3)>>2]|0)+C|0,b=b+1|0;while((b|0)!=(P|0));b=C}else b=C;C=Ia,P=_[C>>2]|0,C=_[C+4>>2]|0,k=((b|0)<0)<<31>>31,(C|0)<(k|0)|(C|0)==(k|0)&P>>>0<b>>>0?(C=Ia,_[C>>2]=b,_[C+4>>2]=k,C=k):b=P,Cn=fn(b|0,C|0,12,0)|0,tn=se()|0,C=Ia,_[C>>2]=Cn,_[C+4>>2]=tn,C=0}if(!C){if(b=Ko(Cn,8)|0,!b)return Un(vi),vi=13,de=Zr,vi|0;if(V=Ko(Cn,8)|0,!V)return Un(vi),Un(b),vi=13,de=Zr,vi|0;wa=Gn,_[wa>>2]=0,_[wa+4>>2]=0,wa=v,Qn=_[wa+4>>2]|0,C=$,_[C>>2]=_[wa>>2],_[C+4>>2]=Qn,C=Ls($,Cn,tn,y,Gn,b,V)|0;e:do if(C)Un(b),Un(V),Un(vi);else{t:do if((_[J>>2]|0)>0){for(k=v+12|0,P=0;C=Ls((_[k>>2]|0)+(P<<3)|0,Cn,tn,y,Gn,b,V)|0,P=P+1|0,!(C|0);)if((P|0)>=(_[J>>2]|0))break t;Un(b),Un(V),Un(vi);break e}while(!1);(tn|0)>0|(tn|0)==0&Cn>>>0>0&&Vc(V|0,0,Cn<<3|0)|0,Qn=Gn,wa=_[Qn+4>>2]|0;t:do if((wa|0)>0|(wa|0)==0&(_[Qn>>2]|0)>>>0>0){vn=b,ua=V,ea=b,wa=V,Qn=b,C=b,Ke=b,en=V,wn=V,b=V;n:for(;;){for(nt=0,At=0,ut=0,lt=0,P=0,k=0;;){V=Ia,$=V+56|0;do _[V>>2]=0,V=V+4|0;while((V|0)<($|0));if(y=vn+(nt<<3)|0,J=_[y>>2]|0,y=_[y+4>>2]|0,Is(J,y,1,Ia,0)|0){V=Ia,$=V+56|0;do _[V>>2]=0,V=V+4|0;while((V|0)<($|0));V=Ko(7,4)|0,V|0&&(Hs(J,y,1,Ia,V,7,0,0)|0,Un(V))}for($e=0;;){Oe=Ia+($e<<3)|0,De=_[Oe>>2]|0,Oe=_[Oe+4>>2]|0;a:do if((De|0)==0&(Oe|0)==0)V=P,$=k;else{if(ae=xp(De|0,Oe|0,Cn|0,tn|0)|0,J=se()|0,V=w+(ae<<3)|0,y=V,$=_[y>>2]|0,y=_[y+4>>2]|0,!(($|0)==0&(y|0)==0)){xe=0,ke=0;do{if((xe|0)>(tn|0)|(xe|0)==(tn|0)&ke>>>0>Cn>>>0)break n;if(($|0)==(De|0)&(y|0)==(Oe|0)){V=P,$=k;break a}V=fn(ae|0,J|0,1,0)|0,ae=Gm(V|0,se()|0,Cn|0,tn|0)|0,J=se()|0,ke=fn(ke|0,xe|0,1,0)|0,xe=se()|0,V=w+(ae<<3)|0,y=V,$=_[y>>2]|0,y=_[y+4>>2]|0}while(!(($|0)==0&(y|0)==0))}if((De|0)==0&(Oe|0)==0){V=P,$=k;break}hh(De,Oe,Jn)|0,Yl(v,vi,Jn)|0&&(ke=fn(P|0,k|0,1,0)|0,k=se()|0,xe=V,_[xe>>2]=De,_[xe+4>>2]=Oe,P=ua+(P<<3)|0,_[P>>2]=De,_[P+4>>2]=Oe,P=ke),V=P,$=k}while(!1);if($e=$e+1|0,$e>>>0>=7)break;P=V,k=$}if(nt=fn(nt|0,At|0,1,0)|0,At=se()|0,ut=fn(ut|0,lt|0,1,0)|0,lt=se()|0,k=Gn,P=_[k>>2]|0,k=_[k+4>>2]|0,(lt|0)<(k|0)|(lt|0)==(k|0)&ut>>>0<P>>>0)P=V,k=$;else break}if((k|0)>0|(k|0)==0&P>>>0>0){P=0,k=0;do lt=vn+(P<<3)|0,_[lt>>2]=0,_[lt+4>>2]=0,P=fn(P|0,k|0,1,0)|0,k=se()|0,lt=Gn,ut=_[lt+4>>2]|0;while((k|0)<(ut|0)|((k|0)==(ut|0)?P>>>0<(_[lt>>2]|0)>>>0:0))}if(lt=Gn,_[lt>>2]=V,_[lt+4>>2]=$,($|0)>0|($|0)==0&V>>>0>0)$e=b,nt=wn,At=Qn,ut=en,lt=ua,b=Ke,wn=C,en=ea,Ke=$e,C=nt,Qn=wa,wa=At,ea=ut,ua=vn,vn=lt;else break t}Un(ea),Un(wa),Un(vi),C=1;break e}else C=V;while(!1);Un(vi),Un(b),Un(C),C=0}while(!1);return vi=C,de=Zr,vi|0}}return Un(vi),vi=C,de=Zr,vi|0}function zo(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0;if(ae=de,de=de+176|0,$=ae,(y|0)<1)return Cu(b,0,0),J=0,de=ae,J|0;for(V=v,V=Gt(_[V>>2]|0,_[V+4>>2]|0,52)|0,se()|0,Cu(b,(y|0)>6?y:6,V&15),V=0;w=v+(V<<3)|0,w=fh(_[w>>2]|0,_[w+4>>2]|0,$)|0,!(w|0);){if(w=_[$>>2]|0,(w|0)>0){k=0;do P=$+8+(k<<4)|0,k=k+1|0,w=$+8+(((k|0)%(w|0)|0)<<4)|0,C=vp(b,w,P)|0,C?yp(b,C)|0:j1(b,P,w)|0,w=_[$>>2]|0;while((k|0)<(w|0))}if(V=V+1|0,(V|0)>=(y|0)){w=0,J=13;break}}return(J|0)==13?(de=ae,w|0):(O1(b),J=w,de=ae,J|0)}function _1(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0;if(P=de,de=de+32|0,w=P,C=P+16|0,v=zo(v,y,C)|0,v|0)return b=v,de=P,b|0;if(_[b>>2]=0,_[b+4>>2]=0,_[b+8>>2]=0,v=F1(C)|0,v|0)do{y=Iw(b)|0;do P1(y,v)|0,k=v+16|0,_[w>>2]=_[k>>2],_[w+4>>2]=_[k+4>>2],_[w+8>>2]=_[k+8>>2],_[w+12>>2]=_[k+12>>2],yp(C,v)|0,v=Dr(C,w)|0;while((v|0)!=0);v=F1(C)|0}while((v|0)!=0);return O1(C),v=SI(b)|0,v?(fp(b),k=v,de=P,k|0):(k=0,de=P,k|0)}function mi(v){return v=v|0,v>>>0>121?(v=0,v|0):(v=_[7696+(v*28|0)+16>>2]|0,v|0)}function ih(v){return v=v|0,(v|0)==4|(v|0)==117|0}function Vl(v){return v=v|0,_[11120+((_[v>>2]|0)*216|0)+((_[v+4>>2]|0)*72|0)+((_[v+8>>2]|0)*24|0)+(_[v+12>>2]<<3)>>2]|0}function B0(v){return v=v|0,_[11120+((_[v>>2]|0)*216|0)+((_[v+4>>2]|0)*72|0)+((_[v+8>>2]|0)*24|0)+(_[v+12>>2]<<3)+4>>2]|0}function zl(v,y){v=v|0,y=y|0,v=7696+(v*28|0)|0,_[y>>2]=_[v>>2],_[y+4>>2]=_[v+4>>2],_[y+8>>2]=_[v+8>>2],_[y+12>>2]=_[v+12>>2]}function sh(v,y){v=v|0,y=y|0;var b=0,w=0;if(y>>>0>20)return y=-1,y|0;do if((_[11120+(y*216|0)>>2]|0)!=(v|0))if((_[11120+(y*216|0)+8>>2]|0)!=(v|0))if((_[11120+(y*216|0)+16>>2]|0)!=(v|0))if((_[11120+(y*216|0)+24>>2]|0)!=(v|0))if((_[11120+(y*216|0)+32>>2]|0)!=(v|0))if((_[11120+(y*216|0)+40>>2]|0)!=(v|0))if((_[11120+(y*216|0)+48>>2]|0)!=(v|0))if((_[11120+(y*216|0)+56>>2]|0)!=(v|0))if((_[11120+(y*216|0)+64>>2]|0)!=(v|0))if((_[11120+(y*216|0)+72>>2]|0)!=(v|0))if((_[11120+(y*216|0)+80>>2]|0)!=(v|0))if((_[11120+(y*216|0)+88>>2]|0)!=(v|0))if((_[11120+(y*216|0)+96>>2]|0)!=(v|0))if((_[11120+(y*216|0)+104>>2]|0)!=(v|0))if((_[11120+(y*216|0)+112>>2]|0)!=(v|0))if((_[11120+(y*216|0)+120>>2]|0)!=(v|0))if((_[11120+(y*216|0)+128>>2]|0)!=(v|0))if((_[11120+(y*216|0)+136>>2]|0)==(v|0))v=2,b=1,w=2;else{if((_[11120+(y*216|0)+144>>2]|0)==(v|0)){v=0,b=2,w=0;break}if((_[11120+(y*216|0)+152>>2]|0)==(v|0)){v=0,b=2,w=1;break}if((_[11120+(y*216|0)+160>>2]|0)==(v|0)){v=0,b=2,w=2;break}if((_[11120+(y*216|0)+168>>2]|0)==(v|0)){v=1,b=2,w=0;break}if((_[11120+(y*216|0)+176>>2]|0)==(v|0)){v=1,b=2,w=1;break}if((_[11120+(y*216|0)+184>>2]|0)==(v|0)){v=1,b=2,w=2;break}if((_[11120+(y*216|0)+192>>2]|0)==(v|0)){v=2,b=2,w=0;break}if((_[11120+(y*216|0)+200>>2]|0)==(v|0)){v=2,b=2,w=1;break}if((_[11120+(y*216|0)+208>>2]|0)==(v|0)){v=2,b=2,w=2;break}else v=-1;return v|0}else v=2,b=1,w=1;else v=2,b=1,w=0;else v=1,b=1,w=2;else v=1,b=1,w=1;else v=1,b=1,w=0;else v=0,b=1,w=2;else v=0,b=1,w=1;else v=0,b=1,w=0;else v=2,b=0,w=2;else v=2,b=0,w=1;else v=2,b=0,w=0;else v=1,b=0,w=2;else v=1,b=0,w=1;else v=1,b=0,w=0;else v=0,b=0,w=2;else v=0,b=0,w=1;else v=0,b=0,w=0;while(!1);return y=_[11120+(y*216|0)+(b*72|0)+(v*24|0)+(w<<3)+4>>2]|0,y|0}function Pc(v,y){return v=v|0,y=y|0,(_[7696+(v*28|0)+20>>2]|0)==(y|0)?(y=1,y|0):(y=(_[7696+(v*28|0)+24>>2]|0)==(y|0),y|0)}function sd(v,y){return v=v|0,y=y|0,_[848+(v*28|0)+(y<<2)>>2]|0}function rh(v,y){return v=v|0,y=y|0,(_[848+(v*28|0)>>2]|0)==(y|0)?(y=0,y|0):(_[848+(v*28|0)+4>>2]|0)==(y|0)?(y=1,y|0):(_[848+(v*28|0)+8>>2]|0)==(y|0)?(y=2,y|0):(_[848+(v*28|0)+12>>2]|0)==(y|0)?(y=3,y|0):(_[848+(v*28|0)+16>>2]|0)==(y|0)?(y=4,y|0):(_[848+(v*28|0)+20>>2]|0)==(y|0)?(y=5,y|0):((_[848+(v*28|0)+24>>2]|0)==(y|0)?6:7)|0}function oh(){return 122}function Ic(v){v=v|0;var y=0,b=0,w=0;y=0;do Jt(y|0,0,45)|0,w=se()|0|134225919,b=v+(y<<3)|0,_[b>>2]=-1,_[b+4>>2]=w,y=y+1|0;while((y|0)!=122);return 0}function Gl(v){v=v|0;var y=0,b=0,w=0;return w=+me[v+16>>3],b=+me[v+24>>3],y=w-b,+(w<b?y+6.283185307179586:y)}function lh(v){return v=v|0,+me[v+16>>3]<+me[v+24>>3]|0}function Oi(v){return v=v|0,+(+me[v>>3]-+me[v+8>>3])}function ql(v,y){v=v|0,y=y|0;var b=0,w=0,C=0;return b=+me[y>>3],!(b>=+me[v+8>>3])||!(b<=+me[v>>3])?(y=0,y|0):(w=+me[v+16>>3],b=+me[v+24>>3],C=+me[y+8>>3],y=C>=b,v=C<=w&1,w<b?y&&(v=1):y||(v=0),y=(v|0)!=0,y|0)}function Jf(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0;return+me[v>>3]<+me[y+8>>3]||+me[v+8>>3]>+me[y>>3]?(w=0,w|0):(P=+me[v+16>>3],b=v+24|0,ae=+me[b>>3],k=P<ae,w=y+16|0,J=+me[w>>3],C=y+24|0,$=+me[C>>3],V=J<$,y=ae-J<$-P,v=k?V|y?1:2:0,y=V?k?1:y?2:1:0,P=+Ho(P,v),P<+Ho(+me[C>>3],y)||(ae=+Ho(+me[b>>3],v),ae>+Ho(+me[w>>3],y))?(V=0,V|0):(V=1,V|0))}function Zf(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0;P=+me[v+16>>3],$=+me[v+24>>3],v=P<$,V=+me[y+16>>3],k=+me[y+24>>3],C=V<k,y=$-V<k-P,_[b>>2]=v?C|y?1:2:0,_[w>>2]=C?v?1:y?2:1:0}function Om(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0;return+me[v>>3]<+me[y>>3]||+me[v+8>>3]>+me[y+8>>3]?(w=0,w|0):(w=v+16|0,$=+me[w>>3],P=+me[v+24>>3],k=$<P,b=y+16|0,ae=+me[b>>3],C=y+24|0,J=+me[C>>3],V=ae<J,y=P-ae<J-$,v=k?V|y?1:2:0,y=V?k?1:y?2:1:0,P=+Ho(P,v),P<=+Ho(+me[C>>3],y)?(ae=+Ho(+me[w>>3],v),V=ae>=+Ho(+me[b>>3],y),V|0):(V=0,V|0))}function ch(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0;C=de,de=de+176|0,w=C,_[w>>2]=4,V=+me[y>>3],me[w+8>>3]=V,P=+me[y+16>>3],me[w+16>>3]=P,me[w+24>>3]=V,V=+me[y+24>>3],me[w+32>>3]=V,k=+me[y+8>>3],me[w+40>>3]=k,me[w+48>>3]=V,me[w+56>>3]=k,me[w+64>>3]=P,y=w+72|0,b=y+96|0;do _[y>>2]=0,y=y+4|0;while((y|0)<(b|0));Ah(v|0,w|0,168)|0,de=C}function xu(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0;Oe=de,de=de+288|0,ae=Oe+264|0,xe=Oe+96|0,J=Oe,V=J,$=V+96|0;do _[V>>2]=0,V=V+4|0;while((V|0)<($|0));return y=cp(y,J)|0,y|0?(De=y,de=Oe,De|0):($=J,J=_[$>>2]|0,$=_[$+4>>2]|0,hh(J,$,ae)|0,fh(J,$,xe)|0,k=+Um(ae,xe+8|0),me[ae>>3]=+me[v>>3],$=ae+8|0,me[$>>3]=+me[v+16>>3],me[xe>>3]=+me[v+8>>3],J=xe+8|0,me[J>>3]=+me[v+24>>3],C=+Um(ae,xe),nt=+me[$>>3]-+me[J>>3],P=+Ln(+nt),$e=+me[ae>>3]-+me[xe>>3],w=+Ln(+$e),!(nt==0|$e==0)&&(nt=+X0(+P,+w),nt=+qs(+(C*C/+Q0(+(nt/+Q0(+P,+w)),3)/(k*(k*2.59807621135)*.8))),me[Yn>>3]=nt,ke=~~nt>>>0,De=+Ln(nt)>=1?nt>0?~~+Se(+Pa(nt/4294967296),4294967295)>>>0:~~+qs((nt-+(~~nt>>>0))/4294967296)>>>0:0,(_[Yn+4>>2]&2146435072|0)!=2146435072)?(xe=(ke|0)==0&(De|0)==0,y=b,_[y>>2]=xe?1:ke,_[y+4>>2]=xe?0:De,y=0):y=1,De=y,de=Oe,De|0)}function Lc(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0;J=de,de=de+288|0,k=J+264|0,V=J+96|0,$=J,C=$,P=C+96|0;do _[C>>2]=0,C=C+4|0;while((C|0)<(P|0));return b=cp(b,$)|0,b|0?(w=b,de=J,w|0):(b=$,C=_[b>>2]|0,b=_[b+4>>2]|0,hh(C,b,k)|0,fh(C,b,V)|0,ae=+Um(k,V+8|0),ae=+qs(+(+Um(v,y)/(ae*2))),me[Yn>>3]=ae,b=~~ae>>>0,C=+Ln(ae)>=1?ae>0?~~+Se(+Pa(ae/4294967296),4294967295)>>>0:~~+qs((ae-+(~~ae>>>0))/4294967296)>>>0:0,(_[Yn+4>>2]&2146435072|0)==2146435072?(w=1,de=J,w|0):($=(b|0)==0&(C|0)==0,_[w>>2]=$?1:b,_[w+4>>2]=$?0:C,w=0,de=J,w|0))}function Pr(v,y){v=v|0,y=+y;var b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0;P=v+16|0,k=+me[P>>3],b=v+24|0,C=+me[b>>3],w=k-C,w=k<C?w+6.283185307179586:w,J=+me[v>>3],V=v+8|0,$=+me[V>>3],ae=J-$,w=(w*y-w)*.5,y=(ae*y-ae)*.5,J=J+y,me[v>>3]=J>1.5707963267948966?1.5707963267948966:J,y=$-y,me[V>>3]=y<-1.5707963267948966?-1.5707963267948966:y,y=k+w,y=y>3.141592653589793?y+-6.283185307179586:y,me[P>>3]=y<-3.141592653589793?y+6.283185307179586:y,y=C-w,y=y>3.141592653589793?y+-6.283185307179586:y,me[b>>3]=y<-3.141592653589793?y+6.283185307179586:y}function rd(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0,_[v>>2]=y,_[v+4>>2]=b,_[v+8>>2]=w}function bu(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0;xe=y+8|0,_[xe>>2]=0,$=+me[v>>3],k=+Ln(+$),J=+me[v+8>>3],V=+Ln(+J)*1.1547005383792515,k=k+V*.5,b=~~k,v=~~V,k=k-+(b|0),V=V-+(v|0);do if(k<.5)if(k<.3333333333333333)if(_[y>>2]=b,V<(k+1)*.5){_[y+4>>2]=v;break}else{v=v+1|0,_[y+4>>2]=v;break}else if(ke=1-k,v=(!(V<ke)&1)+v|0,_[y+4>>2]=v,ke<=V&V<k*2){b=b+1|0,_[y>>2]=b;break}else{_[y>>2]=b;break}else{if(!(k<.6666666666666666))if(b=b+1|0,_[y>>2]=b,V<k*.5){_[y+4>>2]=v;break}else{v=v+1|0,_[y+4>>2]=v;break}if(V<1-k){if(_[y+4>>2]=v,k*2+-1<V){_[y>>2]=b;break}}else v=v+1|0,_[y+4>>2]=v;b=b+1|0,_[y>>2]=b}while(!1);do if($<0)if(v&1){ae=(v+1|0)/2|0,ae=$s(b|0,((b|0)<0)<<31>>31|0,ae|0,((ae|0)<0)<<31>>31|0)|0,b=~~(+(b|0)-((+(ae>>>0)+4294967296*+(se()|0))*2+1)),_[y>>2]=b;break}else{ae=(v|0)/2|0,ae=$s(b|0,((b|0)<0)<<31>>31|0,ae|0,((ae|0)<0)<<31>>31|0)|0,b=~~(+(b|0)-(+(ae>>>0)+4294967296*+(se()|0))*2),_[y>>2]=b;break}while(!1);ae=y+4|0,J<0&&(b=b-((v<<1|1|0)/2|0)|0,_[y>>2]=b,v=0-v|0,_[ae>>2]=v),w=v-b|0,(b|0)<0?(C=0-b|0,_[ae>>2]=w,_[xe>>2]=C,_[y>>2]=0,v=w,b=0):C=0,(v|0)<0&&(b=b-v|0,_[y>>2]=b,C=C-v|0,_[xe>>2]=C,_[ae>>2]=0,v=0),P=b-C|0,w=v-C|0,(C|0)<0&&(_[y>>2]=P,_[ae>>2]=w,_[xe>>2]=0,v=w,b=P,C=0),w=(v|0)<(b|0)?v:b,w=(C|0)<(w|0)?C:w,!((w|0)<=0)&&(_[y>>2]=b-w,_[ae>>2]=v-w,_[xe>>2]=C-w)}function ms(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0;y=_[v>>2]|0,k=v+4|0,b=_[k>>2]|0,(y|0)<0&&(b=b-y|0,_[k>>2]=b,P=v+8|0,_[P>>2]=(_[P>>2]|0)-y,_[v>>2]=0,y=0),(b|0)<0?(y=y-b|0,_[v>>2]=y,P=v+8|0,C=(_[P>>2]|0)-b|0,_[P>>2]=C,_[k>>2]=0,b=0):(C=v+8|0,P=C,C=_[C>>2]|0),(C|0)<0&&(y=y-C|0,_[v>>2]=y,b=b-C|0,_[k>>2]=b,_[P>>2]=0,C=0),w=(b|0)<(y|0)?b:y,w=(C|0)<(w|0)?C:w,!((w|0)<=0)&&(_[v>>2]=y-w,_[k>>2]=b-w,_[P>>2]=C-w)}function Dc(v,y){v=v|0,y=y|0;var b=0,w=0;w=_[v+8>>2]|0,b=+((_[v+4>>2]|0)-w|0),me[y>>3]=+((_[v>>2]|0)-w|0)-b*.5,me[y+8>>3]=b*.8660254037844386}function bs(v,y,b){v=v|0,y=y|0,b=b|0,_[b>>2]=(_[y>>2]|0)+(_[v>>2]|0),_[b+4>>2]=(_[y+4>>2]|0)+(_[v+4>>2]|0),_[b+8>>2]=(_[y+8>>2]|0)+(_[v+8>>2]|0)}function uh(v,y,b){v=v|0,y=y|0,b=b|0,_[b>>2]=(_[v>>2]|0)-(_[y>>2]|0),_[b+4>>2]=(_[v+4>>2]|0)-(_[y+4>>2]|0),_[b+8>>2]=(_[v+8>>2]|0)-(_[y+8>>2]|0)}function kc(v,y){v=v|0,y=y|0;var b=0,w=0;b=Ps(_[v>>2]|0,y)|0,_[v>>2]=b,b=v+4|0,w=Ps(_[b>>2]|0,y)|0,_[b>>2]=w,v=v+8|0,y=Ps(_[v>>2]|0,y)|0,_[v>>2]=y}function od(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0;k=_[v>>2]|0,V=(k|0)<0,w=(_[v+4>>2]|0)-(V?k:0)|0,P=(w|0)<0,C=(P?0-w|0:0)+((_[v+8>>2]|0)-(V?k:0))|0,b=(C|0)<0,v=b?0:C,y=(P?0:w)-(b?C:0)|0,C=(V?0:k)-(P?w:0)-(b?C:0)|0,b=(y|0)<(C|0)?y:C,b=(v|0)<(b|0)?v:b,w=(b|0)>0,v=v-(w?b:0)|0,y=y-(w?b:0)|0;e:do switch(C-(w?b:0)|0){case 0:switch(y|0){case 0:return V=(v|0)==0?0:(v|0)==1?1:7,V|0;case 1:return V=(v|0)==0?2:(v|0)==1?3:7,V|0;default:break e}case 1:switch(y|0){case 0:return V=(v|0)==0?4:(v|0)==1?5:7,V|0;case 1:{if(!v)v=6;else break e;return v|0}default:break e}}while(!1);return V=7,V|0}function U0(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0;if($=v+8|0,k=_[$>>2]|0,V=(_[v>>2]|0)-k|0,J=v+4|0,k=(_[J>>2]|0)-k|0,V>>>0>715827881|k>>>0>715827881){if(w=(V|0)>0,C=2147483647-V|0,P=-2147483648-V|0,(w?(C|0)<(V|0):(P|0)>(V|0))||(b=V<<1,w?(2147483647-b|0)<(V|0):(-2147483648-b|0)>(V|0))||((k|0)>0?(2147483647-k|0)<(k|0):(-2147483648-k|0)>(k|0))||(y=V*3|0,b=k<<1,(w?(C|0)<(b|0):(P|0)>(b|0))||((V|0)>-1?(y|-2147483648|0)>=(k|0):(y^-2147483648|0)<(k|0))))return J=1,J|0}else b=k<<1,y=V*3|0;return w=md(+(y-k|0)*.14285714285714285)|0,_[v>>2]=w,C=md(+(b+V|0)*.14285714285714285)|0,_[J>>2]=C,_[$>>2]=0,b=(C|0)<(w|0),y=b?w:C,b=b?C:w,(b|0)<0&&(((b|0)==-2147483648||((y|0)>0?(2147483647-y|0)<(b|0):(-2147483648-y|0)>(b|0)))&&Dt(27795,26892,354,26903),((y|0)>-1?(y|-2147483648|0)>=(b|0):(y^-2147483648|0)<(b|0))&&Dt(27795,26892,354,26903)),y=C-w|0,(w|0)<0?(b=0-w|0,_[J>>2]=y,_[$>>2]=b,_[v>>2]=0,w=0):(y=C,b=0),(y|0)<0&&(w=w-y|0,_[v>>2]=w,b=b-y|0,_[$>>2]=b,_[J>>2]=0,y=0),P=w-b|0,C=y-b|0,(b|0)<0?(_[v>>2]=P,_[J>>2]=C,_[$>>2]=0,y=C,C=P,b=0):C=w,w=(y|0)<(C|0)?y:C,w=(b|0)<(w|0)?b:w,(w|0)<=0?(J=0,J|0):(_[v>>2]=C-w,_[J>>2]=y-w,_[$>>2]=b-w,J=0,J|0)}function ep(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0,$=0;if(k=v+8|0,C=_[k>>2]|0,P=(_[v>>2]|0)-C|0,V=v+4|0,C=(_[V>>2]|0)-C|0,P>>>0>715827881|C>>>0>715827881){if(b=(P|0)>0,(b?(2147483647-P|0)<(P|0):(-2147483648-P|0)>(P|0))||(y=P<<1,w=(C|0)>0,w?(2147483647-C|0)<(C|0):(-2147483648-C|0)>(C|0)))return V=1,V|0;if($=C<<1,(w?(2147483647-$|0)<(C|0):(-2147483648-$|0)>(C|0))||(b?(2147483647-y|0)<(C|0):(-2147483648-y|0)>(C|0))||(b=C*3|0,(C|0)>-1?(b|-2147483648|0)>=(P|0):(b^-2147483648|0)<(P|0)))return $=1,$|0}else b=C*3|0,y=P<<1;return w=md(+(y+C|0)*.14285714285714285)|0,_[v>>2]=w,C=md(+(b-P|0)*.14285714285714285)|0,_[V>>2]=C,_[k>>2]=0,b=(C|0)<(w|0),y=b?w:C,b=b?C:w,(b|0)<0&&(((b|0)==-2147483648||((y|0)>0?(2147483647-y|0)<(b|0):(-2147483648-y|0)>(b|0)))&&Dt(27795,26892,402,26917),((y|0)>-1?(y|-2147483648|0)>=(b|0):(y^-2147483648|0)<(b|0))&&Dt(27795,26892,402,26917)),y=C-w|0,(w|0)<0?(b=0-w|0,_[V>>2]=y,_[k>>2]=b,_[v>>2]=0,w=0):(y=C,b=0),(y|0)<0&&(w=w-y|0,_[v>>2]=w,b=b-y|0,_[k>>2]=b,_[V>>2]=0,y=0),P=w-b|0,C=y-b|0,(b|0)<0?(_[v>>2]=P,_[V>>2]=C,_[k>>2]=0,y=C,C=P,b=0):C=w,w=(y|0)<(C|0)?y:C,w=(b|0)<(w|0)?b:w,(w|0)<=0?($=0,$|0):(_[v>>2]=C-w,_[V>>2]=y-w,_[k>>2]=b-w,$=0,$|0)}function x1(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0;k=v+8|0,b=_[k>>2]|0,y=(_[v>>2]|0)-b|0,V=v+4|0,b=(_[V>>2]|0)-b|0,w=md(+((y*3|0)-b|0)*.14285714285714285)|0,_[v>>2]=w,y=md(+((b<<1)+y|0)*.14285714285714285)|0,_[V>>2]=y,_[k>>2]=0,b=y-w|0,(w|0)<0?(P=0-w|0,_[V>>2]=b,_[k>>2]=P,_[v>>2]=0,y=b,w=0,b=P):b=0,(y|0)<0&&(w=w-y|0,_[v>>2]=w,b=b-y|0,_[k>>2]=b,_[V>>2]=0,y=0),P=w-b|0,C=y-b|0,(b|0)<0?(_[v>>2]=P,_[V>>2]=C,_[k>>2]=0,y=C,C=P,b=0):C=w,w=(y|0)<(C|0)?y:C,w=(b|0)<(w|0)?b:w,!((w|0)<=0)&&(_[v>>2]=C-w,_[V>>2]=y-w,_[k>>2]=b-w)}function V0(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0;k=v+8|0,b=_[k>>2]|0,y=(_[v>>2]|0)-b|0,V=v+4|0,b=(_[V>>2]|0)-b|0,w=md(+((y<<1)+b|0)*.14285714285714285)|0,_[v>>2]=w,y=md(+((b*3|0)-y|0)*.14285714285714285)|0,_[V>>2]=y,_[k>>2]=0,b=y-w|0,(w|0)<0?(P=0-w|0,_[V>>2]=b,_[k>>2]=P,_[v>>2]=0,y=b,w=0,b=P):b=0,(y|0)<0&&(w=w-y|0,_[v>>2]=w,b=b-y|0,_[k>>2]=b,_[V>>2]=0,y=0),P=w-b|0,C=y-b|0,(b|0)<0?(_[v>>2]=P,_[V>>2]=C,_[k>>2]=0,y=C,C=P,b=0):C=w,w=(y|0)<(C|0)?y:C,w=(b|0)<(w|0)?b:w,!((w|0)<=0)&&(_[v>>2]=C-w,_[V>>2]=y-w,_[k>>2]=b-w)}function Su(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0;y=_[v>>2]|0,k=v+4|0,b=_[k>>2]|0,V=v+8|0,w=_[V>>2]|0,C=b+(y*3|0)|0,_[v>>2]=C,b=w+(b*3|0)|0,_[k>>2]=b,y=(w*3|0)+y|0,_[V>>2]=y,w=b-C|0,(C|0)<0?(y=y-C|0,_[k>>2]=w,_[V>>2]=y,_[v>>2]=0,b=w,w=0):w=C,(b|0)<0&&(w=w-b|0,_[v>>2]=w,y=y-b|0,_[V>>2]=y,_[k>>2]=0,b=0),P=w-y|0,C=b-y|0,(y|0)<0?(_[v>>2]=P,_[k>>2]=C,_[V>>2]=0,w=P,y=0):C=b,b=(C|0)<(w|0)?C:w,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(_[v>>2]=w-b,_[k>>2]=C-b,_[V>>2]=y-b)}function Oc(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0;C=_[v>>2]|0,k=v+4|0,y=_[k>>2]|0,V=v+8|0,b=_[V>>2]|0,w=(y*3|0)+C|0,C=b+(C*3|0)|0,_[v>>2]=C,_[k>>2]=w,y=(b*3|0)+y|0,_[V>>2]=y,b=w-C|0,(C|0)<0?(y=y-C|0,_[k>>2]=b,_[V>>2]=y,_[v>>2]=0,C=0):b=w,(b|0)<0&&(C=C-b|0,_[v>>2]=C,y=y-b|0,_[V>>2]=y,_[k>>2]=0,b=0),P=C-y|0,w=b-y|0,(y|0)<0?(_[v>>2]=P,_[k>>2]=w,_[V>>2]=0,C=P,y=0):w=b,b=(w|0)<(C|0)?w:C,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(_[v>>2]=C-b,_[k>>2]=w-b,_[V>>2]=y-b)}function z0(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0;(y+-1|0)>>>0>=6||(C=(_[15440+(y*12|0)>>2]|0)+(_[v>>2]|0)|0,_[v>>2]=C,V=v+4|0,w=(_[15440+(y*12|0)+4>>2]|0)+(_[V>>2]|0)|0,_[V>>2]=w,k=v+8|0,y=(_[15440+(y*12|0)+8>>2]|0)+(_[k>>2]|0)|0,_[k>>2]=y,b=w-C|0,(C|0)<0?(y=y-C|0,_[V>>2]=b,_[k>>2]=y,_[v>>2]=0,w=0):(b=w,w=C),(b|0)<0&&(w=w-b|0,_[v>>2]=w,y=y-b|0,_[k>>2]=y,_[V>>2]=0,b=0),P=w-y|0,C=b-y|0,(y|0)<0?(_[v>>2]=P,_[V>>2]=C,_[k>>2]=0,w=P,y=0):C=b,b=(C|0)<(w|0)?C:w,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(_[v>>2]=w-b,_[V>>2]=C-b,_[k>>2]=y-b))}function tp(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0;C=_[v>>2]|0,k=v+4|0,y=_[k>>2]|0,V=v+8|0,b=_[V>>2]|0,w=y+C|0,C=b+C|0,_[v>>2]=C,_[k>>2]=w,y=b+y|0,_[V>>2]=y,b=w-C|0,(C|0)<0?(y=y-C|0,_[k>>2]=b,_[V>>2]=y,_[v>>2]=0,w=0):(b=w,w=C),(b|0)<0&&(w=w-b|0,_[v>>2]=w,y=y-b|0,_[V>>2]=y,_[k>>2]=0,b=0),P=w-y|0,C=b-y|0,(y|0)<0?(_[v>>2]=P,_[k>>2]=C,_[V>>2]=0,w=P,y=0):C=b,b=(C|0)<(w|0)?C:w,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(_[v>>2]=w-b,_[k>>2]=C-b,_[V>>2]=y-b)}function np(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0;y=_[v>>2]|0,k=v+4|0,w=_[k>>2]|0,V=v+8|0,b=_[V>>2]|0,C=w+y|0,_[v>>2]=C,w=b+w|0,_[k>>2]=w,y=b+y|0,_[V>>2]=y,b=w-C|0,(C|0)<0?(y=y-C|0,_[k>>2]=b,_[V>>2]=y,_[v>>2]=0,w=0):(b=w,w=C),(b|0)<0&&(w=w-b|0,_[v>>2]=w,y=y-b|0,_[V>>2]=y,_[k>>2]=0,b=0),P=w-y|0,C=b-y|0,(y|0)<0?(_[v>>2]=P,_[k>>2]=C,_[V>>2]=0,w=P,y=0):C=b,b=(C|0)<(w|0)?C:w,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(_[v>>2]=w-b,_[k>>2]=C-b,_[V>>2]=y-b)}function Tu(v){switch(v=v|0,v|0){case 1:{v=5;break}case 5:{v=4;break}case 4:{v=6;break}case 6:{v=2;break}case 2:{v=3;break}case 3:{v=1;break}}return v|0}function Ir(v){switch(v=v|0,v|0){case 1:{v=3;break}case 3:{v=2;break}case 2:{v=6;break}case 6:{v=4;break}case 4:{v=5;break}case 5:{v=1;break}}return v|0}function G0(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0;y=_[v>>2]|0,k=v+4|0,b=_[k>>2]|0,V=v+8|0,w=_[V>>2]|0,C=b+(y<<1)|0,_[v>>2]=C,b=w+(b<<1)|0,_[k>>2]=b,y=(w<<1)+y|0,_[V>>2]=y,w=b-C|0,(C|0)<0?(y=y-C|0,_[k>>2]=w,_[V>>2]=y,_[v>>2]=0,b=w,w=0):w=C,(b|0)<0&&(w=w-b|0,_[v>>2]=w,y=y-b|0,_[V>>2]=y,_[k>>2]=0,b=0),P=w-y|0,C=b-y|0,(y|0)<0?(_[v>>2]=P,_[k>>2]=C,_[V>>2]=0,w=P,y=0):C=b,b=(C|0)<(w|0)?C:w,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(_[v>>2]=w-b,_[k>>2]=C-b,_[V>>2]=y-b)}function q0(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0;C=_[v>>2]|0,k=v+4|0,y=_[k>>2]|0,V=v+8|0,b=_[V>>2]|0,w=(y<<1)+C|0,C=b+(C<<1)|0,_[v>>2]=C,_[k>>2]=w,y=(b<<1)+y|0,_[V>>2]=y,b=w-C|0,(C|0)<0?(y=y-C|0,_[k>>2]=b,_[V>>2]=y,_[v>>2]=0,C=0):b=w,(b|0)<0&&(C=C-b|0,_[v>>2]=C,y=y-b|0,_[V>>2]=y,_[k>>2]=0,b=0),P=C-y|0,w=b-y|0,(y|0)<0?(_[v>>2]=P,_[k>>2]=w,_[V>>2]=0,C=P,y=0):w=b,b=(w|0)<(C|0)?w:C,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(_[v>>2]=C-b,_[k>>2]=w-b,_[V>>2]=y-b)}function Fm(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0;return k=(_[v>>2]|0)-(_[y>>2]|0)|0,V=(k|0)<0,w=(_[v+4>>2]|0)-(_[y+4>>2]|0)-(V?k:0)|0,P=(w|0)<0,C=(V?0-k|0:0)+(_[v+8>>2]|0)-(_[y+8>>2]|0)+(P?0-w|0:0)|0,v=(C|0)<0,y=v?0:C,b=(P?0:w)-(v?C:0)|0,C=(V?0:k)-(P?w:0)-(v?C:0)|0,v=(b|0)<(C|0)?b:C,v=(y|0)<(v|0)?y:v,w=(v|0)>0,y=y-(w?v:0)|0,b=b-(w?v:0)|0,v=C-(w?v:0)|0,v=(v|0)>-1?v:0-v|0,b=(b|0)>-1?b:0-b|0,y=(y|0)>-1?y:0-y|0,y=(b|0)>(y|0)?b:y,((v|0)>(y|0)?v:y)|0}function b1(v,y){v=v|0,y=y|0;var b=0;b=_[v+8>>2]|0,_[y>>2]=(_[v>>2]|0)-b,_[y+4>>2]=(_[v+4>>2]|0)-b}function dh(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0;return w=_[v>>2]|0,_[y>>2]=w,C=_[v+4>>2]|0,k=y+4|0,_[k>>2]=C,V=y+8|0,_[V>>2]=0,b=(C|0)<(w|0),v=b?w:C,b=b?C:w,(b|0)<0&&((b|0)==-2147483648||((v|0)>0?(2147483647-v|0)<(b|0):(-2147483648-v|0)>(b|0))||((v|0)>-1?(v|-2147483648|0)>=(b|0):(v^-2147483648|0)<(b|0)))?(y=1,y|0):(v=C-w|0,(w|0)<0?(b=0-w|0,_[k>>2]=v,_[V>>2]=b,_[y>>2]=0,w=0):(v=C,b=0),(v|0)<0&&(w=w-v|0,_[y>>2]=w,b=b-v|0,_[V>>2]=b,_[k>>2]=0,v=0),P=w-b|0,C=v-b|0,(b|0)<0?(_[y>>2]=P,_[k>>2]=C,_[V>>2]=0,v=C,C=P,b=0):C=w,w=(v|0)<(C|0)?v:C,w=(b|0)<(w|0)?b:w,(w|0)<=0?(y=0,y|0):(_[y>>2]=C-w,_[k>>2]=v-w,_[V>>2]=b-w,y=0,y|0))}function Yr(v){v=v|0;var y=0,b=0,w=0,C=0;y=v+8|0,C=_[y>>2]|0,b=C-(_[v>>2]|0)|0,_[v>>2]=b,w=v+4|0,v=(_[w>>2]|0)-C|0,_[w>>2]=v,_[y>>2]=0-(v+b)}function S1(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0;b=_[v>>2]|0,y=0-b|0,_[v>>2]=y,k=v+8|0,_[k>>2]=0,V=v+4|0,w=_[V>>2]|0,C=w+b|0,(b|0)>0?(_[V>>2]=C,_[k>>2]=b,_[v>>2]=0,y=0,w=C):b=0,(w|0)<0?(P=y-w|0,_[v>>2]=P,b=b-w|0,_[k>>2]=b,_[V>>2]=0,C=P-b|0,y=0-b|0,(b|0)<0?(_[v>>2]=C,_[V>>2]=y,_[k>>2]=0,w=y,b=0):(w=0,C=P)):C=y,y=(w|0)<(C|0)?w:C,y=(b|0)<(y|0)?b:y,!((y|0)<=0)&&(_[v>>2]=C-y,_[V>>2]=w-y,_[k>>2]=b-y)}function T1(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0,J=0,ae=0,xe=0;if(xe=de,de=de+64|0,ae=xe,V=xe+56|0,!(!0&(y&2013265920|0)==134217728&(!0&(w&2013265920|0)==134217728)))return C=5,de=xe,C|0;if((v|0)==(b|0)&(y|0)==(w|0))return _[C>>2]=0,C=0,de=xe,C|0;if(k=Gt(v|0,y|0,52)|0,se()|0,k=k&15,J=Gt(b|0,w|0,52)|0,se()|0,(k|0)!=(J&15|0))return C=12,de=xe,C|0;if(P=k+-1|0,k>>>0>1){sp(v,y,P,ae)|0,sp(b,w,P,V)|0,J=ae,$=_[J>>2]|0,J=_[J+4>>2]|0;e:do if(($|0)==(_[V>>2]|0)&&(J|0)==(_[V+4>>2]|0)){k=(k^15)*3|0,P=Gt(v|0,y|0,k|0)|0,se()|0,P=P&7,k=Gt(b|0,w|0,k|0)|0,se()|0,k=k&7;do if((P|0)==0|(k|0)==0)_[C>>2]=1,P=0;else if((P|0)==7)P=5;else{if((P|0)==1|(k|0)==1&&yi($,J)|0){P=5;break}if((_[15536+(P<<2)>>2]|0)!=(k|0)&&(_[15568+(P<<2)>>2]|0)!=(k|0))break e;_[C>>2]=1,P=0}while(!1);return C=P,de=xe,C|0}while(!1)}P=ae,k=P+56|0;do _[P>>2]=0,P=P+4|0;while((P|0)<(k|0));return Fa(v,y,1,ae)|0,y=ae,!((_[y>>2]|0)==(b|0)&&(_[y+4>>2]|0)==(w|0))&&(y=ae+8|0,!((_[y>>2]|0)==(b|0)&&(_[y+4>>2]|0)==(w|0)))&&(y=ae+16|0,!((_[y>>2]|0)==(b|0)&&(_[y+4>>2]|0)==(w|0)))&&(y=ae+24|0,!((_[y>>2]|0)==(b|0)&&(_[y+4>>2]|0)==(w|0)))&&(y=ae+32|0,!((_[y>>2]|0)==(b|0)&&(_[y+4>>2]|0)==(w|0)))&&(y=ae+40|0,!((_[y>>2]|0)==(b|0)&&(_[y+4>>2]|0)==(w|0)))?(P=ae+48|0,P=((_[P>>2]|0)==(b|0)?(_[P+4>>2]|0)==(w|0):0)&1):P=1,_[C>>2]=P,C=0,de=xe,C|0}function ld(v,y,b,w,C){return v=v|0,y=y|0,b=b|0,w=w|0,C=C|0,b=Ci(v,y,b,w)|0,(b|0)==7?(C=11,C|0):(w=Jt(b|0,0,56)|0,y=y&-2130706433|(se()|0)|268435456,_[C>>2]=v|w,_[C+4>>2]=y,C=0,C|0)}function B(v,y,b){return v=v|0,y=y|0,b=b|0,!0&(y&2013265920|0)==268435456?(_[b>>2]=v,_[b+4>>2]=y&-2130706433|134217728,b=0,b|0):(b=6,b|0)}function ee(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0;return C=de,de=de+16|0,w=C,_[w>>2]=0,!0&(y&2013265920|0)==268435456?(P=Gt(v|0,y|0,56)|0,se()|0,w=za(v,y&-2130706433|134217728,P&7,w,b)|0,de=C,w|0):(w=6,de=C,w|0)}function he(v,y){v=v|0,y=y|0;var b=0;switch(b=Gt(v|0,y|0,56)|0,se()|0,b&7){case 0:case 7:return b=0,b|0}return b=y&-2130706433|134217728,!(!0&(y&2013265920|0)==268435456)||!0&(y&117440512|0)==16777216&(yi(v,b)|0)!=0?(b=0,b|0):(b=w1(v,b)|0,b|0)}function Pe(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0;return C=de,de=de+16|0,w=C,!0&(y&2013265920|0)==268435456?(P=y&-2130706433|134217728,k=b,_[k>>2]=v,_[k+4>>2]=P,_[w>>2]=0,y=Gt(v|0,y|0,56)|0,se()|0,w=za(v,P,y&7,w,b+8|0)|0,de=C,w|0):(w=6,de=C,w|0)}function gt(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0;return C=(yi(v,y)|0)==0,y=y&-2130706433,w=b,_[w>>2]=C?v:0,_[w+4>>2]=C?y|285212672:0,w=b+8|0,_[w>>2]=v,_[w+4>>2]=y|301989888,w=b+16|0,_[w>>2]=v,_[w+4>>2]=y|318767104,w=b+24|0,_[w>>2]=v,_[w+4>>2]=y|335544320,w=b+32|0,_[w>>2]=v,_[w+4>>2]=y|352321536,b=b+40|0,_[b>>2]=v,_[b+4>>2]=y|369098752,0}function Ct(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0;return k=de,de=de+16|0,C=k,P=y&-2130706433|134217728,!0&(y&2013265920|0)==268435456?(w=Gt(v|0,y|0,56)|0,se()|0,w=hb(v,P,w&7)|0,(w|0)==-1?(_[b>>2]=0,P=6,de=k,P|0):(op(v,P,C)|0&&Dt(27795,26932,282,26947),y=Gt(v|0,y|0,52)|0,se()|0,y=y&15,yi(v,P)|0?Go(C,y,w,2,b):cd(C,y,w,2,b),P=0,de=k,P|0)):(P=6,de=k,P|0)}function cn(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0;w=de,de=de+16|0,C=w,Ea(v,y,b,C),bu(C,b+4|0),de=w}function Ea(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0;if(V=de,de=de+16|0,$=V,Ds(v,b,$),P=+yo(+(1-+me[$>>3]*.5)),P<1e-16){_[w>>2]=0,_[w+4>>2]=0,_[w+8>>2]=0,_[w+12>>2]=0,de=V;return}if($=_[b>>2]|0,C=+me[15920+($*24|0)>>3],C=+Bm(C-+Bm(+xI(15600+($<<4)|0,v))),Qr(y)|0?k=+Bm(C+-.3334731722518321):k=C,C=+hr(+P)*2.618033988749896,(y|0)>0){v=0;do C=C*2.6457513110645907,v=v+1|0;while((v|0)!=(y|0))}P=+ka(+k)*C,me[w>>3]=P,k=+la(+k)*C,me[w+8>>3]=k,de=V}function Ds(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0;if(P=de,de=de+32|0,C=P,gp(v,C),_[y>>2]=0,me[b>>3]=5,w=+as(16400,C),w<+me[b>>3]&&(_[y>>2]=0,me[b>>3]=w),w=+as(16424,C),w<+me[b>>3]&&(_[y>>2]=1,me[b>>3]=w),w=+as(16448,C),w<+me[b>>3]&&(_[y>>2]=2,me[b>>3]=w),w=+as(16472,C),w<+me[b>>3]&&(_[y>>2]=3,me[b>>3]=w),w=+as(16496,C),w<+me[b>>3]&&(_[y>>2]=4,me[b>>3]=w),w=+as(16520,C),w<+me[b>>3]&&(_[y>>2]=5,me[b>>3]=w),w=+as(16544,C),w<+me[b>>3]&&(_[y>>2]=6,me[b>>3]=w),w=+as(16568,C),w<+me[b>>3]&&(_[y>>2]=7,me[b>>3]=w),w=+as(16592,C),w<+me[b>>3]&&(_[y>>2]=8,me[b>>3]=w),w=+as(16616,C),w<+me[b>>3]&&(_[y>>2]=9,me[b>>3]=w),w=+as(16640,C),w<+me[b>>3]&&(_[y>>2]=10,me[b>>3]=w),w=+as(16664,C),w<+me[b>>3]&&(_[y>>2]=11,me[b>>3]=w),w=+as(16688,C),w<+me[b>>3]&&(_[y>>2]=12,me[b>>3]=w),w=+as(16712,C),w<+me[b>>3]&&(_[y>>2]=13,me[b>>3]=w),w=+as(16736,C),w<+me[b>>3]&&(_[y>>2]=14,me[b>>3]=w),w=+as(16760,C),w<+me[b>>3]&&(_[y>>2]=15,me[b>>3]=w),w=+as(16784,C),w<+me[b>>3]&&(_[y>>2]=16,me[b>>3]=w),w=+as(16808,C),w<+me[b>>3]&&(_[y>>2]=17,me[b>>3]=w),w=+as(16832,C),w<+me[b>>3]&&(_[y>>2]=18,me[b>>3]=w),w=+as(16856,C),!(w<+me[b>>3])){de=P;return}_[y>>2]=19,me[b>>3]=w,de=P}function Xa(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0;if(P=+gh(v),P<1e-16){y=15600+(y<<4)|0,_[C>>2]=_[y>>2],_[C+4>>2]=_[y+4>>2],_[C+8>>2]=_[y+8>>2],_[C+12>>2]=_[y+12>>2];return}if(k=+ts(+ +me[v+8>>3],+ +me[v>>3]),(b|0)>0){v=0;do P=P*.37796447300922725,v=v+1|0;while((v|0)!=(b|0))}V=P*.3333333333333333,w?(b=(Qr(b)|0)==0,P=+Uo(+((b?V:V*.37796447300922725)*.381966011250105))):(P=+Uo(+(P*.381966011250105)),Qr(b)|0&&(k=+Bm(k+.3334731722518321))),bI(15600+(y<<4)|0,+Bm(+me[15920+(y*24|0)>>3]-k),P,C)}function us(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0;w=de,de=de+16|0,C=w,Dc(v+4|0,C),Xa(C,_[v>>2]|0,y,0,b),de=w}function Go(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0,Ke=0,en=0,wn=0,vn=0,ua=0,ea=0,wa=0,Qn=0,Cn=0,tn=0,Gn=0,Ia=0,Jn=0;if(Gn=de,de=de+272|0,P=Gn+256|0,ut=Gn+240|0,Qn=Gn,Cn=Gn+224|0,tn=Gn+208|0,lt=Gn+176|0,Ke=Gn+160|0,en=Gn+192|0,wn=Gn+144|0,vn=Gn+128|0,ua=Gn+112|0,ea=Gn+96|0,wa=Gn+80|0,_[P>>2]=y,_[ut>>2]=_[v>>2],_[ut+4>>2]=_[v+4>>2],_[ut+8>>2]=_[v+8>>2],_[ut+12>>2]=_[v+12>>2],Fc(ut,P,Qn),_[C>>2]=0,ut=w+b+((w|0)==5&1)|0,(ut|0)<=(b|0)){de=Gn;return}$=_[P>>2]|0,J=Cn+4|0,ae=lt+4|0,xe=b+5|0,ke=16880+($<<2)|0,De=16960+($<<2)|0,Oe=vn+8|0,$e=ua+8|0,nt=ea+8|0,At=tn+4|0,V=b;e:for(;;){k=Qn+(((V|0)%5|0)<<4)|0,_[tn>>2]=_[k>>2],_[tn+4>>2]=_[k+4>>2],_[tn+8>>2]=_[k+8>>2],_[tn+12>>2]=_[k+12>>2];do;while((Xr(tn,$,0,1)|0)==2);if((V|0)>(b|0)&(Qr(y)|0)!=0){if(_[lt>>2]=_[tn>>2],_[lt+4>>2]=_[tn+4>>2],_[lt+8>>2]=_[tn+8>>2],_[lt+12>>2]=_[tn+12>>2],Dc(J,Ke),w=_[lt>>2]|0,P=_[17040+(w*80|0)+(_[Cn>>2]<<2)>>2]|0,_[lt>>2]=_[18640+(w*80|0)+(P*20|0)>>2],k=_[18640+(w*80|0)+(P*20|0)+16>>2]|0,(k|0)>0){v=0;do tp(ae),v=v+1|0;while((v|0)<(k|0))}switch(k=18640+(w*80|0)+(P*20|0)+4|0,_[en>>2]=_[k>>2],_[en+4>>2]=_[k+4>>2],_[en+8>>2]=_[k+8>>2],kc(en,(_[ke>>2]|0)*3|0),bs(ae,en,ae),ms(ae),Dc(ae,wn),Ia=+(_[De>>2]|0),me[vn>>3]=Ia*3,me[Oe>>3]=0,Jn=Ia*-1.5,me[ua>>3]=Jn,me[$e>>3]=Ia*2.598076211353316,me[ea>>3]=Jn,me[nt>>3]=Ia*-2.598076211353316,_[17040+((_[lt>>2]|0)*80|0)+(_[tn>>2]<<2)>>2]|0){case 1:{v=ua,w=vn;break}case 3:{v=ea,w=ua;break}case 2:{v=vn,w=ea;break}default:{v=12;break e}}ub(Ke,wn,w,v,wa),Xa(wa,_[lt>>2]|0,$,1,C+8+(_[C>>2]<<4)|0),_[C>>2]=(_[C>>2]|0)+1}if((V|0)<(xe|0)&&(Dc(At,lt),Xa(lt,_[tn>>2]|0,$,1,C+8+(_[C>>2]<<4)|0),_[C>>2]=(_[C>>2]|0)+1),_[Cn>>2]=_[tn>>2],_[Cn+4>>2]=_[tn+4>>2],_[Cn+8>>2]=_[tn+8>>2],_[Cn+12>>2]=_[tn+12>>2],V=V+1|0,(V|0)>=(ut|0)){v=3;break}}if((v|0)==3){de=Gn;return}else(v|0)==12&&Dt(26970,27017,572,27027)}function Fc(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0;$=de,de=de+128|0,w=$+64|0,C=$,P=w,k=20240,V=P+60|0;do _[P>>2]=_[k>>2],P=P+4|0,k=k+4|0;while((P|0)<(V|0));P=C,k=20304,V=P+60|0;do _[P>>2]=_[k>>2],P=P+4|0,k=k+4|0;while((P|0)<(V|0));V=(Qr(_[y>>2]|0)|0)==0,w=V?w:C,C=v+4|0,G0(C),q0(C),Qr(_[y>>2]|0)|0&&(Oc(C),_[y>>2]=(_[y>>2]|0)+1),_[b>>2]=_[v>>2],y=b+4|0,bs(C,w,y),ms(y),_[b+16>>2]=_[v>>2],y=b+20|0,bs(C,w+12|0,y),ms(y),_[b+32>>2]=_[v>>2],y=b+36|0,bs(C,w+24|0,y),ms(y),_[b+48>>2]=_[v>>2],y=b+52|0,bs(C,w+36|0,y),ms(y),_[b+64>>2]=_[v>>2],b=b+68|0,bs(C,w+48|0,b),ms(b),de=$}function Xr(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0;if(Oe=de,de=de+32|0,ke=Oe+12|0,V=Oe,De=v+4|0,xe=_[16960+(y<<2)>>2]|0,ae=(w|0)!=0,xe=ae?xe*3|0:xe,C=_[De>>2]|0,J=v+8|0,k=_[J>>2]|0,ae){if(P=v+12|0,w=_[P>>2]|0,C=k+C+w|0,(C|0)==(xe|0))return De=1,de=Oe,De|0;$=P}else $=v+12|0,w=_[$>>2]|0,C=k+C+w|0;if((C|0)<=(xe|0))return De=0,de=Oe,De|0;do if((w|0)>0){if(w=_[v>>2]|0,(k|0)>0){P=18640+(w*80|0)+60|0,w=v;break}w=18640+(w*80|0)+40|0,b?(rd(ke,xe,0,0),uh(De,ke,V),np(V),bs(V,ke,De),P=w,w=v):(P=w,w=v)}else P=18640+((_[v>>2]|0)*80|0)+20|0,w=v;while(!1);if(_[w>>2]=_[P>>2],C=P+16|0,(_[C>>2]|0)>0){w=0;do tp(De),w=w+1|0;while((w|0)<(_[C>>2]|0))}return v=P+4|0,_[ke>>2]=_[v>>2],_[ke+4>>2]=_[v+4>>2],_[ke+8>>2]=_[v+8>>2],y=_[16880+(y<<2)>>2]|0,kc(ke,ae?y*3|0:y),bs(De,ke,De),ms(De),ae?w=((_[J>>2]|0)+(_[De>>2]|0)+(_[$>>2]|0)|0)==(xe|0)?1:2:w=2,De=w,de=Oe,De|0}function jc(v,y){v=v|0,y=y|0;var b=0;do b=Xr(v,y,0,1)|0;while((b|0)==2);return b|0}function cd(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0,Ke=0,en=0,wn=0,vn=0,ua=0,ea=0,wa=0,Qn=0;if(ea=de,de=de+240|0,P=ea+224|0,en=ea+208|0,wn=ea,vn=ea+192|0,ua=ea+176|0,nt=ea+160|0,At=ea+144|0,ut=ea+128|0,lt=ea+112|0,Ke=ea+96|0,_[P>>2]=y,_[en>>2]=_[v>>2],_[en+4>>2]=_[v+4>>2],_[en+8>>2]=_[v+8>>2],_[en+12>>2]=_[v+12>>2],ap(en,P,wn),_[C>>2]=0,$e=w+b+((w|0)==6&1)|0,($e|0)<=(b|0)){de=ea;return}$=_[P>>2]|0,J=b+6|0,ae=16960+($<<2)|0,xe=At+8|0,ke=ut+8|0,De=lt+8|0,Oe=vn+4|0,k=0,V=b,w=-1;e:for(;;){if(P=(V|0)%6|0,v=wn+(P<<4)|0,_[vn>>2]=_[v>>2],_[vn+4>>2]=_[v+4>>2],_[vn+8>>2]=_[v+8>>2],_[vn+12>>2]=_[v+12>>2],v=k,k=Xr(vn,$,0,1)|0,(V|0)>(b|0)&(Qr(y)|0)!=0&&(v|0)!=1&&(_[vn>>2]|0)!=(w|0)){switch(Dc(wn+(((P+5|0)%6|0)<<4)+4|0,ua),Dc(wn+(P<<4)+4|0,nt),wa=+(_[ae>>2]|0),me[At>>3]=wa*3,me[xe>>3]=0,Qn=wa*-1.5,me[ut>>3]=Qn,me[ke>>3]=wa*2.598076211353316,me[lt>>3]=Qn,me[De>>3]=wa*-2.598076211353316,P=_[en>>2]|0,_[17040+(P*80|0)+(((w|0)==(P|0)?_[vn>>2]|0:w)<<2)>>2]|0){case 1:{v=ut,w=At;break}case 3:{v=lt,w=ut;break}case 2:{v=At,w=lt;break}default:{v=8;break e}}ub(ua,nt,w,v,Ke),!(db(ua,Ke)|0)&&!(db(nt,Ke)|0)&&(Xa(Ke,_[en>>2]|0,$,1,C+8+(_[C>>2]<<4)|0),_[C>>2]=(_[C>>2]|0)+1)}if((V|0)<(J|0)&&(Dc(Oe,ua),Xa(ua,_[vn>>2]|0,$,1,C+8+(_[C>>2]<<4)|0),_[C>>2]=(_[C>>2]|0)+1),V=V+1|0,(V|0)>=($e|0)){v=3;break}else w=_[vn>>2]|0}if((v|0)==3){de=ea;return}else(v|0)==8&&Dt(27054,27017,737,27099)}function ap(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0;$=de,de=de+160|0,w=$+80|0,C=$,P=w,k=20368,V=P+72|0;do _[P>>2]=_[k>>2],P=P+4|0,k=k+4|0;while((P|0)<(V|0));P=C,k=20448,V=P+72|0;do _[P>>2]=_[k>>2],P=P+4|0,k=k+4|0;while((P|0)<(V|0));V=(Qr(_[y>>2]|0)|0)==0,w=V?w:C,C=v+4|0,G0(C),q0(C),Qr(_[y>>2]|0)|0&&(Oc(C),_[y>>2]=(_[y>>2]|0)+1),_[b>>2]=_[v>>2],y=b+4|0,bs(C,w,y),ms(y),_[b+16>>2]=_[v>>2],y=b+20|0,bs(C,w+12|0,y),ms(y),_[b+32>>2]=_[v>>2],y=b+36|0,bs(C,w+24|0,y),ms(y),_[b+48>>2]=_[v>>2],y=b+52|0,bs(C,w+36|0,y),ms(y),_[b+64>>2]=_[v>>2],y=b+68|0,bs(C,w+48|0,y),ms(y),_[b+80>>2]=_[v>>2],b=b+84|0,bs(C,w+60|0,b),ms(b),de=$}function jm(v,y){return v=v|0,y=y|0,y=Gt(v|0,y|0,52)|0,se()|0,y&15|0}function Sw(v,y){return v=v|0,y=y|0,y=Gt(v|0,y|0,45)|0,se()|0,y&127|0}function gI(v,y,b,w){return v=v|0,y=y|0,b=b|0,w=w|0,(b+-1|0)>>>0>14?(w=4,w|0):(b=Gt(v|0,y|0,(15-b|0)*3|0)|0,se()|0,_[w>>2]=b&7,w=0,w|0)}function AI(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0;if(v>>>0>15)return w=4,w|0;if(y>>>0>121)return w=17,w|0;k=Jt(v|0,0,52)|0,C=se()|0,V=Jt(y|0,0,45)|0,C=C|(se()|0)|134225919;e:do if((v|0)>=1){for(V=1,k=(Ut[20528+y>>0]|0)!=0,P=-1;;){if(y=_[b+(V+-1<<2)>>2]|0,y>>>0>6){C=18,y=10;break}if(!((y|0)==0|k^1))if((y|0)==1){C=19,y=10;break}else k=0;if(J=(15-V|0)*3|0,$=Jt(7,0,J|0)|0,C=C&~(se()|0),y=Jt(y|0,((y|0)<0)<<31>>31|0,J|0)|0,P=y|P&~$,C=se()|0|C,(V|0)<(v|0))V=V+1|0;else break e}if((y|0)==10)return C|0}else P=-1;while(!1);return J=w,_[J>>2]=P,_[J+4>>2]=C,J=0,J|0}function w1(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0;return!(!0&(y&-16777216|0)==134217728)||(w=Gt(v|0,y|0,52)|0,se()|0,w=w&15,b=Gt(v|0,y|0,45)|0,se()|0,b=b&127,b>>>0>121)?(v=0,v|0):(k=(w^15)*3|0,C=Gt(v|0,y|0,k|0)|0,k=Jt(C|0,se()|0,k|0)|0,C=se()|0,P=$s(-1227133514,-1171,k|0,C|0)|0,!((k&613566756&P|0)==0&(C&4681&(se()|0)|0)==0)||(k=(w*3|0)+19|0,P=Jt(~v|0,~y|0,k|0)|0,k=Gt(P|0,se()|0,k|0)|0,!((w|0)==15|(k|0)==0&(se()|0)==0))?(k=0,k|0):!(Ut[20528+b>>0]|0)||(y=y&8191,(v|0)==0&(y|0)==0)?(k=1,k|0):(k=Y0(v|0,y|0)|0,se()|0,((63-k|0)%3|0|0)!=0|0))}function Tw(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0;return!0&(y&-16777216|0)==134217728&&(w=Gt(v|0,y|0,52)|0,se()|0,w=w&15,b=Gt(v|0,y|0,45)|0,se()|0,b=b&127,b>>>0<=121)&&(k=(w^15)*3|0,C=Gt(v|0,y|0,k|0)|0,k=Jt(C|0,se()|0,k|0)|0,C=se()|0,P=$s(-1227133514,-1171,k|0,C|0)|0,(k&613566756&P|0)==0&(C&4681&(se()|0)|0)==0)&&(k=(w*3|0)+19|0,P=Jt(~v|0,~y|0,k|0)|0,k=Gt(P|0,se()|0,k|0)|0,(w|0)==15|(k|0)==0&(se()|0)==0)&&(!(Ut[20528+b>>0]|0)||(b=y&8191,(v|0)==0&(b|0)==0)||(k=Y0(v|0,b|0)|0,se()|0,(63-k|0)%3|0|0))||he(v,y)|0?(k=1,k|0):(k=(pd(v,y)|0)!=0&1,k|0)}function ip(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0;if(C=Jt(y|0,0,52)|0,P=se()|0,b=Jt(b|0,0,45)|0,b=P|(se()|0)|134225919,(y|0)<1){P=-1,w=b,y=v,_[y>>2]=P,v=v+4|0,_[v>>2]=w;return}for(P=1,C=-1;k=(15-P|0)*3|0,V=Jt(7,0,k|0)|0,b=b&~(se()|0),k=Jt(w|0,0,k|0)|0,C=C&~V|k,b=b|(se()|0),(P|0)!=(y|0);)P=P+1|0;V=v,k=V,_[k>>2]=C,V=V+4|0,_[V>>2]=b}function sp(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0;if(P=Gt(v|0,y|0,52)|0,se()|0,P=P&15,b>>>0>15)return w=4,w|0;if((P|0)<(b|0))return w=12,w|0;if((P|0)==(b|0))return _[w>>2]=v,_[w+4>>2]=y,w=0,w|0;if(C=Jt(b|0,0,52)|0,C=C|v,v=se()|0|y&-15728641,(P|0)>(b|0))do y=Jt(7,0,(14-b|0)*3|0)|0,b=b+1|0,C=y|C,v=se()|0|v;while((b|0)<(P|0));return _[w>>2]=C,_[w+4>>2]=v,w=0,w|0}function H0(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0;if(P=Gt(v|0,y|0,52)|0,se()|0,P=P&15,!((b|0)<16&(P|0)<=(b|0)))return w=4,w|0;C=b-P|0,b=Gt(v|0,y|0,45)|0,se()|0;e:do if(!(mi(b&127)|0))b=Eu(7,0,C,((C|0)<0)<<31>>31)|0,C=se()|0;else{t:do if(P|0){for(b=1;k=Jt(7,0,(15-b|0)*3|0)|0,!!((k&v|0)==0&((se()|0)&y|0)==0);)if(b>>>0<P>>>0)b=b+1|0;else break t;b=Eu(7,0,C,((C|0)<0)<<31>>31)|0,C=se()|0;break e}while(!1);b=Eu(7,0,C,((C|0)<0)<<31>>31)|0,b=gs(b|0,se()|0,5,0)|0,b=fn(b|0,se()|0,-5,-1)|0,b=Ru(b|0,se()|0,6,0)|0,b=fn(b|0,se()|0,1,0)|0,C=se()|0}while(!1);return k=w,_[k>>2]=b,_[k+4>>2]=C,k=0,k|0}function yi(v,y){v=v|0,y=y|0;var b=0,w=0,C=0;if(C=Gt(v|0,y|0,45)|0,se()|0,!(mi(C&127)|0))return C=0,C|0;C=Gt(v|0,y|0,52)|0,se()|0,C=C&15;e:do if(!C)b=0;else for(w=1;;){if(b=Gt(v|0,y|0,(15-w|0)*3|0)|0,se()|0,b=b&7,b|0)break e;if(w>>>0<C>>>0)w=w+1|0;else{b=0;break}}while(!1);return C=(b|0)==0&1,C|0}function ww(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0;if(k=de,de=de+16|0,P=k,ud(P,v,y,b),y=P,v=_[y>>2]|0,y=_[y+4>>2]|0,(v|0)==0&(y|0)==0)return de=k,0;C=0,b=0;do V=w+(C<<3)|0,_[V>>2]=v,_[V+4>>2]=y,C=fn(C|0,b|0,1,0)|0,b=se()|0,W0(P),V=P,v=_[V>>2]|0,y=_[V+4>>2]|0;while(!((v|0)==0&(y|0)==0));return de=k,0}function Qx(v,y,b,w){return v=v|0,y=y|0,b=b|0,w=w|0,(w|0)<(b|0)?(b=y,w=v,Ze(b|0),w|0):(b=Jt(-1,-1,((w-b|0)*3|0)+3|0)|0,w=Jt(~b|0,~(se()|0)|0,(15-w|0)*3|0)|0,b=~(se()|0)&y,w=~w&v,Ze(b|0),w|0)}function E1(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0;return C=Gt(v|0,y|0,52)|0,se()|0,C=C&15,(b|0)<16&(C|0)<=(b|0)?((C|0)<(b|0)&&(C=Jt(-1,-1,((b+-1-C|0)*3|0)+3|0)|0,C=Jt(~C|0,~(se()|0)|0,(15-b|0)*3|0)|0,y=~(se()|0)&y,v=~C&v),C=Jt(b|0,0,52)|0,b=y&-15728641|(se()|0),_[w>>2]=v|C,_[w+4>>2]=b,w=0,w|0):(w=4,w|0)}function Jx(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0,Ke=0,en=0,wn=0,vn=0,ua=0,ea=0,wa=0,Qn=0,Cn=0,tn=0;if((b|0)==0&(w|0)==0)return tn=0,tn|0;if(C=v,P=_[C>>2]|0,C=_[C+4>>2]|0,!0&(C&15728640|0)==0){if(!((w|0)>0|(w|0)==0&b>>>0>0)||(tn=y,_[tn>>2]=P,_[tn+4>>2]=C,(b|0)==1&(w|0)==0))return tn=0,tn|0;C=1,P=0;do Qn=v+(C<<3)|0,Cn=_[Qn+4>>2]|0,tn=y+(C<<3)|0,_[tn>>2]=_[Qn>>2],_[tn+4>>2]=Cn,C=fn(C|0,P|0,1,0)|0,P=se()|0;while((P|0)<(w|0)|(P|0)==(w|0)&C>>>0<b>>>0);return C=0,C|0}if(wa=b<<3,Cn=Nu(wa)|0,!Cn)return tn=13,tn|0;if(Ah(Cn|0,v|0,wa|0)|0,Qn=Ko(b,8)|0,!Qn)return Un(Cn),tn=13,tn|0;e:for(;;){C=Cn,J=_[C>>2]|0,C=_[C+4>>2]|0,ua=Gt(J|0,C|0,52)|0,se()|0,ua=ua&15,ea=ua+-1|0,vn=(ua|0)!=0,wn=(w|0)>0|(w|0)==0&b>>>0>0;t:do if(vn&wn){if(ut=Jt(ea|0,0,52)|0,lt=se()|0,ea>>>0>15){if(!((J|0)==0&(C|0)==0)){tn=16;break e}for(P=0,v=0;;){if(P=fn(P|0,v|0,1,0)|0,v=se()|0,!((v|0)<(w|0)|(v|0)==(w|0)&P>>>0<b>>>0))break t;if(k=Cn+(P<<3)|0,en=_[k>>2]|0,k=_[k+4>>2]|0,!((en|0)==0&(k|0)==0)){C=k,tn=16;break e}}}for(V=J,v=C,P=0,k=0;;){if(!((V|0)==0&(v|0)==0)){if(!(!0&(v&117440512|0)==0)){tn=21;break e}if(ae=Gt(V|0,v|0,52)|0,se()|0,ae=ae&15,(ae|0)<(ea|0)){C=12,tn=27;break e}if((ae|0)!=(ea|0)&&(V=V|ut,v=v&-15728641|lt,ae>>>0>=ua>>>0)){$=ea;do en=Jt(7,0,(14-$|0)*3|0)|0,$=$+1|0,V=en|V,v=se()|0|v;while($>>>0<ae>>>0)}if(ke=xp(V|0,v|0,b|0,w|0)|0,De=se()|0,$=Qn+(ke<<3)|0,ae=$,xe=_[ae>>2]|0,ae=_[ae+4>>2]|0,!((xe|0)==0&(ae|0)==0)){nt=0,At=0;do{if((nt|0)>(w|0)|(nt|0)==(w|0)&At>>>0>b>>>0){tn=31;break e}if((xe|0)==(V|0)&(ae&-117440513|0)==(v|0)){Oe=Gt(xe|0,ae|0,56)|0,se()|0,Oe=Oe&7,$e=Oe+1|0,en=Gt(xe|0,ae|0,45)|0,se()|0;n:do if(!(mi(en&127)|0))ae=7;else{if(xe=Gt(xe|0,ae|0,52)|0,se()|0,xe=xe&15,!xe){ae=6;break}for(ae=1;;){if(en=Jt(7,0,(15-ae|0)*3|0)|0,!((en&V|0)==0&((se()|0)&v|0)==0)){ae=7;break n}if(ae>>>0<xe>>>0)ae=ae+1|0;else{ae=6;break}}}while(!1);if((Oe+2|0)>>>0>ae>>>0){tn=41;break e}en=Jt($e|0,0,56)|0,v=se()|0|v&-117440513,Ke=$,_[Ke>>2]=0,_[Ke+4>>2]=0,V=en|V}else ke=fn(ke|0,De|0,1,0)|0,ke=Gm(ke|0,se()|0,b|0,w|0)|0,De=se()|0;At=fn(At|0,nt|0,1,0)|0,nt=se()|0,$=Qn+(ke<<3)|0,ae=$,xe=_[ae>>2]|0,ae=_[ae+4>>2]|0}while(!((xe|0)==0&(ae|0)==0))}en=$,_[en>>2]=V,_[en+4>>2]=v}if(P=fn(P|0,k|0,1,0)|0,k=se()|0,!((k|0)<(w|0)|(k|0)==(w|0)&P>>>0<b>>>0))break t;v=Cn+(P<<3)|0,V=_[v>>2]|0,v=_[v+4>>2]|0}}while(!1);if(en=fn(b|0,w|0,5,0)|0,Ke=se()|0,Ke>>>0<0|(Ke|0)==0&en>>>0<11){tn=85;break}if(en=Ru(b|0,w|0,6,0)|0,se()|0,en=Ko(en,8)|0,!en){tn=48;break}do if(wn){for($e=0,v=0,Oe=0,nt=0;;){if(ae=Qn+($e<<3)|0,k=ae,P=_[k>>2]|0,k=_[k+4>>2]|0,(P|0)==0&(k|0)==0)Ke=Oe;else{xe=Gt(P|0,k|0,56)|0,se()|0,xe=xe&7,V=xe+1|0,ke=k&-117440513,Ke=Gt(P|0,k|0,45)|0,se()|0;t:do if(mi(Ke&127)|0){if(De=Gt(P|0,k|0,52)|0,se()|0,De=De&15,De|0)for($=1;;){if(Ke=Jt(7,0,(15-$|0)*3|0)|0,!((P&Ke|0)==0&(ke&(se()|0)|0)==0))break t;if($>>>0<De>>>0)$=$+1|0;else break}k=Jt(V|0,0,56)|0,P=k|P,k=se()|0|ke,V=ae,_[V>>2]=P,_[V+4>>2]=k,V=xe+2|0}while(!1);(V|0)==7?(Ke=en+(v<<3)|0,_[Ke>>2]=P,_[Ke+4>>2]=k&-117440513,v=fn(v|0,Oe|0,1,0)|0,Ke=se()|0):Ke=Oe}if($e=fn($e|0,nt|0,1,0)|0,nt=se()|0,(nt|0)<(w|0)|(nt|0)==(w|0)&$e>>>0<b>>>0)Oe=Ke;else break}if(wn){if(At=ea>>>0>15,ut=Jt(ea|0,0,52)|0,lt=se()|0,!vn){for(P=0,$=0,V=0,k=0;(J|0)==0&(C|0)==0||(ea=y+(P<<3)|0,_[ea>>2]=J,_[ea+4>>2]=C,P=fn(P|0,$|0,1,0)|0,$=se()|0),V=fn(V|0,k|0,1,0)|0,k=se()|0,!!((k|0)<(w|0)|(k|0)==(w|0)&V>>>0<b>>>0);)C=Cn+(V<<3)|0,J=_[C>>2]|0,C=_[C+4>>2]|0;C=Ke;break}for(P=0,$=0,k=0,V=0;;){do if(!((J|0)==0&(C|0)==0)){if(De=Gt(J|0,C|0,52)|0,se()|0,De=De&15,At|(De|0)<(ea|0)){tn=80;break e}if((De|0)!=(ea|0)){if(ae=J|ut,xe=C&-15728641|lt,De>>>0>=ua>>>0){ke=ea;do vn=Jt(7,0,(14-ke|0)*3|0)|0,ke=ke+1|0,ae=vn|ae,xe=se()|0|xe;while(ke>>>0<De>>>0)}}else ae=J,xe=C;Oe=xp(ae|0,xe|0,b|0,w|0)|0,ke=0,De=0,nt=se()|0;do{if((ke|0)>(w|0)|(ke|0)==(w|0)&De>>>0>b>>>0){tn=81;break e}if(vn=Qn+(Oe<<3)|0,$e=_[vn+4>>2]|0,($e&-117440513|0)==(xe|0)&&(_[vn>>2]|0)==(ae|0)){tn=65;break}vn=fn(Oe|0,nt|0,1,0)|0,Oe=Gm(vn|0,se()|0,b|0,w|0)|0,nt=se()|0,De=fn(De|0,ke|0,1,0)|0,ke=se()|0,vn=Qn+(Oe<<3)|0}while(!((_[vn>>2]|0)==(ae|0)&&(_[vn+4>>2]|0)==(xe|0)));if((tn|0)==65&&(tn=0,!0&($e&117440512|0)==100663296))break;vn=y+(P<<3)|0,_[vn>>2]=J,_[vn+4>>2]=C,P=fn(P|0,$|0,1,0)|0,$=se()|0}while(!1);if(k=fn(k|0,V|0,1,0)|0,V=se()|0,!((V|0)<(w|0)|(V|0)==(w|0)&k>>>0<b>>>0))break;C=Cn+(k<<3)|0,J=_[C>>2]|0,C=_[C+4>>2]|0}C=Ke}else P=0,C=Ke}else P=0,v=0,C=0;while(!1);if(Vc(Qn|0,0,wa|0)|0,Ah(Cn|0,en|0,v<<3|0)|0,Un(en),(v|0)==0&(C|0)==0){tn=89;break}else y=y+(P<<3)|0,w=C,b=v}if((tn|0)==16)!0&(C&117440512|0)==0?(C=4,tn=27):tn=21;else if((tn|0)==31)Dt(27795,27122,620,27132);else{if((tn|0)==41)return Un(Cn),Un(Qn),tn=10,tn|0;if((tn|0)==48)return Un(Cn),Un(Qn),tn=13,tn|0;(tn|0)==80?Dt(27795,27122,711,27132):(tn|0)==81?Dt(27795,27122,723,27132):(tn|0)==85&&(Ah(y|0,Cn|0,b<<3|0)|0,tn=89)}return(tn|0)==21?(Un(Cn),Un(Qn),tn=5,tn|0):(tn|0)==27?(Un(Cn),Un(Qn),tn=C,tn|0):(tn|0)==89?(Un(Cn),Un(Qn),tn=0,tn|0):0}function Ew(v,y,b,w,C,P,k){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0,P=P|0,k=k|0;var V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0;if($e=de,de=de+16|0,Oe=$e,!((b|0)>0|(b|0)==0&y>>>0>0))return Oe=0,de=$e,Oe|0;if((k|0)>=16)return Oe=12,de=$e,Oe|0;ke=0,De=0,xe=0,V=0;e:for(;;){if(J=v+(ke<<3)|0,$=_[J>>2]|0,J=_[J+4>>2]|0,ae=Gt($|0,J|0,52)|0,se()|0,(ae&15|0)>(k|0)){V=12,$=11;break}if(ud(Oe,$,J,k),ae=Oe,J=_[ae>>2]|0,ae=_[ae+4>>2]|0,(J|0)==0&(ae|0)==0)$=xe;else{$=xe;do{if(!((V|0)<(P|0)|(V|0)==(P|0)&$>>>0<C>>>0)){$=10;break e}xe=w+($<<3)|0,_[xe>>2]=J,_[xe+4>>2]=ae,$=fn($|0,V|0,1,0)|0,V=se()|0,W0(Oe),xe=Oe,J=_[xe>>2]|0,ae=_[xe+4>>2]|0}while(!((J|0)==0&(ae|0)==0))}if(ke=fn(ke|0,De|0,1,0)|0,De=se()|0,(De|0)<(b|0)|(De|0)==(b|0)&ke>>>0<y>>>0)xe=$;else{V=0,$=11;break}}return($|0)==10?(Oe=14,de=$e,Oe|0):($|0)==11?(de=$e,V|0):0}function Mw(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0;ke=de,de=de+16|0,xe=ke;e:do if((b|0)>0|(b|0)==0&y>>>0>0){for(J=0,k=0,P=0,ae=0;;){if($=v+(J<<3)|0,V=_[$>>2]|0,$=_[$+4>>2]|0,!((V|0)==0&($|0)==0)&&($=(H0(V,$,w,xe)|0)==0,V=xe,k=fn(_[V>>2]|0,_[V+4>>2]|0,k|0,P|0)|0,P=se()|0,!$)){P=12;break}if(J=fn(J|0,ae|0,1,0)|0,ae=se()|0,!((ae|0)<(b|0)|(ae|0)==(b|0)&J>>>0<y>>>0))break e}return de=ke,P|0}else k=0,P=0;while(!1);return _[C>>2]=k,_[C+4>>2]=P,C=0,de=ke,C|0}function Cw(v,y){return v=v|0,y=y|0,y=Gt(v|0,y|0,52)|0,se()|0,y&1|0}function qo(v,y){v=v|0,y=y|0;var b=0,w=0,C=0;if(C=Gt(v|0,y|0,52)|0,se()|0,C=C&15,!C)return C=0,C|0;for(w=1;;){if(b=Gt(v|0,y|0,(15-w|0)*3|0)|0,se()|0,b=b&7,b|0){w=5;break}if(w>>>0<C>>>0)w=w+1|0;else{b=0,w=5;break}}return(w|0)==5?b|0:0}function Zx(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0,$=0;if($=Gt(v|0,y|0,52)|0,se()|0,$=$&15,!$)return V=y,$=v,Ze(V|0),$|0;for(V=1,b=0;;){P=(15-V|0)*3|0,w=Jt(7,0,P|0)|0,C=se()|0,k=Gt(v|0,y|0,P|0)|0,se()|0,P=Jt(Tu(k&7)|0,0,P|0)|0,k=se()|0,v=P|v&~w,y=k|y&~C;e:do if(!b)if((P&w|0)==0&(k&C|0)==0)b=0;else if(w=Gt(v|0,y|0,52)|0,se()|0,w=w&15,!w)b=1;else{b=1;t:for(;;){switch(k=Gt(v|0,y|0,(15-b|0)*3|0)|0,se()|0,k&7){case 1:break t;case 0:break;default:{b=1;break e}}if(b>>>0<w>>>0)b=b+1|0;else{b=1;break e}}for(b=1;;)if(k=(15-b|0)*3|0,C=Gt(v|0,y|0,k|0)|0,se()|0,P=Jt(7,0,k|0)|0,y=y&~(se()|0),k=Jt(Tu(C&7)|0,0,k|0)|0,v=v&~P|k,y=y|(se()|0),b>>>0<w>>>0)b=b+1|0;else{b=1;break}}while(!1);if(V>>>0<$>>>0)V=V+1|0;else break}return Ze(y|0),v|0}function rp(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0;if(w=Gt(v|0,y|0,52)|0,se()|0,w=w&15,!w)return b=y,w=v,Ze(b|0),w|0;for(b=1;P=(15-b|0)*3|0,k=Gt(v|0,y|0,P|0)|0,se()|0,C=Jt(7,0,P|0)|0,y=y&~(se()|0),P=Jt(Tu(k&7)|0,0,P|0)|0,v=P|v&~C,y=se()|0|y,b>>>0<w>>>0;)b=b+1|0;return Ze(y|0),v|0}function yI(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0,$=0;if($=Gt(v|0,y|0,52)|0,se()|0,$=$&15,!$)return V=y,$=v,Ze(V|0),$|0;for(V=1,b=0;;){P=(15-V|0)*3|0,w=Jt(7,0,P|0)|0,C=se()|0,k=Gt(v|0,y|0,P|0)|0,se()|0,P=Jt(Ir(k&7)|0,0,P|0)|0,k=se()|0,v=P|v&~w,y=k|y&~C;e:do if(!b)if((P&w|0)==0&(k&C|0)==0)b=0;else if(w=Gt(v|0,y|0,52)|0,se()|0,w=w&15,!w)b=1;else{b=1;t:for(;;){switch(k=Gt(v|0,y|0,(15-b|0)*3|0)|0,se()|0,k&7){case 1:break t;case 0:break;default:{b=1;break e}}if(b>>>0<w>>>0)b=b+1|0;else{b=1;break e}}for(b=1;;)if(C=(15-b|0)*3|0,P=Jt(7,0,C|0)|0,k=y&~(se()|0),y=Gt(v|0,y|0,C|0)|0,se()|0,y=Jt(Ir(y&7)|0,0,C|0)|0,v=v&~P|y,y=k|(se()|0),b>>>0<w>>>0)b=b+1|0;else{b=1;break}}while(!1);if(V>>>0<$>>>0)V=V+1|0;else break}return Ze(y|0),v|0}function eb(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0;if(w=Gt(v|0,y|0,52)|0,se()|0,w=w&15,!w)return b=y,w=v,Ze(b|0),w|0;for(b=1;k=(15-b|0)*3|0,P=Jt(7,0,k|0)|0,C=y&~(se()|0),y=Gt(v|0,y|0,k|0)|0,se()|0,y=Jt(Ir(y&7)|0,0,k|0)|0,v=y|v&~P,y=se()|0|C,b>>>0<w>>>0;)b=b+1|0;return Ze(y|0),v|0}function Al(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0;if($=de,de=de+64|0,V=$+40|0,w=$+24|0,C=$+12|0,P=$,Jt(y|0,0,52)|0,b=se()|0|134225919,!y)return(_[v+4>>2]|0)>2||(_[v+8>>2]|0)>2||(_[v+12>>2]|0)>2?(k=0,V=0,Ze(k|0),de=$,V|0):(Jt(Vl(v)|0,0,45)|0,k=se()|0|b,V=-1,Ze(k|0),de=$,V|0);if(_[V>>2]=_[v>>2],_[V+4>>2]=_[v+4>>2],_[V+8>>2]=_[v+8>>2],_[V+12>>2]=_[v+12>>2],k=V+4|0,(y|0)>0)for(v=-1;_[w>>2]=_[k>>2],_[w+4>>2]=_[k+4>>2],_[w+8>>2]=_[k+8>>2],y&1?(x1(k),_[C>>2]=_[k>>2],_[C+4>>2]=_[k+4>>2],_[C+8>>2]=_[k+8>>2],Su(C)):(V0(k),_[C>>2]=_[k>>2],_[C+4>>2]=_[k+4>>2],_[C+8>>2]=_[k+8>>2],Oc(C)),uh(w,C,P),ms(P),ae=(15-y|0)*3|0,J=Jt(7,0,ae|0)|0,b=b&~(se()|0),ae=Jt(od(P)|0,0,ae|0)|0,v=ae|v&~J,b=se()|0|b,(y|0)>1;)y=y+-1|0;else v=-1;e:do if((_[k>>2]|0)<=2&&(_[V+8>>2]|0)<=2&&(_[V+12>>2]|0)<=2){if(w=Vl(V)|0,y=Jt(w|0,0,45)|0,y=y|v,v=se()|0|b&-1040385,P=B0(V)|0,!(mi(w)|0)){if((P|0)<=0)break;for(C=0;;){if(w=Gt(y|0,v|0,52)|0,se()|0,w=w&15,w)for(b=1;ae=(15-b|0)*3|0,V=Gt(y|0,v|0,ae|0)|0,se()|0,J=Jt(7,0,ae|0)|0,v=v&~(se()|0),ae=Jt(Tu(V&7)|0,0,ae|0)|0,y=y&~J|ae,v=v|(se()|0),b>>>0<w>>>0;)b=b+1|0;if(C=C+1|0,(C|0)==(P|0))break e}}C=Gt(y|0,v|0,52)|0,se()|0,C=C&15;t:do if(C){b=1;n:for(;;){switch(ae=Gt(y|0,v|0,(15-b|0)*3|0)|0,se()|0,ae&7){case 1:break n;case 0:break;default:break t}if(b>>>0<C>>>0)b=b+1|0;else break t}if(Pc(w,_[V>>2]|0)|0)for(b=1;V=(15-b|0)*3|0,J=Jt(7,0,V|0)|0,ae=v&~(se()|0),v=Gt(y|0,v|0,V|0)|0,se()|0,v=Jt(Ir(v&7)|0,0,V|0)|0,y=y&~J|v,v=ae|(se()|0),b>>>0<C>>>0;)b=b+1|0;else for(b=1;ae=(15-b|0)*3|0,V=Gt(y|0,v|0,ae|0)|0,se()|0,J=Jt(7,0,ae|0)|0,v=v&~(se()|0),ae=Jt(Tu(V&7)|0,0,ae|0)|0,y=y&~J|ae,v=v|(se()|0),b>>>0<C>>>0;)b=b+1|0}while(!1);if((P|0)>0){b=0;do y=Zx(y,v)|0,v=se()|0,b=b+1|0;while((b|0)!=(P|0))}}else y=0,v=0;while(!1);return J=v,ae=y,Ze(J|0),de=$,ae|0}function Qr(v){return v=v|0,(v|0)%2|0|0}function M1(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0;return C=de,de=de+16|0,w=C,y>>>0>15?(w=4,de=C,w|0):(_[v+4>>2]&2146435072|0)==2146435072||(_[v+8+4>>2]&2146435072|0)==2146435072?(w=3,de=C,w|0):(cn(v,y,w),y=Al(w,y)|0,w=se()|0,_[b>>2]=y,_[b+4>>2]=w,(y|0)==0&(w|0)==0&&Dt(27795,27122,1050,27145),w=0,de=C,w|0)}function C1(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0;if(C=b+4|0,P=Gt(v|0,y|0,52)|0,se()|0,P=P&15,k=Gt(v|0,y|0,45)|0,se()|0,w=(P|0)==0,mi(k&127)|0){if(w)return k=1,k|0;w=1}else{if(w)return k=0,k|0;(_[C>>2]|0)==0&&(_[b+8>>2]|0)==0?w=(_[b+12>>2]|0)!=0&1:w=1}for(b=1;b&1?Su(C):Oc(C),k=Gt(v|0,y|0,(15-b|0)*3|0)|0,se()|0,z0(C,k&7),b>>>0<P>>>0;)b=b+1|0;return w|0}function op(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0;if(ae=de,de=de+16|0,$=ae,J=Gt(v|0,y|0,45)|0,se()|0,J=J&127,J>>>0>121)return _[b>>2]=0,_[b+4>>2]=0,_[b+8>>2]=0,_[b+12>>2]=0,J=5,de=ae,J|0;e:do if((mi(J)|0)!=0&&(P=Gt(v|0,y|0,52)|0,se()|0,P=P&15,(P|0)!=0)){w=1;t:for(;;){switch(V=Gt(v|0,y|0,(15-w|0)*3|0)|0,se()|0,V&7){case 5:break t;case 0:break;default:{w=y;break e}}if(w>>>0<P>>>0)w=w+1|0;else{w=y;break e}}for(C=1,w=y;y=(15-C|0)*3|0,k=Jt(7,0,y|0)|0,V=w&~(se()|0),w=Gt(v|0,w|0,y|0)|0,se()|0,w=Jt(Ir(w&7)|0,0,y|0)|0,v=v&~k|w,w=V|(se()|0),C>>>0<P>>>0;)C=C+1|0}else w=y;while(!1);if(V=7696+(J*28|0)|0,_[b>>2]=_[V>>2],_[b+4>>2]=_[V+4>>2],_[b+8>>2]=_[V+8>>2],_[b+12>>2]=_[V+12>>2],!(C1(v,w,b)|0))return J=0,de=ae,J|0;if(k=b+4|0,_[$>>2]=_[k>>2],_[$+4>>2]=_[k+4>>2],_[$+8>>2]=_[k+8>>2],P=Gt(v|0,w|0,52)|0,se()|0,V=P&15,P&1?(Oc(k),P=V+1|0):P=V,!(mi(J)|0))w=0;else{e:do if(!V)w=0;else for(y=1;;){if(C=Gt(v|0,w|0,(15-y|0)*3|0)|0,se()|0,C=C&7,C|0){w=C;break e}if(y>>>0<V>>>0)y=y+1|0;else{w=0;break}}while(!1);w=(w|0)==4&1}if(!(Xr(b,P,w,0)|0))(P|0)!=(V|0)&&(_[k>>2]=_[$>>2],_[k+4>>2]=_[$+4>>2],_[k+8>>2]=_[$+8>>2]);else{if(mi(J)|0)do;while((Xr(b,P,0,0)|0)!=0);(P|0)!=(V|0)&&V0(k)}return J=0,de=ae,J|0}function hh(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0;return P=de,de=de+16|0,w=P,C=op(v,y,w)|0,C|0?(de=P,C|0):(C=Gt(v|0,y|0,52)|0,se()|0,us(w,C&15,b),C=0,de=P,C|0)}function fh(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0;if(k=de,de=de+16|0,P=k,w=op(v,y,P)|0,w|0)return P=w,de=k,P|0;w=Gt(v|0,y|0,45)|0,se()|0,w=(mi(w&127)|0)==0,C=Gt(v|0,y|0,52)|0,se()|0,C=C&15;e:do if(!w){if(C|0)for(w=1;;){if(V=Jt(7,0,(15-w|0)*3|0)|0,!((V&v|0)==0&((se()|0)&y|0)==0))break e;if(w>>>0<C>>>0)w=w+1|0;else break}return Go(P,C,0,5,b),V=0,de=k,V|0}while(!1);return cd(P,C,0,6,b),V=0,de=k,V|0}function vI(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0;if(C=Gt(v|0,y|0,45)|0,se()|0,!(mi(C&127)|0))return C=2,_[b>>2]=C,0;if(C=Gt(v|0,y|0,52)|0,se()|0,C=C&15,!C)return C=5,_[b>>2]=C,0;for(w=1;;){if(P=Jt(7,0,(15-w|0)*3|0)|0,!((P&v|0)==0&((se()|0)&y|0)==0)){w=2,v=6;break}if(w>>>0<C>>>0)w=w+1|0;else{w=5,v=6;break}}return(v|0)==6&&(_[b>>2]=w),0}function lp(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0;xe=de,de=de+128|0,J=xe+112|0,P=xe+96|0,ae=xe,C=Gt(v|0,y|0,52)|0,se()|0,V=C&15,_[J>>2]=V,k=Gt(v|0,y|0,45)|0,se()|0,k=k&127;e:do if(mi(k)|0){if(V|0)for(w=1;;){if($=Jt(7,0,(15-w|0)*3|0)|0,!(($&v|0)==0&((se()|0)&y|0)==0)){C=0;break e}if(w>>>0<V>>>0)w=w+1|0;else break}if(C&1)C=1;else return $=Jt(V+1|0,0,52)|0,ae=se()|0|y&-15728641,J=Jt(7,0,(14-V|0)*3|0)|0,ae=lp(($|v)&~J,ae&~(se()|0),b)|0,de=xe,ae|0}else C=0;while(!1);if(w=op(v,y,P)|0,!w){C?(Fc(P,J,ae),$=5):(ap(P,J,ae),$=6);e:do if(mi(k)|0)if(!V)v=5;else for(w=1;;){if(k=Jt(7,0,(15-w|0)*3|0)|0,!((k&v|0)==0&((se()|0)&y|0)==0)){v=2;break e}if(w>>>0<V>>>0)w=w+1|0;else{v=5;break}}else v=2;while(!1);Vc(b|0,-1,v<<2|0)|0;e:do if(C)for(P=0;;){if(k=ae+(P<<4)|0,jc(k,_[J>>2]|0)|0,k=_[k>>2]|0,V=_[b>>2]|0,(V|0)==-1|(V|0)==(k|0))w=b;else{C=0;do{if(C=C+1|0,C>>>0>=v>>>0){w=1;break e}w=b+(C<<2)|0,V=_[w>>2]|0}while(!((V|0)==-1|(V|0)==(k|0)))}if(_[w>>2]=k,P=P+1|0,P>>>0>=$>>>0){w=0;break}}else for(P=0;;){if(k=ae+(P<<4)|0,Xr(k,_[J>>2]|0,0,1)|0,k=_[k>>2]|0,V=_[b>>2]|0,(V|0)==-1|(V|0)==(k|0))w=b;else{C=0;do{if(C=C+1|0,C>>>0>=v>>>0){w=1;break e}w=b+(C<<2)|0,V=_[w>>2]|0}while(!((V|0)==-1|(V|0)==(k|0)))}if(_[w>>2]=k,P=P+1|0,P>>>0>=$>>>0){w=0;break}}while(!1)}return ae=w,de=xe,ae|0}function tb(){return 12}function cp(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0,$=0;if(v>>>0>15)return V=4,V|0;if(Jt(v|0,0,52)|0,V=se()|0|134225919,!v){b=0,w=0;do mi(w)|0&&(Jt(w|0,0,45)|0,k=V|(se()|0),v=y+(b<<3)|0,_[v>>2]=-1,_[v+4>>2]=k,b=b+1|0),w=w+1|0;while((w|0)!=122);return b=0,b|0}b=0,k=0;do{if(mi(k)|0){for(Jt(k|0,0,45)|0,w=1,C=-1,P=V|(se()|0);$=Jt(7,0,(15-w|0)*3|0)|0,C=C&~$,P=P&~(se()|0),(w|0)!=(v|0);)w=w+1|0;$=y+(b<<3)|0,_[$>>2]=C,_[$+4>>2]=P,b=b+1|0}k=k+1|0}while((k|0)!=122);return b=0,b|0}function nb(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0;if(ut=de,de=de+16|0,nt=ut,At=Gt(v|0,y|0,52)|0,se()|0,At=At&15,b>>>0>15)return At=4,de=ut,At|0;if((At|0)<(b|0))return At=12,de=ut,At|0;if((At|0)!=(b|0))if(P=Jt(b|0,0,52)|0,P=P|v,V=se()|0|y&-15728641,(At|0)>(b|0)){$=b;do $e=Jt(7,0,(14-$|0)*3|0)|0,$=$+1|0,P=$e|P,V=se()|0|V;while(($|0)<(At|0));$e=P}else $e=P;else $e=v,V=y;Oe=Gt($e|0,V|0,45)|0,se()|0;e:do if(mi(Oe&127)|0){if($=Gt($e|0,V|0,52)|0,se()|0,$=$&15,$|0)for(P=1;;){if(Oe=Jt(7,0,(15-P|0)*3|0)|0,!((Oe&$e|0)==0&((se()|0)&V|0)==0)){J=33;break e}if(P>>>0<$>>>0)P=P+1|0;else break}if(Oe=w,_[Oe>>2]=0,_[Oe+4>>2]=0,(At|0)>(b|0)){for(Oe=y&-15728641,De=At;;){if(ke=De,De=De+-1|0,De>>>0>15|(At|0)<(De|0)){J=19;break}if((At|0)!=(De|0))if(P=Jt(De|0,0,52)|0,P=P|v,$=se()|0|Oe,(At|0)<(ke|0))xe=P;else{J=De;do xe=Jt(7,0,(14-J|0)*3|0)|0,J=J+1|0,P=xe|P,$=se()|0|$;while((J|0)<(At|0));xe=P}else xe=v,$=y;if(ae=Gt(xe|0,$|0,45)|0,se()|0,!(mi(ae&127)|0))P=0;else{ae=Gt(xe|0,$|0,52)|0,se()|0,ae=ae&15;t:do if(!ae)P=0;else for(J=1;;){if(P=Gt(xe|0,$|0,(15-J|0)*3|0)|0,se()|0,P=P&7,P|0)break t;if(J>>>0<ae>>>0)J=J+1|0;else{P=0;break}}while(!1);P=(P|0)==0&1}if($=Gt(v|0,y|0,(15-ke|0)*3|0)|0,se()|0,$=$&7,($|0)==7){C=5,J=42;break}if(P=(P|0)!=0,($|0)==1&P){C=5,J=42;break}if(xe=$+((($|0)!=0&P)<<31>>31)|0,xe|0&&(J=At-ke|0,J=Eu(7,0,J,((J|0)<0)<<31>>31)|0,ae=se()|0,P?(P=gs(J|0,ae|0,5,0)|0,P=fn(P|0,se()|0,-5,-1)|0,P=Ru(P|0,se()|0,6,0)|0,P=fn(P|0,se()|0,1,0)|0,$=se()|0):(P=J,$=ae),ke=xe+-1|0,ke=gs(J|0,ae|0,ke|0,((ke|0)<0)<<31>>31|0)|0,ke=fn(P|0,$|0,ke|0,se()|0)|0,xe=se()|0,ae=w,ae=fn(ke|0,xe|0,_[ae>>2]|0,_[ae+4>>2]|0)|0,xe=se()|0,ke=w,_[ke>>2]=ae,_[ke+4>>2]=xe),(De|0)<=(b|0)){J=37;break}}if((J|0)==19)Dt(27795,27122,1367,27158);else if((J|0)==37){k=w,C=_[k+4>>2]|0,k=_[k>>2]|0;break}else if((J|0)==42)return de=ut,C|0}else C=0,k=0}else J=33;while(!1);e:do if((J|0)==33)if(Oe=w,_[Oe>>2]=0,_[Oe+4>>2]=0,(At|0)>(b|0)){for(P=At;;){if(C=Gt(v|0,y|0,(15-P|0)*3|0)|0,se()|0,C=C&7,(C|0)==7){C=5;break}if(k=At-P|0,k=Eu(7,0,k,((k|0)<0)<<31>>31)|0,C=gs(k|0,se()|0,C|0,0)|0,k=se()|0,Oe=w,k=fn(_[Oe>>2]|0,_[Oe+4>>2]|0,C|0,k|0)|0,C=se()|0,Oe=w,_[Oe>>2]=k,_[Oe+4>>2]=C,P=P+-1|0,(P|0)<=(b|0))break e}return de=ut,C|0}else C=0,k=0;while(!1);return H0($e,V,At,nt)|0&&Dt(27795,27122,1327,27173),At=nt,nt=_[At+4>>2]|0,((C|0)>-1|(C|0)==-1&k>>>0>4294967295)&((nt|0)>(C|0)|((nt|0)==(C|0)?(_[At>>2]|0)>>>0>k>>>0:0))?(At=0,de=ut,At|0):(Dt(27795,27122,1407,27158),0)}function Nw(v,y,b,w,C,P){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0,P=P|0;var k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0;if(xe=de,de=de+16|0,k=xe,C>>>0>15)return P=4,de=xe,P|0;if(V=Gt(b|0,w|0,52)|0,se()|0,V=V&15,(V|0)>(C|0))return P=12,de=xe,P|0;if(H0(b,w,C,k)|0&&Dt(27795,27122,1327,27173),ae=k,J=_[ae+4>>2]|0,!(((y|0)>-1|(y|0)==-1&v>>>0>4294967295)&((J|0)>(y|0)|((J|0)==(y|0)?(_[ae>>2]|0)>>>0>v>>>0:0))))return P=2,de=xe,P|0;ae=C-V|0,C=Jt(C|0,0,52)|0,$=se()|0|w&-15728641,J=P,_[J>>2]=C|b,_[J+4>>2]=$,J=Gt(b|0,w|0,45)|0,se()|0;e:do if(mi(J&127)|0){if(V|0)for(k=1;;){if(J=Jt(7,0,(15-k|0)*3|0)|0,!((J&b|0)==0&((se()|0)&w|0)==0))break e;if(k>>>0<V>>>0)k=k+1|0;else break}if((ae|0)<1)return P=0,de=xe,P|0;for(J=V^15,w=-1,$=1,k=1;;){V=ae-$|0,V=Eu(7,0,V,((V|0)<0)<<31>>31)|0,b=se()|0;do if(k)if(k=gs(V|0,b|0,5,0)|0,k=fn(k|0,se()|0,-5,-1)|0,k=Ru(k|0,se()|0,6,0)|0,C=se()|0,(y|0)>(C|0)|(y|0)==(C|0)&v>>>0>k>>>0){y=fn(v|0,y|0,-1,-1)|0,y=$s(y|0,se()|0,k|0,C|0)|0,k=se()|0,ke=P,Oe=_[ke>>2]|0,ke=_[ke+4>>2]|0,$e=(J+w|0)*3|0,De=Jt(7,0,$e|0)|0,ke=ke&~(se()|0),w=Ru(y|0,k|0,V|0,b|0)|0,v=se()|0,C=fn(w|0,v|0,2,0)|0,$e=Jt(C|0,se()|0,$e|0)|0,ke=se()|0|ke,C=P,_[C>>2]=$e|Oe&~De,_[C+4>>2]=ke,v=gs(w|0,v|0,V|0,b|0)|0,v=$s(y|0,k|0,v|0,se()|0)|0,k=0,y=se()|0;break}else{$e=P,De=_[$e>>2]|0,$e=_[$e+4>>2]|0,Oe=Jt(7,0,(J+w|0)*3|0)|0,$e=$e&~(se()|0),k=P,_[k>>2]=De&~Oe,_[k+4>>2]=$e,k=1;break}else De=P,C=_[De>>2]|0,De=_[De+4>>2]|0,w=(J+w|0)*3|0,ke=Jt(7,0,w|0)|0,De=De&~(se()|0),$e=Ru(v|0,y|0,V|0,b|0)|0,k=se()|0,w=Jt($e|0,k|0,w|0)|0,De=se()|0|De,Oe=P,_[Oe>>2]=w|C&~ke,_[Oe+4>>2]=De,k=gs($e|0,k|0,V|0,b|0)|0,v=$s(v|0,y|0,k|0,se()|0)|0,k=0,y=se()|0;while(!1);if((ae|0)>($|0))w=~$,$=$+1|0;else{y=0;break}}return de=xe,y|0}while(!1);if((ae|0)<1)return $e=0,de=xe,$e|0;for(C=V^15,k=1;;)if(Oe=ae-k|0,Oe=Eu(7,0,Oe,((Oe|0)<0)<<31>>31)|0,$e=se()|0,$=P,b=_[$>>2]|0,$=_[$+4>>2]|0,V=(C-k|0)*3|0,w=Jt(7,0,V|0)|0,$=$&~(se()|0),ke=Ru(v|0,y|0,Oe|0,$e|0)|0,De=se()|0,V=Jt(ke|0,De|0,V|0)|0,$=se()|0|$,J=P,_[J>>2]=V|b&~w,_[J+4>>2]=$,$e=gs(ke|0,De|0,Oe|0,$e|0)|0,v=$s(v|0,y|0,$e|0,se()|0)|0,y=se()|0,(ae|0)<=(k|0)){y=0;break}else k=k+1|0;return de=xe,y|0}function ud(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0;C=Gt(y|0,b|0,52)|0,se()|0,C=C&15,(y|0)==0&(b|0)==0|((w|0)>15|(C|0)>(w|0))?(P=-1,y=-1,b=0,C=0):(y=Qx(y,b,C+1|0,w)|0,k=(se()|0)&-15728641,b=Jt(w|0,0,52)|0,b=y|b,k=k|(se()|0),y=(yi(b,k)|0)==0,P=C,y=y?-1:w,C=k),k=v,_[k>>2]=b,_[k+4>>2]=C,_[v+8>>2]=P,_[v+12>>2]=y}function up(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0;if(C=Gt(v|0,y|0,52)|0,se()|0,C=C&15,P=w+8|0,_[P>>2]=C,(v|0)==0&(y|0)==0|((b|0)>15|(C|0)>(b|0))){b=w,_[b>>2]=0,_[b+4>>2]=0,_[P>>2]=-1,_[w+12>>2]=-1;return}if(v=Qx(v,y,C+1|0,b)|0,P=(se()|0)&-15728641,C=Jt(b|0,0,52)|0,C=v|C,P=P|(se()|0),v=w,_[v>>2]=C,_[v+4>>2]=P,v=w+12|0,yi(C,P)|0){_[v>>2]=b;return}else{_[v>>2]=-1;return}}function W0(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0;if(b=v,y=_[b>>2]|0,b=_[b+4>>2]|0,!((y|0)==0&(b|0)==0)&&(w=Gt(y|0,b|0,52)|0,se()|0,w=w&15,V=Jt(1,0,(w^15)*3|0)|0,y=fn(V|0,se()|0,y|0,b|0)|0,b=se()|0,V=v,_[V>>2]=y,_[V+4>>2]=b,V=v+8|0,k=_[V>>2]|0,!((w|0)<(k|0)))){for($=v+12|0,P=w;;){if((P|0)==(k|0)){w=5;break}if(J=(P|0)==(_[$>>2]|0),C=(15-P|0)*3|0,w=Gt(y|0,b|0,C|0)|0,se()|0,w=w&7,J&((w|0)==1&!0)){w=7;break}if(!((w|0)==7&!0)){w=10;break}if(J=Jt(1,0,C|0)|0,y=fn(y|0,b|0,J|0,se()|0)|0,b=se()|0,J=v,_[J>>2]=y,_[J+4>>2]=b,(P|0)>(k|0))P=P+-1|0;else{w=10;break}}if((w|0)==5){J=v,_[J>>2]=0,_[J+4>>2]=0,_[V>>2]=-1,_[$>>2]=-1;return}else if((w|0)==7){k=Jt(1,0,C|0)|0,k=fn(y|0,b|0,k|0,se()|0)|0,V=se()|0,J=v,_[J>>2]=k,_[J+4>>2]=V,_[$>>2]=P+-1;return}else if((w|0)==10)return}}function Bm(v){v=+v;var y=0;return y=v<0?v+6.283185307179586:v,+(v>=6.283185307179586?y+-6.283185307179586:y)}function Hl(v,y){return v=v|0,y=y|0,+Ln(+(+me[v>>3]-+me[y>>3]))<17453292519943298e-27?(y=+Ln(+(+me[v+8>>3]-+me[y+8>>3]))<17453292519943298e-27,y|0):(y=0,y|0)}function Ho(v,y){switch(v=+v,y=y|0,y|0){case 1:{v=v<0?v+6.283185307179586:v;break}case 2:{v=v>0?v+-6.283185307179586:v;break}}return+v}function Rw(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0;return C=+me[y>>3],w=+me[v>>3],P=+la(+((C-w)*.5)),b=+la(+((+me[y+8>>3]-+me[v+8>>3])*.5)),b=P*P+b*(+ka(+C)*+ka(+w)*b),+(+ts(+ +oa(+b),+ +oa(+(1-b)))*2)}function Um(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0;return C=+me[y>>3],w=+me[v>>3],P=+la(+((C-w)*.5)),b=+la(+((+me[y+8>>3]-+me[v+8>>3])*.5)),b=P*P+b*(+ka(+C)*+ka(+w)*b),+(+ts(+ +oa(+b),+ +oa(+(1-b)))*2*6371.007180918475)}function _I(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0;return C=+me[y>>3],w=+me[v>>3],P=+la(+((C-w)*.5)),b=+la(+((+me[y+8>>3]-+me[v+8>>3])*.5)),b=P*P+b*(+ka(+C)*+ka(+w)*b),+(+ts(+ +oa(+b),+ +oa(+(1-b)))*2*6371.007180918475*1e3)}function xI(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0;return P=+me[y>>3],w=+ka(+P),C=+me[y+8>>3]-+me[v+8>>3],k=w*+la(+C),b=+me[v>>3],+ +ts(+k,+(+la(+P)*+ka(+b)-+ka(+C)*(w*+la(+b))))}function bI(v,y,b,w){v=v|0,y=+y,b=+b,w=w|0;var C=0,P=0,k=0,V=0;if(b<1e-16){_[w>>2]=_[v>>2],_[w+4>>2]=_[v+4>>2],_[w+8>>2]=_[v+8>>2],_[w+12>>2]=_[v+12>>2];return}P=y<0?y+6.283185307179586:y,P=y>=6.283185307179586?P+-6.283185307179586:P;do if(P<1e-16)y=+me[v>>3]+b,me[w>>3]=y,C=w;else{if(C=+Ln(+(P+-3.141592653589793))<1e-16,y=+me[v>>3],C){y=y-b,me[w>>3]=y,C=w;break}if(k=+ka(+b),b=+la(+b),y=k*+la(+y)+ +ka(+P)*(b*+ka(+y)),y=y>1?1:y,y=+ah(+(y<-1?-1:y)),me[w>>3]=y,+Ln(+(y+-1.5707963267948966))<1e-16){me[w>>3]=1.5707963267948966,me[w+8>>3]=0;return}if(+Ln(+(y+1.5707963267948966))<1e-16){me[w>>3]=-1.5707963267948966,me[w+8>>3]=0;return}if(V=1/+ka(+y),P=b*+la(+P)*V,b=+me[v>>3],y=V*((k-+la(+y)*+la(+b))/+ka(+b)),k=P>1?1:P,y=y>1?1:y,y=+me[v+8>>3]+ +ts(+(k<-1?-1:k),+(y<-1?-1:y)),y>3.141592653589793)do y=y+-6.283185307179586;while(y>3.141592653589793);if(y<-3.141592653589793)do y=y+6.283185307179586;while(y<-3.141592653589793);me[w+8>>3]=y;return}while(!1);if(+Ln(+(y+-1.5707963267948966))<1e-16){me[C>>3]=1.5707963267948966,me[w+8>>3]=0;return}if(+Ln(+(y+1.5707963267948966))<1e-16){me[C>>3]=-1.5707963267948966,me[w+8>>3]=0;return}if(y=+me[v+8>>3],y>3.141592653589793)do y=y+-6.283185307179586;while(y>3.141592653589793);if(y<-3.141592653589793)do y=y+6.283185307179586;while(y<-3.141592653589793);me[w+8>>3]=y}function ab(v,y){return v=v|0,y=y|0,v>>>0>15?(y=4,y|0):(me[y>>3]=+me[20656+(v<<3)>>3],y=0,y|0)}function Pw(v,y){return v=v|0,y=y|0,v>>>0>15?(y=4,y|0):(me[y>>3]=+me[20784+(v<<3)>>3],y=0,y|0)}function ib(v,y){return v=v|0,y=y|0,v>>>0>15?(y=4,y|0):(me[y>>3]=+me[20912+(v<<3)>>3],y=0,y|0)}function Bc(v,y){return v=v|0,y=y|0,v>>>0>15?(y=4,y|0):(me[y>>3]=+me[21040+(v<<3)>>3],y=0,y|0)}function dp(v,y){v=v|0,y=y|0;var b=0;return v>>>0>15?(y=4,y|0):(b=Eu(7,0,v,((v|0)<0)<<31>>31)|0,b=gs(b|0,se()|0,120,0)|0,v=se()|0,_[y>>2]=b|2,_[y+4>>2]=v,y=0,y|0)}function yl(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0;return ke=+me[y>>3],ae=+me[v>>3],$=+la(+((ke-ae)*.5)),P=+me[y+8>>3],J=+me[v+8>>3],k=+la(+((P-J)*.5)),V=+ka(+ae),xe=+ka(+ke),k=$*$+k*(xe*V*k),k=+ts(+ +oa(+k),+ +oa(+(1-k)))*2,$=+me[b>>3],ke=+la(+(($-ke)*.5)),w=+me[b+8>>3],P=+la(+((w-P)*.5)),C=+ka(+$),P=ke*ke+P*(xe*C*P),P=+ts(+ +oa(+P),+ +oa(+(1-P)))*2,$=+la(+((ae-$)*.5)),w=+la(+((J-w)*.5)),w=$*$+w*(V*C*w),w=+ts(+ +oa(+w),+ +oa(+(1-w)))*2,C=(k+P+w)*.5,+(+Uo(+ +oa(+(+hr(+(C*.5))*+hr(+((C-k)*.5))*+hr(+((C-P)*.5))*+hr(+((C-w)*.5)))))*4)}function ph(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0;if(V=de,de=de+192|0,P=V+168|0,k=V,C=hh(v,y,P)|0,C|0)return b=C,de=V,b|0;if(fh(v,y,k)|0&&Dt(27795,27190,415,27199),y=_[k>>2]|0,(y|0)>0){if(w=+yl(k+8|0,k+8+(((y|0)!=1&1)<<4)|0,P)+0,(y|0)!=1){v=1;do C=v,v=v+1|0,w=w+ +yl(k+8+(C<<4)|0,k+8+(((v|0)%(y|0)|0)<<4)|0,P);while((v|0)<(y|0))}}else w=0;return me[b>>3]=w,b=0,de=V,b|0}function sb(v,y,b){return v=v|0,y=y|0,b=b|0,v=ph(v,y,b)|0,v|0||(me[b>>3]=+me[b>>3]*6371.007180918475*6371.007180918475),v|0}function N1(v,y,b){return v=v|0,y=y|0,b=b|0,v=ph(v,y,b)|0,v|0||(me[b>>3]=+me[b>>3]*6371.007180918475*6371.007180918475*1e3*1e3),v|0}function R1(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0;if(V=de,de=de+176|0,k=V,v=Ct(v,y,k)|0,v|0)return k=v,de=V,k|0;if(me[b>>3]=0,v=_[k>>2]|0,(v|0)<=1)return k=0,de=V,k|0;y=v+-1|0,v=0,w=+me[k+8>>3],C=+me[k+16>>3],P=0;do v=v+1|0,J=w,w=+me[k+8+(v<<4)>>3],ae=+la(+((w-J)*.5)),$=C,C=+me[k+8+(v<<4)+8>>3],$=+la(+((C-$)*.5)),$=ae*ae+$*(+ka(+w)*+ka(+J)*$),P=P+ +ts(+ +oa(+$),+ +oa(+(1-$)))*2;while((v|0)<(y|0));return me[b>>3]=P,k=0,de=V,k|0}function rb(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0;if(V=de,de=de+176|0,k=V,v=Ct(v,y,k)|0,v|0)return k=v,P=+me[b>>3],P=P*6371.007180918475,me[b>>3]=P,de=V,k|0;if(me[b>>3]=0,v=_[k>>2]|0,(v|0)<=1)return k=0,P=0,P=P*6371.007180918475,me[b>>3]=P,de=V,k|0;y=v+-1|0,v=0,w=+me[k+8>>3],C=+me[k+16>>3],P=0;do v=v+1|0,J=w,w=+me[k+8+(v<<4)>>3],ae=+la(+((w-J)*.5)),$=C,C=+me[k+8+(v<<4)+8>>3],$=+la(+((C-$)*.5)),$=ae*ae+$*(+ka(+J)*+ka(+w)*$),P=P+ +ts(+ +oa(+$),+ +oa(+(1-$)))*2;while((v|0)!=(y|0));return me[b>>3]=P,k=0,ae=P,ae=ae*6371.007180918475,me[b>>3]=ae,de=V,k|0}function hp(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0;if(V=de,de=de+176|0,k=V,v=Ct(v,y,k)|0,v|0)return k=v,P=+me[b>>3],P=P*6371.007180918475,P=P*1e3,me[b>>3]=P,de=V,k|0;if(me[b>>3]=0,v=_[k>>2]|0,(v|0)<=1)return k=0,P=0,P=P*6371.007180918475,P=P*1e3,me[b>>3]=P,de=V,k|0;y=v+-1|0,v=0,w=+me[k+8>>3],C=+me[k+16>>3],P=0;do v=v+1|0,J=w,w=+me[k+8+(v<<4)>>3],ae=+la(+((w-J)*.5)),$=C,C=+me[k+8+(v<<4)+8>>3],$=+la(+((C-$)*.5)),$=ae*ae+$*(+ka(+J)*+ka(+w)*$),P=P+ +ts(+ +oa(+$),+ +oa(+(1-$)))*2;while((v|0)!=(y|0));return me[b>>3]=P,k=0,ae=P,ae=ae*6371.007180918475,ae=ae*1e3,me[b>>3]=ae,de=V,k|0}function Iw(v){v=v|0;var y=0,b=0,w=0;return y=Ko(1,12)|0,y||Dt(27280,27235,49,27293),b=v+4|0,w=_[b>>2]|0,w|0?(w=w+8|0,_[w>>2]=y,_[b>>2]=y,y|0):(_[v>>2]|0&&Dt(27310,27235,61,27333),w=v,_[w>>2]=y,_[b>>2]=y,y|0)}function P1(v,y){v=v|0,y=y|0;var b=0,w=0;return w=Nu(24)|0,w||Dt(27347,27235,78,27361),_[w>>2]=_[y>>2],_[w+4>>2]=_[y+4>>2],_[w+8>>2]=_[y+8>>2],_[w+12>>2]=_[y+12>>2],_[w+16>>2]=0,y=v+4|0,b=_[y>>2]|0,b|0?(_[b+16>>2]=w,_[y>>2]=w,w|0):(_[v>>2]|0&&Dt(27376,27235,82,27361),_[v>>2]=w,_[y>>2]=w,w|0)}function fp(v){v=v|0;var y=0,b=0,w=0,C=0;if(v)for(w=1;;){if(y=_[v>>2]|0,y|0)do{if(b=_[y>>2]|0,b|0)do C=b,b=_[b+16>>2]|0,Un(C);while((b|0)!=0);C=y,y=_[y+8>>2]|0,Un(C)}while((y|0)!=0);if(y=v,v=_[v+8>>2]|0,w||Un(y),v)w=0;else break}}function SI(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0,Ke=0,en=0,wn=0,vn=0,ua=0,ea=0,wa=0,Qn=0,Cn=0,tn=0,Gn=0,Ia=0,Jn=0;if(C=v+8|0,_[C>>2]|0)return Jn=1,Jn|0;if(w=_[v>>2]|0,!w)return Jn=0,Jn|0;y=w,b=0;do b=b+1|0,y=_[y+8>>2]|0;while((y|0)!=0);if(b>>>0<2)return Jn=0,Jn|0;Gn=Nu(b<<2)|0,Gn||Dt(27396,27235,317,27415),tn=Nu(b<<5)|0,tn||Dt(27437,27235,321,27415),_[v>>2]=0,wn=v+4|0,_[wn>>2]=0,_[C>>2]=0,b=0,Cn=0,en=0,xe=0;e:for(;;){if(ae=_[w>>2]|0,ae){P=0,k=ae;do{if($=+me[k+8>>3],y=k,k=_[k+16>>2]|0,J=(k|0)==0,C=J?ae:k,V=+me[C+8>>3],+Ln(+($-V))>3.141592653589793){Jn=14;break}P=P+(V-$)*(+me[y>>3]+ +me[C>>3])}while(!J);if((Jn|0)==14){Jn=0,P=0,y=ae;do Ke=+me[y+8>>3],Qn=y+16|0,wa=_[Qn>>2]|0,wa=(wa|0)==0?ae:wa,lt=+me[wa+8>>3],P=P+(+me[y>>3]+ +me[wa>>3])*((lt<0?lt+6.283185307179586:lt)-(Ke<0?Ke+6.283185307179586:Ke)),y=_[((y|0)==0?w:Qn)>>2]|0;while((y|0)!=0)}P>0?(_[Gn+(Cn<<2)>>2]=w,Cn=Cn+1|0,C=en,y=xe):Jn=19}else Jn=19;if((Jn|0)==19){Jn=0;do if(b){if(y=b+8|0,_[y>>2]|0){Jn=21;break e}if(b=Ko(1,12)|0,!b){Jn=23;break e}_[y>>2]=b,C=b+4|0,k=b,y=xe}else if(xe){C=wn,k=xe+8|0,y=w,b=v;break}else if(_[v>>2]|0){Jn=27;break e}else{C=wn,k=v,y=w,b=v;break}while(!1);if(_[k>>2]=w,_[C>>2]=w,k=tn+(en<<5)|0,J=_[w>>2]|0,J){for(ae=tn+(en<<5)+8|0,me[ae>>3]=17976931348623157e292,xe=tn+(en<<5)+24|0,me[xe>>3]=17976931348623157e292,me[k>>3]=-17976931348623157e292,ke=tn+(en<<5)+16|0,me[ke>>3]=-17976931348623157e292,At=17976931348623157e292,ut=-17976931348623157e292,C=0,De=J,$=17976931348623157e292,$e=17976931348623157e292,nt=-17976931348623157e292,V=-17976931348623157e292;P=+me[De>>3],Ke=+me[De+8>>3],De=_[De+16>>2]|0,Oe=(De|0)==0,lt=+me[(Oe?J:De)+8>>3],P<$&&(me[ae>>3]=P,$=P),Ke<$e&&(me[xe>>3]=Ke,$e=Ke),P>nt?me[k>>3]=P:P=nt,Ke>V&&(me[ke>>3]=Ke,V=Ke),At=Ke>0&Ke<At?Ke:At,ut=Ke<0&Ke>ut?Ke:ut,C=C|+Ln(+(Ke-lt))>3.141592653589793,!Oe;)nt=P;C&&(me[ke>>3]=ut,me[xe>>3]=At)}else _[k>>2]=0,_[k+4>>2]=0,_[k+8>>2]=0,_[k+12>>2]=0,_[k+16>>2]=0,_[k+20>>2]=0,_[k+24>>2]=0,_[k+28>>2]=0;C=en+1|0}if(Qn=w+8|0,w=_[Qn>>2]|0,_[Qn>>2]=0,w)en=C,xe=y;else{Jn=45;break}}if((Jn|0)==21)Dt(27213,27235,35,27247);else if((Jn|0)==23)Dt(27267,27235,37,27247);else if((Jn|0)==27)Dt(27310,27235,61,27333);else if((Jn|0)==45){e:do if((Cn|0)>0){for(Qn=(C|0)==0,ea=C<<2,wa=(v|0)==0,ua=0,y=0;;){if(vn=_[Gn+(ua<<2)>>2]|0,Qn)Jn=73;else{if(en=Nu(ea)|0,!en){Jn=50;break}if(wn=Nu(ea)|0,!wn){Jn=52;break}t:do if(wa)b=0;else{for(C=0,b=0,k=v;w=tn+(C<<5)|0,Wo(_[k>>2]|0,w,_[vn>>2]|0)|0?(_[en+(b<<2)>>2]=k,_[wn+(b<<2)>>2]=w,Oe=b+1|0):Oe=b,k=_[k+8>>2]|0,k;)C=C+1|0,b=Oe;if((Oe|0)>0)if(w=_[en>>2]|0,(Oe|0)==1)b=w;else for(ke=0,De=-1,b=w,xe=w;;){for(J=_[xe>>2]|0,w=0,k=0;C=_[_[en+(k<<2)>>2]>>2]|0,(C|0)==(J|0)?ae=w:ae=w+((Wo(C,_[wn+(k<<2)>>2]|0,_[J>>2]|0)|0)&1)|0,k=k+1|0,(k|0)!=(Oe|0);)w=ae;if(C=(ae|0)>(De|0),b=C?xe:b,w=ke+1|0,(w|0)==(Oe|0))break t;ke=w,De=C?ae:De,xe=_[en+(w<<2)>>2]|0}else b=0}while(!1);if(Un(en),Un(wn),b){if(C=b+4|0,w=_[C>>2]|0,w)b=w+8|0;else if(_[b>>2]|0){Jn=70;break}_[b>>2]=vn,_[C>>2]=vn}else Jn=73}if((Jn|0)==73){if(Jn=0,y=_[vn>>2]|0,y|0)do wn=y,y=_[y+16>>2]|0,Un(wn);while((y|0)!=0);Un(vn),y=1}if(ua=ua+1|0,(ua|0)>=(Cn|0)){Ia=y;break e}}(Jn|0)==50?Dt(27452,27235,249,27471):(Jn|0)==52?Dt(27490,27235,252,27471):(Jn|0)==70&&Dt(27310,27235,61,27333)}else Ia=0;while(!1);return Un(Gn),Un(tn),Jn=Ia,Jn|0}return 0}function Wo(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0;if(!(ql(y,b)|0)||(y=lh(y)|0,w=+me[b>>3],C=+me[b+8>>3],C=y&C<0?C+6.283185307179586:C,v=_[v>>2]|0,!v))return v=0,v|0;if(y){y=0,J=C,b=v;e:for(;;){for(;k=+me[b>>3],C=+me[b+8>>3],b=b+16|0,ae=_[b>>2]|0,ae=(ae|0)==0?v:ae,P=+me[ae>>3],V=+me[ae+8>>3],k>P?($=k,k=V):($=P,P=k,k=C,C=V),w=w==P|w==$?w+2220446049250313e-31:w,!!(w<P|w>$);)if(b=_[b>>2]|0,!b){b=22;break e}if(V=k<0?k+6.283185307179586:k,k=C<0?C+6.283185307179586:C,J=V==J|k==J?J+-2220446049250313e-31:J,$=V+(k-V)*((w-P)/($-P)),($<0?$+6.283185307179586:$)>J&&(y=y^1),b=_[b>>2]|0,!b){b=22;break}}if((b|0)==22)return y|0}else{y=0,J=C,b=v;e:for(;;){for(;k=+me[b>>3],C=+me[b+8>>3],b=b+16|0,ae=_[b>>2]|0,ae=(ae|0)==0?v:ae,P=+me[ae>>3],V=+me[ae+8>>3],k>P?($=k,k=V):($=P,P=k,k=C,C=V),w=w==P|w==$?w+2220446049250313e-31:w,!!(w<P|w>$);)if(b=_[b>>2]|0,!b){b=22;break e}if(J=k==J|C==J?J+-2220446049250313e-31:J,k+(C-k)*((w-P)/($-P))>J&&(y=y^1),b=_[b>>2]|0,!b){b=22;break}}if((b|0)==22)return y|0}return 0}function Uc(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0;if(ut=de,de=de+32|0,At=ut+16|0,nt=ut,P=Gt(v|0,y|0,52)|0,se()|0,P=P&15,De=Gt(b|0,w|0,52)|0,se()|0,(P|0)!=(De&15|0))return At=12,de=ut,At|0;if(J=Gt(v|0,y|0,45)|0,se()|0,J=J&127,ae=Gt(b|0,w|0,45)|0,se()|0,ae=ae&127,J>>>0>121|ae>>>0>121)return At=5,de=ut,At|0;if(De=(J|0)!=(ae|0),De){if(V=rh(J,ae)|0,(V|0)==7)return At=1,de=ut,At|0;$=rh(ae,J)|0,($|0)==7?Dt(27514,27538,161,27548):(Oe=V,k=$)}else Oe=0,k=0;xe=mi(J)|0,ke=mi(ae)|0,_[At>>2]=0,_[At+4>>2]=0,_[At+8>>2]=0,_[At+12>>2]=0;do if(Oe){if(ae=_[4272+(J*28|0)+(Oe<<2)>>2]|0,V=(ae|0)>0,ke)if(V){J=0,$=b,V=w;do $=yI($,V)|0,V=se()|0,k=Ir(k)|0,(k|0)==1&&(k=Ir(1)|0),J=J+1|0;while((J|0)!=(ae|0));ae=k,J=$,$=V}else ae=k,J=b,$=w;else if(V){J=0,$=b,V=w;do $=eb($,V)|0,V=se()|0,k=Ir(k)|0,J=J+1|0;while((J|0)!=(ae|0));ae=k,J=$,$=V}else ae=k,J=b,$=w;if(C1(J,$,At)|0,De||Dt(27563,27538,191,27548),V=(xe|0)!=0,k=(ke|0)!=0,V&k&&Dt(27590,27538,192,27548),V){if(k=qo(v,y)|0,(k|0)==7){P=5;break}if(Ut[22e3+(k*7|0)+Oe>>0]|0){P=1;break}$=_[21168+(k*28|0)+(Oe<<2)>>2]|0,J=$}else if(k){if(k=qo(J,$)|0,(k|0)==7){P=5;break}if(Ut[22e3+(k*7|0)+ae>>0]|0){P=1;break}J=0,$=_[21168+(ae*28|0)+(k<<2)>>2]|0}else J=0,$=0;if((J|$|0)<0)P=5;else{if(($|0)>0){V=At+4|0,k=0;do np(V),k=k+1|0;while((k|0)!=($|0))}if(_[nt>>2]=0,_[nt+4>>2]=0,_[nt+8>>2]=0,z0(nt,Oe),P|0)for(;Qr(P)|0?Su(nt):Oc(nt),(P|0)>1;)P=P+-1|0;if((J|0)>0){P=0;do np(nt),P=P+1|0;while((P|0)!=(J|0))}$e=At+4|0,bs($e,nt,$e),ms($e),$e=51}}else if(C1(b,w,At)|0,(xe|0)!=0&(ke|0)!=0)if((ae|0)!=(J|0)&&Dt(27621,27538,261,27548),k=qo(v,y)|0,P=qo(b,w)|0,(k|0)==7|(P|0)==7)P=5;else if(Ut[22e3+(k*7|0)+P>>0]|0)P=1;else if(k=_[21168+(k*28|0)+(P<<2)>>2]|0,(k|0)>0){V=At+4|0,P=0;do np(V),P=P+1|0;while((P|0)!=(k|0));$e=51}else $e=51;else $e=51;while(!1);return($e|0)==51&&(P=At+4|0,_[C>>2]=_[P>>2],_[C+4>>2]=_[P+4>>2],_[C+8>>2]=_[P+8>>2],P=0),At=P,de=ut,At|0}function wu(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0;if($e=de,de=de+48|0,J=$e+36|0,k=$e+24|0,V=$e+12|0,$=$e,C=Gt(v|0,y|0,52)|0,se()|0,C=C&15,ke=Gt(v|0,y|0,45)|0,se()|0,ke=ke&127,ke>>>0>121)return w=5,de=$e,w|0;if(ae=mi(ke)|0,Jt(C|0,0,52)|0,nt=se()|0|134225919,P=w,_[P>>2]=-1,_[P+4>>2]=nt,!C)return C=od(b)|0,(C|0)==7||(C=sd(ke,C)|0,(C|0)==127)?(nt=1,de=$e,nt|0):(De=Jt(C|0,0,45)|0,Oe=se()|0,ke=w,Oe=_[ke+4>>2]&-1040385|Oe,nt=w,_[nt>>2]=_[ke>>2]|De,_[nt+4>>2]=Oe,nt=0,de=$e,nt|0);for(_[J>>2]=_[b>>2],_[J+4>>2]=_[b+4>>2],_[J+8>>2]=_[b+8>>2],b=C;;){if(P=b,b=b+-1|0,_[k>>2]=_[J>>2],_[k+4>>2]=_[J+4>>2],_[k+8>>2]=_[J+8>>2],Qr(P)|0){if(C=U0(J)|0,C|0){b=13;break}_[V>>2]=_[J>>2],_[V+4>>2]=_[J+4>>2],_[V+8>>2]=_[J+8>>2],Su(V)}else{if(C=ep(J)|0,C|0){b=13;break}_[V>>2]=_[J>>2],_[V+4>>2]=_[J+4>>2],_[V+8>>2]=_[J+8>>2],Oc(V)}if(uh(k,V,$),ms($),C=w,ut=_[C>>2]|0,C=_[C+4>>2]|0,lt=(15-P|0)*3|0,At=Jt(7,0,lt|0)|0,C=C&~(se()|0),lt=Jt(od($)|0,0,lt|0)|0,C=se()|0|C,nt=w,_[nt>>2]=lt|ut&~At,_[nt+4>>2]=C,(P|0)<=1){b=14;break}}e:do if((b|0)!=13&&(b|0)==14)if((_[J>>2]|0)<=1&&(_[J+4>>2]|0)<=1&&(_[J+8>>2]|0)<=1){b=od(J)|0,C=sd(ke,b)|0,(C|0)==127?$=0:$=mi(C)|0;t:do if(b){if(ae){if(C=qo(v,y)|0,(C|0)==7){C=5;break e}if(P=_[21376+(C*28|0)+(b<<2)>>2]|0,(P|0)>0){C=b,b=0;do C=Tu(C)|0,b=b+1|0;while((b|0)!=(P|0))}else C=b;if((C|0)==1){C=9;break e}b=sd(ke,C)|0,(b|0)==127&&Dt(27648,27538,411,27678),mi(b)|0?Dt(27693,27538,412,27678):(Oe=b,De=P,xe=C)}else Oe=C,De=0,xe=b;if(V=_[4272+(ke*28|0)+(xe<<2)>>2]|0,(V|0)<=-1&&Dt(27724,27538,419,27678),!$){if((De|0)<0){C=5;break e}if(De|0){P=w,C=0,b=_[P>>2]|0,P=_[P+4>>2]|0;do b=rp(b,P)|0,P=se()|0,lt=w,_[lt>>2]=b,_[lt+4>>2]=P,C=C+1|0;while((C|0)<(De|0))}if((V|0)<=0){C=Oe,b=58;break}for(P=w,C=0,b=_[P>>2]|0,P=_[P+4>>2]|0;;)if(b=rp(b,P)|0,P=se()|0,lt=w,_[lt>>2]=b,_[lt+4>>2]=P,C=C+1|0,(C|0)==(V|0)){C=Oe,b=58;break t}}if(k=rh(Oe,ke)|0,(k|0)==7&&Dt(27514,27538,428,27678),C=w,b=_[C>>2]|0,C=_[C+4>>2]|0,(V|0)>0){P=0;do b=rp(b,C)|0,C=se()|0,lt=w,_[lt>>2]=b,_[lt+4>>2]=C,P=P+1|0;while((P|0)!=(V|0))}if(C=qo(b,C)|0,(C|0)==7&&Dt(27795,27538,440,27678),b=ih(Oe)|0,b=_[(b?21792:21584)+(k*28|0)+(C<<2)>>2]|0,(b|0)<0&&Dt(27795,27538,454,27678),!b)C=Oe,b=58;else{k=w,C=0,P=_[k>>2]|0,k=_[k+4>>2]|0;do P=Zx(P,k)|0,k=se()|0,lt=w,_[lt>>2]=P,_[lt+4>>2]=k,C=C+1|0;while((C|0)<(b|0));C=Oe,b=58}}else if((ae|0)!=0&($|0)!=0){if(b=qo(v,y)|0,P=w,P=qo(_[P>>2]|0,_[P+4>>2]|0)|0,(b|0)==7|(P|0)==7){C=5;break e}if(P=_[21376+(b*28|0)+(P<<2)>>2]|0,(P|0)<0){C=5;break e}if(!P)b=59;else{V=w,b=0,k=_[V>>2]|0,V=_[V+4>>2]|0;do k=rp(k,V)|0,V=se()|0,lt=w,_[lt>>2]=k,_[lt+4>>2]=V,b=b+1|0;while((b|0)<(P|0));b=58}}else b=58;while(!1);if((b|0)==58&&$&&(b=59),(b|0)==59&&(lt=w,(qo(_[lt>>2]|0,_[lt+4>>2]|0)|0)==1)){C=9;break}lt=w,At=_[lt>>2]|0,lt=_[lt+4>>2]&-1040385,ut=Jt(C|0,0,45)|0,lt=lt|(se()|0),C=w,_[C>>2]=At|ut,_[C+4>>2]=lt,C=0}else C=1;while(!1);return lt=C,de=$e,lt|0}function Lw(v,y,b,w,C,P){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0,P=P|0;var k=0,V=0;return V=de,de=de+16|0,k=V,C?v=15:(v=Uc(v,y,b,w,k)|0,v||(b1(k,P),v=0)),de=V,v|0}function I1(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0;return k=de,de=de+16|0,P=k,w?b=15:(b=dh(b,P)|0,b||(b=wu(v,y,P,C)|0)),de=k,b|0}function pp(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0;return $=de,de=de+32|0,k=$+12|0,V=$,P=Uc(v,y,v,y,k)|0,P|0?(V=P,de=$,V|0):(v=Uc(v,y,b,w,V)|0,v|0?(V=v,de=$,V|0):(k=Fm(k,V)|0,V=C,_[V>>2]=k,_[V+4>>2]=((k|0)<0)<<31>>31,V=0,de=$,V|0))}function ob(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0;return $=de,de=de+32|0,k=$+12|0,V=$,P=Uc(v,y,v,y,k)|0,!P&&(P=Uc(v,y,b,w,V)|0,!P)?(w=Fm(k,V)|0,w=fn(w|0,((w|0)<0)<<31>>31|0,1,0)|0,k=se()|0,V=C,_[V>>2]=w,_[V+4>>2]=k,V=0,de=$,V|0):(V=P,de=$,V|0)}function Dw(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0,Ke=0,en=0,wn=0,vn=0,ua=0;if(vn=de,de=de+48|0,en=vn+24|0,k=vn+12|0,wn=vn,P=Uc(v,y,v,y,en)|0,!P&&(P=Uc(v,y,b,w,k)|0,!P)){lt=Fm(en,k)|0,Ke=((lt|0)<0)<<31>>31,_[en>>2]=0,_[en+4>>2]=0,_[en+8>>2]=0,_[k>>2]=0,_[k+4>>2]=0,_[k+8>>2]=0,Uc(v,y,v,y,en)|0&&Dt(27795,27538,692,27747),Uc(v,y,b,w,k)|0&&Dt(27795,27538,697,27747),Yr(en),Yr(k),ae=(lt|0)==0?0:1/+(lt|0),b=_[en>>2]|0,$e=ae*+((_[k>>2]|0)-b|0),nt=en+4|0,w=_[nt>>2]|0,At=ae*+((_[k+4>>2]|0)-w|0),ut=en+8|0,P=_[ut>>2]|0,ae=ae*+((_[k+8>>2]|0)-P|0),_[wn>>2]=b,xe=wn+4|0,_[xe>>2]=w,ke=wn+8|0,_[ke>>2]=P;e:do if((lt|0)<0)P=0;else for(De=0,Oe=0;;){$=+(Oe>>>0)+4294967296*+(De|0),ua=$e*$+ +(b|0),V=At*$+ +(w|0),$=ae*$+ +(P|0),b=~~+gd(+ua),k=~~+gd(+V),P=~~+gd(+$),ua=+Ln(+(+(b|0)-ua)),V=+Ln(+(+(k|0)-V)),$=+Ln(+(+(P|0)-$));do if(ua>V&ua>$)b=0-(k+P)|0,w=k;else if(J=0-b|0,V>$){w=J-P|0;break}else{w=k,P=J-k|0;break}while(!1);if(_[wn>>2]=b,_[xe>>2]=w,_[ke>>2]=P,S1(wn),P=wu(v,y,wn,C+(Oe<<3)|0)|0,P|0)break e;if(!((De|0)<(Ke|0)|(De|0)==(Ke|0)&Oe>>>0<lt>>>0)){P=0;break e}b=fn(Oe|0,De|0,1,0)|0,w=se()|0,De=w,Oe=b,b=_[en>>2]|0,w=_[nt>>2]|0,P=_[ut>>2]|0}while(!1);return wn=P,de=vn,wn|0}return wn=P,de=vn,wn|0}function Eu(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0;if((b|0)==0&(w|0)==0)return C=0,P=1,Ze(C|0),P|0;P=v,C=y,v=1,y=0;do k=(b&1|0)==0&!0,v=gs((k?1:P)|0,(k?0:C)|0,v|0,y|0)|0,y=se()|0,b=Ow(b|0,w|0,1)|0,w=se()|0,P=gs(P|0,C|0,P|0,C|0)|0,C=se()|0;while(!((b|0)==0&(w|0)==0));return Ze(y|0),v|0}function L1(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0;V=de,de=de+16|0,P=V,k=Gt(v|0,y|0,52)|0,se()|0,k=k&15;do if(k){if(C=hh(v,y,P)|0,!C){J=+me[P>>3],$=1/+ka(+J),ae=+me[25968+(k<<3)>>3],me[b>>3]=J+ae,me[b+8>>3]=J-ae,J=+me[P+8>>3],$=ae*$,me[b+16>>3]=$+J,me[b+24>>3]=J-$;break}return k=C,de=V,k|0}else{if(C=Gt(v|0,y|0,45)|0,se()|0,C=C&127,C>>>0>121)return k=5,de=V,k|0;P=22064+(C<<5)|0,_[b>>2]=_[P>>2],_[b+4>>2]=_[P+4>>2],_[b+8>>2]=_[P+8>>2],_[b+12>>2]=_[P+12>>2],_[b+16>>2]=_[P+16>>2],_[b+20>>2]=_[P+20>>2],_[b+24>>2]=_[P+24>>2],_[b+28>>2]=_[P+28>>2];break}while(!1);return Pr(b,w?1.4:1.1),w=26096+(k<<3)|0,(_[w>>2]|0)==(v|0)&&(_[w+4>>2]|0)==(y|0)&&(me[b>>3]=1.5707963267948966),k=26224+(k<<3)|0,(_[k>>2]|0)==(v|0)&&(_[k+4>>2]|0)==(y|0)&&(me[b+8>>3]=-1.5707963267948966),+me[b>>3]!=1.5707963267948966&&+me[b+8>>3]!=-1.5707963267948966?(k=0,de=V,k|0):(me[b+16>>3]=3.141592653589793,me[b+24>>3]=-3.141592653589793,k=0,de=V,k|0)}function Wl(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0;J=de,de=de+48|0,k=J+32|0,P=J+40|0,V=J,ip(k,0,0,0),$=_[k>>2]|0,k=_[k+4>>2]|0;do if(b>>>0<=15){if(C=$l(w)|0,C|0){w=V,_[w>>2]=0,_[w+4>>2]=0,_[V+8>>2]=C,_[V+12>>2]=-1,w=V+16|0,$=V+29|0,_[w>>2]=0,_[w+4>>2]=0,_[w+8>>2]=0,Ut[w+12>>0]=0,Ut[$>>0]=Ut[P>>0]|0,Ut[$+1>>0]=Ut[P+1>>0]|0,Ut[$+2>>0]=Ut[P+2>>0]|0;break}if(C=Ko((_[y+8>>2]|0)+1|0,32)|0,C){Kl(y,C),ae=V,_[ae>>2]=$,_[ae+4>>2]=k,_[V+8>>2]=0,_[V+12>>2]=b,_[V+16>>2]=w,_[V+20>>2]=y,_[V+24>>2]=C,Ut[V+28>>0]=0,$=V+29|0,Ut[$>>0]=Ut[P>>0]|0,Ut[$+1>>0]=Ut[P+1>>0]|0,Ut[$+2>>0]=Ut[P+2>>0]|0;break}else{w=V,_[w>>2]=0,_[w+4>>2]=0,_[V+8>>2]=13,_[V+12>>2]=-1,w=V+16|0,$=V+29|0,_[w>>2]=0,_[w+4>>2]=0,_[w+8>>2]=0,Ut[w+12>>0]=0,Ut[$>>0]=Ut[P>>0]|0,Ut[$+1>>0]=Ut[P+1>>0]|0,Ut[$+2>>0]=Ut[P+2>>0]|0;break}}else $=V,_[$>>2]=0,_[$+4>>2]=0,_[V+8>>2]=4,_[V+12>>2]=-1,$=V+16|0,ae=V+29|0,_[$>>2]=0,_[$+4>>2]=0,_[$+8>>2]=0,Ut[$+12>>0]=0,Ut[ae>>0]=Ut[P>>0]|0,Ut[ae+1>>0]=Ut[P+1>>0]|0,Ut[ae+2>>0]=Ut[P+2>>0]|0;while(!1);dd(V),_[v>>2]=_[V>>2],_[v+4>>2]=_[V+4>>2],_[v+8>>2]=_[V+8>>2],_[v+12>>2]=_[V+12>>2],_[v+16>>2]=_[V+16>>2],_[v+20>>2]=_[V+20>>2],_[v+24>>2]=_[V+24>>2],_[v+28>>2]=_[V+28>>2],de=J}function dd(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0,Ke=0;if(Ke=de,de=de+336|0,De=Ke+168|0,Oe=Ke,w=v,b=_[w>>2]|0,w=_[w+4>>2]|0,(b|0)==0&(w|0)==0){de=Ke;return}if(y=v+28|0,Ut[y>>0]|0?(b=mp(b,w)|0,w=se()|0):Ut[y>>0]=1,lt=v+20|0,!(_[_[lt>>2]>>2]|0)){y=v+24|0,b=_[y>>2]|0,b|0&&Un(b),ut=v,_[ut>>2]=0,_[ut+4>>2]=0,_[v+8>>2]=0,_[lt>>2]=0,_[v+12>>2]=-1,_[v+16>>2]=0,_[y>>2]=0,de=Ke;return}ut=v+16|0,y=_[ut>>2]|0,C=y&15;e:do if((b|0)==0&(w|0)==0)At=v+24|0;else{$e=v+12|0,xe=(C|0)==3,ae=y&255,$=(C|1|0)==3,ke=v+24|0,J=(C+-1|0)>>>0<3,k=(C|2|0)==3,V=Oe+8|0;t:for(;;){if(P=Gt(b|0,w|0,52)|0,se()|0,P=P&15,(P|0)==(_[$e>>2]|0)){switch(ae&15){case 0:case 2:case 3:{if(C=hh(b,w,De)|0,C|0){nt=15;break t}if(Yl(_[lt>>2]|0,_[ke>>2]|0,De)|0){nt=19;break t}break}}if($&&(C=_[(_[lt>>2]|0)+4>>2]|0,_[De>>2]=_[C>>2],_[De+4>>2]=_[C+4>>2],_[De+8>>2]=_[C+8>>2],_[De+12>>2]=_[C+12>>2],ql(26832,De)|0)){if(M1(_[(_[lt>>2]|0)+4>>2]|0,P,Oe)|0){nt=25;break}if(C=Oe,(_[C>>2]|0)==(b|0)&&(_[C+4>>2]|0)==(w|0)){nt=29;break}}if(J){if(C=fh(b,w,De)|0,C|0){nt=32;break}if(L1(b,w,Oe,0)|0){nt=36;break}if(k&&Mu(_[lt>>2]|0,_[ke>>2]|0,De,Oe)|0){nt=42;break}if($&&k1(_[lt>>2]|0,_[ke>>2]|0,De,Oe)|0){nt=42;break}}if(xe){if(y=L1(b,w,De,1)|0,C=_[ke>>2]|0,y|0){nt=45;break}if(Jf(C,De)|0){if(ch(Oe,De),Om(De,_[ke>>2]|0)|0){nt=53;break}if(Yl(_[lt>>2]|0,_[ke>>2]|0,V)|0){nt=53;break}if(k1(_[lt>>2]|0,_[ke>>2]|0,Oe,De)|0){nt=53;break}}}}do if((P|0)<(_[$e>>2]|0)){if(y=L1(b,w,De,1)|0,C=_[ke>>2]|0,y|0){nt=58;break t}if(!(Jf(C,De)|0)){nt=73;break}if(Om(_[ke>>2]|0,De)|0&&(ch(Oe,De),Mu(_[lt>>2]|0,_[ke>>2]|0,Oe,De)|0)){nt=65;break t}if(b=E1(b,w,P+1|0,Oe)|0,b|0){nt=67;break t}w=Oe,b=_[w>>2]|0,w=_[w+4>>2]|0}else nt=73;while(!1);if((nt|0)==73&&(nt=0,b=mp(b,w)|0,w=se()|0),(b|0)==0&(w|0)==0){At=ke;break e}}switch(nt|0){case 15:{y=_[ke>>2]|0,y|0&&Un(y),nt=v,_[nt>>2]=0,_[nt+4>>2]=0,_[lt>>2]=0,_[$e>>2]=-1,_[ut>>2]=0,_[ke>>2]=0,_[v+8>>2]=C,nt=20;break}case 19:{_[v>>2]=b,_[v+4>>2]=w,nt=20;break}case 25:{Dt(27795,27761,470,27772);break}case 29:{_[v>>2]=b,_[v+4>>2]=w,de=Ke;return}case 32:{y=_[ke>>2]|0,y|0&&Un(y),At=v,_[At>>2]=0,_[At+4>>2]=0,_[lt>>2]=0,_[$e>>2]=-1,_[ut>>2]=0,_[ke>>2]=0,_[v+8>>2]=C,de=Ke;return}case 36:{Dt(27795,27761,493,27772);break}case 42:{_[v>>2]=b,_[v+4>>2]=w,de=Ke;return}case 45:{C|0&&Un(C),nt=v,_[nt>>2]=0,_[nt+4>>2]=0,_[lt>>2]=0,_[$e>>2]=-1,_[ut>>2]=0,_[ke>>2]=0,_[v+8>>2]=y,nt=55;break}case 53:{_[v>>2]=b,_[v+4>>2]=w,nt=55;break}case 58:{C|0&&Un(C),nt=v,_[nt>>2]=0,_[nt+4>>2]=0,_[lt>>2]=0,_[$e>>2]=-1,_[ut>>2]=0,_[ke>>2]=0,_[v+8>>2]=y,nt=71;break}case 65:{_[v>>2]=b,_[v+4>>2]=w,nt=71;break}case 67:{y=_[ke>>2]|0,y|0&&Un(y),At=v,_[At>>2]=0,_[At+4>>2]=0,_[lt>>2]=0,_[$e>>2]=-1,_[ut>>2]=0,_[ke>>2]=0,_[v+8>>2]=b,de=Ke;return}}if((nt|0)==20){de=Ke;return}else if((nt|0)==55){de=Ke;return}else if((nt|0)==71){de=Ke;return}}while(!1);y=_[At>>2]|0,y|0&&Un(y),nt=v,_[nt>>2]=0,_[nt+4>>2]=0,_[v+8>>2]=0,_[lt>>2]=0,_[v+12>>2]=-1,_[ut>>2]=0,_[At>>2]=0,de=Ke}function mp(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0;xe=de,de=de+16|0,ae=xe,w=Gt(v|0,y|0,52)|0,se()|0,w=w&15,b=Gt(v|0,y|0,45)|0,se()|0;do if(w){for(;b=Jt(w+4095|0,0,52)|0,C=se()|0|y&-15728641,P=(15-w|0)*3|0,k=Jt(7,0,P|0)|0,V=se()|0,b=b|v|k,C=C|V,$=Gt(v|0,y|0,P|0)|0,se()|0,$=$&7,w=w+-1|0,!($>>>0<6);)if(w)y=C,v=b;else{J=4;break}if((J|0)==4){b=Gt(b|0,C|0,45)|0,se()|0;break}return ae=($|0)==0&(yi(b,C)|0)!=0,ae=Jt((ae?2:1)+$|0,0,P|0)|0,J=se()|0|y&~V,ae=ae|v&~k,Ze(J|0),de=xe,ae|0}while(!1);return b=b&127,b>>>0>120?(J=0,ae=0,Ze(J|0),de=xe,ae|0):(ip(ae,0,b+1|0,0),J=_[ae+4>>2]|0,ae=_[ae>>2]|0,Ze(J|0),de=xe,ae|0)}function D1(v,y,b,w,C,P){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0,P=P|0;var k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0;nt=de,de=de+160|0,xe=nt+80|0,V=nt+64|0,ke=nt+112|0,$e=nt,Wl(xe,v,y,b),J=xe,ud(V,_[J>>2]|0,_[J+4>>2]|0,y),J=V,$=_[J>>2]|0,J=_[J+4>>2]|0,k=_[xe+8>>2]|0,De=ke+4|0,_[De>>2]=_[xe>>2],_[De+4>>2]=_[xe+4>>2],_[De+8>>2]=_[xe+8>>2],_[De+12>>2]=_[xe+12>>2],_[De+16>>2]=_[xe+16>>2],_[De+20>>2]=_[xe+20>>2],_[De+24>>2]=_[xe+24>>2],_[De+28>>2]=_[xe+28>>2],De=$e,_[De>>2]=$,_[De+4>>2]=J,De=$e+8|0,_[De>>2]=k,v=$e+12|0,y=ke,b=v+36|0;do _[v>>2]=_[y>>2],v=v+4|0,y=y+4|0;while((v|0)<(b|0));if(ke=$e+48|0,_[ke>>2]=_[V>>2],_[ke+4>>2]=_[V+4>>2],_[ke+8>>2]=_[V+8>>2],_[ke+12>>2]=_[V+12>>2],($|0)==0&(J|0)==0)return $e=k,de=nt,$e|0;b=$e+16|0,ae=$e+24|0,xe=$e+28|0,k=0,V=0,y=$,v=J;do{if(!((k|0)<(C|0)|(k|0)==(C|0)&V>>>0<w>>>0)){Oe=4;break}if(J=V,V=fn(V|0,k|0,1,0)|0,k=se()|0,J=P+(J<<3)|0,_[J>>2]=y,_[J+4>>2]=v,W0(ke),v=ke,y=_[v>>2]|0,v=_[v+4>>2]|0,(y|0)==0&(v|0)==0){if(dd(b),y=b,v=_[y>>2]|0,y=_[y+4>>2]|0,(v|0)==0&(y|0)==0){Oe=10;break}up(v,y,_[xe>>2]|0,ke),v=ke,y=_[v>>2]|0,v=_[v+4>>2]|0}J=$e,_[J>>2]=y,_[J+4>>2]=v}while(!((y|0)==0&(v|0)==0));return(Oe|0)==4?(v=$e+40|0,y=_[v>>2]|0,y|0&&Un(y),Oe=$e+16|0,_[Oe>>2]=0,_[Oe+4>>2]=0,_[ae>>2]=0,_[$e+36>>2]=0,_[xe>>2]=-1,_[$e+32>>2]=0,_[v>>2]=0,up(0,0,0,ke),_[$e>>2]=0,_[$e+4>>2]=0,_[De>>2]=0,$e=14,de=nt,$e|0):((Oe|0)==10&&(_[$e>>2]=0,_[$e+4>>2]=0,_[De>>2]=_[ae>>2]),$e=_[De>>2]|0,de=nt,$e|0)}function $0(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0;if(xe=de,de=de+48|0,$=xe+32|0,V=xe+40|0,J=xe,!(_[v>>2]|0))return ae=w,_[ae>>2]=0,_[ae+4>>2]=0,ae=0,de=xe,ae|0;ip($,0,0,0),k=$,C=_[k>>2]|0,k=_[k+4>>2]|0;do if(y>>>0>15)ae=J,_[ae>>2]=0,_[ae+4>>2]=0,_[J+8>>2]=4,_[J+12>>2]=-1,ae=J+16|0,b=J+29|0,_[ae>>2]=0,_[ae+4>>2]=0,_[ae+8>>2]=0,Ut[ae+12>>0]=0,Ut[b>>0]=Ut[V>>0]|0,Ut[b+1>>0]=Ut[V+1>>0]|0,Ut[b+2>>0]=Ut[V+2>>0]|0,b=4,ae=9;else{if(b=$l(b)|0,b|0){$=J,_[$>>2]=0,_[$+4>>2]=0,_[J+8>>2]=b,_[J+12>>2]=-1,$=J+16|0,ae=J+29|0,_[$>>2]=0,_[$+4>>2]=0,_[$+8>>2]=0,Ut[$+12>>0]=0,Ut[ae>>0]=Ut[V>>0]|0,Ut[ae+1>>0]=Ut[V+1>>0]|0,Ut[ae+2>>0]=Ut[V+2>>0]|0,ae=9;break}if(b=Ko((_[v+8>>2]|0)+1|0,32)|0,!b){ae=J,_[ae>>2]=0,_[ae+4>>2]=0,_[J+8>>2]=13,_[J+12>>2]=-1,ae=J+16|0,b=J+29|0,_[ae>>2]=0,_[ae+4>>2]=0,_[ae+8>>2]=0,Ut[ae+12>>0]=0,Ut[b>>0]=Ut[V>>0]|0,Ut[b+1>>0]=Ut[V+1>>0]|0,Ut[b+2>>0]=Ut[V+2>>0]|0,b=13,ae=9;break}Kl(v,b),De=J,_[De>>2]=C,_[De+4>>2]=k,k=J+8|0,_[k>>2]=0,_[J+12>>2]=y,_[J+20>>2]=v,_[J+24>>2]=b,Ut[J+28>>0]=0,C=J+29|0,Ut[C>>0]=Ut[V>>0]|0,Ut[C+1>>0]=Ut[V+1>>0]|0,Ut[C+2>>0]=Ut[V+2>>0]|0,_[J+16>>2]=3,ke=+Oi(b),ke=ke*+Gl(b),P=+Ln(+ +me[b>>3]),P=ke/+ka(+ +Q0(+P,+ +Ln(+ +me[b+8>>3])))*6371.007180918475*6371.007180918475,C=J+12|0,b=_[C>>2]|0;e:do if((b|0)>0)do{if(ab(b+-1|0,$)|0,!(P/+me[$>>3]>10))break e;De=_[C>>2]|0,b=De+-1|0,_[C>>2]=b}while((De|0)>1);while(!1);if(dd(J),C=w,_[C>>2]=0,_[C+4>>2]=0,C=J,b=_[C>>2]|0,C=_[C+4>>2]|0,!((b|0)==0&(C|0)==0))do H0(b,C,y,$)|0,V=$,v=w,V=fn(_[v>>2]|0,_[v+4>>2]|0,_[V>>2]|0,_[V+4>>2]|0)|0,v=se()|0,De=w,_[De>>2]=V,_[De+4>>2]=v,dd(J),De=J,b=_[De>>2]|0,C=_[De+4>>2]|0;while(!((b|0)==0&(C|0)==0));b=_[k>>2]|0}while(!1);return De=b,de=xe,De|0}function Jr(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0;if(!(ql(y,b)|0)||(y=lh(y)|0,w=+me[b>>3],C=+me[b+8>>3],C=y&C<0?C+6.283185307179586:C,ke=_[v>>2]|0,(ke|0)<=0))return ke=0,ke|0;if(xe=_[v+4>>2]|0,y){y=0,ae=C,b=-1,v=0;e:for(;;){for(J=v;k=+me[xe+(J<<4)>>3],C=+me[xe+(J<<4)+8>>3],v=(b+2|0)%(ke|0)|0,P=+me[xe+(v<<4)>>3],V=+me[xe+(v<<4)+8>>3],k>P?($=k,k=V):($=P,P=k,k=C,C=V),w=w==P|w==$?w+2220446049250313e-31:w,!!(w<P|w>$);)if(b=J+1|0,(b|0)>=(ke|0)){b=22;break e}else v=J,J=b,b=v;if(V=k<0?k+6.283185307179586:k,k=C<0?C+6.283185307179586:C,ae=V==ae|k==ae?ae+-2220446049250313e-31:ae,$=V+(k-V)*((w-P)/($-P)),($<0?$+6.283185307179586:$)>ae&&(y=y^1),v=J+1|0,(v|0)>=(ke|0)){b=22;break}else b=J}if((b|0)==22)return y|0}else{y=0,ae=C,b=-1,v=0;e:for(;;){for(J=v;k=+me[xe+(J<<4)>>3],C=+me[xe+(J<<4)+8>>3],v=(b+2|0)%(ke|0)|0,P=+me[xe+(v<<4)>>3],V=+me[xe+(v<<4)+8>>3],k>P?($=k,k=V):($=P,P=k,k=C,C=V),w=w==P|w==$?w+2220446049250313e-31:w,!!(w<P|w>$);)if(b=J+1|0,(b|0)>=(ke|0)){b=22;break e}else v=J,J=b,b=v;if(ae=k==ae|C==ae?ae+-2220446049250313e-31:ae,k+(C-k)*((w-P)/($-P))>ae&&(y=y^1),v=J+1|0,(v|0)>=(ke|0)){b=22;break}else b=J}if((b|0)==22)return y|0}return 0}function vl(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0;if(Oe=_[v>>2]|0,!Oe){_[y>>2]=0,_[y+4>>2]=0,_[y+8>>2]=0,_[y+12>>2]=0,_[y+16>>2]=0,_[y+20>>2]=0,_[y+24>>2]=0,_[y+28>>2]=0;return}if($e=y+8|0,me[$e>>3]=17976931348623157e292,nt=y+24|0,me[nt>>3]=17976931348623157e292,me[y>>3]=-17976931348623157e292,At=y+16|0,me[At>>3]=-17976931348623157e292,!((Oe|0)<=0)){for(ke=_[v+4>>2]|0,J=17976931348623157e292,ae=-17976931348623157e292,xe=0,v=-1,P=17976931348623157e292,k=17976931348623157e292,$=-17976931348623157e292,w=-17976931348623157e292,De=0;b=+me[ke+(De<<4)>>3],V=+me[ke+(De<<4)+8>>3],v=v+2|0,C=+me[ke+(((v|0)==(Oe|0)?0:v)<<4)+8>>3],b<P&&(me[$e>>3]=b,P=b),V<k&&(me[nt>>3]=V,k=V),b>$?me[y>>3]=b:b=$,V>w&&(me[At>>3]=V,w=V),J=V>0&V<J?V:J,ae=V<0&V>ae?V:ae,xe=xe|+Ln(+(V-C))>3.141592653589793,v=De+1|0,(v|0)!=(Oe|0);)ut=De,$=b,De=v,v=ut;xe&&(me[At>>3]=ae,me[nt>>3]=J)}}function $l(v){return v=v|0,(v>>>0<4?0:15)|0}function Kl(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0,Ke=0,en=0,wn=0,vn=0;if(Oe=_[v>>2]|0,Oe){if($e=y+8|0,me[$e>>3]=17976931348623157e292,nt=y+24|0,me[nt>>3]=17976931348623157e292,me[y>>3]=-17976931348623157e292,At=y+16|0,me[At>>3]=-17976931348623157e292,(Oe|0)>0){for(C=_[v+4>>2]|0,ke=17976931348623157e292,De=-17976931348623157e292,w=0,b=-1,$=17976931348623157e292,J=17976931348623157e292,xe=-17976931348623157e292,k=-17976931348623157e292,ut=0;P=+me[C+(ut<<4)>>3],ae=+me[C+(ut<<4)+8>>3],wn=b+2|0,V=+me[C+(((wn|0)==(Oe|0)?0:wn)<<4)+8>>3],P<$&&(me[$e>>3]=P,$=P),ae<J&&(me[nt>>3]=ae,J=ae),P>xe?me[y>>3]=P:P=xe,ae>k&&(me[At>>3]=ae,k=ae),ke=ae>0&ae<ke?ae:ke,De=ae<0&ae>De?ae:De,w=w|+Ln(+(ae-V))>3.141592653589793,b=ut+1|0,(b|0)!=(Oe|0);)wn=ut,xe=P,ut=b,b=wn;w&&(me[At>>3]=De,me[nt>>3]=ke)}}else _[y>>2]=0,_[y+4>>2]=0,_[y+8>>2]=0,_[y+12>>2]=0,_[y+16>>2]=0,_[y+20>>2]=0,_[y+24>>2]=0,_[y+28>>2]=0;if(wn=v+8|0,b=_[wn>>2]|0,!((b|0)<=0)){en=v+12|0,Ke=0;do if(C=_[en>>2]|0,w=Ke,Ke=Ke+1|0,nt=y+(Ke<<5)|0,At=_[C+(w<<3)>>2]|0,At){if(ut=y+(Ke<<5)+8|0,me[ut>>3]=17976931348623157e292,v=y+(Ke<<5)+24|0,me[v>>3]=17976931348623157e292,me[nt>>3]=-17976931348623157e292,lt=y+(Ke<<5)+16|0,me[lt>>3]=-17976931348623157e292,(At|0)>0){for(Oe=_[C+(w<<3)+4>>2]|0,ke=17976931348623157e292,De=-17976931348623157e292,C=0,w=-1,$e=0,$=17976931348623157e292,J=17976931348623157e292,ae=-17976931348623157e292,k=-17976931348623157e292;P=+me[Oe+($e<<4)>>3],xe=+me[Oe+($e<<4)+8>>3],w=w+2|0,V=+me[Oe+(((w|0)==(At|0)?0:w)<<4)+8>>3],P<$&&(me[ut>>3]=P,$=P),xe<J&&(me[v>>3]=xe,J=xe),P>ae?me[nt>>3]=P:P=ae,xe>k&&(me[lt>>3]=xe,k=xe),ke=xe>0&xe<ke?xe:ke,De=xe<0&xe>De?xe:De,C=C|+Ln(+(xe-V))>3.141592653589793,w=$e+1|0,(w|0)!=(At|0);)vn=$e,$e=w,ae=P,w=vn;C&&(me[lt>>3]=De,me[v>>3]=ke)}}else _[nt>>2]=0,_[nt+4>>2]=0,_[nt+8>>2]=0,_[nt+12>>2]=0,_[nt+16>>2]=0,_[nt+20>>2]=0,_[nt+24>>2]=0,_[nt+28>>2]=0,b=_[wn>>2]|0;while((Ke|0)<(b|0))}}function Yl(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0;if(!(Jr(v,y,b)|0))return C=0,C|0;if(C=v+8|0,(_[C>>2]|0)<=0)return C=1,C|0;for(w=v+12|0,v=0;;){if(P=v,v=v+1|0,Jr((_[w>>2]|0)+(P<<3)|0,y+(v<<5)|0,b)|0){v=0,w=6;break}if((v|0)>=(_[C>>2]|0)){v=1,w=6;break}}return(w|0)==6?v|0:0}function Mu(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0;if(J=de,de=de+16|0,V=J,k=b+8|0,!(Jr(v,y,k)|0))return $=0,de=J,$|0;$=v+8|0;e:do if((_[$>>2]|0)>0){for(P=v+12|0,C=0;;){if(ae=C,C=C+1|0,Jr((_[P>>2]|0)+(ae<<3)|0,y+(C<<5)|0,k)|0){C=0;break}if((C|0)>=(_[$>>2]|0))break e}return de=J,C|0}while(!1);if(K0(v,y,b,w)|0)return ae=0,de=J,ae|0;_[V>>2]=_[b>>2],_[V+4>>2]=k,C=_[$>>2]|0;e:do if((C|0)>0)for(v=v+12|0,k=0,P=C;;){if(C=_[v>>2]|0,(_[C+(k<<3)>>2]|0)>0){if(Jr(V,w,_[C+(k<<3)+4>>2]|0)|0){C=0;break e}if(C=k+1|0,K0((_[v>>2]|0)+(k<<3)|0,y+(C<<5)|0,b,w)|0){C=0;break e}P=_[$>>2]|0}else C=k+1|0;if((C|0)<(P|0))k=C;else{C=1;break}}else C=1;while(!1);return ae=C,de=J,ae|0}function K0(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0,Ke=0,en=0,wn=0,vn=0,ua=0;if(wn=de,de=de+176|0,ut=wn+172|0,C=wn+168|0,lt=wn,!(Jf(y,w)|0))return v=0,de=wn,v|0;if(Zf(y,w,ut,C),Ah(lt|0,b|0,168)|0,(_[b>>2]|0)>0){y=0;do vn=lt+8+(y<<4)+8|0,At=+Ho(+me[vn>>3],_[C>>2]|0),me[vn>>3]=At,y=y+1|0;while((y|0)<(_[b>>2]|0))}$e=+me[w>>3],nt=+me[w+8>>3],At=+Ho(+me[w+16>>3],_[C>>2]|0),De=+Ho(+me[w+24>>3],_[C>>2]|0);e:do if((_[v>>2]|0)>0){if(w=v+4|0,C=_[lt>>2]|0,(C|0)<=0){for(y=0;;)if(y=y+1|0,(y|0)>=(_[v>>2]|0)){y=0;break e}}for(b=0;;){if(y=_[w>>2]|0,ke=+me[y+(b<<4)>>3],Oe=+Ho(+me[y+(b<<4)+8>>3],_[ut>>2]|0),y=_[w>>2]|0,b=b+1|0,vn=(b|0)%(_[v>>2]|0)|0,P=+me[y+(vn<<4)>>3],k=+Ho(+me[y+(vn<<4)+8>>3],_[ut>>2]|0),!(ke>=$e)|!(P>=$e)&&!(ke<=nt)|!(P<=nt)&&!(Oe<=De)|!(k<=De)&&!(Oe>=At)|!(k>=At)){xe=P-ke,J=k-Oe,y=0;do if(ua=y,y=y+1|0,vn=(y|0)==(C|0)?0:y,P=+me[lt+8+(ua<<4)+8>>3],k=+me[lt+8+(vn<<4)+8>>3]-P,V=+me[lt+8+(ua<<4)>>3],$=+me[lt+8+(vn<<4)>>3]-V,ae=xe*k-J*$,ae!=0&&(Ke=Oe-P,en=ke-V,$=(Ke*$-k*en)/ae,!($<0|$>1))&&(ae=(xe*Ke-J*en)/ae,ae>=0&ae<=1)){y=1;break e}while((y|0)<(C|0))}if((b|0)>=(_[v>>2]|0)){y=0;break}}}else y=0;while(!1);return ua=y,de=wn,ua|0}function k1(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0;if(K0(v,y,b,w)|0)return P=1,P|0;if(P=v+8|0,(_[P>>2]|0)<=0)return P=0,P|0;for(C=v+12|0,v=0;;){if(k=v,v=v+1|0,K0((_[C>>2]|0)+(k<<3)|0,y+(v<<5)|0,b,w)|0){v=1,C=6;break}if((v|0)>=(_[P>>2]|0)){v=0,C=6;break}}return(C|0)==6?v|0:0}function lb(){return 8}function kw(){return 16}function Lr(){return 168}function ns(){return 8}function Qa(){return 16}function mh(){return 12}function Xl(){return 8}function cb(v){return v=v|0,+(+((_[v>>2]|0)>>>0)+4294967296*+(_[v+4>>2]|0))}function gh(v){v=v|0;var y=0,b=0;return b=+me[v>>3],y=+me[v+8>>3],+ +oa(+(b*b+y*y))}function ub(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0;J=+me[v>>3],$=+me[y>>3]-J,V=+me[v+8>>3],k=+me[y+8>>3]-V,xe=+me[b>>3],P=+me[w>>3]-xe,ke=+me[b+8>>3],ae=+me[w+8>>3]-ke,P=(P*(V-ke)-(J-xe)*ae)/($*ae-k*P),me[C>>3]=J+$*P,me[C+8>>3]=V+k*P}function db(v,y){return v=v|0,y=y|0,+Ln(+(+me[v>>3]-+me[y>>3]))<11920928955078125e-23?(y=+Ln(+(+me[v+8>>3]-+me[y+8>>3]))<11920928955078125e-23,y|0):(y=0,y|0)}function as(v,y){v=v|0,y=y|0;var b=0,w=0,C=0;return C=+me[v>>3]-+me[y>>3],w=+me[v+8>>3]-+me[y+8>>3],b=+me[v+16>>3]-+me[y+16>>3],+(C*C+w*w+b*b)}function gp(v,y){v=v|0,y=y|0;var b=0,w=0,C=0;b=+me[v>>3],w=+ka(+b),b=+la(+b),me[y+16>>3]=b,b=+me[v+8>>3],C=w*+ka(+b),me[y>>3]=C,b=w*+la(+b),me[y+8>>3]=b}function hb(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0;if(P=de,de=de+16|0,C=P,w=yi(v,y)|0,(b+-1|0)>>>0>5||(w=(w|0)!=0,(b|0)==1&w))return C=-1,de=P,C|0;do if(hd(v,y,C)|0)w=-1;else if(w){w=((_[26352+(b<<2)>>2]|0)+5-(_[C>>2]|0)|0)%5|0;break}else{w=((_[26384+(b<<2)>>2]|0)+6-(_[C>>2]|0)|0)%6|0;break}while(!1);return C=w,de=P,C|0}function hd(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0;if(ae=de,de=de+32|0,V=ae+16|0,$=ae,w=op(v,y,V)|0,w|0)return b=w,de=ae,b|0;P=Sw(v,y)|0,J=qo(v,y)|0,zl(P,$),w=sh(P,_[V>>2]|0)|0;do if(mi(P)|0){do switch(P|0){case 4:{C=0;break}case 14:{C=1;break}case 24:{C=2;break}case 38:{C=3;break}case 49:{C=4;break}case 58:{C=5;break}case 63:{C=6;break}case 72:{C=7;break}case 83:{C=8;break}case 97:{C=9;break}case 107:{C=10;break}case 117:{C=11;break}default:Dt(27795,27797,75,27806)}while(!1);if(k=_[26416+(C*24|0)+8>>2]|0,y=_[26416+(C*24|0)+16>>2]|0,v=_[V>>2]|0,(v|0)!=(_[$>>2]|0)&&($=ih(P)|0,v=_[V>>2]|0,$|(v|0)==(y|0)&&(w=(w+1|0)%6|0)),(J|0)==3&(v|0)==(y|0)){w=(w+5|0)%6|0;break}(J|0)==5&(v|0)==(k|0)&&(w=(w+1|0)%6|0)}while(!1);return _[b>>2]=w,b=0,de=ae,b|0}function $o(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0;if(lt=de,de=de+32|0,ut=lt+24|0,nt=lt+20|0,Oe=lt+8|0,De=lt+16|0,ke=lt,$=(yi(v,y)|0)==0,$=$?6:5,ae=Gt(v|0,y|0,52)|0,se()|0,ae=ae&15,$>>>0<=b>>>0)return w=2,de=lt,w|0;xe=(ae|0)==0,!xe&&($e=Jt(7,0,(ae^15)*3|0)|0,($e&v|0)==0&((se()|0)&y|0)==0)?C=b:P=4;e:do if((P|0)==4){if(C=(yi(v,y)|0)!=0,((C?4:5)|0)<(b|0)||hd(v,y,ut)|0||(P=(_[ut>>2]|0)+b|0,C?C=26704+(((P|0)%5|0)<<2)|0:C=26736+(((P|0)%6|0)<<2)|0,$e=_[C>>2]|0,($e|0)==7))return w=1,de=lt,w|0;_[nt>>2]=0,C=za(v,y,$e,nt,Oe)|0;do if(!C){if(V=Oe,J=_[V>>2]|0,V=_[V+4>>2]|0,k=V>>>0<y>>>0|(V|0)==(y|0)&J>>>0<v>>>0,P=k?J:v,k=k?V:y,!xe&&(xe=Jt(7,0,(ae^15)*3|0)|0,(J&xe|0)==0&(V&(se()|0)|0)==0))C=b;else{if(V=(b+-1+$|0)%($|0)|0,C=yi(v,y)|0,(V|0)<0&&Dt(27795,27797,248,27822),$=(C|0)!=0,(($?4:5)|0)<(V|0)&&Dt(27795,27797,248,27822),hd(v,y,ut)|0&&Dt(27795,27797,248,27822),C=(_[ut>>2]|0)+V|0,$?C=26704+(((C|0)%5|0)<<2)|0:C=26736+(((C|0)%6|0)<<2)|0,V=_[C>>2]|0,(V|0)==7&&Dt(27795,27797,248,27822),_[De>>2]=0,C=za(v,y,V,De,ke)|0,C|0)break;J=ke,$=_[J>>2]|0,J=_[J+4>>2]|0;do if(J>>>0<k>>>0|(J|0)==(k|0)&$>>>0<P>>>0){if(yi($,J)|0?P=Ci($,J,v,y)|0:P=_[26800+((((_[De>>2]|0)+(_[26768+(V<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,C=yi($,J)|0,(P+-1|0)>>>0>5){C=-1,P=$,k=J;break}if(C=(C|0)!=0,(P|0)==1&C){C=-1,P=$,k=J;break}do if(hd($,J,ut)|0)C=-1;else if(C){C=((_[26352+(P<<2)>>2]|0)+5-(_[ut>>2]|0)|0)%5|0;break}else{C=((_[26384+(P<<2)>>2]|0)+6-(_[ut>>2]|0)|0)%6|0;break}while(!1);P=$,k=J}else C=b;while(!1);V=Oe,J=_[V>>2]|0,V=_[V+4>>2]|0}if((P|0)==(J|0)&(k|0)==(V|0)){if($=(yi(J,V)|0)!=0,$?v=Ci(J,V,v,y)|0:v=_[26800+((((_[nt>>2]|0)+(_[26768+($e<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,C=yi(J,V)|0,(v+-1|0)>>>0<=5&&(At=(C|0)!=0,!((v|0)==1&At)))do if(hd(J,V,ut)|0)C=-1;else if(At){C=((_[26352+(v<<2)>>2]|0)+5-(_[ut>>2]|0)|0)%5|0;break}else{C=((_[26384+(v<<2)>>2]|0)+6-(_[ut>>2]|0)|0)%6|0;break}while(!1);else C=-1;C=C+1|0,C=(C|0)==6|$&(C|0)==5?0:C}y=k,v=P;break e}while(!1);return w=C,de=lt,w|0}while(!1);return At=Jt(C|0,0,56)|0,ut=se()|0|y&-2130706433|536870912,_[w>>2]=At|v,_[w+4>>2]=ut,w=0,de=lt,w|0}function Ap(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0;return P=(yi(v,y)|0)==0,w=$o(v,y,0,b)|0,C=(w|0)==0,P?!C||(w=$o(v,y,1,b+8|0)|0,w|0)||(w=$o(v,y,2,b+16|0)|0,w|0)||(w=$o(v,y,3,b+24|0)|0,w|0)||(w=$o(v,y,4,b+32|0)|0,w)?(P=w,P|0):$o(v,y,5,b+40|0)|0:!C||(w=$o(v,y,1,b+8|0)|0,w|0)||(w=$o(v,y,2,b+16|0)|0,w|0)||(w=$o(v,y,3,b+24|0)|0,w|0)||(w=$o(v,y,4,b+32|0)|0,w|0)?(P=w,P|0):(P=b+40|0,_[P>>2]=0,_[P+4>>2]=0,P=0,P|0)}function fd(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0,V=0,$=0;return $=de,de=de+192|0,C=$,P=$+168|0,k=Gt(v|0,y|0,56)|0,se()|0,k=k&7,V=y&-2130706433|134217728,w=op(v,V,P)|0,w|0?(V=w,de=$,V|0):(y=Gt(v|0,y|0,52)|0,se()|0,y=y&15,yi(v,V)|0?Go(P,y,k,1,C):cd(P,y,k,1,C),V=C+8|0,_[b>>2]=_[V>>2],_[b+4>>2]=_[V+4>>2],_[b+8>>2]=_[V+8>>2],_[b+12>>2]=_[V+12>>2],V=0,de=$,V|0)}function pd(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0;return C=de,de=de+16|0,b=C,!(!0&(y&2013265920|0)==536870912)||(w=y&-2130706433|134217728,!(w1(v,w)|0))?(w=0,de=C,w|0):(P=Gt(v|0,y|0,56)|0,se()|0,P=($o(v,w,P&7,b)|0)==0,w=b,w=P&((_[w>>2]|0)==(v|0)?(_[w+4>>2]|0)==(y|0):0)&1,de=C,w|0)}function Cu(v,y,b){v=v|0,y=y|0,b=b|0;var w=0;(y|0)>0?(w=Ko(y,4)|0,_[v>>2]=w,w||Dt(27835,27858,40,27872)):_[v>>2]=0,_[v+4>>2]=y,_[v+8>>2]=0,_[v+12>>2]=b}function O1(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0;C=v+4|0,P=v+12|0,k=v+8|0;e:for(;;){for(b=_[C>>2]|0,y=0;;){if((y|0)>=(b|0))break e;if(w=_[v>>2]|0,V=_[w+(y<<2)>>2]|0,!V)y=y+1|0;else break}y=w+(~~(+Ln(+(+Kr(10,+ +(15-(_[P>>2]|0)|0))*(+me[V>>3]+ +me[V+8>>3])))%+(b|0))>>>0<<2)|0,b=_[y>>2]|0;t:do if(b|0){if(w=V+32|0,(b|0)==(V|0))_[y>>2]=_[w>>2];else{if(b=b+32|0,y=_[b>>2]|0,!y)break;for(;(y|0)!=(V|0);)if(b=y+32|0,y=_[b>>2]|0,!y)break t;_[b>>2]=_[w>>2]}Un(V),_[k>>2]=(_[k>>2]|0)+-1}while(!1)}Un(_[v>>2]|0)}function F1(v){v=v|0;var y=0,b=0,w=0;for(w=_[v+4>>2]|0,b=0;;){if((b|0)>=(w|0)){y=0,b=4;break}if(y=_[(_[v>>2]|0)+(b<<2)>>2]|0,!y)b=b+1|0;else{b=4;break}}return(b|0)==4?y|0:0}function yp(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0;if(b=~~(+Ln(+(+Kr(10,+ +(15-(_[v+12>>2]|0)|0))*(+me[y>>3]+ +me[y+8>>3])))%+(_[v+4>>2]|0))>>>0,b=(_[v>>2]|0)+(b<<2)|0,w=_[b>>2]|0,!w)return P=1,P|0;P=y+32|0;do if((w|0)!=(y|0)){if(b=_[w+32>>2]|0,!b)return P=1,P|0;for(C=b;;){if((C|0)==(y|0)){C=8;break}if(b=_[C+32>>2]|0,b)w=C,C=b;else{b=1,C=10;break}}if((C|0)==8){_[w+32>>2]=_[P>>2];break}else if((C|0)==10)return b|0}else _[b>>2]=_[P>>2];while(!1);return Un(y),P=v+8|0,_[P>>2]=(_[P>>2]|0)+-1,P=0,P|0}function j1(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0;P=Nu(40)|0,P||Dt(27888,27858,98,27901),_[P>>2]=_[y>>2],_[P+4>>2]=_[y+4>>2],_[P+8>>2]=_[y+8>>2],_[P+12>>2]=_[y+12>>2],C=P+16|0,_[C>>2]=_[b>>2],_[C+4>>2]=_[b+4>>2],_[C+8>>2]=_[b+8>>2],_[C+12>>2]=_[b+12>>2],_[P+32>>2]=0,C=~~(+Ln(+(+Kr(10,+ +(15-(_[v+12>>2]|0)|0))*(+me[y>>3]+ +me[y+8>>3])))%+(_[v+4>>2]|0))>>>0,C=(_[v>>2]|0)+(C<<2)|0,w=_[C>>2]|0;do if(!w)_[C>>2]=P;else{for(;!(Hl(w,y)|0&&Hl(w+16|0,b)|0);)if(C=_[w+32>>2]|0,w=(C|0)==0?w:C,!(_[w+32>>2]|0)){k=10;break}if((k|0)==10){_[w+32>>2]=P;break}return Un(P),k=w,k|0}while(!1);return k=v+8|0,_[k>>2]=(_[k>>2]|0)+1,k=P,k|0}function vp(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0;if(C=~~(+Ln(+(+Kr(10,+ +(15-(_[v+12>>2]|0)|0))*(+me[y>>3]+ +me[y+8>>3])))%+(_[v+4>>2]|0))>>>0,C=_[(_[v>>2]|0)+(C<<2)>>2]|0,!C)return b=0,b|0;if(!b){for(v=C;;){if(Hl(v,y)|0){w=10;break}if(v=_[v+32>>2]|0,!v){v=0,w=10;break}}if((w|0)==10)return v|0}for(v=C;;){if(Hl(v,y)|0&&Hl(v+16|0,b)|0){w=10;break}if(v=_[v+32>>2]|0,!v){v=0,w=10;break}}return(w|0)==10?v|0:0}function Dr(v,y){v=v|0,y=y|0;var b=0;if(b=~~(+Ln(+(+Kr(10,+ +(15-(_[v+12>>2]|0)|0))*(+me[y>>3]+ +me[y+8>>3])))%+(_[v+4>>2]|0))>>>0,v=_[(_[v>>2]|0)+(b<<2)>>2]|0,!v)return b=0,b|0;for(;;){if(Hl(v,y)|0){y=5;break}if(v=_[v+32>>2]|0,!v){v=0,y=5;break}}return(y|0)==5?v|0:0}function B1(){return 27920}function md(v){return v=+v,~~+J0(+v)|0}function Nu(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0,$e=0,nt=0,At=0,ut=0,lt=0,Ke=0,en=0;en=de,de=de+16|0,ke=en;do if(v>>>0<245){if(J=v>>>0<11?16:v+11&-8,v=J>>>3,xe=_[6981]|0,b=xe>>>v,b&3|0)return y=(b&1^1)+v|0,v=27964+(y<<1<<2)|0,b=v+8|0,w=_[b>>2]|0,C=w+8|0,P=_[C>>2]|0,(P|0)==(v|0)?_[6981]=xe&~(1<<y):(_[P+12>>2]=v,_[b>>2]=P),Ke=y<<3,_[w+4>>2]=Ke|3,Ke=w+Ke+4|0,_[Ke>>2]=_[Ke>>2]|1,Ke=C,de=en,Ke|0;if(ae=_[6983]|0,J>>>0>ae>>>0){if(b|0)return y=2<<v,y=b<<v&(y|0-y),y=(y&0-y)+-1|0,V=y>>>12&16,y=y>>>V,b=y>>>5&8,y=y>>>b,P=y>>>2&4,y=y>>>P,v=y>>>1&2,y=y>>>v,w=y>>>1&1,w=(b|V|P|v|w)+(y>>>w)|0,y=27964+(w<<1<<2)|0,v=y+8|0,P=_[v>>2]|0,V=P+8|0,b=_[V>>2]|0,(b|0)==(y|0)?(v=xe&~(1<<w),_[6981]=v):(_[b+12>>2]=y,_[v>>2]=b,v=xe),Ke=w<<3,k=Ke-J|0,_[P+4>>2]=J|3,C=P+J|0,_[C+4>>2]=k|1,_[P+Ke>>2]=k,ae|0&&(w=_[6986]|0,y=ae>>>3,b=27964+(y<<1<<2)|0,y=1<<y,v&y?(v=b+8|0,y=_[v>>2]|0):(_[6981]=v|y,y=b,v=b+8|0),_[v>>2]=w,_[y+12>>2]=w,_[w+8>>2]=y,_[w+12>>2]=b),_[6983]=k,_[6986]=C,Ke=V,de=en,Ke|0;if(P=_[6982]|0,P){for(b=(P&0-P)+-1|0,C=b>>>12&16,b=b>>>C,w=b>>>5&8,b=b>>>w,k=b>>>2&4,b=b>>>k,V=b>>>1&2,b=b>>>V,$=b>>>1&1,$=_[28228+((w|C|k|V|$)+(b>>>$)<<2)>>2]|0,b=$,V=$,$=(_[$+4>>2]&-8)-J|0;v=_[b+16>>2]|0,!(!v&&(v=_[b+20>>2]|0,!v));)k=(_[v+4>>2]&-8)-J|0,C=k>>>0<$>>>0,b=v,V=C?v:V,$=C?k:$;if(k=V+J|0,k>>>0>V>>>0){C=_[V+24>>2]|0,y=_[V+12>>2]|0;do if((y|0)==(V|0)){if(v=V+20|0,y=_[v>>2]|0,!y&&(v=V+16|0,y=_[v>>2]|0,!y)){b=0;break}for(;;)if(w=y+20|0,b=_[w>>2]|0,b)y=b,v=w;else if(w=y+16|0,b=_[w>>2]|0,b)y=b,v=w;else break;_[v>>2]=0,b=y}else b=_[V+8>>2]|0,_[b+12>>2]=y,_[y+8>>2]=b,b=y;while(!1);do if(C|0){if(y=_[V+28>>2]|0,v=28228+(y<<2)|0,(V|0)==(_[v>>2]|0)){if(_[v>>2]=b,!b){_[6982]=P&~(1<<y);break}}else if(Ke=C+16|0,_[((_[Ke>>2]|0)==(V|0)?Ke:C+20|0)>>2]=b,!b)break;_[b+24>>2]=C,y=_[V+16>>2]|0,y|0&&(_[b+16>>2]=y,_[y+24>>2]=b),y=_[V+20>>2]|0,y|0&&(_[b+20>>2]=y,_[y+24>>2]=b)}while(!1);return $>>>0<16?(Ke=$+J|0,_[V+4>>2]=Ke|3,Ke=V+Ke+4|0,_[Ke>>2]=_[Ke>>2]|1):(_[V+4>>2]=J|3,_[k+4>>2]=$|1,_[k+$>>2]=$,ae|0&&(w=_[6986]|0,y=ae>>>3,b=27964+(y<<1<<2)|0,y=1<<y,y&xe?(v=b+8|0,y=_[v>>2]|0):(_[6981]=y|xe,y=b,v=b+8|0),_[v>>2]=w,_[y+12>>2]=w,_[w+8>>2]=y,_[w+12>>2]=b),_[6983]=$,_[6986]=k),Ke=V+8|0,de=en,Ke|0}else xe=J}else xe=J}else xe=J}else if(v>>>0<=4294967231)if(v=v+11|0,J=v&-8,w=_[6982]|0,w){C=0-J|0,v=v>>>8,v?J>>>0>16777215?$=31:(xe=(v+1048320|0)>>>16&8,$e=v<<xe,V=($e+520192|0)>>>16&4,$e=$e<<V,$=($e+245760|0)>>>16&2,$=14-(V|xe|$)+($e<<$>>>15)|0,$=J>>>($+7|0)&1|$<<1):$=0,b=_[28228+($<<2)>>2]|0;e:do if(!b)b=0,v=0,$e=61;else for(v=0,V=J<<(($|0)==31?0:25-($>>>1)|0),P=0;;){if(k=(_[b+4>>2]&-8)-J|0,k>>>0<C>>>0)if(k)v=b,C=k;else{v=b,C=0,$e=65;break e}if($e=_[b+20>>2]|0,b=_[b+16+(V>>>31<<2)>>2]|0,P=($e|0)==0|($e|0)==(b|0)?P:$e,b)V=V<<1;else{b=P,$e=61;break}}while(!1);if(($e|0)==61){if((b|0)==0&(v|0)==0){if(v=2<<$,v=(v|0-v)&w,!v){xe=J;break}xe=(v&0-v)+-1|0,k=xe>>>12&16,xe=xe>>>k,P=xe>>>5&8,xe=xe>>>P,V=xe>>>2&4,xe=xe>>>V,$=xe>>>1&2,xe=xe>>>$,b=xe>>>1&1,v=0,b=_[28228+((P|k|V|$|b)+(xe>>>b)<<2)>>2]|0}b?$e=65:(V=v,k=C)}if(($e|0)==65)for(P=b;;)if(xe=(_[P+4>>2]&-8)-J|0,b=xe>>>0<C>>>0,C=b?xe:C,v=b?P:v,b=_[P+16>>2]|0,b||(b=_[P+20>>2]|0),b)P=b;else{V=v,k=C;break}if((V|0)!=0&&k>>>0<((_[6983]|0)-J|0)>>>0&&(ae=V+J|0,ae>>>0>V>>>0)){P=_[V+24>>2]|0,y=_[V+12>>2]|0;do if((y|0)==(V|0)){if(v=V+20|0,y=_[v>>2]|0,!y&&(v=V+16|0,y=_[v>>2]|0,!y)){y=0;break}for(;;)if(C=y+20|0,b=_[C>>2]|0,b)y=b,v=C;else if(C=y+16|0,b=_[C>>2]|0,b)y=b,v=C;else break;_[v>>2]=0}else Ke=_[V+8>>2]|0,_[Ke+12>>2]=y,_[y+8>>2]=Ke;while(!1);do if(P){if(v=_[V+28>>2]|0,b=28228+(v<<2)|0,(V|0)==(_[b>>2]|0)){if(_[b>>2]=y,!y){w=w&~(1<<v),_[6982]=w;break}}else if(Ke=P+16|0,_[((_[Ke>>2]|0)==(V|0)?Ke:P+20|0)>>2]=y,!y)break;_[y+24>>2]=P,v=_[V+16>>2]|0,v|0&&(_[y+16>>2]=v,_[v+24>>2]=y),v=_[V+20>>2]|0,v&&(_[y+20>>2]=v,_[v+24>>2]=y)}while(!1);e:do if(k>>>0<16)Ke=k+J|0,_[V+4>>2]=Ke|3,Ke=V+Ke+4|0,_[Ke>>2]=_[Ke>>2]|1;else{if(_[V+4>>2]=J|3,_[ae+4>>2]=k|1,_[ae+k>>2]=k,y=k>>>3,k>>>0<256){b=27964+(y<<1<<2)|0,v=_[6981]|0,y=1<<y,v&y?(v=b+8|0,y=_[v>>2]|0):(_[6981]=v|y,y=b,v=b+8|0),_[v>>2]=ae,_[y+12>>2]=ae,_[ae+8>>2]=y,_[ae+12>>2]=b;break}if(y=k>>>8,y?k>>>0>16777215?b=31:(lt=(y+1048320|0)>>>16&8,Ke=y<<lt,ut=(Ke+520192|0)>>>16&4,Ke=Ke<<ut,b=(Ke+245760|0)>>>16&2,b=14-(ut|lt|b)+(Ke<<b>>>15)|0,b=k>>>(b+7|0)&1|b<<1):b=0,y=28228+(b<<2)|0,_[ae+28>>2]=b,v=ae+16|0,_[v+4>>2]=0,_[v>>2]=0,v=1<<b,!(w&v)){_[6982]=w|v,_[y>>2]=ae,_[ae+24>>2]=y,_[ae+12>>2]=ae,_[ae+8>>2]=ae;break}y=_[y>>2]|0;t:do if((_[y+4>>2]&-8|0)!=(k|0)){for(w=k<<((b|0)==31?0:25-(b>>>1)|0);b=y+16+(w>>>31<<2)|0,v=_[b>>2]|0,!!v;)if((_[v+4>>2]&-8|0)==(k|0)){y=v;break t}else w=w<<1,y=v;_[b>>2]=ae,_[ae+24>>2]=y,_[ae+12>>2]=ae,_[ae+8>>2]=ae;break e}while(!1);lt=y+8|0,Ke=_[lt>>2]|0,_[Ke+12>>2]=ae,_[lt>>2]=ae,_[ae+8>>2]=Ke,_[ae+12>>2]=y,_[ae+24>>2]=0}while(!1);return Ke=V+8|0,de=en,Ke|0}else xe=J}else xe=J;else xe=-1;while(!1);if(b=_[6983]|0,b>>>0>=xe>>>0)return y=b-xe|0,v=_[6986]|0,y>>>0>15?(Ke=v+xe|0,_[6986]=Ke,_[6983]=y,_[Ke+4>>2]=y|1,_[v+b>>2]=y,_[v+4>>2]=xe|3):(_[6983]=0,_[6986]=0,_[v+4>>2]=b|3,Ke=v+b+4|0,_[Ke>>2]=_[Ke>>2]|1),Ke=v+8|0,de=en,Ke|0;if(k=_[6984]|0,k>>>0>xe>>>0)return ut=k-xe|0,_[6984]=ut,Ke=_[6987]|0,lt=Ke+xe|0,_[6987]=lt,_[lt+4>>2]=ut|1,_[Ke+4>>2]=xe|3,Ke=Ke+8|0,de=en,Ke|0;if(_[7099]|0?v=_[7101]|0:(_[7101]=4096,_[7100]=4096,_[7102]=-1,_[7103]=-1,_[7104]=0,_[7092]=0,_[7099]=ke&-16^1431655768,v=4096),V=xe+48|0,$=xe+47|0,P=v+$|0,C=0-v|0,J=P&C,J>>>0<=xe>>>0||(v=_[7091]|0,v|0&&(ae=_[7089]|0,ke=ae+J|0,ke>>>0<=ae>>>0|ke>>>0>v>>>0)))return Ke=0,de=en,Ke|0;e:do if(_[7092]&4)y=0,$e=143;else{b=_[6987]|0;t:do if(b){for(w=28372;ke=_[w>>2]|0,!(ke>>>0<=b>>>0&&(ke+(_[w+4>>2]|0)|0)>>>0>b>>>0);)if(v=_[w+8>>2]|0,v)w=v;else{$e=128;break t}if(y=P-k&C,y>>>0<2147483647)if(v=Ad(y|0)|0,(v|0)==((_[w>>2]|0)+(_[w+4>>2]|0)|0)){if((v|0)!=-1){k=y,P=v,$e=145;break e}}else w=v,$e=136;else y=0}else $e=128;while(!1);do if(($e|0)==128)if(b=Ad(0)|0,(b|0)!=-1&&(y=b,De=_[7100]|0,Oe=De+-1|0,y=((Oe&y|0)==0?0:(Oe+y&0-De)-y|0)+J|0,De=_[7089]|0,Oe=y+De|0,y>>>0>xe>>>0&y>>>0<2147483647)){if(ke=_[7091]|0,ke|0&&Oe>>>0<=De>>>0|Oe>>>0>ke>>>0){y=0;break}if(v=Ad(y|0)|0,(v|0)==(b|0)){k=y,P=b,$e=145;break e}else w=v,$e=136}else y=0;while(!1);do if(($e|0)==136){if(b=0-y|0,!(V>>>0>y>>>0&(y>>>0<2147483647&(w|0)!=-1)))if((w|0)==-1){y=0;break}else{k=y,P=w,$e=145;break e}if(v=_[7101]|0,v=$-y+v&0-v,v>>>0>=2147483647){k=y,P=w,$e=145;break e}if((Ad(v|0)|0)==-1){Ad(b|0)|0,y=0;break}else{k=v+y|0,P=w,$e=145;break e}}while(!1);_[7092]=_[7092]|4,$e=143}while(!1);if(($e|0)==143&&J>>>0<2147483647&&(ut=Ad(J|0)|0,Oe=Ad(0)|0,nt=Oe-ut|0,At=nt>>>0>(xe+40|0)>>>0,!((ut|0)==-1|At^1|ut>>>0<Oe>>>0&((ut|0)!=-1&(Oe|0)!=-1)^1))&&(k=At?nt:y,P=ut,$e=145),($e|0)==145){y=(_[7089]|0)+k|0,_[7089]=y,y>>>0>(_[7090]|0)>>>0&&(_[7090]=y),$=_[6987]|0;e:do if($){for(y=28372;;){if(v=_[y>>2]|0,b=_[y+4>>2]|0,(P|0)==(v+b|0)){$e=154;break}if(w=_[y+8>>2]|0,w)y=w;else break}if(($e|0)==154&&(lt=y+4|0,(_[y+12>>2]&8|0)==0)&&P>>>0>$>>>0&v>>>0<=$>>>0){_[lt>>2]=b+k,Ke=(_[6984]|0)+k|0,ut=$+8|0,ut=(ut&7|0)==0?0:0-ut&7,lt=$+ut|0,ut=Ke-ut|0,_[6987]=lt,_[6984]=ut,_[lt+4>>2]=ut|1,_[$+Ke+4>>2]=40,_[6988]=_[7103];break}for(P>>>0<(_[6985]|0)>>>0&&(_[6985]=P),b=P+k|0,y=28372;;){if((_[y>>2]|0)==(b|0)){$e=162;break}if(v=_[y+8>>2]|0,v)y=v;else break}if(($e|0)==162&&(_[y+12>>2]&8|0)==0){_[y>>2]=P,ae=y+4|0,_[ae>>2]=(_[ae>>2]|0)+k,ae=P+8|0,ae=P+((ae&7|0)==0?0:0-ae&7)|0,y=b+8|0,y=b+((y&7|0)==0?0:0-y&7)|0,J=ae+xe|0,V=y-ae-xe|0,_[ae+4>>2]=xe|3;t:do if(($|0)==(y|0))Ke=(_[6984]|0)+V|0,_[6984]=Ke,_[6987]=J,_[J+4>>2]=Ke|1;else{if((_[6986]|0)==(y|0)){Ke=(_[6983]|0)+V|0,_[6983]=Ke,_[6986]=J,_[J+4>>2]=Ke|1,_[J+Ke>>2]=Ke;break}if(v=_[y+4>>2]|0,(v&3|0)==1){k=v&-8,w=v>>>3;n:do if(v>>>0<256)if(v=_[y+8>>2]|0,b=_[y+12>>2]|0,(b|0)==(v|0)){_[6981]=_[6981]&~(1<<w);break}else{_[v+12>>2]=b,_[b+8>>2]=v;break}else{P=_[y+24>>2]|0,v=_[y+12>>2]|0;do if((v|0)==(y|0)){if(b=y+16|0,w=b+4|0,v=_[w>>2]|0,v)b=w;else if(v=_[b>>2]|0,!v){v=0;break}for(;;)if(C=v+20|0,w=_[C>>2]|0,w)v=w,b=C;else if(C=v+16|0,w=_[C>>2]|0,w)v=w,b=C;else break;_[b>>2]=0}else Ke=_[y+8>>2]|0,_[Ke+12>>2]=v,_[v+8>>2]=Ke;while(!1);if(!P)break;b=_[y+28>>2]|0,w=28228+(b<<2)|0;do if((_[w>>2]|0)!=(y|0)){if(Ke=P+16|0,_[((_[Ke>>2]|0)==(y|0)?Ke:P+20|0)>>2]=v,!v)break n}else{if(_[w>>2]=v,v|0)break;_[6982]=_[6982]&~(1<<b);break n}while(!1);if(_[v+24>>2]=P,b=y+16|0,w=_[b>>2]|0,w|0&&(_[v+16>>2]=w,_[w+24>>2]=v),b=_[b+4>>2]|0,!b)break;_[v+20>>2]=b,_[b+24>>2]=v}while(!1);y=y+k|0,C=k+V|0}else C=V;if(y=y+4|0,_[y>>2]=_[y>>2]&-2,_[J+4>>2]=C|1,_[J+C>>2]=C,y=C>>>3,C>>>0<256){b=27964+(y<<1<<2)|0,v=_[6981]|0,y=1<<y,v&y?(v=b+8|0,y=_[v>>2]|0):(_[6981]=v|y,y=b,v=b+8|0),_[v>>2]=J,_[y+12>>2]=J,_[J+8>>2]=y,_[J+12>>2]=b;break}y=C>>>8;do if(!y)w=0;else{if(C>>>0>16777215){w=31;break}lt=(y+1048320|0)>>>16&8,Ke=y<<lt,ut=(Ke+520192|0)>>>16&4,Ke=Ke<<ut,w=(Ke+245760|0)>>>16&2,w=14-(ut|lt|w)+(Ke<<w>>>15)|0,w=C>>>(w+7|0)&1|w<<1}while(!1);if(y=28228+(w<<2)|0,_[J+28>>2]=w,v=J+16|0,_[v+4>>2]=0,_[v>>2]=0,v=_[6982]|0,b=1<<w,!(v&b)){_[6982]=v|b,_[y>>2]=J,_[J+24>>2]=y,_[J+12>>2]=J,_[J+8>>2]=J;break}y=_[y>>2]|0;n:do if((_[y+4>>2]&-8|0)!=(C|0)){for(w=C<<((w|0)==31?0:25-(w>>>1)|0);b=y+16+(w>>>31<<2)|0,v=_[b>>2]|0,!!v;)if((_[v+4>>2]&-8|0)==(C|0)){y=v;break n}else w=w<<1,y=v;_[b>>2]=J,_[J+24>>2]=y,_[J+12>>2]=J,_[J+8>>2]=J;break t}while(!1);lt=y+8|0,Ke=_[lt>>2]|0,_[Ke+12>>2]=J,_[lt>>2]=J,_[J+8>>2]=Ke,_[J+12>>2]=y,_[J+24>>2]=0}while(!1);return Ke=ae+8|0,de=en,Ke|0}for(y=28372;v=_[y>>2]|0,!(v>>>0<=$>>>0&&(Ke=v+(_[y+4>>2]|0)|0,Ke>>>0>$>>>0));)y=_[y+8>>2]|0;C=Ke+-47|0,v=C+8|0,v=C+((v&7|0)==0?0:0-v&7)|0,C=$+16|0,v=v>>>0<C>>>0?$:v,y=v+8|0,b=k+-40|0,ut=P+8|0,ut=(ut&7|0)==0?0:0-ut&7,lt=P+ut|0,ut=b-ut|0,_[6987]=lt,_[6984]=ut,_[lt+4>>2]=ut|1,_[P+b+4>>2]=40,_[6988]=_[7103],b=v+4|0,_[b>>2]=27,_[y>>2]=_[7093],_[y+4>>2]=_[7094],_[y+8>>2]=_[7095],_[y+12>>2]=_[7096],_[7093]=P,_[7094]=k,_[7096]=0,_[7095]=y,y=v+24|0;do lt=y,y=y+4|0,_[y>>2]=7;while((lt+8|0)>>>0<Ke>>>0);if((v|0)!=($|0)){if(P=v-$|0,_[b>>2]=_[b>>2]&-2,_[$+4>>2]=P|1,_[v>>2]=P,y=P>>>3,P>>>0<256){b=27964+(y<<1<<2)|0,v=_[6981]|0,y=1<<y,v&y?(v=b+8|0,y=_[v>>2]|0):(_[6981]=v|y,y=b,v=b+8|0),_[v>>2]=$,_[y+12>>2]=$,_[$+8>>2]=y,_[$+12>>2]=b;break}if(y=P>>>8,y?P>>>0>16777215?w=31:(lt=(y+1048320|0)>>>16&8,Ke=y<<lt,ut=(Ke+520192|0)>>>16&4,Ke=Ke<<ut,w=(Ke+245760|0)>>>16&2,w=14-(ut|lt|w)+(Ke<<w>>>15)|0,w=P>>>(w+7|0)&1|w<<1):w=0,b=28228+(w<<2)|0,_[$+28>>2]=w,_[$+20>>2]=0,_[C>>2]=0,y=_[6982]|0,v=1<<w,!(y&v)){_[6982]=y|v,_[b>>2]=$,_[$+24>>2]=b,_[$+12>>2]=$,_[$+8>>2]=$;break}y=_[b>>2]|0;t:do if((_[y+4>>2]&-8|0)!=(P|0)){for(w=P<<((w|0)==31?0:25-(w>>>1)|0);b=y+16+(w>>>31<<2)|0,v=_[b>>2]|0,!!v;)if((_[v+4>>2]&-8|0)==(P|0)){y=v;break t}else w=w<<1,y=v;_[b>>2]=$,_[$+24>>2]=y,_[$+12>>2]=$,_[$+8>>2]=$;break e}while(!1);lt=y+8|0,Ke=_[lt>>2]|0,_[Ke+12>>2]=$,_[lt>>2]=$,_[$+8>>2]=Ke,_[$+12>>2]=y,_[$+24>>2]=0}}else Ke=_[6985]|0,(Ke|0)==0|P>>>0<Ke>>>0&&(_[6985]=P),_[7093]=P,_[7094]=k,_[7096]=0,_[6990]=_[7099],_[6989]=-1,_[6994]=27964,_[6993]=27964,_[6996]=27972,_[6995]=27972,_[6998]=27980,_[6997]=27980,_[7e3]=27988,_[6999]=27988,_[7002]=27996,_[7001]=27996,_[7004]=28004,_[7003]=28004,_[7006]=28012,_[7005]=28012,_[7008]=28020,_[7007]=28020,_[7010]=28028,_[7009]=28028,_[7012]=28036,_[7011]=28036,_[7014]=28044,_[7013]=28044,_[7016]=28052,_[7015]=28052,_[7018]=28060,_[7017]=28060,_[7020]=28068,_[7019]=28068,_[7022]=28076,_[7021]=28076,_[7024]=28084,_[7023]=28084,_[7026]=28092,_[7025]=28092,_[7028]=28100,_[7027]=28100,_[7030]=28108,_[7029]=28108,_[7032]=28116,_[7031]=28116,_[7034]=28124,_[7033]=28124,_[7036]=28132,_[7035]=28132,_[7038]=28140,_[7037]=28140,_[7040]=28148,_[7039]=28148,_[7042]=28156,_[7041]=28156,_[7044]=28164,_[7043]=28164,_[7046]=28172,_[7045]=28172,_[7048]=28180,_[7047]=28180,_[7050]=28188,_[7049]=28188,_[7052]=28196,_[7051]=28196,_[7054]=28204,_[7053]=28204,_[7056]=28212,_[7055]=28212,Ke=k+-40|0,ut=P+8|0,ut=(ut&7|0)==0?0:0-ut&7,lt=P+ut|0,ut=Ke-ut|0,_[6987]=lt,_[6984]=ut,_[lt+4>>2]=ut|1,_[P+Ke+4>>2]=40,_[6988]=_[7103];while(!1);if(y=_[6984]|0,y>>>0>xe>>>0)return ut=y-xe|0,_[6984]=ut,Ke=_[6987]|0,lt=Ke+xe|0,_[6987]=lt,_[lt+4>>2]=ut|1,_[Ke+4>>2]=xe|3,Ke=Ke+8|0,de=en,Ke|0}return Ke=B1()|0,_[Ke>>2]=12,Ke=0,de=en,Ke|0}function Un(v){v=v|0;var y=0,b=0,w=0,C=0,P=0,k=0,V=0,$=0;if(v){b=v+-8|0,C=_[6985]|0,v=_[v+-4>>2]|0,y=v&-8,$=b+y|0;do if(v&1)V=b,k=b;else{if(w=_[b>>2]|0,!(v&3)||(k=b+(0-w)|0,P=w+y|0,k>>>0<C>>>0))return;if((_[6986]|0)==(k|0)){if(v=$+4|0,y=_[v>>2]|0,(y&3|0)!=3){V=k,y=P;break}_[6983]=P,_[v>>2]=y&-2,_[k+4>>2]=P|1,_[k+P>>2]=P;return}if(b=w>>>3,w>>>0<256)if(v=_[k+8>>2]|0,y=_[k+12>>2]|0,(y|0)==(v|0)){_[6981]=_[6981]&~(1<<b),V=k,y=P;break}else{_[v+12>>2]=y,_[y+8>>2]=v,V=k,y=P;break}C=_[k+24>>2]|0,v=_[k+12>>2]|0;do if((v|0)==(k|0)){if(y=k+16|0,b=y+4|0,v=_[b>>2]|0,v)y=b;else if(v=_[y>>2]|0,!v){v=0;break}for(;;)if(w=v+20|0,b=_[w>>2]|0,b)v=b,y=w;else if(w=v+16|0,b=_[w>>2]|0,b)v=b,y=w;else break;_[y>>2]=0}else V=_[k+8>>2]|0,_[V+12>>2]=v,_[v+8>>2]=V;while(!1);if(C){if(y=_[k+28>>2]|0,b=28228+(y<<2)|0,(_[b>>2]|0)==(k|0)){if(_[b>>2]=v,!v){_[6982]=_[6982]&~(1<<y),V=k,y=P;break}}else if(V=C+16|0,_[((_[V>>2]|0)==(k|0)?V:C+20|0)>>2]=v,!v){V=k,y=P;break}_[v+24>>2]=C,y=k+16|0,b=_[y>>2]|0,b|0&&(_[v+16>>2]=b,_[b+24>>2]=v),y=_[y+4>>2]|0,y?(_[v+20>>2]=y,_[y+24>>2]=v,V=k,y=P):(V=k,y=P)}else V=k,y=P}while(!1);if(!(k>>>0>=$>>>0)&&(v=$+4|0,w=_[v>>2]|0,!!(w&1))){if(w&2)_[v>>2]=w&-2,_[V+4>>2]=y|1,_[k+y>>2]=y,C=y;else{if((_[6987]|0)==($|0)){if($=(_[6984]|0)+y|0,_[6984]=$,_[6987]=V,_[V+4>>2]=$|1,(V|0)!=(_[6986]|0))return;_[6986]=0,_[6983]=0;return}if((_[6986]|0)==($|0)){$=(_[6983]|0)+y|0,_[6983]=$,_[6986]=k,_[V+4>>2]=$|1,_[k+$>>2]=$;return}C=(w&-8)+y|0,b=w>>>3;do if(w>>>0<256)if(y=_[$+8>>2]|0,v=_[$+12>>2]|0,(v|0)==(y|0)){_[6981]=_[6981]&~(1<<b);break}else{_[y+12>>2]=v,_[v+8>>2]=y;break}else{P=_[$+24>>2]|0,v=_[$+12>>2]|0;do if((v|0)==($|0)){if(y=$+16|0,b=y+4|0,v=_[b>>2]|0,v)y=b;else if(v=_[y>>2]|0,!v){b=0;break}for(;;)if(w=v+20|0,b=_[w>>2]|0,b)v=b,y=w;else if(w=v+16|0,b=_[w>>2]|0,b)v=b,y=w;else break;_[y>>2]=0,b=v}else b=_[$+8>>2]|0,_[b+12>>2]=v,_[v+8>>2]=b,b=v;while(!1);if(P|0){if(v=_[$+28>>2]|0,y=28228+(v<<2)|0,(_[y>>2]|0)==($|0)){if(_[y>>2]=b,!b){_[6982]=_[6982]&~(1<<v);break}}else if(w=P+16|0,_[((_[w>>2]|0)==($|0)?w:P+20|0)>>2]=b,!b)break;_[b+24>>2]=P,v=$+16|0,y=_[v>>2]|0,y|0&&(_[b+16>>2]=y,_[y+24>>2]=b),v=_[v+4>>2]|0,v|0&&(_[b+20>>2]=v,_[v+24>>2]=b)}}while(!1);if(_[V+4>>2]=C|1,_[k+C>>2]=C,(V|0)==(_[6986]|0)){_[6983]=C;return}}if(v=C>>>3,C>>>0<256){b=27964+(v<<1<<2)|0,y=_[6981]|0,v=1<<v,y&v?(y=b+8|0,v=_[y>>2]|0):(_[6981]=y|v,v=b,y=b+8|0),_[y>>2]=V,_[v+12>>2]=V,_[V+8>>2]=v,_[V+12>>2]=b;return}v=C>>>8,v?C>>>0>16777215?w=31:(k=(v+1048320|0)>>>16&8,$=v<<k,P=($+520192|0)>>>16&4,$=$<<P,w=($+245760|0)>>>16&2,w=14-(P|k|w)+($<<w>>>15)|0,w=C>>>(w+7|0)&1|w<<1):w=0,v=28228+(w<<2)|0,_[V+28>>2]=w,_[V+20>>2]=0,_[V+16>>2]=0,y=_[6982]|0,b=1<<w;e:do if(!(y&b))_[6982]=y|b,_[v>>2]=V,_[V+24>>2]=v,_[V+12>>2]=V,_[V+8>>2]=V;else{v=_[v>>2]|0;t:do if((_[v+4>>2]&-8|0)!=(C|0)){for(w=C<<((w|0)==31?0:25-(w>>>1)|0);b=v+16+(w>>>31<<2)|0,y=_[b>>2]|0,!!y;)if((_[y+4>>2]&-8|0)==(C|0)){v=y;break t}else w=w<<1,v=y;_[b>>2]=V,_[V+24>>2]=v,_[V+12>>2]=V,_[V+8>>2]=V;break e}while(!1);k=v+8|0,$=_[k>>2]|0,_[$+12>>2]=V,_[k>>2]=V,_[V+8>>2]=$,_[V+12>>2]=v,_[V+24>>2]=0}while(!1);if($=(_[6989]|0)+-1|0,_[6989]=$,!($|0)){for(v=28380;v=_[v>>2]|0,v;)v=v+8|0;_[6989]=-1}}}}function Ko(v,y){v=v|0,y=y|0;var b=0;return v?(b=Ps(y,v)|0,(y|v)>>>0>65535&&(b=((b>>>0)/(v>>>0)|0|0)==(y|0)?b:-1)):b=0,v=Nu(b)|0,!v||!(_[v+-4>>2]&3)||Vc(v|0,0,b|0)|0,v|0}function fn(v,y,b,w){return v=v|0,y=y|0,b=b|0,w=w|0,b=v+b>>>0,Ze(y+w+(b>>>0<v>>>0|0)>>>0|0),b|0|0}function $s(v,y,b,w){return v=v|0,y=y|0,b=b|0,w=w|0,w=y-w-(b>>>0>v>>>0|0)>>>0,Ze(w|0),v-b>>>0|0|0}function Vm(v){return v=v|0,(v?31-(St(v^v-1)|0)|0:32)|0}function _p(v,y,b,w,C){v=v|0,y=y|0,b=b|0,w=w|0,C=C|0;var P=0,k=0,V=0,$=0,J=0,ae=0,xe=0,ke=0,De=0,Oe=0;if(ae=v,$=y,J=$,k=b,ke=w,V=ke,!J)return P=(C|0)!=0,V?P?(_[C>>2]=v|0,_[C+4>>2]=y&0,ke=0,C=0,Ze(ke|0),C|0):(ke=0,C=0,Ze(ke|0),C|0):(P&&(_[C>>2]=(ae>>>0)%(k>>>0),_[C+4>>2]=0),ke=0,C=(ae>>>0)/(k>>>0)>>>0,Ze(ke|0),C|0);P=(V|0)==0;do if(k){if(!P){if(P=(St(V|0)|0)-(St(J|0)|0)|0,P>>>0<=31){xe=P+1|0,V=31-P|0,y=P-31>>31,k=xe,v=ae>>>(xe>>>0)&y|J<<V,y=J>>>(xe>>>0)&y,P=0,V=ae<<V;break}return C?(_[C>>2]=v|0,_[C+4>>2]=$|y&0,ke=0,C=0,Ze(ke|0),C|0):(ke=0,C=0,Ze(ke|0),C|0)}if(P=k-1|0,P&k|0){V=(St(k|0)|0)+33-(St(J|0)|0)|0,Oe=64-V|0,xe=32-V|0,$=xe>>31,De=V-32|0,y=De>>31,k=V,v=xe-1>>31&J>>>(De>>>0)|(J<<xe|ae>>>(V>>>0))&y,y=y&J>>>(V>>>0),P=ae<<Oe&$,V=(J<<Oe|ae>>>(De>>>0))&$|ae<<xe&V-33>>31;break}return C|0&&(_[C>>2]=P&ae,_[C+4>>2]=0),(k|0)==1?(De=$|y&0,Oe=v|0|0,Ze(De|0),Oe|0):(Oe=Vm(k|0)|0,De=J>>>(Oe>>>0)|0,Oe=J<<32-Oe|ae>>>(Oe>>>0)|0,Ze(De|0),Oe|0)}else{if(P)return C|0&&(_[C>>2]=(J>>>0)%(k>>>0),_[C+4>>2]=0),De=0,Oe=(J>>>0)/(k>>>0)>>>0,Ze(De|0),Oe|0;if(!ae)return C|0&&(_[C>>2]=0,_[C+4>>2]=(J>>>0)%(V>>>0)),De=0,Oe=(J>>>0)/(V>>>0)>>>0,Ze(De|0),Oe|0;if(P=V-1|0,!(P&V))return C|0&&(_[C>>2]=v|0,_[C+4>>2]=P&J|y&0),De=0,Oe=J>>>((Vm(V|0)|0)>>>0),Ze(De|0),Oe|0;if(P=(St(V|0)|0)-(St(J|0)|0)|0,P>>>0<=30){y=P+1|0,V=31-P|0,k=y,v=J<<V|ae>>>(y>>>0),y=J>>>(y>>>0),P=0,V=ae<<V;break}return C?(_[C>>2]=v|0,_[C+4>>2]=$|y&0,De=0,Oe=0,Ze(De|0),Oe|0):(De=0,Oe=0,Ze(De|0),Oe|0)}while(!1);if(!k)J=V,$=0,V=0;else{xe=b|0|0,ae=ke|w&0,J=fn(xe|0,ae|0,-1,-1)|0,b=se()|0,$=V,V=0;do w=$,$=P>>>31|$<<1,P=V|P<<1,w=v<<1|w>>>31|0,ke=v>>>31|y<<1|0,$s(J|0,b|0,w|0,ke|0)|0,Oe=se()|0,De=Oe>>31|((Oe|0)<0?-1:0)<<1,V=De&1,v=$s(w|0,ke|0,De&xe|0,(((Oe|0)<0?-1:0)>>31|((Oe|0)<0?-1:0)<<1)&ae|0)|0,y=se()|0,k=k-1|0;while((k|0)!=0);J=$,$=0}return k=0,C|0&&(_[C>>2]=v,_[C+4>>2]=y),De=(P|0)>>>31|(J|k)<<1|(k<<1|P>>>31)&0|$,Oe=(P<<1|0)&-2|V,Ze(De|0),Oe|0}function Ru(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0;return J=y>>31|((y|0)<0?-1:0)<<1,$=((y|0)<0?-1:0)>>31|((y|0)<0?-1:0)<<1,P=w>>31|((w|0)<0?-1:0)<<1,C=((w|0)<0?-1:0)>>31|((w|0)<0?-1:0)<<1,V=$s(J^v|0,$^y|0,J|0,$|0)|0,k=se()|0,v=P^J,y=C^$,$s((_p(V,k,$s(P^b|0,C^w|0,P|0,C|0)|0,se()|0,0)|0)^v|0,(se()|0)^y|0,v|0,y|0)|0}function zm(v,y){v=v|0,y=y|0;var b=0,w=0,C=0,P=0;return P=v&65535,C=y&65535,b=Ps(C,P)|0,w=v>>>16,v=(b>>>16)+(Ps(C,w)|0)|0,C=y>>>16,y=Ps(C,P)|0,Ze((v>>>16)+(Ps(C,w)|0)+(((v&65535)+y|0)>>>16)|0),v+y<<16|b&65535|0|0}function gs(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0;return C=v,P=b,b=zm(C,P)|0,v=se()|0,Ze((Ps(y,P)|0)+(Ps(w,C)|0)+v|v&0|0),b|0|0|0}function Gm(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0,k=0,V=0,$=0,J=0;return C=de,de=de+16|0,V=C|0,k=y>>31|((y|0)<0?-1:0)<<1,P=((y|0)<0?-1:0)>>31|((y|0)<0?-1:0)<<1,J=w>>31|((w|0)<0?-1:0)<<1,$=((w|0)<0?-1:0)>>31|((w|0)<0?-1:0)<<1,v=$s(k^v|0,P^y|0,k|0,P|0)|0,y=se()|0,_p(v,y,$s(J^b|0,$^w|0,J|0,$|0)|0,se()|0,V)|0,w=$s(_[V>>2]^k|0,_[V+4>>2]^P|0,k|0,P|0)|0,b=se()|0,de=C,Ze(b|0),w|0}function xp(v,y,b,w){v=v|0,y=y|0,b=b|0,w=w|0;var C=0,P=0;return P=de,de=de+16|0,C=P|0,_p(v,y,b,w,C)|0,de=P,Ze(_[C+4>>2]|0),_[C>>2]|0|0}function Ow(v,y,b){return v=v|0,y=y|0,b=b|0,(b|0)<32?(Ze(y>>b|0),v>>>b|(y&(1<<b)-1)<<32-b):(Ze(((y|0)<0?-1:0)|0),y>>b-32|0)}function Gt(v,y,b){return v=v|0,y=y|0,b=b|0,(b|0)<32?(Ze(y>>>b|0),v>>>b|(y&(1<<b)-1)<<32-b):(Ze(0),y>>>b-32|0)}function Jt(v,y,b){return v=v|0,y=y|0,b=b|0,(b|0)<32?(Ze(y<<b|(v&(1<<b)-1<<32-b)>>>32-b|0),v<<b):(Ze(v<<b-32|0),0)}function Y0(v,y,b){return v=v|0,y=y|0,y=St(y)|0,(y|0)==32&&(y=y+(St(v)|0)|0),Ze(0),y|0}function X0(v,y){return v=+v,y=+y,v!=v?+y:y!=y?+v:+ot(+v,+y)}function Q0(v,y){return v=+v,y=+y,v!=v?+y:y!=y?+v:+Se(+v,+y)}function gd(v){return v=+v,v>=0?+Pa(v+.5):+qs(v-.5)}function Ah(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0;if((b|0)>=8192)return bn(v|0,y|0,b|0)|0,v|0;if(P=v|0,C=v+b|0,(v&3)==(y&3)){for(;v&3;){if(!b)return P|0;Ut[v>>0]=Ut[y>>0]|0,v=v+1|0,y=y+1|0,b=b-1|0}for(b=C&-4|0,w=b-64|0;(v|0)<=(w|0);)_[v>>2]=_[y>>2],_[v+4>>2]=_[y+4>>2],_[v+8>>2]=_[y+8>>2],_[v+12>>2]=_[y+12>>2],_[v+16>>2]=_[y+16>>2],_[v+20>>2]=_[y+20>>2],_[v+24>>2]=_[y+24>>2],_[v+28>>2]=_[y+28>>2],_[v+32>>2]=_[y+32>>2],_[v+36>>2]=_[y+36>>2],_[v+40>>2]=_[y+40>>2],_[v+44>>2]=_[y+44>>2],_[v+48>>2]=_[y+48>>2],_[v+52>>2]=_[y+52>>2],_[v+56>>2]=_[y+56>>2],_[v+60>>2]=_[y+60>>2],v=v+64|0,y=y+64|0;for(;(v|0)<(b|0);)_[v>>2]=_[y>>2],v=v+4|0,y=y+4|0}else for(b=C-4|0;(v|0)<(b|0);)Ut[v>>0]=Ut[y>>0]|0,Ut[v+1>>0]=Ut[y+1>>0]|0,Ut[v+2>>0]=Ut[y+2>>0]|0,Ut[v+3>>0]=Ut[y+3>>0]|0,v=v+4|0,y=y+4|0;for(;(v|0)<(C|0);)Ut[v>>0]=Ut[y>>0]|0,v=v+1|0,y=y+1|0;return P|0}function Vc(v,y,b){v=v|0,y=y|0,b=b|0;var w=0,C=0,P=0,k=0;if(P=v+b|0,y=y&255,(b|0)>=67){for(;v&3;)Ut[v>>0]=y,v=v+1|0;for(w=P&-4|0,k=y|y<<8|y<<16|y<<24,C=w-64|0;(v|0)<=(C|0);)_[v>>2]=k,_[v+4>>2]=k,_[v+8>>2]=k,_[v+12>>2]=k,_[v+16>>2]=k,_[v+20>>2]=k,_[v+24>>2]=k,_[v+28>>2]=k,_[v+32>>2]=k,_[v+36>>2]=k,_[v+40>>2]=k,_[v+44>>2]=k,_[v+48>>2]=k,_[v+52>>2]=k,_[v+56>>2]=k,_[v+60>>2]=k,v=v+64|0;for(;(v|0)<(w|0);)_[v>>2]=k,v=v+4|0}for(;(v|0)<(P|0);)Ut[v>>0]=y,v=v+1|0;return P-b|0}function J0(v){return v=+v,v>=0?+Pa(v+.5):+qs(v-.5)}function Ad(v){v=v|0;var y=0,b=0,w=0;return w=dn()|0,b=_[va>>2]|0,y=b+v|0,(v|0)>0&(y|0)<(b|0)|(y|0)<0?(Dn(y|0)|0,gn(12),-1):(y|0)>(w|0)&&!(Mn(y|0)|0)?(gn(12),-1):(_[va>>2]=y,b|0)}return{___divdi3:Ru,___muldi3:gs,___remdi3:Gm,___uremdi3:xp,_areNeighborCells:T1,_bitshift64Ashr:Ow,_bitshift64Lshr:Gt,_bitshift64Shl:Jt,_calloc:Ko,_cellAreaKm2:sb,_cellAreaM2:N1,_cellAreaRads2:ph,_cellToBoundary:fh,_cellToCenterChild:E1,_cellToChildPos:nb,_cellToChildren:ww,_cellToChildrenSize:H0,_cellToLatLng:hh,_cellToLocalIj:Lw,_cellToParent:sp,_cellToVertex:$o,_cellToVertexes:Ap,_cellsToDirectedEdge:ld,_cellsToLinkedMultiPolygon:_1,_childPosToCell:Nw,_compactCells:Jx,_constructCell:AI,_destroyLinkedMultiPolygon:fp,_directedEdgeToBoundary:Ct,_directedEdgeToCells:Pe,_edgeLengthKm:rb,_edgeLengthM:hp,_edgeLengthRads:R1,_emscripten_replace_memory:Bn,_free:Un,_getBaseCellNumber:Sw,_getDirectedEdgeDestination:ee,_getDirectedEdgeOrigin:B,_getHexagonAreaAvgKm2:ab,_getHexagonAreaAvgM2:Pw,_getHexagonEdgeLengthAvgKm:ib,_getHexagonEdgeLengthAvgM:Bc,_getIcosahedronFaces:lp,_getIndexDigit:gI,_getNumCells:dp,_getPentagons:cp,_getRes0Cells:Ic,_getResolution:jm,_greatCircleDistanceKm:Um,_greatCircleDistanceM:_I,_greatCircleDistanceRads:Rw,_gridDisk:Fa,_gridDiskDistances:ca,_gridDistance:pp,_gridPathCells:Dw,_gridPathCellsSize:ob,_gridRing:Vo,_gridRingUnsafe:pi,_i64Add:fn,_i64Subtract:$s,_isPentagon:yi,_isResClassIII:Cw,_isValidCell:w1,_isValidDirectedEdge:he,_isValidIndex:Tw,_isValidVertex:pd,_latLngToCell:M1,_llvm_ctlz_i64:Y0,_llvm_maxnum_f64:X0,_llvm_minnum_f64:Q0,_llvm_round_f64:gd,_localIjToCell:I1,_malloc:Nu,_maxFaceCount:vI,_maxGridDiskSize:Pn,_maxPolygonToCellsSize:Ws,_maxPolygonToCellsSizeExperimental:$0,_memcpy:Ah,_memset:Vc,_originToDirectedEdges:gt,_pentagonCount:tb,_polygonToCells:id,_polygonToCellsExperimental:D1,_readInt64AsDoubleFromPointer:cb,_res0CellCount:oh,_round:J0,_sbrk:Ad,_sizeOfCellBoundary:Lr,_sizeOfCoordIJ:Xl,_sizeOfGeoLoop:ns,_sizeOfGeoPolygon:Qa,_sizeOfH3Index:lb,_sizeOfLatLng:kw,_sizeOfLinkedGeoPolygon:mh,_uncompactCells:Ew,_uncompactCellsSize:Mw,_vertexToLatLng:fd,establishStackSpace:Ya,stackAlloc:ja,stackRestore:Xn,stackSave:ki}})(vt,Tn,q);e.___divdi3=Ne.___divdi3,e.___muldi3=Ne.___muldi3,e.___remdi3=Ne.___remdi3,e.___uremdi3=Ne.___uremdi3,e._areNeighborCells=Ne._areNeighborCells,e._bitshift64Ashr=Ne._bitshift64Ashr,e._bitshift64Lshr=Ne._bitshift64Lshr,e._bitshift64Shl=Ne._bitshift64Shl,e._calloc=Ne._calloc,e._cellAreaKm2=Ne._cellAreaKm2,e._cellAreaM2=Ne._cellAreaM2,e._cellAreaRads2=Ne._cellAreaRads2,e._cellToBoundary=Ne._cellToBoundary,e._cellToCenterChild=Ne._cellToCenterChild,e._cellToChildPos=Ne._cellToChildPos,e._cellToChildren=Ne._cellToChildren,e._cellToChildrenSize=Ne._cellToChildrenSize,e._cellToLatLng=Ne._cellToLatLng,e._cellToLocalIj=Ne._cellToLocalIj,e._cellToParent=Ne._cellToParent,e._cellToVertex=Ne._cellToVertex,e._cellToVertexes=Ne._cellToVertexes,e._cellsToDirectedEdge=Ne._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=Ne._cellsToLinkedMultiPolygon,e._childPosToCell=Ne._childPosToCell,e._compactCells=Ne._compactCells,e._constructCell=Ne._constructCell,e._destroyLinkedMultiPolygon=Ne._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=Ne._directedEdgeToBoundary,e._directedEdgeToCells=Ne._directedEdgeToCells,e._edgeLengthKm=Ne._edgeLengthKm,e._edgeLengthM=Ne._edgeLengthM,e._edgeLengthRads=Ne._edgeLengthRads;var Xt=e._emscripten_replace_memory=Ne._emscripten_replace_memory;e._free=Ne._free,e._getBaseCellNumber=Ne._getBaseCellNumber,e._getDirectedEdgeDestination=Ne._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=Ne._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=Ne._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=Ne._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=Ne._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=Ne._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=Ne._getIcosahedronFaces,e._getIndexDigit=Ne._getIndexDigit,e._getNumCells=Ne._getNumCells,e._getPentagons=Ne._getPentagons,e._getRes0Cells=Ne._getRes0Cells,e._getResolution=Ne._getResolution,e._greatCircleDistanceKm=Ne._greatCircleDistanceKm,e._greatCircleDistanceM=Ne._greatCircleDistanceM,e._greatCircleDistanceRads=Ne._greatCircleDistanceRads,e._gridDisk=Ne._gridDisk,e._gridDiskDistances=Ne._gridDiskDistances,e._gridDistance=Ne._gridDistance,e._gridPathCells=Ne._gridPathCells,e._gridPathCellsSize=Ne._gridPathCellsSize,e._gridRing=Ne._gridRing,e._gridRingUnsafe=Ne._gridRingUnsafe,e._i64Add=Ne._i64Add,e._i64Subtract=Ne._i64Subtract,e._isPentagon=Ne._isPentagon,e._isResClassIII=Ne._isResClassIII,e._isValidCell=Ne._isValidCell,e._isValidDirectedEdge=Ne._isValidDirectedEdge,e._isValidIndex=Ne._isValidIndex,e._isValidVertex=Ne._isValidVertex,e._latLngToCell=Ne._latLngToCell,e._llvm_ctlz_i64=Ne._llvm_ctlz_i64,e._llvm_maxnum_f64=Ne._llvm_maxnum_f64,e._llvm_minnum_f64=Ne._llvm_minnum_f64,e._llvm_round_f64=Ne._llvm_round_f64,e._localIjToCell=Ne._localIjToCell,e._malloc=Ne._malloc,e._maxFaceCount=Ne._maxFaceCount,e._maxGridDiskSize=Ne._maxGridDiskSize,e._maxPolygonToCellsSize=Ne._maxPolygonToCellsSize,e._maxPolygonToCellsSizeExperimental=Ne._maxPolygonToCellsSizeExperimental,e._memcpy=Ne._memcpy,e._memset=Ne._memset,e._originToDirectedEdges=Ne._originToDirectedEdges,e._pentagonCount=Ne._pentagonCount,e._polygonToCells=Ne._polygonToCells,e._polygonToCellsExperimental=Ne._polygonToCellsExperimental,e._readInt64AsDoubleFromPointer=Ne._readInt64AsDoubleFromPointer,e._res0CellCount=Ne._res0CellCount,e._round=Ne._round,e._sbrk=Ne._sbrk,e._sizeOfCellBoundary=Ne._sizeOfCellBoundary,e._sizeOfCoordIJ=Ne._sizeOfCoordIJ,e._sizeOfGeoLoop=Ne._sizeOfGeoLoop,e._sizeOfGeoPolygon=Ne._sizeOfGeoPolygon,e._sizeOfH3Index=Ne._sizeOfH3Index,e._sizeOfLatLng=Ne._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=Ne._sizeOfLinkedGeoPolygon,e._uncompactCells=Ne._uncompactCells,e._uncompactCellsSize=Ne._uncompactCellsSize,e._vertexToLatLng=Ne._vertexToLatLng,e.establishStackSpace=Ne.establishStackSpace;var Ht=e.stackAlloc=Ne.stackAlloc,$t=e.stackRestore=Ne.stackRestore,zt=e.stackSave=Ne.stackSave;if(e.asm=Ne,e.cwrap=I,e.setValue=A,e.getValue=x,wt){_e(wt)||(wt=r(wt));{Ue();var Ot=function(bt){bt.byteLength&&(bt=new Uint8Array(bt)),H.set(bt,m),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,it()},an=function(){o(wt,Ot,function(){throw"could not load memory initializer "+wt})},jn=kt(wt);if(jn)Ot(jn.buffer);else if(e.memoryInitializerRequest){var ai=function(){var bt=e.memoryInitializerRequest,Bt=bt.response;if(bt.status!==200&&bt.status!==0){var ln=kt(e.memoryInitializerRequestURL);if(ln)Bt=ln.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+bt.status+", retrying "+wt),an();return}}Ot(Bt)};e.memoryInitializerRequest.response?setTimeout(ai,0):e.memoryInitializerRequest.addEventListener("load",ai)}else an()}}var Ta;ve=function bt(){Ta||Gs(),Ta||(ve=bt)};function Gs(bt){if(rt>0||(fe(),rt>0))return;function Bt(){Ta||(Ta=!0,!T&&(Le(),Fe(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Ie()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),Bt()},1)):Bt()}e.run=Gs;function dr(bt){throw e.onAbort&&e.onAbort(bt),bt+="",l(bt),c(bt),T=!0,"abort("+bt+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=dr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return Gs(),a})(typeof ci=="object"?ci:{}),aa="number",ta=aa,Lv=aa,da=aa,ha=aa,no=aa,xn=aa,mOe=[["sizeOfH3Index",aa],["sizeOfLatLng",aa],["sizeOfCellBoundary",aa],["sizeOfGeoLoop",aa],["sizeOfGeoPolygon",aa],["sizeOfLinkedGeoPolygon",aa],["sizeOfCoordIJ",aa],["readInt64AsDoubleFromPointer",aa],["isValidCell",Lv,[da,ha]],["isValidIndex",Lv,[da,ha]],["latLngToCell",ta,[aa,aa,no,xn]],["cellToLatLng",ta,[da,ha,xn]],["cellToBoundary",ta,[da,ha,xn]],["maxGridDiskSize",ta,[aa,xn]],["gridDisk",ta,[da,ha,aa,xn]],["gridDiskDistances",ta,[da,ha,aa,xn,xn]],["gridRing",ta,[da,ha,aa,xn]],["gridRingUnsafe",ta,[da,ha,aa,xn]],["maxPolygonToCellsSize",ta,[xn,no,aa,xn]],["polygonToCells",ta,[xn,no,aa,xn]],["maxPolygonToCellsSizeExperimental",ta,[xn,no,aa,xn]],["polygonToCellsExperimental",ta,[xn,no,aa,aa,aa,xn]],["cellsToLinkedMultiPolygon",ta,[xn,aa,xn]],["destroyLinkedMultiPolygon",null,[xn]],["compactCells",ta,[xn,xn,aa,aa]],["uncompactCells",ta,[xn,aa,aa,xn,aa,no]],["uncompactCellsSize",ta,[xn,aa,aa,no,xn]],["isPentagon",Lv,[da,ha]],["isResClassIII",Lv,[da,ha]],["getBaseCellNumber",aa,[da,ha]],["getResolution",aa,[da,ha]],["getIndexDigit",aa,[da,ha,aa]],["constructCell",ta,[aa,aa,xn,xn]],["maxFaceCount",ta,[da,ha,xn]],["getIcosahedronFaces",ta,[da,ha,xn]],["cellToParent",ta,[da,ha,no,xn]],["cellToChildren",ta,[da,ha,no,xn]],["cellToCenterChild",ta,[da,ha,no,xn]],["cellToChildrenSize",ta,[da,ha,no,xn]],["cellToChildPos",ta,[da,ha,no,xn]],["childPosToCell",ta,[aa,aa,da,ha,no,xn]],["areNeighborCells",ta,[da,ha,da,ha,xn]],["cellsToDirectedEdge",ta,[da,ha,da,ha,xn]],["getDirectedEdgeOrigin",ta,[da,ha,xn]],["getDirectedEdgeDestination",ta,[da,ha,xn]],["isValidDirectedEdge",Lv,[da,ha]],["directedEdgeToCells",ta,[da,ha,xn]],["originToDirectedEdges",ta,[da,ha,xn]],["directedEdgeToBoundary",ta,[da,ha,xn]],["gridDistance",ta,[da,ha,da,ha,xn]],["gridPathCells",ta,[da,ha,da,ha,xn]],["gridPathCellsSize",ta,[da,ha,da,ha,xn]],["cellToLocalIj",ta,[da,ha,da,ha,aa,xn]],["localIjToCell",ta,[da,ha,xn,aa,xn]],["getHexagonAreaAvgM2",ta,[no,xn]],["getHexagonAreaAvgKm2",ta,[no,xn]],["getHexagonEdgeLengthAvgM",ta,[no,xn]],["getHexagonEdgeLengthAvgKm",ta,[no,xn]],["greatCircleDistanceM",aa,[xn,xn]],["greatCircleDistanceKm",aa,[xn,xn]],["greatCircleDistanceRads",aa,[xn,xn]],["cellAreaM2",ta,[da,ha,xn]],["cellAreaKm2",ta,[da,ha,xn]],["cellAreaRads2",ta,[da,ha,xn]],["edgeLengthM",ta,[da,ha,xn]],["edgeLengthKm",ta,[da,ha,xn]],["edgeLengthRads",ta,[da,ha,xn]],["getNumCells",ta,[no,xn]],["getRes0Cells",ta,[xn]],["res0CellCount",aa],["getPentagons",ta,[aa,xn]],["pentagonCount",aa],["cellToVertex",ta,[da,ha,aa,xn]],["cellToVertexes",ta,[da,ha,xn]],["vertexToLatLng",ta,[da,ha,xn]],["isValidVertex",Lv,[da,ha]]],gOe=0,AOe=1,yOe=2,vOe=3,gne=4,_Oe=5,xOe=6,bOe=7,SOe=8,TOe=9,wOe=10,EOe=11,MOe=12,COe=13,NOe=14,ROe=15,POe=16,IOe=17,LOe=18,DOe=19,ur={};ur[gOe]="Success";ur[AOe]="The operation failed but a more specific error is not available";ur[yOe]="Argument was outside of acceptable range";ur[vOe]="Latitude or longitude arguments were outside of acceptable range";ur[gne]="Resolution argument was outside of acceptable range";ur[_Oe]="Cell argument was not valid";ur[xOe]="Directed edge argument was not valid";ur[bOe]="Undirected edge argument was not valid";ur[SOe]="Vertex argument was not valid";ur[TOe]="Pentagon distortion was encountered";ur[wOe]="Duplicate input";ur[EOe]="Cell arguments were not neighbors";ur[MOe]="Cell arguments had incompatible resolutions";ur[COe]="Memory allocation failed";ur[NOe]="Bounds of provided memory were insufficient";ur[ROe]="Mode or flags argument was not valid";ur[POe]="Index argument was not valid";ur[IOe]="Base cell number was outside of acceptable range";ur[LOe]="Child indexing digits invalid";ur[DOe]="Child indexing digits refer to a deleted subsequence";var kOe=1e3,Ane=1001,yne=1002,M4={};M4[kOe]="Unknown unit";M4[Ane]="Array length out of bounds";M4[yne]="Got unexpected null value for H3 index";var OOe="Unknown error";function vne(a,e,n){var i=n&&"value"in n,s=new Error((a[e]||OOe)+" (code: "+e+(i?", value: "+n.value:"")+")");return s.code=e,s}function _ne(a,e){var n=arguments.length===2?{value:e}:{};return vne(ur,a,n)}function xne(a,e){var n=arguments.length===2?{value:e}:{};return vne(M4,a,n)}function rT(a){if(a!==0)throw _ne(a)}var Sc={};mOe.forEach(function(e){Sc[e[0]]=ci.cwrap.apply(ci,e)});var l_=16,oT=4,fx=8,FOe=8,fR=Sc.sizeOfH3Index(),oB=Sc.sizeOfLatLng(),jOe=Sc.sizeOfCellBoundary(),BOe=Sc.sizeOfGeoPolygon(),fS=Sc.sizeOfGeoLoop();Sc.sizeOfLinkedGeoPolygon();Sc.sizeOfCoordIJ();function UOe(a){if(typeof a!="number"||a<0||a>15||Math.floor(a)!==a)throw _ne(gne,a);return a}function VOe(a){if(!a)throw xne(yne);return a}var zOe=Math.pow(2,32)-1;function GOe(a){if(a>zOe)throw xne(Ane,a);return a}var qOe=/[^0-9a-fA-F]/;function bne(a){if(Array.isArray(a)&&a.length===2&&Number.isInteger(a[0])&&Number.isInteger(a[1]))return a;if(typeof a!="string"||qOe.test(a))return[0,0];var e=parseInt(a.substring(0,a.length-8),l_),n=parseInt(a.substring(a.length-8),l_);return[n,e]}function B$(a){if(a>=0)return a.toString(l_);a=a&2147483647;var e=Sne(8,a.toString(l_)),n=(parseInt(e[0],l_)+8).toString(l_);return e=n+e.substring(1),e}function HOe(a,e){return B$(e)+Sne(8,B$(a))}function Sne(a,e){for(var n=a-e.length,i="",s=0;s<n;s++)i+="0";return i=i+e,i}function U$(a,e,n){for(var i=a.length,s=ci._calloc(i,oB),r=n?1:0,o=n?0:1,l=0;l<i*2;l+=2)ci.HEAPF64.set([a[l/2][r],a[l/2][o]].map(Mne),s/fx+l);return ci.HEAPU32.set([i,s],e/oT),e}function WOe(a,e){var n=a.length-1,i=ci._calloc(BOe),s=0,r=s+fS,o=r+oT;U$(a[0],i+s,e);var l;if(n>0){l=ci._calloc(n,fS);for(var c=0;c<n;c++)U$(a[c+1],l+fS*c,e)}return ci.setValue(i+r,n,"i32"),ci.setValue(i+o,l,"i32"),i}function $Oe(a){var e=0,n=e+fS,i=n+oT,s=oT;ci._free(ci.getValue(a+e+s,"i8*"));var r=ci.getValue(a+n,"i32");if(r>0){for(var o=ci.getValue(a+i,"i32"),l=0;l<r;l++)ci._free(ci.getValue(o+fS*l+s,"i8*"));ci._free(o)}ci._free(a)}function Tne(a,e){e===void 0&&(e=0);var n=ci.getValue(a+fR*e,"i32"),i=ci.getValue(a+fR*e+oT,"i32");return i?HOe(n,i):null}function KOe(a){return Sc.readInt64AsDoubleFromPointer(a)}function YOe(a,e){for(var n=[],i=0;i<e;i++){var s=Tne(a,i);s!==null&&n.push(s)}return n}function pR(a){return e8e(ci.getValue(a,"double"))}function XOe(a){return[pR(a),pR(a+fx)]}function QOe(a){return[pR(a+fx),pR(a)]}function JOe(a,e,n){for(var i=ci.getValue(a,"i32"),s=a+fx,r=[],o=QOe,l=0;l<i*2;l+=2)r.push(o(s+fx*l));return r.push(r[0]),r}function ZOe(a,e,n){var i=ci._malloc(oB);ci.HEAPF64.set([a,e].map(Mne),i/fx);var s=ci._malloc(fR);try{return rT(Sc.latLngToCell(i,n,s)),VOe(Tne(s))}finally{ci._free(s),ci._free(i)}}function wne(a){var e=ci._malloc(oB),n=bne(a),i=n[0],s=n[1];try{return rT(Sc.cellToLatLng(i,s,e)),XOe(e)}finally{ci._free(e)}}function Ene(a,e){var n=ci._malloc(jOe),i=bne(a),s=i[0],r=i[1];try{return rT(Sc.cellToBoundary(s,r,n)),JOe(n,e,e)}finally{ci._free(n)}}function V$(a,e,n){if(UOe(e),n=!!n,a.length===0||a[0].length===0)return[];var i=typeof a[0][0]=="number"?[a]:a,s=WOe(i,n),r=ci._malloc(FOe);try{rT(Sc.maxPolygonToCellsSize(s,e,0,r));var o=GOe(KOe(r)),l=ci._calloc(o,fR);try{return rT(Sc.polygonToCells(s,e,0,l)),YOe(l,o)}finally{ci._free(l)}}finally{ci._free(r),$Oe(s)}}function Mne(a){return a*Math.PI/180}function e8e(a){return a*180/Math.PI}function t8e(a){return a=Math.max(0,Math.min(1,a)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+a*(1172.33-a*(10793.56-a*(33300.12-a*(38394.49-a*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+a*(557.33+a*(1225.33-a*(3574.96-a*(1073.77+a*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+a*(3211.1-a*(15327.97-a*(27814-a*(22569.18-a*6838.66)))))))+")"}const n8e=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"],b5=new WeakMap;class a8e{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=n8e,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const n=e.getMRT();return n!==null&&n.has("velocity")}getRenderObjectData(e){let n=this.renderObjects.get(e);if(n===void 0){const{geometry:i,material:s,object:r}=e;if(n={material:this.getMaterialData(s),geometry:{id:i.id,attributes:this.getAttributesData(i.attributes),indexVersion:i.index?i.index.version:null,drawRange:{start:i.drawRange.start,count:i.drawRange.count}},worldMatrix:r.matrixWorld.clone()},r.center&&(n.center=r.center.clone()),r.morphTargetInfluences&&(n.morphTargetInfluences=r.morphTargetInfluences.slice()),e.bundle!==null&&(n.version=e.bundle.version),n.material.transmission>0){const{width:o,height:l}=e.context;n.bufferWidth=o,n.bufferHeight=l}n.lights=this.getLightsData(e.lightsNode.getLights()),this.renderObjects.set(e,n)}return n}getAttributesData(e){const n={};for(const i in e){const s=e[i];n[i]={version:s.version}}return n}containsNode(e){const n=e.material;for(const i in n)if(n[i]&&n[i].isNode)return!0;return!!(e.context.modelViewMatrix||e.context.modelNormalViewMatrix||e.context.getAO||e.context.getShadow)}getMaterialData(e){const n={};for(const i of this.refreshUniforms){const s=e[i];s!=null&&(typeof s=="object"&&s.clone!==void 0?s.isTexture===!0?n[i]={id:s.id,version:s.version}:n[i]=s.clone():n[i]=s)}return n}equals(e,n){const{object:i,material:s,geometry:r}=e,o=this.getRenderObjectData(e);if(o.worldMatrix.equals(i.matrixWorld)!==!0)return o.worldMatrix.copy(i.matrixWorld),!1;const l=o.material;for(const E in l){const M=l[E],N=s[E];if(M.equals!==void 0){if(M.equals(N)===!1)return M.copy(N),!1}else if(N.isTexture===!0){if(M.id!==N.id||M.version!==N.version)return M.id=N.id,M.version=N.version,!1}else if(M!==N)return l[E]=N,!1}if(l.transmission>0){const{width:E,height:M}=e.context;if(o.bufferWidth!==E||o.bufferHeight!==M)return o.bufferWidth=E,o.bufferHeight=M,!1}const c=o.geometry,u=r.attributes,h=c.attributes,f=Object.keys(h),m=Object.keys(u);if(c.id!==r.id)return c.id=r.id,!1;if(f.length!==m.length)return o.geometry.attributes=this.getAttributesData(u),!1;for(const E of f){const M=h[E],N=u[E];if(N===void 0)return delete h[E],!1;if(M.version!==N.version)return M.version=N.version,!1}const A=r.index,x=c.indexVersion,T=A?A.version:null;if(x!==T)return c.indexVersion=T,!1;if(c.drawRange.start!==r.drawRange.start||c.drawRange.count!==r.drawRange.count)return c.drawRange.start=r.drawRange.start,c.drawRange.count=r.drawRange.count,!1;if(o.morphTargetInfluences){let E=!1;for(let M=0;M<o.morphTargetInfluences.length;M++)o.morphTargetInfluences[M]!==i.morphTargetInfluences[M]&&(o.morphTargetInfluences[M]=i.morphTargetInfluences[M],E=!0);if(E)return!1}if(o.lights){for(let E=0;E<n.length;E++)if(o.lights[E].map!==n[E].map)return!1}return o.center&&o.center.equals(i.center)===!1?(o.center.copy(i.center),!0):(e.bundle!==null&&(o.version=e.bundle.version),!0)}getLightsData(e){const n=[];for(const i of e)i.isSpotLight===!0&&i.map!==null&&n.push({map:i.map.version});return n}getLights(e,n){if(b5.has(e)){const s=b5.get(e);if(s.renderId===n)return s.lightsData}const i=this.getLightsData(e.getLights());return b5.set(e,{renderId:n,lightsData:i}),i}needsRefresh(e,n){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(n.renderer))return!0;const{renderId:i}=n;if(this.renderId!==i)return this.renderId=i,!0;const s=e.object.static===!0,r=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;if(s||r)return!1;const o=this.getLights(e.lightsNode,i);return this.equals(e,o)!==!0}}function lB(a,e=0){let n=3735928559^e,i=1103547991^e;if(a instanceof Array)for(let s=0,r;s<a.length;s++)r=a[s],n=Math.imul(n^r,2654435761),i=Math.imul(i^r,1597334677);else for(let s=0,r;s<a.length;s++)r=a.charCodeAt(s),n=Math.imul(n^r,2654435761),i=Math.imul(i^r,1597334677);return n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507),i^=Math.imul(n^n>>>13,3266489909),4294967296*(2097151&i)+(n>>>0)}const uw=a=>lB(a),Hx=a=>lB(a),pS=(...a)=>lB(a),i8e=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),z$=new WeakMap;function Cne(a){return i8e.get(a)}function mR(a){if(/[iu]?vec\d/.test(a))return a.startsWith("ivec")?Int32Array:a.startsWith("uvec")?Uint32Array:Float32Array;if(/mat\d/.test(a)||/float/.test(a))return Float32Array;if(/uint/.test(a))return Uint32Array;if(/int/.test(a))return Int32Array;throw new Error(`THREE.NodeUtils: Unsupported type: ${a}`)}function Nne(a){if(/float|int|uint/.test(a))return 1;if(/vec2/.test(a))return 2;if(/vec3/.test(a))return 3;if(/vec4/.test(a)||/mat2/.test(a))return 4;if(/mat3/.test(a))return 9;if(/mat4/.test(a))return 16;Rt("TSL: Unsupported type:",a)}function s8e(a){if(/float|int|uint/.test(a))return 1;if(/vec2/.test(a))return 2;if(/vec3/.test(a))return 3;if(/vec4/.test(a)||/mat2/.test(a))return 4;if(/mat3/.test(a))return 12;if(/mat4/.test(a))return 16;Rt("TSL: Unsupported type:",a)}function r8e(a){if(/float|int|uint/.test(a))return 4;if(/vec2/.test(a))return 8;if(/vec3/.test(a)||/vec4/.test(a))return 16;if(/mat2/.test(a))return 8;if(/mat3/.test(a)||/mat4/.test(a))return 16;Rt("TSL: Unsupported type:",a)}function zg(a){if(a==null)return null;const e=typeof a;return a.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":a.isVector2===!0?"vec2":a.isVector3===!0?"vec3":a.isVector4===!0?"vec4":a.isMatrix2===!0?"mat2":a.isMatrix3===!0?"mat3":a.isMatrix4===!0?"mat4":a.isColor===!0?"color":a instanceof ArrayBuffer?"ArrayBuffer":null}function cB(a,...e){const n=a?a.slice(-4):void 0;return e.length===1&&(n==="vec2"?e=[e[0],e[0]]:n==="vec3"?e=[e[0],e[0],e[0]]:n==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),a==="color"?new on(...e):n==="vec2"?new Nt(...e):n==="vec3"?new ye(...e):n==="vec4"?new qn(...e):n==="mat2"?new rw(...e):n==="mat3"?new ga(...e):n==="mat4"?new _n(...e):a==="bool"?e[0]||!1:a==="float"||a==="int"||a==="uint"?e[0]||0:a==="string"?e[0]||"":a==="ArrayBuffer"?Ine(e[0]):null}function Rne(a){let e=z$.get(a);return e===void 0&&(e={},z$.set(a,e)),e}function Pne(a){let e="";const n=new Uint8Array(a);for(let i=0;i<n.length;i++)e+=String.fromCharCode(n[i]);return btoa(e)}function Ine(a){return Uint8Array.from(atob(a),e=>e.charCodeAt(0)).buffer}const W2={VERTEX:"vertex",FRAGMENT:"fragment"},fa={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},o8e={BOOLEAN:"bool",INTEGER:"int",FLOAT:"float",VECTOR2:"vec2",VECTOR3:"vec3",VECTOR4:"vec4",MATRIX2:"mat2",MATRIX3:"mat3",MATRIX4:"mat4"},Po={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},Lne=["fragment","vertex"],bO=["setup","analyze","generate"],SO=[...Lne,"compute"],m1=["x","y","z","w"],l8e={analyze:"setup",generate:"analyze"};let c8e=0;class yn extends Cc{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=fa.NONE,this.updateBeforeType=fa.NONE,this.updateAfterType=fa.NONE,this.uuid=Xy.generateUUID(),this.version=0,this.name="",this.global=!1,this.parents=!1,this.isNode=!0,this._beforeNodes=null,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:c8e++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,n){return this.updateType=n,this.update=e.bind(this),this}onFrameUpdate(e){return this.onUpdate(e,fa.FRAME)}onRenderUpdate(e){return this.onUpdate(e,fa.RENDER)}onObjectUpdate(e){return this.onUpdate(e,fa.OBJECT)}onReference(e){return this.updateReference=e.bind(this),this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of this._getChildren())yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const n of this.getChildren())n.traverse(e)}_getChildren(e=new Set){const n=[];e.add(this);for(const i of Object.getOwnPropertyNames(this)){const s=this[i];if(!(i.startsWith("_")===!0||e.has(s))){if(Array.isArray(s)===!0)for(let r=0;r<s.length;r++){const o=s[r];o&&o.isNode===!0&&n.push({property:i,index:r,childNode:o})}else if(s&&s.isNode===!0)n.push({property:i,childNode:s});else if(s&&Object.getPrototypeOf(s)===Object.prototype)for(const r in s){if(r.startsWith("_")===!0)continue;const o=s[r];o&&o.isNode===!0&&n.push({property:i,index:r,childNode:o})}}}return n}getCacheKey(e=!1,n=null){if(e=e||this.version!==this._cacheKeyVersion,e===!0||this._cacheKey===null){n===null&&(n=new Set);const i=[];for(const{property:s,childNode:r}of this._getChildren(n))i.push(uw(s.slice(0,-4)),r.getCacheKey(e,n));this._cacheKey=pS(Hx(i),this.customCacheKey()),this._cacheKeyVersion=this.version}return this._cacheKey}customCacheKey(){return this.id}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const n=this.getNodeType(e);return e.getElementType(n)}getMemberType(){return"void"}getNodeType(e){const n=e.getNodeProperties(this);return n.outputNode?n.outputNode.getNodeType(e):this.nodeType}getShared(e){const n=this.getHash(e);return e.getNodeFromHash(n)||this}getArrayCount(){return null}setup(e){const n=e.getNodeProperties(this);let i=0;for(const s of this.getChildren())n["node"+i++]=s;return n.outputNode||null}analyze(e,n=null){const i=e.increaseUsage(this);if(this.parents===!0){const s=e.getDataFromNode(this,"any");s.stages=s.stages||{},s.stages[e.shaderStage]=s.stages[e.shaderStage]||[],s.stages[e.shaderStage].push(n)}if(i===1){const s=e.getNodeProperties(this);for(const r of Object.values(s))r&&r.isNode===!0&&r.build(e,this)}}generate(e,n){const{outputNode:i}=e.getNodeProperties(this);if(i&&i.isNode===!0)return i.build(e,n)}updateBefore(){yt("Abstract function.")}updateAfter(){yt("Abstract function.")}update(){yt("Abstract function.")}before(e){return this._beforeNodes===null&&(this._beforeNodes=[]),this._beforeNodes.push(e),this}build(e,n=null){const i=this.getShared(e);if(this!==i)return i.build(e,n);if(this._beforeNodes!==null){const c=this._beforeNodes;this._beforeNodes=null;for(const u of c)u.build(e,n);this._beforeNodes=c}const s=e.getDataFromNode(this);s.buildStages=s.buildStages||{},s.buildStages[e.buildStage]=!0;const r=l8e[e.buildStage];if(r&&s.buildStages[r]!==!0){const c=e.getBuildStage();e.setBuildStage(r),this.build(e),e.setBuildStage(c)}e.addNode(this),e.addChain(this);let o=null;const l=e.getBuildStage();if(l==="setup"){this.updateReference(e);const c=e.getNodeProperties(this);if(c.initialized!==!0){c.initialized=!0,c.outputNode=this.setup(e)||c.outputNode||null;for(const u of Object.values(c))if(u&&u.isNode===!0){if(u.parents===!0){const h=e.getNodeProperties(u);h.parents=h.parents||[],h.parents.push(this)}u.build(e)}}o=c.outputNode}else if(l==="analyze")this.analyze(e,n);else if(l==="generate"){if(this.generate.length<2){const u=this.getNodeType(e),h=e.getDataFromNode(this);o=h.snippet,o===void 0?h.generated===void 0?(h.generated=!0,o=this.generate(e)||"",h.snippet=o):(yt("Node: Recursion detected.",this),o="/* Recursion detected. */"):h.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),o=e.format(o,u,n)}else o=this.generate(e,n)||"";o===""&&n!==null&&n!=="void"&&n!=="OutputType"&&(Rt(`TSL: Invalid generated code, expected a "${n}".`),o=e.generateConst(n))}return e.removeChain(this),e.addSequentialNode(this),o}getSerializeChildren(){return this._getChildren()}serialize(e){const n=this.getSerializeChildren(),i={};for(const{property:s,index:r,childNode:o}of n)r!==void 0?(i[s]===void 0&&(i[s]=Number.isInteger(r)?[]:{}),i[s][r]=o.toJSON(e.meta).uuid):i[s]=o.toJSON(e.meta).uuid;Object.keys(i).length>0&&(e.inputNodes=i)}deserialize(e){if(e.inputNodes!==void 0){const n=e.meta.nodes;for(const i in e.inputNodes)if(Array.isArray(e.inputNodes[i])){const s=[];for(const r of e.inputNodes[i])s.push(n[r]);this[i]=s}else if(typeof e.inputNodes[i]=="object"){const s={};for(const r in e.inputNodes[i]){const o=e.inputNodes[i][r];s[r]=n[o]}this[i]=s}else{const s=e.inputNodes[i];this[i]=n[s]}}}toJSON(e){const{uuid:n,type:i}=this,s=e===void 0||typeof e=="string";s&&(e={textures:{},images:{},nodes:{}});let r=e.nodes[n];r===void 0&&(r={uuid:n,type:i,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},s!==!0&&(e.nodes[r.uuid]=r),this.serialize(r),delete r.meta);function o(l){const c=[];for(const u in l){const h=l[u];delete h.metadata,c.push(h)}return c}if(s){const l=o(e.textures),c=o(e.images),u=o(e.nodes);l.length>0&&(r.textures=l),c.length>0&&(r.images=c),u.length>0&&(r.nodes=u)}return r}}class g1 extends yn{static get type(){return"ArrayElementNode"}constructor(e,n){super(),this.node=e,this.indexNode=n,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}getMemberType(e,n){return this.node.getMemberType(e,n)}generate(e){const n=this.indexNode.getNodeType(e),i=this.node.build(e),s=this.indexNode.build(e,!e.isVector(n)&&e.isInteger(n)?n:"uint");return`${i}[ ${s} ]`}}class Dne extends yn{static get type(){return"ConvertNode"}constructor(e,n){super(),this.node=e,this.convertTo=n}getNodeType(e){const n=this.node.getNodeType(e);let i=null;for(const s of this.convertTo.split("|"))(i===null||e.getTypeLength(n)===e.getTypeLength(s))&&(i=s);return i}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,n){const i=this.node,s=this.getNodeType(e),r=i.build(e,s);return e.format(r,s,n)}}class Rs extends yn{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,n){if(e.getBuildStage()==="generate"){const s=e.getVectorType(this.getNodeType(e,n)),r=e.getDataFromNode(this);if(r.propertyName!==void 0)return e.format(r.propertyName,s,n);if(s!=="void"&&n!=="void"&&this.hasDependencies(e)){const o=super.build(e,s),l=e.getVarFromNode(this,null,s),c=e.getPropertyName(l);return e.addLineFlowCode(`${c} = ${o}`,this),r.snippet=o,r.propertyName=c,e.format(r.propertyName,s,n)}}return super.build(e,n)}}class u8e extends Rs{static get type(){return"JoinNode"}constructor(e=[],n=null){super(n),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((n,i)=>n+e.getTypeLength(i.getNodeType(e)),0))}generate(e,n){const i=this.getNodeType(e),s=e.getTypeLength(i),r=this.nodes,o=e.getComponentType(i),l=[];let c=0;for(const h of r){if(c>=s){Rt(`TSL: Length of parameters exceeds maximum length of function '${i}()' type.`);break}let f=h.getNodeType(e),m=e.getTypeLength(f),A;if(c+m>s&&(Rt(`TSL: Length of '${i}()' data exceeds maximum length of output type.`),m=s-c,f=e.getTypeFromLength(m)),c+=m,A=h.build(e,f),e.getComponentType(f)!==o){const T=e.getTypeFromLength(m,o);A=e.format(A,f,T)}l.push(A)}const u=`${e.getType(i)}( ${l.join(", ")} )`;return e.format(u,i,n)}}const d8e=m1.join("");class kne extends yn{static get type(){return"SplitNode"}constructor(e,n="x"){super(),this.node=e,this.components=n,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const n of this.components)e=Math.max(m1.indexOf(n)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}getScope(){return this.node.getScope()}generate(e,n){const i=this.node,s=e.getTypeLength(i.getNodeType(e));let r=null;if(s>1){let o=null;this.getVectorLength()>=s&&(o=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const c=i.build(e,o);this.components.length===s&&this.components===d8e.slice(0,this.components.length)?r=e.format(c,o,n):r=e.format(`${c}.${this.components}`,this.getNodeType(e),n)}else r=i.build(e,n);return r}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class h8e extends Rs{static get type(){return"SetNode"}constructor(e,n,i){super(),this.sourceNode=e,this.components=n,this.targetNode=i}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:n,components:i,targetNode:s}=this,r=this.getNodeType(e),o=e.getComponentType(s.getNodeType(e)),l=e.getTypeFromLength(i.length,o),c=s.build(e,l),u=n.build(e,r),h=e.getTypeLength(r),f=[];for(let m=0;m<h;m++){const A=m1[m];A===i[0]?(f.push(c),m+=i.length-1):f.push(u+"."+A)}return`${e.getType(r)}( ${f.join(", ")} )`}}class f8e extends Rs{static get type(){return"FlipNode"}constructor(e,n){super(),this.sourceNode=e,this.components=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:n,sourceNode:i}=this,s=this.getNodeType(e),r=i.build(e),o=e.getVarFromNode(this),l=e.getPropertyName(o);e.addLineFlowCode(l+" = "+r,this);const c=e.getTypeLength(s),u=[];let h=0;for(let f=0;f<c;f++){const m=m1[f];m===n[h]?(u.push("1.0 - "+(l+"."+m)),h++):u.push(l+"."+m)}return`${e.getType(s)}( ${u.join(", ")} )`}}class uB extends yn{static get type(){return"InputNode"}constructor(e,n=null){super(n),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?zg(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=zg(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=Pne(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?cB(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){yt("Abstract function.")}}const G$=/float|u?int/;class nd extends uB{static get type(){return"ConstNode"}constructor(e,n=null){super(e,n),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,n){const i=this.getNodeType(e);return G$.test(i)&&G$.test(n)?e.generateConst(n,this.value):e.format(this.generateConst(e),i,n)}}class p8e extends yn{static get type(){return"MemberNode"}constructor(e,n){super(),this.structNode=e,this.property=n,this.isMemberNode=!0}hasMember(e){return this.structNode.isMemberNode&&this.structNode.hasMember(e)===!1?!1:this.structNode.getMemberType(e,this.property)!=="void"}getNodeType(e){return this.hasMember(e)===!1?"float":this.structNode.getMemberType(e,this.property)}getMemberType(e,n){if(this.hasMember(e)===!1)return"float";const i=this.getNodeType(e);return e.getStructTypeNode(i).getMemberType(e,n)}generate(e){if(this.hasMember(e)===!1){yt(`TSL: Member "${this.property}" does not exist in struct.`);const i=this.getNodeType(e);return e.generateConst(i)}return this.structNode.build(e)+"."+this.property}}let y0=null;const TO=new Map;function Pt(a,e){if(TO.has(a)){yt(`TSL: Redefinition of method chaining '${a}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${a} is not a function`);TO.set(a,e),a!=="assign"&&(yn.prototype[a]=function(...n){return this.isStackNode?this.addToStack(e(...n)):e(this,...n)},yn.prototype[a+"Assign"]=function(...n){return this.isStackNode?this.assign(n[0],e(...n)):this.assign(e(this,...n))})}const m8e=a=>a.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),q$=a=>m8e(a).split("").sort().join("");yn.prototype.assign=function(...a){if(this.isStackNode!==!0)return y0!==null?y0.assign(this,...a):Rt("TSL: No stack defined for assign operation. Make sure the assign is inside a Fn()."),this;{const e=TO.get("assign");return this.addToStack(e(...a))}};yn.prototype.toVarIntent=function(){return this};yn.prototype.get=function(a){return new p8e(this,a)};const mS={};function GM(a,e,n){mS[a]=mS[e]=mS[n]={get(){this._cache=this._cache||{};let o=this._cache[a];return o===void 0&&(o=new kne(this,a),this._cache[a]=o),o},set(o){this[a].assign(rn(o))}};const i=a.toUpperCase(),s=e.toUpperCase(),r=n.toUpperCase();yn.prototype["set"+i]=yn.prototype["set"+s]=yn.prototype["set"+r]=function(o){const l=q$(a);return new h8e(this,l,rn(o))},yn.prototype["flip"+i]=yn.prototype["flip"+s]=yn.prototype["flip"+r]=function(){const o=q$(a);return new f8e(this,o)}}const Th=["x","y","z","w"],wh=["r","g","b","a"],Eh=["s","t","p","q"];for(let a=0;a<4;a++){let e=Th[a],n=wh[a],i=Eh[a];GM(e,n,i);for(let s=0;s<4;s++){e=Th[a]+Th[s],n=wh[a]+wh[s],i=Eh[a]+Eh[s],GM(e,n,i);for(let r=0;r<4;r++){e=Th[a]+Th[s]+Th[r],n=wh[a]+wh[s]+wh[r],i=Eh[a]+Eh[s]+Eh[r],GM(e,n,i);for(let o=0;o<4;o++)e=Th[a]+Th[s]+Th[r]+Th[o],n=wh[a]+wh[s]+wh[r]+wh[o],i=Eh[a]+Eh[s]+Eh[r]+Eh[o],GM(e,n,i)}}}for(let a=0;a<32;a++)mS[a]={get(){this._cache=this._cache||{};let e=this._cache[a];return e===void 0&&(e=new g1(this,new nd(a,"uint")),this._cache[a]=e),e},set(e){this[a].assign(rn(e))}};Object.defineProperties(yn.prototype,mS);const H$=new WeakMap,g8e=function(a,e=null){const n=zg(a);return n==="node"?a:e===null&&(n==="float"||n==="boolean")||n&&n!=="shader"&&n!=="string"?rn(wO(a,e)):n==="shader"?a.isFn?a:Ye(a):a},A8e=function(a,e=null){for(const n in a)a[n]=rn(a[n],e);return a},y8e=function(a,e=null){const n=a.length;for(let i=0;i<n;i++)a[i]=rn(a[i],e);return a},One=function(a,e=null,n=null,i=null){function s(h){return i!==null?(h=rn(Object.assign(h,i)),i.intent===!0&&(h=h.toVarIntent())):h=rn(h),h}let r,o=e,l,c;function u(h){let f;return o?f=/[a-z]/i.test(o)?o+"()":o:f=a.type,l!==void 0&&h.length<l?(Rt(`TSL: "${f}" parameter length is less than minimum required.`),h.concat(new Array(l-h.length).fill(0))):c!==void 0&&h.length>c?(Rt(`TSL: "${f}" parameter length exceeds limit.`),h.slice(0,c)):h}return e===null?r=(...h)=>s(new a(...ty(u(h)))):n!==null?(n=rn(n),r=(...h)=>s(new a(e,...ty(u(h)),n))):r=(...h)=>s(new a(e,...ty(u(h)))),r.setParameterLength=(...h)=>(h.length===1?l=c=h[0]:h.length===2&&([l,c]=h),r),r.setName=h=>(o=h,r),r},v8e=function(a,...e){return new a(...ty(e))};class _8e extends yn{constructor(e,n){super(),this.shaderNode=e,this.rawInputs=n,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getElementType(e){return this.getOutputNode(e).getElementType(e)}getMemberType(e,n){return this.getOutputNode(e).getMemberType(e,n)}call(e){const{shaderNode:n,rawInputs:i}=this,s=e.getNodeProperties(n),r=e.getClosestSubBuild(n.subBuilds)||"",o=r||"default";if(s[o])return s[o];const l=e.subBuildFn,c=e.fnCall;e.subBuildFn=r,e.fnCall=this;let u=null;if(n.layout){let h=H$.get(e.constructor);h===void 0&&(h=new WeakMap,H$.set(e.constructor,h));let f=h.get(n);f===void 0&&(f=rn(e.buildFunctionNode(n)),h.set(n,f)),e.addInclude(f);const m=i?x8e(i):null;u=rn(f.call(m))}else{const h=new Proxy(e,{get:(T,E,M)=>{let N;return Symbol.iterator===E?N=function*(){yield void 0}:N=Reflect.get(T,E,M),N}}),f=i?b8e(i):null,m=Array.isArray(i)?i.length>0:i!==null,A=n.jsFunc,x=m||A.length>1?A(f,h):A(h);u=rn(x)}return e.subBuildFn=l,e.fnCall=c,n.once&&(s[o]=u),u}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const n=e.getNodeProperties(this),i=e.getSubBuildOutput(this);return n[i]=n[i]||this.setupOutput(e),n[i].subBuild=e.getClosestSubBuild(this),n[i]}build(e,n=null){let i=null;const s=e.getBuildStage(),r=e.getNodeProperties(this),o=e.getSubBuildOutput(this),l=this.getOutputNode(e),c=e.fnCall;if(e.fnCall=this,s==="setup"){const u=e.getSubBuildProperty("initialized",this);if(r[u]!==!0&&(r[u]=!0,r[o]=this.getOutputNode(e),r[o].build(e),this.shaderNode.subBuilds))for(const h of e.chaining){const f=e.getDataFromNode(h,"any");f.subBuilds=f.subBuilds||new Set;for(const m of this.shaderNode.subBuilds)f.subBuilds.add(m)}i=r[o]}else s==="analyze"?l.build(e,n):s==="generate"&&(i=l.build(e,n)||"");return e.fnCall=c,i}}function x8e(a){let e;return R4(a),a[0]&&(a[0].isNode||Object.getPrototypeOf(a[0])!==Object.prototype)?e=[...a]:e=a[0],e}function b8e(a){let e=0;return R4(a),new Proxy(a,{get:(n,i,s)=>{let r;if(i==="length")return r=a.length,r;if(Symbol.iterator===i)r=function*(){for(const o of a)yield rn(o)};else{if(a.length>0)if(Object.getPrototypeOf(a[0])===Object.prototype){const o=a[0];o[i]===void 0?r=o[e++]:r=Reflect.get(o,i,s)}else a[0]instanceof yn&&(a[i]===void 0?r=a[e++]:r=Reflect.get(a,i,s));else r=Reflect.get(n,i,s);r=rn(r)}return r}})}class S8e extends yn{constructor(e,n){super(n),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}getLayout(){return this.layout}call(e=null){return new _8e(this,e)}setup(){return this.call()}}const T8e=[!1,!0],w8e=[0,1,2,3],E8e=[-1,-2],Fne=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],dB=new Map;for(const a of T8e)dB.set(a,new nd(a));const hB=new Map;for(const a of w8e)hB.set(a,new nd(a,"uint"));const fB=new Map([...hB].map(a=>new nd(a.value,"int")));for(const a of E8e)fB.set(a,new nd(a,"int"));const C4=new Map([...fB].map(a=>new nd(a.value)));for(const a of Fne)C4.set(a,new nd(a));for(const a of Fne)C4.set(-a,new nd(-a));const N4={bool:dB,uint:hB,ints:fB,float:C4},W$=new Map([...dB,...C4]),wO=(a,e)=>W$.has(a)?W$.get(a):a.isNode===!0?a:new nd(a,e),Rr=function(a,e=null){return(...n)=>{for(const s of n)if(s===void 0)return Rt(`TSL: Invalid parameter for the type "${a}".`),new nd(0,a);if((n.length===0||!["bool","float","int","uint"].includes(a)&&n.every(s=>{const r=typeof s;return r!=="object"&&r!=="function"}))&&(n=[cB(a,...n)]),n.length===1&&e!==null&&e.has(n[0]))return $2(e.get(n[0]));if(n.length===1){const s=wO(n[0],a);return s.nodeType===a?$2(s):$2(new Dne(s,a))}const i=n.map(s=>wO(s));return $2(new u8e(i,a))}},lT=a=>typeof a=="object"&&a!==null?a.value:a,jne=a=>a!=null?a.nodeType||a.convertTo||(typeof a=="string"?a:null):null;function c_(a,e){return new S8e(a,e)}const rn=(a,e=null)=>g8e(a,e),$2=(a,e=null)=>rn(a,e).toVarIntent(),R4=(a,e=null)=>new A8e(a,e),ty=(a,e=null)=>new y8e(a,e),sa=(a,e=null,n=null,i=null)=>new One(a,e,n,i),sn=(a,...e)=>new v8e(a,...e),Zt=(a,e=null,n=null,i={})=>new One(a,e,n,{...i,intent:!0});let M8e=0;class C8e extends yn{constructor(e,n=null){super();let i=null;n!==null&&(typeof n=="object"?i=n.return:(typeof n=="string"?i=n:Rt("TSL: Invalid layout type."),n=null)),this.shaderNode=new c_(e,i),n!==null&&this.setLayout(n),this.isFn=!0}setLayout(e){const n=this.shaderNode.nodeType;if(typeof e.inputs!="object"){const i={name:"fn"+M8e++,type:n,inputs:[]};for(const s in e)s!=="return"&&i.inputs.push({name:s,type:e[s]});e=i}return this.shaderNode.setLayout(e),this}getNodeType(e){return this.shaderNode.getNodeType(e)||"float"}call(...e){const n=this.shaderNode.call(e);return this.shaderNode.nodeType==="void"&&n.toStack(),n.toVarIntent()}once(e=null){return this.shaderNode.once=!0,this.shaderNode.subBuilds=e,this}generate(e){const n=this.getNodeType(e);return Rt('TSL: "Fn()" was declared but not invoked. Try calling it like "Fn()( ...params )".'),e.generateConst(n)}}function Ye(a,e=null){const n=new C8e(a,e);return new Proxy(()=>{},{apply(i,s,r){return n.call(...r)},get(i,s,r){return Reflect.get(n,s,r)},set(i,s,r,o){return Reflect.set(n,s,r,o)}})}const cT=a=>{y0=a},pB=()=>y0,kn=(...a)=>y0.If(...a),N8e=(...a)=>y0.Switch(...a);function P4(a){return y0&&y0.addToStack(a),a}Pt("toStack",P4);const Bne=new Rr("color"),Re=new Rr("float",N4.float),Be=new Rr("int",N4.ints),qt=new Rr("uint",N4.uint),Ku=new Rr("bool",N4.bool),Qt=new Rr("vec2"),yr=new Rr("ivec2"),mB=new Rr("uvec2"),Une=new Rr("bvec2"),qe=new Rr("vec3"),gB=new Rr("ivec3"),A1=new Rr("uvec3"),AB=new Rr("bvec3"),On=new Rr("vec4"),yB=new Rr("ivec4"),vB=new Rr("uvec4"),Vne=new Rr("bvec4"),I4=new Rr("mat2"),Oo=new Rr("mat3"),n0=new Rr("mat4"),R8e=(a="")=>new nd(a,"string"),P8e=a=>new nd(a,"ArrayBuffer");Pt("toColor",Bne);Pt("toFloat",Re);Pt("toInt",Be);Pt("toUint",qt);Pt("toBool",Ku);Pt("toVec2",Qt);Pt("toIVec2",yr);Pt("toUVec2",mB);Pt("toBVec2",Une);Pt("toVec3",qe);Pt("toIVec3",gB);Pt("toUVec3",A1);Pt("toBVec3",AB);Pt("toVec4",On);Pt("toIVec4",yB);Pt("toUVec4",vB);Pt("toBVec4",Vne);Pt("toMat2",I4);Pt("toMat3",Oo);Pt("toMat4",n0);const zne=sa(g1).setParameterLength(2),Gne=(a,e)=>rn(new Dne(rn(a),e)),I8e=(a,e)=>rn(new kne(rn(a),e));Pt("element",zne);Pt("convert",Gne);const L8e=a=>(yt("TSL: append() has been renamed to Stack()."),P4(a));Pt("append",a=>(yt("TSL: .append() has been renamed to .toStack()."),P4(a)));class Si extends yn{static get type(){return"PropertyNode"}constructor(e,n=null,i=!1){super(e),this.name=n,this.varying=i,this.isPropertyNode=!0,this.global=!0}customCacheKey(){return uw(this.type+":"+(this.name||"")+":"+(this.varying?"1":"0"))}getHash(e){return this.name||super.getHash(e)}generate(e){let n;return this.varying===!0?(n=e.getVaryingFromNode(this,this.name),n.needsInterpolation=!0):n=e.getVarFromNode(this,this.name),e.getPropertyName(n)}}const im=(a,e)=>new Si(a,e),uT=(a,e)=>new Si(a,e,!0),Pi=sn(Si,"vec4","DiffuseColor"),IA=sn(Si,"vec3","DiffuseContribution"),EO=sn(Si,"vec3","EmissiveColor"),Uh=sn(Si,"float","Roughness"),Xp=sn(Si,"float","Metalness"),gR=sn(Si,"float","Clearcoat"),dT=sn(Si,"float","ClearcoatRoughness"),Xc=sn(Si,"vec3","Sheen"),Ig=sn(Si,"float","SheenRoughness"),L4=sn(Si,"float","Iridescence"),AR=sn(Si,"float","IridescenceIOR"),yR=sn(Si,"float","IridescenceThickness"),vR=sn(Si,"float","AlphaT"),Eg=sn(Si,"float","Anisotropy"),gS=sn(Si,"vec3","AnisotropyT"),ny=sn(Si,"vec3","AnisotropyB"),v0=sn(Si,"color","SpecularColor"),WA=sn(Si,"color","SpecularColorBlended"),M_=sn(Si,"float","SpecularF90"),_R=sn(Si,"float","Shininess"),C_=sn(Si,"vec4","Output"),i3=sn(Si,"float","dashSize"),MO=sn(Si,"float","gapSize"),D8e=sn(Si,"float","pointWidth"),AS=sn(Si,"float","IOR"),xR=sn(Si,"float","Transmission"),_B=sn(Si,"float","Thickness"),xB=sn(Si,"float","AttenuationDistance"),bB=sn(Si,"color","AttenuationColor"),SB=sn(Si,"float","Dispersion");class qne extends yn{static get type(){return"UniformGroupNode"}constructor(e,n=!1,i=1){super("string"),this.name=e,this.shared=n,this.order=i,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const Hne=a=>new qne(a),D4=(a,e=0)=>new qne(a,!0,e),Wne=D4("frame"),Nn=D4("render"),TB=Hne("object");class dw extends uB{static get type(){return"UniformNode"}constructor(e,n=null){super(e,n),this.isUniformNode=!0,this.name="",this.groupNode=TB}setName(e){return this.name=e,this}label(e){return yt('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,n){return e=e.bind(this),super.onUpdate(i=>{const s=e(i,this);s!==void 0&&(this.value=s)},n)}getInputType(e){let n=super.getInputType(e);return n==="bool"&&(n="uint"),n}generate(e,n){const i=this.getNodeType(e),s=this.getUniformHash(e);let r=e.getNodeFromHash(s);r===void 0&&(e.setHashNode(this,s),r=this);const o=r.getInputType(e),l=e.getUniformFromNode(r,o,e.shaderStage,this.name||e.context.nodeName),c=e.getPropertyName(l);e.context.nodeName!==void 0&&delete e.context.nodeName;let u=c;if(i==="bool"){const h=e.getDataFromNode(this);let f=h.propertyName;if(f===void 0){const m=e.getVarFromNode(this,null,"bool");f=e.getPropertyName(m),h.propertyName=f,u=e.format(c,o,i),e.addLineFlowCode(`${f} = ${u}`,this)}u=f}return e.format(u,i,n)}}const Rn=(a,e)=>{const n=jne(e||a);if(n===a&&(a=cB(n)),a&&a.isNode===!0){let i=a.value;a.traverse(s=>{s.isConstNode===!0&&(i=s.value)}),a=i}return new dw(a,n)};class $$ extends Rs{static get type(){return"ArrayNode"}constructor(e,n,i=null){super(e),this.count=n,this.values=i,this.isArrayNode=!0}getArrayCount(){return this.count}getNodeType(e){return this.nodeType===null?this.values[0].getNodeType(e):this.nodeType}getElementType(e){return this.getNodeType(e)}getMemberType(e,n){return this.nodeType===null?this.values[0].getMemberType(e,n):super.getMemberType(e,n)}generate(e){const n=this.getNodeType(e);return e.generateArray(n,this.count,this.values)}}const $ne=(...a)=>{let e;if(a.length===1){const n=a[0];e=new $$(null,n.length,n)}else{const n=a[0],i=a[1];e=new $$(n,i)}return rn(e)};Pt("toArray",(a,e)=>$ne(Array(e).fill(a)));class k8e extends Rs{static get type(){return"AssignNode"}constructor(e,n){super(),this.targetNode=e,this.sourceNode=n,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,n){return n!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:n}=this;if(e.isAvailable("swizzleAssign")===!1&&n.isSplitNode&&n.components.length>1){const i=e.getTypeLength(n.node.getNodeType(e));return m1.join("").slice(0,i)!==n.components}return!1}setup(e){const{targetNode:n,sourceNode:i}=this,s=n.getScope(),r=e.getDataFromNode(s);r.assign=!0;const o=e.getNodeProperties(this);o.sourceNode=i,o.targetNode=n.context({assign:!0})}generate(e,n){const{targetNode:i,sourceNode:s}=e.getNodeProperties(this),r=this.needsSplitAssign(e),o=i.build(e),l=i.getNodeType(e),c=s.build(e,l),u=s.getNodeType(e),h=e.getDataFromNode(this);let f;if(h.initialized===!0)n!=="void"&&(f=o);else if(r){const m=e.getVarFromNode(this,null,l),A=e.getPropertyName(m);e.addLineFlowCode(`${A} = ${c}`,this);const x=i.node,E=x.node.context({assign:!0}).build(e);for(let M=0;M<x.components.length;M++){const N=x.components[M];e.addLineFlowCode(`${E}.${N} = ${A}[ ${M} ]`,this)}n!=="void"&&(f=o)}else f=`${o} = ${c}`,(n==="void"||u==="void")&&(e.addLineFlowCode(f,this),n!=="void"&&(f=o));return h.initialized=!0,e.format(f,l,n)}}const Kne=sa(k8e).setParameterLength(2);Pt("assign",Kne);class O8e extends Rs{static get type(){return"FunctionCallNode"}constructor(e=null,n={}){super(),this.functionNode=e,this.parameters=n}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}getMemberType(e,n){return this.functionNode.getMemberType(e,n)}generate(e){const n=[],i=this.functionNode,s=i.getInputs(e),r=this.parameters,o=(c,u)=>{const h=u.type,f=h==="pointer";let m;return f?m="&"+c.build(e):m=c.build(e,h),m};if(Array.isArray(r)){if(r.length>s.length)Rt("TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),r.length=s.length;else if(r.length<s.length)for(Rt("TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");r.length<s.length;)r.push(Re(0));for(let c=0;c<r.length;c++)n.push(o(r[c],s[c]))}else for(const c of s){const u=r[c.name];u!==void 0?n.push(o(u,c)):(Rt(`TSL: Input '${c.name}' not found in 'Fn()'.`),n.push(o(Re(0),c)))}return`${i.build(e,"property")}( ${n.join(", ")} )`}}const Yne=(a,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?ty(e):R4(e[0]),new O8e(rn(a),e));Pt("call",Yne);const F8e={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class Cs extends Rs{static get type(){return"OperatorNode"}constructor(e,n,i,...s){if(super(),s.length>0){let r=new Cs(e,n,i);for(let o=0;o<s.length-1;o++)r=new Cs(e,r,s[o]);n=r,i=s[s.length-1]}this.op=e,this.aNode=n,this.bNode=i,this.isOperatorNode=!0}getOperatorMethod(e,n){return e.getMethod(F8e[this.op],n)}getNodeType(e,n=null){const i=this.op,s=this.aNode,r=this.bNode,o=s.getNodeType(e),l=r?r.getNodeType(e):null;if(o==="void"||l==="void")return n||"void";if(i==="%")return o;if(i==="~"||i==="&"||i==="|"||i==="^"||i===">>"||i==="<<")return e.getIntegerType(o);if(i==="!"||i==="&&"||i==="||"||i==="^^")return"bool";if(i==="=="||i==="!="||i==="<"||i===">"||i==="<="||i===">="){const c=Math.max(e.getTypeLength(o),e.getTypeLength(l));return c>1?`bvec${c}`:"bool"}else{if(e.isMatrix(o)){if(l==="float")return o;if(e.isVector(l))return e.getVectorFromMatrix(o);if(e.isMatrix(l))return o}else if(e.isMatrix(l)){if(o==="float")return l;if(e.isVector(o))return e.getVectorFromMatrix(l)}return e.getTypeLength(l)>e.getTypeLength(o)?l:o}}generate(e,n){const i=this.op,{aNode:s,bNode:r}=this,o=this.getNodeType(e,n);let l=null,c=null;o!=="void"?(l=s.getNodeType(e),c=r?r.getNodeType(e):null,i==="<"||i===">"||i==="<="||i===">="||i==="=="||i==="!="?e.isVector(l)?c=l:e.isVector(c)?l=c:l!==c&&(l=c="float"):i===">>"||i==="<<"?(l=o,c=e.changeComponentType(c,"uint")):i==="%"?(l=o,c=e.isInteger(l)&&e.isInteger(c)?c:l):e.isMatrix(l)?c==="float"?c="float":e.isVector(c)?c=e.getVectorFromMatrix(l):e.isMatrix(c)||(l=c=o):e.isMatrix(c)?l==="float"?l="float":e.isVector(l)?l=e.getVectorFromMatrix(c):l=c=o:l=c=o):l=c=o;const u=s.build(e,l),h=r?r.build(e,c):null,f=e.getFunctionOperator(i);if(n!=="void"){const m=e.renderer.coordinateSystem===Ro;if(i==="=="||i==="!="||i==="<"||i===">"||i==="<="||i===">=")return m?e.isVector(l)?e.format(`${this.getOperatorMethod(e,n)}( ${u}, ${h} )`,o,n):e.format(`( ${u} ${i} ${h} )`,o,n):e.format(`( ${u} ${i} ${h} )`,o,n);if(i==="%")return e.isInteger(c)?e.format(`( ${u} % ${h} )`,o,n):e.format(`${this.getOperatorMethod(e,o)}( ${u}, ${h} )`,o,n);if(i==="!"||i==="~")return e.format(`(${i}${u})`,l,n);if(f)return e.format(`${f}( ${u}, ${h} )`,o,n);if(e.isMatrix(l)&&c==="float")return e.format(`( ${h} ${i} ${u} )`,o,n);if(l==="float"&&e.isMatrix(c))return e.format(`${u} ${i} ${h}`,o,n);{let A=`( ${u} ${i} ${h} )`;return!m&&o==="bool"&&e.isVector(l)&&e.isVector(c)&&(A=`all${A}`),e.format(A,o,n)}}else if(l!=="void")return f?e.format(`${f}( ${u}, ${h} )`,o,n):e.isMatrix(l)&&c==="float"?e.format(`${h} ${i} ${u}`,o,n):e.format(`${u} ${i} ${h}`,o,n)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const cr=Zt(Cs,"+").setParameterLength(2,1/0).setName("add"),Ka=Zt(Cs,"-").setParameterLength(2,1/0).setName("sub"),ia=Zt(Cs,"*").setParameterLength(2,1/0).setName("mul"),yu=Zt(Cs,"/").setParameterLength(2,1/0).setName("div"),hw=Zt(Cs,"%").setParameterLength(2).setName("mod"),wB=Zt(Cs,"==").setParameterLength(2).setName("equal"),Xne=Zt(Cs,"!=").setParameterLength(2).setName("notEqual"),Qne=Zt(Cs,"<").setParameterLength(2).setName("lessThan"),EB=Zt(Cs,">").setParameterLength(2).setName("greaterThan"),Jne=Zt(Cs,"<=").setParameterLength(2).setName("lessThanEqual"),Zne=Zt(Cs,">=").setParameterLength(2).setName("greaterThanEqual"),eae=Zt(Cs,"&&").setParameterLength(2,1/0).setName("and"),tae=Zt(Cs,"||").setParameterLength(2,1/0).setName("or"),nae=Zt(Cs,"!").setParameterLength(1).setName("not"),aae=Zt(Cs,"^^").setParameterLength(2).setName("xor"),iae=Zt(Cs,"&").setParameterLength(2).setName("bitAnd"),sae=Zt(Cs,"~").setParameterLength(1).setName("bitNot"),rae=Zt(Cs,"|").setParameterLength(2).setName("bitOr"),oae=Zt(Cs,"^").setParameterLength(2).setName("bitXor"),lae=Zt(Cs,"<<").setParameterLength(2).setName("shiftLeft"),cae=Zt(Cs,">>").setParameterLength(2).setName("shiftRight"),uae=Ye(([a])=>(a.addAssign(1),a)),dae=Ye(([a])=>(a.subAssign(1),a)),hae=Ye(([a])=>{const e=Be(a).toConst();return a.addAssign(1),e}),fae=Ye(([a])=>{const e=Be(a).toConst();return a.subAssign(1),e});Pt("add",cr);Pt("sub",Ka);Pt("mul",ia);Pt("div",yu);Pt("mod",hw);Pt("equal",wB);Pt("notEqual",Xne);Pt("lessThan",Qne);Pt("greaterThan",EB);Pt("lessThanEqual",Jne);Pt("greaterThanEqual",Zne);Pt("and",eae);Pt("or",tae);Pt("not",nae);Pt("xor",aae);Pt("bitAnd",iae);Pt("bitNot",sae);Pt("bitOr",rae);Pt("bitXor",oae);Pt("shiftLeft",lae);Pt("shiftRight",cae);Pt("incrementBefore",uae);Pt("decrementBefore",dae);Pt("increment",hae);Pt("decrement",fae);const pae=(a,e)=>(yt('TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),hw(Be(a),Be(e)));Pt("modInt",pae);class ft extends Rs{static get type(){return"MathNode"}constructor(e,n,i=null,s=null){if(super(),(e===ft.MAX||e===ft.MIN)&&arguments.length>3){let r=new ft(e,n,i);for(let o=2;o<arguments.length-1;o++)r=new ft(e,r,arguments[o]);n=r,i=arguments[arguments.length-1],s=null}this.method=e,this.aNode=n,this.bNode=i,this.cNode=s,this.isMathNode=!0}getInputType(e){const n=this.aNode.getNodeType(e),i=this.bNode?this.bNode.getNodeType(e):null,s=this.cNode?this.cNode.getNodeType(e):null,r=e.isMatrix(n)?0:e.getTypeLength(n),o=e.isMatrix(i)?0:e.getTypeLength(i),l=e.isMatrix(s)?0:e.getTypeLength(s);return r>o&&r>l?n:o>l?i:l>r?s:n}getNodeType(e){const n=this.method;return n===ft.LENGTH||n===ft.DISTANCE||n===ft.DOT?"float":n===ft.CROSS?"vec3":n===ft.ALL||n===ft.ANY?"bool":n===ft.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:n,bNode:i,method:s}=this;let r=null;if(s===ft.ONE_MINUS)r=Ka(1,n);else if(s===ft.RECIPROCAL)r=yu(1,n);else if(s===ft.DIFFERENCE)r=Ji(Ka(n,i));else if(s===ft.TRANSFORM_DIRECTION){let o=n,l=i;e.isMatrix(o.getNodeType(e))?l=On(qe(l),0):o=On(qe(o),0);const c=ia(o,l).xyz;r=Fl(c)}return r!==null?r:super.setup(e)}generate(e,n){if(e.getNodeProperties(this).outputNode)return super.generate(e,n);let s=this.method;const r=this.getNodeType(e),o=this.getInputType(e),l=this.aNode,c=this.bNode,u=this.cNode,h=e.renderer.coordinateSystem;if(s===ft.NEGATE)return e.format("( - "+l.build(e,o)+" )",r,n);{const f=[];return s===ft.CROSS?f.push(l.build(e,r),c.build(e,r)):h===Ro&&s===ft.STEP?f.push(l.build(e,e.getTypeLength(l.getNodeType(e))===1?"float":o),c.build(e,o)):h===Ro&&(s===ft.MIN||s===ft.MAX)?f.push(l.build(e,o),c.build(e,e.getTypeLength(c.getNodeType(e))===1?"float":o)):s===ft.REFRACT?f.push(l.build(e,o),c.build(e,o),u.build(e,"float")):s===ft.MIX?f.push(l.build(e,o),c.build(e,o),u.build(e,e.getTypeLength(u.getNodeType(e))===1?"float":o)):(h===bc&&s===ft.ATAN&&c!==null&&(s="atan2"),e.shaderStage!=="fragment"&&(s===ft.DFDX||s===ft.DFDY)&&(yt(`TSL: '${s}' is not supported in the ${e.shaderStage} stage.`),s="/*"+s+"*/"),f.push(l.build(e,o)),c!==null&&f.push(c.build(e,o)),u!==null&&f.push(u.build(e,o))),e.format(`${e.getMethod(s,r)}( ${f.join(", ")} )`,r,n)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}ft.ALL="all";ft.ANY="any";ft.RADIANS="radians";ft.DEGREES="degrees";ft.EXP="exp";ft.EXP2="exp2";ft.LOG="log";ft.LOG2="log2";ft.SQRT="sqrt";ft.INVERSE_SQRT="inversesqrt";ft.FLOOR="floor";ft.CEIL="ceil";ft.NORMALIZE="normalize";ft.FRACT="fract";ft.SIN="sin";ft.COS="cos";ft.TAN="tan";ft.ASIN="asin";ft.ACOS="acos";ft.ATAN="atan";ft.ABS="abs";ft.SIGN="sign";ft.LENGTH="length";ft.NEGATE="negate";ft.ONE_MINUS="oneMinus";ft.DFDX="dFdx";ft.DFDY="dFdy";ft.ROUND="round";ft.RECIPROCAL="reciprocal";ft.TRUNC="trunc";ft.FWIDTH="fwidth";ft.TRANSPOSE="transpose";ft.DETERMINANT="determinant";ft.INVERSE="inverse";ft.EQUALS="equals";ft.MIN="min";ft.MAX="max";ft.STEP="step";ft.REFLECT="reflect";ft.DISTANCE="distance";ft.DIFFERENCE="difference";ft.DOT="dot";ft.CROSS="cross";ft.POW="pow";ft.TRANSFORM_DIRECTION="transformDirection";ft.MIX="mix";ft.CLAMP="clamp";ft.REFRACT="refract";ft.SMOOTHSTEP="smoothstep";ft.FACEFORWARD="faceforward";const MB=Re(1e-6),j8e=Re(1e6),bR=Re(Math.PI),B8e=Re(Math.PI*2),U8e=Re(Math.PI*2),V8e=Re(Math.PI*.5),mae=Zt(ft,ft.ALL).setParameterLength(1),gae=Zt(ft,ft.ANY).setParameterLength(1),Aae=Zt(ft,ft.RADIANS).setParameterLength(1),yae=Zt(ft,ft.DEGREES).setParameterLength(1),CB=Zt(ft,ft.EXP).setParameterLength(1),px=Zt(ft,ft.EXP2).setParameterLength(1),k4=Zt(ft,ft.LOG).setParameterLength(1),sf=Zt(ft,ft.LOG2).setParameterLength(1),cl=Zt(ft,ft.SQRT).setParameterLength(1),NB=Zt(ft,ft.INVERSE_SQRT).setParameterLength(1),rf=Zt(ft,ft.FLOOR).setParameterLength(1),O4=Zt(ft,ft.CEIL).setParameterLength(1),Fl=Zt(ft,ft.NORMALIZE).setParameterLength(1),Yd=Zt(ft,ft.FRACT).setParameterLength(1),Rl=Zt(ft,ft.SIN).setParameterLength(1),Rd=Zt(ft,ft.COS).setParameterLength(1),vae=Zt(ft,ft.TAN).setParameterLength(1),_ae=Zt(ft,ft.ASIN).setParameterLength(1),RB=Zt(ft,ft.ACOS).setParameterLength(1),F4=Zt(ft,ft.ATAN).setParameterLength(1,2),Ji=Zt(ft,ft.ABS).setParameterLength(1),PB=Zt(ft,ft.SIGN).setParameterLength(1),of=Zt(ft,ft.LENGTH).setParameterLength(1),IB=Zt(ft,ft.NEGATE).setParameterLength(1),xae=Zt(ft,ft.ONE_MINUS).setParameterLength(1),LB=Zt(ft,ft.DFDX).setParameterLength(1),DB=Zt(ft,ft.DFDY).setParameterLength(1),bae=Zt(ft,ft.ROUND).setParameterLength(1),Sae=Zt(ft,ft.RECIPROCAL).setParameterLength(1),kB=Zt(ft,ft.TRUNC).setParameterLength(1),OB=Zt(ft,ft.FWIDTH).setParameterLength(1),Tae=Zt(ft,ft.TRANSPOSE).setParameterLength(1),wae=Zt(ft,ft.DETERMINANT).setParameterLength(1),Eae=Zt(ft,ft.INVERSE).setParameterLength(1),Mae=(a,e)=>(yt('TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),wB(a,e)),Tc=Zt(ft,ft.MIN).setParameterLength(2,1/0),Ns=Zt(ft,ft.MAX).setParameterLength(2,1/0),j4=Zt(ft,ft.STEP).setParameterLength(2),Cae=Zt(ft,ft.REFLECT).setParameterLength(2),Nae=Zt(ft,ft.DISTANCE).setParameterLength(2),Rae=Zt(ft,ft.DIFFERENCE).setParameterLength(2),Yu=Zt(ft,ft.DOT).setParameterLength(2),Mm=Zt(ft,ft.CROSS).setParameterLength(2),Uu=Zt(ft,ft.POW).setParameterLength(2),FB=a=>ia(a,a),Pae=a=>ia(a,a,a),jB=a=>ia(a,a,a,a),Iae=Zt(ft,ft.TRANSFORM_DIRECTION).setParameterLength(2),Lae=a=>ia(PB(a),Uu(Ji(a),1/3)),BB=a=>Yu(a,a),Ha=Zt(ft,ft.MIX).setParameterLength(3),Xd=(a,e=0,n=1)=>rn(new ft(ft.CLAMP,rn(a),rn(e),rn(n))),B4=a=>Xd(a),UB=Zt(ft,ft.REFRACT).setParameterLength(3),Qd=Zt(ft,ft.SMOOTHSTEP).setParameterLength(3),VB=Zt(ft,ft.FACEFORWARD).setParameterLength(3),Dae=Ye(([a])=>{const i=43758.5453,s=Yu(a.xy,Qt(12.9898,78.233)),r=hw(s,bR);return Yd(Rl(r).mul(i))}),kae=(a,e,n)=>Ha(e,n,a),Oae=(a,e,n)=>Qd(e,n,a),Fae=(a,e)=>j4(e,a),jae=(a,e)=>(yt('TSL: "atan2" is overloaded. Use "atan" instead.'),F4(a,e)),z8e=VB,G8e=NB;Pt("all",mae);Pt("any",gae);Pt("equals",Mae);Pt("radians",Aae);Pt("degrees",yae);Pt("exp",CB);Pt("exp2",px);Pt("log",k4);Pt("log2",sf);Pt("sqrt",cl);Pt("inverseSqrt",NB);Pt("floor",rf);Pt("ceil",O4);Pt("normalize",Fl);Pt("fract",Yd);Pt("sin",Rl);Pt("cos",Rd);Pt("tan",vae);Pt("asin",_ae);Pt("acos",RB);Pt("atan",F4);Pt("abs",Ji);Pt("sign",PB);Pt("length",of);Pt("lengthSq",BB);Pt("negate",IB);Pt("oneMinus",xae);Pt("dFdx",LB);Pt("dFdy",DB);Pt("round",bae);Pt("reciprocal",Sae);Pt("trunc",kB);Pt("fwidth",OB);Pt("atan2",jae);Pt("min",Tc);Pt("max",Ns);Pt("step",Fae);Pt("reflect",Cae);Pt("distance",Nae);Pt("dot",Yu);Pt("cross",Mm);Pt("pow",Uu);Pt("pow2",FB);Pt("pow3",Pae);Pt("pow4",jB);Pt("transformDirection",Iae);Pt("mix",kae);Pt("clamp",Xd);Pt("refract",UB);Pt("smoothstep",Oae);Pt("faceForward",VB);Pt("difference",Rae);Pt("saturate",B4);Pt("cbrt",Lae);Pt("transpose",Tae);Pt("determinant",wae);Pt("inverse",Eae);Pt("rand",Dae);class q8e extends yn{static get type(){return"ConditionalNode"}constructor(e,n,i=null){super(),this.condNode=e,this.ifNode=n,this.elseNode=i}getNodeType(e){const{ifNode:n,elseNode:i}=e.getNodeProperties(this);if(n===void 0)return e.flowBuildStage(this,"setup"),this.getNodeType(e);const s=n.getNodeType(e);if(i!==null){const r=i.getNodeType(e);if(e.getTypeLength(r)>e.getTypeLength(s))return r}return s}setup(e){const n=this.condNode,i=this.ifNode.isolate(),s=this.elseNode?this.elseNode.isolate():null,r=e.context.nodeBlock;e.getDataFromNode(i).parentNodeBlock=r,s!==null&&(e.getDataFromNode(s).parentNodeBlock=r);const o=e.context.uniformFlow,l=e.getNodeProperties(this);l.condNode=n,l.ifNode=o?i:i.context({nodeBlock:i}),l.elseNode=s?o?s:s.context({nodeBlock:s}):null}generate(e,n){const i=this.getNodeType(e),s=e.getDataFromNode(this);if(s.nodeProperty!==void 0)return s.nodeProperty;const{condNode:r,ifNode:o,elseNode:l}=e.getNodeProperties(this),c=e.currentFunctionNode,u=n!=="void",h=u?im(i).build(e):"";s.nodeProperty=h;const f=r.build(e,"bool");if(e.context.uniformFlow&&l!==null){const x=o.build(e,i),T=l.build(e,i),E=e.getTernary(f,x,T);return e.format(E,i,n)}e.addFlowCode(`
${e.tab}if ( ${f} ) {

`).addFlowTab();let A=o.build(e,i);if(A&&(u?A=h+" = "+A+";":(A="return "+A+";",c===null&&(yt("TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),A="// "+A))),e.removeFlowTab().addFlowCode(e.tab+"	"+A+`

`+e.tab+"}"),l!==null){e.addFlowCode(` else {

`).addFlowTab();let x=l.build(e,i);x&&(u?x=h+" = "+x+";":(x="return "+x+";",c===null&&(yt("TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),x="// "+x))),e.removeFlowTab().addFlowCode(e.tab+"	"+x+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(h,i,n)}}const Io=sa(q8e).setParameterLength(2,3);Pt("select",Io);class Bae extends yn{static get type(){return"ContextNode"}constructor(e=null,n={}){super(),this.isContextNode=!0,this.node=e,this.value=n}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}getFlowContextData(){const e=[];return this.traverse(n=>{n.isContextNode===!0&&e.push(n.value)}),Object.assign({},...e)}getMemberType(e,n){return this.node.getMemberType(e,n)}analyze(e){const n=e.addContext(this.value);this.node.build(e),e.setContext(n)}setup(e){const n=e.addContext(this.value);this.node.build(e),e.setContext(n)}generate(e,n){const i=e.addContext(this.value),s=this.node.build(e,n);return e.setContext(i),s}}const Dm=(a=null,e={})=>{let n=a;return(n===null||n.isNode!==!0)&&(e=n||e,n=null),new Bae(n,e)},Uae=a=>Dm(a,{uniformFlow:!0}),zB=(a,e)=>Dm(a,{nodeName:e});function Vae(a,e,n=null){return Dm(n,{getShadow:({light:i,shadowColorNode:s})=>e===i?s.mul(a):s})}function zae(a,e=null){return Dm(e,{getAO:(n,{material:i})=>i.transparent===!0?n:n!==null?n.mul(a):a})}function Gae(a,e){return yt('TSL: "label()" has been deprecated. Use "setName()" instead.'),zB(a,e)}Pt("context",Dm);Pt("label",Gae);Pt("uniformFlow",Uae);Pt("setName",zB);Pt("builtinShadowContext",(a,e,n)=>Vae(e,n,a));Pt("builtinAOContext",(a,e)=>zae(e,a));class s3 extends yn{static get type(){return"VarNode"}constructor(e,n=null,i=!1){super(),this.node=e,this.name=n,this.global=!0,this.isVarNode=!0,this.readOnly=i,this.parents=!0,this.intent=!1}setIntent(e){return this.intent=e,this}isIntent(e){return e.getDataFromNode(this).forceDeclaration===!0?!1:this.intent}getIntent(){return this.intent}getMemberType(e,n){return this.node.getMemberType(e,n)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}getArrayCount(e){return this.node.getArrayCount(e)}isAssign(e){return e.getDataFromNode(this).assign}build(...e){const n=e[0];if(this._hasStack(n)===!1&&n.buildStage==="setup"&&(n.context.nodeLoop||n.context.nodeBlock)){let i=!1;if(this.node.isShaderCallNodeInternal&&this.node.shaderNode.getLayout()===null&&n.fnCall&&n.fnCall.shaderNode&&n.getDataFromNode(this.node.shaderNode).hasLoop){const o=n.getDataFromNode(this);o.forceDeclaration=!0,i=!0}const s=n.getBaseStack();i?s.addToStackBefore(this):s.addToStack(this)}return this.isIntent(n)&&this.isAssign(n)!==!0?this.node.build(...e):super.build(...e)}generate(e){const{node:n,name:i,readOnly:s}=this,{renderer:r}=e,o=r.backend.isWebGPUBackend===!0;let l=!1,c=!1;s&&(l=e.isDeterministic(n),c=o?s:l);const u=this.getNodeType(e);if(u=="void")return this.isIntent(e)!==!0&&Rt('TSL: ".toVar()" can not be used with void type.'),n.build(e);const h=e.getVectorType(u),f=n.build(e,h),m=e.getVarFromNode(this,i,h,void 0,c),A=e.getPropertyName(m);let x=A;if(c)if(o)x=l?`const ${A}`:`let ${A}`;else{const T=n.getArrayCount(e);x=`const ${e.getVar(m.type,A,T)}`}return e.addLineFlowCode(`${x} = ${f}`,this),A}_hasStack(e){return e.getDataFromNode(this).stack!==void 0}}const GB=sa(s3),qae=(a,e=null)=>GB(a,e).toStack(),Hae=(a,e=null)=>GB(a,e,!0).toStack(),Wae=a=>GB(a).setIntent(!0).toStack();Pt("toVar",qae);Pt("toConst",Hae);Pt("toVarIntent",Wae);class H8e extends yn{static get type(){return"SubBuild"}constructor(e,n,i=null){super(i),this.node=e,this.name=n,this.isSubBuildNode=!0}getNodeType(e){if(this.nodeType!==null)return this.nodeType;e.addSubBuild(this.name);const n=this.node.getNodeType(e);return e.removeSubBuild(),n}build(e,...n){e.addSubBuild(this.name);const i=this.node.build(e,...n);return e.removeSubBuild(),i}}const N_=(a,e,n=null)=>rn(new H8e(rn(a),e,n));class W8e extends yn{static get type(){return"VaryingNode"}constructor(e,n=null){super(),this.node=e,this.name=n,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,n=null){return this.interpolationType=e,this.interpolationSampling=n,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const n=e.getNodeProperties(this);let i=n.varying;if(i===void 0){const s=this.name,r=this.getNodeType(e),o=this.interpolationType,l=this.interpolationSampling;n.varying=i=e.getVaryingFromNode(this,s,r,o,l),n.node=N_(this.node,"VERTEX")}return i.needsInterpolation||(i.needsInterpolation=e.shaderStage==="fragment"),i}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(W2.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(W2.VERTEX,this.node)}generate(e){const n=e.getSubBuildProperty("property",e.currentStack),i=e.getNodeProperties(this),s=this.setupVarying(e);if(i[n]===void 0){const r=this.getNodeType(e),o=e.getPropertyName(s,W2.VERTEX);e.flowNodeFromShaderStage(W2.VERTEX,i.node,r,o),i[n]=o}return e.getPropertyName(s)}}const Xf=sa(W8e).setParameterLength(1,2),$ae=a=>Xf(a);Pt("toVarying",Xf);Pt("toVertexStage",$ae);Pt("varying",(...a)=>(yt("TSL: .varying() has been renamed to .toVarying()."),Xf(...a)));Pt("vertexStage",(...a)=>(yt("TSL: .vertexStage() has been renamed to .toVertexStage()."),Xf(...a)));const Kae=Ye(([a])=>{const e=a.mul(.9478672986).add(.0521327014).pow(2.4),n=a.mul(.0773993808),i=a.lessThanEqual(.04045);return Ha(e,n,i)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),Yae=Ye(([a])=>{const e=a.pow(.41666).mul(1.055).sub(.055),n=a.mul(12.92),i=a.lessThanEqual(.0031308);return Ha(e,n,i)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),qB="WorkingColorSpace",$8e="OutputColorSpace";class HB extends Rs{static get type(){return"ColorSpaceNode"}constructor(e,n,i){super("vec4"),this.colorNode=e,this.source=n,this.target=i}resolveColorSpace(e,n){return n===qB?Vn.workingColorSpace:n===$8e?e.context.outputColorSpace||e.renderer.outputColorSpace:n}setup(e){const{colorNode:n}=this,i=this.resolveColorSpace(e,this.source),s=this.resolveColorSpace(e,this.target);let r=n;return Vn.enabled===!1||i===s||!i||!s||(Vn.getTransfer(i)===An&&(r=On(Kae(r.rgb),r.a)),Vn.getPrimaries(i)!==Vn.getPrimaries(s)&&(r=On(Oo(Vn._getMatrix(new ga,i,s)).mul(r.rgb),r.a)),Vn.getTransfer(s)===An&&(r=On(Yae(r.rgb),r.a))),r}}const Xae=(a,e)=>rn(new HB(rn(a),qB,e)),U4=(a,e)=>rn(new HB(rn(a),e,qB)),K8e=(a,e,n)=>rn(new HB(rn(a),e,n));Pt("workingToColorSpace",Xae);Pt("colorSpaceToWorking",U4);let Y8e=class extends g1{static get type(){return"ReferenceElementNode"}constructor(e,n){super(e,n),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const n=super.generate(e),i=this.referenceNode.getNodeType(),s=this.getNodeType();return e.format(n,i,s)}};class Qae extends yn{static get type(){return"ReferenceBaseNode"}constructor(e,n,i=null,s=null){super(),this.property=e,this.uniformType=n,this.object=i,this.count=s,this.properties=e.split("."),this.reference=i,this.node=null,this.group=null,this.updateType=fa.OBJECT}setGroup(e){return this.group=e,this}element(e){return new Y8e(this,rn(e))}setNodeType(e){const n=Rn(null,e);this.group!==null&&n.setGroup(this.group),this.node=n}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:n}=this;let i=e[n[0]];for(let s=1;s<n.length;s++)i=i[n[s]];return i}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const X8e=(a,e,n)=>new Qae(a,e,n);class Q8e extends Qae{static get type(){return"RendererReferenceNode"}constructor(e,n,i=null){super(e,n,i),this.renderer=i,this.setGroup(Nn)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const Jae=(a,e,n=null)=>new Q8e(a,e,n);class J8e extends Rs{static get type(){return"ToneMappingNode"}constructor(e,n=eie,i=null){super("vec3"),this._toneMapping=e,this.exposureNode=n,this.colorNode=i}customCacheKey(){return pS(this._toneMapping)}setToneMapping(e){return this._toneMapping=e,this}getToneMapping(){return this._toneMapping}setup(e){const n=this.colorNode||e.context.color,i=this._toneMapping;if(i===lo)return n;let s=null;const r=e.renderer.library.getToneMappingFunction(i);return r!==null?s=On(r(n.rgb,this.exposureNode),n.a):(Rt("ToneMappingNode: Unsupported Tone Mapping configuration.",i),s=n),s}}const Zae=(a,e,n)=>rn(new J8e(a,rn(e),rn(n))),eie=Jae("toneMappingExposure","float");Pt("toneMapping",(a,e,n)=>Zae(e,n,a));const K$=new WeakMap;function Y$(a,e){let n=K$.get(a);return n===void 0&&(n=new zx(a,e),K$.set(a,n)),n}class pg extends uB{static get type(){return"BufferAttributeNode"}constructor(e,n=null,i=0,s=0){super(e,n),this.isBufferNode=!0,this.bufferType=n,this.bufferStride=i,this.bufferOffset=s,this.usage=m0,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&e.itemSize<=4&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let n=e.globalCache.getData(this.value);return n===void 0&&(n={node:this},e.globalCache.setData(this.value,n)),n.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const n=this.getNodeType(e),i=e.getTypeLength(n),s=this.value,r=this.bufferStride||i,o=this.bufferOffset;let l;s.isInterleavedBuffer===!0?l=s:s.isBufferAttribute===!0?l=Y$(s.array,r):l=Y$(s,r);const c=new kl(l,i,o);l.setUsage(this.usage),this.attribute=c,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const n=this.getNodeType(e),i=e.getBufferAttributeFromNode(this,n),s=e.getPropertyName(i);let r=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=s,r=s):r=Xf(this).build(e,n),r}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}function V4(a,e=null,n=0,i=0,s=m0,r=!1){return e==="mat3"||e===null&&a.itemSize===9?Oo(new pg(a,"vec3",9,0).setUsage(s).setInstanced(r),new pg(a,"vec3",9,3).setUsage(s).setInstanced(r),new pg(a,"vec3",9,6).setUsage(s).setInstanced(r)):e==="mat4"||e===null&&a.itemSize===16?n0(new pg(a,"vec4",16,0).setUsage(s).setInstanced(r),new pg(a,"vec4",16,4).setUsage(s).setInstanced(r),new pg(a,"vec4",16,8).setUsage(s).setInstanced(r),new pg(a,"vec4",16,12).setUsage(s).setInstanced(r)):new pg(a,e,n,i)}const WB=(a,e=null,n=0,i=0)=>V4(a,e,n,i),Z8e=(a,e=null,n=0,i=0)=>V4(a,e,n,i,Bg),SR=(a,e=null,n=0,i=0)=>V4(a,e,n,i,m0,!0),CO=(a,e=null,n=0,i=0)=>V4(a,e,n,i,Bg,!0);Pt("toAttribute",a=>WB(a.value));class eFe extends yn{static get type(){return"ComputeNode"}constructor(e,n){super("void"),this.isComputeNode=!0,this.computeNode=e,this.workgroupSize=n,this.count=null,this.version=1,this.name="",this.updateBeforeType=fa.OBJECT,this.onInitFunction=null}setCount(e){return this.count=e,this}getCount(){return this.count}dispose(){this.dispatchEvent({type:"dispose"})}setName(e){return this.name=e,this}label(e){return yt('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const n=this.computeNode.build(e);if(n){const i=e.getNodeProperties(this);i.outputComputeNode=n.outputNode,n.outputNode=null}return n}generate(e,n){const{shaderStage:i}=e;if(i==="compute"){const s=this.computeNode.build(e,"void");s!==""&&e.addLineFlowCode(s,this)}else{const r=e.getNodeProperties(this).outputComputeNode;if(r)return r.build(e,n)}}}const $B=(a,e=[64])=>{(e.length===0||e.length>3)&&Rt("TSL: compute() workgroupSize must have 1, 2, or 3 elements");for(let n=0;n<e.length;n++){const i=e[n];(typeof i!="number"||i<=0||!Number.isInteger(i))&&Rt(`TSL: compute() workgroupSize element at index [ ${n} ] must be a positive integer`)}for(;e.length<3;)e.push(1);return rn(new eFe(rn(a),e))},tie=(a,e,n)=>$B(a,n).setCount(e);Pt("compute",tie);Pt("computeKernel",$B);class tFe extends yn{static get type(){return"IsolateNode"}constructor(e,n=!0){super(),this.node=e,this.parent=n,this.isIsolateNode=!0}getNodeType(e){const n=e.getCache(),i=e.getCacheFromNode(this,this.parent);e.setCache(i);const s=this.node.getNodeType(e);return e.setCache(n),s}build(e,...n){const i=e.getCache(),s=e.getCacheFromNode(this,this.parent);e.setCache(s);const r=this.node.build(e,...n);return e.setCache(i),r}setParent(e){return this.parent=e,this}getParent(){return this.parent}}const R_=a=>new tFe(rn(a));function nie(a,e=!0){return yt('TSL: "cache()" has been deprecated. Use "isolate()" instead.'),R_(a).setParent(e)}Pt("cache",nie);Pt("isolate",R_);class nFe extends yn{static get type(){return"BypassNode"}constructor(e,n){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=n}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const n=this.callNode.build(e,"void");return n!==""&&e.addLineFlowCode(n,this),this.outputNode.build(e)}}const aie=sa(nFe).setParameterLength(2);Pt("bypass",aie);class iie extends yn{static get type(){return"RemapNode"}constructor(e,n,i,s=Re(0),r=Re(1)){super(),this.node=e,this.inLowNode=n,this.inHighNode=i,this.outLowNode=s,this.outHighNode=r,this.doClamp=!0}setup(){const{node:e,inLowNode:n,inHighNode:i,outLowNode:s,outHighNode:r,doClamp:o}=this;let l=e.sub(n).div(i.sub(n));return o===!0&&(l=l.clamp()),l.mul(r.sub(s)).add(s)}}const sie=sa(iie,null,null,{doClamp:!1}).setParameterLength(3,5),rie=sa(iie).setParameterLength(3,5);Pt("remap",sie);Pt("remapClamp",rie);class r3 extends yn{static get type(){return"ExpressionNode"}constructor(e="",n="void"){super(n),this.snippet=e}generate(e,n){const i=this.getNodeType(e),s=this.snippet;if(i==="void")e.addLineFlowCode(s,this);else return e.format(s,i,n)}}const Cm=sa(r3).setParameterLength(1,2),oie=a=>(a?Io(a,Cm("discard")):Cm("discard")).toStack(),aFe=()=>Cm("return").toStack();Pt("discard",oie);class iFe extends Rs{static get type(){return"RenderOutputNode"}constructor(e,n,i){super("vec4"),this.colorNode=e,this._toneMapping=n,this.outputColorSpace=i,this.isRenderOutputNode=!0}setToneMapping(e){return this._toneMapping=e,this}getToneMapping(){return this._toneMapping}setup({context:e}){let n=this.colorNode||e.color;const i=(this._toneMapping!==null?this._toneMapping:e.toneMapping)||lo,s=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||Il;return i!==lo&&(n=n.toneMapping(i)),s!==Il&&s!==Vn.workingColorSpace&&(n=n.workingToColorSpace(s)),n}}const lie=(a,e=null,n=null)=>rn(new iFe(rn(a),e,n));Pt("renderOutput",lie);class sFe extends Rs{static get type(){return"DebugNode"}constructor(e,n=null){super(),this.node=e,this.callback=n}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const n=this.callback,i=this.node.build(e),s="--- TSL debug - "+e.shaderStage+" shader ---",r="-".repeat(s.length);let o="";return o+="// #"+s+`#
`,o+=e.flow.code.replace(/^\t/mg,"")+`
`,o+="/* ... */ "+i+` /* ... */
`,o+="// #"+r+`#
`,n!==null?n(e,o):ix(o),i}}const cie=(a,e=null)=>rn(new sFe(rn(a),e)).toStack();Pt("debug",cie);class uie{constructor(){this._renderer=null,this.currentFrame=null}get nodeFrame(){return this._renderer._nodes.nodeFrame}setRenderer(e){return this._renderer=e,this}getRenderer(){return this._renderer}init(){}begin(){}finish(){}inspect(){}computeAsync(){}beginCompute(){}finishCompute(){}beginRender(){}finishRender(){}copyTextureToTexture(){}copyFramebufferToTexture(){}}class rFe extends yn{static get type(){return"InspectorNode"}constructor(e,n="",i=null){super(),this.node=e,this.name=n,this.callback=i,this.updateType=fa.FRAME,this.isInspectorNode=!0}getName(){return this.name||this.node.name}update(e){e.renderer.inspector.inspect(this)}getNodeType(e){return this.node.getNodeType(e)}setup(e){let n=this.node;return e.context.inspector===!0&&this.callback!==null&&(n=this.callback(n)),e.renderer.backend.isWebGPUBackend!==!0&&e.renderer.inspector.constructor!==uie&&ji('TSL: ".toInspector()" is only available with WebGPU.'),n}}function die(a,e="",n=null){return a=rn(a),a.before(new rFe(a,e,n))}Pt("toInspector",die);function oFe(a){yt("TSL: AddNodeElement has been removed in favor of tree-shaking. Trying add",a)}class hie extends yn{static get type(){return"AttributeNode"}constructor(e,n=null){super(n),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let n=this.nodeType;if(n===null){const i=this.getAttributeName(e);if(e.hasGeometryAttribute(i)){const s=e.geometry.getAttribute(i);n=e.getTypeFromAttribute(s)}else n="float"}return n}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const n=this.getAttributeName(e),i=this.getNodeType(e);if(e.hasGeometryAttribute(n)===!0){const r=e.geometry.getAttribute(n),o=e.getTypeFromAttribute(r),l=e.getAttribute(n,o);return e.shaderStage==="vertex"?e.format(l.name,o,i):Xf(this).build(e,i)}else return yt(`AttributeNode: Vertex attribute "${n}" not found on geometry.`),e.generateConst(i)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const Nm=(a,e=null)=>new hie(a,e),Vi=(a=0)=>Nm("uv"+(a>0?a:""),"vec2");class lFe extends yn{static get type(){return"TextureSizeNode"}constructor(e,n=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=n}generate(e,n){const i=this.textureNode.build(e,"property"),s=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${i}, ${s} )`,this.getNodeType(e),n)}}const sm=sa(lFe).setParameterLength(1,2);class cFe extends dw{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=fa.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,n=e.images,i=n&&n.length>0?n[0]&&n[0].image||n[0]:e.image;if(i&&i.width!==void 0){const{width:s,height:r}=i;this.value=Math.log2(Math.max(s,r))}}}const KB=sa(cFe).setParameterLength(1),YB=new _s;class qf extends dw{static get type(){return"TextureNode"}constructor(e=YB,n=null,i=null,s=null){super(e),this.isTextureNode=!0,this.uvNode=n,this.levelNode=i,this.biasNode=s,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.offsetNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=fa.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this._flipYUniform=null,this.setUpdateMatrix(n===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===Ei?"uvec4":this.value.type===jr?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return Vi(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=Rn(this.value.matrix)),this._matrixUniform.mul(qe(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this}setupUV(e,n){return e.isFlipY()&&(this._flipYUniform===null&&(this._flipYUniform=Rn(!1)),n=n.toVar(),this.sampler?n=this._flipYUniform.select(n.flipY(),n):n=this._flipYUniform.select(n.setY(Be(sm(this,this.levelNode).y).sub(n.y).sub(1)),n)),n}setup(e){const n=e.getNodeProperties(this);n.referenceNode=this.referenceNode;const i=this.value;if(!i||i.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");const s=Ye(()=>{let o=this.uvNode;return(o===null||e.context.forceUVContext===!0)&&e.context.getUV&&(o=e.context.getUV(this,e)),o||(o=this.getDefaultUV()),this.updateMatrix===!0&&(o=this.getTransformedUV(o)),o=this.setupUV(e,o),this.updateType=this._matrixUniform!==null||this._flipYUniform!==null?fa.OBJECT:fa.NONE,o})();let r=this.levelNode;r===null&&e.context.getTextureLevel&&(r=e.context.getTextureLevel(this)),n.uvNode=s,n.levelNode=r,n.biasNode=this.biasNode,n.compareNode=this.compareNode,n.gradNode=this.gradNode,n.depthNode=this.depthNode,n.offsetNode=this.offsetNode}generateUV(e,n){return n.build(e,this.sampler===!0?"vec2":"ivec2")}generateOffset(e,n){return n.build(e,"ivec2")}generateSnippet(e,n,i,s,r,o,l,c,u){const h=this.value;let f;return r?f=e.generateTextureBias(h,n,i,r,o,u):c?f=e.generateTextureGrad(h,n,i,c,o,u):l?f=e.generateTextureCompare(h,n,i,l,o,u):this.sampler===!1?f=e.generateTextureLoad(h,n,i,s,o,u):s?f=e.generateTextureLevel(h,n,i,s,o,u):f=e.generateTexture(h,n,i,o,u),f}generate(e,n){const i=this.value,s=e.getNodeProperties(this),r=super.generate(e,"property");if(/^sampler/.test(n))return r+"_sampler";if(e.isReference(n))return r;{const o=e.getDataFromNode(this);let l=o.propertyName;if(l===void 0){const{uvNode:h,levelNode:f,biasNode:m,compareNode:A,depthNode:x,gradNode:T,offsetNode:E}=s,M=this.generateUV(e,h),N=f?f.build(e,"float"):null,I=m?m.build(e,"float"):null,F=x?x.build(e,"int"):null,G=A?A.build(e,"float"):null,O=T?[T[0].build(e,"vec2"),T[1].build(e,"vec2")]:null,D=E?this.generateOffset(e,E):null,j=e.getVarFromNode(this);l=e.getPropertyName(j);const L=this.generateSnippet(e,r,M,N,I,F,G,O,D);e.addLineFlowCode(`${l} = ${L}`,this),o.snippet=L,o.propertyName=l}let c=l;const u=this.getNodeType(e);return e.needsToWorkingColorSpace(i)&&(c=U4(Cm(c,u),i.colorSpace).setup(e).build(e,u)),e.format(c,u,n)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return yt("TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const n=this.clone();return n.uvNode=rn(e),n.referenceNode=this.getBase(),rn(n)}load(e){return this.sample(e).setSampler(!1)}blur(e){const n=this.clone();n.biasNode=rn(e).mul(KB(n)),n.referenceNode=this.getBase();const i=n.value;return n.generateMipmaps===!1&&(i&&i.generateMipmaps===!1||i.minFilter===Mi||i.magFilter===Mi)&&(yt("TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),n.biasNode=null),rn(n)}level(e){const n=this.clone();return n.levelNode=rn(e),n.referenceNode=this.getBase(),rn(n)}size(e){return sm(this,e)}bias(e){const n=this.clone();return n.biasNode=rn(e),n.referenceNode=this.getBase(),rn(n)}getBase(){return this.referenceNode?this.referenceNode.getBase():this}compare(e){const n=this.clone();return n.compareNode=rn(e),n.referenceNode=this.getBase(),rn(n)}grad(e,n){const i=this.clone();return i.gradNode=[rn(e),rn(n)],i.referenceNode=this.getBase(),rn(i)}depth(e){const n=this.clone();return n.depthNode=rn(e),n.referenceNode=this.getBase(),rn(n)}offset(e){const n=this.clone();return n.offsetNode=rn(e),n.referenceNode=this.getBase(),rn(n)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,n=this._matrixUniform;n!==null&&(n.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix();const i=this._flipYUniform;i!==null&&(i.value=e.image instanceof ImageBitmap&&e.flipY===!0||e.isRenderTargetTexture===!0||e.isFramebufferTexture===!0||e.isDepthTexture===!0)}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}const uFe=sa(qf).setParameterLength(1,4).setName("texture"),hi=(a=YB,e=null,n=null,i=null)=>{let s;return a&&a.isTextureNode===!0?(s=rn(a.clone()),s.referenceNode=a.getBase(),e!==null&&(s.uvNode=rn(e)),n!==null&&(s.levelNode=rn(n)),i!==null&&(s.biasNode=rn(i))):s=uFe(a,e,n,i),s},dFe=(a=YB)=>hi(a),Os=(...a)=>hi(...a).setSampler(!1),hFe=(a,e,n)=>hi(a,e).level(n),fFe=a=>(a.isNode===!0?a:hi(a)).convert("sampler"),pFe=a=>(a.isNode===!0?a:hi(a)).convert("samplerComparison");class XB extends dw{static get type(){return"BufferNode"}constructor(e,n,i=0){super(e,n),this.isBufferNode=!0,this.bufferType=n,this.bufferCount=i,this.updateRanges=[]}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const fw=(a,e,n)=>new XB(a,e,n);class mFe extends g1{static get type(){return"UniformArrayElementNode"}constructor(e,n){super(e,n),this.isArrayBufferElementNode=!0}generate(e){const n=super.generate(e),i=this.getNodeType(),s=this.node.getPaddedType();return e.format(n,s,i)}}class gFe extends XB{static get type(){return"UniformArrayNode"}constructor(e,n=null){super(null),this.array=e,this.elementType=n===null?zg(e[0]):n,this.paddedType=this.getPaddedType(),this.updateType=fa.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let n="vec4";return e==="mat2"?n="mat2":/mat/.test(e)===!0?n="mat4":e.charAt(0)==="i"?n="ivec4":e.charAt(0)==="u"&&(n="uvec4"),n}update(){const{array:e,value:n}=this,i=this.elementType;if(i==="float"||i==="int"||i==="uint")for(let s=0;s<e.length;s++){const r=s*4;n[r]=e[s]}else if(i==="color")for(let s=0;s<e.length;s++){const r=s*4,o=e[s];n[r]=o.r,n[r+1]=o.g,n[r+2]=o.b||0}else if(i==="mat2")for(let s=0;s<e.length;s++){const r=s*4,o=e[s];n[r]=o.elements[0],n[r+1]=o.elements[1],n[r+2]=o.elements[2],n[r+3]=o.elements[3]}else if(i==="mat3")for(let s=0;s<e.length;s++){const r=s*16,o=e[s];n[r]=o.elements[0],n[r+1]=o.elements[1],n[r+2]=o.elements[2],n[r+4]=o.elements[3],n[r+5]=o.elements[4],n[r+6]=o.elements[5],n[r+8]=o.elements[6],n[r+9]=o.elements[7],n[r+10]=o.elements[8],n[r+15]=1}else if(i==="mat4")for(let s=0;s<e.length;s++){const r=s*16,o=e[s];for(let l=0;l<o.elements.length;l++)n[r+l]=o.elements[l]}else for(let s=0;s<e.length;s++){const r=s*4,o=e[s];n[r]=o.x,n[r+1]=o.y,n[r+2]=o.z||0,n[r+3]=o.w||0}}setup(e){const n=this.array.length,i=this.elementType;let s=Float32Array;const r=this.paddedType,o=e.getTypeLength(r);return i.charAt(0)==="i"&&(s=Int32Array),i.charAt(0)==="u"&&(s=Uint32Array),this.value=new s(n*o),this.bufferCount=n,this.bufferType=r,super.setup(e)}element(e){return new mFe(this,rn(e))}}const sl=(a,e)=>new gFe(a,e);class AFe extends yn{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const km=sa(AFe).setParameterLength(1);let l2,c2;class ss extends yn{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this._output=null,this.isViewportNode=!0}getNodeType(){return this.scope===ss.DPR?"float":this.scope===ss.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=fa.NONE;return(this.scope===ss.SIZE||this.scope===ss.VIEWPORT||this.scope===ss.DPR)&&(e=fa.RENDER),this.updateType=e,e}update({renderer:e}){const n=e.getRenderTarget();this.scope===ss.VIEWPORT?n!==null?c2.copy(n.viewport):(e.getViewport(c2),c2.multiplyScalar(e.getPixelRatio())):this.scope===ss.DPR?this._output.value=e.getPixelRatio():n!==null?(l2.width=n.width,l2.height=n.height):e.getDrawingBufferSize(l2)}setup(){const e=this.scope;let n=null;return e===ss.SIZE?n=Rn(l2||(l2=new Nt)):e===ss.VIEWPORT?n=Rn(c2||(c2=new qn)):e===ss.DPR?n=Rn(1):n=Qt(y1.div(t1)),this._output=n,n}generate(e){if(this.scope===ss.COORDINATE){let n=e.getFragCoord();if(e.isFlipY()){const i=e.getNodeProperties(t1).outputNode.build(e);n=`${e.getType("vec2")}( ${n}.x, ${i}.y - ${n}.y )`}return n}return super.generate(e)}}ss.COORDINATE="coordinate";ss.VIEWPORT="viewport";ss.SIZE="size";ss.UV="uv";ss.DPR="dpr";const fie=sn(ss,ss.DPR),rm=sn(ss,ss.UV),t1=sn(ss,ss.SIZE),y1=sn(ss,ss.COORDINATE),QB=sn(ss,ss.VIEWPORT),JB=QB.zw,pie=y1.sub(QB.xy),yFe=pie.div(JB),vFe=Ye(()=>(yt('TSL: "viewportResolution" is deprecated. Use "screenSize" instead.'),t1),"vec2").once()(),I0=Rn(0,"uint").setName("u_cameraIndex").setGroup(D4("cameraIndex")).toVarying("v_cameraIndex"),Lg=Rn("float").setName("cameraNear").setGroup(Nn).onRenderUpdate(({camera:a})=>a.near),Dg=Rn("float").setName("cameraFar").setGroup(Nn).onRenderUpdate(({camera:a})=>a.far),om=Ye(({camera:a})=>{let e;if(a.isArrayCamera&&a.cameras.length>0){const n=[];for(const s of a.cameras)n.push(s.projectionMatrix);e=sl(n).setGroup(Nn).setName("cameraProjectionMatrices").element(a.isMultiViewCamera?km("gl_ViewID_OVR"):I0).toConst("cameraProjectionMatrix")}else e=Rn("mat4").setName("cameraProjectionMatrix").setGroup(Nn).onRenderUpdate(({camera:n})=>n.projectionMatrix);return e}).once()(),_Fe=Ye(({camera:a})=>{let e;if(a.isArrayCamera&&a.cameras.length>0){const n=[];for(const s of a.cameras)n.push(s.projectionMatrixInverse);e=sl(n).setGroup(Nn).setName("cameraProjectionMatricesInverse").element(a.isMultiViewCamera?km("gl_ViewID_OVR"):I0).toConst("cameraProjectionMatrixInverse")}else e=Rn("mat4").setName("cameraProjectionMatrixInverse").setGroup(Nn).onRenderUpdate(({camera:n})=>n.projectionMatrixInverse);return e}).once()(),ad=Ye(({camera:a})=>{let e;if(a.isArrayCamera&&a.cameras.length>0){const n=[];for(const s of a.cameras)n.push(s.matrixWorldInverse);e=sl(n).setGroup(Nn).setName("cameraViewMatrices").element(a.isMultiViewCamera?km("gl_ViewID_OVR"):I0).toConst("cameraViewMatrix")}else e=Rn("mat4").setName("cameraViewMatrix").setGroup(Nn).onRenderUpdate(({camera:n})=>n.matrixWorldInverse);return e}).once()(),xFe=Ye(({camera:a})=>{let e;if(a.isArrayCamera&&a.cameras.length>0){const n=[];for(const s of a.cameras)n.push(s.matrixWorld);e=sl(n).setGroup(Nn).setName("cameraWorldMatrices").element(a.isMultiViewCamera?km("gl_ViewID_OVR"):I0).toConst("cameraWorldMatrix")}else e=Rn("mat4").setName("cameraWorldMatrix").setGroup(Nn).onRenderUpdate(({camera:n})=>n.matrixWorld);return e}).once()(),bFe=Ye(({camera:a})=>{let e;if(a.isArrayCamera&&a.cameras.length>0){const n=[];for(const s of a.cameras)n.push(s.normalMatrix);e=sl(n).setGroup(Nn).setName("cameraNormalMatrices").element(a.isMultiViewCamera?km("gl_ViewID_OVR"):I0).toConst("cameraNormalMatrix")}else e=Rn("mat3").setName("cameraNormalMatrix").setGroup(Nn).onRenderUpdate(({camera:n})=>n.normalMatrix);return e}).once()(),mie=Ye(({camera:a})=>{let e;if(a.isArrayCamera&&a.cameras.length>0){const n=[];for(let s=0,r=a.cameras.length;s<r;s++)n.push(new ye);e=sl(n).setGroup(Nn).setName("cameraPositions").onRenderUpdate(({camera:s},r)=>{const o=s.cameras,l=r.array;for(let c=0,u=o.length;c<u;c++)l[c].setFromMatrixPosition(o[c].matrixWorld)}).element(a.isMultiViewCamera?km("gl_ViewID_OVR"):I0).toConst("cameraPosition")}else e=Rn(new ye).setName("cameraPosition").setGroup(Nn).onRenderUpdate(({camera:n},i)=>i.value.setFromMatrixPosition(n.matrixWorld));return e}).once()(),SFe=Ye(({camera:a})=>{let e;if(a.isArrayCamera&&a.cameras.length>0){const n=[];for(const s of a.cameras)n.push(s.viewport);e=sl(n,"vec4").setGroup(Nn).setName("cameraViewports").element(I0).toConst("cameraViewport")}else e=On(0,0,t1.x,t1.y).toConst("cameraViewport");return e}).once()(),X$=new Cr;class qa extends yn{static get type(){return"Object3DNode"}constructor(e,n=null){super(),this.scope=e,this.object3d=n,this.updateType=fa.OBJECT,this.uniformNode=new dw(null)}getNodeType(){const e=this.scope;if(e===qa.WORLD_MATRIX)return"mat4";if(e===qa.POSITION||e===qa.VIEW_POSITION||e===qa.DIRECTION||e===qa.SCALE)return"vec3";if(e===qa.RADIUS)return"float"}update(e){const n=this.object3d,i=this.uniformNode,s=this.scope;if(s===qa.WORLD_MATRIX)i.value=n.matrixWorld;else if(s===qa.POSITION)i.value=i.value||new ye,i.value.setFromMatrixPosition(n.matrixWorld);else if(s===qa.SCALE)i.value=i.value||new ye,i.value.setFromMatrixScale(n.matrixWorld);else if(s===qa.DIRECTION)i.value=i.value||new ye,n.getWorldDirection(i.value);else if(s===qa.VIEW_POSITION){const r=e.camera;i.value=i.value||new ye,i.value.setFromMatrixPosition(n.matrixWorld),i.value.applyMatrix4(r.matrixWorldInverse)}else if(s===qa.RADIUS){const r=e.object.geometry;r.boundingSphere===null&&r.computeBoundingSphere(),X$.copy(r.boundingSphere).applyMatrix4(n.matrixWorld),i.value=X$.radius}}generate(e){const n=this.scope;return n===qa.WORLD_MATRIX?this.uniformNode.nodeType="mat4":n===qa.POSITION||n===qa.VIEW_POSITION||n===qa.DIRECTION||n===qa.SCALE?this.uniformNode.nodeType="vec3":n===qa.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}qa.WORLD_MATRIX="worldMatrix";qa.POSITION="position";qa.SCALE="scale";qa.VIEW_POSITION="viewPosition";qa.DIRECTION="direction";qa.RADIUS="radius";const TFe=sa(qa,qa.DIRECTION).setParameterLength(1),wFe=sa(qa,qa.WORLD_MATRIX).setParameterLength(1),gie=sa(qa,qa.POSITION).setParameterLength(1),EFe=sa(qa,qa.SCALE).setParameterLength(1),MFe=sa(qa,qa.VIEW_POSITION).setParameterLength(1),CFe=sa(qa,qa.RADIUS).setParameterLength(1);class Xu extends qa{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}const NFe=sn(Xu,Xu.DIRECTION),Vu=sn(Xu,Xu.WORLD_MATRIX),RFe=sn(Xu,Xu.POSITION),PFe=sn(Xu,Xu.SCALE),IFe=sn(Xu,Xu.VIEW_POSITION),LFe=sn(Xu,Xu.RADIUS),Aie=Rn(new ga).onObjectUpdate(({object:a},e)=>e.value.getNormalMatrix(a.matrixWorld)),DFe=Rn(new _n).onObjectUpdate(({object:a},e)=>e.value.copy(a.matrixWorld).invert()),L0=Ye(a=>a.context.modelViewMatrix||yie).once()().toVar("modelViewMatrix"),yie=ad.mul(Vu),NO=Ye(a=>(a.context.isHighPrecisionModelViewMatrix=!0,Rn("mat4").onObjectUpdate(({object:e,camera:n})=>e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),RO=Ye(a=>{const e=a.context.isHighPrecisionModelViewMatrix;return Rn("mat3").onObjectUpdate(({object:n,camera:i})=>(e!==!0&&n.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,n.matrixWorld),n.normalMatrix.getNormalMatrix(n.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),pw=Nm("position","vec3"),Es=pw.toVarying("positionLocal"),TR=pw.toVarying("positionPrevious"),lf=Ye(a=>Vu.mul(Es).xyz.toVarying(a.getSubBuildProperty("v_positionWorld")),"vec3").once(["POSITION"])(),ZB=Ye(()=>Es.transformDirection(Vu).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),"vec3").once(["POSITION"])(),tr=Ye(a=>a.context.setupPositionView().toVarying("v_positionView"),"vec3").once(["POSITION"])(),qi=Ye(a=>{let e;return a.camera.isOrthographicCamera?e=qe(0,0,1):e=tr.negate().toVarying("v_positionViewDirection").normalize(),e.toVar("positionViewDirection")},"vec3").once(["POSITION"])();class kFe extends yn{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){if(e.shaderStage!=="fragment")return"true";const{material:n}=e;return n.side===Di?"false":e.getFrontFacing()}}const vie=sn(kFe),e7=Re(vie).mul(2).sub(1),Wx=Ye(([a],{material:e})=>{const n=e.side;return n===Di?a=a.mul(-1):n===er&&(a=a.mul(e7)),a}),z4=Nm("normal","vec3"),wc=Ye(a=>a.geometry.hasAttribute("normal")===!1?(yt('TSL: Vertex attribute "normal" not found on geometry.'),qe(0,1,0)):z4,"vec3").once()().toVar("normalLocal"),_ie=tr.dFdx().cross(tr.dFdy()).normalize().toVar("normalFlat"),mx=Ye(a=>{let e;return a.material.flatShading===!0?e=_ie:e=t7(wc).toVarying("v_normalViewGeometry").normalize(),e},"vec3").once()().toVar("normalViewGeometry"),xie=Ye(a=>{let e=mx.transformDirection(ad);return a.material.flatShading!==!0&&(e=e.toVarying("v_normalWorldGeometry")),e.normalize().toVar("normalWorldGeometry")},"vec3").once()(),oi=Ye(({subBuildFn:a,material:e,context:n})=>{let i;return a==="NORMAL"||a==="VERTEX"?(i=mx,e.flatShading!==!0&&(i=Wx(i))):i=n.setupNormal().context({getUV:null}),i},"vec3").once(["NORMAL","VERTEX"])().toVar("normalView"),D0=oi.transformDirection(ad).toVar("normalWorld"),$A=Ye(({subBuildFn:a,context:e})=>{let n;return a==="NORMAL"||a==="VERTEX"?n=oi:n=e.setupClearcoatNormal().context({getUV:null}),n},"vec3").once(["NORMAL","VERTEX"])().toVar("clearcoatNormalView"),bie=Ye(([a,e=Vu])=>{const n=Oo(e),i=a.div(qe(n[0].dot(n[0]),n[1].dot(n[1]),n[2].dot(n[2])));return n.mul(i).xyz}),t7=Ye(([a],e)=>{const n=e.context.modelNormalViewMatrix;if(n)return n.transformDirection(a);const i=Aie.mul(a);return ad.transformDirection(i)}),OFe=Ye(()=>(yt('TSL: "transformedNormalView" is deprecated. Use "normalView" instead.'),oi)).once(["NORMAL","VERTEX"])(),FFe=Ye(()=>(yt('TSL: "transformedNormalWorld" is deprecated. Use "normalWorld" instead.'),D0)).once(["NORMAL","VERTEX"])(),jFe=Ye(()=>(yt('TSL: "transformedClearcoatNormalView" is deprecated. Use "clearcoatNormalView" instead.'),$A)).once(["NORMAL","VERTEX"])(),Q$=new fo,S5=new _n,Sie=Rn(0).onReference(({material:a})=>a).onObjectUpdate(({material:a})=>a.refractionRatio),o3=Rn(1).onReference(({material:a})=>a).onObjectUpdate(function({material:a,scene:e}){return a.envMap?a.envMapIntensity:e.environmentIntensity}),n7=Rn(new _n).onReference(function(a){return a.material}).onObjectUpdate(function({material:a,scene:e}){const n=e.environment!==null&&a.envMap===null?e.environmentRotation:a.envMapRotation;return n?(Q$.copy(n),S5.makeRotationFromEuler(Q$)):S5.identity(),S5}),Tie=qi.negate().reflect(oi),wie=qi.negate().refract(oi,Sie),Eie=Tie.transformDirection(ad).toVar("reflectVector"),Mie=wie.transformDirection(ad).toVar("reflectVector"),Cie=new M0;class BFe extends qf{static get type(){return"CubeTextureNode"}constructor(e,n=null,i=null,s=null){super(e,n,i,s),this.isCubeTextureNode=!0}getInputType(){return this.value.isDepthTexture===!0?"cubeDepthTexture":"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===xc?Eie:e.mapping===Wu?Mie:(Rt('CubeTextureNode: Mapping "%s" not supported.',e.mapping),qe(0,0,0))}setUpdateMatrix(){}setupUV(e,n){const i=this.value;return i.isDepthTexture===!0?e.renderer.coordinateSystem===bc?qe(n.x,n.y.negate(),n.z):n:((e.renderer.coordinateSystem===bc||!i.isRenderTargetTexture)&&(n=qe(n.x.negate(),n.yz)),n7.mul(n))}generateUV(e,n){return n.build(e,this.sampler===!0?"vec3":"ivec3")}}const a7=sa(BFe).setParameterLength(1,4).setName("cubeTexture"),Dl=(a=Cie,e=null,n=null,i=null)=>{let s;return a&&a.isCubeTextureNode===!0?(s=rn(a.clone()),s.referenceNode=a,e!==null&&(s.uvNode=rn(e)),n!==null&&(s.levelNode=rn(n)),i!==null&&(s.biasNode=rn(i))):s=a7(a,e,n,i),s},UFe=(a=Cie)=>a7(a);class VFe extends g1{static get type(){return"ReferenceElementNode"}constructor(e,n){super(e,n),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const n=super.generate(e),i=this.referenceNode.getNodeType(),s=this.getNodeType();return e.format(n,i,s)}}class G4 extends yn{static get type(){return"ReferenceNode"}constructor(e,n,i=null,s=null){super(),this.property=e,this.uniformType=n,this.object=i,this.count=s,this.properties=e.split("."),this.reference=i,this.node=null,this.group=null,this.name=null,this.updateType=fa.OBJECT}element(e){return new VFe(this,rn(e))}setGroup(e){return this.group=e,this}setName(e){return this.name=e,this}label(e){return yt('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setNodeType(e){let n=null;this.count!==null?n=fw(null,e,this.count):Array.isArray(this.getValueFromReference())?n=sl(null,e):e==="texture"?n=hi(null):e==="cubeTexture"?n=Dl(null):n=Rn(null,e),this.group!==null&&n.setGroup(this.group),this.name!==null&&n.setName(this.name),this.node=n}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:n}=this;let i=e[n[0]];for(let s=1;s<n.length;s++)i=i[n[s]];return i}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const Bi=(a,e,n)=>new G4(a,e,n),PO=(a,e,n,i)=>new G4(a,e,i,n);class zFe extends G4{static get type(){return"MaterialReferenceNode"}constructor(e,n,i=null){super(e,n,i),this.material=i,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const Hp=(a,e,n=null)=>new zFe(a,e,n),Nie=Vi(),GFe=tr.dFdx(),qFe=tr.dFdy(),Rie=Nie.dFdx(),Pie=Nie.dFdy(),Iie=oi,Lie=qFe.cross(Iie),Die=Iie.cross(GFe),IO=Lie.mul(Rie.x).add(Die.mul(Pie.x)),LO=Lie.mul(Rie.y).add(Die.mul(Pie.y)),J$=IO.dot(IO).max(LO.dot(LO)),kie=J$.equal(0).select(0,J$.inverseSqrt()),HFe=IO.mul(kie).toVar("tangentViewFrame"),WFe=LO.mul(kie).toVar("bitangentViewFrame"),q4=Nm("tangent","vec4"),mw=q4.xyz.toVar("tangentLocal"),H4=Ye(({subBuildFn:a,geometry:e,material:n})=>{let i;return a==="VERTEX"||e.hasAttribute("tangent")?i=L0.mul(On(mw,0)).xyz.toVarying("v_tangentView").normalize():i=HFe,n.flatShading!==!0&&(i=Wx(i)),i},"vec3").once(["NORMAL","VERTEX"])().toVar("tangentView"),Oie=H4.transformDirection(ad).toVarying("v_tangentWorld").normalize().toVar("tangentWorld"),W4=Ye(([a,e],{subBuildFn:n,material:i})=>{let s=a.mul(q4.w).xyz;return n==="NORMAL"&&i.flatShading!==!0&&(s=s.toVarying(e)),s}).once(["NORMAL"]),$Fe=W4(z4.cross(q4),"v_bitangentGeometry").normalize().toVar("bitangentGeometry"),KFe=W4(wc.cross(mw),"v_bitangentLocal").normalize().toVar("bitangentLocal"),Fie=Ye(({subBuildFn:a,geometry:e,material:n})=>{let i;return a==="VERTEX"||e.hasAttribute("tangent")?i=W4(oi.cross(H4),"v_bitangentView").normalize():i=WFe,n.flatShading!==!0&&(i=Wx(i)),i},"vec3").once(["NORMAL","VERTEX"])().toVar("bitangentView"),YFe=W4(D0.cross(Oie),"v_bitangentWorld").normalize().toVar("bitangentWorld"),KA=Oo(H4,Fie,oi).toVar("TBNViewMatrix"),jie=qi.mul(KA),XFe=(a,e)=>a.sub(jie.mul(e)),Bie=Ye(()=>{let a=ny.cross(qi);return a=a.cross(ny).normalize(),a=Ha(a,oi,Eg.mul(Uh.oneMinus()).oneMinus().pow2().pow2()).normalize(),a}).once()(),Uie=a=>rn(a).mul(.5).add(.5),QFe=a=>rn(a).mul(2).sub(1),DO=a=>qe(a,cl(B4(Re(1).sub(Yu(a,a)))));class JFe extends Rs{static get type(){return"NormalMapNode"}constructor(e,n=null){super("vec3"),this.node=e,this.scaleNode=n,this.normalMapType=qd,this.unpackNormalMode=YC}setup({material:e}){const{normalMapType:n,scaleNode:i,unpackNormalMode:s}=this;let r=this.node.mul(2).sub(1);if(n===qd?s===tj?r=DO(r.xy):s===oee?r=DO(r.yw):s!==YC&&console.error(`THREE.NodeMaterial: Unexpected unpack normal mode: ${s}`):s!==YC&&console.error(`THREE.NodeMaterial: Normal map type '${n}' is not compatible with unpack normal mode '${s}'`),i!==null){let l=i;e.flatShading===!0&&(l=Wx(l)),r=qe(r.xy.mul(l),r.z)}let o=null;return n===ej?o=t7(r):n===qd?o=KA.mul(r).normalize():(Rt(`NodeMaterial: Unsupported normal map type: ${n}`),o=oi),o}}const kO=sa(JFe).setParameterLength(1,2),ZFe=Ye(({textureNode:a,bumpScale:e})=>{const n=s=>a.isolate().context({getUV:r=>s(r.uvNode||Vi()),forceUVContext:!0}),i=Re(n(s=>s));return Qt(Re(n(s=>s.add(s.dFdx()))).sub(i),Re(n(s=>s.add(s.dFdy()))).sub(i)).mul(e)}),eje=Ye(a=>{const{surf_pos:e,surf_norm:n,dHdxy:i}=a,s=e.dFdx().normalize(),r=e.dFdy().normalize(),o=n,l=r.cross(o),c=o.cross(s),u=s.dot(l).mul(e7),h=u.sign().mul(i.x.mul(l).add(i.y.mul(c)));return u.abs().mul(n).sub(h).normalize()});class tje extends Rs{static get type(){return"BumpMapNode"}constructor(e,n=null){super("vec3"),this.textureNode=e,this.scaleNode=n}setup(){const e=this.scaleNode!==null?this.scaleNode:1,n=ZFe({textureNode:this.textureNode,bumpScale:e});return eje({surf_pos:tr,surf_norm:oi,dHdxy:n})}}const i7=sa(tje).setParameterLength(1,2),Z$=new Map;class Lt extends yn{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,n){let i=Z$.get(e);return i===void 0&&(i=Hp(e,n),Z$.set(e,i)),i}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const n=e.context.material,i=this.scope;let s=null;if(i===Lt.COLOR){const r=n.color!==void 0?this.getColor(i):qe();n.map&&n.map.isTexture===!0?s=r.mul(this.getTexture("map")):s=r}else if(i===Lt.OPACITY){const r=this.getFloat(i);n.alphaMap&&n.alphaMap.isTexture===!0?s=r.mul(this.getTexture("alpha")):s=r}else if(i===Lt.SPECULAR_STRENGTH)n.specularMap&&n.specularMap.isTexture===!0?s=this.getTexture("specular").r:s=Re(1);else if(i===Lt.SPECULAR_INTENSITY){const r=this.getFloat(i);n.specularIntensityMap&&n.specularIntensityMap.isTexture===!0?s=r.mul(this.getTexture(i).a):s=r}else if(i===Lt.SPECULAR_COLOR){const r=this.getColor(i);n.specularColorMap&&n.specularColorMap.isTexture===!0?s=r.mul(this.getTexture(i).rgb):s=r}else if(i===Lt.ROUGHNESS){const r=this.getFloat(i);n.roughnessMap&&n.roughnessMap.isTexture===!0?s=r.mul(this.getTexture(i).g):s=r}else if(i===Lt.METALNESS){const r=this.getFloat(i);n.metalnessMap&&n.metalnessMap.isTexture===!0?s=r.mul(this.getTexture(i).b):s=r}else if(i===Lt.EMISSIVE){const r=this.getFloat("emissiveIntensity"),o=this.getColor(i).mul(r);n.emissiveMap&&n.emissiveMap.isTexture===!0?s=o.mul(this.getTexture(i)):s=o}else if(i===Lt.NORMAL)n.normalMap?(s=kO(this.getTexture("normal"),this.getCache("normalScale","vec2")),s.normalMapType=n.normalMapType,(n.normalMap.format==ol||n.normalMap.format==p0||n.normalMap.format==f0)&&(s.unpackNormalMode=tj)):n.bumpMap?s=i7(this.getTexture("bump").r,this.getFloat("bumpScale")):s=oi;else if(i===Lt.CLEARCOAT){const r=this.getFloat(i);n.clearcoatMap&&n.clearcoatMap.isTexture===!0?s=r.mul(this.getTexture(i).r):s=r}else if(i===Lt.CLEARCOAT_ROUGHNESS){const r=this.getFloat(i);n.clearcoatRoughnessMap&&n.clearcoatRoughnessMap.isTexture===!0?s=r.mul(this.getTexture(i).r):s=r}else if(i===Lt.CLEARCOAT_NORMAL)n.clearcoatNormalMap?s=kO(this.getTexture(i),this.getCache(i+"Scale","vec2")):s=oi;else if(i===Lt.SHEEN){const r=this.getColor("sheenColor").mul(this.getFloat("sheen"));n.sheenColorMap&&n.sheenColorMap.isTexture===!0?s=r.mul(this.getTexture("sheenColor").rgb):s=r}else if(i===Lt.SHEEN_ROUGHNESS){const r=this.getFloat(i);n.sheenRoughnessMap&&n.sheenRoughnessMap.isTexture===!0?s=r.mul(this.getTexture(i).a):s=r,s=s.clamp(1e-4,1)}else if(i===Lt.ANISOTROPY)if(n.anisotropyMap&&n.anisotropyMap.isTexture===!0){const r=this.getTexture(i);s=I4(e_.x,e_.y,e_.y.negate(),e_.x).mul(r.rg.mul(2).sub(Qt(1)).normalize().mul(r.b))}else s=e_;else if(i===Lt.IRIDESCENCE_THICKNESS){const r=Bi("1","float",n.iridescenceThicknessRange);if(n.iridescenceThicknessMap){const o=Bi("0","float",n.iridescenceThicknessRange);s=r.sub(o).mul(this.getTexture(i).g).add(o)}else s=r}else if(i===Lt.TRANSMISSION){const r=this.getFloat(i);n.transmissionMap?s=r.mul(this.getTexture(i).r):s=r}else if(i===Lt.THICKNESS){const r=this.getFloat(i);n.thicknessMap?s=r.mul(this.getTexture(i).g):s=r}else if(i===Lt.IOR)s=this.getFloat(i);else if(i===Lt.LIGHT_MAP)s=this.getTexture(i).rgb.mul(this.getFloat("lightMapIntensity"));else if(i===Lt.AO)s=this.getTexture(i).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(i===Lt.LINE_DASH_OFFSET)s=n.dashOffset?this.getFloat(i):Re(0);else{const r=this.getNodeType(e);s=this.getCache(i,r)}return s}}Lt.ALPHA_TEST="alphaTest";Lt.COLOR="color";Lt.OPACITY="opacity";Lt.SHININESS="shininess";Lt.SPECULAR="specular";Lt.SPECULAR_STRENGTH="specularStrength";Lt.SPECULAR_INTENSITY="specularIntensity";Lt.SPECULAR_COLOR="specularColor";Lt.REFLECTIVITY="reflectivity";Lt.ROUGHNESS="roughness";Lt.METALNESS="metalness";Lt.NORMAL="normal";Lt.CLEARCOAT="clearcoat";Lt.CLEARCOAT_ROUGHNESS="clearcoatRoughness";Lt.CLEARCOAT_NORMAL="clearcoatNormal";Lt.EMISSIVE="emissive";Lt.ROTATION="rotation";Lt.SHEEN="sheen";Lt.SHEEN_ROUGHNESS="sheenRoughness";Lt.ANISOTROPY="anisotropy";Lt.IRIDESCENCE="iridescence";Lt.IRIDESCENCE_IOR="iridescenceIOR";Lt.IRIDESCENCE_THICKNESS="iridescenceThickness";Lt.IOR="ior";Lt.TRANSMISSION="transmission";Lt.THICKNESS="thickness";Lt.ATTENUATION_DISTANCE="attenuationDistance";Lt.ATTENUATION_COLOR="attenuationColor";Lt.LINE_SCALE="scale";Lt.LINE_DASH_SIZE="dashSize";Lt.LINE_GAP_SIZE="gapSize";Lt.LINE_WIDTH="linewidth";Lt.LINE_DASH_OFFSET="dashOffset";Lt.POINT_SIZE="size";Lt.DISPERSION="dispersion";Lt.LIGHT_MAP="light";Lt.AO="ao";const Vie=sn(Lt,Lt.ALPHA_TEST),zie=sn(Lt,Lt.COLOR),Gie=sn(Lt,Lt.SHININESS),qie=sn(Lt,Lt.EMISSIVE),s7=sn(Lt,Lt.OPACITY),Hie=sn(Lt,Lt.SPECULAR),OO=sn(Lt,Lt.SPECULAR_INTENSITY),Wie=sn(Lt,Lt.SPECULAR_COLOR),yS=sn(Lt,Lt.SPECULAR_STRENGTH),l3=sn(Lt,Lt.REFLECTIVITY),$ie=sn(Lt,Lt.ROUGHNESS),Kie=sn(Lt,Lt.METALNESS),Yie=sn(Lt,Lt.NORMAL),Xie=sn(Lt,Lt.CLEARCOAT),Qie=sn(Lt,Lt.CLEARCOAT_ROUGHNESS),Jie=sn(Lt,Lt.CLEARCOAT_NORMAL),Zie=sn(Lt,Lt.ROTATION),ese=sn(Lt,Lt.SHEEN),tse=sn(Lt,Lt.SHEEN_ROUGHNESS),nse=sn(Lt,Lt.ANISOTROPY),ase=sn(Lt,Lt.IRIDESCENCE),ise=sn(Lt,Lt.IRIDESCENCE_IOR),sse=sn(Lt,Lt.IRIDESCENCE_THICKNESS),rse=sn(Lt,Lt.TRANSMISSION),ose=sn(Lt,Lt.THICKNESS),lse=sn(Lt,Lt.IOR),cse=sn(Lt,Lt.ATTENUATION_DISTANCE),use=sn(Lt,Lt.ATTENUATION_COLOR),dse=sn(Lt,Lt.LINE_SCALE),hse=sn(Lt,Lt.LINE_DASH_SIZE),fse=sn(Lt,Lt.LINE_GAP_SIZE),nje=sn(Lt,Lt.LINE_WIDTH),pse=sn(Lt,Lt.LINE_DASH_OFFSET),mse=sn(Lt,Lt.POINT_SIZE),gse=sn(Lt,Lt.DISPERSION),r7=sn(Lt,Lt.LIGHT_MAP),Ase=sn(Lt,Lt.AO),e_=Rn(new Nt).onReference(function(a){return a.material}).onRenderUpdate(function({material:a}){this.value.set(a.anisotropy*Math.cos(a.anisotropyRotation),a.anisotropy*Math.sin(a.anisotropyRotation))}),yse=Ye(a=>a.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class aje extends g1{static get type(){return"StorageArrayElementNode"}constructor(e,n){super(e,n),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}getMemberType(e,n){const i=this.storageBufferNode.structTypeNode;return i?i.getMemberType(e,n):"void"}setup(e){return e.isAvailable("storageBuffer")===!1&&this.node.isPBO===!0&&e.setupPBO(this.node),super.setup(e)}generate(e,n){let i;const s=e.context.assign;if(e.isAvailable("storageBuffer")===!1?this.node.isPBO===!0&&s!==!0&&(this.node.value.isInstancedBufferAttribute||e.shaderStage!=="compute")?i=e.generatePBO(this):i=this.node.build(e):i=super.generate(e),s!==!0){const r=this.getNodeType(e);i=e.format(i,r,n)}return i}}const ije=sa(aje).setParameterLength(2);class sje extends XB{static get type(){return"StorageBufferNode"}constructor(e,n=null,i=0){let s,r=null;n&&n.isStruct?(s="struct",r=n.layout,(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(i=e.count)):n===null&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)?(s=Cne(e.itemSize),i=e.count):s=n,super(e,s,i),this.isStorageBufferNode=!0,this.structTypeNode=r,this.access=Po.READ_WRITE,this.isAtomic=!1,this.isPBO=!1,this._attribute=null,this._varying=null,this.global=!0,e.isStorageBufferAttribute!==!0&&e.isStorageInstancedBufferAttribute!==!0&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}getHash(e){if(this.bufferCount===0){let n=e.globalCache.getData(this.value);return n===void 0&&(n={node:this},e.globalCache.setData(this.value,n)),n.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(e){return ije(this,e)}setPBO(e){return this.isPBO=e,this}getPBO(){return this.isPBO}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess(Po.READ_ONLY)}setAtomic(e){return this.isAtomic=e,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return this._attribute===null&&(this._attribute=WB(this.value),this._varying=Xf(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(e){if(this.structTypeNode!==null)return this.structTypeNode.getNodeType(e);if(e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.getNodeType(e);const{attribute:n}=this.getAttributeData();return n.getNodeType(e)}getMemberType(e,n){return this.structTypeNode!==null?this.structTypeNode.getMemberType(e,n):"void"}generate(e){if(this.structTypeNode!==null&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.generate(e);const{attribute:n,varying:i}=this.getAttributeData(),s=i.build(e);return e.registerTransform(s,n),s}}const lm=(a,e=null,n=0)=>new sje(a,e,n),rje=(a,e,n)=>(yt('TSL: "storageObject()" is deprecated. Use "storage().setPBO( true )" instead.'),lm(a,e,n).setPBO(!0));class ys extends yn{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const n=this.getNodeType(e),i=this.scope;let s;if(i===ys.VERTEX)s=e.getVertexIndex();else if(i===ys.INSTANCE)s=e.getInstanceIndex();else if(i===ys.DRAW)s=e.getDrawIndex();else if(i===ys.INVOCATION_LOCAL)s=e.getInvocationLocalIndex();else if(i===ys.INVOCATION_SUBGROUP)s=e.getInvocationSubgroupIndex();else if(i===ys.SUBGROUP)s=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+i);let r;return e.shaderStage==="vertex"||e.shaderStage==="compute"?r=s:r=Xf(this).build(e,n),r}}ys.VERTEX="vertex";ys.INSTANCE="instance";ys.SUBGROUP="subgroup";ys.INVOCATION_LOCAL="invocationLocal";ys.INVOCATION_SUBGROUP="invocationSubgroup";ys.DRAW="draw";const vse=sn(ys,ys.VERTEX),cf=sn(ys,ys.INSTANCE),oje=sn(ys,ys.SUBGROUP),lje=sn(ys,ys.INVOCATION_SUBGROUP),cje=sn(ys,ys.INVOCATION_LOCAL),_se=sn(ys,ys.DRAW);class xse extends yn{static get type(){return"InstanceNode"}constructor(e,n,i=null){super("void"),this.count=e,this.instanceMatrix=n,this.instanceColor=i,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=fa.FRAME,this.buffer=null,this.bufferColor=null}get isStorageMatrix(){const{instanceMatrix:e}=this;return e&&e.isStorageInstancedBufferAttribute===!0}get isStorageColor(){const{instanceColor:e}=this;return e&&e.isStorageInstancedBufferAttribute===!0}setup(e){const{instanceMatrix:n,instanceColor:i,isStorageMatrix:s,isStorageColor:r}=this,{count:o}=n;let{instanceMatrixNode:l,instanceColorNode:c}=this;if(l===null){if(s)l=lm(n,"mat4",Math.max(o,1)).element(cf);else if(o<=1e3)l=fw(n.array,"mat4",Math.max(o,1)).element(cf);else{const h=new XS(n.array,16,1);this.buffer=h;const f=n.usage===Bg?CO:SR,m=[f(h,"vec4",16,0),f(h,"vec4",16,4),f(h,"vec4",16,8),f(h,"vec4",16,12)];l=n0(...m)}this.instanceMatrixNode=l}if(i&&c===null){if(r)c=lm(i,"vec3",Math.max(i.count,1)).element(cf);else{const h=new _c(i.array,3),f=i.usage===Bg?CO:SR;this.bufferColor=h,c=qe(f(h,"vec3",3,0))}this.instanceColorNode=c}const u=l.mul(Es).xyz;if(Es.assign(u),e.hasGeometryAttribute("normal")){const h=bie(wc,l);wc.assign(h)}this.instanceColorNode!==null&&uT("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.buffer!==null&&this.isStorageMatrix!==!0&&(this.buffer.clearUpdateRanges(),this.buffer.updateRanges.push(...this.instanceMatrix.updateRanges),this.instanceMatrix.usage!==Bg&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version)),this.instanceColor&&this.bufferColor!==null&&this.isStorageColor!==!0&&(this.bufferColor.clearUpdateRanges(),this.bufferColor.updateRanges.push(...this.instanceColor.updateRanges),this.instanceColor.usage!==Bg&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version))}}const uje=sa(xse).setParameterLength(2,3);class dje extends xse{static get type(){return"InstancedMeshNode"}constructor(e){const{count:n,instanceMatrix:i,instanceColor:s}=e;super(n,i,s),this.instancedMesh=e}}const bse=sa(dje).setParameterLength(1);class hje extends yn{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=cf:this.batchingIdNode=_se);const i=Ye(([x])=>{const T=Be(sm(Os(this.batchMesh._indirectTexture),0).x).toConst(),E=Be(x).mod(T).toConst(),M=Be(x).div(T).toConst();return Os(this.batchMesh._indirectTexture,yr(E,M)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(Be(this.batchingIdNode)),s=this.batchMesh._matricesTexture,r=Be(sm(Os(s),0).x).toConst(),o=Re(i).mul(4).toInt().toConst(),l=o.mod(r).toConst(),c=o.div(r).toConst(),u=n0(Os(s,yr(l,c)),Os(s,yr(l.add(1),c)),Os(s,yr(l.add(2),c)),Os(s,yr(l.add(3),c))),h=this.batchMesh._colorsTexture;if(h!==null){const T=Ye(([E])=>{const M=Be(sm(Os(h),0).x).toConst(),N=E,I=N.mod(M).toConst(),F=N.div(M).toConst();return Os(h,yr(I,F)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(i);uT("vec3","vBatchColor").assign(T)}const f=Oo(u);Es.assign(u.mul(Es));const m=wc.div(qe(f[0].dot(f[0]),f[1].dot(f[1]),f[2].dot(f[2]))),A=f.mul(m).xyz;wc.assign(A),e.hasGeometryAttribute("tangent")&&mw.mulAssign(f)}}const Sse=sa(hje).setParameterLength(1),eK=new WeakMap;class Tse extends yn{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=fa.OBJECT,this.skinIndexNode=Nm("skinIndex","uvec4"),this.skinWeightNode=Nm("skinWeight","vec4"),this.bindMatrixNode=Bi("bindMatrix","mat4"),this.bindMatrixInverseNode=Bi("bindMatrixInverse","mat4"),this.boneMatricesNode=PO("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=Es,this.toPositionNode=Es,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,n=this.positionNode){const{skinIndexNode:i,skinWeightNode:s,bindMatrixNode:r,bindMatrixInverseNode:o}=this,l=e.element(i.x),c=e.element(i.y),u=e.element(i.z),h=e.element(i.w),f=r.mul(n),m=cr(l.mul(s.x).mul(f),c.mul(s.y).mul(f),u.mul(s.z).mul(f),h.mul(s.w).mul(f));return o.mul(m).xyz}getSkinnedNormal(e=this.boneMatricesNode,n=wc){const{skinIndexNode:i,skinWeightNode:s,bindMatrixNode:r,bindMatrixInverseNode:o}=this,l=e.element(i.x),c=e.element(i.y),u=e.element(i.z),h=e.element(i.w);let f=cr(s.x.mul(l),s.y.mul(c),s.z.mul(u),s.w.mul(h));return f=o.mul(f).mul(r),f.transformDirection(n).xyz}getPreviousSkinnedPosition(e){const n=e.object;return this.previousBoneMatricesNode===null&&(n.skeleton.previousBoneMatrices=new Float32Array(n.skeleton.boneMatrices),this.previousBoneMatricesNode=PO("skeleton.previousBoneMatrices","mat4",n.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,TR)}needsPreviousBoneMatrices(e){const n=e.renderer.getMRT();return n&&n.has("velocity")||Rne(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&TR.assign(this.getPreviousSkinnedPosition(e));const n=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(n),e.hasGeometryAttribute("normal")){const i=this.getSkinnedNormal();wc.assign(i),e.hasGeometryAttribute("tangent")&&mw.assign(i)}return n}generate(e,n){if(n!=="void")return super.generate(e,n)}update(e){const n=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;eK.get(n)!==e.frameId&&(eK.set(n,e.frameId),this.previousBoneMatricesNode!==null&&(n.previousBoneMatrices===null&&(n.previousBoneMatrices=new Float32Array(n.boneMatrices)),n.previousBoneMatrices.set(n.boneMatrices)),n.update())}}const wse=a=>new Tse(a),fje=(a,e=null)=>{const n=new Tse(a);return n.positionNode=lm(new _c(a.geometry.getAttribute("position").array,3),"vec3").setPBO(!0).toReadOnly().element(cf).toVar(),n.skinIndexNode=lm(new _c(new Uint32Array(a.geometry.getAttribute("skinIndex").array),4),"uvec4").setPBO(!0).toReadOnly().element(cf).toVar(),n.skinWeightNode=lm(new _c(a.geometry.getAttribute("skinWeight").array,4),"vec4").setPBO(!0).toReadOnly().element(cf).toVar(),n.bindMatrixNode=Rn(a.bindMatrix,"mat4"),n.bindMatrixInverseNode=Rn(a.bindMatrixInverse,"mat4"),n.boneMatricesNode=fw(a.skeleton.boneMatrices,"mat4",a.skeleton.bones.length),n.toPositionNode=e,rn(n)};class pje extends yn{static get type(){return"LoopNode"}constructor(e=[]){super("void"),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const n=e.getNodeProperties(this);if(n.stackNode!==void 0)return n;const i={};for(let l=0,c=this.params.length-1;l<c;l++){const u=this.params[l],h=u.isNode!==!0&&u.name||this.getVarName(l),f=u.isNode!==!0&&u.type||"int";i[h]=Cm(h,f)}const s=e.addStack(),r=this.params[this.params.length-1](i);n.returnsNode=r.context({nodeLoop:r}),n.stackNode=s;const o=this.params[0];if(o.isNode!==!0&&typeof o.update=="function"){const l=Ye(this.params[0].update)(i);n.updateNode=l.context({nodeLoop:l})}return e.removeStack(),n}setup(e){if(this.getProperties(e),e.fnCall){const n=e.getDataFromNode(e.fnCall.shaderNode);n.hasLoop=!0}}generate(e){const n=this.getProperties(e),i=this.params,s=n.stackNode;for(let o=0,l=i.length-1;o<l;o++){const c=i[o];let u=!1,h=null,f=null,m=null,A=null,x=null,T=null;c.isNode?c.getNodeType(e)==="bool"?(u=!0,A="bool",f=c.build(e,A)):(A="int",m=this.getVarName(o),h="0",f=c.build(e,A),x="<"):(A=c.type||"int",m=c.name||this.getVarName(o),h=c.start,f=c.end,x=c.condition,T=c.update,typeof h=="number"?h=e.generateConst(A,h):h&&h.isNode&&(h=h.build(e,A)),typeof f=="number"?f=e.generateConst(A,f):f&&f.isNode&&(f=f.build(e,A)),h!==void 0&&f===void 0?(h=h+" - 1",f="0",x=">="):f!==void 0&&h===void 0&&(h="0",x="<"),x===void 0&&(Number(h)>Number(f)?x=">=":x="<"));let E;if(u)E=`while ( ${f} )`;else{const M={start:h,end:f},N=M.start,I=M.end;let F;const G=()=>x.includes("<")?"+=":"-=";if(T!=null)switch(typeof T){case"function":F=e.flowStagesNode(n.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":F=m+" "+G()+" "+e.generateConst(A,T);break;case"string":F=m+" "+T;break;default:T.isNode?F=m+" "+G()+" "+T.build(e):(Rt("TSL: 'Loop( { update: ... } )' is not a function, string or number."),F="break /* invalid update */")}else A==="int"||A==="uint"?T=x.includes("<")?"++":"--":T=G()+" 1.",F=m+" "+T;const O=e.getVar(A,m)+" = "+N,D=m+" "+x+" "+I;E=`for ( ${O}; ${D}; ${F} )`}e.addFlowCode((o===0?`
`:"")+e.tab+E+` {

`).addFlowTab()}const r=s.build(e,"void");n.returnsNode.build(e,"void"),e.removeFlowTab().addFlowCode(`
`+e.tab+r);for(let o=0,l=this.params.length-1;o<l;o++)e.addFlowCode((o===0?"":e.tab)+`}

`).removeFlowTab();e.addFlowTab()}}const Li=(...a)=>new pje(ty(a,"int")).toStack(),mje=()=>Cm("continue").toStack(),Ese=()=>Cm("break").toStack(),T5=new WeakMap,Kc=new qn,tK=Ye(({bufferMap:a,influence:e,stride:n,width:i,depth:s,offset:r})=>{const o=Be(vse).mul(n).add(r),l=o.div(i),c=o.sub(l.mul(i));return Os(a,yr(c,l)).depth(s).xyz.mul(e)});function gje(a){const e=a.morphAttributes.position!==void 0,n=a.morphAttributes.normal!==void 0,i=a.morphAttributes.color!==void 0,s=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,r=s!==void 0?s.length:0;let o=T5.get(a);if(o===void 0||o.count!==r){let M=function(){T.dispose(),T5.delete(a),a.removeEventListener("dispose",M)};o!==void 0&&o.texture.dispose();const l=a.morphAttributes.position||[],c=a.morphAttributes.normal||[],u=a.morphAttributes.color||[];let h=0;e===!0&&(h=1),n===!0&&(h=2),i===!0&&(h=3);let f=a.attributes.position.count*h,m=1;const A=4096;f>A&&(m=Math.ceil(f/A),f=A);const x=new Float32Array(f*m*4*r),T=new YT(x,f,m,r);T.type=ls,T.needsUpdate=!0;const E=h*4;for(let N=0;N<r;N++){const I=l[N],F=c[N],G=u[N],O=f*m*4*N;for(let D=0;D<I.count;D++){const j=D*E;e===!0&&(Kc.fromBufferAttribute(I,D),x[O+j+0]=Kc.x,x[O+j+1]=Kc.y,x[O+j+2]=Kc.z,x[O+j+3]=0),n===!0&&(Kc.fromBufferAttribute(F,D),x[O+j+4]=Kc.x,x[O+j+5]=Kc.y,x[O+j+6]=Kc.z,x[O+j+7]=0),i===!0&&(Kc.fromBufferAttribute(G,D),x[O+j+8]=Kc.x,x[O+j+9]=Kc.y,x[O+j+10]=Kc.z,x[O+j+11]=G.itemSize===4?Kc.w:1)}}o={count:r,texture:T,stride:h,size:new Nt(f,m)},T5.set(a,o),a.addEventListener("dispose",M)}return o}class Aje extends yn{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=Rn(1),this.updateType=fa.OBJECT}setup(e){const{geometry:n}=e,i=n.morphAttributes.position!==void 0,s=n.hasAttribute("normal")&&n.morphAttributes.normal!==void 0,r=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,o=r!==void 0?r.length:0,{texture:l,stride:c,size:u}=gje(n);i===!0&&Es.mulAssign(this.morphBaseInfluence),s===!0&&wc.mulAssign(this.morphBaseInfluence);const h=Be(u.width);Li(o,({i:f})=>{const m=Re(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?m.assign(Os(this.mesh.morphTexture,yr(Be(f).add(1),Be(cf))).r):m.assign(Bi("morphTargetInfluences","float").element(f).toVar()),kn(m.notEqual(0),()=>{i===!0&&Es.addAssign(tK({bufferMap:l,influence:m,stride:c,width:h,depth:f,offset:Be(0)})),s===!0&&wc.addAssign(tK({bufferMap:l,influence:m,stride:c,width:h,depth:f,offset:Be(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((n,i)=>n+i,0)}}const Mse=sa(Aje).setParameterLength(1);class $x extends yn{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class yje extends $x{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class vje extends Bae{static get type(){return"LightingContextNode"}constructor(e,n=null,i=null,s=null){super(e),this.lightingModel=n,this.backdropNode=i,this.backdropAlphaNode=s,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:n}=this,i=qe().toVar("directDiffuse"),s=qe().toVar("directSpecular"),r=qe().toVar("indirectDiffuse"),o=qe().toVar("indirectSpecular"),l={directDiffuse:i,directSpecular:s,indirectDiffuse:r,indirectSpecular:o};return{radiance:qe().toVar("radiance"),irradiance:qe().toVar("irradiance"),iblIrradiance:qe().toVar("iblIrradiance"),ambientOcclusion:Re(1).toVar("ambientOcclusion"),reflectedLight:l,backdrop:e,backdropAlpha:n}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const Cse=sa(vje);class _je extends $x{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}const Dv=new Nt;class $4 extends qf{static get type(){return"ViewportTextureNode"}constructor(e=rm,n=null,i=null){let s=null;i===null?(s=new n4,s.minFilter=No,i=s):s=i,super(i,e,n),this.generateMipmaps=!1,this.defaultFramebuffer=s,this.isOutputTextureNode=!0,this.updateBeforeType=fa.FRAME,this._cacheTextures=new WeakMap}getTextureForReference(e=null){let n,i;if(this.referenceNode?(n=this.referenceNode.defaultFramebuffer,i=this.referenceNode._cacheTextures):(n=this.defaultFramebuffer,i=this._cacheTextures),e===null)return n;if(i.has(e)===!1){const s=n.clone();i.set(e,s)}return i.get(e)}updateReference(e){const n=e.renderer.getRenderTarget();return this.value=this.getTextureForReference(n),this.value}updateBefore(e){const n=e.renderer,i=n.getRenderTarget();i===null?n.getDrawingBufferSize(Dv):Dv.set(i.width,i.height);const s=this.getTextureForReference(i);(s.image.width!==Dv.width||s.image.height!==Dv.height)&&(s.image.width=Dv.width,s.image.height=Dv.height,s.needsUpdate=!0);const r=s.generateMipmaps;s.generateMipmaps=this.generateMipmaps,n.copyFramebufferToTexture(s),s.generateMipmaps=r}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const xje=sa($4).setParameterLength(0,3),o7=sa($4,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let qM=null;class bje extends $4{static get type(){return"ViewportDepthTextureNode"}constructor(e=rm,n=null){qM===null&&(qM=new Do),super(e,n,qM)}getTextureForReference(){return qM}}const l7=sa(bje).setParameterLength(0,2);class pc extends yn{static get type(){return"ViewportDepthNode"}constructor(e,n=null){super("float"),this.scope=e,this.valueNode=n,this.isViewportDepthNode=!0}generate(e){const{scope:n}=this;return n===pc.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:n}=this,i=this.valueNode;let s=null;if(n===pc.DEPTH_BASE)i!==null&&(s=Rse().assign(i));else if(n===pc.DEPTH)e.isPerspectiveCamera?s=Nse(tr.z,Lg,Dg):s=P_(tr.z,Lg,Dg);else if(n===pc.LINEAR_DEPTH)if(i!==null)if(e.isPerspectiveCamera){const r=c7(i,Lg,Dg);s=P_(r,Lg,Dg)}else s=i;else s=P_(tr.z,Lg,Dg);return s}}pc.DEPTH_BASE="depthBase";pc.DEPTH="depth";pc.LINEAR_DEPTH="linearDepth";const P_=(a,e,n)=>a.add(e).div(e.sub(n)),Sje=(a,e,n)=>e.sub(n).mul(a).sub(e),Nse=(a,e,n)=>e.add(a).mul(n).div(n.sub(e).mul(a)),c7=(a,e,n)=>e.mul(n).div(n.sub(e).mul(a).sub(n)),u7=(a,e,n)=>{e=e.max(1e-6).toVar();const i=sf(a.negate().div(e)),s=sf(n.div(e));return i.div(s)},Tje=(a,e,n)=>{const i=a.mul(k4(n.div(e)));return Re(Math.E).pow(i).mul(e).negate()},Rse=sa(pc,pc.DEPTH_BASE),d7=sn(pc,pc.DEPTH),wR=sa(pc,pc.LINEAR_DEPTH).setParameterLength(0,1),wje=wR(l7());d7.assign=a=>Rse(a);class Gu extends yn{static get type(){return"ClippingNode"}constructor(e=Gu.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const n=e.clippingContext,{intersectionPlanes:i,unionPlanes:s}=n;return this.hardwareClipping=e.material.hardwareClipping,this.scope===Gu.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(i,s):this.scope===Gu.HARDWARE?this.setupHardwareClipping(s,e):this.setupDefault(i,s)}setupAlphaToCoverage(e,n){return Ye(()=>{const i=Re().toVar("distanceToPlane"),s=Re().toVar("distanceToGradient"),r=Re(1).toVar("clipOpacity"),o=n.length;if(this.hardwareClipping===!1&&o>0){const c=sl(n).setGroup(Nn);Li(o,({i:u})=>{const h=c.element(u);i.assign(tr.dot(h.xyz).negate().add(h.w)),s.assign(i.fwidth().div(2)),r.mulAssign(Qd(s.negate(),s,i))})}const l=e.length;if(l>0){const c=sl(e).setGroup(Nn),u=Re(1).toVar("intersectionClipOpacity");Li(l,({i:h})=>{const f=c.element(h);i.assign(tr.dot(f.xyz).negate().add(f.w)),s.assign(i.fwidth().div(2)),u.mulAssign(Qd(s.negate(),s,i).oneMinus())}),r.mulAssign(u.oneMinus())}Pi.a.mulAssign(r),Pi.a.equal(0).discard()})()}setupDefault(e,n){return Ye(()=>{const i=n.length;if(this.hardwareClipping===!1&&i>0){const r=sl(n).setGroup(Nn);Li(i,({i:o})=>{const l=r.element(o);tr.dot(l.xyz).greaterThan(l.w).discard()})}const s=e.length;if(s>0){const r=sl(e).setGroup(Nn),o=Ku(!0).toVar("clipped");Li(s,({i:l})=>{const c=r.element(l);o.assign(tr.dot(c.xyz).greaterThan(c.w).and(o))}),o.discard()}})()}setupHardwareClipping(e,n){const i=e.length;return n.enableHardwareClipping(i),Ye(()=>{const s=sl(e).setGroup(Nn),r=km(n.getClipDistance());Li(i,({i:o})=>{const l=s.element(o),c=tr.dot(l.xyz).sub(l.w).negate();r.element(o).assign(c)})})()}}Gu.ALPHA_TO_COVERAGE="alphaToCoverage";Gu.DEFAULT="default";Gu.HARDWARE="hardware";const Eje=()=>new Gu,Mje=()=>new Gu(Gu.ALPHA_TO_COVERAGE),Cje=()=>new Gu(Gu.HARDWARE),Nje=.05,nK=Ye(([a])=>Yd(ia(1e4,Rl(ia(17,a.x).add(ia(.1,a.y)))).mul(cr(.1,Ji(Rl(ia(13,a.y).add(a.x))))))),aK=Ye(([a])=>nK(Qt(nK(a.xy),a.z))),Rje=Ye(([a])=>{const e=Ns(of(LB(a.xyz)),of(DB(a.xyz))),n=Re(1).div(Re(Nje).mul(e)).toVar("pixScale"),i=Qt(px(rf(sf(n))),px(O4(sf(n)))),s=Qt(aK(rf(i.x.mul(a.xyz))),aK(rf(i.y.mul(a.xyz)))),r=Yd(sf(n)),o=cr(ia(r.oneMinus(),s.x),ia(r,s.y)),l=Tc(r,r.oneMinus()),c=qe(o.mul(o).div(ia(2,l).mul(Ka(1,l))),o.sub(ia(.5,l)).div(Ka(1,l)),Ka(1,Ka(1,o).mul(Ka(1,o)).div(ia(2,l).mul(Ka(1,l))))),u=o.lessThan(l.oneMinus()).select(o.lessThan(l).select(c.x,c.y),c.z);return Xd(u,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class Pje extends hie{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const n=this.getAttributeName(e),i=e.hasGeometryAttribute(n);let s;return i===!0?s=super.generate(e):s=e.generateConst(this.nodeType,new qn(1,1,1,1)),s}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const Pse=(a=0)=>new Pje(a),Ise=Ye(([a,e])=>Tc(1,a.oneMinus().div(e)).oneMinus()).setLayout({name:"blendBurn",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),Lse=Ye(([a,e])=>Tc(a.div(e.oneMinus()),1)).setLayout({name:"blendDodge",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),Dse=Ye(([a,e])=>a.oneMinus().mul(e.oneMinus()).oneMinus()).setLayout({name:"blendScreen",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),kse=Ye(([a,e])=>Ha(a.mul(2).mul(e),a.oneMinus().mul(2).mul(e.oneMinus()).oneMinus(),j4(.5,a))).setLayout({name:"blendOverlay",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),Ije=Ye(([a,e])=>{const n=e.a.add(a.a.mul(e.a.oneMinus()));return On(e.rgb.mul(e.a).add(a.rgb.mul(a.a).mul(e.a.oneMinus())).div(n),n)}).setLayout({name:"blendColor",type:"vec4",inputs:[{name:"base",type:"vec4"},{name:"blend",type:"vec4"}]}),Ose=Ye(([a])=>On(a.rgb.mul(a.a),a.a),{color:"vec4",return:"vec4"}),Lje=Ye(([a])=>(kn(a.a.equal(0),()=>On(0)),On(a.rgb.div(a.a),a.a)),{color:"vec4",return:"vec4"}),Dje=(...a)=>(yt('TSL: "burn" has been renamed. Use "blendBurn" instead.'),Ise(a)),kje=(...a)=>(yt('TSL: "dodge" has been renamed. Use "blendDodge" instead.'),Lse(a)),Oje=(...a)=>(yt('TSL: "screen" has been renamed. Use "blendScreen" instead.'),Dse(a)),Fje=(...a)=>(yt('TSL: "overlay" has been renamed. Use "blendOverlay" instead.'),kse(a));class zs extends po{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,this.contextNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{yt('NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}_getNodeChildren(){const e=[];for(const n of Object.getOwnPropertyNames(this)){if(n.startsWith("_")===!0)continue;const i=this[n];i&&i.isNode===!0&&e.push({property:n,childNode:i})}return e}customProgramCacheKey(){const e=[];for(const{property:n,childNode:i}of this._getNodeChildren())e.push(uw(n.slice(0,-4)),i.getCacheKey());return this.type+Hx(e)}build(e){this.setup(e)}setupObserver(e){return new a8e(e)}setup(e){e.context.setupNormal=()=>N_(this.setupNormal(e),"NORMAL","vec3"),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const n=e.renderer,i=n.getRenderTarget();n.contextNode.isContextNode===!0?e.context={...e.context,...n.contextNode.getFlowContextData()}:Rt('NodeMaterial: "renderer.contextNode" must be an instance of `context()`.'),this.contextNode!==null&&(this.contextNode.isContextNode===!0?e.context={...e.context,...this.contextNode.getFlowContextData()}:Rt('NodeMaterial: "material.contextNode" must be an instance of `context()`.')),e.addStack();const s=N_(this.setupVertex(e),"VERTEX"),r=this.vertexNode||s;e.stack.outputNode=r,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let o;const l=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(i!==null?i.depthBuffer===!0&&this.setupDepth(e):n.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const c=this.setupLighting(e);l!==null&&e.stack.addToStack(l);const u=On(c,Pi.a).max(0);o=this.setupOutput(e,u),C_.assign(o);const h=this.outputNode!==null;if(h&&(o=this.outputNode),e.context.getOutput&&(o=e.context.getOutput(o,e)),i!==null){const f=n.getMRT(),m=this.mrtNode;f!==null?(h&&C_.assign(o),o=f,m!==null&&(o=f.merge(m))):m!==null&&(o=m)}}else{let c=this.fragmentNode;c.isOutputStructNode!==!0&&(c=On(c)),o=this.setupOutput(e,c)}e.stack.outputNode=o,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:n,intersectionPlanes:i}=e.clippingContext;let s=null;if(n.length>0||i.length>0){const r=e.renderer.currentSamples;this.alphaToCoverage&&r>1?s=Mje():e.stack.addToStack(Eje())}return s}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const n=e.clippingContext.unionPlanes.length;n>0&&n<=8&&e.isAvailable("clipDistance")&&(e.stack.addToStack(Cje()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:n,camera:i}=e;let s=this.depthNode;if(s===null){const r=n.getMRT();r&&r.has("depth")?s=r.get("depth"):n.logarithmicDepthBuffer===!0&&(i.isPerspectiveCamera?s=u7(tr.z,Lg,Dg):s=P_(tr.z,Lg,Dg))}s!==null&&d7.assign(s).toStack()}setupPositionView(){return L0.mul(Es).xyz}setupModelViewProjection(){return om.mul(tr)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),yse}setupPosition(e){const{object:n,geometry:i}=e;if((i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color)&&Mse(n).toStack(),n.isSkinnedMesh===!0&&wse(n).toStack(),this.displacementMap){const s=Hp("displacementMap","texture"),r=Hp("displacementScale","float"),o=Hp("displacementBias","float");Es.addAssign(wc.normalize().mul(s.x.mul(r).add(o)))}return n.isBatchedMesh&&Sse(n).toStack(),n.isInstancedMesh&&n.instanceMatrix&&n.instanceMatrix.isInstancedBufferAttribute===!0&&bse(n).toStack(),this.positionNode!==null&&Es.assign(N_(this.positionNode,"POSITION","vec3")),Es}setupDiffuseColor(e){const{object:n,geometry:i}=e;this.maskNode!==null&&Ku(this.maskNode).not().discard();let s=this.colorNode?On(this.colorNode):zie;this.vertexColors===!0&&i.hasAttribute("color")&&(s=s.mul(Pse())),n.instanceColor&&(s=uT("vec3","vInstanceColor").mul(s)),n.isBatchedMesh&&n._colorsTexture&&(s=uT("vec3","vBatchColor").mul(s)),Pi.assign(s);const r=this.opacityNode?Re(this.opacityNode):s7;Pi.a.assign(Pi.a.mul(r));let o=null;(this.alphaTestNode!==null||this.alphaTest>0)&&(o=this.alphaTestNode!==null?Re(this.alphaTestNode):Vie,this.alphaToCoverage===!0?(Pi.a=Qd(o,o.add(OB(Pi.a)),Pi.a),Pi.a.lessThanEqual(0).discard()):Pi.a.lessThanEqual(o).discard()),this.alphaHash===!0&&Pi.a.lessThan(Rje(Es)).discard(),e.isOpaque()&&Pi.a.assign(1)}setupVariants(){}setupOutgoingLight(){return this.lights===!0?qe(0):Pi.rgb}setupNormal(){return this.normalNode?qe(this.normalNode):Yie}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?Hp("envMap","cubeTexture"):Hp("envMap","texture")),e}setupLightMap(e){let n=null;return e.material.lightMap&&(n=new _je(r7)),n}setupLights(e){const n=[],i=this.setupEnvironment(e);i&&i.isLightingNode&&n.push(i);const s=this.setupLightMap(e);s&&s.isLightingNode&&n.push(s);let r=this.aoNode;r===null&&e.material.aoMap&&(r=Ase),e.context.getAO&&(r=e.context.getAO(r,e)),r&&n.push(new yje(r));let o=this.lightsNode||e.lightsNode;return n.length>0&&(o=e.renderer.lighting.createNode([...o.getLights(),...n])),o}setupLightingModel(){}setupLighting(e){const{material:n}=e,{backdropNode:i,backdropAlphaNode:s,emissiveNode:r}=this,l=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let c=this.setupOutgoingLight(e);if(l&&l.getScope().hasLights){const u=this.setupLightingModel(e)||null;c=Cse(l,u,i,s)}else i!==null&&(c=qe(s!==null?Ha(c,i,s):i));return(r&&r.isNode===!0||n.emissive&&n.emissive.isColor===!0)&&(EO.assign(qe(r||qie)),c=c.add(EO)),c}setupFog(e,n){const i=e.fogNode;return i&&(C_.assign(n),n=On(i.toVar())),n}setupPremultipliedAlpha(e,n){return Ose(n)}setupOutput(e,n){return this.fog===!0&&(n=this.setupFog(e,n)),this.premultipliedAlpha===!0&&(n=this.setupPremultipliedAlpha(e,n)),n}setDefaultValues(e){for(const i in e){const s=e[i];this[i]===void 0&&(this[i]=s,s&&s.clone&&(this[i]=s.clone()))}const n=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const i in n)Object.getOwnPropertyDescriptor(this.constructor.prototype,i)===void 0&&n[i].get!==void 0&&Object.defineProperty(this.constructor.prototype,i,n[i])}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{},nodes:{}});const i=po.prototype.toJSON.call(this,e);i.inputNodes={};for(const{property:r,childNode:o}of this._getNodeChildren())i.inputNodes[r]=o.toJSON(e).uuid;function s(r){const o=[];for(const l in r){const c=r[l];delete c.metadata,o.push(c)}return o}if(n){const r=s(e.textures),o=s(e.images),l=s(e.nodes);r.length>0&&(i.textures=r),o.length>0&&(i.images=o),l.length>0&&(i.nodes=l)}return i}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.aoNode=e.aoNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,this.contextNode=e.contextNode,super.copy(e)}}const jje=new Hr;class Bje extends zs{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(jje),this.setValues(e)}}const Uje=new Mj;class Vje extends zs{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(Uje),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?Re(this.offsetNode):pse,n=this.dashScaleNode?Re(this.dashScaleNode):dse,i=this.dashSizeNode?Re(this.dashSizeNode):hse,s=this.gapSizeNode?Re(this.gapSizeNode):fse;i3.assign(i),MO.assign(s);const r=Xf(Nm("lineDistance").mul(n));(e?r.add(e):r).mod(i3.add(MO)).greaterThan(i3).discard()}}let HM=null;class zje extends $4{static get type(){return"ViewportSharedTextureNode"}constructor(e=rm,n=null){HM===null&&(HM=new n4),super(e,n,HM)}getTextureForReference(){return HM}updateReference(){return this}}const Gje=sa(zje).setParameterLength(0,2),qje=new Sj;class Hje extends zs{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(qje),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?Re(this.opacityNode):s7;Pi.assign(U4(On(Uie(oi),e),Fr))}}const h7=Ye(([a=ZB])=>{const e=a.z.atan(a.x).mul(1/(Math.PI*2)).add(.5),n=a.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return Qt(e,n)});class Fse extends QP{constructor(e=1,n={}){super(e,n),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,n){const i=n.minFilter,s=n.generateMipmaps;n.generateMipmaps=!0,this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r=new Yf(5,5,5),o=h7(ZB),l=new zs;l.colorNode=hi(n,o,0),l.side=Di,l.blending=hl;const c=new Na(r,l),u=new Vx;u.add(c),n.minFilter===No&&(n.minFilter=di);const h=new rj(1,10,this),f=e.getMRT();return e.setMRT(null),h.update(e,u),e.setMRT(f),n.minFilter=i,n.currentGenerateMipmaps=s,c.geometry.dispose(),c.material.dispose(),this}}const vS=new WeakMap;class Wje extends Rs{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=Dl(null);const n=new M0;n.isRenderTargetTexture=!0,this._defaultTexture=n,this.updateBeforeType=fa.RENDER}updateBefore(e){const{renderer:n,material:i}=e,s=this.envNode;if(s.isTextureNode||s.isMaterialReferenceNode){const r=s.isTextureNode?s.value:i[s.property];if(r&&r.isTexture){const o=r.mapping;if(o===d0||o===h0){if(vS.has(r)){const l=vS.get(r);iK(l,r.mapping),this._cubeTexture=l}else{const l=r.image;if($je(l)){const c=new Fse(l.height);c.fromEquirectangularTexture(n,r),iK(c.texture,r.mapping),this._cubeTexture=c.texture,vS.set(r,c.texture),r.addEventListener("dispose",jse)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function $je(a){return a==null?!1:a.height>0}function jse(a){const e=a.target;e.removeEventListener("dispose",jse);const n=vS.get(e);n!==void 0&&(vS.delete(e),n.dispose())}function iK(a,e){e===d0?a.mapping=xc:e===h0&&(a.mapping=Wu)}const Bse=sa(Wje).setParameterLength(1);class f7 extends $x{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=Bse(this.envNode)}}class Kje extends $x{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const n=Re(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(n)}}class K4{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class Use extends K4{constructor(){super()}indirect({context:e}){const n=e.ambientOcclusion,i=e.reflectedLight,s=e.irradianceLightMap;i.indirectDiffuse.assign(On(0)),s?i.indirectDiffuse.addAssign(s):i.indirectDiffuse.addAssign(On(1,1,1,0)),i.indirectDiffuse.mulAssign(n),i.indirectDiffuse.mulAssign(Pi.rgb)}finish(e){const{material:n,context:i}=e,s=i.outgoingLight,r=e.context.environment;if(r)switch(n.combine){case Ox:s.rgb.assign(Ha(s.rgb,s.rgb.mul(r.rgb),yS.mul(l3)));break;case XF:s.rgb.assign(Ha(s.rgb,r.rgb,yS.mul(l3)));break;case QF:s.rgb.addAssign(r.rgb.mul(yS.mul(l3)));break;default:yt("BasicLightingModel: Unsupported .combine value:",n.combine);break}}}const Yje=new oo;class Xje extends zs{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Yje),this.setValues(e)}setupNormal(){return Wx(mx)}setupEnvironment(e){const n=super.setupEnvironment(e);return n?new f7(n):null}setupLightMap(e){let n=null;return e.material.lightMap&&(n=new Kje(r7)),n}setupOutgoingLight(){return Pi.rgb}setupLightingModel(){return new Use}}const gx=Ye(({f0:a,f90:e,dotVH:n})=>{const i=n.mul(-5.55473).sub(6.98316).mul(n).exp2();return a.mul(i.oneMinus()).add(e.mul(i))}),n1=Ye(a=>a.diffuseColor.mul(1/Math.PI)),Qje=()=>Re(.25),Jje=Ye(({dotNH:a})=>_R.mul(Re(.5)).add(1).mul(Re(1/Math.PI)).mul(a.pow(_R))),Zje=Ye(({lightDirection:a})=>{const e=a.add(qi).normalize(),n=oi.dot(e).clamp(),i=qi.dot(e).clamp(),s=gx({f0:v0,f90:1,dotVH:i}),r=Qje(),o=Jje({dotNH:n});return s.mul(r).mul(o)});class Vse extends Use{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:n,reflectedLight:i}){const r=oi.dot(e).clamp().mul(n);i.directDiffuse.addAssign(r.mul(n1({diffuseColor:Pi.rgb}))),this.specular===!0&&i.directSpecular.addAssign(r.mul(Zje({lightDirection:e})).mul(yS))}indirect(e){const{ambientOcclusion:n,irradiance:i,reflectedLight:s}=e.context;s.indirectDiffuse.addAssign(i.mul(n1({diffuseColor:Pi}))),s.indirectDiffuse.mulAssign(n)}}const eBe=new nh;class tBe extends zs{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(eBe),this.setValues(e)}setupEnvironment(e){const n=super.setupEnvironment(e);return n?new f7(n):null}setupLightingModel(){return new Vse(!1)}}const nBe=new m4;class aBe extends zs{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(nBe),this.setValues(e)}setupEnvironment(e){const n=super.setupEnvironment(e);return n?new f7(n):null}setupLightingModel(){return new Vse}setupVariants(){const e=(this.shininessNode?Re(this.shininessNode):Gie).max(1e-4);_R.assign(e);const n=this.specularNode||Hie;v0.assign(n)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const zse=Ye(a=>{if(a.geometry.hasAttribute("normal")===!1)return Re(0);const e=mx.dFdx().abs().max(mx.dFdy().abs());return e.x.max(e.y).max(e.z)}),p7=Ye(a=>{const{roughness:e}=a,n=zse();let i=e.max(.0525);return i=i.add(n),i=i.min(1),i}),Gse=Ye(({alpha:a,dotNL:e,dotNV:n})=>{const i=a.pow2(),s=e.mul(i.add(i.oneMinus().mul(n.pow2())).sqrt()),r=n.mul(i.add(i.oneMinus().mul(e.pow2())).sqrt());return yu(.5,s.add(r).max(MB))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),iBe=Ye(({alphaT:a,alphaB:e,dotTV:n,dotBV:i,dotTL:s,dotBL:r,dotNV:o,dotNL:l})=>{const c=l.mul(qe(a.mul(n),e.mul(i),o).length()),u=o.mul(qe(a.mul(s),e.mul(r),l).length());return yu(.5,c.add(u))}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),qse=Ye(({alpha:a,dotNH:e})=>{const n=a.pow2(),i=e.pow2().mul(n.oneMinus()).oneMinus();return n.div(i.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),sBe=Re(1/Math.PI),rBe=Ye(({alphaT:a,alphaB:e,dotNH:n,dotTH:i,dotBH:s})=>{const r=a.mul(e),o=qe(e.mul(i),a.mul(s),r.mul(n)),l=o.dot(o),c=r.div(l);return sBe.mul(r.mul(c.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),m7=Ye(({lightDirection:a,f0:e,f90:n,roughness:i,f:s,normalView:r=oi,USE_IRIDESCENCE:o,USE_ANISOTROPY:l})=>{const c=i.pow2(),u=a.add(qi).normalize(),h=r.dot(a).clamp(),f=r.dot(qi).clamp(),m=r.dot(u).clamp(),A=qi.dot(u).clamp();let x=gx({f0:e,f90:n,dotVH:A}),T,E;if(lT(o)&&(x=L4.mix(x,s)),lT(l)){const M=gS.dot(a),N=gS.dot(qi),I=gS.dot(u),F=ny.dot(a),G=ny.dot(qi),O=ny.dot(u);T=iBe({alphaT:vR,alphaB:c,dotTV:N,dotBV:G,dotTL:M,dotBL:F,dotNV:f,dotNL:h}),E=rBe({alphaT:vR,alphaB:c,dotNH:m,dotTH:I,dotBH:O})}else T=Gse({alpha:c,dotNL:h,dotNV:f}),E=qse({alpha:c,dotNH:m});return x.mul(T).mul(E)}),oBe=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let Mh=null;const hT=Ye(({roughness:a,dotNV:e})=>{Mh===null&&(Mh=new cu(oBe,16,16,ol,cs),Mh.name="DFG_LUT",Mh.minFilter=di,Mh.magFilter=di,Mh.wrapS=Ur,Mh.wrapT=Ur,Mh.generateMipmaps=!1,Mh.needsUpdate=!0);const n=Qt(a,e);return hi(Mh,n).rg}),lBe=Ye(({lightDirection:a,f0:e,f90:n,roughness:i,f:s,USE_IRIDESCENCE:r,USE_ANISOTROPY:o})=>{const l=m7({lightDirection:a,f0:e,f90:n,roughness:i,f:s,USE_IRIDESCENCE:r,USE_ANISOTROPY:o}),c=oi.dot(a).clamp(),u=oi.dot(qi).clamp(),h=hT({roughness:i,dotNV:u}),f=hT({roughness:i,dotNV:c}),m=e.mul(h.x).add(n.mul(h.y)),A=e.mul(f.x).add(n.mul(f.y)),x=h.x.add(h.y),T=f.x.add(f.y),E=Re(1).sub(x),M=Re(1).sub(T),N=e.add(e.oneMinus().mul(.047619)),I=m.mul(A).mul(N).div(Re(1).sub(E.mul(M).mul(N).mul(N)).add(MB)),F=E.mul(M),G=I.mul(F);return l.add(G)}),Hse=Ye(a=>{const{dotNV:e,specularColor:n,specularF90:i,roughness:s}=a,r=hT({dotNV:e,roughness:s});return n.mul(r.x).add(i.mul(r.y))}),FO=Ye(({f:a,f90:e,dotVH:n})=>{const i=n.oneMinus().saturate(),s=i.mul(i),r=i.mul(s,s).clamp(0,.9999);return a.sub(qe(e).mul(r)).div(r.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),cBe=Ye(({roughness:a,dotNH:e})=>{const n=a.pow2(),i=Re(1).div(n),r=e.pow2().oneMinus().max(.0078125);return Re(2).add(i).mul(r.pow(i.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),uBe=Ye(({dotNV:a,dotNL:e})=>Re(1).div(Re(4).mul(e.add(a).sub(e.mul(a))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),dBe=Ye(({lightDirection:a})=>{const e=a.add(qi).normalize(),n=oi.dot(a).clamp(),i=oi.dot(qi).clamp(),s=oi.dot(e).clamp(),r=cBe({roughness:Ig,dotNH:s}),o=uBe({dotNV:i,dotNL:n});return Xc.mul(r).mul(o)}),hBe=Ye(({N:a,V:e,roughness:n})=>{const r=.0078125,o=a.dot(e).saturate(),l=Qt(n,o.oneMinus().sqrt());return l.assign(l.mul(.984375).add(r)),l}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),fBe=Ye(({f:a})=>{const e=a.length();return Ns(e.mul(e).add(a.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),WM=Ye(({v1:a,v2:e})=>{const n=a.dot(e),i=n.abs().toVar(),s=i.mul(.0145206).add(.4965155).mul(i).add(.8543985).toVar(),r=i.add(4.1616724).mul(i).add(3.417594).toVar(),o=s.div(r),l=n.greaterThan(0).select(o,Ns(n.mul(n).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(o));return a.cross(e).mul(l)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),sK=Ye(({N:a,V:e,P:n,mInv:i,p0:s,p1:r,p2:o,p3:l})=>{const c=r.sub(s).toVar(),u=l.sub(s).toVar(),h=c.cross(u),f=qe().toVar();return kn(h.dot(n.sub(s)).greaterThanEqual(0),()=>{const m=e.sub(a.mul(e.dot(a))).normalize(),A=a.cross(m).negate(),x=i.mul(Oo(m,A,a).transpose()).toVar(),T=x.mul(s.sub(n)).normalize().toVar(),E=x.mul(r.sub(n)).normalize().toVar(),M=x.mul(o.sub(n)).normalize().toVar(),N=x.mul(l.sub(n)).normalize().toVar(),I=qe(0).toVar();I.addAssign(WM({v1:T,v2:E})),I.addAssign(WM({v1:E,v2:M})),I.addAssign(WM({v1:M,v2:N})),I.addAssign(WM({v1:N,v2:T})),f.assign(qe(fBe({f:I})))}),f}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),Y4=1/6,Wse=a=>ia(Y4,ia(a,ia(a,a.negate().add(3)).sub(3)).add(1)),jO=a=>ia(Y4,ia(a,ia(a,ia(3,a).sub(6))).add(4)),$se=a=>ia(Y4,ia(a,ia(a,ia(-3,a).add(3)).add(3)).add(1)),BO=a=>ia(Y4,Uu(a,3)),rK=a=>Wse(a).add(jO(a)),oK=a=>$se(a).add(BO(a)),lK=a=>cr(-1,jO(a).div(Wse(a).add(jO(a)))),cK=a=>cr(1,BO(a).div($se(a).add(BO(a)))),uK=(a,e,n)=>{const i=a.uvNode,s=ia(i,e.zw).add(.5),r=rf(s),o=Yd(s),l=rK(o.x),c=oK(o.x),u=lK(o.x),h=cK(o.x),f=lK(o.y),m=cK(o.y),A=Qt(r.x.add(u),r.y.add(f)).sub(.5).mul(e.xy),x=Qt(r.x.add(h),r.y.add(f)).sub(.5).mul(e.xy),T=Qt(r.x.add(u),r.y.add(m)).sub(.5).mul(e.xy),E=Qt(r.x.add(h),r.y.add(m)).sub(.5).mul(e.xy),M=rK(o.y).mul(cr(l.mul(a.sample(A).level(n)),c.mul(a.sample(x).level(n)))),N=oK(o.y).mul(cr(l.mul(a.sample(T).level(n)),c.mul(a.sample(E).level(n))));return M.add(N)},g7=Ye(([a,e])=>{const n=Qt(a.size(Be(e))),i=Qt(a.size(Be(e.add(1)))),s=yu(1,n),r=yu(1,i),o=uK(a,On(s,n),rf(e)),l=uK(a,On(r,i),O4(e));return Yd(e).mix(o,l)}),pBe=Ye(([a,e])=>{const n=e.mul(KB(a));return g7(a,n)}),dK=Ye(([a,e,n,i,s])=>{const r=qe(UB(e.negate(),Fl(a),yu(1,i))),o=qe(of(s[0].xyz),of(s[1].xyz),of(s[2].xyz));return Fl(r).mul(n.mul(o))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),mBe=Ye(([a,e])=>a.mul(Xd(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),gBe=o7(),ABe=o7(),hK=Ye(([a,e,n],{material:i})=>{const r=(i.side===Di?gBe:ABe).sample(a),o=sf(t1.x).mul(mBe(e,n));return g7(r,o)}),fK=Ye(([a,e,n])=>(kn(n.notEqual(0),()=>{const i=k4(e).negate().div(n);return CB(i.negate().mul(a))}),qe(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),yBe=Ye(([a,e,n,i,s,r,o,l,c,u,h,f,m,A,x])=>{let T,E;if(x){T=On().toVar(),E=qe().toVar();const G=h.sub(1).mul(x.mul(.025)),O=qe(h.sub(G),h,h.add(G));Li({start:0,end:3},({i:D})=>{const j=O.element(D),L=dK(a,e,f,j,l),U=o.add(L),q=u.mul(c.mul(On(U,1))),K=Qt(q.xy.div(q.w)).toVar();K.addAssign(1),K.divAssign(2),K.assign(Qt(K.x,K.y.oneMinus()));const H=hK(K,n,j);T.element(D).assign(H.element(D)),T.a.addAssign(H.a),E.element(D).assign(i.element(D).mul(fK(of(L),m,A).element(D)))}),T.a.divAssign(3)}else{const G=dK(a,e,f,h,l),O=o.add(G),D=u.mul(c.mul(On(O,1))),j=Qt(D.xy.div(D.w)).toVar();j.addAssign(1),j.divAssign(2),j.assign(Qt(j.x,j.y.oneMinus())),T=hK(j,n,h),E=i.mul(fK(of(G),m,A))}const M=E.rgb.mul(T.rgb),N=a.dot(e).clamp(),I=qe(Hse({dotNV:N,specularColor:s,specularF90:r,roughness:n})),F=E.r.add(E.g,E.b).div(3);return On(I.oneMinus().mul(M),T.a.oneMinus().mul(F).oneMinus())}),vBe=Oo(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),_Be=a=>{const e=a.sqrt();return qe(1).add(e).div(qe(1).sub(e))},pK=(a,e)=>a.sub(e).div(a.add(e)).pow2(),xBe=(a,e)=>{const n=a.mul(2*Math.PI*1e-9),i=qe(54856e-17,44201e-17,52481e-17),s=qe(1681e3,1795300,2208400),r=qe(43278e5,93046e5,66121e5),o=Re(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(n.mul(2239900).add(e.x).cos()).mul(n.pow2().mul(-45282e5).exp());let l=i.mul(r.mul(2*Math.PI).sqrt()).mul(s.mul(n).add(e).cos()).mul(n.pow2().negate().mul(r).exp());return l=qe(l.x.add(o),l.y,l.z).div(10685e-11),vBe.mul(l)},mK=Ye(({outsideIOR:a,eta2:e,cosTheta1:n,thinFilmThickness:i,baseF0:s})=>{const r=Ha(a,e,Qd(0,.03,i)),l=a.div(r).pow2().mul(n.pow2().oneMinus()).oneMinus();kn(l.lessThan(0),()=>qe(1));const c=l.sqrt(),u=pK(r,a),h=gx({f0:u,f90:1,dotVH:n}),f=h.oneMinus(),m=r.lessThan(a).select(Math.PI,0),A=Re(Math.PI).sub(m),x=_Be(s.clamp(0,.9999)),T=pK(x,r.toVec3()),E=gx({f0:T,f90:1,dotVH:c}),M=qe(x.x.lessThan(r).select(Math.PI,0),x.y.lessThan(r).select(Math.PI,0),x.z.lessThan(r).select(Math.PI,0)),N=r.mul(i,c,2),I=qe(A).add(M),F=h.mul(E).clamp(1e-5,.9999),G=F.sqrt(),O=f.pow2().mul(E).div(qe(1).sub(F)),j=h.add(O).toVar(),L=O.sub(f).toVar();return Li({start:1,end:2,condition:"<=",name:"m"},({m:U})=>{L.mulAssign(G);const q=xBe(Re(U).mul(N),Re(U).mul(I)).mul(2);j.addAssign(L.mul(q))}),j.max(qe(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),u2=Ye(({normal:a,viewDir:e,roughness:n})=>{const i=a.dot(e).saturate(),s=n.mul(n),r=n.add(.1).reciprocal(),o=Re(-1.9362).add(n.mul(1.0678)).add(s.mul(.4573)).sub(r.mul(.8469)),l=Re(-.6014).add(n.mul(.5538)).sub(s.mul(.467)).sub(r.mul(.1255));return o.mul(i).add(l).exp().saturate()}),w5=qe(.04),E5=Re(1);class Kse extends K4{constructor(e=!1,n=!1,i=!1,s=!1,r=!1,o=!1){super(),this.clearcoat=e,this.sheen=n,this.iridescence=i,this.anisotropy=s,this.transmission=r,this.dispersion=o,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null,this.iridescenceF0Dielectric=null,this.iridescenceF0Metallic=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=qe().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=qe().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=qe().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=qe().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=qe().toVar("sheenSpecularIndirect")),this.iridescence===!0){const n=oi.dot(qi).clamp(),i=mK({outsideIOR:Re(1),eta2:AR,cosTheta1:n,thinFilmThickness:yR,baseF0:v0}),s=mK({outsideIOR:Re(1),eta2:AR,cosTheta1:n,thinFilmThickness:yR,baseF0:Pi.rgb});this.iridescenceFresnel=Ha(i,s,Xp),this.iridescenceF0Dielectric=FO({f:i,f90:1,dotVH:n}),this.iridescenceF0Metallic=FO({f:s,f90:1,dotVH:n}),this.iridescenceF0=Ha(this.iridescenceF0Dielectric,this.iridescenceF0Metallic,Xp)}if(this.transmission===!0){const n=lf,i=mie.sub(lf).normalize(),s=D0,r=e.context;r.backdrop=yBe(s,i,Uh,IA,WA,M_,n,Vu,ad,om,AS,_B,bB,xB,this.dispersion?SB:null),r.backdropAlpha=xR,Pi.a.mulAssign(Ha(1,r.backdrop.a,xR))}super.start(e)}computeMultiscattering(e,n,i,s,r=null){const o=oi.dot(qi).clamp(),l=hT({roughness:Uh,dotNV:o}),c=r?L4.mix(s,r):s,u=c.mul(l.x).add(i.mul(l.y)),f=l.x.add(l.y).oneMinus(),m=c.add(c.oneMinus().mul(.047619)),A=u.mul(m).div(f.mul(m).oneMinus());e.addAssign(u),n.addAssign(A.mul(f))}direct({lightDirection:e,lightColor:n,reflectedLight:i}){const r=oi.dot(e).clamp().mul(n).toVar();if(this.sheen===!0){this.sheenSpecularDirect.addAssign(r.mul(dBe({lightDirection:e})));const o=u2({normal:oi,viewDir:qi,roughness:Ig}),l=u2({normal:oi,viewDir:e,roughness:Ig}),c=Xc.r.max(Xc.g).max(Xc.b).mul(o.max(l)).oneMinus();r.mulAssign(c)}if(this.clearcoat===!0){const l=$A.dot(e).clamp().mul(n);this.clearcoatSpecularDirect.addAssign(l.mul(m7({lightDirection:e,f0:w5,f90:E5,roughness:dT,normalView:$A})))}i.directDiffuse.addAssign(r.mul(n1({diffuseColor:IA}))),i.directSpecular.addAssign(r.mul(lBe({lightDirection:e,f0:WA,f90:1,roughness:Uh,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:n,halfWidth:i,halfHeight:s,reflectedLight:r,ltc_1:o,ltc_2:l}){const c=n.add(i).sub(s),u=n.sub(i).sub(s),h=n.sub(i).add(s),f=n.add(i).add(s),m=oi,A=qi,x=tr.toVar(),T=hBe({N:m,V:A,roughness:Uh}),E=o.sample(T).toVar(),M=l.sample(T).toVar(),N=Oo(qe(E.x,0,E.y),qe(0,1,0),qe(E.z,0,E.w)).toVar(),I=WA.mul(M.x).add(WA.oneMinus().mul(M.y)).toVar();r.directSpecular.addAssign(e.mul(I).mul(sK({N:m,V:A,P:x,mInv:N,p0:c,p1:u,p2:h,p3:f}))),r.directDiffuse.addAssign(e.mul(IA).mul(sK({N:m,V:A,P:x,mInv:Oo(1,0,0,0,1,0,0,0,1),p0:c,p1:u,p2:h,p3:f})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:n,reflectedLight:i}=e.context,s=n.mul(n1({diffuseColor:IA})).toVar();if(this.sheen===!0){const r=u2({normal:oi,viewDir:qi,roughness:Ig}),o=Xc.r.max(Xc.g).max(Xc.b).mul(r).oneMinus();s.mulAssign(o)}i.indirectDiffuse.addAssign(s)}indirectSpecular(e){const{radiance:n,iblIrradiance:i,reflectedLight:s}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(i.mul(Xc,u2({normal:oi,viewDir:qi,roughness:Ig}))),this.clearcoat===!0){const E=$A.dot(qi).clamp(),M=Hse({dotNV:E,specularColor:w5,specularF90:E5,roughness:dT});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(M))}const r=qe().toVar("singleScatteringDielectric"),o=qe().toVar("multiScatteringDielectric"),l=qe().toVar("singleScatteringMetallic"),c=qe().toVar("multiScatteringMetallic");this.computeMultiscattering(r,o,M_,v0,this.iridescenceF0Dielectric),this.computeMultiscattering(l,c,M_,Pi.rgb,this.iridescenceF0Metallic);const u=Ha(r,l,Xp),h=Ha(o,c,Xp),f=r.add(o),m=IA.mul(f.oneMinus()),A=i.mul(1/Math.PI),x=n.mul(u).add(h.mul(A)).toVar(),T=m.mul(A).toVar();if(this.sheen===!0){const E=u2({normal:oi,viewDir:qi,roughness:Ig}),M=Xc.r.max(Xc.g).max(Xc.b).mul(E).oneMinus();x.mulAssign(M),T.mulAssign(M)}s.indirectSpecular.addAssign(x),s.indirectDiffuse.addAssign(T)}ambientOcclusion(e){const{ambientOcclusion:n,reflectedLight:i}=e.context,r=oi.dot(qi).clamp().add(n),o=Uh.mul(-16).oneMinus().negate().exp2(),l=n.sub(r.pow(o).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(n),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(n),i.indirectDiffuse.mulAssign(n),i.indirectSpecular.mulAssign(l)}finish({context:e}){const{outgoingLight:n}=e;if(this.clearcoat===!0){const i=$A.dot(qi).clamp(),s=gx({dotVH:i,f0:w5,f90:E5}),r=n.mul(gR.mul(s).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(gR));n.assign(r)}if(this.sheen===!0){const i=n.add(this.sheenSpecularDirect,this.sheenSpecularIndirect.mul(1/Math.PI));n.assign(i)}}}const gK=Re(1),UO=Re(-2),$M=Re(.8),M5=Re(-1),KM=Re(.4),C5=Re(2),YM=Re(.305),N5=Re(3),AK=Re(.21),bBe=Re(4),yK=Re(4),SBe=Re(16),TBe=Ye(([a])=>{const e=qe(Ji(a)).toVar(),n=Re(-1).toVar();return kn(e.x.greaterThan(e.z),()=>{kn(e.x.greaterThan(e.y),()=>{n.assign(Io(a.x.greaterThan(0),0,3))}).Else(()=>{n.assign(Io(a.y.greaterThan(0),1,4))})}).Else(()=>{kn(e.z.greaterThan(e.y),()=>{n.assign(Io(a.z.greaterThan(0),2,5))}).Else(()=>{n.assign(Io(a.y.greaterThan(0),1,4))})}),n}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),wBe=Ye(([a,e])=>{const n=Qt().toVar();return kn(e.equal(0),()=>{n.assign(Qt(a.z,a.y).div(Ji(a.x)))}).ElseIf(e.equal(1),()=>{n.assign(Qt(a.x.negate(),a.z.negate()).div(Ji(a.y)))}).ElseIf(e.equal(2),()=>{n.assign(Qt(a.x.negate(),a.y).div(Ji(a.z)))}).ElseIf(e.equal(3),()=>{n.assign(Qt(a.z.negate(),a.y).div(Ji(a.x)))}).ElseIf(e.equal(4),()=>{n.assign(Qt(a.x.negate(),a.z).div(Ji(a.y)))}).Else(()=>{n.assign(Qt(a.x,a.y).div(Ji(a.z)))}),ia(.5,n.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),EBe=Ye(([a])=>{const e=Re(0).toVar();return kn(a.greaterThanEqual($M),()=>{e.assign(gK.sub(a).mul(M5.sub(UO)).div(gK.sub($M)).add(UO))}).ElseIf(a.greaterThanEqual(KM),()=>{e.assign($M.sub(a).mul(C5.sub(M5)).div($M.sub(KM)).add(M5))}).ElseIf(a.greaterThanEqual(YM),()=>{e.assign(KM.sub(a).mul(N5.sub(C5)).div(KM.sub(YM)).add(C5))}).ElseIf(a.greaterThanEqual(AK),()=>{e.assign(YM.sub(a).mul(bBe.sub(N5)).div(YM.sub(AK)).add(N5))}).Else(()=>{e.assign(Re(-2).mul(sf(ia(1.16,a))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),Yse=Ye(([a,e])=>{const n=a.toVar();n.assign(ia(2,n).sub(1));const i=qe(n,1).toVar();return kn(e.equal(0),()=>{i.assign(i.zyx)}).ElseIf(e.equal(1),()=>{i.assign(i.xzy),i.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{i.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{i.assign(i.zyx),i.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{i.assign(i.xzy),i.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{i.z.mulAssign(-1)}),i}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),Xse=Ye(([a,e,n,i,s,r])=>{const o=Re(n),l=qe(e),c=Xd(EBe(o),UO,r),u=Yd(c),h=rf(c),f=qe(fT(a,l,h,i,s,r)).toVar();return kn(u.notEqual(0),()=>{const m=qe(fT(a,l,h.add(1),i,s,r)).toVar();f.assign(Ha(f,m,u))}),f}),fT=Ye(([a,e,n,i,s,r])=>{const o=Re(n).toVar(),l=qe(e),c=Re(TBe(l)).toVar(),u=Re(Ns(yK.sub(o),0)).toVar();o.assign(Ns(o,yK));const h=Re(px(o)).toVar(),f=Qt(wBe(l,c).mul(h.sub(2)).add(1)).toVar();return kn(c.greaterThan(2),()=>{f.y.addAssign(h),c.subAssign(3)}),f.x.addAssign(c.mul(h)),f.x.addAssign(u.mul(ia(3,SBe))),f.y.addAssign(ia(4,px(r).sub(h))),f.x.mulAssign(i),f.y.mulAssign(s),a.sample(f).grad(Qt(),Qt())}),R5=Ye(({envMap:a,mipInt:e,outputDirection:n,theta:i,axis:s,CUBEUV_TEXEL_WIDTH:r,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:l})=>{const c=Rd(i),u=n.mul(c).add(s.cross(n).mul(Rl(i))).add(s.mul(s.dot(n).mul(c.oneMinus())));return fT(a,u,e,r,o,l)}),Qse=Ye(({n:a,latitudinal:e,poleAxis:n,outputDirection:i,weights:s,samples:r,dTheta:o,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:f})=>{const m=qe(Io(e,n,Mm(n,i))).toVar();kn(m.equal(qe(0)),()=>{m.assign(qe(i.z,0,i.x.negate()))}),m.assign(Fl(m));const A=qe().toVar();return A.addAssign(s.element(0).mul(R5({theta:0,axis:m,outputDirection:i,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:f}))),Li({start:Be(1),end:a},({i:x})=>{kn(x.greaterThanEqual(r),()=>{Ese()});const T=Re(o.mul(Re(x))).toVar();A.addAssign(s.element(x).mul(R5({theta:T.mul(-1),axis:m,outputDirection:i,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:f}))),A.addAssign(s.element(x).mul(R5({theta:T,axis:m,outputDirection:i,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:f})))}),On(A,1)}),MBe=Ye(([a])=>{const e=qt(a).toVar();return e.assign(e.shiftLeft(qt(16)).bitOr(e.shiftRight(qt(16)))),e.assign(e.bitAnd(qt(1431655765)).shiftLeft(qt(1)).bitOr(e.bitAnd(qt(2863311530)).shiftRight(qt(1)))),e.assign(e.bitAnd(qt(858993459)).shiftLeft(qt(2)).bitOr(e.bitAnd(qt(3435973836)).shiftRight(qt(2)))),e.assign(e.bitAnd(qt(252645135)).shiftLeft(qt(4)).bitOr(e.bitAnd(qt(4042322160)).shiftRight(qt(4)))),e.assign(e.bitAnd(qt(16711935)).shiftLeft(qt(8)).bitOr(e.bitAnd(qt(4278255360)).shiftRight(qt(8)))),Re(e).mul(23283064365386963e-26)}),CBe=Ye(([a,e])=>Qt(Re(a).div(Re(e)),MBe(a))),NBe=Ye(([a,e,n])=>{const i=qe(e).toVar(),s=Re(n),r=s.mul(s).toVar(),o=Fl(qe(r.mul(i.x),r.mul(i.y),i.z)).toVar(),l=o.x.mul(o.x).add(o.y.mul(o.y)),c=Io(l.greaterThan(0),qe(o.y.negate(),o.x,0).div(cl(l)),qe(1,0,0)).toVar(),u=Mm(o,c).toVar(),h=cl(a.x),f=ia(2,3.14159265359).mul(a.y),m=h.mul(Rd(f)).toVar(),A=h.mul(Rl(f)).toVar(),x=ia(.5,o.z.add(1));A.assign(x.oneMinus().mul(cl(m.mul(m).oneMinus())).add(x.mul(A)));const T=c.mul(m).add(u.mul(A)).add(o.mul(cl(Ns(0,m.mul(m).add(A.mul(A)).oneMinus()))));return Fl(qe(r.mul(T.x),r.mul(T.y),Ns(0,T.z)))}),Jse=Ye(({roughness:a,mipInt:e,envMap:n,N_immutable:i,GGX_SAMPLES:s,CUBEUV_TEXEL_WIDTH:r,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:l})=>{const c=qe(i).toVar(),u=qe(0).toVar(),h=Re(0).toVar();return kn(a.lessThan(.001),()=>{u.assign(fT(n,c,e,r,o,l))}).Else(()=>{const f=Io(Ji(c.z).lessThan(.999),qe(0,0,1),qe(1,0,0)),m=Fl(Mm(f,c)).toVar(),A=Mm(c,m).toVar();Li({start:qt(0),end:s},({i:x})=>{const T=CBe(x,s),E=NBe(T,qe(0,0,1),a),M=Fl(m.mul(E.x).add(A.mul(E.y)).add(c.mul(E.z))),N=Fl(M.mul(Yu(c,M).mul(2)).sub(c)),I=Ns(Yu(c,N),0);kn(I.greaterThan(0),()=>{const F=fT(n,N,e,r,o,l);u.addAssign(F.mul(I)),h.addAssign(I)})}),kn(h.greaterThan(0),()=>{u.assign(u.div(h))})}),On(u,1)}),Gg=4,vK=[.125,.215,.35,.446,.526,.582],LA=20,RBe=512,d2=new P0(-1,1,1,-1,0,1),PBe=new Zs(90,1),_K=new on;let P5=null,I5=0,L5=0;const IBe=new ye,ER=new WeakMap,LBe=[3,1,5,0,4,2],D5=Yse(Vi(),Nm("faceIndex")).normalize(),X4=qe(D5.x,D5.y,D5.z);class DBe{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._ggxMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,n=0,i=.1,s=100,r={}){const{size:o=256,position:l=IBe,renderTarget:c=null}=r;if(this._setSize(o),this._hasInitialized===!1){yt('PMREMGenerator: ".fromScene()" called before the backend is initialized. Try using "await renderer.init()" instead.');const h=c||this._allocateTarget();return r.renderTarget=h,this.fromSceneAsync(e,n,i,s,r),h}P5=this._renderer.getRenderTarget(),I5=this._renderer.getActiveCubeFace(),L5=this._renderer.getActiveMipmapLevel();const u=c||this._allocateTarget();return u.depthBuffer=!0,this._init(u),this._sceneToCubeUV(e,i,s,u,l),n>0&&this._blur(u,0,0,n),this._applyPMREM(u),this._cleanup(u),u}async fromSceneAsync(e,n=0,i=.1,s=100,r={}){return ji('PMREMGenerator: ".fromSceneAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this.fromScene(e,n,i,s,r)}fromEquirectangular(e,n=null){if(this._hasInitialized===!1){yt('PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using "await renderer.init()" instead.'),this._setSizeFromTexture(e);const i=n||this._allocateTarget();return this.fromEquirectangularAsync(e,i),i}return this._fromTexture(e,n)}async fromEquirectangularAsync(e,n=null){return ji('PMREMGenerator: ".fromEquirectangularAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this._fromTexture(e,n)}fromCubemap(e,n=null){if(this._hasInitialized===!1){yt("PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const i=n||this._allocateTarget();return this.fromCubemapAsync(e,n),i}return this._fromTexture(e,n)}async fromCubemapAsync(e,n=null){return ji('PMREMGenerator: ".fromCubemapAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this._fromTexture(e,n)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=bK(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=SK(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===xc||e.mapping===Wu?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(P5,I5,L5),e.scissorTest=!1,kv(e,0,0,e.width,e.height)}_fromTexture(e,n){this._setSizeFromTexture(e),P5=this._renderer.getRenderTarget(),I5=this._renderer.getActiveCubeFace(),L5=this._renderer.getActiveMipmapLevel();const i=n||this._allocateTarget();return this._init(i),this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTarget(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize;return xK(e,n)}_init(e){if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=xK(e.width,e.height);const{_lodMax:n}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=kBe(n)),this._blurMaterial=OBe(n,e.width,e.height),this._ggxMaterial=FBe(n,e.width,e.height)}}async _compileMaterial(e){const n=new Na(new zn,e);await this._renderer.compile(n,d2)}_sceneToCubeUV(e,n,i,s,r){const o=PBe;o.near=n,o.far=i;const l=[1,1,1,1,-1,1],c=[1,-1,1,-1,1,-1],u=this._renderer,h=u.autoClear;u.getClearColor(_K),u.autoClear=!1,this._backgroundBox===null&&(this._backgroundBox=new Na(new Yf,new oo({name:"PMREM.Background",side:Di,depthWrite:!1,depthTest:!1})));const f=this._backgroundBox,m=f.material;let A=!1;const x=e.background;x?x.isColor&&(m.color.copy(x),e.background=null,A=!0):(m.color.copy(_K),A=!0),u.setRenderTarget(s),u.clear(),A&&u.render(f,o);for(let T=0;T<6;T++){const E=T%3;E===0?(o.up.set(0,l[T],0),o.position.set(r.x,r.y,r.z),o.lookAt(r.x+c[T],r.y,r.z)):E===1?(o.up.set(0,0,l[T]),o.position.set(r.x,r.y,r.z),o.lookAt(r.x,r.y+c[T],r.z)):(o.up.set(0,l[T],0),o.position.set(r.x,r.y,r.z),o.lookAt(r.x,r.y,r.z+c[T]));const M=this._cubeSize;kv(s,E*M,T>2?M:0,M,M),u.render(e,o)}u.autoClear=h,e.background=x}_textureToCubeUV(e,n){const i=this._renderer,s=e.mapping===xc||e.mapping===Wu;s?this._cubemapMaterial===null&&(this._cubemapMaterial=bK(e)):this._equirectMaterial===null&&(this._equirectMaterial=SK(e));const r=s?this._cubemapMaterial:this._equirectMaterial;r.fragmentNode.value=e;const o=this._lodMeshes[0];o.material=r;const l=this._cubeSize;kv(n,0,0,3*l,2*l),i.setRenderTarget(n),i.render(o,d2)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const s=this._lodMeshes.length;for(let r=1;r<s;r++)this._applyGGXFilter(e,r-1,r);n.autoClear=i}_applyGGXFilter(e,n,i){const s=this._renderer,r=this._pingPongRenderTarget,o=this._ggxMaterial,l=this._lodMeshes[i];l.material=o;const c=ER.get(o),u=i/(this._lodMeshes.length-1),h=n/(this._lodMeshes.length-1),f=Math.sqrt(u*u-h*h),m=0+u*1.25,A=f*m,{_lodMax:x}=this,T=this._sizeLods[i],E=3*T*(i>x-Gg?i-x+Gg:0),M=4*(this._cubeSize-T);e.texture.frame=(e.texture.frame||0)+1,c.envMap.value=e.texture,c.roughness.value=A,c.mipInt.value=x-n,kv(r,E,M,3*T,2*T),s.setRenderTarget(r),s.render(l,d2),r.texture.frame=(r.texture.frame||0)+1,c.envMap.value=r.texture,c.roughness.value=0,c.mipInt.value=x-i,kv(e,E,M,3*T,2*T),s.setRenderTarget(e),s.render(l,d2)}_blur(e,n,i,s,r){const o=this._pingPongRenderTarget;this._halfBlur(e,o,n,i,s,"latitudinal",r),this._halfBlur(o,e,i,i,s,"longitudinal",r)}_halfBlur(e,n,i,s,r,o,l){const c=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&Rt("blur direction must be either latitudinal or longitudinal!");const h=3,f=this._lodMeshes[s];f.material=u;const m=ER.get(u),A=this._sizeLods[i]-1,x=isFinite(r)?Math.PI/(2*A):2*Math.PI/(2*LA-1),T=r/x,E=isFinite(r)?1+Math.floor(h*T):LA;E>LA&&yt(`sigmaRadians, ${r}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${LA}`);const M=[];let N=0;for(let D=0;D<LA;++D){const j=D/T,L=Math.exp(-j*j/2);M.push(L),D===0?N+=L:D<E&&(N+=2*L)}for(let D=0;D<M.length;D++)M[D]=M[D]/N;e.texture.frame=(e.texture.frame||0)+1,m.envMap.value=e.texture,m.samples.value=E,m.weights.array=M,m.latitudinal.value=o==="latitudinal"?1:0,l&&(m.poleAxis.value=l);const{_lodMax:I}=this;m.dTheta.value=x,m.mipInt.value=I-i;const F=this._sizeLods[s],G=3*F*(s>I-Gg?s-I+Gg:0),O=4*(this._cubeSize-F);kv(n,G,O,3*F,2*F),c.setRenderTarget(n),c.render(f,d2)}}function kBe(a){const e=[],n=[],i=[];let s=a;const r=a-Gg+1+vK.length;for(let o=0;o<r;o++){const l=Math.pow(2,s);e.push(l);let c=1/l;o>a-Gg?c=vK[o-a+Gg-1]:o===0&&(c=0),n.push(c);const u=1/(l-2),h=-u,f=1+u,m=[h,h,f,h,f,f,h,h,f,f,h,f],A=6,x=6,T=3,E=2,M=1,N=new Float32Array(T*x*A),I=new Float32Array(E*x*A),F=new Float32Array(M*x*A);for(let O=0;O<A;O++){const D=O%3*2/3-1,j=O>2?0:-1,L=[D,j,0,D+2/3,j,0,D+2/3,j+1,0,D,j,0,D+2/3,j+1,0,D,j+1,0],U=LBe[O];N.set(L,T*x*U),I.set(m,E*x*U);const q=[U,U,U,U,U,U];F.set(q,M*x*U)}const G=new zn;G.setAttribute("position",new Ua(N,T)),G.setAttribute("uv",new Ua(I,E)),G.setAttribute("faceIndex",new Ua(F,M)),i.push(new Na(G,null)),s>Gg&&s--}return{lodMeshes:i,sizeLods:e,sigmas:n}}function xK(a,e){const n={magFilter:di,minFilter:di,generateMipmaps:!1,type:cs,format:fs,colorSpace:_m},i=new th(a,e,n);return i.texture.mapping=Am,i.texture.name="PMREM.cubeUv",i.texture.isPMREMTexture=!0,i.scissorTest=!0,i}function kv(a,e,n,i,s){a.viewport.set(e,n,i,s),a.scissor.set(e,n,i,s)}function Q4(a){const e=new zs;return e.depthTest=!1,e.depthWrite=!1,e.blending=hl,e.name=`PMREM_${a}`,e}function OBe(a,e,n){const i=sl(new Array(LA).fill(0)),s=Rn(new ye(0,1,0)),r=Rn(0),o=Re(LA),l=Rn(0),c=Rn(1),u=hi(),h=Rn(0),f=Re(1/e),m=Re(1/n),A=Re(a),x={n:o,latitudinal:l,weights:i,poleAxis:s,outputDirection:X4,dTheta:r,samples:c,envMap:u,mipInt:h,CUBEUV_TEXEL_WIDTH:f,CUBEUV_TEXEL_HEIGHT:m,CUBEUV_MAX_MIP:A},T=Q4("blur");return T.fragmentNode=Qse({...x,latitudinal:l.equal(1)}),ER.set(T,x),T}function FBe(a,e,n){const i=hi(),s=Rn(0),r=Rn(0),o=Re(1/e),l=Re(1/n),c=Re(a),u={envMap:i,roughness:s,mipInt:r,CUBEUV_TEXEL_WIDTH:o,CUBEUV_TEXEL_HEIGHT:l,CUBEUV_MAX_MIP:c},h=Q4("ggx");return h.fragmentNode=Jse({...u,N_immutable:X4,GGX_SAMPLES:qt(RBe)}),ER.set(h,u),h}function bK(a){const e=Q4("cubemap");return e.fragmentNode=Dl(a,X4),e}function SK(a){const e=Q4("equirect");return e.fragmentNode=hi(a,h7(X4),0),e}const TK=new WeakMap;function jBe(a){const e=Math.log2(a)-2,n=1/a;return{texelWidth:1/(3*Math.max(Math.pow(2,e),112)),texelHeight:n,maxMip:e}}function BBe(a,e,n){const i=UBe(e);let s=i.get(a);if((s!==void 0?s.pmremVersion:-1)!==a.pmremVersion){const o=a.image;if(a.isCubeTexture)if(zBe(o))s=n.fromCubemap(a,s);else return null;else if(GBe(o))s=n.fromEquirectangular(a,s);else return null;s.pmremVersion=a.pmremVersion,i.set(a,s)}return s.texture}function UBe(a){let e=TK.get(a);return e===void 0&&(e=new WeakMap,TK.set(a,e)),e}class VBe extends Rs{static get type(){return"PMREMNode"}constructor(e,n=null,i=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=n,this.levelNode=i,this._generator=null;const s=new _s;s.isRenderTargetTexture=!0,this._texture=hi(s),this._width=Rn(0),this._height=Rn(0),this._maxMip=Rn(0),this.updateBeforeType=fa.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const n=jBe(e.image.height);this._texture.value=e,this._width.value=n.texelWidth,this._height.value=n.texelHeight,this._maxMip.value=n.maxMip}updateBefore(e){let n=this._pmrem;const i=n?n.pmremVersion:-1,s=this._value;i!==s.pmremVersion&&(s.isPMREMTexture===!0?n=s:n=BBe(s,e.renderer,this._generator),n!==null&&(this._pmrem=n,this.updateFromTexture(n)))}setup(e){this._generator===null&&(this._generator=new DBe(e.renderer)),this.updateBefore(e);let n=this.uvNode;n===null&&e.context.getUV&&(n=e.context.getUV(this,e)),n=n7.mul(qe(n.x,n.y.negate(),n.z));let i=this.levelNode;return i===null&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),Xse(this._texture,n,i,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function zBe(a){if(a==null)return!1;let e=0;const n=6;for(let i=0;i<n;i++)a[i]!==void 0&&e++;return e===n}function GBe(a){return a==null?!1:a.height>0}const A7=sa(VBe).setParameterLength(1,3),wK=new WeakMap;class qBe extends $x{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:n}=e;let i=this.envNode;if(i.isTextureNode||i.isMaterialReferenceNode){const f=i.isTextureNode?i.value:n[i.property];let m=wK.get(f);m===void 0&&(m=A7(f),wK.set(f,m)),i=m}const r=n.useAnisotropy===!0||n.anisotropy>0?Bie:oi,o=i.context(EK(Uh,r)).mul(o3),l=i.context(HBe(D0)).mul(Math.PI).mul(o3),c=R_(o),u=R_(l);e.context.radiance.addAssign(c),e.context.iblIrradiance.addAssign(u);const h=e.context.lightingModel.clearcoatRadiance;if(h){const f=i.context(EK(dT,$A)).mul(o3),m=R_(f);h.addAssign(m)}}}const EK=(a,e)=>{let n=null;return{getUV:()=>(n===null&&(n=qi.negate().reflect(e),n=jB(a).mix(n,e).normalize(),n=n.transformDirection(ad)),n),getTextureLevel:()=>a}},HBe=a=>({getUV:()=>a,getTextureLevel:()=>Re(1)}),WBe=new p4;class Zse extends zs{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(WBe),this.setValues(e)}setupEnvironment(e){let n=super.setupEnvironment(e);return n===null&&e.environmentNode&&(n=e.environmentNode),n?new qBe(n):null}setupLightingModel(){return new Kse}setupSpecular(){const e=Ha(qe(.04),Pi.rgb,Xp);v0.assign(qe(.04)),WA.assign(e),M_.assign(1)}setupVariants(){const e=this.metalnessNode?Re(this.metalnessNode):Kie;Xp.assign(e);let n=this.roughnessNode?Re(this.roughnessNode):$ie;n=p7({roughness:n}),Uh.assign(n),this.setupSpecular(),IA.assign(Pi.rgb.mul(e.oneMinus()))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const $Be=new xj;class KBe extends Zse{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues($Be),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?Re(this.iorNode):lse;AS.assign(e),v0.assign(Tc(FB(AS.sub(1).div(AS.add(1))).mul(Wie),qe(1)).mul(OO)),WA.assign(Ha(v0,Pi.rgb,Xp)),M_.assign(Ha(OO,1,Xp))}setupLightingModel(){return new Kse(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const n=this.clearcoatNode?Re(this.clearcoatNode):Xie,i=this.clearcoatRoughnessNode?Re(this.clearcoatRoughnessNode):Qie;gR.assign(n),dT.assign(p7({roughness:i}))}if(this.useSheen){const n=this.sheenNode?qe(this.sheenNode):ese,i=this.sheenRoughnessNode?Re(this.sheenRoughnessNode):tse;Xc.assign(n),Ig.assign(i)}if(this.useIridescence){const n=this.iridescenceNode?Re(this.iridescenceNode):ase,i=this.iridescenceIORNode?Re(this.iridescenceIORNode):ise,s=this.iridescenceThicknessNode?Re(this.iridescenceThicknessNode):sse;L4.assign(n),AR.assign(i),yR.assign(s)}if(this.useAnisotropy){const n=(this.anisotropyNode?Qt(this.anisotropyNode):nse).toVar();Eg.assign(n.length()),kn(Eg.equal(0),()=>{n.assign(Qt(1,0))}).Else(()=>{n.divAssign(Qt(Eg)),Eg.assign(Eg.saturate())}),vR.assign(Eg.pow2().mix(Uh.pow2(),1)),gS.assign(KA[0].mul(n.x).add(KA[1].mul(n.y))),ny.assign(KA[1].mul(n.x).sub(KA[0].mul(n.y)))}if(this.useTransmission){const n=this.transmissionNode?Re(this.transmissionNode):rse,i=this.thicknessNode?Re(this.thicknessNode):ose,s=this.attenuationDistanceNode?Re(this.attenuationDistanceNode):cse,r=this.attenuationColorNode?qe(this.attenuationColorNode):use;if(xR.assign(n),_B.assign(i),xB.assign(s),bB.assign(r),this.useDispersion){const o=this.dispersionNode?Re(this.dispersionNode):gse;SB.assign(o)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?qe(this.clearcoatNormalNode):Jie}setup(e){e.context.setupClearcoatNormal=()=>N_(this.setupClearcoatNormal(e),"NORMAL","vec3"),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const YBe=Ye(({normal:a,lightDirection:e,builder:n})=>{const i=a.dot(e),s=Qt(i.mul(.5).add(.5),0);if(n.material.gradientMap){const r=Hp("gradientMap","texture").context({getUV:()=>s});return qe(r.r)}else{const r=s.fwidth().mul(.5);return Ha(qe(.7),qe(1),Qd(Re(.7).sub(r.x),Re(.7).add(r.x),s.x))}});class XBe extends K4{direct({lightDirection:e,lightColor:n,reflectedLight:i},s){const r=YBe({normal:z4,lightDirection:e,builder:s}).mul(n);i.directDiffuse.addAssign(r.mul(n1({diffuseColor:Pi.rgb})))}indirect(e){const{ambientOcclusion:n,irradiance:i,reflectedLight:s}=e.context;s.indirectDiffuse.addAssign(i.mul(n1({diffuseColor:Pi}))),s.indirectDiffuse.mulAssign(n)}}const QBe=new bj;class JBe extends zs{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(QBe),this.setValues(e)}setupLightingModel(){return new XBe}}const ere=Ye(()=>{const a=qe(qi.z,0,qi.x.negate()).normalize(),e=qi.cross(a);return Qt(a.dot(oi),e.dot(oi)).mul(.495).add(.5)}).once(["NORMAL","VERTEX"])().toVar("matcapUV"),ZBe=new Ej;class e7e extends zs{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(ZBe),this.setValues(e)}setupVariants(e){const n=ere;let i;e.material.matcap?i=Hp("matcap","texture").context({getUV:()=>n}):i=qe(Ha(.2,.8,n.y)),Pi.rgb.mulAssign(i.rgb)}}class t7e extends Rs{static get type(){return"RotateNode"}constructor(e,n){super(),this.positionNode=e,this.rotationNode=n}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:n,positionNode:i}=this;if(this.getNodeType(e)==="vec2"){const r=n.cos(),o=n.sin();return I4(r,o,o.negate(),r).mul(i)}else{const r=n,o=n0(On(1,0,0,0),On(0,Rd(r.x),Rl(r.x).negate(),0),On(0,Rl(r.x),Rd(r.x),0),On(0,0,0,1)),l=n0(On(Rd(r.y),0,Rl(r.y),0),On(0,1,0,0),On(Rl(r.y).negate(),0,Rd(r.y),0),On(0,0,0,1)),c=n0(On(Rd(r.z),Rl(r.z).negate(),0,0),On(Rl(r.z),Rd(r.z),0,0),On(0,0,1,0),On(0,0,0,1));return o.mul(l).mul(c).mul(On(i,1)).xyz}}}const gw=sa(t7e).setParameterLength(2),n7e=new e4;class tre extends zs{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(n7e),this.setValues(e)}setupPositionView(e){const{object:n,camera:i}=e,{positionNode:s,rotationNode:r,scaleNode:o,sizeAttenuation:l}=this,c=L0.mul(qe(s||0));let u=Qt(Vu[0].xyz.length(),Vu[1].xyz.length());o!==null&&(u=u.mul(Qt(o))),i.isPerspectiveCamera&&l===!1&&(u=u.mul(c.z.negate()));let h=pw.xy;if(n.center&&n.center.isVector2===!0){const A=X8e("center","vec2",n);h=h.sub(A.sub(.5))}h=h.mul(u);const f=Re(r||Zie),m=gw(h,f);return On(c.xy.add(m),c.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const a7e=new JT,i7e=new Nt;class s7e extends tre{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(a7e),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return L0.mul(qe(e||Es)).xyz}setupVertexSprite(e){const{material:n,camera:i}=e,{rotationNode:s,scaleNode:r,sizeNode:o,sizeAttenuation:l}=this;let c=super.setupVertex(e);if(n.isNodeMaterial!==!0)return c;let u=o!==null?Qt(o):mse;u=u.mul(fie),i.isPerspectiveCamera&&l===!0&&(u=u.mul(r7e.div(tr.z.negate()))),r&&r.isNode&&(u=u.mul(Qt(r)));let h=pw.xy;if(s&&s.isNode){const f=Re(s);h=gw(h,f)}return h=h.mul(u),h=h.div(JB.div(2)),h=h.mul(c.w),c=c.add(On(h,0,0)),c}setupVertex(e){return e.object.isPoints?super.setupVertex(e):this.setupVertexSprite(e)}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}const r7e=Rn(1).onFrameUpdate(function({renderer:a}){const e=a.getSize(i7e);this.value=.5*e.y});class o7e extends K4{constructor(){super(),this.shadowNode=Re(1).toVar("shadowMask")}direct({lightNode:e}){e.shadowNode!==null&&this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){Pi.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(Pi.rgb)}}const l7e=new vj;class c7e extends zs{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(l7e),this.setValues(e)}setupLightingModel(){return new o7e}}im("vec3");im("vec3");im("vec3");class u7e{constructor(e,n,i){this.renderer=e,this.nodes=n,this.info=i,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(n,i)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this.renderer._inspector.begin(),this._animationLoop!==null&&this._animationLoop(n,i),this.renderer._inspector.finish()};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class Jd{constructor(){this.weakMaps={}}_getWeakMap(e){const n=e.length;let i=this.weakMaps[n];return i===void 0&&(i=new WeakMap,this.weakMaps[n]=i),i}get(e){let n=this._getWeakMap(e);for(let i=0;i<e.length-1;i++)if(n=n.get(e[i]),n===void 0)return;return n.get(e[e.length-1])}set(e,n){let i=this._getWeakMap(e);for(let s=0;s<e.length-1;s++){const r=e[s];i.has(r)===!1&&i.set(r,new WeakMap),i=i.get(r)}return i.set(e[e.length-1],n),this}delete(e){let n=this._getWeakMap(e);for(let i=0;i<e.length-1;i++)if(n=n.get(e[i]),n===void 0)return!1;return n.delete(e[e.length-1])}}let d7e=0;function h7e(a){const e=Object.keys(a);let n=Object.getPrototypeOf(a);for(;n;){const i=Object.getOwnPropertyDescriptors(n);for(const s in i)if(i[s]!==void 0){const r=i[s];r&&typeof r.get=="function"&&e.push(s)}n=Object.getPrototypeOf(n)}return e}class f7e{constructor(e,n,i,s,r,o,l,c,u,h){this.id=d7e++,this._nodes=e,this._geometries=n,this.renderer=i,this.object=s,this.material=r,this.scene=o,this.camera=l,this.lightsNode=c,this.context=u,this.geometry=s.geometry,this.version=r.version,this.drawRange=null,this.attributes=null,this.attributesId=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=h,this.clippingContextCacheKey=h!==null?h.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.onGeometryDispose=()=>{this.attributes=null,this.attributesId=null},this.material.addEventListener("dispose",this.onMaterialDispose),this.geometry.addEventListener("dispose",this.onGeometryDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const n of this.getBindings())if(n.name===e)return n}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getIndirectOffset(){return this._geometries.getIndirectOffset(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null,this.attributesId=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,n=this.geometry,i=[],s=new Set,r={};for(const o of e){let l;if(o.node&&o.node.attribute?l=o.node.attribute:(l=n.getAttribute(o.name),r[o.name]=l.version),l===void 0)continue;i.push(l);const c=l.isInterleavedBufferAttribute?l.data:l;s.add(c)}return this.attributes=i,this.attributesId=r,this.vertexBuffers=Array.from(s.values()),i}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:n,geometry:i,group:s,drawRange:r}=this,o=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),l=this.getIndex(),c=l!==null;let u=1;if(i.isInstancedBufferGeometry===!0?u=i.instanceCount:e.count!==void 0&&(u=Math.max(0,e.count)),u===0)return null;if(o.instanceCount=u,e.isBatchedMesh===!0)return o;let h=1;n.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(h=2);let f=r.start*h,m=(r.start+r.count)*h;s!==null&&(f=Math.max(f,s.start*h),m=Math.min(m,(s.start+s.count)*h));const A=i.attributes.position;let x=1/0;c?x=l.count:A!=null&&(x=A.count),f=Math.max(f,0),m=Math.min(m,x);const T=m-f;return T<0||T===1/0?null:(o.vertexCount=T,o.firstVertex=f,o)}getGeometryCacheKey(){const{geometry:e}=this;let n="";for(const i of Object.keys(e.attributes).sort()){const s=e.attributes[i];n+=i+",",s.data&&(n+=s.data.stride+","),s.offset&&(n+=s.offset+","),s.itemSize&&(n+=s.itemSize+","),s.normalized&&(n+="n,")}for(const i of Object.keys(e.morphAttributes).sort()){const s=e.morphAttributes[i];n+="morph-"+i+",";for(let r=0,o=s.length;r<o;r++){const l=s[r];n+=l.id+","}}return e.index&&(n+="index,"),n}getMaterialCacheKey(){const{object:e,material:n,renderer:i}=this;let s=n.customProgramCacheKey();for(const r of h7e(n)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(r))continue;const o=n[r];let l;if(o!==null){const c=typeof o;c==="number"?l=o!==0?"1":"0":c==="object"?(l="{",o.isTexture&&(l+=o.mapping,i.backend.isWebGPUBackend===!0&&(l+=o.magFilter,l+=o.minFilter,l+=o.wrapS,l+=o.wrapT,l+=o.wrapR)),l+="}"):l=String(o)}else l=String(o);s+=l+","}return s+=this.clippingContextCacheKey+",",e.geometry&&(s+=this.getGeometryCacheKey()),e.skeleton&&(s+=e.skeleton.bones.length+","),e.isBatchedMesh&&(s+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(s+=e._colorsTexture.uuid+",")),(e.isInstancedMesh||e.count>1||Array.isArray(e.morphTargetInfluences))&&(s+=e.uuid+","),s+=this.context.id+",",s+=e.receiveShadow+",",uw(s)}get needsGeometryUpdate(){if(this.geometry.id!==this.object.geometry.id)return!0;if(this.attributes!==null){const e=this.attributesId;for(const n in e){const i=this.geometry.getAttribute(n);if(i===void 0||e[n]!==i.id)return!0}}return!1}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=pS(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=pS(e,1)),e=pS(e,this.camera.id,this.renderer.contextNode.id,this.renderer.contextNode.version),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.geometry.removeEventListener("dispose",this.onGeometryDispose),this.onDispose()}}const vA=[];class p7e{constructor(e,n,i,s,r,o){this.renderer=e,this.nodes=n,this.geometries=i,this.pipelines=s,this.bindings=r,this.info=o,this.chainMaps={}}get(e,n,i,s,r,o,l,c){const u=this.getChainMap(c);vA[0]=e,vA[1]=n,vA[2]=o,vA[3]=r;let h=u.get(vA);return h===void 0?(h=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,n,i,s,r,o,l,c),u.set(vA,h)):(h.updateClipping(l),h.needsGeometryUpdate&&h.setGeometry(e.geometry),(h.version!==n.version||h.needsUpdate)&&(h.initialCacheKey!==h.getCacheKey()?(h.dispose(),h=this.get(e,n,i,s,r,o,l,c)):h.version=n.version)),vA.length=0,h}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new Jd)}dispose(){this.chainMaps={}}createRenderObject(e,n,i,s,r,o,l,c,u,h,f){const m=this.getChainMap(f),A=new f7e(e,n,i,s,r,o,l,c,u,h);return A.onDispose=()=>{this.pipelines.delete(A),this.bindings.deleteForRender(A),this.nodes.delete(A),m.delete(A.getChainArray())},A}}class k0{constructor(){this.data=new WeakMap}get(e){let n=this.data.get(e);return n===void 0&&(n={},this.data.set(e,n)),n}delete(e){let n=null;return this.data.has(e)&&(n=this.data.get(e),this.data.delete(e)),n}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const zu={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},kg=16,m7e=211,g7e=212;class A7e extends k0{constructor(e){super(),this.backend=e}delete(e){const n=super.delete(e);return n!==null&&this.backend.destroyAttribute(e),n}update(e,n){const i=this.get(e);if(i.version===void 0)n===zu.VERTEX?this.backend.createAttribute(e):n===zu.INDEX?this.backend.createIndexAttribute(e):n===zu.STORAGE?this.backend.createStorageAttribute(e):n===zu.INDIRECT&&this.backend.createIndirectStorageAttribute(e),i.version=this._getBufferAttribute(e).version;else{const s=this._getBufferAttribute(e);(i.version<s.version||s.usage===Bg)&&(this.backend.updateAttribute(e),i.version=s.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function nre(a){return a.index!==null?a.index.version:a.attributes.position.version}function MK(a){const e=[],n=a.index,i=a.attributes.position;if(n!==null){const r=n.array;for(let o=0,l=r.length;o<l;o+=3){const c=r[o+0],u=r[o+1],h=r[o+2];e.push(c,u,u,h,h,c)}}else{const r=i.array;for(let o=0,l=r.length/3-1;o<l;o+=3){const c=o+0,u=o+1,h=o+2;e.push(c,u,u,h,h,c)}}const s=new(nj(e)?XP:YP)(e,1);return s.version=nre(a),s}class y7e extends k0{constructor(e,n){super(),this.attributes=e,this.info=n,this.wireframes=new WeakMap,this.attributeCall=new WeakMap,this._geometryDisposeListeners=new Map}has(e){const n=e.geometry;return super.has(n)&&this.get(n).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const n=e.geometry,i=this.get(n);i.initialized=!0,this.info.memory.geometries++;const s=()=>{this.info.memory.geometries--;const r=n.index,o=e.getAttributes();r!==null&&this.attributes.delete(r);for(const c of o)this.attributes.delete(c);const l=this.wireframes.get(n);l!==void 0&&this.attributes.delete(l),n.removeEventListener("dispose",s),this._geometryDisposeListeners.delete(n)};n.addEventListener("dispose",s),this._geometryDisposeListeners.set(n,s)}updateAttributes(e){const n=e.getAttributes();for(const r of n)r.isStorageBufferAttribute||r.isStorageInstancedBufferAttribute?this.updateAttribute(r,zu.STORAGE):this.updateAttribute(r,zu.VERTEX);const i=this.getIndex(e);i!==null&&this.updateAttribute(i,zu.INDEX);const s=e.geometry.indirect;s!==null&&this.updateAttribute(s,zu.INDIRECT)}updateAttribute(e,n){const i=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,n),this.attributeCall.set(e,i)):this.attributeCall.get(e.data)!==i&&(this.attributes.update(e,n),this.attributeCall.set(e.data,i),this.attributeCall.set(e,i)):this.attributeCall.get(e)!==i&&(this.attributes.update(e,n),this.attributeCall.set(e,i))}getIndirect(e){return e.geometry.indirect}getIndirectOffset(e){return e.geometry.indirectOffset}getIndex(e){const{geometry:n,material:i}=e;let s=n.index;if(i.wireframe===!0){const r=this.wireframes;let o=r.get(n);o===void 0?(o=MK(n),r.set(n,o)):o.version!==nre(n)&&(this.attributes.delete(o),o=MK(n),r.set(n,o)),s=o}return s}dispose(){for(const[e,n]of this._geometryDisposeListeners.entries())e.removeEventListener("dispose",n);this._geometryDisposeListeners.clear()}}class v7e{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,n,i){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=i*(n/3):e.isPoints?this.render.points+=i*n:e.isLineSegments?this.render.lines+=i*(n/2):e.isLine?this.render.lines+=i*(n-1):Rt("WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class are{constructor(e){this.cacheKey=e,this.usedTimes=0}}class _7e extends are{constructor(e,n,i){super(e),this.vertexProgram=n,this.fragmentProgram=i}}class x7e extends are{constructor(e,n){super(e),this.computeProgram=n,this.isComputePipeline=!0}}let b7e=0;class k5{constructor(e,n,i,s=null,r=null){this.id=b7e++,this.code=e,this.stage=n,this.name=i,this.transforms=s,this.attributes=r,this.usedTimes=0}}class S7e extends k0{constructor(e,n){super(),this.backend=e,this.nodes=n,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,n){const{backend:i}=this,s=this.get(e);if(this._needsComputeUpdate(e)){const r=s.pipeline;r&&(r.usedTimes--,r.computeProgram.usedTimes--);const o=this.nodes.getForCompute(e);let l=this.programs.compute.get(o.computeShader);l===void 0&&(r&&r.computeProgram.usedTimes===0&&this._releaseProgram(r.computeProgram),l=new k5(o.computeShader,"compute",e.name,o.transforms,o.nodeAttributes),this.programs.compute.set(o.computeShader,l),i.createProgram(l));const c=this._getComputeCacheKey(e,l);let u=this.caches.get(c);u===void 0&&(r&&r.usedTimes===0&&this._releasePipeline(r),u=this._getComputePipeline(e,l,c,n)),u.usedTimes++,l.usedTimes++,s.version=e.version,s.pipeline=u}return s.pipeline}getForRender(e,n=null){const{backend:i}=this,s=this.get(e);if(this._needsRenderUpdate(e)){const r=s.pipeline;r&&(r.usedTimes--,r.vertexProgram.usedTimes--,r.fragmentProgram.usedTimes--);const o=e.getNodeBuilderState(),l=e.material?e.material.name:"";let c=this.programs.vertex.get(o.vertexShader);c===void 0&&(r&&r.vertexProgram.usedTimes===0&&this._releaseProgram(r.vertexProgram),c=new k5(o.vertexShader,"vertex",l),this.programs.vertex.set(o.vertexShader,c),i.createProgram(c));let u=this.programs.fragment.get(o.fragmentShader);u===void 0&&(r&&r.fragmentProgram.usedTimes===0&&this._releaseProgram(r.fragmentProgram),u=new k5(o.fragmentShader,"fragment",l),this.programs.fragment.set(o.fragmentShader,u),i.createProgram(u));const h=this._getRenderCacheKey(e,c,u);let f=this.caches.get(h);f===void 0?(r&&r.usedTimes===0&&this._releasePipeline(r),f=this._getRenderPipeline(e,c,u,h,n)):e.pipeline=f,f.usedTimes++,c.usedTimes++,u.usedTimes++,s.pipeline=f}return s.pipeline}delete(e){const n=this.get(e).pipeline;return n&&(n.usedTimes--,n.usedTimes===0&&this._releasePipeline(n),n.isComputePipeline?(n.computeProgram.usedTimes--,n.computeProgram.usedTimes===0&&this._releaseProgram(n.computeProgram)):(n.fragmentProgram.usedTimes--,n.vertexProgram.usedTimes--,n.vertexProgram.usedTimes===0&&this._releaseProgram(n.vertexProgram),n.fragmentProgram.usedTimes===0&&this._releaseProgram(n.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,n,i,s){i=i||this._getComputeCacheKey(e,n);let r=this.caches.get(i);return r===void 0&&(r=new x7e(i,n),this.caches.set(i,r),this.backend.createComputePipeline(r,s)),r}_getRenderPipeline(e,n,i,s,r){s=s||this._getRenderCacheKey(e,n,i);let o=this.caches.get(s);return o===void 0&&(o=new _7e(s,n,i),this.caches.set(s,o),e.pipeline=o,this.backend.createRenderPipeline(e,r)),o}_getComputeCacheKey(e,n){return e.id+","+n.id}_getRenderCacheKey(e,n,i){return n.id+","+i.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const n=e.code,i=e.stage;this.programs[i].delete(n)}_needsComputeUpdate(e){const n=this.get(e);return n.pipeline===void 0||n.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class T7e extends k0{constructor(e,n,i,s,r,o){super(),this.backend=e,this.textures=i,this.pipelines=r,this.attributes=s,this.nodes=n,this.info=o,this.pipelines.bindings=this}getForRender(e){const n=e.getBindings();for(const i of n){const s=this.get(i);s.bindGroup===void 0&&(this._init(i),this.backend.createBindings(i,n,0),s.bindGroup=i)}return n}getForCompute(e){const n=this.nodes.getForCompute(e).bindings;for(const i of n){const s=this.get(i);s.bindGroup===void 0&&(this._init(i),this.backend.createBindings(i,n,0),s.bindGroup=i)}return n}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}deleteForCompute(e){const n=this.nodes.getForCompute(e).bindings;for(const i of n)this.backend.deleteBindGroupData(i),this.delete(i)}deleteForRender(e){const n=e.getBindings();for(const i of n)this.backend.deleteBindGroupData(i),this.delete(i)}_updateBindings(e){for(const n of e)this._update(n,e)}_init(e){for(const n of e.bindings)if(n.isSampledTexture)this.textures.updateTexture(n.texture);else if(n.isSampler)this.textures.updateSampler(n.texture);else if(n.isStorageBuffer){const i=n.attribute,s=i.isIndirectStorageBufferAttribute?zu.INDIRECT:zu.STORAGE;this.attributes.update(i,s)}}_update(e,n){const{backend:i}=this;let s=!1,r=!0,o=0,l=0;for(const c of e.bindings)if(this.nodes.updateGroup(c)!==!1){if(c.isStorageBuffer){const h=c.attribute,f=h.isIndirectStorageBufferAttribute?zu.INDIRECT:zu.STORAGE;this.attributes.update(h,f)}if(c.isUniformBuffer)c.update()&&i.updateBinding(c);else if(c.isSampledTexture){const h=c.update(),f=c.texture,m=this.textures.get(f);if(h&&(this.textures.updateTexture(f),c.generation!==m.generation&&(c.generation=m.generation,s=!0,r=!1)),i.get(f).externalTexture!==void 0||m.isDefaultTexture?r=!1:(o=o*10+f.id,l+=f.version),f.isStorageTexture===!0&&f.mipmapsAutoUpdate===!0){const x=this.get(f);c.store===!0?x.needsMipmap=!0:this.textures.needsMipmaps(f)&&x.needsMipmap===!0&&(this.backend.generateMipmaps(f),x.needsMipmap=!1)}}else if(c.isSampler&&c.update()){const f=this.textures.updateSampler(c.texture);c.samplerKey!==f&&(c.samplerKey=f,s=!0,r=!1)}}s===!0&&this.backend.updateBindings(e,n,r?o:0,l)}}function w7e(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.z!==e.z?a.z-e.z:a.id-e.id}function CK(a,e){return a.groupOrder!==e.groupOrder?a.groupOrder-e.groupOrder:a.renderOrder!==e.renderOrder?a.renderOrder-e.renderOrder:a.z!==e.z?e.z-a.z:a.id-e.id}function NK(a){return(a.transmission>0||a.transmissionNode&&a.transmissionNode.isNode)&&a.side===er&&a.forceSinglePass===!1}class E7e{constructor(e,n,i){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(n,i),this.lightsArray=[],this.scene=n,this.camera=i,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,n,i,s,r,o,l){let c=this.renderItems[this.renderItemsIndex];return c===void 0?(c={id:e.id,object:e,geometry:n,material:i,groupOrder:s,renderOrder:e.renderOrder,z:r,group:o,clippingContext:l},this.renderItems[this.renderItemsIndex]=c):(c.id=e.id,c.object=e,c.geometry=n,c.material=i,c.groupOrder=s,c.renderOrder=e.renderOrder,c.z=r,c.group=o,c.clippingContext=l),this.renderItemsIndex++,c}push(e,n,i,s,r,o,l){const c=this.getNextRenderItem(e,n,i,s,r,o,l);e.occlusionTest===!0&&this.occlusionQueryCount++,i.transparent===!0||i.transmission>0||i.transmissionNode&&i.transmissionNode.isNode||i.backdropNode&&i.backdropNode.isNode?(NK(i)&&this.transparentDoublePass.push(c),this.transparent.push(c)):this.opaque.push(c)}unshift(e,n,i,s,r,o,l){const c=this.getNextRenderItem(e,n,i,s,r,o,l);i.transparent===!0||i.transmission>0||i.transmissionNode&&i.transmissionNode.isNode||i.backdropNode&&i.backdropNode.isNode?(NK(i)&&this.transparentDoublePass.unshift(c),this.transparent.unshift(c)):this.opaque.unshift(c)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,n){this.opaque.length>1&&this.opaque.sort(e||w7e),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(n||CK),this.transparent.length>1&&this.transparent.sort(n||CK)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,n=this.renderItems.length;e<n;e++){const i=this.renderItems[e];if(i.id===null)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.groupOrder=null,i.renderOrder=null,i.z=null,i.group=null,i.clippingContext=null}}}const h2=[];class M7e{constructor(e){this.lighting=e,this.lists=new Jd}get(e,n){const i=this.lists;h2[0]=e,h2[1]=n;let s=i.get(h2);return s===void 0&&(s=new E7e(this.lighting,e,n),i.set(h2,s)),h2.length=0,s}dispose(){this.lists=new Jd}}let C7e=0;class N7e{constructor(){this.id=C7e++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new qn,this.scissor=!1,this.scissorValue=new qn,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return ire(this)}}function ire(a){const{textures:e,activeCubeFace:n,activeMipmapLevel:i}=a,s=[n,i];for(const r of e)s.push(r.id);return Hx(s)}const Ov=[],R7e=new Vx,P7e=new u1;class I7e{constructor(){this.chainMaps={}}get(e,n,i=null,s=null){Ov[0]=e,Ov[1]=n,s!==null&&(Ov[2]=s);let r;if(i===null)r="default";else{const c=i.texture.format;r=`${i.textures.length}:${c}:${i.samples}:${i.depthBuffer}:${i.stencilBuffer}`}const o=this._getChainMap(r);let l=o.get(Ov);return l===void 0&&(l=new N7e,o.set(Ov,l)),Ov.length=0,i!==null&&(l.sampleCount=i.samples===0?1:i.samples),l}getForClear(e=null){return this.get(R7e,P7e,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new Jd)}dispose(){this.chainMaps={}}}const L7e=new ye;class D7e extends k0{constructor(e,n,i){super(),this.renderer=e,this.backend=n,this.info=i}updateRenderTarget(e,n=0){const i=this.get(e),s=e.samples===0?1:e.samples,r=i.depthTextureMips||(i.depthTextureMips={}),o=e.textures,l=this.getSize(o[0]),c=l.width>>n,u=l.height>>n;let h=e.depthTexture||r[n];const f=e.depthBuffer===!0||e.stencilBuffer===!0;let m=!1;h===void 0&&f&&(h=new Do,h.format=e.stencilBuffer?rl:ho,h.type=e.stencilBuffer?yc:Ei,h.image.width=c,h.image.height=u,h.image.depth=l.depth,h.renderTarget=e,h.isArrayTexture=e.multiview===!0&&l.depth>1,r[n]=h),(i.width!==l.width||l.height!==i.height)&&(m=!0,h&&(h.needsUpdate=!0,h.image.width=c,h.image.height=u,h.image.depth=h.isArrayTexture?h.image.depth:1)),i.width=l.width,i.height=l.height,i.textures=o,i.depthTexture=h||null,i.depth=e.depthBuffer,i.stencil=e.stencilBuffer,i.renderTarget=e,i.sampleCount!==s&&(m=!0,h&&(h.needsUpdate=!0),i.sampleCount=s);const A={sampleCount:s};if(e.isXRRenderTarget!==!0){for(let x=0;x<o.length;x++){const T=o[x];m&&(T.needsUpdate=!0),this.updateTexture(T,A)}h&&this.updateTexture(h,A)}i.initialized!==!0&&(i.initialized=!0,i.onDispose=()=>{this._destroyRenderTarget(e)},e.addEventListener("dispose",i.onDispose))}updateTexture(e,n={}){const i=this.get(e);if(i.initialized===!0&&i.version===e.version)return;const s=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,r=this.backend;if(s&&i.initialized===!0&&r.destroyTexture(e),e.isFramebufferTexture){const u=this.renderer.getRenderTarget();u?e.type=u.texture.type:e.type=os}const{width:o,height:l,depth:c}=this.getSize(e);if(n.width=o,n.height=l,n.depth=c,n.needsMipmaps=this.needsMipmaps(e),n.levels=n.needsMipmaps?this.getMipLevels(e,o,l):1,e.isCubeTexture&&e.mipmaps.length>0&&n.levels++,s||e.isStorageTexture===!0||e.isExternalTexture===!0)r.createTexture(e,n),i.generation=e.version;else if(e.version>0){const u=e.image;if(u===void 0)yt("Renderer: Texture marked for update but image is undefined.");else if(u.complete===!1)yt("Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const f=[];for(const m of e.images)f.push(m);n.images=f}else n.image=u;(i.isDefaultTexture===void 0||i.isDefaultTexture===!0)&&(r.createTexture(e,n),i.isDefaultTexture=!1,i.generation=e.version),e.source.dataReady===!0&&r.updateTexture(e,n);const h=e.isStorageTexture===!0&&e.mipmapsAutoUpdate===!1;n.needsMipmaps&&e.mipmaps.length===0&&!h&&r.generateMipmaps(e),e.onUpdate&&e.onUpdate(e)}}else r.createDefaultTexture(e),i.isDefaultTexture=!0,i.generation=e.version;i.initialized!==!0&&(i.initialized=!0,i.generation=e.version,this.info.memory.textures++,e.isVideoTexture&&Vn.enabled===!0&&Vn.getTransfer(e.colorSpace)!==An&&yt("WebGPURenderer: Video textures must use a color space with a sRGB transfer function, e.g. SRGBColorSpace."),i.onDispose=()=>{this._destroyTexture(e)},e.addEventListener("dispose",i.onDispose)),i.version=e.version}updateSampler(e){return this.backend.updateSampler(e)}getSize(e,n=L7e){let i=e.images?e.images[0]:e.image;return i?(i.image!==void 0&&(i=i.image),typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement?(n.width=i.videoWidth||1,n.height=i.videoHeight||1,n.depth=1):typeof VideoFrame<"u"&&i instanceof VideoFrame?(n.width=i.displayWidth||1,n.height=i.displayHeight||1,n.depth=1):(n.width=i.width||1,n.height=i.height||1,n.depth=e.isCubeTexture?6:i.depth||1)):n.width=n.height=n.depth=1,n}getMipLevels(e,n,i){let s;return e.mipmaps.length>0?s=e.mipmaps.length:e.isCompressedTexture===!0?s=1:s=Math.floor(Math.log2(Math.max(n,i)))+1,s}needsMipmaps(e){return e.generateMipmaps===!0||e.mipmaps.length>0}_destroyRenderTarget(e){if(this.has(e)===!0){const n=this.get(e),i=n.textures,s=n.depthTexture;e.removeEventListener("dispose",n.onDispose);for(let r=0;r<i.length;r++)this._destroyTexture(i[r]);s&&this._destroyTexture(s),this.delete(e),this.backend.delete(e)}}_destroyTexture(e){if(this.has(e)===!0){const n=this.get(e);e.removeEventListener("dispose",n.onDispose);const i=n.isDefaultTexture;this.backend.destroyTexture(e,i),this.delete(e),this.info.memory.textures--}}}class y7 extends on{constructor(e,n,i,s=1){super(e,n,i),this.a=s}set(e,n,i,s=1){return this.a=s,super.set(e,n,i)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class sre extends Si{static get type(){return"ParameterNode"}constructor(e,n=null){super(e,n),this.isParameterNode=!0}getMemberType(e,n){const i=this.getNodeType(e),s=e.getStructTypeNode(i);let r;return s!==null?r=s.getMemberType(e,n):(Rt(`TSL: Member "${n}" not found in struct "${i}".`),r="float"),r}getHash(){return this.uuid}generate(){return this.name}}const k7e=(a,e)=>new sre(a,e);class O7e extends yn{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this._currentNode=null,this.isStackNode=!0}getElementType(e){return this.hasOutput?this.outputNode.getElementType(e):"void"}getNodeType(e){return this.hasOutput?this.outputNode.getNodeType(e):"void"}getMemberType(e,n){return this.hasOutput?this.outputNode.getMemberType(e,n):"void"}addToStack(e,n=this.nodes.length){return e.isNode!==!0?(Rt("TSL: Invalid node added to stack."),this):(this.nodes.splice(n,0,e),this)}addToStackBefore(e){const n=this._currentNode?this.nodes.indexOf(this._currentNode):0;return this.addToStack(e,n)}If(e,n){const i=new c_(n);return this._currentCond=Io(e,i),this.addToStack(this._currentCond)}ElseIf(e,n){const i=new c_(n),s=Io(e,i);return this._currentCond.elseNode=s,this._currentCond=s,this}Else(e){return this._currentCond.elseNode=new c_(e),this}Switch(e){return this._expressionNode=rn(e),this}Case(...e){const n=[];if(e.length>=2)for(let l=0;l<e.length-1;l++)n.push(this._expressionNode.equal(rn(e[l])));else Rt("TSL: Invalid parameter length. Case() requires at least two parameters.");const i=e[e.length-1],s=new c_(i);let r=n[0];for(let l=1;l<n.length;l++)r=r.or(n[l]);const o=Io(r,s);return this._currentCond===null?(this._currentCond=o,this.addToStack(this._currentCond)):(this._currentCond.elseNode=o,this._currentCond=o,this)}Default(e){return this.Else(e),this}setup(e){const n=e.getNodeProperties(this);let i=0;for(const s of this.getChildren())s.isVarNode&&s.isIntent(e)&&s.isAssign(e)!==!0||(n["node"+i++]=s);return n.outputNode||null}get hasOutput(){return this.outputNode&&this.outputNode.isNode}build(e,...n){const i=pB(),s=e.buildStage;cT(this),e.setActiveStack(this);const r=u=>{if(this._currentNode=u,!(u.isVarNode&&u.isIntent(e)&&u.isAssign(e)!==!0)){if(s==="setup")u.build(e);else if(s==="analyze")u.build(e,this);else if(s==="generate"){const h=e.getDataFromNode(u,"any").stages,f=h&&h[e.shaderStage];if(u.isVarNode&&f&&f.length===1&&f[0]&&f[0].isStackNode)return;u.build(e,"void")}}},o=[...this.nodes];for(const u of o)r(u);this._currentNode=null;const l=this.nodes.filter(u=>o.indexOf(u)===-1);for(const u of l)r(u);let c;return this.hasOutput?c=this.outputNode.build(e,...n):c=super.build(e,...n),cT(i),e.removeActiveStack(this),c}}const c3=sa(O7e).setParameterLength(0,1);function F7e(a){return Object.entries(a).map(([e,n])=>typeof n=="string"?{name:e,type:n,atomic:!1}:{name:e,type:n.type,atomic:n.atomic||!1})}class j7e extends yn{static get type(){return"StructTypeNode"}constructor(e,n=null){super("struct"),this.membersLayout=F7e(e),this.name=n,this.isStructLayoutNode=!0}getLength(){const e=Float32Array.BYTES_PER_ELEMENT;let n=1,i=0;for(const s of this.membersLayout){const r=s.type,o=s8e(r),l=r8e(r)/e;n=Math.max(n,l);const u=i%n%l;u!==0&&(i+=l-u),i+=o}return Math.ceil(i/n)*n}getMemberType(e,n){const i=this.membersLayout.find(s=>s.name===n);return i?i.type:"void"}getNodeType(e){return e.getStructTypeFromNode(this,this.membersLayout,this.name).name}setup(e){e.getStructTypeFromNode(this,this.membersLayout,this.name),e.addInclude(this)}generate(e){return this.getNodeType(e)}}class B7e extends yn{static get type(){return"StructNode"}constructor(e,n){super("vec3"),this.structTypeNode=e,this.values=n,this.isStructNode=!0}getNodeType(e){return this.structTypeNode.getNodeType(e)}getMemberType(e,n){return this.structTypeNode.getMemberType(e,n)}generate(e){const n=e.getVarFromNode(this),i=n.type,s=e.getPropertyName(n);return e.addLineFlowCode(`${s} = ${e.generateStruct(i,this.structTypeNode.membersLayout,this.values)}`,this),n.name}}const U7e=(a,e=null)=>{const n=new j7e(a,e),i=(...s)=>{let r=null;if(s.length>0)if(s[0].isNode){r={};const o=Object.keys(a);for(let l=0;l<s.length;l++)r[o[l]]=s[l]}else r=s[0];return new B7e(n,r)};return i.layout=n,i.isStruct=!0,i};class rre extends yn{static get type(){return"OutputStructNode"}constructor(...e){super(),this.members=e,this.isOutputStructNode=!0}getNodeType(e){const n=e.getNodeProperties(this);if(n.membersLayout===void 0){const i=this.members,s=[];for(let r=0;r<i.length;r++){const o="m"+r,l=i[r].getNodeType(e);s.push({name:o,type:l,index:r})}n.membersLayout=s,n.structType=e.getOutputStructTypeFromNode(this,n.membersLayout)}return n.structType.name}generate(e){const n=e.getOutputStructName(),i=this.members,s=n!==""?n+".":"";for(let r=0;r<i.length;r++){const o=i[r].build(e);e.addLineFlowCode(`${s}m${r} = ${o}`,this)}return n}}const V7e=sa(rre);function ore(a,e){for(let n=0;n<a.length;n++)if(a[n].name===e)return n;return-1}class z7e extends rre{static get type(){return"MRTNode"}constructor(e){super(),this.outputNodes=e,this.isMRTNode=!0}has(e){return this.outputNodes[e]!==void 0}get(e){return this.outputNodes[e]}merge(e){const n={...this.outputNodes,...e.outputNodes};return lre(n)}setup(e){const n=this.outputNodes,i=e.renderer.getRenderTarget(),s=[],r=i.textures;for(const o in n){const l=ore(r,o);s[l]=On(n[o])}return this.members=s,super.setup(e)}}const lre=sa(z7e);class Aw extends Rs{static get type(){return"BitcastNode"}constructor(e,n,i=null){super(),this.valueNode=e,this.conversionType=n,this.inputType=i,this.isBitcastNode=!0}getNodeType(e){if(this.inputType!==null){const n=this.valueNode.getNodeType(e),i=e.getTypeLength(n);return e.getTypeFromLength(i,this.conversionType)}return this.conversionType}generate(e){const n=this.getNodeType(e);let i="";if(this.inputType!==null){const s=this.valueNode.getNodeType(e);i=e.getTypeLength(s)===1?this.inputType:e.changeComponentType(s,this.inputType)}else i=this.valueNode.getNodeType(e);return`${e.getBitcastMethod(n,i)}( ${this.valueNode.build(e,i)} )`}}const cre=Zt(Aw).setParameterLength(2),G7e=a=>new Aw(a,"int","float"),ure=a=>new Aw(a,"uint","float"),q7e=a=>new Aw(a,"float","int"),H7e=a=>new Aw(a,"float","uint"),XM={};class uu extends ft{static get type(){return"BitcountNode"}constructor(e,n){super(e,n),this.isBitcountNode=!0}_resolveElementType(e,n,i){i==="int"?n.assign(cre(e,"uint")):n.assign(e)}_returnDataNode(e){switch(e){case"uint":return qt;case"int":return Be;case"uvec2":return mB;case"uvec3":return A1;case"uvec4":return vB;case"ivec2":return yr;case"ivec3":return gB;case"ivec4":return yB}}_createTrailingZerosBaseLayout(e,n){const i=this._returnDataNode(n);return Ye(([r])=>{const o=qt(0);this._resolveElementType(r,o,n);const l=Re(o.bitAnd(IB(o))),u=ure(l).shiftRight(23).sub(127);return i(u)}).setLayout({name:e,type:n,inputs:[{name:"value",type:n}]})}_createLeadingZerosBaseLayout(e,n){const i=this._returnDataNode(n);return Ye(([r])=>{kn(r.equal(qt(0)),()=>qt(32));const o=qt(0),l=qt(0);return this._resolveElementType(r,o,n),kn(o.shiftRight(16).equal(0),()=>{l.addAssign(16),o.shiftLeftAssign(16)}),kn(o.shiftRight(24).equal(0),()=>{l.addAssign(8),o.shiftLeftAssign(8)}),kn(o.shiftRight(28).equal(0),()=>{l.addAssign(4),o.shiftLeftAssign(4)}),kn(o.shiftRight(30).equal(0),()=>{l.addAssign(2),o.shiftLeftAssign(2)}),kn(o.shiftRight(31).equal(0),()=>{l.addAssign(1)}),i(l)}).setLayout({name:e,type:n,inputs:[{name:"value",type:n}]})}_createOneBitsBaseLayout(e,n){const i=this._returnDataNode(n);return Ye(([r])=>{const o=qt(0);this._resolveElementType(r,o,n),o.assign(o.sub(o.shiftRight(qt(1)).bitAnd(qt(1431655765)))),o.assign(o.bitAnd(qt(858993459)).add(o.shiftRight(qt(2)).bitAnd(qt(858993459))));const l=o.add(o.shiftRight(qt(4))).bitAnd(qt(252645135)).mul(qt(16843009)).shiftRight(qt(24));return i(l)}).setLayout({name:e,type:n,inputs:[{name:"value",type:n}]})}_createMainLayout(e,n,i,s){const r=this._returnDataNode(n);return Ye(([l])=>{if(i===1)return r(s(l));{const c=r(0),u=["x","y","z","w"];for(let h=0;h<i;h++){const f=u[h];c[f].assign(s(l[f]))}return c}}).setLayout({name:e,type:n,inputs:[{name:"value",type:n}]})}setup(e){const{method:n,aNode:i}=this,{renderer:s}=e;if(s.backend.isWebGPUBackend)return super.setup(e);const r=this.getInputType(e),o=e.getElementType(r),l=e.getTypeLength(r),c=`${n}_base_${o}`,u=`${n}_${r}`;let h=XM[c];if(h===void 0){switch(n){case uu.COUNT_LEADING_ZEROS:{h=this._createLeadingZerosBaseLayout(c,o);break}case uu.COUNT_TRAILING_ZEROS:{h=this._createTrailingZerosBaseLayout(c,o);break}case uu.COUNT_ONE_BITS:{h=this._createOneBitsBaseLayout(c,o);break}}XM[c]=h}let f=XM[u];return f===void 0&&(f=this._createMainLayout(u,r,l,h),XM[u]=f),Ye(()=>f(i))()}}uu.COUNT_TRAILING_ZEROS="countTrailingZeros";uu.COUNT_LEADING_ZEROS="countLeadingZeros";uu.COUNT_ONE_BITS="countOneBits";const W7e=Zt(uu,uu.COUNT_TRAILING_ZEROS).setParameterLength(1),$7e=Zt(uu,uu.COUNT_LEADING_ZEROS).setParameterLength(1),K7e=Zt(uu,uu.COUNT_ONE_BITS).setParameterLength(1),Y7e=Ye(([a])=>{const e=a.toUint().mul(747796405).add(2891336453),n=e.shiftRight(e.shiftRight(28).add(4)).bitXor(e).mul(277803737);return n.shiftRight(22).bitXor(n).toFloat().mul(1/2**32)}),VO=(a,e)=>Uu(ia(4,a.mul(Ka(1,a))),e),X7e=(a,e)=>a.lessThan(.5)?VO(a.mul(2),e).div(2):Ka(1,VO(ia(Ka(1,a),2),e).div(2)),Q7e=(a,e,n)=>Uu(yu(Uu(a,e),cr(Uu(a,e),Uu(Ka(1,a),n))),1/e),J7e=(a,e)=>Rl(bR.mul(e.mul(a).sub(1))).div(bR.mul(e.mul(a).sub(1)));class v7 extends Rs{static get type(){return"PackFloatNode"}constructor(e,n){super(),this.vectorNode=n,this.encoding=e,this.isPackFloatNode=!0}getNodeType(){return"uint"}generate(e){const n=this.vectorNode.getNodeType(e);return`${e.getFloatPackingMethod(this.encoding)}(${this.vectorNode.build(e,n)})`}}const Z7e=Zt(v7,"snorm").setParameterLength(1),eUe=Zt(v7,"unorm").setParameterLength(1),tUe=Zt(v7,"float16").setParameterLength(1);class _7 extends Rs{static get type(){return"UnpackFloatNode"}constructor(e,n){super(),this.uintNode=n,this.encoding=e,this.isUnpackFloatNode=!0}getNodeType(){return"vec2"}generate(e){const n=this.uintNode.getNodeType(e);return`${e.getFloatUnpackingMethod(this.encoding)}(${this.uintNode.build(e,n)})`}}const nUe=Zt(_7,"snorm").setParameterLength(1),aUe=Zt(_7,"unorm").setParameterLength(1),iUe=Zt(_7,"float16").setParameterLength(1),Gp=Ye(([a])=>a.fract().sub(.5).abs()).setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),sUe=Ye(([a])=>qe(Gp(a.z.add(Gp(a.y.mul(1)))),Gp(a.z.add(Gp(a.x.mul(1)))),Gp(a.y.add(Gp(a.x.mul(1)))))).setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),rUe=Ye(([a,e,n])=>{const i=qe(a).toVar(),s=Re(1.4).toVar(),r=Re(0).toVar(),o=qe(i).toVar();return Li({start:Re(0),end:Re(3),type:"float",condition:"<="},()=>{const l=qe(sUe(o.mul(2))).toVar();i.addAssign(l.add(n.mul(Re(.1).mul(e)))),o.mulAssign(1.8),s.mulAssign(1.5),i.mulAssign(1.2);const c=Re(Gp(i.z.add(Gp(i.x.add(Gp(i.y)))))).toVar();r.addAssign(c.div(s)),o.addAssign(.14)}),r}).setLayout({name:"triNoise3D",type:"float",inputs:[{name:"position",type:"vec3"},{name:"speed",type:"float"},{name:"time",type:"float"}]});class oUe extends yn{static get type(){return"FunctionOverloadingNode"}constructor(e=[],...n){super(),this.functionNodes=e,this.parametersNodes=n,this._candidateFn=null,this.global=!0}getNodeType(e){return this.getCandidateFn(e).shaderNode.layout.type}getCandidateFn(e){const n=this.parametersNodes;let i=this._candidateFn;if(i===null){let s=null,r=-1;for(const o of this.functionNodes){const c=o.shaderNode.layout;if(c===null)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");const u=c.inputs;if(n.length===u.length){let h=0;for(let f=0;f<n.length;f++){const m=n[f],A=u[f];m.getNodeType(e)===A.type&&h++}h>r&&(s=o,r=h)}}this._candidateFn=i=s}return i}setup(e){return this.getCandidateFn(e)(...this.parametersNodes)}}const lUe=sa(oUe),Bo=a=>(...e)=>lUe(a,...e),Kx=Rn(0).setGroup(Nn).onRenderUpdate(a=>a.time),cUe=Rn(0).setGroup(Nn).onRenderUpdate(a=>a.deltaTime),dre=Rn(0,"uint").setGroup(Nn).onRenderUpdate(a=>a.frameId),uUe=(a=Kx)=>a.add(.75).mul(Math.PI*2).sin().mul(.5).add(.5),dUe=(a=Kx)=>a.fract().round(),hUe=(a=Kx)=>a.add(.5).fract().mul(2).sub(1).abs(),fUe=(a=Kx)=>a.fract();function pUe(a,e=null){return Dm(e,{getUV:a})}const mUe=Ye(([a,e,n=Qt(.5)])=>gw(a.sub(n),e).add(n)),gUe=Ye(([a,e,n=Qt(.5)])=>{const i=a.sub(n),s=i.dot(i),o=s.mul(s).mul(e);return a.add(i.mul(o))}),AUe=Ye(({position:a=null,horizontal:e=!0,vertical:n=!1})=>{let i;a!==null?(i=Vu.toVar(),i[3][0]=a.x,i[3][1]=a.y,i[3][2]=a.z):i=Vu;const s=ad.mul(i);return lT(e)&&(s[0][0]=Vu[0].length(),s[0][1]=0,s[0][2]=0),lT(n)&&(s[1][0]=0,s[1][1]=Vu[1].length(),s[1][2]=0),s[2][0]=0,s[2][1]=0,s[2][2]=1,om.mul(s).mul(Es)}),yUe=Ye(([a=null])=>{const e=wR();return wR(l7(a)).sub(e).lessThan(0).select(rm,a)});class vUe extends yn{static get type(){return"SpriteSheetUVNode"}constructor(e,n=Vi(),i=Re(0)){super("vec2"),this.countNode=e,this.uvNode=n,this.frameNode=i}setup(){const{frameNode:e,uvNode:n,countNode:i}=this,{width:s,height:r}=i,o=e.mod(s.mul(r)).floor(),l=o.mod(s),c=r.sub(o.add(1).div(s).ceil()),u=i.reciprocal(),h=Qt(l,c);return n.add(h).mul(u)}}const _Ue=sa(vUe).setParameterLength(3),hre=Ye(([a,e=null,n=null,i=Re(1),s=Es,r=wc])=>{let o=r.abs().normalize();o=o.div(o.dot(qe(1)));const l=s.yz.mul(i),c=s.zx.mul(i),u=s.xy.mul(i),h=a.value,f=e!==null?e.value:h,m=n!==null?n.value:h,A=hi(h,l).mul(o.x),x=hi(f,c).mul(o.y),T=hi(m,u).mul(o.z);return cr(A,x,T)}),xUe=(...a)=>hre(...a),Fv=new Nd,_A=new ye,jv=new ye,O5=new ye,f2=new _n,QM=new ye(0,0,-1),Ch=new qn,p2=new ye,JM=new ye,m2=new qn,ZM=new Nt,MR=new th,bUe=rm.flipX();MR.depthTexture=new Do(1,1);let eC=!1;class x7 extends qf{static get type(){return"ReflectorNode"}constructor(e={}){super(e.defaultTexture||MR.texture,bUe),this._reflectorBaseNode=e.reflector||new SUe(this,e),this._depthNode=null,this.setUpdateMatrix(!1)}get reflector(){return this._reflectorBaseNode}get target(){return this._reflectorBaseNode.target}getDepthNode(){if(this._depthNode===null){if(this._reflectorBaseNode.depth!==!0)throw new Error("THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ");this._depthNode=rn(new x7({defaultTexture:MR.depthTexture,reflector:this._reflectorBaseNode}))}return this._depthNode}setup(e){return e.object.isQuadMesh||this._reflectorBaseNode.build(e),super.setup(e)}clone(){const e=new this.constructor(this.reflectorNode);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e._reflectorBaseNode=this._reflectorBaseNode,e}dispose(){super.dispose(),this._reflectorBaseNode.dispose()}}class SUe extends yn{static get type(){return"ReflectorBaseNode"}constructor(e,n={}){super();const{target:i=new ni,resolutionScale:s=1,generateMipmaps:r=!1,bounces:o=!0,depth:l=!1,samples:c=0}=n;this.textureNode=e,this.target=i,this.resolutionScale=s,n.resolution!==void 0&&(ji('ReflectorNode: The "resolution" parameter has been renamed to "resolutionScale".'),this.resolutionScale=n.resolution),this.generateMipmaps=r,this.bounces=o,this.depth=l,this.samples=c,this.updateBeforeType=o?fa.RENDER:fa.FRAME,this.virtualCameras=new WeakMap,this.renderTargets=new Map,this.forceUpdate=!1,this.hasOutput=!1}_updateResolution(e,n){const i=this.resolutionScale;n.getDrawingBufferSize(ZM),e.setSize(Math.round(ZM.width*i),Math.round(ZM.height*i))}setup(e){return this._updateResolution(MR,e.renderer),super.setup(e)}dispose(){super.dispose();for(const e of this.renderTargets.values())e.dispose()}getVirtualCamera(e){let n=this.virtualCameras.get(e);return n===void 0&&(n=e.clone(),this.virtualCameras.set(e,n)),n}getRenderTarget(e){let n=this.renderTargets.get(e);return n===void 0&&(n=new th(0,0,{type:cs,samples:this.samples}),this.generateMipmaps===!0&&(n.texture.minFilter=ZZ,n.texture.generateMipmaps=!0),this.depth===!0&&(n.depthTexture=new Do),this.renderTargets.set(e,n)),n}updateBefore(e){if(this.bounces===!1&&eC)return!1;eC=!0;const{scene:n,camera:i,renderer:s,material:r}=e,{target:o}=this,l=this.getVirtualCamera(i),c=this.getRenderTarget(l);s.getDrawingBufferSize(ZM),this._updateResolution(c,s),jv.setFromMatrixPosition(o.matrixWorld),O5.setFromMatrixPosition(i.matrixWorld),f2.extractRotation(o.matrixWorld),_A.set(0,0,1),_A.applyMatrix4(f2),p2.subVectors(jv,O5);const u=p2.dot(_A)>0;let h=!1;if(u===!0&&this.forceUpdate===!1){if(this.hasOutput===!1){eC=!1;return}h=!0}p2.reflect(_A).negate(),p2.add(jv),f2.extractRotation(i.matrixWorld),QM.set(0,0,-1),QM.applyMatrix4(f2),QM.add(O5),JM.subVectors(jv,QM),JM.reflect(_A).negate(),JM.add(jv),l.coordinateSystem=i.coordinateSystem,l.position.copy(p2),l.up.set(0,1,0),l.up.applyMatrix4(f2),l.up.reflect(_A),l.lookAt(JM),l.near=i.near,l.far=i.far,l.updateMatrixWorld(),l.projectionMatrix.copy(i.projectionMatrix),Fv.setFromNormalAndCoplanarPoint(_A,jv),Fv.applyMatrix4(l.matrixWorldInverse),Ch.set(Fv.normal.x,Fv.normal.y,Fv.normal.z,Fv.constant);const f=l.projectionMatrix;m2.x=(Math.sign(Ch.x)+f.elements[8])/f.elements[0],m2.y=(Math.sign(Ch.y)+f.elements[9])/f.elements[5],m2.z=-1,m2.w=(1+f.elements[10])/f.elements[14],Ch.multiplyScalar(1/Ch.dot(m2));const m=0;f.elements[2]=Ch.x,f.elements[6]=Ch.y,f.elements[10]=s.coordinateSystem===bc?Ch.z-m:Ch.z+1-m,f.elements[14]=Ch.w,this.textureNode.value=c.texture,this.depth===!0&&(this.textureNode.getDepthNode().value=c.depthTexture),r.visible=!1;const A=s.getRenderTarget(),x=s.getMRT(),T=s.autoClear;s.setMRT(null),s.setRenderTarget(c),s.autoClear=!0;const E=n.name;n.name=(n.name||"Scene")+" [ Reflector ]",h?(s.clear(),this.hasOutput=!1):(s.render(n,l),this.hasOutput=!0),n.name=E,s.setMRT(x),s.setRenderTarget(A),s.autoClear=T,r.visible=!0,eC=!1,this.forceUpdate=!1}get resolution(){return ji('ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale}set resolution(e){ji('ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale=e}}const TUe=a=>new x7(a),F5=new P0(-1,1,1,-1,0,1);class wUe extends zn{constructor(e=!1){super();const n=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new mn([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new mn(n,2))}}const EUe=new wUe;class J4 extends Na{constructor(e=null){super(EUe,e),this.camera=F5,this.isQuadMesh=!0}async renderAsync(e){ji('QuadMesh: "renderAsync()" has been deprecated. Use "render()" and "await renderer.init();" when creating the renderer.'),await e.init(),e.render(this,F5)}render(e){e.render(this,F5)}}const MUe=new Nt;class CUe extends qf{static get type(){return"RTTNode"}constructor(e,n=null,i=null,s={type:cs}){const r=new th(n,i,s);super(r.texture,Vi()),this.isRTTNode=!0,this.node=e,this.width=n,this.height=i,this.pixelRatio=1,this.renderTarget=r,this.textureNeedsUpdate=!0,this.autoUpdate=!0,this._rttNode=null,this._quadMesh=new J4(new zs),this.updateBeforeType=fa.RENDER}get autoResize(){return this.width===null}setup(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,super.setup(e)}setSize(e,n){this.width=e,this.height=n;const i=e*this.pixelRatio,s=n*this.pixelRatio;this.renderTarget.setSize(i,s),this.textureNeedsUpdate=!0}setPixelRatio(e){this.pixelRatio=e,this.setSize(this.width,this.height)}updateBefore({renderer:e}){if(this.textureNeedsUpdate===!1&&this.autoUpdate===!1)return;if(this.textureNeedsUpdate=!1,this.autoResize===!0){const s=e.getPixelRatio(),r=e.getSize(MUe),o=Math.floor(r.width*s),l=Math.floor(r.height*s);(o!==this.renderTarget.width||l!==this.renderTarget.height)&&(this.renderTarget.setSize(o,l),this.textureNeedsUpdate=!0)}let n="RTT";this.node.name&&(n=this.node.name+" [ "+n+" ]"),this._quadMesh.material.fragmentNode=this._rttNode,this._quadMesh.name=n;const i=e.getRenderTarget();e.setRenderTarget(this.renderTarget),this._quadMesh.render(e),e.setRenderTarget(i)}clone(){const e=new qf(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}}const fre=(a,...e)=>rn(new CUe(rn(a),...e)),NUe=(a,...e)=>a.isSampleNode||a.isTextureNode?a:a.isPassNode?a.getTextureNode():fre(a,...e),t_=Ye(([a,e,n],i)=>{let s;i.renderer.coordinateSystem===bc?(a=Qt(a.x,a.y.oneMinus()).mul(2).sub(1),s=On(qe(a,e),1)):s=On(qe(a.x,a.y.oneMinus(),e).mul(2).sub(1),1);const r=On(n.mul(s));return r.xyz.div(r.w)}),RUe=Ye(([a,e])=>{const n=e.mul(On(a,1)),i=n.xy.div(n.w).mul(.5).add(.5).toVar();return Qt(i.x,i.y.oneMinus())}),PUe=Ye(([a,e,n])=>{const i=sm(Os(e)),s=yr(a.mul(i)).toVar(),r=Os(e,s).toVar(),o=Os(e,s.sub(yr(2,0))).toVar(),l=Os(e,s.sub(yr(1,0))).toVar(),c=Os(e,s.add(yr(1,0))).toVar(),u=Os(e,s.add(yr(2,0))).toVar(),h=Os(e,s.add(yr(0,2))).toVar(),f=Os(e,s.add(yr(0,1))).toVar(),m=Os(e,s.sub(yr(0,1))).toVar(),A=Os(e,s.sub(yr(0,2))).toVar(),x=Ji(Ka(Re(2).mul(l).sub(o),r)).toVar(),T=Ji(Ka(Re(2).mul(c).sub(u),r)).toVar(),E=Ji(Ka(Re(2).mul(f).sub(h),r)).toVar(),M=Ji(Ka(Re(2).mul(m).sub(A),r)).toVar(),N=t_(a,r,n).toVar(),I=x.lessThan(T).select(N.sub(t_(a.sub(Qt(Re(1).div(i.x),0)),l,n)),N.negate().add(t_(a.add(Qt(Re(1).div(i.x),0)),c,n))),F=E.lessThan(M).select(N.sub(t_(a.add(Qt(0,Re(1).div(i.y))),f,n)),N.negate().add(t_(a.sub(Qt(0,Re(1).div(i.y))),m,n)));return Fl(Mm(I,F))}),b7=Ye(([a])=>Yd(Re(52.9829189).mul(Yd(Yu(a,Qt(.06711056,.00583715)))))).setLayout({name:"interleavedGradientNoise",type:"float",inputs:[{name:"position",type:"vec2"}]}),Id=Ye(([a,e,n])=>{const i=Re(2.399963229728653),s=cl(Re(a).add(.5).div(Re(e))),r=Re(a).mul(i).add(n);return Qt(Rd(r),Rl(r)).mul(s)}).setLayout({name:"vogelDiskSample",type:"vec2",inputs:[{name:"sampleIndex",type:"int"},{name:"samplesCount",type:"int"},{name:"phi",type:"float"}]});class IUe extends yn{static get type(){return"SampleNode"}constructor(e,n=null){super(),this.callback=e,this.uvNode=n,this.isSampleNode=!0}setup(){return this.sample(Vi())}sample(e){return this.callback(e)}}const LUe=(a,e=null)=>new IUe(a,rn(e));class mc extends yn{static get type(){return"EventNode"}constructor(e,n){super("void"),this.eventType=e,this.callback=n,e===mc.OBJECT?this.updateType=fa.OBJECT:e===mc.MATERIAL?this.updateType=fa.RENDER:e===mc.BEFORE_OBJECT?this.updateBeforeType=fa.OBJECT:e===mc.BEFORE_MATERIAL&&(this.updateBeforeType=fa.RENDER)}update(e){this.callback(e)}updateBefore(e){this.callback(e)}}mc.OBJECT="object";mc.MATERIAL="material";mc.BEFORE_OBJECT="beforeObject";mc.BEFORE_MATERIAL="beforeMaterial";const Z4=(a,e)=>new mc(a,e).toStack(),DUe=a=>Z4(mc.OBJECT,a),kUe=a=>Z4(mc.MATERIAL,a),OUe=a=>Z4(mc.BEFORE_OBJECT,a),FUe=a=>Z4(mc.BEFORE_MATERIAL,a);class u3 extends _c{constructor(e,n,i=Float32Array){const s=ArrayBuffer.isView(e)?e:new i(e*n);super(s,n),this.isStorageInstancedBufferAttribute=!0}}class jUe extends Ua{constructor(e,n,i=Float32Array){const s=ArrayBuffer.isView(e)?e:new i(e*n);super(s,n),this.isStorageBufferAttribute=!0}}const BUe=(a,e="float")=>{let n,i;e.isStruct===!0?(n=e.layout.getLength(),i=mR("float")):(n=Nne(e),i=mR(e));const s=new jUe(a,n,i);return lm(s,e,a)},UUe=(a,e="float")=>{let n,i;e.isStruct===!0?(n=e.layout.getLength(),i=mR("float")):(n=Nne(e),i=mR(e));const s=new u3(a,n,i);return lm(s,e,a)};class VUe extends yn{static get type(){return"PointUVNode"}constructor(){super("vec2"),this.isPointUVNode=!0}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}const zUe=sn(VUe),g2=new fo,j5=new _n;class gc extends yn{static get type(){return"SceneNode"}constructor(e=gc.BACKGROUND_BLURRINESS,n=null){super(),this.scope=e,this.scene=n}setup(e){const n=this.scope,i=this.scene!==null?this.scene:e.scene;let s;return n===gc.BACKGROUND_BLURRINESS?s=Bi("backgroundBlurriness","float",i):n===gc.BACKGROUND_INTENSITY?s=Bi("backgroundIntensity","float",i):n===gc.BACKGROUND_ROTATION?s=Rn("mat4").setName("backgroundRotation").setGroup(Nn).onRenderUpdate(()=>{const r=i.background;return r!==null&&r.isTexture&&r.mapping!==GT?(g2.copy(i.backgroundRotation),g2.x*=-1,g2.y*=-1,g2.z*=-1,j5.makeRotationFromEuler(g2)):j5.identity(),j5}):Rt("SceneNode: Unknown scope:",n),s}}gc.BACKGROUND_BLURRINESS="backgroundBlurriness";gc.BACKGROUND_INTENSITY="backgroundIntensity";gc.BACKGROUND_ROTATION="backgroundRotation";const pre=sn(gc,gc.BACKGROUND_BLURRINESS),zO=sn(gc,gc.BACKGROUND_INTENSITY),mre=sn(gc,gc.BACKGROUND_ROTATION);class GUe extends qf{static get type(){return"StorageTextureNode"}constructor(e,n,i=null){super(e,n),this.storeNode=i,this.mipLevel=0,this.isStorageTextureNode=!0,this.access=Po.WRITE_ONLY}getInputType(){return"storageTexture"}setup(e){super.setup(e);const n=e.getNodeProperties(this);return n.storeNode=this.storeNode,n}setAccess(e){return this.access=e,this}setMipLevel(e){return this.mipLevel=e,this}generate(e,n){let i;return this.storeNode!==null?i=this.generateStore(e):i=super.generate(e,n),i}toReadWrite(){return this.setAccess(Po.READ_WRITE)}toReadOnly(){return this.setAccess(Po.READ_ONLY)}toWriteOnly(){return this.setAccess(Po.WRITE_ONLY)}generateStore(e){const n=e.getNodeProperties(this),{uvNode:i,storeNode:s,depthNode:r}=n,o=super.generate(e,"property"),l=i.build(e,this.value.is3DTexture===!0?"uvec3":"uvec2"),c=s.build(e,"vec4"),u=r?r.build(e,"int"):null,h=e.generateTextureStore(e,o,l,u,c);e.addLineFlowCode(h,this)}clone(){const e=super.clone();return e.storeNode=this.storeNode,e.mipLevel=this.mipLevel,e}}const gre=sa(GUe).setParameterLength(1,3),qUe=(a,e,n)=>{const i=gre(a,e,n);return n!==null&&i.toStack(),i},HUe=Ye(({texture:a,uv:e})=>{const i=qe().toVar();return kn(e.x.lessThan(1e-4),()=>{i.assign(qe(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{i.assign(qe(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{i.assign(qe(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{i.assign(qe(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{i.assign(qe(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{i.assign(qe(0,0,-1))}).Else(()=>{const r=a.sample(e.add(qe(-.01,0,0))).r.sub(a.sample(e.add(qe(.01,0,0))).r),o=a.sample(e.add(qe(0,-.01,0))).r.sub(a.sample(e.add(qe(0,.01,0))).r),l=a.sample(e.add(qe(0,0,-.01))).r.sub(a.sample(e.add(qe(0,0,.01))).r);i.assign(qe(r,o,l))}),i.normalize()});class WUe extends qf{static get type(){return"Texture3DNode"}constructor(e,n=null,i=null){super(e,n,i),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return qe(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,n){const i=this.value;return e.isFlipY()&&(i.isRenderTargetTexture===!0||i.isFramebufferTexture===!0)&&(this.sampler?n=n.flipY():n=n.setY(Be(sm(this,this.levelNode).y).sub(n.y).sub(1))),n}generateUV(e,n){return n.build(e,this.sampler===!0?"vec3":"ivec3")}generateOffset(e,n){return n.build(e,"ivec3")}normal(e){return HUe({texture:this,uv:e})}}const eI=sa(WUe).setParameterLength(1,3),$Ue=(...a)=>eI(...a).setSampler(!1),KUe=(a,e,n)=>eI(a,e).level(n);class YUe extends G4{static get type(){return"UserDataNode"}constructor(e,n,i=null){super(e,n,i),this.userData=i}updateReference(e){return this.reference=this.userData!==null?this.userData:e.object.userData,this.reference}}const XUe=(a,e,n)=>new YUe(a,e,n),RK=new WeakMap;class QUe extends Rs{static get type(){return"VelocityNode"}constructor(){super("vec2"),this.projectionMatrix=null,this.updateType=fa.OBJECT,this.updateAfterType=fa.OBJECT,this.previousModelWorldMatrix=Rn(new _n),this.previousProjectionMatrix=Rn(new _n).setGroup(Nn),this.previousCameraViewMatrix=Rn(new _n)}setProjectionMatrix(e){this.projectionMatrix=e}update({frameId:e,camera:n,object:i}){const s=PK(i);this.previousModelWorldMatrix.value.copy(s);const r=Are(n);r.frameId!==e&&(r.frameId=e,r.previousProjectionMatrix===void 0?(r.previousProjectionMatrix=new _n,r.previousCameraViewMatrix=new _n,r.currentProjectionMatrix=new _n,r.currentCameraViewMatrix=new _n,r.previousProjectionMatrix.copy(this.projectionMatrix||n.projectionMatrix),r.previousCameraViewMatrix.copy(n.matrixWorldInverse)):(r.previousProjectionMatrix.copy(r.currentProjectionMatrix),r.previousCameraViewMatrix.copy(r.currentCameraViewMatrix)),r.currentProjectionMatrix.copy(this.projectionMatrix||n.projectionMatrix),r.currentCameraViewMatrix.copy(n.matrixWorldInverse),this.previousProjectionMatrix.value.copy(r.previousProjectionMatrix),this.previousCameraViewMatrix.value.copy(r.previousCameraViewMatrix))}updateAfter({object:e}){PK(e).copy(e.matrixWorld)}setup(){const e=this.projectionMatrix===null?om:Rn(this.projectionMatrix),n=this.previousCameraViewMatrix.mul(this.previousModelWorldMatrix),i=e.mul(L0).mul(Es),s=this.previousProjectionMatrix.mul(n).mul(TR),r=i.xy.div(i.w),o=s.xy.div(s.w);return Ka(r,o)}}function Are(a){let e=RK.get(a);return e===void 0&&(e={},RK.set(a,e)),e}function PK(a,e=0){const n=Are(a);let i=n[e];return i===void 0&&(n[e]=i=new _n,n[e].copy(a.matrixWorld)),i}const JUe=sn(QUe),ZUe=Ye(([a])=>S7(a.rgb)),e9e=Ye(([a,e=Re(1)])=>e.mix(S7(a.rgb),a.rgb)),t9e=Ye(([a,e=Re(1)])=>{const n=cr(a.r,a.g,a.b).div(3),i=a.r.max(a.g.max(a.b)),s=i.sub(n).mul(e).mul(-3);return Ha(a.rgb,i,s)}),n9e=Ye(([a,e=Re(1)])=>{const n=qe(.57735,.57735,.57735),i=e.cos();return qe(a.rgb.mul(i).add(n.cross(a.rgb).mul(e.sin()).add(n.mul(Yu(n,a.rgb).mul(i.oneMinus())))))}),S7=(a,e=qe(Vn.getLuminanceCoefficients(new ye)))=>Yu(a,e),a9e=Ye(([a,e=qe(1),n=qe(0),i=qe(1),s=Re(1),r=qe(Vn.getLuminanceCoefficients(new ye,_m))])=>{const o=a.rgb.dot(qe(r)),l=Ns(a.rgb.mul(e).add(n),0).toVar(),c=l.pow(i).toVar();return kn(l.r.greaterThan(0),()=>{l.r.assign(c.r)}),kn(l.g.greaterThan(0),()=>{l.g.assign(c.g)}),kn(l.b.greaterThan(0),()=>{l.b.assign(c.b)}),l.assign(o.add(l.sub(o).mul(s))),On(l.rgb,a.a)});class i9e extends Rs{static get type(){return"PosterizeNode"}constructor(e,n){super(),this.sourceNode=e,this.stepsNode=n}setup(){const{sourceNode:e,stepsNode:n}=this;return e.mul(n).floor().div(n)}}const s9e=sa(i9e).setParameterLength(2),tC=new Nt;class yre extends qf{static get type(){return"PassTextureNode"}constructor(e,n){super(n),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class IK extends yre{static get type(){return"PassMultipleTextureNode"}constructor(e,n,i=!1){super(e,null),this.textureName=n,this.previousTexture=i}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){const e=new this.constructor(this.passNode,this.textureName,this.previousTexture);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}class Hf extends Rs{static get type(){return"PassNode"}constructor(e,n,i,s={}){super("vec4"),this.scope=e,this.scene=n,this.camera=i,this.options=s,this._pixelRatio=1,this._width=1,this._height=1;const r=new Do;r.isRenderTargetTexture=!0,r.name="depth";const o=new th(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:cs,...s});o.texture.name="output",o.depthTexture=r,this.renderTarget=o,this.overrideMaterial=null,this.transparent=!0,this.opaque=!0,this.contextNode=null,this._contextNodeCache=null,this._textures={output:o.texture,depth:r},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=Rn(0),this._cameraFar=Rn(0),this._mrt=null,this._layers=null,this._resolutionScale=1,this._viewport=null,this._scissor=null,this.isPassNode=!0,this.updateBeforeType=fa.FRAME,this.global=!0}setResolutionScale(e){return this._resolutionScale=e,this}getResolutionScale(){return this._resolutionScale}setResolution(e){return yt("PassNode: .setResolution() is deprecated. Use .setResolutionScale() instead."),this.setResolutionScale(e)}getResolution(){return yt("PassNode: .getResolution() is deprecated. Use .getResolutionScale() instead."),this.getResolutionScale()}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let n=this._textures[e];return n===void 0&&(n=this.renderTarget.texture.clone(),n.name=e,this._textures[e]=n,this.renderTarget.textures.push(n)),n}getPreviousTexture(e){let n=this._previousTextures[e];return n===void 0&&(n=this.getTexture(e).clone(),this._previousTextures[e]=n),n}toggleTexture(e){const n=this._previousTextures[e];if(n!==void 0){const i=this._textures[e],s=this.renderTarget.textures.indexOf(i);this.renderTarget.textures[s]=n,this._textures[e]=n,this._previousTextures[e]=i,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let n=this._textureNodes[e];return n===void 0&&(n=new IK(this,e),n.updateTexture(),this._textureNodes[e]=n),n}getPreviousTextureNode(e="output"){let n=this._previousTextureNodes[e];return n===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),n=new IK(this,e,!0),n.updateTexture(),this._previousTextureNodes[e]=n),n}getViewZNode(e="depth"){let n=this._viewZNodes[e];if(n===void 0){const i=this._cameraNear,s=this._cameraFar;this._viewZNodes[e]=n=c7(this.getTextureNode(e),i,s)}return n}getLinearDepthNode(e="depth"){let n=this._linearDepthNodes[e];if(n===void 0){const i=this._cameraNear,s=this._cameraFar,r=this.getViewZNode(e);this._linearDepthNodes[e]=n=P_(r,i,s)}return n}async compileAsync(e){const n=e.getRenderTarget(),i=e.getMRT();e.setRenderTarget(this.renderTarget),e.setMRT(this._mrt),await e.compileAsync(this.scene,this.camera),e.setRenderTarget(n),e.setMRT(i)}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,this.renderTarget.texture.type=e.getOutputBufferType(),this.scope===Hf.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:n}=e,{scene:i}=this;let s,r;const o=n.getOutputRenderTarget();o&&o.isXRRenderTarget===!0?(r=1,s=n.xr.getCamera(),n.xr.updateCamera(s),tC.set(o.width,o.height)):(s=this.camera,r=n.getPixelRatio(),n.getSize(tC)),this._pixelRatio=r,this.setSize(tC.width,tC.height);const l=n.getRenderTarget(),c=n.getMRT(),u=n.autoClear,h=n.transparent,f=n.opaque,m=s.layers.mask,A=n.contextNode,x=i.overrideMaterial;this._cameraNear.value=s.near,this._cameraFar.value=s.far,this._layers!==null&&(s.layers.mask=this._layers.mask);for(const E in this._previousTextures)this.toggleTexture(E);this.overrideMaterial!==null&&(i.overrideMaterial=this.overrideMaterial),n.setRenderTarget(this.renderTarget),n.setMRT(this._mrt),n.autoClear=!0,n.transparent=this.transparent,n.opaque=this.opaque,this.contextNode!==null&&((this._contextNodeCache===null||this._contextNodeCache.version!==this.version)&&(this._contextNodeCache={version:this.version,context:Dm({...n.contextNode.getFlowContextData(),...this.contextNode.getFlowContextData()})}),n.contextNode=this._contextNodeCache.context);const T=i.name;i.name=this.name?this.name:i.name,n.render(i,s),i.name=T,i.overrideMaterial=x,n.setRenderTarget(l),n.setMRT(c),n.autoClear=u,n.transparent=h,n.opaque=f,n.contextNode=A,s.layers.mask=m}setSize(e,n){this._width=e,this._height=n;const i=Math.floor(this._width*this._pixelRatio*this._resolutionScale),s=Math.floor(this._height*this._pixelRatio*this._resolutionScale);this.renderTarget.setSize(i,s),this._scissor!==null&&this.renderTarget.scissor.copy(this._scissor),this._viewport!==null&&this.renderTarget.viewport.copy(this._viewport)}setScissor(e,n,i,s){e===null?this._scissor=null:(this._scissor===null&&(this._scissor=new qn),e.isVector4?this._scissor.copy(e):this._scissor.set(e,n,i,s),this._scissor.multiplyScalar(this._pixelRatio*this._resolutionScale).floor())}setViewport(e,n,i,s){e===null?this._viewport=null:(this._viewport===null&&(this._viewport=new qn),e.isVector4?this._viewport.copy(e):this._viewport.set(e,n,i,s),this._viewport.multiplyScalar(this._pixelRatio*this._resolutionScale).floor())}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}Hf.COLOR="color";Hf.DEPTH="depth";const r9e=(a,e,n)=>new Hf(Hf.COLOR,a,e,n),o9e=(a,e)=>new yre(a,e),l9e=(a,e,n)=>new Hf(Hf.DEPTH,a,e,n);class c9e extends Hf{static get type(){return"ToonOutlinePassNode"}constructor(e,n,i,s,r){super(Hf.COLOR,e,n),this.colorNode=i,this.thicknessNode=s,this.alphaNode=r,this._materialCache=new WeakMap,this.name="Outline Pass"}updateBefore(e){const{renderer:n}=e,i=n.getRenderObjectFunction();n.setRenderObjectFunction((s,r,o,l,c,u,h,f)=>{if((c.isMeshToonMaterial||c.isMeshToonNodeMaterial)&&c.wireframe===!1){const m=this._getOutlineMaterial(c);n.renderObject(s,r,o,l,m,u,h,f)}n.renderObject(s,r,o,l,c,u,h,f)}),super.updateBefore(e),n.setRenderObjectFunction(i)}_createMaterial(){const e=new zs;e.isMeshToonOutlineMaterial=!0,e.name="Toon_Outline",e.side=Di;const n=wc.negate(),i=om.mul(L0),s=Re(1),r=i.mul(On(Es,1)),o=i.mul(On(Es.add(n),1)),l=Fl(r.sub(o));return e.vertexNode=r.add(l.mul(this.thicknessNode).mul(r.w).mul(s)),e.colorNode=On(this.colorNode,this.alphaNode),e}_getOutlineMaterial(e){let n=this._materialCache.get(e);return n===void 0&&(n=this._createMaterial(),this._materialCache.set(e,n)),n}}const u9e=(a,e,n=new on(0,0,0),i=.003,s=1)=>rn(new c9e(a,e,rn(n),rn(i),rn(s))),vre=Ye(([a,e])=>a.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),_re=Ye(([a,e])=>(a=a.mul(e),a.div(a.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),xre=Ye(([a,e])=>{a=a.mul(e),a=a.sub(.004).max(0);const n=a.mul(a.mul(6.2).add(.5)),i=a.mul(a.mul(6.2).add(1.7)).add(.06);return n.div(i).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),d9e=Ye(([a])=>{const e=a.mul(a.add(.0245786)).sub(90537e-9),n=a.mul(a.add(.432951).mul(.983729)).add(.238081);return e.div(n)}),bre=Ye(([a,e])=>{const n=Oo(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),i=Oo(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return a=a.mul(e).div(.6),a=n.mul(a),a=d9e(a),a=i.mul(a),a.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),h9e=Oo(qe(1.6605,-.1246,-.0182),qe(-.5876,1.1329,-.1006),qe(-.0728,-.0083,1.1187)),f9e=Oo(qe(.6274,.0691,.0164),qe(.3293,.9195,.088),qe(.0433,.0113,.8956)),p9e=Ye(([a])=>{const e=qe(a).toVar(),n=qe(e.mul(e)).toVar(),i=qe(n.mul(n)).toVar();return Re(15.5).mul(i.mul(n)).sub(ia(40.14,i.mul(e))).add(ia(31.96,i).sub(ia(6.868,n.mul(e))).add(ia(.4298,n).add(ia(.1191,e).sub(.00232))))}),Sre=Ye(([a,e])=>{const n=qe(a).toVar(),i=Oo(qe(.856627153315983,.137318972929847,.11189821299995),qe(.0951212405381588,.761241990602591,.0767994186031903),qe(.0482516061458583,.101439036467562,.811302368396859)),s=Oo(qe(1.1271005818144368,-.1413297634984383,-.14132976349843826),qe(-.11060664309660323,1.157823702216272,-.11060664309660294),qe(-.016493938717834573,-.016493938717834257,1.2519364065950405)),r=Re(-12.47393),o=Re(4.026069);return n.mulAssign(e),n.assign(f9e.mul(n)),n.assign(i.mul(n)),n.assign(Ns(n,1e-10)),n.assign(sf(n)),n.assign(n.sub(r).div(o.sub(r))),n.assign(Xd(n,0,1)),n.assign(p9e(n)),n.assign(s.mul(n)),n.assign(Uu(Ns(qe(0),n),qe(2.2))),n.assign(h9e.mul(n)),n.assign(Xd(n,0,1)),n}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Tre=Ye(([a,e])=>{const n=Re(.76),i=Re(.15);a=a.mul(e);const s=Tc(a.r,Tc(a.g,a.b)),r=Io(s.lessThan(.08),s.sub(ia(6.25,s.mul(s))),.04);a.subAssign(r);const o=Ns(a.r,Ns(a.g,a.b));kn(o.lessThan(n),()=>a);const l=Ka(1,n),c=Ka(1,l.mul(l).div(o.add(l.sub(n))));a.mulAssign(c.div(o));const u=Ka(1,yu(1,i.mul(o.sub(c)).add(1)));return Ha(a,qe(c),u)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class ao extends yn{static get type(){return"CodeNode"}constructor(e="",n=[],i=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=n,this.language=i}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const n=this.getIncludes(e);for(const s of n)s.build(e);const i=e.getCodeFromNode(this,this.getNodeType(e));return i.code=this.code,i.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}const tI=sa(ao).setParameterLength(1,3),m9e=(a,e)=>tI(a,e,"js"),g9e=(a,e)=>tI(a,e,"wgsl"),A9e=(a,e)=>tI(a,e,"glsl");class wre extends ao{static get type(){return"FunctionNode"}constructor(e="",n=[],i=""){super(e,n,i)}getNodeType(e){return this.getNodeFunction(e).type}getMemberType(e,n){const i=this.getNodeType(e);return e.getStructTypeNode(i).getMemberType(e,n)}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const n=e.getDataFromNode(this);let i=n.nodeFunction;return i===void 0&&(i=e.parser.parseFunction(this.code),n.nodeFunction=i),i}generate(e,n){super.generate(e);const i=this.getNodeFunction(e),s=i.name,r=i.type,o=e.getCodeFromNode(this,r);s!==""&&(o.name=s);const l=e.getPropertyName(o),c=this.getNodeFunction(e).getCode(l);return o.code=c+`
`,n==="property"?l:e.format(`${l}()`,r,n)}}const Ere=(a,e=[],n="")=>{for(let r=0;r<e.length;r++){const o=e[r];typeof o=="function"&&(e[r]=o.functionNode)}const i=new wre(a,e,n),s=(...r)=>i.call(...r);return s.functionNode=i,s},y9e=(a,e)=>Ere(a,e,"glsl"),v9e=(a,e)=>Ere(a,e,"wgsl");class _9e extends yn{static get type(){return"ScriptableValueNode"}constructor(e=null){super(),this._value=e,this._cache=null,this.inputType=null,this.outputType=null,this.events=new Cc,this.isScriptableValueNode=!0}get isScriptableOutputNode(){return this.outputType!==null}set value(e){this._value!==e&&(this._cache&&this.inputType==="URL"&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}get value(){return this._value}refresh(){this.events.dispatchEvent({type:"refresh"})}getValue(){const e=this.value;if(e&&this._cache===null&&this.inputType==="URL"&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&e.value!==null&&e.value!==void 0&&((this.inputType==="URL"||this.inputType==="String")&&typeof e.value=="string"||this.inputType==="Number"&&typeof e.value=="number"||this.inputType==="Vector2"&&e.value.isVector2||this.inputType==="Vector3"&&e.value.isVector3||this.inputType==="Vector4"&&e.value.isVector4||this.inputType==="Color"&&e.value.isColor||this.inputType==="Matrix3"&&e.value.isMatrix3||this.inputType==="Matrix4"&&e.value.isMatrix4))return e.value;return this._cache||e}getNodeType(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}setup(){return this.value&&this.value.isNode?this.value:Re()}serialize(e){super.serialize(e),this.value!==null?this.inputType==="ArrayBuffer"?e.value=Pne(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}deserialize(e){super.deserialize(e);let n=null;e.value!==null&&(e.inputType==="ArrayBuffer"?n=Ine(e.value):e.inputType==="Texture"?n=e.meta.textures[e.value]:n=e.meta.nodes[e.value]||null),this.value=n,this.inputType=e.inputType,this.outputType=e.outputType}}const d3=sa(_9e).setParameterLength(1);class Mre extends Map{get(e,n=null,...i){if(this.has(e))return super.get(e);if(n!==null){const s=n(...i);return this.set(e,s),s}}}class x9e{constructor(e){this.scriptableNode=e}get parameters(){return this.scriptableNode.parameters}get layout(){return this.scriptableNode.getLayout()}getInputLayout(e){return this.scriptableNode.getInputLayout(e)}get(e){const n=this.parameters[e];return n?n.getValue():null}}const h3=new Mre;class b9e extends yn{static get type(){return"ScriptableNode"}constructor(e=null,n={}){super(),this.codeNode=e,this.parameters=n,this._local=new Mre,this._output=d3(null),this._outputs={},this._source=this.source,this._method=null,this._object=null,this._value=null,this._needsOutputUpdate=!0,this.onRefresh=this.onRefresh.bind(this),this.isScriptableNode=!0}get source(){return this.codeNode?this.codeNode.code:""}setLocal(e,n){return this._local.set(e,n)}getLocal(e){return this._local.get(e)}onRefresh(){this._refresh()}getInputLayout(e){for(const n of this.getLayout())if(n.inputType&&(n.id===e||n.name===e))return n}getOutputLayout(e){for(const n of this.getLayout())if(n.outputType&&(n.id===e||n.name===e))return n}setOutput(e,n){const i=this._outputs;return i[e]===void 0?i[e]=d3(n):i[e].value=n,this}getOutput(e){return this._outputs[e]}getParameter(e){return this.parameters[e]}setParameter(e,n){const i=this.parameters;return n&&n.isScriptableNode?(this.deleteParameter(e),i[e]=n,i[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):n&&n.isScriptableValueNode?(this.deleteParameter(e),i[e]=n,i[e].events.addEventListener("refresh",this.onRefresh)):i[e]===void 0?(i[e]=d3(n),i[e].events.addEventListener("refresh",this.onRefresh)):i[e].value=n,this}getValue(){return this.getDefaultOutput().getValue()}deleteParameter(e){let n=this.parameters[e];return n&&(n.isScriptableNode&&(n=n.getDefaultOutput()),n.events.removeEventListener("refresh",this.onRefresh)),this}clearParameters(){for(const e of Object.keys(this.parameters))this.deleteParameter(e);return this.needsUpdate=!0,this}call(e,...n){const s=this.getObject()[e];if(typeof s=="function")return s(...n)}async callAsync(e,...n){const s=this.getObject()[e];if(typeof s=="function")return s.constructor.name==="AsyncFunction"?await s(...n):s(...n)}getNodeType(e){return this.getDefaultOutputNode().getNodeType(e)}refresh(e=null){e!==null?this.getOutput(e).refresh():this._refresh()}getObject(){if(this.needsUpdate&&this.dispose(),this._object!==null)return this._object;const e=()=>this.refresh(),n=(u,h)=>this.setOutput(u,h),i=new x9e(this),s=h3.get("THREE"),r=h3.get("TSL"),o=this.getMethod(),l=[i,this._local,h3,e,n,s,r];this._object=o(...l);const c=this._object.layout;if(c&&(c.cache===!1&&this._local.clear(),this._output.outputType=c.outputType||null,Array.isArray(c.elements)))for(const u of c.elements){const h=u.id||u.name;u.inputType&&(this.getParameter(h)===void 0&&this.setParameter(h,null),this.getParameter(h).inputType=u.inputType),u.outputType&&(this.getOutput(h)===void 0&&this.setOutput(h,null),this.getOutput(h).outputType=u.outputType)}return this._object}deserialize(e){super.deserialize(e);for(const n in this.parameters){let i=this.parameters[n];i.isScriptableNode&&(i=i.getDefaultOutput()),i.events.addEventListener("refresh",this.onRefresh)}}getLayout(){return this.getObject().layout}getDefaultOutputNode(){const e=this.getDefaultOutput().value;return e&&e.isNode?e:Re()}getDefaultOutput(){return this._exec()._output}getMethod(){if(this.needsUpdate&&this.dispose(),this._method!==null)return this._method;const e=["parameters","local","global","refresh","setOutput","THREE","TSL"],i=["layout","init","main","dispose"].join(", "),s="var "+i+`; var output = {};
`,r=`
return { ...output, `+i+" };",o=s+this.codeNode.code+r;return this._method=new Function(...e,o),this._method}dispose(){this._method!==null&&(this._object&&typeof this._object.dispose=="function"&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}setup(){return this.getDefaultOutputNode()}getCacheKey(e){const n=[uw(this.source),this.getDefaultOutputNode().getCacheKey(e)];for(const i in this.parameters)n.push(this.parameters[i].getCacheKey(e));return Hx(n)}set needsUpdate(e){e===!0&&this.dispose()}get needsUpdate(){return this.source!==this._source}_exec(){return this.codeNode===null?this:(this._needsOutputUpdate===!0&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value,this)}_refresh(){this.needsUpdate=!0,this._exec(),this._output.refresh()}}const S9e=sa(b9e).setParameterLength(1,2);function Cre(a){let e;const n=a.context.getViewZ;return n!==void 0&&(e=n(this)),(e||tr.z).negate()}const T7=Ye(([a,e],n)=>{const i=Cre(n);return Qd(a,e,i)}),w7=Ye(([a],e)=>{const n=Cre(e);return a.mul(a,n,n).negate().exp().oneMinus()}),pT=Ye(([a,e])=>On(e.toFloat().mix(C_.rgb,a.toVec3()),C_.a));function T9e(a,e,n){return yt('TSL: "rangeFog( color, near, far )" is deprecated. Use "fog( color, rangeFogFactor( near, far ) )" instead.'),pT(a,T7(e,n))}function w9e(a,e){return yt('TSL: "densityFog( color, density )" is deprecated. Use "fog( color, densityFogFactor( density ) )" instead.'),pT(a,w7(e))}let xA=null,bA=null;class E9e extends yn{static get type(){return"RangeNode"}constructor(e=Re(),n=Re()){super(),this.minNode=e,this.maxNode=n}getVectorLength(e){const n=this.getConstNode(this.minNode),i=this.getConstNode(this.maxNode),s=e.getTypeLength(zg(n.value)),r=e.getTypeLength(zg(i.value));return s>r?s:r}getNodeType(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}getConstNode(e){let n=null;if(e.traverse(i=>{i.isConstNode===!0&&(n=i)}),n===null)throw new Error('THREE.TSL: No "ConstNode" found in node graph.');return n}setup(e){const n=e.object;let i=null;if(n.count>1){const s=this.getConstNode(this.minNode),r=this.getConstNode(this.maxNode),o=s.value,l=r.value,c=e.getTypeLength(zg(o)),u=e.getTypeLength(zg(l));xA=xA||new qn,bA=bA||new qn,xA.setScalar(0),bA.setScalar(0),c===1?xA.setScalar(o):o.isColor?xA.set(o.r,o.g,o.b,1):xA.set(o.x,o.y,o.z||0,o.w||0),u===1?bA.setScalar(l):l.isColor?bA.set(l.r,l.g,l.b,1):bA.set(l.x,l.y,l.z||0,l.w||0);const h=4,f=h*n.count,m=new Float32Array(f);for(let x=0;x<f;x++){const T=x%h,E=xA.getComponent(T),M=bA.getComponent(T);m[x]=Xy.lerp(E,M,Math.random())}const A=this.getNodeType(e);if(n.count<=4096)i=fw(m,"vec4",n.count).element(cf).convert(A);else{const x=new _c(m,4);e.geometry.setAttribute("__range"+this.id,x),i=SR(x).convert(A)}}else i=Re(0);return i}}const M9e=sa(E9e).setParameterLength(2);class C9e extends yn{static get type(){return"ComputeBuiltinNode"}constructor(e,n){super(n),this._builtinName=e}getHash(e){return this.getBuiltinName(e)}getNodeType(){return this.nodeType}setBuiltinName(e){return this._builtinName=e,this}getBuiltinName(){return this._builtinName}hasBuiltin(e){return e.hasBuiltin(this._builtinName)}generate(e,n){const i=this.getBuiltinName(e),s=this.getNodeType(e);return e.shaderStage==="compute"?e.format(i,s,n):(yt(`ComputeBuiltinNode: Compute built-in value ${i} can not be accessed in the ${e.shaderStage} stage`),e.generateConst(s))}serialize(e){super.serialize(e),e.global=this.global,e._builtinName=this._builtinName}deserialize(e){super.deserialize(e),this.global=e.global,this._builtinName=e._builtinName}}const yw=(a,e)=>new C9e(a,e),N9e=yw("numWorkgroups","uvec3"),R9e=yw("workgroupId","uvec3"),P9e=yw("globalId","uvec3"),I9e=yw("localId","uvec3"),L9e=yw("subgroupSize","uint");class D9e extends yn{constructor(e){super(),this.scope=e}generate(e){const{scope:n}=this,{renderer:i}=e;i.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${n}Barrier 
`):e.addLineFlowCode(`${n}Barrier()`,this)}}const E7=sa(D9e),k9e=()=>E7("workgroup").toStack(),O9e=()=>E7("storage").toStack(),F9e=()=>E7("texture").toStack();class j9e extends g1{constructor(e,n){super(e,n),this.isWorkgroupInfoElementNode=!0}generate(e,n){let i;const s=e.context.assign;if(i=super.generate(e),s!==!0){const r=this.getNodeType(e);i=e.format(i,r,n)}return i}}class B9e extends yn{constructor(e,n,i=0){super(n),this.bufferType=n,this.bufferCount=i,this.isWorkgroupInfoNode=!0,this.elementType=n,this.scope=e,this.name=""}setName(e){return this.name=e,this}label(e){return yt('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setScope(e){return this.scope=e,this}getElementType(){return this.elementType}getInputType(){return`${this.scope}Array`}element(e){return new j9e(this,e)}generate(e){const n=this.name!==""?this.name:`${this.scope}Array_${this.id}`;return e.getScopedArray(n,this.scope.toLowerCase(),this.bufferType,this.bufferCount)}}const U9e=(a,e)=>new B9e("Workgroup",a,e);class $r extends yn{static get type(){return"AtomicFunctionNode"}constructor(e,n,i){super("uint"),this.method=e,this.pointerNode=n,this.valueNode=i,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const n=e.getNodeProperties(this),i=n.parents,s=this.method,r=this.getNodeType(e),o=this.getInputType(e),l=this.pointerNode,c=this.valueNode,u=[];u.push(`&${l.build(e,o)}`),c!==null&&u.push(c.build(e,o));const h=`${e.getMethod(s,r)}( ${u.join(", ")} )`;if(i?i.length===1&&i[0].isStackNode===!0:!1)e.addLineFlowCode(h,this);else return n.constNode===void 0&&(n.constNode=Cm(h,r).toConst()),n.constNode.build(e)}}$r.ATOMIC_LOAD="atomicLoad";$r.ATOMIC_STORE="atomicStore";$r.ATOMIC_ADD="atomicAdd";$r.ATOMIC_SUB="atomicSub";$r.ATOMIC_MAX="atomicMax";$r.ATOMIC_MIN="atomicMin";$r.ATOMIC_AND="atomicAnd";$r.ATOMIC_OR="atomicOr";$r.ATOMIC_XOR="atomicXor";const V9e=sa($r),Qf=(a,e,n)=>V9e(a,e,n).toStack(),z9e=a=>Qf($r.ATOMIC_LOAD,a,null),G9e=(a,e)=>Qf($r.ATOMIC_STORE,a,e),q9e=(a,e)=>Qf($r.ATOMIC_ADD,a,e),H9e=(a,e)=>Qf($r.ATOMIC_SUB,a,e),W9e=(a,e)=>Qf($r.ATOMIC_MAX,a,e),$9e=(a,e)=>Qf($r.ATOMIC_MIN,a,e),K9e=(a,e)=>Qf($r.ATOMIC_AND,a,e),Y9e=(a,e)=>Qf($r.ATOMIC_OR,a,e),X9e=(a,e)=>Qf($r.ATOMIC_XOR,a,e);class un extends Rs{static get type(){return"SubgroupFunctionNode"}constructor(e,n=null,i=null){super(),this.method=e,this.aNode=n,this.bNode=i}getInputType(e){const n=this.aNode?this.aNode.getNodeType(e):null,i=this.bNode?this.bNode.getNodeType(e):null,s=e.isMatrix(n)?0:e.getTypeLength(n),r=e.isMatrix(i)?0:e.getTypeLength(i);return s>r?n:i}getNodeType(e){const n=this.method;return n===un.SUBGROUP_ELECT?"bool":n===un.SUBGROUP_BALLOT?"uvec4":this.getInputType(e)}generate(e,n){const i=this.method,s=this.getNodeType(e),r=this.getInputType(e),o=this.aNode,l=this.bNode,c=[];if(i===un.SUBGROUP_BROADCAST||i===un.SUBGROUP_SHUFFLE||i===un.QUAD_BROADCAST){const h=l.getNodeType(e);c.push(o.build(e,s),l.build(e,h==="float"?"int":s))}else i===un.SUBGROUP_SHUFFLE_XOR||i===un.SUBGROUP_SHUFFLE_DOWN||i===un.SUBGROUP_SHUFFLE_UP?c.push(o.build(e,s),l.build(e,"uint")):(o!==null&&c.push(o.build(e,r)),l!==null&&c.push(l.build(e,r)));const u=c.length===0?"()":`( ${c.join(", ")} )`;return e.format(`${e.getMethod(i,s)}${u}`,s,n)}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}un.SUBGROUP_ELECT="subgroupElect";un.SUBGROUP_BALLOT="subgroupBallot";un.SUBGROUP_ADD="subgroupAdd";un.SUBGROUP_INCLUSIVE_ADD="subgroupInclusiveAdd";un.SUBGROUP_EXCLUSIVE_AND="subgroupExclusiveAdd";un.SUBGROUP_MUL="subgroupMul";un.SUBGROUP_INCLUSIVE_MUL="subgroupInclusiveMul";un.SUBGROUP_EXCLUSIVE_MUL="subgroupExclusiveMul";un.SUBGROUP_AND="subgroupAnd";un.SUBGROUP_OR="subgroupOr";un.SUBGROUP_XOR="subgroupXor";un.SUBGROUP_MIN="subgroupMin";un.SUBGROUP_MAX="subgroupMax";un.SUBGROUP_ALL="subgroupAll";un.SUBGROUP_ANY="subgroupAny";un.SUBGROUP_BROADCAST_FIRST="subgroupBroadcastFirst";un.QUAD_SWAP_X="quadSwapX";un.QUAD_SWAP_Y="quadSwapY";un.QUAD_SWAP_DIAGONAL="quadSwapDiagonal";un.SUBGROUP_BROADCAST="subgroupBroadcast";un.SUBGROUP_SHUFFLE="subgroupShuffle";un.SUBGROUP_SHUFFLE_XOR="subgroupShuffleXor";un.SUBGROUP_SHUFFLE_UP="subgroupShuffleUp";un.SUBGROUP_SHUFFLE_DOWN="subgroupShuffleDown";un.QUAD_BROADCAST="quadBroadcast";const Q9e=Zt(un,un.SUBGROUP_ELECT).setParameterLength(0),J9e=Zt(un,un.SUBGROUP_BALLOT).setParameterLength(1),Z9e=Zt(un,un.SUBGROUP_ADD).setParameterLength(1),eVe=Zt(un,un.SUBGROUP_INCLUSIVE_ADD).setParameterLength(1),tVe=Zt(un,un.SUBGROUP_EXCLUSIVE_AND).setParameterLength(1),nVe=Zt(un,un.SUBGROUP_MUL).setParameterLength(1),aVe=Zt(un,un.SUBGROUP_INCLUSIVE_MUL).setParameterLength(1),iVe=Zt(un,un.SUBGROUP_EXCLUSIVE_MUL).setParameterLength(1),sVe=Zt(un,un.SUBGROUP_AND).setParameterLength(1),rVe=Zt(un,un.SUBGROUP_OR).setParameterLength(1),oVe=Zt(un,un.SUBGROUP_XOR).setParameterLength(1),lVe=Zt(un,un.SUBGROUP_MIN).setParameterLength(1),cVe=Zt(un,un.SUBGROUP_MAX).setParameterLength(1),uVe=Zt(un,un.SUBGROUP_ALL).setParameterLength(0),dVe=Zt(un,un.SUBGROUP_ANY).setParameterLength(0),hVe=Zt(un,un.SUBGROUP_BROADCAST_FIRST).setParameterLength(2),fVe=Zt(un,un.QUAD_SWAP_X).setParameterLength(1),pVe=Zt(un,un.QUAD_SWAP_Y).setParameterLength(1),mVe=Zt(un,un.QUAD_SWAP_DIAGONAL).setParameterLength(1),gVe=Zt(un,un.SUBGROUP_BROADCAST).setParameterLength(2),AVe=Zt(un,un.SUBGROUP_SHUFFLE).setParameterLength(2),yVe=Zt(un,un.SUBGROUP_SHUFFLE_XOR).setParameterLength(2),vVe=Zt(un,un.SUBGROUP_SHUFFLE_UP).setParameterLength(2),_Ve=Zt(un,un.SUBGROUP_SHUFFLE_DOWN).setParameterLength(2),xVe=Zt(un,un.QUAD_BROADCAST).setParameterLength(1);let nC;function nI(a){nC=nC||new WeakMap;let e=nC.get(a);return e===void 0&&nC.set(a,e={}),e}function aI(a){const e=nI(a);return e.shadowMatrix||(e.shadowMatrix=Rn("mat4").setGroup(Nn).onRenderUpdate(n=>((a.castShadow!==!0||n.renderer.shadowMap.enabled===!1)&&(a.shadow.camera.coordinateSystem!==n.camera.coordinateSystem&&(a.shadow.camera.coordinateSystem=n.camera.coordinateSystem,a.shadow.camera.updateProjectionMatrix()),a.shadow.updateMatrices(a)),a.shadow.matrix)))}function Nre(a,e=lf){const n=aI(a).mul(e);return n.xyz.div(n.w)}function M7(a){const e=nI(a);return e.position||(e.position=Rn(new ye).setGroup(Nn).onRenderUpdate((n,i)=>i.value.setFromMatrixPosition(a.matrixWorld)))}function Rre(a){const e=nI(a);return e.targetPosition||(e.targetPosition=Rn(new ye).setGroup(Nn).onRenderUpdate((n,i)=>i.value.setFromMatrixPosition(a.target.matrixWorld)))}function C7(a){const e=nI(a);return e.viewPosition||(e.viewPosition=Rn(new ye).setGroup(Nn).onRenderUpdate(({camera:n},i)=>{i.value=i.value||new ye,i.value.setFromMatrixPosition(a.matrixWorld),i.value.applyMatrix4(n.matrixWorldInverse)}))}const N7=a=>ad.transformDirection(M7(a).sub(Rre(a))),bVe=a=>a.sort((e,n)=>e.id-n.id),SVe=(a,e)=>{for(const n of e)if(n.isAnalyticLightNode&&n.light.id===a)return n;return null},B5=new WeakMap,A2=[];class R7 extends yn{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=im("vec3","totalDiffuse"),this.totalSpecularNode=im("vec3","totalSpecular"),this.outgoingLightNode=im("vec3","outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=this._lights;for(let i=0;i<e.length;i++){const s=e[i];if(A2.push(s.id),A2.push(s.castShadow?1:0),s.isSpotLight===!0){const r=s.map!==null?s.map.id:-1,o=s.colorNode?s.colorNode.getCacheKey():-1;A2.push(r,o)}}const n=Hx(A2);return A2.length=0,n}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const n=[];for(const i of this._lightNodes)n.push(i.getHash());this._lightNodesHash="lights-"+n.join(",")}return this._lightNodesHash}analyze(e){const n=e.getNodeProperties(this);for(const i of n.nodes)i.build(e);n.outputNode.build(e)}setupLightsNode(e){const n=[],i=this._lightNodes,s=bVe(this._lights),r=e.renderer.library;for(const o of s)if(o.isNode)n.push(rn(o));else{let l=null;if(i!==null&&(l=SVe(o.id,i)),l===null){const c=r.getLightNodeClass(o.constructor);if(c===null){yt(`LightsNode.setupNodeLights: Light node not found for ${o.constructor.name}`);continue}let u=null;B5.has(o)?u=B5.get(o):(u=new c(o),B5.set(o,u)),n.push(u)}}this._lightNodes=n}setupDirectLight(e,n,i){const{lightingModel:s,reflectedLight:r}=e.context;s.direct({...i,lightNode:n,reflectedLight:r},e)}setupDirectRectAreaLight(e,n,i){const{lightingModel:s,reflectedLight:r}=e.context;s.directRectArea({...i,lightNode:n,reflectedLight:r},e)}setupLights(e,n){for(const i of n)i.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const n=e.lightsNode;e.lightsNode=this;let i=this.outgoingLightNode;const s=e.context,r=s.lightingModel,o=e.getNodeProperties(this);if(r){const{totalDiffuseNode:l,totalSpecularNode:c}=this;s.outgoingLight=i;const u=e.addStack();o.nodes=u.nodes,r.start(e);const{backdrop:h,backdropAlpha:f}=s,{directDiffuse:m,directSpecular:A,indirectDiffuse:x,indirectSpecular:T}=s.reflectedLight;let E=m.add(x);h!==null&&(f!==null?E=qe(f.mix(E,h)):E=qe(h)),l.assign(E),c.assign(A.add(T)),i.assign(l.add(c)),r.finish(e),i=i.bypass(e.removeStack())}else o.nodes=[];return e.lightsNode=n,i}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}const TVe=(a=[])=>new R7().setLights(a);class wVe extends yn{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=fa.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:n}){P7.assign(n.receivedShadowPositionNode||e.shadowPositionWorld||lf)}}const P7=im("vec3","shadowPositionWorld");function EVe(a,e={}){return e.toneMapping=a.toneMapping,e.toneMappingExposure=a.toneMappingExposure,e.outputColorSpace=a.outputColorSpace,e.renderTarget=a.getRenderTarget(),e.activeCubeFace=a.getActiveCubeFace(),e.activeMipmapLevel=a.getActiveMipmapLevel(),e.renderObjectFunction=a.getRenderObjectFunction(),e.pixelRatio=a.getPixelRatio(),e.mrt=a.getMRT(),e.clearColor=a.getClearColor(e.clearColor||new on),e.clearAlpha=a.getClearAlpha(),e.autoClear=a.autoClear,e.scissorTest=a.getScissorTest(),e}function MVe(a,e){return e=EVe(a,e),a.setMRT(null),a.setRenderObjectFunction(null),a.setClearColor(0,1),a.autoClear=!0,e}function CVe(a,e){a.toneMapping=e.toneMapping,a.toneMappingExposure=e.toneMappingExposure,a.outputColorSpace=e.outputColorSpace,a.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),a.setRenderObjectFunction(e.renderObjectFunction),a.setPixelRatio(e.pixelRatio),a.setMRT(e.mrt),a.setClearColor(e.clearColor,e.clearAlpha),a.autoClear=e.autoClear,a.setScissorTest(e.scissorTest)}function NVe(a,e={}){return e.background=a.background,e.backgroundNode=a.backgroundNode,e.overrideMaterial=a.overrideMaterial,e}function RVe(a,e){return e=NVe(a,e),a.background=null,a.backgroundNode=null,a.overrideMaterial=null,e}function PVe(a,e){a.background=e.background,a.backgroundNode=e.backgroundNode,a.overrideMaterial=e.overrideMaterial}function IVe(a,e,n){return n=MVe(a,n),n=RVe(e,n),n}function LVe(a,e,n){CVe(a,n),PVe(e,n)}const CR=new WeakMap,Pre=Ye(({depthTexture:a,shadowCoord:e,depthLayer:n})=>{let i=hi(a,e.xy).setName("t_basic");return a.isArrayTexture&&(i=i.depth(n)),i.compare(e.z)}),Ire=Ye(({depthTexture:a,shadowCoord:e,shadow:n,depthLayer:i})=>{const s=(h,f)=>{let m=hi(a,h);return a.isArrayTexture&&(m=m.depth(i)),m.compare(f)},r=Bi("mapSize","vec2",n).setGroup(Nn),o=Bi("radius","float",n).setGroup(Nn),l=Qt(1).div(r),c=o.mul(l.x),u=b7(y1.xy).mul(6.28318530718);return cr(s(e.xy.add(Id(0,5,u).mul(c)),e.z),s(e.xy.add(Id(1,5,u).mul(c)),e.z),s(e.xy.add(Id(2,5,u).mul(c)),e.z),s(e.xy.add(Id(3,5,u).mul(c)),e.z),s(e.xy.add(Id(4,5,u).mul(c)),e.z)).mul(1/5)}),Lre=Ye(({depthTexture:a,shadowCoord:e,shadow:n,depthLayer:i})=>{const s=(f,m)=>{let A=hi(a,f);return a.isArrayTexture&&(A=A.depth(i)),A.compare(m)},r=Bi("mapSize","vec2",n).setGroup(Nn),o=Qt(1).div(r),l=o.x,c=o.y,u=e.xy,h=Yd(u.mul(r).add(.5));return u.subAssign(h.mul(o)),cr(s(u,e.z),s(u.add(Qt(l,0)),e.z),s(u.add(Qt(0,c)),e.z),s(u.add(o),e.z),Ha(s(u.add(Qt(l.negate(),0)),e.z),s(u.add(Qt(l.mul(2),0)),e.z),h.x),Ha(s(u.add(Qt(l.negate(),c)),e.z),s(u.add(Qt(l.mul(2),c)),e.z),h.x),Ha(s(u.add(Qt(0,c.negate())),e.z),s(u.add(Qt(0,c.mul(2))),e.z),h.y),Ha(s(u.add(Qt(l,c.negate())),e.z),s(u.add(Qt(l,c.mul(2))),e.z),h.y),Ha(Ha(s(u.add(Qt(l.negate(),c.negate())),e.z),s(u.add(Qt(l.mul(2),c.negate())),e.z),h.x),Ha(s(u.add(Qt(l.negate(),c.mul(2))),e.z),s(u.add(Qt(l.mul(2),c.mul(2))),e.z),h.x),h.y)).mul(1/9)}),Dre=Ye(({depthTexture:a,shadowCoord:e,depthLayer:n})=>{let i=hi(a).sample(e.xy);a.isArrayTexture&&(i=i.depth(n)),i=i.rg;const s=i.x,r=Ns(1e-7,i.y.mul(i.y)),o=j4(e.z,s);kn(o.equal(1),()=>Re(1));const l=e.z.sub(s);let c=r.div(r.add(l.mul(l)));return c=Xd(Ka(c,.3).div(.65)),Ns(o,c)}),DVe=Ye(([a,e,n])=>{let i=lf.sub(a).length();return i=i.sub(e).div(n.sub(e)),i=i.saturate(),i}),kVe=a=>{const e=a.shadow.camera,n=Bi("near","float",e).setGroup(Nn),i=Bi("far","float",e).setGroup(Nn),s=gie(a);return DVe(s,n,i)},kre=a=>{let e=CR.get(a);if(e===void 0){const n=a.isPointLight?kVe(a):null;e=new zs,e.colorNode=On(0,0,0,1),e.depthNode=n,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,CR.set(a,e)}return e},Ore=a=>{const e=CR.get(a);e!==void 0&&(e.dispose(),CR.delete(a))},LK=new Jd,Bv=[],Fre=(a,e,n,i)=>{Bv[0]=a,Bv[1]=e;let s=LK.get(Bv);return(s===void 0||s.shadowType!==n||s.useVelocity!==i)&&(s=(r,o,l,c,u,h,...f)=>{(r.castShadow===!0||r.receiveShadow&&n===Hh)&&(i&&(Rne(r).useVelocity=!0),r.onBeforeShadow(a,r,l,e.camera,c,o.overrideMaterial,h),a.renderObject(r,o,l,c,u,h,...f),r.onAfterShadow(a,r,l,e.camera,c,o.overrideMaterial,h))},s.shadowType=n,s.useVelocity=i,LK.set(Bv,s)),Bv[0]=null,Bv[1]=null,s},OVe=Ye(({samples:a,radius:e,size:n,shadowPass:i,depthLayer:s})=>{const r=Re(0).toVar("meanVertical"),o=Re(0).toVar("squareMeanVertical"),l=a.lessThanEqual(Re(1)).select(Re(0),Re(2).div(a.sub(1))),c=a.lessThanEqual(Re(1)).select(Re(0),Re(-1));Li({start:Be(0),end:Be(a),type:"int",condition:"<"},({i:h})=>{const f=c.add(Re(h).mul(l));let m=i.sample(cr(y1.xy,Qt(0,f).mul(e)).div(n));i.value.isArrayTexture&&(m=m.depth(s)),m=m.x,r.addAssign(m),o.addAssign(m.mul(m))}),r.divAssign(a),o.divAssign(a);const u=cl(o.sub(r.mul(r)).max(0));return Qt(r,u)}),FVe=Ye(({samples:a,radius:e,size:n,shadowPass:i,depthLayer:s})=>{const r=Re(0).toVar("meanHorizontal"),o=Re(0).toVar("squareMeanHorizontal"),l=a.lessThanEqual(Re(1)).select(Re(0),Re(2).div(a.sub(1))),c=a.lessThanEqual(Re(1)).select(Re(0),Re(-1));Li({start:Be(0),end:Be(a),type:"int",condition:"<"},({i:h})=>{const f=c.add(Re(h).mul(l));let m=i.sample(cr(y1.xy,Qt(f,0).mul(e)).div(n));i.value.isArrayTexture&&(m=m.depth(s)),r.addAssign(m.x),o.addAssign(cr(m.y.mul(m.y),m.x.mul(m.x)))}),r.divAssign(a),o.divAssign(a);const u=cl(o.sub(r.mul(r)).max(0));return Qt(r,u)}),jVe=[Pre,Ire,Lre,Dre];let U5;const aC=new J4;class jre extends wVe{static get type(){return"ShadowNode"}constructor(e,n=null){super(e),this.shadow=n||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._currentShadowType=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:n,depthTexture:i,shadowCoord:s,shadow:r,depthLayer:o}){const l=s.x.greaterThanEqual(0).and(s.x.lessThanEqual(1)).and(s.y.greaterThanEqual(0)).and(s.y.lessThanEqual(1)).and(s.z.lessThanEqual(1)),c=n({depthTexture:i,shadowCoord:s,shadow:r,depthLayer:o});return l.select(c,Re(1))}setupShadowCoord(e,n){const{shadow:i}=this,{renderer:s}=e,r=Bi("bias","float",i).setGroup(Nn);let o=n,l;if(i.camera.isOrthographicCamera||s.logarithmicDepthBuffer!==!0)o=o.xyz.div(o.w),l=o.z,s.coordinateSystem===bc&&(l=l.mul(2).sub(1));else{const c=o.w;o=o.xy.div(c);const u=Bi("near","float",i.camera).setGroup(Nn),h=Bi("far","float",i.camera).setGroup(Nn);l=u7(c.negate(),u,h)}return o=qe(o.x,o.y.oneMinus(),l.add(r)),o}getShadowFilterFn(e){return jVe[e]}setupRenderTarget(e,n){const i=new Do(e.mapSize.width,e.mapSize.height);i.name="ShadowDepthTexture",i.compareFunction=jx;const s=n.createRenderTarget(e.mapSize.width,e.mapSize.height);return s.texture.name="ShadowMap",s.texture.type=e.mapType,s.depthTexture=i,{shadowMap:s,depthTexture:i}}setupShadow(e){const{renderer:n,camera:i}=e,{light:s,shadow:r}=this,o=n.shadowMap.type,{depthTexture:l,shadowMap:c}=this.setupRenderTarget(r,e);if(r.camera.coordinateSystem=i.coordinateSystem,r.camera.updateProjectionMatrix(),o===Hh&&r.isPointLightShadow!==!0){l.compareFunction=null,c.depth>1?(c._vsmShadowMapVertical||(c._vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:ol,type:cs,depth:c.depth,depthBuffer:!1}),c._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=c._vsmShadowMapVertical,c._vsmShadowMapHorizontal||(c._vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:ol,type:cs,depth:c.depth,depthBuffer:!1}),c._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=c._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:ol,type:cs,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:ol,type:cs,depthBuffer:!1}));let I=hi(l);l.isArrayTexture&&(I=I.depth(this.depthLayer));let F=hi(this.vsmShadowMapVertical.texture);l.isArrayTexture&&(F=F.depth(this.depthLayer));const G=Bi("blurSamples","float",r).setGroup(Nn),O=Bi("radius","float",r).setGroup(Nn),D=Bi("mapSize","vec2",r).setGroup(Nn);let j=this.vsmMaterialVertical||(this.vsmMaterialVertical=new zs);j.fragmentNode=OVe({samples:G,radius:O,size:D,shadowPass:I,depthLayer:this.depthLayer}).context(e.getSharedContext()),j.name="VSMVertical",j=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new zs),j.fragmentNode=FVe({samples:G,radius:O,size:D,shadowPass:F,depthLayer:this.depthLayer}).context(e.getSharedContext()),j.name="VSMHorizontal"}const u=Bi("intensity","float",r).setGroup(Nn),h=Bi("normalBias","float",r).setGroup(Nn),f=aI(s).mul(P7.add(D0.mul(h))),m=this.setupShadowCoord(e,f),A=r.filterNode||this.getShadowFilterFn(n.shadowMap.type)||null;if(A===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const x=o===Hh&&r.isPointLightShadow!==!0?this.vsmShadowMapHorizontal.texture:l,T=this.setupShadowFilter(e,{filterFn:A,shadowTexture:c.texture,depthTexture:x,shadowCoord:m,shadow:r,depthLayer:this.depthLayer});let E;c.texture.isCubeTexture?E=Dl(c.texture,m.xyz):(E=hi(c.texture,m),l.isArrayTexture&&(E=E.depth(this.depthLayer)));const M=Ha(1,T.rgb.mix(E,1),u.mul(E.a)).toVar();this.shadowMap=c,this.shadow.map=c;const N=`${this.light.type} Shadow [ ${this.light.name||"ID: "+this.light.id} ]`;return M.toInspector(`${N} / Color`,()=>this.shadowMap.texture.isCubeTexture?Dl(this.shadowMap.texture):hi(this.shadowMap.texture)).toInspector(`${N} / Depth`,()=>this.shadowMap.texture.isCubeTexture?Dl(this.shadowMap.texture).r.oneMinus():Os(this.shadowMap.depthTexture,Vi().mul(sm(hi(this.shadowMap.depthTexture)))).r.oneMinus())}setup(e){if(e.renderer.shadowMap.enabled!==!1)return Ye(()=>{const n=e.renderer.shadowMap.type;this._currentShadowType!==n&&(this._reset(),this._node=null);let i=this._node;return this.setupShadowPosition(e),i===null&&(this._node=i=this.setupShadow(e),this._currentShadowType=n),e.material.shadowNode&&yt('NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(i=e.material.receivedShadowNode(i)),i})()}renderShadow(e){const{shadow:n,shadowMap:i,light:s}=this,{renderer:r,scene:o}=e;n.updateMatrices(s),i.setSize(n.mapSize.width,n.mapSize.height,i.depth);const l=o.name;o.name=`Shadow Map [ ${s.name||"ID: "+s.id} ]`,r.render(o,n.camera),o.name=l}updateShadow(e){const{shadowMap:n,light:i,shadow:s}=this,{renderer:r,scene:o,camera:l}=e,c=r.shadowMap.type,u=n.depthTexture.version;this._depthVersionCached=u;const h=s.camera.layers.mask;(s.camera.layers.mask&4294967294)===0&&(s.camera.layers.mask=l.layers.mask);const f=r.getRenderObjectFunction(),m=r.getMRT(),A=m?m.has("velocity"):!1;U5=IVe(r,o,U5),o.overrideMaterial=kre(i),r.setRenderObjectFunction(Fre(r,s,c,A)),r.setClearColor(0,0),r.setRenderTarget(n),this.renderShadow(e),r.setRenderObjectFunction(f),c===Hh&&s.isPointLightShadow!==!0&&this.vsmPass(r),s.camera.layers.mask=h,LVe(r,o,U5)}vsmPass(e){const{shadow:n}=this,i=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(n.mapSize.width,n.mapSize.height,i),this.vsmShadowMapHorizontal.setSize(n.mapSize.width,n.mapSize.height,i),e.setRenderTarget(this.vsmShadowMapVertical),aC.material=this.vsmMaterialVertical,aC.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),aC.material=this.vsmMaterialHorizontal,aC.render(e)}dispose(){this._reset(),super.dispose()}_reset(){this._currentShadowType=null,Ore(this.light),this.shadowMap&&(this.shadowMap.dispose(),this.shadowMap=null),this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null)}updateBefore(e){const{shadow:n}=this;let i=n.needsUpdate||n.autoUpdate;i&&(this._cameraFrameId[e.camera]===e.frameId&&(i=!1),this._cameraFrameId[e.camera]=e.frameId),i&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(n.needsUpdate=!1))}}const Bre=(a,e)=>new jre(a,e),BVe=new on,DK=new _n,y2=new ye,V5=new ye,UVe=[new ye(1,0,0),new ye(-1,0,0),new ye(0,-1,0),new ye(0,1,0),new ye(0,0,1),new ye(0,0,-1)],VVe=[new ye(0,-1,0),new ye(0,-1,0),new ye(0,0,-1),new ye(0,0,1),new ye(0,-1,0),new ye(0,-1,0)],zVe=[new ye(1,0,0),new ye(-1,0,0),new ye(0,1,0),new ye(0,-1,0),new ye(0,0,1),new ye(0,0,-1)],GVe=[new ye(0,-1,0),new ye(0,-1,0),new ye(0,0,1),new ye(0,0,-1),new ye(0,-1,0),new ye(0,-1,0)],Ure=Ye(({depthTexture:a,bd3D:e,dp:n})=>Dl(a,e).compare(n)),Vre=Ye(({depthTexture:a,bd3D:e,dp:n,shadow:i})=>{const s=Bi("radius","float",i).setGroup(Nn),r=Bi("mapSize","vec2",i).setGroup(Nn),o=s.div(r.x),l=Ji(e),c=Fl(Mm(e,l.x.greaterThan(l.z).select(qe(0,1,0),qe(1,0,0)))),u=Mm(e,c),h=b7(y1.xy).mul(6.28318530718),f=Id(0,5,h),m=Id(1,5,h),A=Id(2,5,h),x=Id(3,5,h),T=Id(4,5,h);return Dl(a,e.add(c.mul(f.x).add(u.mul(f.y)).mul(o))).compare(n).add(Dl(a,e.add(c.mul(m.x).add(u.mul(m.y)).mul(o))).compare(n)).add(Dl(a,e.add(c.mul(A.x).add(u.mul(A.y)).mul(o))).compare(n)).add(Dl(a,e.add(c.mul(x.x).add(u.mul(x.y)).mul(o))).compare(n)).add(Dl(a,e.add(c.mul(T.x).add(u.mul(T.y)).mul(o))).compare(n)).mul(1/5)}),qVe=Ye(({filterFn:a,depthTexture:e,shadowCoord:n,shadow:i})=>{const s=n.xyz.toVar(),r=s.length(),o=Rn("float").setGroup(Nn).onRenderUpdate(()=>i.camera.near),l=Rn("float").setGroup(Nn).onRenderUpdate(()=>i.camera.far),c=Bi("bias","float",i).setGroup(Nn),u=Re(1).toVar();return kn(r.sub(l).lessThanEqual(0).and(r.sub(o).greaterThanEqual(0)),()=>{const h=r.sub(o).div(l.sub(o)).toVar();h.addAssign(c);const f=s.normalize();u.assign(a({depthTexture:e,bd3D:f,dp:h,shadow:i}))}),u});class HVe extends jre{static get type(){return"PointShadowNode"}constructor(e,n=null){super(e,n)}getShadowFilterFn(e){return e===WZ?Ure:Vre}setupShadowCoord(e,n){return n}setupShadowFilter(e,{filterFn:n,depthTexture:i,shadowCoord:s,shadow:r}){return qVe({filterFn:n,depthTexture:i,shadowCoord:s,shadow:r})}setupRenderTarget(e,n){const i=new cj(e.mapSize.width);i.name="PointShadowDepthTexture",i.compareFunction=jx;const s=n.createCubeRenderTarget(e.mapSize.width);return s.texture.name="PointShadowMap",s.depthTexture=i,{shadowMap:s,depthTexture:i}}renderShadow(e){const{shadow:n,shadowMap:i,light:s}=this,{renderer:r,scene:o}=e,l=n.camera,c=n.matrix,u=r.coordinateSystem===bc,h=u?UVe:zVe,f=u?VVe:GVe;i.setSize(n.mapSize.width,n.mapSize.width);const m=r.autoClear,A=r.getClearColor(BVe),x=r.getClearAlpha();r.autoClear=!1,r.setClearColor(n.clearColor,n.clearAlpha);for(let T=0;T<6;T++){r.setRenderTarget(i,T),r.clear();const E=s.distance||l.far;E!==l.far&&(l.far=E,l.updateProjectionMatrix()),y2.setFromMatrixPosition(s.matrixWorld),l.position.copy(y2),V5.copy(l.position),V5.add(h[T]),l.up.copy(f[T]),l.lookAt(V5),l.updateMatrixWorld(),c.makeTranslation(-y2.x,-y2.y,-y2.z),DK.multiplyMatrices(l.projectionMatrix,l.matrixWorldInverse),n._frustum.setFromProjectionMatrix(DK,l.coordinateSystem,l.reversedDepth);const M=o.name;o.name=`Point Light Shadow [ ${s.name||"ID: "+s.id} ] - Face ${T+1}`,r.render(o,l),o.name=M}r.autoClear=m,r.setClearColor(A,x)}}const zre=(a,e)=>new HVe(a,e);class v1 extends $x{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new on,this.colorNode=e&&e.colorNode||Rn(this.color).setGroup(Nn),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=fa.FRAME,e&&e.shadow&&(this._shadowDisposeListener=()=>{this.disposeShadow()},e.addEventListener("dispose",this._shadowDisposeListener))}dispose(){this._shadowDisposeListener&&this.light.removeEventListener("dispose",this._shadowDisposeListener),super.dispose()}disposeShadow(){this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null),this.shadowColorNode=null,this.baseColorNode!==null&&(this.colorNode=this.baseColorNode,this.baseColorNode=null)}getHash(){return this.light.uuid}getLightVector(e){return C7(this.light).sub(e.context.positionView||tr)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return Bre(this.light)}setupShadow(e){const{renderer:n}=e;if(n.shadowMap.enabled===!1)return;let i=this.shadowColorNode;if(i===null){const s=this.light.shadow.shadowNode;let r;s!==void 0?r=rn(s):r=this.setupShadowNode(),this.shadowNode=r,this.shadowColorNode=i=this.colorNode.mul(r),this.baseColorNode=this.colorNode}e.context.getShadow&&(i=e.context.getShadow(this,e)),this.colorNode=i}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const n=this.setupDirect(e),i=this.setupDirectRectArea(e);n&&e.lightsNode.setupDirectLight(e,this,n),i&&e.lightsNode.setupDirectRectAreaLight(e,this,i)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const I7=Ye(({lightDistance:a,cutoffDistance:e,decayExponent:n})=>{const i=a.pow(n).max(.01).reciprocal();return e.greaterThan(0).select(i.mul(a.div(e).pow4().oneMinus().clamp().pow2()),i)}),Gre=({color:a,lightVector:e,cutoffDistance:n,decayExponent:i})=>{const s=e.normalize(),r=e.length(),o=I7({lightDistance:r,cutoffDistance:n,decayExponent:i}),l=a.mul(o);return{lightDirection:s,lightColor:l}};class WVe extends v1{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=Rn(0).setGroup(Nn),this.decayExponentNode=Rn(2).setGroup(Nn)}update(e){const{light:n}=this;super.update(e),this.cutoffDistanceNode.value=n.distance,this.decayExponentNode.value=n.decay}setupShadowNode(){return zre(this.light)}setupDirect(e){return Gre({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const $Ve=Ye(([a=Vi()])=>{const e=a.mul(2),n=e.x.floor(),i=e.y.floor();return n.add(i).mod(2).sign()}),KVe=Ye(([a=Vi()],{renderer:e,material:n})=>{const i=BB(a.mul(2).sub(1));let s;if(n.alphaToCoverage&&e.currentSamples>0){const r=Re(i.fwidth()).toVar();s=Qd(r.oneMinus(),r.add(1),i).oneMinus()}else s=Io(i.greaterThan(1),0,1);return s}),_S=Ye(([a,e,n])=>{const i=Re(n).toVar(),s=Re(e).toVar(),r=Ku(a).toVar();return Io(r,s,i)}).setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),NR=Ye(([a,e])=>{const n=Ku(e).toVar(),i=Re(a).toVar();return Io(n,i.negate(),i)}).setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),lr=Ye(([a])=>{const e=Re(a).toVar();return Be(rf(e))}).setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),xs=Ye(([a,e])=>{const n=Re(a).toVar();return e.assign(lr(n)),n.sub(Re(e))}),YVe=Ye(([a,e,n,i,s,r])=>{const o=Re(r).toVar(),l=Re(s).toVar(),c=Re(i).toVar(),u=Re(n).toVar(),h=Re(e).toVar(),f=Re(a).toVar(),m=Re(Ka(1,l)).toVar();return Ka(1,o).mul(f.mul(m).add(h.mul(l))).add(o.mul(u.mul(m).add(c.mul(l))))}).setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),XVe=Ye(([a,e,n,i,s,r])=>{const o=Re(r).toVar(),l=Re(s).toVar(),c=qe(i).toVar(),u=qe(n).toVar(),h=qe(e).toVar(),f=qe(a).toVar(),m=Re(Ka(1,l)).toVar();return Ka(1,o).mul(f.mul(m).add(h.mul(l))).add(o.mul(u.mul(m).add(c.mul(l))))}).setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]}),qre=Bo([YVe,XVe]),QVe=Ye(([a,e,n,i,s,r,o,l,c,u,h])=>{const f=Re(h).toVar(),m=Re(u).toVar(),A=Re(c).toVar(),x=Re(l).toVar(),T=Re(o).toVar(),E=Re(r).toVar(),M=Re(s).toVar(),N=Re(i).toVar(),I=Re(n).toVar(),F=Re(e).toVar(),G=Re(a).toVar(),O=Re(Ka(1,A)).toVar(),D=Re(Ka(1,m)).toVar();return Re(Ka(1,f)).toVar().mul(D.mul(G.mul(O).add(F.mul(A))).add(m.mul(I.mul(O).add(N.mul(A))))).add(f.mul(D.mul(M.mul(O).add(E.mul(A))).add(m.mul(T.mul(O).add(x.mul(A))))))}).setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),JVe=Ye(([a,e,n,i,s,r,o,l,c,u,h])=>{const f=Re(h).toVar(),m=Re(u).toVar(),A=Re(c).toVar(),x=qe(l).toVar(),T=qe(o).toVar(),E=qe(r).toVar(),M=qe(s).toVar(),N=qe(i).toVar(),I=qe(n).toVar(),F=qe(e).toVar(),G=qe(a).toVar(),O=Re(Ka(1,A)).toVar(),D=Re(Ka(1,m)).toVar();return Re(Ka(1,f)).toVar().mul(D.mul(G.mul(O).add(F.mul(A))).add(m.mul(I.mul(O).add(N.mul(A))))).add(f.mul(D.mul(M.mul(O).add(E.mul(A))).add(m.mul(T.mul(O).add(x.mul(A))))))}).setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),Hre=Bo([QVe,JVe]),ZVe=Ye(([a,e,n])=>{const i=Re(n).toVar(),s=Re(e).toVar(),r=qt(a).toVar(),o=qt(r.bitAnd(qt(7))).toVar(),l=Re(_S(o.lessThan(qt(4)),s,i)).toVar(),c=Re(ia(2,_S(o.lessThan(qt(4)),i,s))).toVar();return NR(l,Ku(o.bitAnd(qt(1)))).add(NR(c,Ku(o.bitAnd(qt(2)))))}).setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),eze=Ye(([a,e,n,i])=>{const s=Re(i).toVar(),r=Re(n).toVar(),o=Re(e).toVar(),l=qt(a).toVar(),c=qt(l.bitAnd(qt(15))).toVar(),u=Re(_S(c.lessThan(qt(8)),o,r)).toVar(),h=Re(_S(c.lessThan(qt(4)),r,_S(c.equal(qt(12)).or(c.equal(qt(14))),o,s))).toVar();return NR(u,Ku(c.bitAnd(qt(1)))).add(NR(h,Ku(c.bitAnd(qt(2)))))}).setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),so=Bo([ZVe,eze]),tze=Ye(([a,e,n])=>{const i=Re(n).toVar(),s=Re(e).toVar(),r=A1(a).toVar();return qe(so(r.x,s,i),so(r.y,s,i),so(r.z,s,i))}).setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),nze=Ye(([a,e,n,i])=>{const s=Re(i).toVar(),r=Re(n).toVar(),o=Re(e).toVar(),l=A1(a).toVar();return qe(so(l.x,o,r,s),so(l.y,o,r,s),so(l.z,o,r,s))}).setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),Ou=Bo([tze,nze]),aze=Ye(([a])=>{const e=Re(a).toVar();return ia(.6616,e)}).setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),ize=Ye(([a])=>{const e=Re(a).toVar();return ia(.982,e)}).setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),sze=Ye(([a])=>{const e=qe(a).toVar();return ia(.6616,e)}).setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),Wre=Bo([aze,sze]),rze=Ye(([a])=>{const e=qe(a).toVar();return ia(.982,e)}).setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),$re=Bo([ize,rze]),eu=Ye(([a,e])=>{const n=Be(e).toVar(),i=qt(a).toVar();return i.shiftLeft(n).bitOr(i.shiftRight(Be(32).sub(n)))}).setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),Kre=Ye(([a,e,n])=>{a.subAssign(n),a.bitXorAssign(eu(n,Be(4))),n.addAssign(e),e.subAssign(a),e.bitXorAssign(eu(a,Be(6))),a.addAssign(n),n.subAssign(e),n.bitXorAssign(eu(e,Be(8))),e.addAssign(a),a.subAssign(n),a.bitXorAssign(eu(n,Be(16))),n.addAssign(e),e.subAssign(a),e.bitXorAssign(eu(a,Be(19))),a.addAssign(n),n.subAssign(e),n.bitXorAssign(eu(e,Be(4))),e.addAssign(a)}),vw=Ye(([a,e,n])=>{const i=qt(n).toVar(),s=qt(e).toVar(),r=qt(a).toVar();return i.bitXorAssign(s),i.subAssign(eu(s,Be(14))),r.bitXorAssign(i),r.subAssign(eu(i,Be(11))),s.bitXorAssign(r),s.subAssign(eu(r,Be(25))),i.bitXorAssign(s),i.subAssign(eu(s,Be(16))),r.bitXorAssign(i),r.subAssign(eu(i,Be(4))),s.bitXorAssign(r),s.subAssign(eu(r,Be(14))),i.bitXorAssign(s),i.subAssign(eu(s,Be(24))),i}).setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),pl=Ye(([a])=>{const e=qt(a).toVar();return Re(e).div(Re(qt(Be(4294967295))))}).setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),uf=Ye(([a])=>{const e=Re(a).toVar();return e.mul(e).mul(e).mul(e.mul(e.mul(6).sub(15)).add(10))}).setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),oze=Ye(([a])=>{const e=Be(a).toVar(),n=qt(qt(1)).toVar(),i=qt(qt(Be(3735928559)).add(n.shiftLeft(qt(2))).add(qt(13))).toVar();return vw(i.add(qt(e)),i,i)}).setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),lze=Ye(([a,e])=>{const n=Be(e).toVar(),i=Be(a).toVar(),s=qt(qt(2)).toVar(),r=qt().toVar(),o=qt().toVar(),l=qt().toVar();return r.assign(o.assign(l.assign(qt(Be(3735928559)).add(s.shiftLeft(qt(2))).add(qt(13))))),r.addAssign(qt(i)),o.addAssign(qt(n)),vw(r,o,l)}).setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),cze=Ye(([a,e,n])=>{const i=Be(n).toVar(),s=Be(e).toVar(),r=Be(a).toVar(),o=qt(qt(3)).toVar(),l=qt().toVar(),c=qt().toVar(),u=qt().toVar();return l.assign(c.assign(u.assign(qt(Be(3735928559)).add(o.shiftLeft(qt(2))).add(qt(13))))),l.addAssign(qt(r)),c.addAssign(qt(s)),u.addAssign(qt(i)),vw(l,c,u)}).setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),uze=Ye(([a,e,n,i])=>{const s=Be(i).toVar(),r=Be(n).toVar(),o=Be(e).toVar(),l=Be(a).toVar(),c=qt(qt(4)).toVar(),u=qt().toVar(),h=qt().toVar(),f=qt().toVar();return u.assign(h.assign(f.assign(qt(Be(3735928559)).add(c.shiftLeft(qt(2))).add(qt(13))))),u.addAssign(qt(l)),h.addAssign(qt(o)),f.addAssign(qt(r)),Kre(u,h,f),u.addAssign(qt(s)),vw(u,h,f)}).setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),dze=Ye(([a,e,n,i,s])=>{const r=Be(s).toVar(),o=Be(i).toVar(),l=Be(n).toVar(),c=Be(e).toVar(),u=Be(a).toVar(),h=qt(qt(5)).toVar(),f=qt().toVar(),m=qt().toVar(),A=qt().toVar();return f.assign(m.assign(A.assign(qt(Be(3735928559)).add(h.shiftLeft(qt(2))).add(qt(13))))),f.addAssign(qt(u)),m.addAssign(qt(c)),A.addAssign(qt(l)),Kre(f,m,A),f.addAssign(qt(o)),m.addAssign(qt(r)),vw(f,m,A)}).setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]}),Ui=Bo([oze,lze,cze,uze,dze]),hze=Ye(([a,e])=>{const n=Be(e).toVar(),i=Be(a).toVar(),s=qt(Ui(i,n)).toVar(),r=A1().toVar();return r.x.assign(s.bitAnd(Be(255))),r.y.assign(s.shiftRight(Be(8)).bitAnd(Be(255))),r.z.assign(s.shiftRight(Be(16)).bitAnd(Be(255))),r}).setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),fze=Ye(([a,e,n])=>{const i=Be(n).toVar(),s=Be(e).toVar(),r=Be(a).toVar(),o=qt(Ui(r,s,i)).toVar(),l=A1().toVar();return l.x.assign(o.bitAnd(Be(255))),l.y.assign(o.shiftRight(Be(8)).bitAnd(Be(255))),l.z.assign(o.shiftRight(Be(16)).bitAnd(Be(255))),l}).setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),Fu=Bo([hze,fze]),pze=Ye(([a])=>{const e=Qt(a).toVar(),n=Be().toVar(),i=Be().toVar(),s=Re(xs(e.x,n)).toVar(),r=Re(xs(e.y,i)).toVar(),o=Re(uf(s)).toVar(),l=Re(uf(r)).toVar(),c=Re(qre(so(Ui(n,i),s,r),so(Ui(n.add(Be(1)),i),s.sub(1),r),so(Ui(n,i.add(Be(1))),s,r.sub(1)),so(Ui(n.add(Be(1)),i.add(Be(1))),s.sub(1),r.sub(1)),o,l)).toVar();return Wre(c)}).setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),mze=Ye(([a])=>{const e=qe(a).toVar(),n=Be().toVar(),i=Be().toVar(),s=Be().toVar(),r=Re(xs(e.x,n)).toVar(),o=Re(xs(e.y,i)).toVar(),l=Re(xs(e.z,s)).toVar(),c=Re(uf(r)).toVar(),u=Re(uf(o)).toVar(),h=Re(uf(l)).toVar(),f=Re(Hre(so(Ui(n,i,s),r,o,l),so(Ui(n.add(Be(1)),i,s),r.sub(1),o,l),so(Ui(n,i.add(Be(1)),s),r,o.sub(1),l),so(Ui(n.add(Be(1)),i.add(Be(1)),s),r.sub(1),o.sub(1),l),so(Ui(n,i,s.add(Be(1))),r,o,l.sub(1)),so(Ui(n.add(Be(1)),i,s.add(Be(1))),r.sub(1),o,l.sub(1)),so(Ui(n,i.add(Be(1)),s.add(Be(1))),r,o.sub(1),l.sub(1)),so(Ui(n.add(Be(1)),i.add(Be(1)),s.add(Be(1))),r.sub(1),o.sub(1),l.sub(1)),c,u,h)).toVar();return $re(f)}).setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]}),L7=Bo([pze,mze]),gze=Ye(([a])=>{const e=Qt(a).toVar(),n=Be().toVar(),i=Be().toVar(),s=Re(xs(e.x,n)).toVar(),r=Re(xs(e.y,i)).toVar(),o=Re(uf(s)).toVar(),l=Re(uf(r)).toVar(),c=qe(qre(Ou(Fu(n,i),s,r),Ou(Fu(n.add(Be(1)),i),s.sub(1),r),Ou(Fu(n,i.add(Be(1))),s,r.sub(1)),Ou(Fu(n.add(Be(1)),i.add(Be(1))),s.sub(1),r.sub(1)),o,l)).toVar();return Wre(c)}).setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),Aze=Ye(([a])=>{const e=qe(a).toVar(),n=Be().toVar(),i=Be().toVar(),s=Be().toVar(),r=Re(xs(e.x,n)).toVar(),o=Re(xs(e.y,i)).toVar(),l=Re(xs(e.z,s)).toVar(),c=Re(uf(r)).toVar(),u=Re(uf(o)).toVar(),h=Re(uf(l)).toVar(),f=qe(Hre(Ou(Fu(n,i,s),r,o,l),Ou(Fu(n.add(Be(1)),i,s),r.sub(1),o,l),Ou(Fu(n,i.add(Be(1)),s),r,o.sub(1),l),Ou(Fu(n.add(Be(1)),i.add(Be(1)),s),r.sub(1),o.sub(1),l),Ou(Fu(n,i,s.add(Be(1))),r,o,l.sub(1)),Ou(Fu(n.add(Be(1)),i,s.add(Be(1))),r.sub(1),o,l.sub(1)),Ou(Fu(n,i.add(Be(1)),s.add(Be(1))),r,o.sub(1),l.sub(1)),Ou(Fu(n.add(Be(1)),i.add(Be(1)),s.add(Be(1))),r.sub(1),o.sub(1),l.sub(1)),c,u,h)).toVar();return $re(f)}).setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),_w=Bo([gze,Aze]),yze=Ye(([a])=>{const e=Re(a).toVar(),n=Be(lr(e)).toVar();return pl(Ui(n))}).setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),vze=Ye(([a])=>{const e=Qt(a).toVar(),n=Be(lr(e.x)).toVar(),i=Be(lr(e.y)).toVar();return pl(Ui(n,i))}).setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),_ze=Ye(([a])=>{const e=qe(a).toVar(),n=Be(lr(e.x)).toVar(),i=Be(lr(e.y)).toVar(),s=Be(lr(e.z)).toVar();return pl(Ui(n,i,s))}).setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),xze=Ye(([a])=>{const e=On(a).toVar(),n=Be(lr(e.x)).toVar(),i=Be(lr(e.y)).toVar(),s=Be(lr(e.z)).toVar(),r=Be(lr(e.w)).toVar();return pl(Ui(n,i,s,r))}).setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]}),bze=Bo([yze,vze,_ze,xze]),Sze=Ye(([a])=>{const e=Re(a).toVar(),n=Be(lr(e)).toVar();return qe(pl(Ui(n,Be(0))),pl(Ui(n,Be(1))),pl(Ui(n,Be(2))))}).setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),Tze=Ye(([a])=>{const e=Qt(a).toVar(),n=Be(lr(e.x)).toVar(),i=Be(lr(e.y)).toVar();return qe(pl(Ui(n,i,Be(0))),pl(Ui(n,i,Be(1))),pl(Ui(n,i,Be(2))))}).setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),wze=Ye(([a])=>{const e=qe(a).toVar(),n=Be(lr(e.x)).toVar(),i=Be(lr(e.y)).toVar(),s=Be(lr(e.z)).toVar();return qe(pl(Ui(n,i,s,Be(0))),pl(Ui(n,i,s,Be(1))),pl(Ui(n,i,s,Be(2))))}).setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),Eze=Ye(([a])=>{const e=On(a).toVar(),n=Be(lr(e.x)).toVar(),i=Be(lr(e.y)).toVar(),s=Be(lr(e.z)).toVar(),r=Be(lr(e.w)).toVar();return qe(pl(Ui(n,i,s,r,Be(0))),pl(Ui(n,i,s,r,Be(1))),pl(Ui(n,i,s,r,Be(2))))}).setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]}),iI=Bo([Sze,Tze,wze,Eze]),RR=Ye(([a,e,n,i])=>{const s=Re(i).toVar(),r=Re(n).toVar(),o=Be(e).toVar(),l=qe(a).toVar(),c=Re(0).toVar(),u=Re(1).toVar();return Li(o,()=>{c.addAssign(u.mul(L7(l))),u.mulAssign(s),l.mulAssign(r)}),c}).setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),sI=Ye(([a,e,n,i])=>{const s=Re(i).toVar(),r=Re(n).toVar(),o=Be(e).toVar(),l=qe(a).toVar(),c=qe(0).toVar(),u=Re(1).toVar();return Li(o,()=>{c.addAssign(u.mul(_w(l))),u.mulAssign(s),l.mulAssign(r)}),c}).setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Mze=Ye(([a,e,n,i])=>{const s=Re(i).toVar(),r=Re(n).toVar(),o=Be(e).toVar(),l=qe(a).toVar();return Qt(RR(l,o,r,s),RR(l.add(qe(Be(19),Be(193),Be(17))),o,r,s))}).setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Cze=Ye(([a,e,n,i])=>{const s=Re(i).toVar(),r=Re(n).toVar(),o=Be(e).toVar(),l=qe(a).toVar(),c=qe(sI(l,o,r,s)).toVar(),u=Re(RR(l.add(qe(Be(19),Be(193),Be(17))),o,r,s)).toVar();return On(c,u)}).setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Nze=Ye(([a,e,n,i,s,r,o])=>{const l=Be(o).toVar(),c=Re(r).toVar(),u=Be(s).toVar(),h=Be(i).toVar(),f=Be(n).toVar(),m=Be(e).toVar(),A=Qt(a).toVar(),x=qe(iI(Qt(m.add(h),f.add(u)))).toVar(),T=Qt(x.x,x.y).toVar();T.subAssign(.5),T.mulAssign(c),T.addAssign(.5);const E=Qt(Qt(Re(m),Re(f)).add(T)).toVar(),M=Qt(E.sub(A)).toVar();return kn(l.equal(Be(2)),()=>Ji(M.x).add(Ji(M.y))),kn(l.equal(Be(3)),()=>Ns(Ji(M.x),Ji(M.y))),Yu(M,M)}).setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Rze=Ye(([a,e,n,i,s,r,o,l,c])=>{const u=Be(c).toVar(),h=Re(l).toVar(),f=Be(o).toVar(),m=Be(r).toVar(),A=Be(s).toVar(),x=Be(i).toVar(),T=Be(n).toVar(),E=Be(e).toVar(),M=qe(a).toVar(),N=qe(iI(qe(E.add(A),T.add(m),x.add(f)))).toVar();N.subAssign(.5),N.mulAssign(h),N.addAssign(.5);const I=qe(qe(Re(E),Re(T),Re(x)).add(N)).toVar(),F=qe(I.sub(M)).toVar();return kn(u.equal(Be(2)),()=>Ji(F.x).add(Ji(F.y)).add(Ji(F.z))),kn(u.equal(Be(3)),()=>Ns(Ji(F.x),Ji(F.y),Ji(F.z))),Yu(F,F)}).setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Yx=Bo([Nze,Rze]),Pze=Ye(([a,e,n])=>{const i=Be(n).toVar(),s=Re(e).toVar(),r=Qt(a).toVar(),o=Be().toVar(),l=Be().toVar(),c=Qt(xs(r.x,o),xs(r.y,l)).toVar(),u=Re(1e6).toVar();return Li({start:-1,end:Be(1),name:"x",condition:"<="},({x:h})=>{Li({start:-1,end:Be(1),name:"y",condition:"<="},({y:f})=>{const m=Re(Yx(c,h,f,o,l,s,i)).toVar();u.assign(Tc(u,m))})}),kn(i.equal(Be(0)),()=>{u.assign(cl(u))}),u}).setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Ize=Ye(([a,e,n])=>{const i=Be(n).toVar(),s=Re(e).toVar(),r=Qt(a).toVar(),o=Be().toVar(),l=Be().toVar(),c=Qt(xs(r.x,o),xs(r.y,l)).toVar(),u=Qt(1e6,1e6).toVar();return Li({start:-1,end:Be(1),name:"x",condition:"<="},({x:h})=>{Li({start:-1,end:Be(1),name:"y",condition:"<="},({y:f})=>{const m=Re(Yx(c,h,f,o,l,s,i)).toVar();kn(m.lessThan(u.x),()=>{u.y.assign(u.x),u.x.assign(m)}).ElseIf(m.lessThan(u.y),()=>{u.y.assign(m)})})}),kn(i.equal(Be(0)),()=>{u.assign(cl(u))}),u}).setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Lze=Ye(([a,e,n])=>{const i=Be(n).toVar(),s=Re(e).toVar(),r=Qt(a).toVar(),o=Be().toVar(),l=Be().toVar(),c=Qt(xs(r.x,o),xs(r.y,l)).toVar(),u=qe(1e6,1e6,1e6).toVar();return Li({start:-1,end:Be(1),name:"x",condition:"<="},({x:h})=>{Li({start:-1,end:Be(1),name:"y",condition:"<="},({y:f})=>{const m=Re(Yx(c,h,f,o,l,s,i)).toVar();kn(m.lessThan(u.x),()=>{u.z.assign(u.y),u.y.assign(u.x),u.x.assign(m)}).ElseIf(m.lessThan(u.y),()=>{u.z.assign(u.y),u.y.assign(m)}).ElseIf(m.lessThan(u.z),()=>{u.z.assign(m)})})}),kn(i.equal(Be(0)),()=>{u.assign(cl(u))}),u}).setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Dze=Ye(([a,e,n])=>{const i=Be(n).toVar(),s=Re(e).toVar(),r=qe(a).toVar(),o=Be().toVar(),l=Be().toVar(),c=Be().toVar(),u=qe(xs(r.x,o),xs(r.y,l),xs(r.z,c)).toVar(),h=Re(1e6).toVar();return Li({start:-1,end:Be(1),name:"x",condition:"<="},({x:f})=>{Li({start:-1,end:Be(1),name:"y",condition:"<="},({y:m})=>{Li({start:-1,end:Be(1),name:"z",condition:"<="},({z:A})=>{const x=Re(Yx(u,f,m,A,o,l,c,s,i)).toVar();h.assign(Tc(h,x))})})}),kn(i.equal(Be(0)),()=>{h.assign(cl(h))}),h}).setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),kze=Bo([Pze,Dze]),Oze=Ye(([a,e,n])=>{const i=Be(n).toVar(),s=Re(e).toVar(),r=qe(a).toVar(),o=Be().toVar(),l=Be().toVar(),c=Be().toVar(),u=qe(xs(r.x,o),xs(r.y,l),xs(r.z,c)).toVar(),h=Qt(1e6,1e6).toVar();return Li({start:-1,end:Be(1),name:"x",condition:"<="},({x:f})=>{Li({start:-1,end:Be(1),name:"y",condition:"<="},({y:m})=>{Li({start:-1,end:Be(1),name:"z",condition:"<="},({z:A})=>{const x=Re(Yx(u,f,m,A,o,l,c,s,i)).toVar();kn(x.lessThan(h.x),()=>{h.y.assign(h.x),h.x.assign(x)}).ElseIf(x.lessThan(h.y),()=>{h.y.assign(x)})})})}),kn(i.equal(Be(0)),()=>{h.assign(cl(h))}),h}).setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Fze=Bo([Ize,Oze]),jze=Ye(([a,e,n])=>{const i=Be(n).toVar(),s=Re(e).toVar(),r=qe(a).toVar(),o=Be().toVar(),l=Be().toVar(),c=Be().toVar(),u=qe(xs(r.x,o),xs(r.y,l),xs(r.z,c)).toVar(),h=qe(1e6,1e6,1e6).toVar();return Li({start:-1,end:Be(1),name:"x",condition:"<="},({x:f})=>{Li({start:-1,end:Be(1),name:"y",condition:"<="},({y:m})=>{Li({start:-1,end:Be(1),name:"z",condition:"<="},({z:A})=>{const x=Re(Yx(u,f,m,A,o,l,c,s,i)).toVar();kn(x.lessThan(h.x),()=>{h.z.assign(h.y),h.y.assign(h.x),h.x.assign(x)}).ElseIf(x.lessThan(h.y),()=>{h.z.assign(h.y),h.y.assign(x)}).ElseIf(x.lessThan(h.z),()=>{h.z.assign(x)})})})}),kn(i.equal(Be(0)),()=>{h.assign(cl(h))}),h}).setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),D7=Bo([Lze,jze]),Bze=Ye(([a,e,n,i,s,r,o,l,c,u,h])=>{const f=Be(a).toVar(),m=Qt(e).toVar(),A=Qt(n).toVar(),x=Qt(i).toVar(),T=Re(s).toVar(),E=Re(r).toVar(),M=Re(o).toVar(),N=Ku(l).toVar(),I=Be(c).toVar(),F=Re(u).toVar(),G=Re(h).toVar(),O=m.mul(A).add(x),D=Re(0).toVar();return kn(f.equal(Be(0)),()=>{D.assign(_w(O))}),kn(f.equal(Be(1)),()=>{D.assign(iI(O))}),kn(f.equal(Be(2)),()=>{D.assign(D7(O,T,Be(0)))}),kn(f.equal(Be(3)),()=>{D.assign(sI(qe(O,0),I,F,G))}),D.assign(D.mul(M.sub(E)).add(E)),kn(N,()=>{D.assign(Xd(D,E,M))}),D}).setLayout({name:"mx_unifiednoise2d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"texcoord",type:"vec2"},{name:"freq",type:"vec2"},{name:"offset",type:"vec2"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Uze=Ye(([a,e,n,i,s,r,o,l,c,u,h])=>{const f=Be(a).toVar(),m=qe(e).toVar(),A=qe(n).toVar(),x=qe(i).toVar(),T=Re(s).toVar(),E=Re(r).toVar(),M=Re(o).toVar(),N=Ku(l).toVar(),I=Be(c).toVar(),F=Re(u).toVar(),G=Re(h).toVar(),O=m.mul(A).add(x),D=Re(0).toVar();return kn(f.equal(Be(0)),()=>{D.assign(_w(O))}),kn(f.equal(Be(1)),()=>{D.assign(iI(O))}),kn(f.equal(Be(2)),()=>{D.assign(D7(O,T,Be(0)))}),kn(f.equal(Be(3)),()=>{D.assign(sI(O,I,F,G))}),D.assign(D.mul(M.sub(E)).add(E)),kn(N,()=>{D.assign(Xd(D,E,M))}),D}).setLayout({name:"mx_unifiednoise3d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"position",type:"vec3"},{name:"freq",type:"vec3"},{name:"offset",type:"vec3"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Vze=Ye(([a])=>{const e=a.y,n=a.z,i=qe().toVar();return kn(e.lessThan(1e-4),()=>{i.assign(qe(n,n,n))}).Else(()=>{let s=a.x;s=s.sub(rf(s)).mul(6).toVar();const r=Be(kB(s)),o=s.sub(Re(r)),l=n.mul(e.oneMinus()),c=n.mul(e.mul(o).oneMinus()),u=n.mul(e.mul(o.oneMinus()).oneMinus());kn(r.equal(Be(0)),()=>{i.assign(qe(n,u,l))}).ElseIf(r.equal(Be(1)),()=>{i.assign(qe(c,n,l))}).ElseIf(r.equal(Be(2)),()=>{i.assign(qe(l,n,u))}).ElseIf(r.equal(Be(3)),()=>{i.assign(qe(l,c,n))}).ElseIf(r.equal(Be(4)),()=>{i.assign(qe(u,l,n))}).Else(()=>{i.assign(qe(n,l,c))})}),i}).setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),zze=Ye(([a])=>{const e=qe(a).toVar(),n=Re(e.x).toVar(),i=Re(e.y).toVar(),s=Re(e.z).toVar(),r=Re(Tc(n,Tc(i,s))).toVar(),o=Re(Ns(n,Ns(i,s))).toVar(),l=Re(o.sub(r)).toVar(),c=Re().toVar(),u=Re().toVar(),h=Re().toVar();return h.assign(o),kn(o.greaterThan(0),()=>{u.assign(l.div(o))}).Else(()=>{u.assign(0)}),kn(u.lessThanEqual(0),()=>{c.assign(0)}).Else(()=>{kn(n.greaterThanEqual(o),()=>{c.assign(i.sub(s).div(l))}).ElseIf(i.greaterThanEqual(o),()=>{c.assign(cr(2,s.sub(n).div(l)))}).Else(()=>{c.assign(cr(4,n.sub(i).div(l)))}),c.mulAssign(1/6),kn(c.lessThan(0),()=>{c.addAssign(1)})}),qe(c,u,h)}).setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]}),Gze=Ye(([a])=>{const e=qe(a).toVar(),n=AB(EB(e,qe(.04045))).toVar(),i=qe(e.div(12.92)).toVar(),s=qe(Uu(Ns(e.add(qe(.055)),qe(0)).div(1.055),qe(2.4))).toVar();return Ha(i,s,n)}).setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),Yre=(a,e)=>{a=Re(a),e=Re(e);const n=Qt(e.dFdx(),e.dFdy()).length().mul(.7071067811865476);return Qd(a.sub(n),a.add(n),e)},Xre=(a,e,n,i)=>Ha(a,e,n[i].clamp()),qze=(a,e,n=Vi())=>Xre(a,e,n,"x"),Hze=(a,e,n=Vi())=>Xre(a,e,n,"y"),Wze=(a,e,n,i,s=Vi())=>{const r=s.x.clamp(),o=s.y.clamp(),l=Ha(a,e,r),c=Ha(n,i,r);return Ha(l,c,o)},Qre=(a,e,n,i,s)=>Ha(a,e,Yre(n,i[s])),$ze=(a,e,n,i=Vi())=>Qre(a,e,n,i,"x"),Kze=(a,e,n,i=Vi())=>Qre(a,e,n,i,"y"),Yze=(a=1,e=0,n=Vi())=>n.mul(a).add(e),Xze=(a,e=1)=>(a=Re(a),a.abs().pow(e).mul(a.sign())),Qze=(a,e=1,n=.5)=>Re(a).sub(n).mul(e).add(n),Jze=(a=Vi(),e=1,n=0)=>L7(a.convert("vec2|vec3")).mul(e).add(n),Zze=(a=Vi(),e=1,n=0)=>_w(a.convert("vec2|vec3")).mul(e).add(n),eGe=(a=Vi(),e=1,n=0)=>(a=a.convert("vec2|vec3"),On(_w(a),L7(a.add(Qt(19,73)))).mul(e).add(n)),tGe=(a,e=Vi(),n=Qt(1,1),i=Qt(0,0),s=1,r=0,o=1,l=!1,c=1,u=2,h=.5)=>Bze(a,e.convert("vec2|vec3"),n,i,s,r,o,l,c,u,h),nGe=(a,e=Vi(),n=Qt(1,1),i=Qt(0,0),s=1,r=0,o=1,l=!1,c=1,u=2,h=.5)=>Uze(a,e.convert("vec2|vec3"),n,i,s,r,o,l,c,u,h),aGe=(a=Vi(),e=1)=>kze(a.convert("vec2|vec3"),e,Be(1)),iGe=(a=Vi(),e=1)=>Fze(a.convert("vec2|vec3"),e,Be(1)),sGe=(a=Vi(),e=1)=>D7(a.convert("vec2|vec3"),e,Be(1)),rGe=(a=Vi())=>bze(a.convert("vec2|vec3")),oGe=(a=Vi(),e=3,n=2,i=.5,s=1)=>RR(a,Be(e),n,i).mul(s),lGe=(a=Vi(),e=3,n=2,i=.5,s=1)=>Mze(a,Be(e),n,i).mul(s),cGe=(a=Vi(),e=3,n=2,i=.5,s=1)=>sI(a,Be(e),n,i).mul(s),uGe=(a=Vi(),e=3,n=2,i=.5,s=1)=>Cze(a,Be(e),n,i).mul(s),dGe=(a,e=Re(0))=>cr(a,e),hGe=(a,e=Re(0))=>Ka(a,e),fGe=(a,e=Re(1))=>ia(a,e),pGe=(a,e=Re(1))=>yu(a,e),mGe=(a,e=Re(1))=>hw(a,e),gGe=(a,e=Re(1))=>Uu(a,e),AGe=(a=Re(0),e=Re(1))=>F4(a,e),yGe=()=>Kx,vGe=()=>dre,_Ge=(a,e=Re(1))=>Ka(e,a),xGe=(a,e,n,i)=>a.greaterThan(e).mix(n,i),bGe=(a,e,n,i)=>a.greaterThanEqual(e).mix(n,i),SGe=(a,e,n,i)=>a.equal(e).mix(n,i),TGe=(a,e=null)=>{if(typeof e=="string"){const n={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3},i=e.replace(/^out/,"").toLowerCase();if(n[i]!==void 0)return a.element(n[i])}if(typeof e=="number")return a.element(e);if(typeof e=="string"&&e.length===1){const n={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3};if(n[e]!==void 0)return a.element(n[e])}return a},wGe=(a,e=Qt(.5,.5),n=Qt(1,1),i=Re(0),s=Qt(0,0))=>{let r=a;if(e&&(r=r.sub(e)),n&&(r=r.mul(n)),i){const o=i.mul(Math.PI/180),l=o.cos(),c=o.sin();r=Qt(r.x.mul(l).sub(r.y.mul(c)),r.x.mul(c).add(r.y.mul(l)))}return e&&(r=r.add(e)),s&&(r=r.add(s)),r},EGe=(a,e)=>{a=Qt(a),e=Re(e);const n=e.mul(Math.PI/180);return gw(a,n)},MGe=(a,e,n)=>{a=qe(a),e=Re(e),n=qe(n);const i=e.mul(Math.PI/180),s=n.normalize(),r=i.cos(),o=i.sin(),l=Re(1).sub(r);return a.mul(r).add(s.cross(a).mul(o)).add(s.mul(s.dot(a)).mul(l))},CGe=(a,e)=>(a=qe(a),e=Re(e),i7(a,e)),NGe=Ye(([a,e,n])=>{const i=Fl(a).toVar(),s=Ka(Re(.5).mul(e.sub(n)),lf).div(i).toVar(),r=Ka(Re(-.5).mul(e.sub(n)),lf).div(i).toVar(),o=qe().toVar();o.x=i.x.greaterThan(Re(0)).select(s.x,r.x),o.y=i.y.greaterThan(Re(0)).select(s.y,r.y),o.z=i.z.greaterThan(Re(0)).select(s.z,r.z);const l=Tc(o.x,o.y,o.z).toVar();return lf.add(i.mul(l)).toVar().sub(n)}),Jre=Ye(([a,e])=>{const n=a.x,i=a.y,s=a.z;let r=e.element(0).mul(.886227);return r=r.add(e.element(1).mul(2*.511664).mul(i)),r=r.add(e.element(2).mul(2*.511664).mul(s)),r=r.add(e.element(3).mul(2*.511664).mul(n)),r=r.add(e.element(4).mul(2*.429043).mul(n).mul(i)),r=r.add(e.element(5).mul(2*.429043).mul(i).mul(s)),r=r.add(e.element(6).mul(s.mul(s).mul(.743125).sub(.247708))),r=r.add(e.element(7).mul(2*.429043).mul(n).mul(s)),r=r.add(e.element(8).mul(.429043).mul(ia(n,n).sub(ia(i,i)))),r});var Z=Object.freeze({__proto__:null,BRDF_GGX:m7,BRDF_Lambert:n1,BasicPointShadowFilter:Ure,BasicShadowFilter:Pre,Break:Ese,Const:Hae,Continue:mje,DFGLUT:hT,D_GGX:qse,Discard:oie,EPSILON:MB,F_Schlick:gx,Fn:Ye,HALF_PI:V8e,INFINITY:j8e,If:kn,Loop:Li,NodeAccess:Po,NodeShaderStage:W2,NodeType:o8e,NodeUpdateType:fa,OnBeforeMaterialUpdate:FUe,OnBeforeObjectUpdate:OUe,OnMaterialUpdate:kUe,OnObjectUpdate:DUe,PCFShadowFilter:Ire,PCFSoftShadowFilter:Lre,PI:bR,PI2:B8e,PointShadowFilter:Vre,Return:aFe,Schlick_to_F0:FO,ScriptableNodeResources:h3,ShaderNode:c_,Stack:P4,Switch:N8e,TBNViewMatrix:KA,TWO_PI:U8e,VSMShadowFilter:Dre,V_GGX_SmithCorrelated:Gse,Var:qae,VarIntent:Wae,abs:Ji,acesFilmicToneMapping:bre,acos:RB,add:cr,addMethodChaining:Pt,addNodeElement:oFe,agxToneMapping:Sre,all:mae,alphaT:vR,and:eae,anisotropy:Eg,anisotropyB:ny,anisotropyT:gS,any:gae,append:L8e,array:$ne,arrayBuffer:P8e,asin:_ae,assign:Kne,atan:F4,atan2:jae,atomicAdd:q9e,atomicAnd:K9e,atomicFunc:Qf,atomicLoad:z9e,atomicMax:W9e,atomicMin:$9e,atomicOr:Y9e,atomicStore:G9e,atomicSub:H9e,atomicXor:X9e,attenuationColor:bB,attenuationDistance:xB,attribute:Nm,attributeArray:BUe,backgroundBlurriness:pre,backgroundIntensity:zO,backgroundRotation:mre,batch:Sse,bentNormalView:Bie,billboarding:AUe,bitAnd:iae,bitNot:sae,bitOr:rae,bitXor:oae,bitangentGeometry:$Fe,bitangentLocal:KFe,bitangentView:Fie,bitangentWorld:YFe,bitcast:cre,blendBurn:Ise,blendColor:Ije,blendDodge:Lse,blendOverlay:kse,blendScreen:Dse,blur:Qse,bool:Ku,buffer:fw,bufferAttribute:WB,builtin:km,builtinAOContext:zae,builtinShadowContext:Vae,bumpMap:i7,burn:Dje,bvec2:Une,bvec3:AB,bvec4:Vne,bypass:aie,cache:nie,call:Yne,cameraFar:Dg,cameraIndex:I0,cameraNear:Lg,cameraNormalMatrix:bFe,cameraPosition:mie,cameraProjectionMatrix:om,cameraProjectionMatrixInverse:_Fe,cameraViewMatrix:ad,cameraViewport:SFe,cameraWorldMatrix:xFe,cbrt:Lae,cdl:a9e,ceil:O4,checker:$Ve,cineonToneMapping:xre,clamp:Xd,clearcoat:gR,clearcoatNormalView:$A,clearcoatRoughness:dT,code:tI,color:Bne,colorSpaceToWorking:U4,colorToDirection:QFe,compute:tie,computeKernel:$B,computeSkinning:fje,context:Dm,convert:Gne,convertColorSpace:K8e,convertToTexture:NUe,cos:Rd,countLeadingZeros:$7e,countOneBits:K7e,countTrailingZeros:W7e,cross:Mm,cubeTexture:Dl,cubeTextureBase:a7,dFdx:LB,dFdy:DB,dashSize:i3,debug:cie,decrement:fae,decrementBefore:dae,defaultBuildStages:bO,defaultShaderStages:Lne,defined:lT,degrees:yae,deltaTime:cUe,densityFog:w9e,densityFogFactor:w7,depth:d7,depthPass:l9e,determinant:wae,difference:Rae,diffuseColor:Pi,diffuseContribution:IA,directPointLight:Gre,directionToColor:Uie,directionToFaceDirection:Wx,dispersion:SB,disposeShadowMaterial:Ore,distance:Nae,div:yu,dodge:kje,dot:Yu,drawIndex:_se,dynamicBufferAttribute:Z8e,element:zne,emissive:EO,equal:wB,equals:Mae,equirectUV:h7,exp:CB,exp2:px,expression:Cm,faceDirection:e7,faceForward:VB,faceforward:z8e,float:Re,floatBitsToInt:G7e,floatBitsToUint:ure,floor:rf,fog:pT,fract:Yd,frameGroup:Wne,frameId:dre,frontFacing:vie,fwidth:OB,gain:X7e,gapSize:MO,getConstNodeType:jne,getCurrentStack:pB,getDirection:Yse,getDistanceAttenuation:I7,getGeometryRoughness:zse,getNormalFromDepth:PUe,getParallaxCorrectNormal:NGe,getRoughness:p7,getScreenPosition:RUe,getShIrradianceAt:Jre,getShadowMaterial:kre,getShadowRenderObjectFunction:Fre,getTextureIndex:ore,getViewPosition:t_,ggxConvolution:Jse,globalId:P9e,glsl:A9e,glslFn:y9e,grayscale:ZUe,greaterThan:EB,greaterThanEqual:Zne,hash:Y7e,highpModelNormalViewMatrix:RO,highpModelViewMatrix:NO,hue:n9e,increment:hae,incrementBefore:uae,inspector:die,instance:uje,instanceIndex:cf,instancedArray:UUe,instancedBufferAttribute:SR,instancedDynamicBufferAttribute:CO,instancedMesh:bse,int:Be,intBitsToFloat:q7e,interleavedGradientNoise:b7,inverse:Eae,inverseSqrt:NB,inversesqrt:G8e,invocationLocalIndex:cje,invocationSubgroupIndex:lje,ior:AS,iridescence:L4,iridescenceIOR:AR,iridescenceThickness:yR,isolate:R_,ivec2:yr,ivec3:gB,ivec4:yB,js:m9e,label:Gae,length:of,lengthSq:BB,lessThan:Qne,lessThanEqual:Jne,lightPosition:M7,lightProjectionUV:Nre,lightShadowMatrix:aI,lightTargetDirection:N7,lightTargetPosition:Rre,lightViewPosition:C7,lightingContext:Cse,lights:TVe,linearDepth:wR,linearToneMapping:vre,localId:I9e,log:k4,log2:sf,logarithmicDepthToViewZ:Tje,luminance:S7,mat2:I4,mat3:Oo,mat4:n0,matcapUV:ere,materialAO:Ase,materialAlphaTest:Vie,materialAnisotropy:nse,materialAnisotropyVector:e_,materialAttenuationColor:use,materialAttenuationDistance:cse,materialClearcoat:Xie,materialClearcoatNormal:Jie,materialClearcoatRoughness:Qie,materialColor:zie,materialDispersion:gse,materialEmissive:qie,materialEnvIntensity:o3,materialEnvRotation:n7,materialIOR:lse,materialIridescence:ase,materialIridescenceIOR:ise,materialIridescenceThickness:sse,materialLightMap:r7,materialLineDashOffset:pse,materialLineDashSize:hse,materialLineGapSize:fse,materialLineScale:dse,materialLineWidth:nje,materialMetalness:Kie,materialNormal:Yie,materialOpacity:s7,materialPointSize:mse,materialReference:Hp,materialReflectivity:l3,materialRefractionRatio:Sie,materialRotation:Zie,materialRoughness:$ie,materialSheen:ese,materialSheenRoughness:tse,materialShininess:Gie,materialSpecular:Hie,materialSpecularColor:Wie,materialSpecularIntensity:OO,materialSpecularStrength:yS,materialThickness:ose,materialTransmission:rse,max:Ns,maxMipLevel:KB,mediumpModelViewMatrix:yie,metalness:Xp,min:Tc,mix:Ha,mixElement:kae,mod:hw,modInt:pae,modelDirection:NFe,modelNormalMatrix:Aie,modelPosition:RFe,modelRadius:LFe,modelScale:PFe,modelViewMatrix:L0,modelViewPosition:IFe,modelViewProjection:yse,modelWorldMatrix:Vu,modelWorldMatrixInverse:DFe,morphReference:Mse,mrt:lre,mul:ia,mx_aastep:Yre,mx_add:dGe,mx_atan2:AGe,mx_cell_noise_float:rGe,mx_contrast:Qze,mx_divide:pGe,mx_fractal_noise_float:oGe,mx_fractal_noise_vec2:lGe,mx_fractal_noise_vec3:cGe,mx_fractal_noise_vec4:uGe,mx_frame:vGe,mx_heighttonormal:CGe,mx_hsvtorgb:Vze,mx_ifequal:SGe,mx_ifgreater:xGe,mx_ifgreatereq:bGe,mx_invert:_Ge,mx_modulo:mGe,mx_multiply:fGe,mx_noise_float:Jze,mx_noise_vec3:Zze,mx_noise_vec4:eGe,mx_place2d:wGe,mx_power:gGe,mx_ramp4:Wze,mx_ramplr:qze,mx_ramptb:Hze,mx_rgbtohsv:zze,mx_rotate2d:EGe,mx_rotate3d:MGe,mx_safepower:Xze,mx_separate:TGe,mx_splitlr:$ze,mx_splittb:Kze,mx_srgb_texture_to_lin_rec709:Gze,mx_subtract:hGe,mx_timer:yGe,mx_transform_uv:Yze,mx_unifiednoise2d:tGe,mx_unifiednoise3d:nGe,mx_worley_noise_float:aGe,mx_worley_noise_vec2:iGe,mx_worley_noise_vec3:sGe,negate:IB,neutralToneMapping:Tre,nodeArray:ty,nodeImmutable:sn,nodeObject:rn,nodeObjectIntent:$2,nodeObjects:R4,nodeProxy:sa,nodeProxyIntent:Zt,normalFlat:_ie,normalGeometry:z4,normalLocal:wc,normalMap:kO,normalView:oi,normalViewGeometry:mx,normalWorld:D0,normalWorldGeometry:xie,normalize:Fl,not:nae,notEqual:Xne,numWorkgroups:N9e,objectDirection:TFe,objectGroup:TB,objectPosition:gie,objectRadius:CFe,objectScale:EFe,objectViewPosition:MFe,objectWorldMatrix:wFe,oneMinus:xae,or:tae,orthographicDepthToViewZ:Sje,oscSawtooth:fUe,oscSine:uUe,oscSquare:dUe,oscTriangle:hUe,output:C_,outputStruct:V7e,overlay:Fje,overloadingFn:Bo,packHalf2x16:tUe,packSnorm2x16:Z7e,packUnorm2x16:eUe,parabola:VO,parallaxDirection:jie,parallaxUV:XFe,parameter:k7e,pass:r9e,passTexture:o9e,pcurve:Q7e,perspectiveDepthToViewZ:c7,pmremTexture:A7,pointShadow:zre,pointUV:zUe,pointWidth:D8e,positionGeometry:pw,positionLocal:Es,positionPrevious:TR,positionView:tr,positionViewDirection:qi,positionWorld:lf,positionWorldDirection:ZB,posterize:s9e,pow:Uu,pow2:FB,pow3:Pae,pow4:jB,premultiplyAlpha:Ose,property:im,quadBroadcast:xVe,quadSwapDiagonal:mVe,quadSwapX:fVe,quadSwapY:pVe,radians:Aae,rand:Dae,range:M9e,rangeFog:T9e,rangeFogFactor:T7,reciprocal:Sae,reference:Bi,referenceBuffer:PO,reflect:Cae,reflectVector:Eie,reflectView:Tie,reflector:TUe,refract:UB,refractVector:Mie,refractView:wie,reinhardToneMapping:_re,remap:sie,remapClamp:rie,renderGroup:Nn,renderOutput:lie,rendererReference:Jae,replaceDefaultUV:pUe,rotate:gw,rotateUV:mUe,roughness:Uh,round:bae,rtt:fre,sRGBTransferEOTF:Kae,sRGBTransferOETF:Yae,sample:LUe,sampler:fFe,samplerComparison:pFe,saturate:B4,saturation:e9e,screen:Oje,screenCoordinate:y1,screenDPR:fie,screenSize:t1,screenUV:rm,scriptable:S9e,scriptableValue:d3,select:Io,setCurrentStack:cT,setName:zB,shaderStages:SO,shadow:Bre,shadowPositionWorld:P7,shapeCircle:KVe,sharedUniformGroup:D4,sheen:Xc,sheenRoughness:Ig,shiftLeft:lae,shiftRight:cae,shininess:_R,sign:PB,sin:Rl,sinc:J7e,skinning:wse,smoothstep:Qd,smoothstepElement:Oae,specularColor:v0,specularColorBlended:WA,specularF90:M_,spherizeUV:gUe,split:I8e,spritesheetUV:_Ue,sqrt:cl,stack:c3,step:j4,stepElement:Fae,storage:lm,storageBarrier:O9e,storageObject:rje,storageTexture:gre,string:R8e,struct:U7e,sub:Ka,subBuild:N_,subgroupAdd:Z9e,subgroupAll:uVe,subgroupAnd:sVe,subgroupAny:dVe,subgroupBallot:J9e,subgroupBroadcast:gVe,subgroupBroadcastFirst:hVe,subgroupElect:Q9e,subgroupExclusiveAdd:tVe,subgroupExclusiveMul:iVe,subgroupInclusiveAdd:eVe,subgroupInclusiveMul:aVe,subgroupIndex:oje,subgroupMax:cVe,subgroupMin:lVe,subgroupMul:nVe,subgroupOr:rVe,subgroupShuffle:AVe,subgroupShuffleDown:_Ve,subgroupShuffleUp:vVe,subgroupShuffleXor:yVe,subgroupSize:L9e,subgroupXor:oVe,tan:vae,tangentGeometry:q4,tangentLocal:mw,tangentView:H4,tangentWorld:Oie,texture:hi,texture3D:eI,texture3DLevel:KUe,texture3DLoad:$Ue,textureBarrier:F9e,textureBicubic:pBe,textureBicubicLevel:g7,textureCubeUV:Xse,textureLevel:hFe,textureLoad:Os,textureSize:sm,textureStore:qUe,thickness:_B,time:Kx,toneMapping:Zae,toneMappingExposure:eie,toonOutlinePass:u9e,transformDirection:Iae,transformNormal:bie,transformNormalToView:t7,transformedClearcoatNormalView:jFe,transformedNormalView:OFe,transformedNormalWorld:FFe,transmission:xR,transpose:Tae,triNoise3D:rUe,triplanarTexture:xUe,triplanarTextures:hre,trunc:kB,uint:qt,uintBitsToFloat:H7e,uniform:Rn,uniformArray:sl,uniformCubeTexture:UFe,uniformFlow:Uae,uniformGroup:Hne,uniformTexture:dFe,unpackHalf2x16:iUe,unpackNormal:DO,unpackSnorm2x16:nUe,unpackUnorm2x16:aUe,unpremultiplyAlpha:Lje,userData:XUe,uv:Vi,uvec2:mB,uvec3:A1,uvec4:vB,varying:Xf,varyingProperty:uT,vec2:Qt,vec3:qe,vec4:On,vectorComponents:m1,velocity:JUe,vertexColor:Pse,vertexIndex:vse,vertexStage:$ae,vibrance:t9e,viewZToLogarithmicDepth:u7,viewZToOrthographicDepth:P_,viewZToPerspectiveDepth:Nse,viewport:QB,viewportCoordinate:pie,viewportDepthTexture:l7,viewportLinearDepth:wje,viewportMipTexture:o7,viewportResolution:vFe,viewportSafeUV:yUe,viewportSharedTexture:Gje,viewportSize:JB,viewportTexture:xje,viewportUV:yFe,vogelDiskSample:Id,wgsl:g9e,wgslFn:v9e,workgroupArray:U9e,workgroupBarrier:k9e,workgroupId:R9e,workingToColorSpace:Xae,xor:aae});const Td=new y7;class RGe extends k0{constructor(e,n){super(),this.renderer=e,this.nodes=n}update(e,n,i){const s=this.renderer,r=this.nodes.getBackgroundNode(e)||e.background;let o=!1;if(r===null)s._clearColor.getRGB(Td),Td.a=s._clearColor.a;else if(r.isColor===!0)r.getRGB(Td),Td.a=1,o=!0;else if(r.isNode===!0){const c=this.get(e),u=r;Td.copy(s._clearColor);let h=c.backgroundMesh;if(h===void 0){let N=function(){r.removeEventListener("dispose",N),h.material.dispose(),h.geometry.dispose()};const m=On(u).mul(zO).context({getUV:()=>mre.mul(xie),getTextureLevel:()=>pre}),A=om.element(3).element(3).equal(1),x=yu(1,om.element(1).element(1)).mul(3),T=A.select(Es.mul(x),Es);let E=om.mul(L0.mul(On(T,0)));E=E.setZ(E.w);const M=new zs;M.name="Background.material",M.side=Di,M.depthTest=!1,M.depthWrite=!1,M.allowOverride=!1,M.fog=!1,M.lights=!1,M.vertexNode=E,M.colorNode=m,c.backgroundMeshNode=m,c.backgroundMesh=h=new Na(new vu(1,32,32),M),h.frustumCulled=!1,h.name="Background.mesh",r.addEventListener("dispose",N)}const f=u.getCacheKey();c.backgroundCacheKey!==f&&(c.backgroundMeshNode.node=On(u).mul(zO),c.backgroundMeshNode.needsUpdate=!0,h.material.needsUpdate=!0,c.backgroundCacheKey=f),n.unshift(h,h.geometry,h.material,0,0,null,null)}else Rt("Renderer: Unsupported background configuration.",r);const l=s.xr.getEnvironmentBlendMode();if(l==="additive"?Td.set(0,0,0,1):l==="alpha-blend"&&Td.set(0,0,0,0),s.autoClear===!0||o===!0){const c=i.clearColorValue;c.r=Td.r,c.g=Td.g,c.b=Td.b,c.a=Td.a,(s.backend.isWebGLBackend===!0||s.alpha===!0)&&(c.r*=c.a,c.g*=c.a,c.b*=c.a),i.depthClearValue=s._clearDepth,i.stencilClearValue=s._clearStencil,i.clearColor=s.autoClearColor===!0,i.clearDepth=s.autoClearDepth===!0,i.clearStencil=s.autoClearStencil===!0}else i.clearColor=!1,i.clearDepth=!1,i.clearStencil=!1}}let PGe=0;class GO{constructor(e="",n=[],i=0,s=[]){this.name=e,this.bindings=n,this.index=i,this.bindingsReference=s,this.id=PGe++}}class IGe{constructor(e,n,i,s,r,o,l,c,u,h=[]){this.vertexShader=e,this.fragmentShader=n,this.computeShader=i,this.transforms=h,this.nodeAttributes=s,this.bindings=r,this.updateNodes=o,this.updateBeforeNodes=l,this.updateAfterNodes=c,this.observer=u,this.usedTimes=0}createBindings(){const e=[];for(const n of this.bindings)if(n.bindings[0].groupNode.shared!==!0){const s=new GO(n.name,[],n.index,n.bindingsReference);e.push(s);for(const r of n.bindings)s.bindings.push(r.clone())}else e.push(n);return e}}class kK{constructor(e,n,i=null){this.isNodeAttribute=!0,this.name=e,this.type=n,this.node=i}}class LGe{constructor(e,n,i){this.isNodeUniform=!0,this.name=e,this.type=n,this.node=i}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class Zre{constructor(e,n,i=!1,s=null){this.isNodeVar=!0,this.name=e,this.type=n,this.readOnly=i,this.count=s}}class DGe extends Zre{constructor(e,n,i=null,s=null){super(e,n),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=i,this.interpolationSampling=s}}class kGe{constructor(e,n,i=""){this.name=e,this.type=n,this.code=i,Object.defineProperty(this,"isNodeCode",{value:!0})}}let OGe=0;class z5{constructor(e=null){this.id=OGe++,this.nodesData=new WeakMap,this.parent=e}getData(e){let n=this.nodesData.get(e);return n===void 0&&this.parent!==null&&(n=this.parent.getData(e)),n}setData(e,n){this.nodesData.set(e,n)}}class FGe{constructor(e,n){this.name=e,this.members=n,this.output=!1}}class O0{constructor(e,n){this.name=e,this.value=n,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class jGe extends O0{constructor(e,n=0){super(e,n),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class BGe extends O0{constructor(e,n=new Nt){super(e,n),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class UGe extends O0{constructor(e,n=new ye){super(e,n),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class VGe extends O0{constructor(e,n=new qn){super(e,n),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class zGe extends O0{constructor(e,n=new on){super(e,n),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class GGe extends O0{constructor(e,n=new rw){super(e,n),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class qGe extends O0{constructor(e,n=new ga){super(e,n),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class HGe extends O0{constructor(e,n=new _n){super(e,n),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class WGe extends jGe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class $Ge extends BGe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class KGe extends UGe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class YGe extends VGe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class XGe extends zGe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class QGe extends GGe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class JGe extends qGe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class ZGe extends HGe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}let eqe=0;const tqe=new WeakMap,OK=new WeakMap,nqe=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),iC=a=>/e/g.test(a)?String(a).replace(/\+/g,""):(a=Number(a),a+(a%1?"":".0"));class eoe{constructor(e,n,i){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=n,this.parser=i,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.types={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=c3(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new z5,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.subBuildLayers=[],this.activeStacks=[],this.subBuildFn=null,this.fnCall=null,Object.defineProperty(this,"id",{value:eqe++})}isOpaque(){const e=this.material;return e.transparent===!1&&e.blending===fl&&e.alphaToCoverage===!1}getBindGroupsCache(){let e=OK.get(this.renderer);return e===void 0&&(e=new Jd,OK.set(this.renderer,e)),e}createRenderTarget(e,n,i){return new th(e,n,i)}createCubeRenderTarget(e,n){return new Fse(e,n)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,n){const i=this.getBindGroupsCache(),s=[];let r=!0;for(const l of n)s.push(l),r=r&&l.groupNode.shared!==!0;let o;return r?(o=i.get(s),o===void 0&&(o=new GO(e,s,this.bindingsIndexes[e].group,s),i.set(s,o))):o=new GO(e,s,this.bindingsIndexes[e].group,s),o}getBindGroupArray(e,n){const i=this.bindings[n];let s=i[e];return s===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),i[e]=s=[]),s}getBindings(){let e=this.bindGroups;if(e===null){const n={},i=this.bindings;for(const s of SO)for(const r in i[s]){const o=i[s][r];(n[r]||(n[r]=[])).push(...o)}e=[];for(const s in n){const r=n[s],o=this._getBindGroup(s,r);e.push(o)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((n,i)=>n.bindings[0].groupNode.order-i.bindings[0].groupNode.order);for(let n=0;n<e.length;n++){const i=e[n];this.bindingsIndexes[i.name].group=n,i.index=n}}setHashNode(e,n){this.hashNodes[n]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==fa.NONE&&this.updateNodes.push(e);for(const e of this.sequentialNodes){const n=e.getUpdateBeforeType(),i=e.getUpdateAfterType();n!==fa.NONE&&this.updateBeforeNodes.push(e),i!==fa.NONE&&this.updateAfterNodes.push(e)}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===di||e.magFilter===Zg||e.magFilter===Od||e.magFilter===No||e.minFilter===di||e.minFilter===Zg||e.minFilter===Od||e.minFilter===No}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getTernary(){return null}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,n){return this.flowNodes[e].push(n),n}setContext(e){this.context=e}getContext(){return this.context}addContext(e){const n=this.getContext();return this.setContext({...this.context,...e}),n}getSharedContext(){const e={...this.context};return delete e.material,delete e.getUV,delete e.getOutput,delete e.getTextureLevel,delete e.getAO,delete e.getShadow,e}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,n=!0){const i=this.getDataFromNode(e);return i.cache===void 0&&(i.cache=new z5(n?this.getCache():null)),i.cache}isAvailable(){return!1}getVertexIndex(){yt("Abstract function.")}getInstanceIndex(){yt("Abstract function.")}getDrawIndex(){yt("Abstract function.")}getFrontFacing(){yt("Abstract function.")}getFragCoord(){yt("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const n=this.getDataFromNode(e);return n.usageCount=n.usageCount===void 0?1:n.usageCount+1,n.usageCount}generateTexture(){yt("Abstract function.")}generateTextureLod(){yt("Abstract function.")}generateArrayDeclaration(e,n){return this.getType(e)+"[ "+n+" ]"}generateArray(e,n,i=null){let s=this.generateArrayDeclaration(e,n)+"( ";for(let r=0;r<n;r++){const o=i?i[r]:null;o!==null?s+=o.build(this,e):s+=this.generateConst(e),r<n-1&&(s+=", ")}return s+=" )",s}generateStruct(e,n,i=null){const s=[];for(const r of n){const{name:o,type:l}=r;i&&i[o]&&i[o].isNode?s.push(i[o].build(this,l)):s.push(this.generateConst(l))}return e+"( "+s.join(", ")+" )"}generateConst(e,n=null){if(n===null&&(e==="float"||e==="int"||e==="uint"?n=0:e==="bool"?n=!1:e==="color"?n=new on:e==="vec2"||e==="uvec2"||e==="ivec2"?n=new Nt:e==="vec3"||e==="uvec3"||e==="ivec3"?n=new ye:(e==="vec4"||e==="uvec4"||e==="ivec4")&&(n=new qn)),e==="float")return iC(n);if(e==="int")return`${Math.round(n)}`;if(e==="uint")return n>=0?`${Math.round(n)}u`:"0u";if(e==="bool")return n?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${iC(n.r)}, ${iC(n.g)}, ${iC(n.b)} )`;const i=this.getTypeLength(e),s=this.getComponentType(e),r=o=>this.generateConst(s,o);if(i===2)return`${this.getType(e)}( ${r(n.x)}, ${r(n.y)} )`;if(i===3)return`${this.getType(e)}( ${r(n.x)}, ${r(n.y)}, ${r(n.z)} )`;if(i===4&&e!=="mat2")return`${this.getType(e)}( ${r(n.x)}, ${r(n.y)}, ${r(n.z)}, ${r(n.w)} )`;if(i>=4&&n&&(n.isMatrix2||n.isMatrix3||n.isMatrix4))return`${this.getType(e)}( ${n.elements.map(r).join(", ")} )`;if(i>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,n){const i=this.attributes;for(const r of i)if(r.name===e)return r;const s=new kK(e,n);return this.registerDeclaration(s),i.push(s),s}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const n=e.type;if(e.isDataTexture){if(n===jr)return"int";if(n===Ei)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const n=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return n===null?null:n[1]==="b"?"bool":n[1]==="i"?"int":n[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,n="float"){if(e===1)return n;let i=Cne(e);const s=n==="float"?"":n[0];return/mat2/.test(n)===!0&&(i=i.replace("vec","mat")),s+i}getTypeFromArray(e){return nqe.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const i=n.array,s=e.itemSize,r=e.normalized;let o;return!(e instanceof sj)&&r!==!0&&(o=this.getTypeFromArray(i)),this.getTypeFromLength(s,o)}getTypeLength(e){const n=this.getVectorType(e),i=/vec([2-4])/.exec(n);return i!==null?Number(i[1]):n==="float"||n==="bool"||n==="int"||n==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,n){return this.getTypeFromLength(this.getTypeLength(e),n)}getIntegerType(e){const n=this.getComponentType(e);return n==="int"||n==="uint"?e:this.changeComponentType(e,"int")}setActiveStack(e){this.activeStacks.push(e)}removeActiveStack(e){if(this.activeStacks[this.activeStacks.length-1]===e)this.activeStacks.pop();else throw new Error("NodeBuilder: Invalid active stack removal.")}getActiveStack(){return this.activeStacks[this.activeStacks.length-1]}getBaseStack(){return this.activeStacks[0]}addStack(){this.stack=c3(this.stack);const e=pB();return this.stacks.push(e),cT(this.stack),this.stack}removeStack(){const e=this.stack;for(const n of e.nodes){const i=this.getDataFromNode(n);i.stack=e}return this.stack=e.parent,cT(this.stacks.pop()),e}getDataFromNode(e,n=this.shaderStage,i=null){i=i===null?e.isGlobal(this)?this.globalCache:this.cache:i;let s=i.getData(e);s===void 0&&(s={},i.setData(e,s)),s[n]===void 0&&(s[n]={});let r=s[n];const o=s.any?s.any.subBuilds:null,l=this.getClosestSubBuild(o);return l&&(r.subBuildsCache===void 0&&(r.subBuildsCache={}),r=r.subBuildsCache[l]||(r.subBuildsCache[l]={}),r.subBuilds=o),r}getNodeProperties(e,n="any"){const i=this.getDataFromNode(e,n);return i.properties||(i.properties={outputNode:null})}getBufferAttributeFromNode(e,n){const i=this.getDataFromNode(e,"vertex");let s=i.bufferAttribute;if(s===void 0){const r=this.uniforms.index++;s=new kK("nodeAttribute"+r,n,e),this.bufferAttributes.push(s),i.bufferAttribute=s}return s}getStructTypeNode(e,n=this.shaderStage){return this.types[n][e]||null}getStructTypeFromNode(e,n,i=null,s=this.shaderStage){const r=this.getDataFromNode(e,s,this.globalCache);let o=r.structType;if(o===void 0){const l=this.structs.index++;i===null&&(i="StructType"+l),o=new FGe(i,n),this.structs[s].push(o),this.types[s][i]=e,r.structType=o}return o}getOutputStructTypeFromNode(e,n){const i=this.getStructTypeFromNode(e,n,"OutputType","fragment");return i.output=!0,i}getUniformFromNode(e,n,i=this.shaderStage,s=null){const r=this.getDataFromNode(e,i,this.globalCache);let o=r.uniform;if(o===void 0){const l=this.uniforms.index++;o=new LGe(s||"nodeUniform"+l,n,e),this.uniforms[i].push(o),this.registerDeclaration(o),r.uniform=o}return o}getVarFromNode(e,n=null,i=e.getNodeType(this),s=this.shaderStage,r=!1){const o=this.getDataFromNode(e,s),l=this.getSubBuildProperty("variable",o.subBuilds);let c=o[l];if(c===void 0){const u=r?"_const":"_var",h=this.vars[s]||(this.vars[s]=[]),f=this.vars[u]||(this.vars[u]=0);n===null&&(n=(r?"nodeConst":"nodeVar")+f,this.vars[u]++),l!=="variable"&&(n=this.getSubBuildProperty(n,o.subBuilds));const m=e.getArrayCount(this);c=new Zre(n,i,r,m),r||h.push(c),this.registerDeclaration(c),o[l]=c}return c}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const n of e.values)if(!this.isDeterministic(n))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,n=null,i=e.getNodeType(this),s=null,r=null){const o=this.getDataFromNode(e,"any"),l=this.getSubBuildProperty("varying",o.subBuilds);let c=o[l];if(c===void 0){const u=this.varyings,h=u.length;n===null&&(n="nodeVarying"+h),l!=="varying"&&(n=this.getSubBuildProperty(n,o.subBuilds)),c=new DGe(n,i,s,r),u.push(c),this.registerDeclaration(c),o[l]=c}return c}registerDeclaration(e){const n=this.shaderStage,i=this.declarations[n]||(this.declarations[n]={}),s=this.getPropertyName(e);let r=1,o=s;for(;i[o]!==void 0;)o=s+"_"+r++;r>1&&(e.name=o,yt(`TSL: Declaration name '${s}' of '${e.type}' already in use. Renamed to '${o}'.`)),i[o]=e}getCodeFromNode(e,n,i=this.shaderStage){const s=this.getDataFromNode(e);let r=s.code;if(r===void 0){const o=this.codes[i]||(this.codes[i]=[]),l=o.length;r=new kGe("nodeCode"+l,n),o.push(r),s.code=r}return r}addFlowCodeHierarchy(e,n){const{flowCodes:i,flowCodeBlock:s}=this.getDataFromNode(e);let r=!0,o=n;for(;o;){if(s.get(o)===!0){r=!1;break}o=this.getDataFromNode(o).parentNodeBlock}if(r)for(const l of i)this.addLineFlowCode(l)}addLineFlowCodeBlock(e,n,i){const s=this.getDataFromNode(e),r=s.flowCodes||(s.flowCodes=[]),o=s.flowCodeBlock||(s.flowCodeBlock=new WeakMap);r.push(n),o.set(i,!0)}addLineFlowCode(e,n=null){return e===""?this:(n!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(n,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const n=e.getNodeType(this),i=this.flowChildNode(e,n);return this.flowsData.set(e,i),i}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const n=new wre,i=this.currentFunctionNode;return this.currentFunctionNode=n,n.code=this.buildFunctionCode(e),this.currentFunctionNode=i,n}flowShaderNode(e){const n=e.layout,i={[Symbol.iterator](){let o=0;const l=Object.values(this);return{next:()=>({value:l[o],done:o++>=l.length})}}};for(const o of n.inputs)i[o.name]=new sre(o.type,o.name);e.layout=null;const s=e.call(i),r=this.flowStagesNode(s,n.type);return e.layout=n,r}flowBuildStage(e,n,i=null){const s=this.getBuildStage();this.setBuildStage(n);const r=e.build(this,i);return this.setBuildStage(s),r}flowStagesNode(e,n=null){const i=this.flow,s=this.vars,r=this.declarations,o=this.cache,l=this.buildStage,c=this.stack,u={code:""};this.flow=u,this.vars={},this.declarations={},this.cache=new z5,this.stack=c3();for(const h of bO)this.setBuildStage(h),u.result=e.build(this,n);return u.vars=this.getVars(this.shaderStage),this.flow=i,this.vars=s,this.declarations=r,this.cache=o,this.stack=c,this.setBuildStage(l),u}getFunctionOperator(){return null}buildFunctionCode(){yt("Abstract function.")}flowChildNode(e,n=null){const i=this.flow,s={code:""};return this.flow=s,s.result=e.build(this,n),this.flow=i,s}flowNodeFromShaderStage(e,n,i=null,s=null){const r=this.tab,o=this.cache,l=this.shaderStage,c=this.context;this.setShaderStage(e);const u={...this.context};delete u.nodeBlock,this.cache=this.globalCache,this.tab="	",this.context=u;let h=null;if(this.buildStage==="generate"){const f=this.flowChildNode(n,i);s!==null&&(f.code+=`${this.tab+s} = ${f.result};
`),this.flowCode[e]=this.flowCode[e]+f.code,h=f}else h=n.build(this);return this.setShaderStage(l),this.cache=o,this.tab=r,this.context=c,h}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){yt("Abstract function.")}getVaryings(){yt("Abstract function.")}getVar(e,n,i=null){return`${i!==null?this.generateArrayDeclaration(e,i):this.getType(e)} ${n}`}getVars(e){let n="";const i=this.vars[e];if(i!==void 0)for(const s of i)n+=`${this.getVar(s.type,s.name)}; `;return n}getUniforms(){yt("Abstract function.")}getCodes(e){const n=this.codes[e];let i="";if(n!==void 0)for(const s of n)i+=s.code+`
`;return i}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){yt("Abstract function.")}get subBuild(){return this.subBuildLayers[this.subBuildLayers.length-1]||null}addSubBuild(e){this.subBuildLayers.push(e)}removeSubBuild(){return this.subBuildLayers.pop()}getClosestSubBuild(e){let n;if(e&&e.isNode?e.isShaderCallNodeInternal?n=e.shaderNode.subBuilds:e.isStackNode?n=[e.subBuild]:n=this.getDataFromNode(e,"any").subBuilds:e instanceof Set?n=[...e]:n=e,!n)return null;const i=this.subBuildLayers;for(let s=n.length-1;s>=0;s--){const r=n[s];if(i.includes(r))return r}return null}getSubBuildOutput(e){return this.getSubBuildProperty("outputNode",e)}getSubBuildProperty(e="",n=null){let i;n!==null?i=this.getClosestSubBuild(n):i=this.subBuildFn;let s;return i?s=e?i+"_"+e:i:s=e,s}build(){const{object:e,material:n,renderer:i}=this;if(n!==null){let s=i.library.fromMaterial(n);s===null&&(Rt(`NodeMaterial: Material "${n.type}" is not compatible.`),s=new zs),s.build(this)}else this.addFlow("compute",e);for(const s of bO){this.setBuildStage(s),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const r of SO){this.setShaderStage(r);const o=this.flowNodes[r];for(const l of o)s==="generate"?this.flowNode(l):l.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getSharedDataFromNode(e){let n=tqe.get(e);return n===void 0&&(n={}),n}getNodeUniform(e,n){const i=this.getSharedDataFromNode(e);let s=i.cache;if(s===void 0){if(n==="float"||n==="int"||n==="uint")s=new WGe(e);else if(n==="vec2"||n==="ivec2"||n==="uvec2")s=new $Ge(e);else if(n==="vec3"||n==="ivec3"||n==="uvec3")s=new KGe(e);else if(n==="vec4"||n==="ivec4"||n==="uvec4")s=new YGe(e);else if(n==="color")s=new XGe(e);else if(n==="mat2")s=new QGe(e);else if(n==="mat3")s=new JGe(e);else if(n==="mat4")s=new ZGe(e);else throw new Error(`Uniform "${n}" not implemented.`);i.cache=s}return s}format(e,n,i){if(n=this.getVectorType(n),i=this.getVectorType(i),n===i||i===null||this.isReference(i))return e;const s=this.getTypeLength(n),r=this.getTypeLength(i);return s===16&&r===9?`${this.getType(i)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:s===9&&r===4?`${this.getType(i)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:s>4||r>4||r===0?e:s===r?`${this.getType(i)}( ${e} )`:s>r?(e=i==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,r)}`,this.format(e,this.getTypeFromLength(r,this.getComponentType(n)),i)):r===4&&s>1?`${this.getType(i)}( ${this.format(e,n,"vec3")}, 1.0 )`:s===2?`${this.getType(i)}( ${this.format(e,n,"vec2")}, 0.0 )`:(s===1&&r>1&&n!==this.getComponentType(i)&&(e=`${this.getType(this.getComponentType(i))}( ${e} )`),`${this.getType(i)}( ${e} )`)}getSignature(){return`// Three.js r${w0} - Node System
`}}class FK{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,n){let i=e.get(n);return i===void 0&&(i={renderId:0,frameId:0},e.set(n,i)),i}updateBeforeNode(e){const n=e.getUpdateBeforeType(),i=e.updateReference(this);if(n===fa.FRAME){const s=this._getMaps(this.updateBeforeMap,i);if(s.frameId!==this.frameId){const r=s.frameId;s.frameId=this.frameId,e.updateBefore(this)===!1&&(s.frameId=r)}}else if(n===fa.RENDER){const s=this._getMaps(this.updateBeforeMap,i);if(s.renderId!==this.renderId){const r=s.renderId;s.renderId=this.renderId,e.updateBefore(this)===!1&&(s.renderId=r)}}else n===fa.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const n=e.getUpdateAfterType(),i=e.updateReference(this);if(n===fa.FRAME){const s=this._getMaps(this.updateAfterMap,i);s.frameId!==this.frameId&&e.updateAfter(this)!==!1&&(s.frameId=this.frameId)}else if(n===fa.RENDER){const s=this._getMaps(this.updateAfterMap,i);s.renderId!==this.renderId&&e.updateAfter(this)!==!1&&(s.renderId=this.renderId)}else n===fa.OBJECT&&e.updateAfter(this)}updateNode(e){const n=e.getUpdateType(),i=e.updateReference(this);if(n===fa.FRAME){const s=this._getMaps(this.updateMap,i);s.frameId!==this.frameId&&e.update(this)!==!1&&(s.frameId=this.frameId)}else if(n===fa.RENDER){const s=this._getMaps(this.updateMap,i);s.renderId!==this.renderId&&e.update(this)!==!1&&(s.renderId=this.renderId)}else n===fa.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class k7{constructor(e,n,i=null,s="",r=!1){this.type=e,this.name=n,this.count=i,this.qualifier=s,this.isConst=r}}k7.isNodeFunctionInput=!0;class aqe extends v1{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:N7(this.light),lightColor:e}}}const G5=new _n,sC=new _n;let v2=null;class iqe extends v1{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=Rn(new ye).setGroup(Nn),this.halfWidth=Rn(new ye).setGroup(Nn),this.updateType=fa.RENDER}update(e){super.update(e);const{light:n}=this,i=e.camera.matrixWorldInverse;sC.identity(),G5.copy(n.matrixWorld),G5.premultiply(i),sC.extractRotation(G5),this.halfWidth.value.set(n.width*.5,0,0),this.halfHeight.value.set(0,n.height*.5,0),this.halfWidth.value.applyMatrix4(sC),this.halfHeight.value.applyMatrix4(sC)}setupDirectRectArea(e){let n,i;e.isAvailable("float32Filterable")?(n=hi(v2.LTC_FLOAT_1),i=hi(v2.LTC_FLOAT_2)):(n=hi(v2.LTC_HALF_1),i=hi(v2.LTC_HALF_2));const{colorNode:s,light:r}=this,o=C7(r);return{lightColor:s,lightPosition:o,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:n,ltc_2:i}}static setLTC(e){v2=e}}class O7 extends v1{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=Rn(0).setGroup(Nn),this.penumbraCosNode=Rn(0).setGroup(Nn),this.cutoffDistanceNode=Rn(0).setGroup(Nn),this.decayExponentNode=Rn(0).setGroup(Nn),this.colorNode=Rn(this.color).setGroup(Nn)}update(e){super.update(e);const{light:n}=this;this.coneCosNode.value=Math.cos(n.angle),this.penumbraCosNode.value=Math.cos(n.angle*(1-n.penumbra)),this.cutoffDistanceNode.value=n.distance,this.decayExponentNode.value=n.decay}getSpotAttenuation(e,n){const{coneCosNode:i,penumbraCosNode:s}=this;return Qd(i,s,n)}getLightCoord(e){const n=e.getNodeProperties(this);let i=n.projectionUV;return i===void 0&&(i=Nre(this.light,e.context.positionWorld),n.projectionUV=i),i}setupDirect(e){const{colorNode:n,cutoffDistanceNode:i,decayExponentNode:s,light:r}=this,o=this.getLightVector(e),l=o.normalize(),c=l.dot(N7(r)),u=this.getSpotAttenuation(e,c),h=o.length(),f=I7({lightDistance:h,cutoffDistance:i,decayExponent:s});let m=n.mul(u).mul(f),A,x;return r.colorNode?(x=this.getLightCoord(e),A=r.colorNode(x)):r.map&&(x=this.getLightCoord(e),A=hi(r.map,x.xy).onRenderUpdate(()=>r.map)),A&&(m=x.mul(2).sub(1).abs().lessThan(1).all().select(m.mul(A),m)),{lightColor:m,lightDirection:l}}}class sqe extends O7{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,n){const i=this.light.iesMap;let s=null;if(i&&i.isTexture===!0){const r=n.acos().mul(1/Math.PI);s=hi(i,Qt(r,0),0).r}else s=super.getSpotAttenuation(n);return s}}const rqe=Ye(([a,e])=>{const n=a.abs().sub(e);return of(Ns(n,0)).add(Tc(Ns(n.x,n.y),0))});class oqe extends O7{static get type(){return"ProjectorLightNode"}update(e){super.update(e);const n=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(n.angle*(1-n.penumbra)),.99999),n.aspect===null){let i=1;n.map!==null&&(i=n.map.width/n.map.height),n.shadow.aspect=i}else n.shadow.aspect=n.aspect}getSpotAttenuation(e){const n=Re(0),i=this.penumbraCosNode,s=aI(this.light).mul(e.context.positionWorld||lf);return kn(s.w.greaterThan(0),()=>{const r=s.xyz.div(s.w),o=rqe(r.xy.sub(Qt(.5)),Qt(.5)),l=yu(-1,Ka(1,RB(i)).sub(1));n.assign(B4(o.mul(-2).mul(l)))}),n}}class lqe extends v1{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class cqe extends v1{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=M7(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=Rn(new on).setGroup(Nn)}update(e){const{light:n}=this;super.update(e),this.lightPositionNode.object3d=n,this.groundColorNode.value.copy(n.groundColor).multiplyScalar(n.intensity)}setup(e){const{colorNode:n,groundColorNode:i,lightDirectionNode:s}=this,o=D0.dot(s).mul(.5).add(.5),l=Ha(i,n,o);e.context.irradiance.addAssign(l)}}class uqe extends v1{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const n=[];for(let i=0;i<9;i++)n.push(new ye);this.lightProbe=sl(n)}update(e){const{light:n}=this;super.update(e);for(let i=0;i<9;i++)this.lightProbe.array[i].copy(n.sh.coefficients[i]).multiplyScalar(n.intensity)}setup(e){const n=Jre(D0,this.lightProbe);e.context.irradiance.addAssign(n)}}class toe{parseFunction(){yt("Abstract function.")}}class F7{constructor(e,n,i="",s=""){this.type=e,this.inputs=n,this.name=i,this.precision=s}getCode(){yt("Abstract function.")}}F7.isNodeFunction=!0;const dqe=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,hqe=/[a-z_0-9]+/ig,jK="#pragma main",fqe=a=>{a=a.trim();const e=a.indexOf(jK),n=e!==-1?a.slice(e+jK.length):a,i=n.match(dqe);if(i!==null&&i.length===5){const s=i[4],r=[];let o=null;for(;(o=hqe.exec(s))!==null;)r.push(o);const l=[];let c=0;for(;c<r.length;){const x=r[c][0]==="const";x===!0&&c++;let T=r[c][0];T==="in"||T==="out"||T==="inout"?c++:T="";const E=r[c++][0];let M=Number.parseInt(r[c][0]);Number.isNaN(M)===!1?c++:M=null;const N=r[c++][0];l.push(new k7(E,N,M,T,x))}const u=n.substring(i[0].length),h=i[3]!==void 0?i[3]:"",f=i[2],m=i[1]!==void 0?i[1]:"",A=e!==-1?a.slice(0,e):"";return{type:f,inputs:l,name:h,precision:m,inputsCode:s,blockCode:u,headerCode:A}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class pqe extends F7{constructor(e){const{type:n,inputs:i,name:s,precision:r,inputsCode:o,blockCode:l,headerCode:c}=fqe(e);super(n,i,s,r),this.inputsCode=o,this.blockCode=l,this.headerCode=c}getCode(e=this.name){let n;const i=this.blockCode;if(i!==""){const{type:s,inputsCode:r,headerCode:o,precision:l}=this;let c=`${s} ${e} ( ${r.trim()} )`;l!==""&&(c=`${l} ${c}`),n=o+c+i}else n="";return n}}class mqe extends toe{parseFunction(e){return new pqe(e)}}const BK=new WeakMap,Nh=[],mg=[];class gqe extends k0{constructor(e,n){super(),this.renderer=e,this.backend=n,this.nodeFrame=new FK,this.nodeBuilderCache=new Map,this.callHashCache=new Jd,this.groupsData=new Jd,this.cacheLib={}}updateGroup(e){const n=e.groupNode,i=n.name;if(i===TB.name)return!0;if(i===Nn.name){const r=this.get(e),o=this.nodeFrame.renderId;return r.renderId!==o?(r.renderId=o,!0):!1}if(i===Wne.name){const r=this.get(e),o=this.nodeFrame.frameId;return r.frameId!==o?(r.frameId=o,!0):!1}Nh[0]=n,Nh[1]=e;let s=this.groupsData.get(Nh);return s===void 0&&this.groupsData.set(Nh,s={}),Nh.length=0,s.version!==n.version?(s.version=n.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const n=this.get(e);let i=n.nodeBuilderState;if(i===void 0){const{nodeBuilderCache:s}=this,r=this.getForRenderCacheKey(e);if(i=s.get(r),i===void 0){const o=c=>{const u=this.backend.createNodeBuilder(e.object,this.renderer);return u.scene=e.scene,u.material=c,u.camera=e.camera,u.context.material=c,u.lightsNode=e.lightsNode,u.environmentNode=this.getEnvironmentNode(e.scene),u.fogNode=this.getFogNode(e.scene),u.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&u.enableMultiview(),u};let l=o(e.material);try{l.build()}catch(c){l=o(new zs),l.build(),Rt("TSL: "+c)}i=this._createNodeBuilderState(l),s.set(r,i)}i.usedTimes++,n.nodeBuilderState=i}return i}delete(e){if(e.isRenderObject){const n=this.get(e).nodeBuilderState;n.usedTimes--,n.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const n=this.get(e);let i=n.nodeBuilderState;if(i===void 0){const s=this.backend.createNodeBuilder(e,this.renderer);s.build(),i=this._createNodeBuilderState(s),n.nodeBuilderState=i}return i}_createNodeBuilderState(e){return new IGe(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let n=null;if(e.environmentNode&&e.environmentNode.isNode)n=e.environmentNode;else{const i=this.get(e);i.environmentNode&&(n=i.environmentNode)}return n}getBackgroundNode(e){this.updateBackground(e);let n=null;if(e.backgroundNode&&e.backgroundNode.isNode)n=e.backgroundNode;else{const i=this.get(e);i.backgroundNode&&(n=i.backgroundNode)}return n}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,n){Nh[0]=e,Nh[1]=n;const i=this.renderer.info.calls,s=this.callHashCache.get(Nh)||{};if(s.callId!==i){const r=this.getEnvironmentNode(e),o=this.getFogNode(e);n&&mg.push(n.getCacheKey(!0)),r&&mg.push(r.getCacheKey()),o&&mg.push(o.getCacheKey()),mg.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),mg.push(this.renderer.shadowMap.enabled?1:0),mg.push(this.renderer.shadowMap.type),s.callId=i,s.cacheKey=Hx(mg),this.callHashCache.set(Nh,s),mg.length=0}return Nh.length=0,s.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const n=this.get(e),i=e.background;if(i){const s=e.backgroundBlurriness===0&&n.backgroundBlurriness>0||e.backgroundBlurriness>0&&n.backgroundBlurriness===0;if(n.background!==i||s){const r=this.getCacheNode("background",i,()=>{if(i.isCubeTexture===!0||i.mapping===d0||i.mapping===h0||i.mapping===Am){if(e.backgroundBlurriness>0||i.mapping===Am)return A7(i);{let o;return i.isCubeTexture===!0?o=Dl(i):o=hi(i),Bse(o)}}else{if(i.isTexture===!0)return hi(i,rm.flipY()).setUpdateMatrix(!0);i.isColor!==!0&&Rt("WebGPUNodes: Unsupported background configuration.",i)}},s);n.backgroundNode=r,n.background=i,n.backgroundBlurriness=e.backgroundBlurriness}}else n.backgroundNode&&(delete n.backgroundNode,delete n.background)}getCacheNode(e,n,i,s=!1){const r=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let o=r.get(n);return(o===void 0||s)&&(o=i(),r.set(n,o)),o}updateFog(e){const n=this.get(e),i=e.fog;if(i){if(n.fog!==i){const s=this.getCacheNode("fog",i,()=>{if(i.isFogExp2){const r=Bi("color","color",i).setGroup(Nn),o=Bi("density","float",i).setGroup(Nn);return pT(r,w7(o))}else if(i.isFog){const r=Bi("color","color",i).setGroup(Nn),o=Bi("near","float",i).setGroup(Nn),l=Bi("far","float",i).setGroup(Nn);return pT(r,T7(o,l))}else Rt("Renderer: Unsupported fog configuration.",i)});n.fogNode=s,n.fog=i}}else delete n.fogNode,delete n.fog}updateEnvironment(e){const n=this.get(e),i=e.environment;if(i){if(n.environment!==i){const s=this.getCacheNode("environment",i,()=>{if(i.isCubeTexture===!0)return Dl(i);if(i.isTexture===!0)return hi(i);Rt("Nodes: Unsupported environment configuration.",i)});n.environmentNode=s,n.environment=i}}else n.environmentNode&&(delete n.environmentNode,delete n.environment)}getNodeFrame(e=this.renderer,n=null,i=null,s=null,r=null){const o=this.nodeFrame;return o.renderer=e,o.scene=n,o.object=i,o.camera=s,o.material=r,o}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return BK.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const n=this.renderer,i=this.getOutputCacheKey(),s=e.isArrayTexture?eI(e,qe(rm,km("gl_ViewID_OVR"))).renderOutput(n.toneMapping,n.currentColorSpace):hi(e,rm).renderOutput(n.toneMapping,n.currentColorSpace);return BK.set(e,i),s}updateBefore(e){const n=e.getNodeBuilderState();for(const i of n.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(i)}updateAfter(e){const n=e.getNodeBuilderState();for(const i of n.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(i)}updateForCompute(e){const n=this.getNodeFrame(),i=this.getForCompute(e);for(const s of i.updateNodes)n.updateNode(s)}updateForRender(e){const n=this.getNodeFrameForRender(e),i=e.getNodeBuilderState();for(const s of i.updateNodes)n.updateNode(s)}needsRefresh(e){const n=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,n)}dispose(){super.dispose(),this.nodeFrame=new FK,this.nodeBuilderCache=new Map,this.cacheLib={}}}const q5=new Nd;class PR{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new ga,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,n,i){const s=e.length;for(let r=0;r<s;r++){q5.copy(e[r]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const o=n[i+r],l=q5.normal;o.x=-l.x,o.y=-l.y,o.z=-l.z,o.w=q5.constant}}updateGlobal(e,n){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=n.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,n){let i=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==n.clipIntersection&&(this.clipIntersection=n.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const s=n.clippingPlanes,r=s.length;let o,l;if(this.clipIntersection?(o=this.intersectionPlanes,l=e.intersectionPlanes.length):(o=this.unionPlanes,l=e.unionPlanes.length),o.length!==l+r){o.length=l+r;for(let c=0;c<r;c++)o[l+c]=new qn;i=!0}this.projectPlanes(s,o,l),i&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let n=this.clippingGroupContexts.get(e);return n===void 0&&(n=new PR(this),this.clippingGroupContexts.set(e,n)),n.update(this,e),n}get unionClippingCount(){return this.unionPlanes.length}}class Aqe{constructor(e,n){this.bundleGroup=e,this.camera=n}}const _2=[];class yqe{constructor(){this.bundles=new Jd}get(e,n){const i=this.bundles;_2[0]=e,_2[1]=n;let s=i.get(_2);return s===void 0&&(s=new Aqe(e,n),i.set(_2,s)),_2.length=0,s}dispose(){this.bundles=new Jd}}class noe{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let n=null;const i=this.getMaterialNodeClass(e.type);if(i!==null){n=new i;for(const s in e)n[s]=e[s]}return n}addToneMapping(e,n){this.addType(e,n,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,n){this.addType(e,n,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,n){this.addClass(e,n,this.lightNodes)}addType(e,n,i){if(i.has(n)){yt(`Redefinition of node ${n}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof n=="function"||typeof n=="object")throw new Error(`Base class ${n} is not a class.`);i.set(n,e)}addClass(e,n,i){if(i.has(n)){yt(`Redefinition of node ${n.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof n!="function")throw new Error(`Base class ${n.name} is not a class.`);i.set(n,e)}}const vqe=new R7,x2=[];class _qe extends Jd{constructor(){super()}createNode(e=[]){return new R7().setLights(e)}getNode(e,n){if(e.isQuadMesh)return vqe;x2[0]=e,x2[1]=n;let i=this.get(x2);return i===void 0&&(i=this.createNode(),this.set(x2,i)),x2.length=0,i}}class K2 extends th{constructor(e=1,n=1,i={}){super(e,n,i),this.isXRRenderTarget=!0,this._hasExternalTextures=!1,this._autoAllocateDepthBuffer=!0,this._isOpaqueFramebuffer=!1}copy(e){return super.copy(e),this._hasExternalTextures=e._hasExternalTextures,this._autoAllocateDepthBuffer=e._autoAllocateDepthBuffer,this._isOpaqueFramebuffer=e._isOpaqueFramebuffer,this}}const UK=new ye,VK=new ye;class xqe extends Cc{constructor(e,n=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new Zs,this._cameraL.viewport=new qn,this._cameraR=new Zs,this._cameraR.viewport=new qn,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new Uj,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._sessionUsesLayers=!1,this._supportsGlBinding=typeof XRWebGLBinding<"u",this._frameBufferTargets=null,this._createXRLayer=Mqe.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new Nt,this._onSessionEvent=Tqe.bind(this),this._onSessionEnd=wqe.bind(this),this._onInputSourcesChange=Eqe.bind(this),this._onAnimationFrame=Cqe.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._supportsLayers=this._supportsGlBinding&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=n,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&yt("XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&yt("XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getBinding(){return this._glBinding===null&&this._supportsGlBinding&&(this._glBinding=new XRWebGLBinding(this._session,this._gl)),this._glBinding}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,n,i,s,r,o,l,c={}){const u=new h1(e,n),h=new K2(r,o,{format:fs,type:os,depthTexture:new Do(r,o,c.stencil?yc:Ei,void 0,void 0,void 0,void 0,void 0,void 0,c.stencil?rl:ho),stencilBuffer:c.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});h._autoAllocateDepthBuffer=!0;const f=new oo({color:16777215,side:Ac});f.map=h.texture,f.map.offset.y=1,f.map.repeat.y=-1;const m=new Na(u,f);m.position.copy(i),m.quaternion.copy(s);const A={type:"quad",width:e,height:n,translation:i,quaternion:s,pixelwidth:r,pixelheight:o,plane:m,material:f,rendercall:l,renderTarget:h};if(this._layers.push(A),this._session!==null){A.plane.material=new oo({color:16777215,side:Ac}),A.plane.material.blending=QA,A.plane.material.blendEquation=Co,A.plane.material.blendSrc=Oh,A.plane.material.blendDst=Oh,A.xrlayer=this._createXRLayer(A);const x=this._session.renderState.layers;x.unshift(A.xrlayer),this._session.updateRenderState({layers:x})}else h.isXRRenderTarget=!1;return m}createCylinderLayer(e,n,i,s,r,o,l,c,u={}){const h=new d1(e,e,e*n/i,64,64,!0,Math.PI-n/2,n),f=new K2(o,l,{format:fs,type:os,depthTexture:new Do(o,l,u.stencil?yc:Ei,void 0,void 0,void 0,void 0,void 0,void 0,u.stencil?rl:ho),stencilBuffer:u.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});f._autoAllocateDepthBuffer=!0;const m=new oo({color:16777215,side:Di});m.map=f.texture,m.map.offset.y=1,m.map.repeat.y=-1;const A=new Na(h,m);A.position.copy(s),A.quaternion.copy(r);const x={type:"cylinder",radius:e,centralAngle:n,aspectratio:i,translation:s,quaternion:r,pixelwidth:o,pixelheight:l,plane:A,material:m,rendercall:c,renderTarget:f};if(this._layers.push(x),this._session!==null){x.plane.material=new oo({color:16777215,side:Di}),x.plane.material.blending=QA,x.plane.material.blendEquation=Co,x.plane.material.blendSrc=Oh,x.plane.material.blendDst=Oh,x.xrlayer=this._createXRLayer(x);const T=this._session.renderState.layers;T.unshift(x.xrlayer),this._session.updateRenderState({layers:T})}else f.isXRRenderTarget=!1;return A}renderLayers(){const e=new ye,n=new Er,i=this._renderer,s=this.isPresenting,r=i.getOutputRenderTarget(),o=i._frameBufferTarget;this.isPresenting=!1;const l=new Nt;i.getSize(l);const c=i._quad;for(const u of this._layers)if(u.renderTarget.isXRRenderTarget=this._session!==null,u.renderTarget._hasExternalTextures=u.renderTarget.isXRRenderTarget,u.renderTarget.isXRRenderTarget&&this._sessionUsesLayers){u.xrlayer.transform=new XRRigidTransform(u.plane.getWorldPosition(e),u.plane.getWorldQuaternion(n));const h=this._glBinding.getSubImage(u.xrlayer,this._xrFrame);i.backend.setXRRenderTargetTextures(u.renderTarget,h.colorTexture,void 0),i._setXRLayerSize(u.renderTarget.width,u.renderTarget.height),i.setOutputRenderTarget(u.renderTarget),i.setRenderTarget(null),i._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);const{frameBufferTarget:f,quad:m}=this._frameBufferTargets.get(u.renderTarget)||{frameBufferTarget:null,quad:null};f?(i._frameBufferTarget=f,i._quad=m):(i._quad=new J4(new zs),this._frameBufferTargets.set(u.renderTarget,{frameBufferTarget:i._getFrameBufferTarget(),quad:i._quad})),u.rendercall(),i._frameBufferTarget=null}else i.setRenderTarget(u.renderTarget),u.rendercall();i.setRenderTarget(null),i.setOutputRenderTarget(r),i._frameBufferTarget=o,i._setXRLayerSize(l.x,l.y),i._quad=c,this.isPresenting=s}getSession(){return this._session}async setSession(e){const n=this._renderer,i=n.backend;this._gl=n.getContext();const s=this._gl,r=s.getContextAttributes();if(this._session=e,e!==null){if(i.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await i.makeXRCompatible(),this._currentPixelRatio=n.getPixelRatio(),n.getSize(this._currentSize),this._currentAnimationContext=n._animation.getContext(),this._currentAnimationLoop=n._animation.getAnimationLoop(),n._animation.stop(),this._supportsLayers===!0){let o=null,l=null,c=null;n.depth&&(c=n.stencil?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24,o=n.stencil?rl:ho,l=n.stencil?yc:Ei);const u={colorFormat:s.RGBA8,depthFormat:c,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&n.hasFeature("OVR_multiview2")&&(u.textureType="texture-array",this._useMultiview=!0),this._glBinding=this.getBinding();const h=this._glBinding.createProjectionLayer(u),f=[h];this._glProjLayer=h,n.setPixelRatio(1),n._setXRLayerSize(h.textureWidth,h.textureHeight);const m=this._useMultiview?2:1,A=new Do(h.textureWidth,h.textureHeight,l,void 0,void 0,void 0,void 0,void 0,void 0,o,m);if(this._xrRenderTarget=new K2(h.textureWidth,h.textureHeight,{format:fs,type:os,colorSpace:n.outputColorSpace,depthTexture:A,stencilBuffer:n.stencil,samples:r.antialias?4:0,resolveDepthBuffer:h.ignoreDepthValues===!1,resolveStencilBuffer:h.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget._hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._sessionUsesLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._sessionUsesLayers)for(const x of this._layers)x.plane.material=new oo({color:16777215,side:x.type==="cylinder"?Di:Ac}),x.plane.material.blending=QA,x.plane.material.blendEquation=Co,x.plane.material.blendSrc=Oh,x.plane.material.blendDst=Oh,x.xrlayer=this._createXRLayer(x),f.unshift(x.xrlayer);e.updateRenderState({layers:f})}else{const o={antialias:n.currentSamples>0,alpha:!0,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},l=new XRWebGLLayer(e,s,o);this._glBaseLayer=l,e.updateRenderState({baseLayer:l}),n.setPixelRatio(1),n._setXRLayerSize(l.framebufferWidth,l.framebufferHeight),this._xrRenderTarget=new K2(l.framebufferWidth,l.framebufferHeight,{format:fs,type:os,colorSpace:n.outputColorSpace,stencilBuffer:n.stencil,resolveDepthBuffer:l.ignoreDepthValues===!1,resolveStencilBuffer:l.ignoreDepthValues===!1}),this._xrRenderTarget._isOpaqueFramebuffer=!0,this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),n._animation.setAnimationLoop(this._onAnimationFrame),n._animation.setContext(e),n._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const n=this._session;if(n===null)return;const i=e.near,s=e.far,r=this._cameraXR,o=this._cameraL,l=this._cameraR;r.near=l.near=o.near=i,r.far=l.far=o.far=s,r.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==r.near||this._currentDepthFar!==r.far)&&(n.updateRenderState({depthNear:r.near,depthFar:r.far}),this._currentDepthNear=r.near,this._currentDepthFar=r.far),r.layers.mask=e.layers.mask|6,o.layers.mask=r.layers.mask&3,l.layers.mask=r.layers.mask&5;const c=e.parent,u=r.cameras;zK(r,c);for(let h=0;h<u.length;h++)zK(u[h],c);u.length===2?bqe(r,o,l):r.projectionMatrix.copy(o.projectionMatrix),Sqe(e,r,c)}_getController(e){let n=this._controllers[e];return n===void 0&&(n=new lS,this._controllers[e]=n),n}}function bqe(a,e,n){UK.setFromMatrixPosition(e.matrixWorld),VK.setFromMatrixPosition(n.matrixWorld);const i=UK.distanceTo(VK),s=e.projectionMatrix.elements,r=n.projectionMatrix.elements,o=s[14]/(s[10]-1),l=s[14]/(s[10]+1),c=(s[9]+1)/s[5],u=(s[9]-1)/s[5],h=(s[8]-1)/s[0],f=(r[8]+1)/r[0],m=o*h,A=o*f,x=i/(-h+f),T=x*-h;if(e.matrixWorld.decompose(a.position,a.quaternion,a.scale),a.translateX(T),a.translateZ(x),a.matrixWorld.compose(a.position,a.quaternion,a.scale),a.matrixWorldInverse.copy(a.matrixWorld).invert(),s[10]===-1)a.projectionMatrix.copy(e.projectionMatrix),a.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const E=o+x,M=l+x,N=m-T,I=A+(i-T),F=c*l/M*E,G=u*l/M*E;a.projectionMatrix.makePerspective(N,I,F,G,E,M),a.projectionMatrixInverse.copy(a.projectionMatrix).invert()}}function zK(a,e){e===null?a.matrixWorld.copy(a.matrix):a.matrixWorld.multiplyMatrices(e.matrixWorld,a.matrix),a.matrixWorldInverse.copy(a.matrixWorld).invert()}function Sqe(a,e,n){n===null?a.matrix.copy(e.matrixWorld):(a.matrix.copy(n.matrixWorld),a.matrix.invert(),a.matrix.multiply(e.matrixWorld)),a.matrix.decompose(a.position,a.quaternion,a.scale),a.updateMatrixWorld(!0),a.projectionMatrix.copy(e.projectionMatrix),a.projectionMatrixInverse.copy(e.projectionMatrixInverse),a.isPerspectiveCamera&&(a.fov=Yy*2*Math.atan(1/a.projectionMatrix.elements[5]),a.zoom=1)}function Tqe(a){const e=this._controllerInputSources.indexOf(a.inputSource);if(e===-1)return;const n=this._controllers[e];if(n!==void 0){const i=this.getReferenceSpace();n.update(a.inputSource,a.frame,i),n.dispatchEvent({type:a.type,data:a.inputSource})}}function wqe(){const a=this._session,e=this._renderer;a.removeEventListener("select",this._onSessionEvent),a.removeEventListener("selectstart",this._onSessionEvent),a.removeEventListener("selectend",this._onSessionEvent),a.removeEventListener("squeeze",this._onSessionEvent),a.removeEventListener("squeezestart",this._onSessionEvent),a.removeEventListener("squeezeend",this._onSessionEvent),a.removeEventListener("end",this._onSessionEnd),a.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let n=0;n<this._controllers.length;n++){const i=this._controllerInputSources[n];i!==null&&(this._controllerInputSources[n]=null,this._controllers[n].disconnect(i))}if(this._currentDepthNear=null,this._currentDepthFar=null,e._resetXRState(),this._session=null,this._xrRenderTarget=null,this._glBinding=null,this._glBaseLayer=null,this._glProjLayer=null,this._sessionUsesLayers===!0)for(const n of this._layers)n.renderTarget=new K2(n.pixelwidth,n.pixelheight,{format:fs,type:os,depthTexture:new Do(n.pixelwidth,n.pixelheight,n.stencilBuffer?yc:Ei,void 0,void 0,void 0,void 0,void 0,void 0,n.stencilBuffer?rl:ho),stencilBuffer:n.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),n.renderTarget.isXRRenderTarget=!1,n.plane.material=n.material,n.material.map=n.renderTarget.texture,n.material.map.offset.y=1,n.material.map.repeat.y=-1,delete n.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function Eqe(a){const e=this._controllers,n=this._controllerInputSources;for(let i=0;i<a.removed.length;i++){const s=a.removed[i],r=n.indexOf(s);r>=0&&(n[r]=null,e[r].disconnect(s))}for(let i=0;i<a.added.length;i++){const s=a.added[i];let r=n.indexOf(s);if(r===-1){for(let l=0;l<e.length;l++)if(l>=n.length){n.push(s),r=l;break}else if(n[l]===null){n[l]=s,r=l;break}if(r===-1)break}const o=e[r];o&&o.connect(s)}}function Mqe(a){return a.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(a.translation,a.quaternion),width:a.width/2,height:a.height/2,space:this._referenceSpace,viewPixelWidth:a.pixelwidth,viewPixelHeight:a.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(a.translation,a.quaternion),radius:a.radius,centralAngle:a.centralAngle,aspectRatio:a.aspectRatio,space:this._referenceSpace,viewPixelWidth:a.pixelwidth,viewPixelHeight:a.pixelheight,clearOnAccess:!1})}function Cqe(a,e){if(e===void 0)return;const n=this._cameraXR,i=this._renderer,s=i.backend,r=this._glBaseLayer,o=this.getReferenceSpace(),l=e.getViewerPose(o);if(this._xrFrame=e,l!==null){const c=l.views;this._glBaseLayer!==null&&s.setXRTarget(r.framebuffer);let u=!1;c.length!==n.cameras.length&&(n.cameras.length=0,u=!0);for(let h=0;h<c.length;h++){const f=c[h];let m;if(this._supportsLayers===!0){const x=this._glBinding.getViewSubImage(this._glProjLayer,f);m=x.viewport,h===0&&s.setXRRenderTargetTextures(this._xrRenderTarget,x.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:x.depthStencilTexture)}else m=r.getViewport(f);let A=this._cameras[h];A===void 0&&(A=new Zs,A.layers.enable(h),A.viewport=new qn,this._cameras[h]=A),A.matrix.fromArray(f.transform.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale),A.projectionMatrix.fromArray(f.projectionMatrix),A.projectionMatrixInverse.copy(A.projectionMatrix).invert(),A.viewport.set(m.x,m.y,m.width,m.height),h===0&&(n.matrix.copy(A.matrix),n.matrix.decompose(n.position,n.quaternion,n.scale)),u===!0&&n.cameras.push(A)}i.setOutputRenderTarget(this._xrRenderTarget)}for(let c=0;c<this._controllers.length;c++){const u=this._controllerInputSources[c],h=this._controllers[c];u!==null&&h!==void 0&&h.update(u,e,o)}this._currentAnimationLoop&&this._currentAnimationLoop(a,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}class Nqe extends Cc{constructor(e){super(),this.domElement=e,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new qn(0,0,this._width,this._height),this._scissor=new qn(0,0,this._width,this._height),this._scissorTest=!1,this.colorTexture=new n4,this.depthTexture=new Do}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,n,i){this.xr&&this.xr.isPresenting||(this._width=e,this._height=n,this._pixelRatio=i,this.domElement.width=Math.floor(e*i),this.domElement.height=Math.floor(n*i),this.setViewport(0,0,e,n),this._dispatchResize())}setSize(e,n,i=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=n,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(n*this._pixelRatio),i===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=n+"px"),this.setViewport(0,0,e,n),this._dispatchResize())}getScissor(e){const n=this._scissor;return e.x=n.x,e.y=n.y,e.width=n.width,e.height=n.height,e}setScissor(e,n,i,s){const r=this._scissor;e.isVector4?r.copy(e):r.set(e,n,i,s)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e}getViewport(e){return e.copy(this._viewport)}setViewport(e,n,i,s,r=0,o=1){const l=this._viewport;e.isVector4?l.copy(e):l.set(e,n,i,s),l.minDepth=r,l.maxDepth=o}_dispatchResize(){this.dispatchEvent({type:"resize"})}dispose(){this.dispatchEvent({type:"dispose"})}}const GK=new Vx,Uv=new Nt,H5=new qn,W5=new C0,$5=new QT,rC=new _n,Up=new qn;class Rqe{constructor(e,n={}){this.isRenderer=!0;const{logarithmicDepthBuffer:i=!1,alpha:s=!0,depth:r=!0,stencil:o=!1,antialias:l=!1,samples:c=0,getFallback:u=null,outputBufferType:h=cs,multiview:f=!1}=n;this.backend=e,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=s,this.logarithmicDepthBuffer=i,this.outputColorSpace=Fr,this.toneMapping=lo,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=r,this.stencil=o,this.info=new v7e,this.contextNode=Dm(),this.library=new noe,this.lighting=new _qe,this._samples=c||l===!0?4:0,this._onCanvasTargetResize=this._onCanvasTargetResize.bind(this),this._canvasTarget=new Nqe(e.getDomElement()),this._canvasTarget.addEventListener("resize",this._onCanvasTargetResize),this._canvasTarget.isDefaultCanvasTarget=!0,this._inspector=new uie,this._inspector.setRenderer(this),this._getFallback=u,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new J4(new zs),this._quad.name="Output Color Transform",this._quad.material.name="outputColorTransform",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const m=this.alpha===!0?0:1;this._clearColor=new y7(0,0,0,m),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._outputBufferType=h,this._cacheShadowNodes=new WeakMap,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:b_},this.xr=new xqe(this,f),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(A,x,T)=>{await this.compileAsync(A,x);const E=this._renderLists.get(A,x),M=this._renderContexts.get(A,x,this._renderTarget,this._mrt),N=A.overrideMaterial||T.material,I=this._objects.get(T,N,A,x,E.lightsNode,M,M.clippingContext),{fragmentShader:F,vertexShader:G}=I.getNodeBuilderState();return{fragmentShader:F,vertexShader:G}}}}async init(){return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,n)=>{let i=this.backend;try{await i.init(this)}catch(s){if(this._getFallback!==null)try{this.backend=i=this._getFallback(s),await i.init(this)}catch(r){n(r);return}else{n(s);return}}this._nodes=new gqe(this,i),this._animation=new u7e(this,this._nodes,this.info),this._attributes=new A7e(i),this._background=new RGe(this,this._nodes),this._geometries=new y7e(this._attributes,this.info),this._textures=new D7e(this,i,this.info),this._pipelines=new S7e(i,this._nodes),this._bindings=new T7e(i,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new p7e(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new M7e(this.lighting),this._bundles=new yqe,this._renderContexts=new I7e,this._animation.start(),this._initialized=!0,this._inspector.init(),e(this)}),this._initPromise)}get domElement(){return this._canvasTarget.domElement}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,n,i=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const s=this._nodes.nodeFrame,r=s.renderId,o=this._currentRenderContext,l=this._currentRenderObjectFunction,c=this._compilationPromises,u=e.isScene===!0?e:GK;i===null&&(i=e);const h=this._renderTarget,f=this._renderContexts.get(i,n,h,this._mrt),m=this._activeMipmapLevel,A=[];this._currentRenderContext=f,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=A,s.renderId++,s.update(),f.depth=this.depth,f.stencil=this.stencil,f.clippingContext||(f.clippingContext=new PR),f.clippingContext.updateGlobal(u,n),u.onBeforeRender(this,e,n,h);const x=this._renderLists.get(e,n);if(x.begin(),this._projectObject(e,n,0,x,f.clippingContext),i!==e&&i.traverseVisible(function(I){I.isLight&&I.layers.test(n.layers)&&x.pushLight(I)}),x.finish(),h!==null){this._textures.updateRenderTarget(h,m);const I=this._textures.get(h);f.textures=I.textures,f.depthTexture=I.depthTexture}else f.textures=null,f.depthTexture=null;this._background.update(u,x,f);const T=x.opaque,E=x.transparent,M=x.transparentDoublePass,N=x.lightsNode;this.opaque===!0&&T.length>0&&this._renderObjects(T,n,u,N),this.transparent===!0&&E.length>0&&this._renderTransparents(E,M,n,u,N),s.renderId=r,this._currentRenderContext=o,this._currentRenderObjectFunction=l,this._compilationPromises=c,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(A)}async renderAsync(e,n){ji('Renderer: "renderAsync()" has been deprecated. Use "render()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.render(e,n)}async waitForGPU(){Rt("Renderer: waitForGPU() has been removed. Read https://github.com/mrdoob/three.js/issues/32012 for more information.")}set inspector(e){this._inspector!==null&&this._inspector.setRenderer(null),this._inspector=e,this._inspector.setRenderer(this)}get inspector(){return this._inspector}set highPrecision(e){const n=this.contextNode.value;e===!0?(n.modelViewMatrix=NO,n.modelNormalViewMatrix=RO):this.highPrecision&&(delete n.modelViewMatrix,delete n.modelNormalViewMatrix)}get highPrecision(){const e=this.contextNode.value;return e.modelViewMatrix===NO&&e.modelNormalViewMatrix===RO}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getOutputBufferType(){return this._outputBufferType}getColorBufferType(){return ji('Renderer: ".getColorBufferType()" has been renamed to ".getOutputBufferType()".'),this.getOutputBufferType()}_onDeviceLost(e){let n=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(n+=`
Reason: ${e.reason}`),Rt(n),this._isDeviceLost=!0}_renderBundle(e,n,i){const{bundleGroup:s,camera:r,renderList:o}=e,l=this._currentRenderContext,c=this._bundles.get(s,r),u=this.backend.get(c);u.renderContexts===void 0&&(u.renderContexts=new Set);const h=s.version!==u.version,f=u.renderContexts.has(l)===!1||h;if(u.renderContexts.add(l),f){this.backend.beginBundle(l),(u.renderObjects===void 0||h)&&(u.renderObjects=[]),this._currentRenderBundle=c;const{transparentDoublePass:m,transparent:A,opaque:x}=o;this.opaque===!0&&x.length>0&&this._renderObjects(x,r,n,i),this.transparent===!0&&A.length>0&&this._renderTransparents(A,m,r,n,i),this._currentRenderBundle=null,this.backend.finishBundle(l,c),u.version=s.version}else{const{renderObjects:m}=u;for(let A=0,x=m.length;A<x;A++){const T=m[A];this._nodes.needsRefresh(T)&&(this._nodes.updateBefore(T),this._nodes.updateForRender(T),this._bindings.updateForRender(T),this._nodes.updateAfter(T))}}this.backend.addBundle(l,c)}render(e,n){if(this._initialized===!1)throw new Error('Renderer: .render() called before the backend is initialized. Use "await renderer.init();" before rendering.');this._renderScene(e,n)}get initialized(){return this._initialized}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:n}=this,i=e!==lo,s=n!==Vn.workingColorSpace;if(i===!1&&s===!1)return null;const{width:r,height:o}=this.getDrawingBufferSize(Uv),{depth:l,stencil:c}=this;let u=this._frameBufferTarget;u===null&&(u=new th(r,o,{depthBuffer:l,stencilBuffer:c,type:this._outputBufferType,format:fs,colorSpace:Vn.workingColorSpace,generateMipmaps:!1,minFilter:di,magFilter:di,samples:this.samples}),u.isPostProcessingRenderTarget=!0,this._frameBufferTarget=u);const h=this.getOutputRenderTarget();u.depthBuffer=l,u.stencilBuffer=c,h!==null?u.setSize(h.width,h.height,h.depth):u.setSize(r,o,1);const f=this._canvasTarget;return u.viewport.copy(f._viewport),u.scissor.copy(f._scissor),u.viewport.multiplyScalar(f._pixelRatio),u.scissor.multiplyScalar(f._pixelRatio),u.scissorTest=f._scissorTest,u.multiview=h!==null?h.multiview:!1,u.resolveDepthBuffer=h!==null?h.resolveDepthBuffer:!0,u._autoAllocateDepthBuffer=h!==null?h._autoAllocateDepthBuffer:!1,u}_renderScene(e,n,i=!0){if(this._isDeviceLost===!0)return;const s=i?this._getFrameBufferTarget():null,r=this._nodes.nodeFrame,o=r.renderId,l=this._currentRenderContext,c=this._currentRenderObjectFunction,u=e.isScene===!0?e:GK,h=this._renderTarget||this._outputRenderTarget,f=this._activeCubeFace,m=this._activeMipmapLevel;let A;s!==null?(A=s,this.setRenderTarget(A)):A=h;const x=this._renderContexts.get(e,n,A,this._mrt);this._currentRenderContext=x,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,r.renderId=this.info.calls,this.backend.updateTimeStampUID(x),this.inspector.beginRender(this.backend.getTimestampUID(x),e,n,A);const T=this.coordinateSystem,E=this.xr;if(n.coordinateSystem!==T&&E.isPresenting===!1&&(n.coordinateSystem=T,n.updateProjectionMatrix(),n.isArrayCamera))for(const X of n.cameras)X.coordinateSystem=T,X.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),n.parent===null&&n.matrixWorldAutoUpdate===!0&&n.updateMatrixWorld(),E.enabled===!0&&E.isPresenting===!0&&(E.cameraAutoUpdate===!0&&E.updateCamera(n),n=E.getCamera());const M=this._canvasTarget;let N=M._viewport,I=M._scissor,F=M._pixelRatio;A!==null&&(N=A.viewport,I=A.scissor,F=1),this.getDrawingBufferSize(Uv),H5.set(0,0,Uv.width,Uv.height);const G=N.minDepth===void 0?0:N.minDepth,O=N.maxDepth===void 0?1:N.maxDepth;x.viewportValue.copy(N).multiplyScalar(F).floor(),x.viewportValue.width>>=m,x.viewportValue.height>>=m,x.viewportValue.minDepth=G,x.viewportValue.maxDepth=O,x.viewport=x.viewportValue.equals(H5)===!1,x.scissorValue.copy(I).multiplyScalar(F).floor(),x.scissor=M._scissorTest&&x.scissorValue.equals(H5)===!1,x.scissorValue.width>>=m,x.scissorValue.height>>=m,x.clippingContext||(x.clippingContext=new PR),x.clippingContext.updateGlobal(u,n),u.onBeforeRender(this,e,n,A);const D=n.isArrayCamera?$5:W5;n.isArrayCamera||(rC.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),D.setFromProjectionMatrix(rC,n.coordinateSystem,n.reversedDepth));const j=this._renderLists.get(e,n);if(j.begin(),this._projectObject(e,n,0,j,x.clippingContext),j.finish(),this.sortObjects===!0&&j.sort(this._opaqueSort,this._transparentSort),A!==null){this._textures.updateRenderTarget(A,m);const X=this._textures.get(A);x.textures=X.textures,x.depthTexture=X.depthTexture,x.width=X.width,x.height=X.height,x.renderTarget=A,x.depth=A.depthBuffer,x.stencil=A.stencilBuffer}else x.textures=null,x.depthTexture=null,x.width=Uv.width,x.height=Uv.height,x.depth=this.depth,x.stencil=this.stencil;x.width>>=m,x.height>>=m,x.activeCubeFace=f,x.activeMipmapLevel=m,x.occlusionQueryCount=j.occlusionQueryCount,x.scissorValue.max(Up.set(0,0,0,0)),x.scissorValue.x+x.scissorValue.width>x.width&&(x.scissorValue.width=Math.max(x.width-x.scissorValue.x,0)),x.scissorValue.y+x.scissorValue.height>x.height&&(x.scissorValue.height=Math.max(x.height-x.scissorValue.y,0)),this._background.update(u,j,x),x.camera=n,this.backend.beginRender(x);const{bundles:L,lightsNode:U,transparentDoublePass:q,transparent:K,opaque:H}=j;return L.length>0&&this._renderBundles(L,u,U),this.opaque===!0&&H.length>0&&this._renderObjects(H,n,u,U),this.transparent===!0&&K.length>0&&this._renderTransparents(K,q,n,u,U),this.backend.finishRender(x),r.renderId=o,this._currentRenderContext=l,this._currentRenderObjectFunction=c,s!==null&&(this.setRenderTarget(h,f,m),this._renderOutput(A)),u.onAfterRender(this,e,n,A),this.inspector.finishRender(this.backend.getTimestampUID(x)),x}_setXRLayerSize(e,n){this._canvasTarget._width=e,this._canvasTarget._height=n,this.setViewport(0,0,e,n)}_renderOutput(e){const n=this._quad;this._nodes.hasOutputChange(e.texture)&&(n.material.fragmentNode=this._nodes.getOutputNode(e.texture),n.material.needsUpdate=!0);const i=this.autoClear,s=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(n,n.camera,!1),this.autoClear=i,this.xr.enabled=s}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}getAnimationLoop(){return this._animation.getAnimationLoop()}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._canvasTarget.getPixelRatio()}getDrawingBufferSize(e){return this._canvasTarget.getDrawingBufferSize(e)}getSize(e){return this._canvasTarget.getSize(e)}setPixelRatio(e=1){this._canvasTarget.setPixelRatio(e)}setDrawingBufferSize(e,n,i){this.xr&&this.xr.isPresenting||this._canvasTarget.setDrawingBufferSize(e,n,i)}setSize(e,n,i=!0){this.xr&&this.xr.isPresenting||this._canvasTarget.setSize(e,n,i)}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){return this._canvasTarget.getScissor(e)}setScissor(e,n,i,s){this._canvasTarget.setScissor(e,n,i,s)}getScissorTest(){return this._canvasTarget.getScissorTest()}setScissorTest(e){this._canvasTarget.setScissorTest(e),this.backend.setScissorTest(e)}getViewport(e){return this._canvasTarget.getViewport(e)}setViewport(e,n,i,s,r=0,o=1){this._canvasTarget.setViewport(e,n,i,s,r,o)}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,n=1){this._clearColor.set(e),this._clearColor.a=n}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const n=this._currentRenderContext;return n&&this.backend.isOccluded(n,e)}clear(e=!0,n=!0,i=!0){if(this._initialized===!1)throw new Error('Renderer: .clear() called before the backend is initialized. Use "await renderer.init();" before before using this method.');const s=this._renderTarget||this._getFrameBufferTarget();let r=null;if(s!==null){this._textures.updateRenderTarget(s);const o=this._textures.get(s);r=this._renderContexts.getForClear(s),r.textures=o.textures,r.depthTexture=o.depthTexture,r.width=o.width,r.height=o.height,r.renderTarget=s,r.depth=s.depthBuffer,r.stencil=s.stencilBuffer,r.clearColorValue=this.backend.getClearColor(),r.activeCubeFace=this.getActiveCubeFace(),r.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,n,i,r),s!==null&&this._renderTarget===null&&this._renderOutput(s)}clearColor(){this.clear(!0,!1,!1)}clearDepth(){this.clear(!1,!0,!1)}clearStencil(){this.clear(!1,!1,!0)}async clearAsync(e=!0,n=!0,i=!0){ji('Renderer: "clearAsync()" has been deprecated. Use "clear()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.clear(e,n,i)}async clearColorAsync(){ji('Renderer: "clearColorAsync()" has been deprecated. Use "clearColor()" and "await renderer.init();" when creating the renderer.'),this.clear(!0,!1,!1)}async clearDepthAsync(){ji('Renderer: "clearDepthAsync()" has been deprecated. Use "clearDepth()" and "await renderer.init();" when creating the renderer.'),this.clear(!1,!0,!1)}async clearStencilAsync(){ji('Renderer: "clearStencilAsync()" has been deprecated. Use "clearStencil()" and "await renderer.init();" when creating the renderer.'),this.clear(!1,!1,!0)}get needsFrameBufferTarget(){const e=this.currentToneMapping!==lo,n=this.currentColorSpace!==Vn.workingColorSpace;return e||n}get samples(){return this._samples}get currentSamples(){let e=this._samples;return this._renderTarget!==null?e=this._renderTarget.samples:this.needsFrameBufferTarget&&(e=0),e}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:lo}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:Vn.workingColorSpace}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this._initialized===!0&&(this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._geometries.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()})),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,n=0,i=0){this._renderTarget=e,this._activeCubeFace=n,this._activeMipmapLevel=i}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}setCanvasTarget(e){this._canvasTarget.removeEventListener("resize",this._onCanvasTargetResize),this._canvasTarget=e,this._canvasTarget.addEventListener("resize",this._onCanvasTargetResize)}getCanvasTarget(){return this._canvasTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e,n=null){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return yt("Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e,n);const i=this._nodes.nodeFrame,s=i.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,i.renderId=this.info.calls,this.backend.updateTimeStampUID(e),this.inspector.beginCompute(this.backend.getTimestampUID(e),e);const r=this.backend,o=this._pipelines,l=this._bindings,c=this._nodes,u=Array.isArray(e)?e:[e];if(u[0]===void 0||u[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");r.beginCompute(e);for(const h of u){if(o.has(h)===!1){const A=()=>{h.removeEventListener("dispose",A),o.delete(h),l.deleteForCompute(h),c.delete(h)};h.addEventListener("dispose",A);const x=h.onInitFunction;x!==null&&x.call(h,{renderer:this})}c.updateForCompute(h),l.updateForCompute(h);const f=l.getForCompute(h),m=o.getForCompute(h,f);r.compute(e,h,f,m,n)}r.finishCompute(e),i.renderId=s,this.inspector.finishCompute(this.backend.getTimestampUID(e))}async computeAsync(e,n=null){this._initialized===!1&&await this.init(),this.compute(e,n)}async hasFeatureAsync(e){return ji('Renderer: "hasFeatureAsync()" has been deprecated. Use "hasFeature()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){if(this._initialized===!1)throw new Error('Renderer: .hasFeature() called before the backend is initialized. Use "await renderer.init();" before before using this method.');return this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){ji('Renderer: "initTextureAsync()" has been deprecated. Use "initTexture()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.initTexture(e)}initTexture(e){if(this._initialized===!1)throw new Error('Renderer: .initTexture() called before the backend is initialized. Use "await renderer.init();" before before using this method.');this._textures.updateTexture(e)}copyFramebufferToTexture(e,n=null){if(n!==null)if(n.isVector2)n=Up.set(n.x,n.y,e.image.width,e.image.height).floor();else if(n.isVector4)n=Up.copy(n).floor();else{Rt("Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else n=Up.set(0,0,e.image.width,e.image.height);let i=this._currentRenderContext,s;i!==null?s=i.renderTarget:(s=this._renderTarget||this._getFrameBufferTarget(),s!==null&&(this._textures.updateRenderTarget(s),i=this._textures.get(s))),this._textures.updateTexture(e,{renderTarget:s}),this.backend.copyFramebufferToTexture(e,i,n),this._inspector.copyFramebufferToTexture(e)}copyTextureToTexture(e,n,i=null,s=null,r=0,o=0){this._textures.updateTexture(e),this._textures.updateTexture(n),this.backend.copyTextureToTexture(e,n,i,s,r,o),this._inspector.copyTextureToTexture(e,n)}async readRenderTargetPixelsAsync(e,n,i,s,r,o=0,l=0){return this.backend.copyTextureToBuffer(e.textures[o],n,i,s,r,l)}_projectObject(e,n,i,s,r){if(e.visible===!1)return;if(e.layers.test(n.layers)){if(e.isGroup)i=e.renderOrder,e.isClippingGroup&&e.enabled&&(r=r.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(n);else if(e.isLight)s.pushLight(e);else if(e.isSprite){const c=n.isArrayCamera?$5:W5;if(!e.frustumCulled||c.intersectsSprite(e,n)){this.sortObjects===!0&&Up.setFromMatrixPosition(e.matrixWorld).applyMatrix4(rC);const{geometry:u,material:h}=e;h.visible&&s.push(e,u,h,i,Up.z,null,r)}}else if(e.isLineLoop)Rt("Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const c=n.isArrayCamera?$5:W5;if(!e.frustumCulled||c.intersectsObject(e,n)){const{geometry:u,material:h}=e;if(this.sortObjects===!0&&(u.boundingSphere===null&&u.computeBoundingSphere(),Up.copy(u.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(rC)),Array.isArray(h)){const f=u.groups;for(let m=0,A=f.length;m<A;m++){const x=f[m],T=h[x.materialIndex];T&&T.visible&&s.push(e,u,T,i,Up.z,x,r)}}else h.visible&&s.push(e,u,h,i,Up.z,null,r)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const c=s;s=this._renderLists.get(e,n),s.begin(),c.pushBundle({bundleGroup:e,camera:n,renderList:s}),s.finish()}const l=e.children;for(let c=0,u=l.length;c<u;c++)this._projectObject(l[c],n,i,s,r)}_renderBundles(e,n,i){for(const s of e)this._renderBundle(s,n,i)}_renderTransparents(e,n,i,s,r){if(n.length>0){for(const{material:o}of n)o.side=Di;this._renderObjects(n,i,s,r,"backSide");for(const{material:o}of n)o.side=Ac;this._renderObjects(e,i,s,r);for(const{material:o}of n)o.side=er}else this._renderObjects(e,i,s,r)}_renderObjects(e,n,i,s,r=null){for(let o=0,l=e.length;o<l;o++){const{object:c,geometry:u,material:h,group:f,clippingContext:m}=e[o];this._currentRenderObjectFunction(c,i,n,u,h,f,s,m,r)}}_getShadowNodes(e){const n=e.version;let i=this._cacheShadowNodes.get(e);if(i===void 0||i.version!==n){const s=e.map!==null,r=e.colorNode&&e.colorNode.isNode,o=e.castShadowNode&&e.castShadowNode.isNode;let l=null,c=null,u=null;if(s||r||o){let h,f;o?(h=e.castShadowNode.rgb,f=e.castShadowNode.a):(h=qe(0),f=Re(1)),s&&(f=f.mul(Bi("map","texture",e).a)),r&&(f=f.mul(e.colorNode.a)),c=On(h,f)}e.depthNode&&e.depthNode.isNode&&(u=e.depthNode),e.castShadowPositionNode&&e.castShadowPositionNode.isNode?l=e.castShadowPositionNode:e.positionNode&&e.positionNode.isNode&&(l=e.positionNode),i={version:n,colorNode:c,depthNode:u,positionNode:l},this._cacheShadowNodes.set(e,i)}return i}renderObject(e,n,i,s,r,o,l,c=null,u=null){let h=!1,f,m,A,x;if(e.onBeforeRender(this,n,i,s,r,o),r.allowOverride===!0&&n.overrideMaterial!==null){const T=n.overrideMaterial;if(h=!0,f=n.overrideMaterial.colorNode,m=n.overrideMaterial.depthNode,A=n.overrideMaterial.positionNode,x=n.overrideMaterial.side,r.positionNode&&r.positionNode.isNode&&(T.positionNode=r.positionNode),T.alphaTest=r.alphaTest,T.alphaMap=r.alphaMap,T.transparent=r.transparent||r.transmission>0||r.transmissionNode&&r.transmissionNode.isNode||r.backdropNode&&r.backdropNode.isNode,T.isShadowPassMaterial){const{colorNode:E,depthNode:M,positionNode:N}=this._getShadowNodes(r);T.side=r.shadowSide===null?r.side:r.shadowSide,E!==null&&(T.colorNode=E),M!==null&&(T.depthNode=M),N!==null&&(T.positionNode=N)}r=T}r.transparent===!0&&r.side===er&&r.forceSinglePass===!1?(r.side=Di,this._handleObjectFunction(e,r,n,i,l,o,c,"backSide"),r.side=Ac,this._handleObjectFunction(e,r,n,i,l,o,c,u),r.side=er):this._handleObjectFunction(e,r,n,i,l,o,c,u),h&&(n.overrideMaterial.colorNode=f,n.overrideMaterial.depthNode=m,n.overrideMaterial.positionNode=A,n.overrideMaterial.side=x),e.onAfterRender(this,n,i,s,r,o)}_renderObjectDirect(e,n,i,s,r,o,l,c){const u=this._objects.get(e,n,i,s,r,this._currentRenderContext,l,c);u.drawRange=e.geometry.drawRange,u.group=o;const h=this._nodes.needsRefresh(u);h&&(this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u)),this._pipelines.updateForRender(u),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(u),u.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(u,this.info),h&&this._nodes.updateAfter(u)}_createObjectPipeline(e,n,i,s,r,o,l,c){const u=this._objects.get(e,n,i,s,r,this._currentRenderContext,l,c);u.drawRange=e.geometry.drawRange,u.group=o,this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u),this._pipelines.getForRender(u,this._compilationPromises),this._nodes.updateAfter(u)}_onCanvasTargetResize(){this._initialized&&this.backend.updateSize()}get compile(){return this.compileAsync}}class aoe{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}getVisibility(){return this.visibility}clone(){return Object.assign(new this.constructor,this)}}function Pqe(a){return a+(kg-a%kg)%kg}let ioe=class extends aoe{constructor(e,n=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=n,this._updateRanges=[]}get updateRanges(){return this._updateRanges}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}get byteLength(){return Pqe(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}};class soe extends ioe{constructor(e,n=null){super(e,n),this.isUniformBuffer=!0}}let Iqe=0;class roe extends soe{constructor(e,n){super("UniformBuffer_"+Iqe++,e?e.value:null),this.nodeUniform=e,this.groupNode=n,this.isNodeUniformBuffer=!0}set updateRanges(e){this.nodeUniform.updateRanges=e}get updateRanges(){return this.nodeUniform.updateRanges}addUpdateRange(e,n){this.nodeUniform.addUpdateRange(e,n)}clearUpdateRanges(){this.nodeUniform.clearUpdateRanges()}get buffer(){return this.nodeUniform.value}}class Lqe extends soe{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const n=this.byteLength;e=new Float32Array(new ArrayBuffer(n)),this._buffer=e}return e}get byteLength(){const e=this.bytesPerElement;let n=0;for(let i=0,s=this.uniforms.length;i<s;i++){const r=this.uniforms[i],o=r.boundary,l=r.itemSize*e,c=n%kg,u=c%o,h=c+u;n+=u,h!==0&&kg-h<l&&(n+=kg-h),r.offset=n/e,n+=l}return Math.ceil(n/kg)*kg}update(){let e=!1;for(const n of this.uniforms)this.updateByType(n)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);Rt("WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let n=!1;const i=this.values,s=e.getValue(),r=e.offset,o=e.getType();if(i[r]!==s){const l=this._getBufferForType(o);l[r]=i[r]=s,n=!0}return n}updateVector2(e){let n=!1;const i=this.values,s=e.getValue(),r=e.offset,o=e.getType();if(i[r+0]!==s.x||i[r+1]!==s.y){const l=this._getBufferForType(o);l[r+0]=i[r+0]=s.x,l[r+1]=i[r+1]=s.y,n=!0}return n}updateVector3(e){let n=!1;const i=this.values,s=e.getValue(),r=e.offset,o=e.getType();if(i[r+0]!==s.x||i[r+1]!==s.y||i[r+2]!==s.z){const l=this._getBufferForType(o);l[r+0]=i[r+0]=s.x,l[r+1]=i[r+1]=s.y,l[r+2]=i[r+2]=s.z,n=!0}return n}updateVector4(e){let n=!1;const i=this.values,s=e.getValue(),r=e.offset,o=e.getType();if(i[r+0]!==s.x||i[r+1]!==s.y||i[r+2]!==s.z||i[r+4]!==s.w){const l=this._getBufferForType(o);l[r+0]=i[r+0]=s.x,l[r+1]=i[r+1]=s.y,l[r+2]=i[r+2]=s.z,l[r+3]=i[r+3]=s.w,n=!0}return n}updateColor(e){let n=!1;const i=this.values,s=e.getValue(),r=e.offset;if(i[r+0]!==s.r||i[r+1]!==s.g||i[r+2]!==s.b){const o=this.buffer;o[r+0]=i[r+0]=s.r,o[r+1]=i[r+1]=s.g,o[r+2]=i[r+2]=s.b,n=!0}return n}updateMatrix3(e){let n=!1;const i=this.values,s=e.getValue().elements,r=e.offset;if(i[r+0]!==s[0]||i[r+1]!==s[1]||i[r+2]!==s[2]||i[r+4]!==s[3]||i[r+5]!==s[4]||i[r+6]!==s[5]||i[r+8]!==s[6]||i[r+9]!==s[7]||i[r+10]!==s[8]){const o=this.buffer;o[r+0]=i[r+0]=s[0],o[r+1]=i[r+1]=s[1],o[r+2]=i[r+2]=s[2],o[r+4]=i[r+4]=s[3],o[r+5]=i[r+5]=s[4],o[r+6]=i[r+6]=s[5],o[r+8]=i[r+8]=s[6],o[r+9]=i[r+9]=s[7],o[r+10]=i[r+10]=s[8],n=!0}return n}updateMatrix4(e){let n=!1;const i=this.values,s=e.getValue().elements,r=e.offset;return kqe(i,s,r)===!1&&(this.buffer.set(s,r),Dqe(i,s,r),n=!0),n}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function Dqe(a,e,n){for(let i=0,s=e.length;i<s;i++)a[n+i]=e[i]}function kqe(a,e,n){for(let i=0,s=e.length;i<s;i++)if(a[n+i]!==e[i])return!1;return!0}let Oqe=0;class ooe extends Lqe{constructor(e,n){super(e),this.id=Oqe++,this.groupNode=n,this.isNodeUniformsGroup=!0}}class loe extends aoe{constructor(e,n){super(e),this._texture=null,this._onTextureDispose=()=>{this.generation=null,this.version=0},this.texture=n,this.version=n?n.version:0,this.generation=null,this.samplerKey="",this.isSampler=!0}set texture(e){this._texture!==e&&(this._texture&&this._texture.removeEventListener("dispose",this._onTextureDispose),this._texture=e,this.generation=null,this.version=0,this._texture&&this._texture.addEventListener("dispose",this._onTextureDispose))}get texture(){return this._texture}update(){const{texture:e,version:n}=this;return n!==e.version?(this.version=e.version,!0):!1}clone(){const e=super.clone();return e._texture=null,e._onTextureDispose=()=>{e.generation=null,e.version=0},e.texture=this.texture,e}}let Fqe=0;class jqe extends loe{constructor(e,n){super(e,n),this.id=Fqe++,this.store=!1,this.mipLevel=0,this.isSampledTexture=!0}}class rI extends jqe{constructor(e,n,i,s=null){super(e,n?n.value:null),this.textureNode=n,this.groupNode=i,this.access=s}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class coe extends rI{constructor(e,n,i,s=null){super(e,n,i,s),this.isSampledCubeTexture=!0}}class qO extends rI{constructor(e,n,i,s=null){super(e,n,i,s),this.isSampledTexture3D=!0}}const qK={bitcast_int_uint:new ao("uint tsl_bitcast_int_to_uint ( int x ) { return floatBitsToUint( intBitsToFloat ( x ) ); }"),bitcast_uint_int:new ao("uint tsl_bitcast_uint_to_int ( uint x ) { return floatBitsToInt( uintBitsToFloat ( x ) ); }")},Bqe={textureDimensions:"textureSize",equals:"equal",bitcast_float_int:"floatBitsToInt",bitcast_int_float:"intBitsToFloat",bitcast_uint_float:"uintBitsToFloat",bitcast_float_uint:"floatBitsToUint",bitcast_uint_int:"tsl_bitcast_uint_to_int",bitcast_int_uint:"tsl_bitcast_int_to_uint",floatpack_snorm_2x16:"packSnorm2x16",floatpack_unorm_2x16:"packUnorm2x16",floatpack_float16_2x16:"packHalf2x16",floatunpack_snorm_2x16:"unpackSnorm2x16",floatunpack_unorm_2x16:"unpackUnorm2x16",floatunpack_float16_2x16:"unpackHalf2x16"},Uqe={low:"lowp",medium:"mediump",high:"highp"},HK={swizzleAssign:!0,storageBuffer:!1},WK={perspective:"smooth",linear:"noperspective"},$K={centroid:"centroid"},KK=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class Vqe extends eoe{constructor(e,n){super(e,n,new mqe),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Il}_include(e){const n=qK[e];return n.build(this),this.addInclude(n),n}getMethod(e){return qK[e]!==void 0&&this._include(e),Bqe[e]||e}getBitcastMethod(e,n){return this.getMethod(`bitcast_${n}_${e}`)}getFloatPackingMethod(e){return this.getMethod(`floatpack_${e}_2x16`)}getFloatUnpackingMethod(e){return this.getMethod(`floatunpack_${e}_2x16`)}getTernary(e,n,i){return`${e} ? ${n} : ${i}`}getOutputStructName(){return""}buildFunctionCode(e){const n=e.layout,i=this.flowShaderNode(e),s=[];for(const o of n.inputs)s.push(this.getType(o.type)+" "+o.name);return`${this.getType(n.type)} ${n.name}( ${s.join(", ")} ) {

	${i.vars}

${i.code}
	return ${i.result};

}`}setupPBO(e){const n=e.value;if(n.pbo===void 0){const i=n.array,s=n.count*n.itemSize,{itemSize:r}=n,o=n.array.constructor.name.toLowerCase().includes("int");let l=o?E0:r1;r===2?l=o?o1:ol:r===3?l=o?eee:Fx:r===4&&(l=o?l1:fs);const c={Float32Array:ls,Uint8Array:os,Uint16Array:Bu,Uint32Array:Ei,Int8Array:e0,Int16Array:t0,Int32Array:jr,Uint8ClampedArray:os},u=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(s/r))));let h=Math.ceil(s/r/u);u*h*r<s&&h++;const f=u*h*r,m=new i.constructor(f);m.set(i,0),n.array=m;const A=new cu(n.array,u,h,l,c[n.array.constructor.name]||ls);A.needsUpdate=!0,A.isPBOTexture=!0;const x=new qf(A,null,null);x.setPrecision("high"),n.pboNode=x,n.pbo=x.value,this.getUniformFromNode(n.pboNode,"texture",this.shaderStage,this.context.nodeName)}}getPropertyName(e,n=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?n.charAt(0)+"_"+e.name:super.getPropertyName(e,n)}generatePBO(e){const{node:n,indexNode:i}=e,s=n.value;if(this.renderer.backend.has(s)){const h=this.renderer.backend.get(s);h.pbo=s.pbo}const r=this.getUniformFromNode(s.pboNode,"texture",this.shaderStage,this.context.nodeName),o=this.getPropertyName(r);this.increaseUsage(i);const l=i.build(this,"uint"),c=this.getDataFromNode(e);let u=c.propertyName;if(u===void 0){const h=this.getVarFromNode(e);u=this.getPropertyName(h);const f=this.getDataFromNode(n);let m=f.propertySizeName;m===void 0&&(m=u+"Size",this.getVarFromNode(n,m,"uint"),this.addLineFlowCode(`${m} = uint( textureSize( ${o}, 0 ).x )`,e),f.propertySizeName=m);const{itemSize:A}=s,x="."+m1.join("").slice(0,A),T=`ivec2(${l} % ${m}, ${l} / ${m})`,E=this.generateTextureLoad(null,o,T,"0",null,null);let M="vec4";s.pbo.type===Ei?M="uvec4":s.pbo.type===jr&&(M="ivec4"),this.addLineFlowCode(`${u} = ${M}(${E})${x}`,e),c.propertyName=u}return u}generateTextureLoad(e,n,i,s,r,o){s===null&&(s="0");let l;return r?o?l=`texelFetchOffset( ${n}, ivec3( ${i}, ${r} ), ${s}, ${o} )`:l=`texelFetch( ${n}, ivec3( ${i}, ${r} ), ${s} )`:o?l=`texelFetchOffset( ${n}, ${i}, ${s}, ${o} )`:l=`texelFetch( ${n}, ${i}, ${s} )`,e!==null&&e.isDepthTexture&&(l+=".x"),l}generateTexture(e,n,i,s,r){return s&&(i=`vec3( ${i}, ${s} )`),e.isDepthTexture?r?`textureOffset( ${n}, ${i}, ${r} ).x`:`texture( ${n}, ${i} ).x`:r?`textureOffset( ${n}, ${i}, ${r} )`:`texture( ${n}, ${i} )`}generateTextureLevel(e,n,i,s,r){return r?`textureLodOffset( ${n}, ${i}, ${s}, ${r} )`:`textureLod( ${n}, ${i}, ${s} )`}generateTextureBias(e,n,i,s,r){return r?`textureOffset( ${n}, ${i}, ${r}, ${s} )`:`texture( ${n}, ${i}, ${s} )`}generateTextureGrad(e,n,i,s,r){return r?`textureGradOffset( ${n}, ${i}, ${s[0]}, ${s[1]}, ${r} )`:`textureGrad( ${n}, ${i}, ${s[0]}, ${s[1]} )`}generateTextureCompare(e,n,i,s,r,o,l=this.shaderStage){if(l==="fragment")return e.isCubeTexture?`texture( ${n}, vec4( ${i}, ${s} ) )`:r?o?`textureOffset( ${n}, vec4( ${i}, ${r}, ${s} ), ${o} )`:`texture( ${n}, vec4( ${i}, ${r}, ${s} ) )`:o?`textureOffset( ${n}, vec3( ${i}, ${s} ), ${o} )`:`texture( ${n}, vec3( ${i}, ${s} ) )`;Rt(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${l} shader.`)}getVars(e){const n=[],i=this.vars[e];if(i!==void 0)for(const s of i)n.push(`${this.getVar(s.type,s.name,s.count)};`);return n.join(`
	`)}getUniforms(e){const n=this.uniforms[e],i=[],s={};for(const o of n){let l=null,c=!1;if(o.type==="texture"||o.type==="texture3D"){const h=o.node.value;let f="";(h.isDataTexture===!0||h.isData3DTexture===!0)&&(h.type===Ei?f="u":h.type===jr&&(f="i")),o.type==="texture3D"&&h.isArrayTexture===!1?l=`${f}sampler3D ${o.name};`:h.compareFunction?h.isArrayTexture===!0?l=`sampler2DArrayShadow ${o.name};`:l=`sampler2DShadow ${o.name};`:h.isArrayTexture===!0||h.isDataArrayTexture===!0||h.isCompressedArrayTexture===!0?l=`${f}sampler2DArray ${o.name};`:l=`${f}sampler2D ${o.name};`}else if(o.type==="cubeTexture")l=`samplerCube ${o.name};`;else if(o.type==="cubeDepthTexture")l=`samplerCubeShadow ${o.name};`;else if(o.type==="buffer"){const h=o.node,f=this.getType(h.bufferType),m=h.bufferCount,A=m>0?m:"";l=`${h.name} {
	${f} ${o.name}[${A}];
};
`}else l=`${this.getVectorType(o.type)} ${this.getPropertyName(o,e)};`,c=!0;const u=o.node.precision;if(u!==null&&(l=Uqe[u]+" "+l),c){l="	"+l;const h=o.groupNode.name;(s[h]||(s[h]=[])).push(l)}else l="uniform "+l,i.push(l)}let r="";for(const o in s){const l=s[o];r+=this._getGLSLUniformStruct(e+"_"+o,l.join(`
`))+`
`}return r+=i.join(`
`),r}getTypeFromAttribute(e){let n=super.getTypeFromAttribute(e);if(/^[iu]/.test(n)&&e.gpuType!==jr){let i=e;e.isInterleavedBufferAttribute&&(i=e.data);const s=i.array;s instanceof Uint32Array||s instanceof Int32Array||(n=n.slice(1))}return n}getAttributes(e){let n="";if(e==="vertex"||e==="compute"){const i=this.getAttributesArray();let s=0;for(const r of i)n+=`layout( location = ${s++} ) in ${r.type} ${r.name};
`}return n}getStructMembers(e){const n=[];for(const i of e.members)n.push(`	${i.type} ${i.name};`);return n.join(`
`)}getStructs(e){const n=[],i=this.structs[e],s=[];for(const r of i)if(r.output)for(const o of r.members)s.push(`layout( location = ${o.index} ) out ${o.type} ${o.name};`);else{let o="struct "+r.name+` {
`;o+=this.getStructMembers(r),o+=`
};
`,n.push(o)}return s.length===0&&s.push("layout( location = 0 ) out vec4 fragColor;"),`
`+s.join(`
`)+`

`+n.join(`
`)}getVaryings(e){let n="";const i=this.varyings;if(e==="vertex"||e==="compute")for(const s of i){e==="compute"&&(s.needsInterpolation=!0);const r=this.getType(s.type);if(s.needsInterpolation)if(s.interpolationType){const o=WK[s.interpolationType]||s.interpolationType,l=$K[s.interpolationSampling]||"";n+=`${o} ${l} out ${r} ${s.name};
`}else{const o=r.includes("int")||r.includes("uv")||r.includes("iv")?"flat ":"";n+=`${o}out ${r} ${s.name};
`}else n+=`${r} ${s.name};
`}else if(e==="fragment"){for(const s of i)if(s.needsInterpolation){const r=this.getType(s.type);if(s.interpolationType){const o=WK[s.interpolationType]||s.interpolationType,l=$K[s.interpolationSampling]||"";n+=`${o} ${l} in ${r} ${s.name};
`}else{const o=r.includes("int")||r.includes("uv")||r.includes("iv")?"flat ":"";n+=`${o}in ${r} ${s.name};
`}}}for(const s of this.builtins[e])n+=`${s};
`;return n}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((i,s)=>i*s,1)}u`}getSubgroupSize(){Rt("GLSLNodeBuilder: WebGLBackend does not support the subgroupSize node")}getInvocationSubgroupIndex(){Rt("GLSLNodeBuilder: WebGLBackend does not support the invocationSubgroupIndex node")}getSubgroupIndex(){Rt("GLSLNodeBuilder: WebGLBackend does not support the subgroupIndex node")}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,n,i=this.shaderStage){const s=this.extensions[i]||(this.extensions[i]=new Map);s.has(e)===!1&&s.set(e,{name:e,behavior:n})}getExtensions(e){const n=[];if(e==="vertex"){const s=this.renderer.backend.extensions;this.object.isBatchedMesh&&s.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const i=this.extensions[e];if(i!==void 0)for(const{name:s,behavior:r}of i.values())n.push(`#extension ${s} : ${r}`);return n.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let n=HK[e];if(n===void 0){let i;switch(n=!1,e){case"float32Filterable":i="OES_texture_float_linear";break;case"clipDistance":i="WEBGL_clip_cull_distance";break}if(i!==void 0){const s=this.renderer.backend.extensions;s.has(i)&&(s.get(i),n=!0)}HK[e]=n}return n}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,n){this.transforms.push({varyingName:e,attributeNode:n})}getTransforms(){const e=this.transforms;let n="";for(let i=0;i<e.length;i++){const s=e[i],r=this.getPropertyName(s.attributeNode);r&&(n+=`${s.varyingName} = ${r};
	`)}return n}_getGLSLUniformStruct(e,n){return`
layout( std140 ) uniform ${e} {
${n}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${KK}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${KK}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const n in e){let i=`// code

`;i+=this.flowCode[n];const s=this.flowNodes[n],r=s[s.length-1];for(const l of s){const c=this.getFlowData(l),u=l.name;u&&(i.length>0&&(i+=`
`),i+=`	// flow -> ${u}
	`),i+=`${c.code}
	`,l===r&&n!=="compute"&&(i+=`// result
	`,n==="vertex"?(i+="gl_Position = ",i+=`${c.result};`):n==="fragment"&&(l.outputNode.isOutputStructNode||(i+="fragColor = ",i+=`${c.result};`)))}const o=e[n];o.extensions=this.getExtensions(n),o.uniforms=this.getUniforms(n),o.attributes=this.getAttributes(n),o.varyings=this.getVaryings(n),o.vars=this.getVars(n),o.structs=this.getStructs(n),o.codes=this.getCodes(n),o.transforms=this.getTransforms(n),o.flow=i}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,n,i,s=null){const r=super.getUniformFromNode(e,n,i,s),o=this.getDataFromNode(e,i,this.globalCache);let l=o.uniformGPU;if(l===void 0){const c=e.groupNode,u=c.name,h=this.getBindGroupArray(u,i);if(n==="texture")l=new rI(r.name,r.node,c),h.push(l);else if(n==="cubeTexture"||n==="cubeDepthTexture")l=new coe(r.name,r.node,c),h.push(l);else if(n==="texture3D")l=new qO(r.name,r.node,c),h.push(l);else if(n==="buffer"){r.name=`buffer${e.id}`;const f=this.getSharedDataFromNode(e);let m=f.buffer;m===void 0&&(e.name=`NodeBuffer_${e.id}`,m=new roe(e,c),m.name=e.name,f.buffer=m),h.push(m),l=m}else{const f=this.uniformGroups[i]||(this.uniformGroups[i]={});let m=f[u];m===void 0&&(m=new ooe(i+"_"+u,c),f[u]=m,h.push(m)),l=this.getNodeUniform(r,n),m.addUniform(l)}o.uniformGPU=l}return r}}let K5=null,Vv=null;class uoe{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={[Fd.RENDER]:null,[Fd.COMPUTE]:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}updateSampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}updateTimeStampUID(e){const n=this.get(e),i=this.renderer.info.frame;let s;e.isComputeNode===!0?s="c:"+this.renderer.info.compute.frameCalls:s="r:"+this.renderer.info.render.frameCalls,n.timestampUID=s+":"+e.id+":f"+i}getTimestampUID(e){return this.get(e).timestampUID}getTimestampFrames(e){const n=this.timestampQueryPool[e];return n?n.getTimestampFrames():[]}_getQueryPool(e){const n=e.startsWith("c:")?Fd.COMPUTE:Fd.RENDER;return this.timestampQueryPool[n]}getTimestamp(e){return this._getQueryPool(e).getTimestamp(e)}hasTimestamp(e){return this._getQueryPool(e).hasTimestamp(e)}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){ji("WebGPURenderer: Timestamp tracking is disabled.");return}const n=this.timestampQueryPool[e];if(!n)return;const i=await n.resolveQueriesAsync();return this.renderer.info[e].timestamp=i,i}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return K5=K5||new Nt,this.renderer.getDrawingBufferSize(K5)}setScissorTest(){}getClearColor(){const e=this.renderer;return Vv=Vv||new y7,e.getClearColor(Vv),Vv.getRGB(Vv),Vv}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:aj(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${w0} webgpu`),this.domElement=e),e}set(e,n){this.data.set(e,n)}get(e){let n=this.data.get(e);return n===void 0&&(n={},this.data.set(e,n)),n}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}deleteBindGroupData(){}dispose(){}}let zqe=0;class Gqe{constructor(e,n){this.buffers=[e.bufferGPU,n],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class qqe{constructor(e){this.backend=e}createAttribute(e,n){const i=this.backend,{gl:s}=i,r=e.array,o=e.usage||s.STATIC_DRAW,l=e.isInterleavedBufferAttribute?e.data:e,c=i.get(l);let u=c.bufferGPU;u===void 0&&(u=this._createBuffer(s,n,r,o),c.bufferGPU=u,c.bufferType=n,c.version=l.version);let h;if(r instanceof Float32Array)h=s.FLOAT;else if(typeof Float16Array<"u"&&r instanceof Float16Array)h=s.HALF_FLOAT;else if(r instanceof Uint16Array)e.isFloat16BufferAttribute?h=s.HALF_FLOAT:h=s.UNSIGNED_SHORT;else if(r instanceof Int16Array)h=s.SHORT;else if(r instanceof Uint32Array)h=s.UNSIGNED_INT;else if(r instanceof Int32Array)h=s.INT;else if(r instanceof Int8Array)h=s.BYTE;else if(r instanceof Uint8Array)h=s.UNSIGNED_BYTE;else if(r instanceof Uint8ClampedArray)h=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+r);let f={bufferGPU:u,bufferType:n,type:h,byteLength:r.byteLength,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:h===s.INT||h===s.UNSIGNED_INT||e.gpuType===jr,id:zqe++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const m=this._createBuffer(s,n,r,o);f=new Gqe(f,m)}i.set(e,f)}updateAttribute(e){const n=this.backend,{gl:i}=n,s=e.array,r=e.isInterleavedBufferAttribute?e.data:e,o=n.get(r),l=o.bufferType,c=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(i.bindBuffer(l,o.bufferGPU),c.length===0)i.bufferSubData(l,0,s);else{for(let u=0,h=c.length;u<h;u++){const f=c[u];i.bufferSubData(l,f.start*s.BYTES_PER_ELEMENT,s,f.start,f.count)}r.clearUpdateRanges()}i.bindBuffer(l,null),o.version=r.version}destroyAttribute(e){const n=this.backend,{gl:i}=n;e.isInterleavedBufferAttribute&&n.delete(e.data);const s=n.get(e);i.deleteBuffer(s.bufferGPU),n.delete(e)}async getArrayBufferAsync(e){const n=this.backend,{gl:i}=n,s=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:r}=n.get(s),o=e.array,l=o.byteLength;i.bindBuffer(i.COPY_READ_BUFFER,r);const c=i.createBuffer();i.bindBuffer(i.COPY_WRITE_BUFFER,c),i.bufferData(i.COPY_WRITE_BUFFER,l,i.STREAM_READ),i.copyBufferSubData(i.COPY_READ_BUFFER,i.COPY_WRITE_BUFFER,0,0,l),await n.utils._clientWaitAsync();const u=new e.array.constructor(o.length);return i.bindBuffer(i.COPY_WRITE_BUFFER,c),i.getBufferSubData(i.COPY_WRITE_BUFFER,0,u),i.deleteBuffer(c),i.bindBuffer(i.COPY_READ_BUFFER,null),i.bindBuffer(i.COPY_WRITE_BUFFER,null),u.buffer}_createBuffer(e,n,i,s){const r=e.createBuffer();return e.bindBuffer(n,r),e.bufferData(n,i,s),e.bindBuffer(n,null),r}}let Y5,b2;class Hqe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;Y5={[Co]:e.FUNC_ADD,[TP]:e.FUNC_SUBTRACT,[wP]:e.FUNC_REVERSE_SUBTRACT},b2={[Oh]:e.ZERO,[EP]:e.ONE,[MP]:e.SRC_COLOR,[q_]:e.SRC_ALPHA,[LP]:e.SRC_ALPHA_SATURATE,[PP]:e.DST_COLOR,[NP]:e.DST_ALPHA,[CP]:e.ONE_MINUS_SRC_COLOR,[H_]:e.ONE_MINUS_SRC_ALPHA,[IP]:e.ONE_MINUS_DST_COLOR,[RP]:e.ONE_MINUS_DST_ALPHA};const n=e.getParameter(e.SCISSOR_BOX),i=e.getParameter(e.VIEWPORT);this.currentScissor=new qn().fromArray(n),this.currentViewport=new qn().fromArray(i),this._tempVec4=new qn}enable(e){const{enabled:n}=this;n[e]!==!0&&(this.gl.enable(e),n[e]=!0)}disable(e){const{enabled:n}=this;n[e]!==!1&&(this.gl.disable(e),n[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:n}=this;e?n.frontFace(n.CW):n.frontFace(n.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:n}=this;e!==WF?(this.enable(n.CULL_FACE),e!==this.currentCullFace&&(e===TN?n.cullFace(n.BACK):e===$F?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):this.disable(n.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:n,gl:i}=this;e!==n&&(i.lineWidth(e),this.currentLineWidth=e)}setMRTBlending(e){const n=this.gl,i=this.backend.drawBuffersIndexedExt;if(i)for(let s=1;s<e.length;s++)i.blendFuncSeparateiOES(s,n.ONE,n.ZERO,n.ONE,n.ZERO)}setBlending(e,n,i,s,r,o,l,c){const{gl:u}=this;if(e===hl){this.currentBlendingEnabled===!0&&(this.disable(u.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(u.BLEND),this.currentBlendingEnabled=!0),e!==QA){if(e!==this.currentBlending||c!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==Co||this.currentBlendEquationAlpha!==Co)&&(u.blendEquation(u.FUNC_ADD),this.currentBlendEquation=Co,this.currentBlendEquationAlpha=Co),c)switch(e){case fl:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case xy:u.blendFunc(u.ONE,u.ONE);break;case by:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case Sy:u.blendFuncSeparate(u.DST_COLOR,u.ONE_MINUS_SRC_ALPHA,u.ZERO,u.ONE);break;default:Rt("WebGLState: Invalid blending: ",e);break}else switch(e){case fl:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case xy:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE,u.ONE,u.ONE);break;case by:Rt("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Sy:Rt("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Rt("WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=c}return}r=r||n,o=o||i,l=l||s,(n!==this.currentBlendEquation||r!==this.currentBlendEquationAlpha)&&(u.blendEquationSeparate(Y5[n],Y5[r]),this.currentBlendEquation=n,this.currentBlendEquationAlpha=r),(i!==this.currentBlendSrc||s!==this.currentBlendDst||o!==this.currentBlendSrcAlpha||l!==this.currentBlendDstAlpha)&&(u.blendFuncSeparate(b2[i],b2[s],b2[o],b2[l]),this.currentBlendSrc=i,this.currentBlendDst=s,this.currentBlendSrcAlpha=o,this.currentBlendDstAlpha=l),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:n}=this;e?this.enable(n.DEPTH_TEST):this.disable(n.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:n}=this;switch(e){case W_:n.depthFunc(n.NEVER);break;case $_:n.depthFunc(n.ALWAYS);break;case K_:n.depthFunc(n.LESS);break;case gm:n.depthFunc(n.LEQUAL);break;case Y_:n.depthFunc(n.EQUAL);break;case X_:n.depthFunc(n.GEQUAL);break;case Q_:n.depthFunc(n.GREATER);break;case J_:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}this.currentDepthFunc=e}}scissor(e,n,i,s){const r=this._tempVec4.set(e,n,i,s);if(this.currentScissor.equals(r)===!1){const{gl:o}=this;o.scissor(r.x,r.y,r.z,r.w),this.currentScissor.copy(r)}}viewport(e,n,i,s){const r=this._tempVec4.set(e,n,i,s);if(this.currentViewport.equals(r)===!1){const{gl:o}=this;o.viewport(r.x,r.y,r.z,r.w),this.currentViewport.copy(r)}}setScissorTest(e){const n=this.gl;e?this.enable(n.SCISSOR_TEST):this.disable(n.SCISSOR_TEST)}setStencilTest(e){const{gl:n}=this;e?this.enable(n.STENCIL_TEST):this.disable(n.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,n,i){(this.currentStencilFunc!==e||this.currentStencilRef!==n||this.currentStencilFuncMask!==i)&&(this.gl.stencilFunc(e,n,i),this.currentStencilFunc=e,this.currentStencilRef=n,this.currentStencilFuncMask=i)}setStencilOp(e,n,i){(this.currentStencilFail!==e||this.currentStencilZFail!==n||this.currentStencilZPass!==i)&&(this.gl.stencilOp(e,n,i),this.currentStencilFail=e,this.currentStencilZFail=n,this.currentStencilZPass=i)}setMaterial(e,n,i){const{gl:s}=this;e.side===er?this.disable(s.CULL_FACE):this.enable(s.CULL_FACE);let r=e.side===Di;n&&(r=!r),this.setFlipSided(r),e.blending===fl&&e.transparent===!1?this.setBlending(hl):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const o=e.stencilWrite;if(this.setStencilTest(o),o&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.currentSamples>0?this.enable(s.SAMPLE_ALPHA_TO_COVERAGE):this.disable(s.SAMPLE_ALPHA_TO_COVERAGE),i>0&&this.currentClippingPlanes!==i)for(let c=0;c<8;c++)c<i?this.enable(12288+c):this.disable(12288+c)}setPolygonOffset(e,n,i){const{gl:s}=this;e?(this.enable(s.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==n||this.currentPolygonOffsetUnits!==i)&&(s.polygonOffset(n,i),this.currentPolygonOffsetFactor=n,this.currentPolygonOffsetUnits=i)):this.disable(s.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,n=null){const i=this.gl;return this.currentVAO!==e||this.currentIndex!==n?(i.bindVertexArray(e),n!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,n),this.currentVAO=e,this.currentIndex=n,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,n){const{gl:i,currentBoundFramebuffers:s}=this;return s[e]!==n?(i.bindFramebuffer(e,n),s[e]=n,e===i.DRAW_FRAMEBUFFER&&(s[i.FRAMEBUFFER]=n),e===i.FRAMEBUFFER&&(s[i.DRAW_FRAMEBUFFER]=n),!0):!1}drawBuffers(e,n){const{gl:i}=this;let s=[],r=!1;if(e.textures!==null){s=this.currentDrawbuffers.get(n),s===void 0&&(s=[],this.currentDrawbuffers.set(n,s));const o=e.textures;if(s.length!==o.length||s[0]!==i.COLOR_ATTACHMENT0){for(let l=0,c=o.length;l<c;l++)s[l]=i.COLOR_ATTACHMENT0+l;s.length=o.length,r=!0}}else s[0]!==i.BACK&&(s[0]=i.BACK,r=!0);r&&i.drawBuffers(s)}activeTexture(e){const{gl:n,currentTextureSlot:i,maxTextures:s}=this;e===void 0&&(e=n.TEXTURE0+s-1),i!==e&&(n.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,n,i){const{gl:s,currentTextureSlot:r,currentBoundTextures:o,maxTextures:l}=this;i===void 0&&(r===null?i=s.TEXTURE0+l-1:i=r);let c=o[i];c===void 0&&(c={type:void 0,texture:void 0},o[i]=c),(c.type!==e||c.texture!==n)&&(r!==i&&(s.activeTexture(i),this.currentTextureSlot=i),s.bindTexture(e,n),c.type=e,c.texture=n)}bindBufferBase(e,n,i){const{gl:s}=this,r=`${e}-${n}`;return this.currentBoundBufferBases[r]!==i?(s.bindBufferBase(e,n,i),this.currentBoundBufferBases[r]=i,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:n,currentBoundTextures:i}=this,s=i[n];s!==void 0&&s.type!==void 0&&(e.bindTexture(s.type,null),s.type=void 0,s.texture=void 0)}}class Wqe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,n=Il){const{gl:i,extensions:s}=this;let r;const o=Vn.getTransfer(n);if(e===os)return i.UNSIGNED_BYTE;if(e===HT)return i.UNSIGNED_SHORT_4_4_4_4;if(e===WT)return i.UNSIGNED_SHORT_5_5_5_1;if(e===$T)return i.UNSIGNED_INT_5_9_9_9_REV;if(e===KT)return i.UNSIGNED_INT_10F_11F_11F_REV;if(e===e0)return i.BYTE;if(e===t0)return i.SHORT;if(e===Bu)return i.UNSIGNED_SHORT;if(e===jr)return i.INT;if(e===Ei)return i.UNSIGNED_INT;if(e===ls)return i.FLOAT;if(e===cs)return i.HALF_FLOAT;if(e===UP)return i.ALPHA;if(e===Fx)return i.RGB;if(e===fs)return i.RGBA;if(e===ho)return i.DEPTH_COMPONENT;if(e===rl)return i.DEPTH_STENCIL;if(e===r1)return i.RED;if(e===E0)return i.RED_INTEGER;if(e===ol)return i.RG;if(e===o1)return i.RG_INTEGER;if(e===l1)return i.RGBA_INTEGER;if(e===Qp||e===Jp||e===Zp||e===em)if(o===An)if(r=s.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(e===Qp)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===Jp)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===Zp)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===em)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=s.get("WEBGL_compressed_texture_s3tc"),r!==null){if(e===Qp)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Jp)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Zp)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===em)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===Z_||e===ex||e===tx||e===nx)if(r=s.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(e===Z_)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===ex)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===tx)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===nx)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===Ty||e===wy||e===Ey||e===My||e===Cy||e===f0||e===Ny)if(r=s.get("WEBGL_compressed_texture_etc"),r!==null){if(e===Ty||e===wy)return o===An?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(e===Ey)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC;if(e===My)return r.COMPRESSED_R11_EAC;if(e===Cy)return r.COMPRESSED_SIGNED_R11_EAC;if(e===f0)return r.COMPRESSED_RG11_EAC;if(e===Ny)return r.COMPRESSED_SIGNED_RG11_EAC}else return null;if(e===Ry||e===Py||e===Iy||e===Ly||e===Dy||e===ky||e===Oy||e===Fy||e===jy||e===By||e===Uy||e===Vy||e===zy||e===Gy)if(r=s.get("WEBGL_compressed_texture_astc"),r!==null){if(e===Ry)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===Py)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===Iy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===Ly)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===Dy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===ky)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===Oy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===Fy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===jy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===By)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===Uy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===Vy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===zy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===Gy)return o===An?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===qy)if(r=s.get("EXT_texture_compression_bptc"),r!==null){if(e===qy)return o===An?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===Hy||e===Wy||e===p0||e===$y)if(r=s.get("EXT_texture_compression_rgtc"),r!==null){if(e===Hy)return r.COMPRESSED_RED_RGTC1_EXT;if(e===Wy)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===p0)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===$y)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===yc?i.UNSIGNED_INT_24_8:i[e]!==void 0?i[e]:null}_clientWaitAsync(){const{gl:e}=this,n=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((i,s)=>{function r(){const o=e.clientWaitSync(n,e.SYNC_FLUSH_COMMANDS_BIT,0);if(o===e.WAIT_FAILED){e.deleteSync(n),s();return}if(o===e.TIMEOUT_EXPIRED){requestAnimationFrame(r);return}e.deleteSync(n),i()}r()})}}let YK=!1,oC,X5,XK;class $qe{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},this._srcFramebuffer=null,this._dstFramebuffer=null,YK===!1&&(this._init(),YK=!0)}_init(){const e=this.gl;oC={[ym]:e.REPEAT,[Ur]:e.CLAMP_TO_EDGE,[vm]:e.MIRRORED_REPEAT},X5={[Mi]:e.NEAREST,[qT]:e.NEAREST_MIPMAP_NEAREST,[Od]:e.NEAREST_MIPMAP_LINEAR,[di]:e.LINEAR,[Zg]:e.LINEAR_MIPMAP_NEAREST,[No]:e.LINEAR_MIPMAP_LINEAR},XK={[zP]:e.NEVER,[WP]:e.ALWAYS,[jx]:e.LESS,[Bx]:e.LEQUAL,[GP]:e.EQUAL,[Ux]:e.GEQUAL,[qP]:e.GREATER,[HP]:e.NOTEQUAL}}getGLTextureType(e){const{gl:n}=this;let i;return e.isCubeTexture===!0?i=n.TEXTURE_CUBE_MAP:e.isArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0?i=n.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?i=n.TEXTURE_3D:i=n.TEXTURE_2D,i}getInternalFormat(e,n,i,s,r=!1){const{gl:o,extensions:l}=this;if(e!==null){if(o[e]!==void 0)return o[e];yt("WebGLBackend: Attempt to use non-existing WebGL internal format '"+e+"'")}let c=n;if(n===o.RED&&(i===o.FLOAT&&(c=o.R32F),i===o.HALF_FLOAT&&(c=o.R16F),i===o.UNSIGNED_BYTE&&(c=o.R8),i===o.UNSIGNED_SHORT&&(c=o.R16),i===o.UNSIGNED_INT&&(c=o.R32UI),i===o.BYTE&&(c=o.R8I),i===o.SHORT&&(c=o.R16I),i===o.INT&&(c=o.R32I)),n===o.RED_INTEGER&&(i===o.UNSIGNED_BYTE&&(c=o.R8UI),i===o.UNSIGNED_SHORT&&(c=o.R16UI),i===o.UNSIGNED_INT&&(c=o.R32UI),i===o.BYTE&&(c=o.R8I),i===o.SHORT&&(c=o.R16I),i===o.INT&&(c=o.R32I)),n===o.RG&&(i===o.FLOAT&&(c=o.RG32F),i===o.HALF_FLOAT&&(c=o.RG16F),i===o.UNSIGNED_BYTE&&(c=o.RG8),i===o.UNSIGNED_SHORT&&(c=o.RG16),i===o.UNSIGNED_INT&&(c=o.RG32UI),i===o.BYTE&&(c=o.RG8I),i===o.SHORT&&(c=o.RG16I),i===o.INT&&(c=o.RG32I)),n===o.RG_INTEGER&&(i===o.UNSIGNED_BYTE&&(c=o.RG8UI),i===o.UNSIGNED_SHORT&&(c=o.RG16UI),i===o.UNSIGNED_INT&&(c=o.RG32UI),i===o.BYTE&&(c=o.RG8I),i===o.SHORT&&(c=o.RG16I),i===o.INT&&(c=o.RG32I)),n===o.RGB){const u=r?Ky:Vn.getTransfer(s);i===o.FLOAT&&(c=o.RGB32F),i===o.HALF_FLOAT&&(c=o.RGB16F),i===o.UNSIGNED_BYTE&&(c=o.RGB8),i===o.UNSIGNED_SHORT&&(c=o.RGB16),i===o.UNSIGNED_INT&&(c=o.RGB32UI),i===o.BYTE&&(c=o.RGB8I),i===o.SHORT&&(c=o.RGB16I),i===o.INT&&(c=o.RGB32I),i===o.UNSIGNED_BYTE&&(c=u===An?o.SRGB8:o.RGB8),i===o.UNSIGNED_SHORT_5_6_5&&(c=o.RGB565),i===o.UNSIGNED_SHORT_5_5_5_1&&(c=o.RGB5_A1),i===o.UNSIGNED_SHORT_4_4_4_4&&(c=o.RGB4),i===o.UNSIGNED_INT_5_9_9_9_REV&&(c=o.RGB9_E5),i===o.UNSIGNED_INT_10F_11F_11F_REV&&(c=o.R11F_G11F_B10F)}if(n===o.RGB_INTEGER&&(i===o.UNSIGNED_BYTE&&(c=o.RGB8UI),i===o.UNSIGNED_SHORT&&(c=o.RGB16UI),i===o.UNSIGNED_INT&&(c=o.RGB32UI),i===o.BYTE&&(c=o.RGB8I),i===o.SHORT&&(c=o.RGB16I),i===o.INT&&(c=o.RGB32I)),n===o.RGBA){const u=r?Ky:Vn.getTransfer(s);i===o.FLOAT&&(c=o.RGBA32F),i===o.HALF_FLOAT&&(c=o.RGBA16F),i===o.UNSIGNED_BYTE&&(c=o.RGBA8),i===o.UNSIGNED_SHORT&&(c=o.RGBA16),i===o.UNSIGNED_INT&&(c=o.RGBA32UI),i===o.BYTE&&(c=o.RGBA8I),i===o.SHORT&&(c=o.RGBA16I),i===o.INT&&(c=o.RGBA32I),i===o.UNSIGNED_BYTE&&(c=u===An?o.SRGB8_ALPHA8:o.RGBA8),i===o.UNSIGNED_SHORT_4_4_4_4&&(c=o.RGBA4),i===o.UNSIGNED_SHORT_5_5_5_1&&(c=o.RGB5_A1)}return n===o.RGBA_INTEGER&&(i===o.UNSIGNED_BYTE&&(c=o.RGBA8UI),i===o.UNSIGNED_SHORT&&(c=o.RGBA16UI),i===o.UNSIGNED_INT&&(c=o.RGBA32UI),i===o.BYTE&&(c=o.RGBA8I),i===o.SHORT&&(c=o.RGBA16I),i===o.INT&&(c=o.RGBA32I)),n===o.DEPTH_COMPONENT&&(i===o.UNSIGNED_SHORT&&(c=o.DEPTH_COMPONENT16),i===o.UNSIGNED_INT&&(c=o.DEPTH_COMPONENT24),i===o.FLOAT&&(c=o.DEPTH_COMPONENT32F)),n===o.DEPTH_STENCIL&&i===o.UNSIGNED_INT_24_8&&(c=o.DEPTH24_STENCIL8),(c===o.R16F||c===o.R32F||c===o.RG16F||c===o.RG32F||c===o.RGBA16F||c===o.RGBA32F)&&l.get("EXT_color_buffer_float"),c}setTextureParameters(e,n){const{gl:i,extensions:s,backend:r}=this,o=Vn.getPrimaries(Vn.workingColorSpace),l=n.colorSpace===Il?null:Vn.getPrimaries(n.colorSpace),c=n.colorSpace===Il||o===l?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,n.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,c),i.texParameteri(e,i.TEXTURE_WRAP_S,oC[n.wrapS]),i.texParameteri(e,i.TEXTURE_WRAP_T,oC[n.wrapT]),(e===i.TEXTURE_3D||e===i.TEXTURE_2D_ARRAY)&&(n.isArrayTexture||i.texParameteri(e,i.TEXTURE_WRAP_R,oC[n.wrapR])),i.texParameteri(e,i.TEXTURE_MAG_FILTER,X5[n.magFilter]);const u=n.mipmaps!==void 0&&n.mipmaps.length>0,h=n.minFilter===di&&u?No:n.minFilter;if(i.texParameteri(e,i.TEXTURE_MIN_FILTER,X5[h]),n.compareFunction&&(i.texParameteri(e,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(e,i.TEXTURE_COMPARE_FUNC,XK[n.compareFunction])),s.has("EXT_texture_filter_anisotropic")===!0){if(n.magFilter===Mi||n.minFilter!==Od&&n.minFilter!==No||n.type===ls&&s.has("OES_texture_float_linear")===!1)return;if(n.anisotropy>1){const f=s.get("EXT_texture_filter_anisotropic");i.texParameterf(e,f.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(n.anisotropy,r.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:n,backend:i,defaultTextures:s}=this,r=this.getGLTextureType(e);let o=s[r];o===void 0&&(o=n.createTexture(),i.state.bindTexture(r,o),n.texParameteri(r,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(r,n.TEXTURE_MAG_FILTER,n.NEAREST),s[r]=o),i.set(e,{textureGPU:o,glTextureType:r})}createTexture(e,n){const{gl:i,backend:s}=this,{levels:r,width:o,height:l,depth:c}=n,u=s.utils.convert(e.format,e.colorSpace),h=s.utils.convert(e.type),f=this.getInternalFormat(e.internalFormat,u,h,e.colorSpace,e.isVideoTexture),m=i.createTexture(),A=this.getGLTextureType(e);s.state.bindTexture(A,m),this.setTextureParameters(A,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?i.texStorage3D(i.TEXTURE_2D_ARRAY,r,f,o,l,c):e.isData3DTexture?i.texStorage3D(i.TEXTURE_3D,r,f,o,l,c):e.isVideoTexture||i.texStorage2D(A,r,f,o,l),s.set(e,{textureGPU:m,glTextureType:A,glFormat:u,glType:h,glInternalFormat:f})}copyBufferToTexture(e,n){const{gl:i,backend:s}=this,{textureGPU:r,glTextureType:o,glFormat:l,glType:c}=s.get(n),{width:u,height:h}=n.source.data;i.bindBuffer(i.PIXEL_UNPACK_BUFFER,e),s.state.bindTexture(o,r),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.texSubImage2D(o,0,0,0,u,h,l,c,0),i.bindBuffer(i.PIXEL_UNPACK_BUFFER,null),s.state.unbindTexture()}updateTexture(e,n){const{gl:i}=this,{width:s,height:r}=n,{textureGPU:o,glTextureType:l,glFormat:c,glType:u,glInternalFormat:h}=this.backend.get(e);if(!(e.isRenderTargetTexture||o===void 0))if(this.backend.state.bindTexture(l,o),this.setTextureParameters(l,e),e.isCompressedTexture){const f=e.mipmaps,m=n.image;for(let A=0;A<f.length;A++){const x=f[A];e.isCompressedArrayTexture?e.format!==i.RGBA?c!==null?i.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,A,0,0,0,x.width,x.height,m.depth,c,x.data):yt("WebGLBackend: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texSubImage3D(i.TEXTURE_2D_ARRAY,A,0,0,0,x.width,x.height,m.depth,c,u,x.data):c!==null?i.compressedTexSubImage2D(i.TEXTURE_2D,A,0,0,x.width,x.height,c,x.data):yt("WebGLBackend: Unsupported compressed texture format")}}else if(e.isCubeTexture){const f=n.images,m=e.mipmaps;for(let A=0;A<6;A++){const x=lC(f[A]);i.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+A,0,0,0,s,r,c,u,x);for(let T=0;T<m.length;T++){const E=m[T],M=lC(E.images[A]);i.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+A,T+1,0,0,M.width,M.height,c,u,M)}}}else if(e.isDataArrayTexture||e.isArrayTexture){const f=n.image;if(e.layerUpdates.size>0){const m=LN(f.width,f.height,e.format,e.type);for(const A of e.layerUpdates){const x=f.data.subarray(A*m/f.data.BYTES_PER_ELEMENT,(A+1)*m/f.data.BYTES_PER_ELEMENT);i.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,A,f.width,f.height,1,c,u,x)}e.clearLayerUpdates()}else i.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,c,u,f.data)}else if(e.isData3DTexture){const f=n.image;i.texSubImage3D(i.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,c,u,f.data)}else if(e.isVideoTexture)e.update(),i.texImage2D(l,0,h,c,u,n.image);else{const f=e.mipmaps;if(f.length>0)for(let m=0,A=f.length;m<A;m++){const x=f[m],T=lC(x);i.texSubImage2D(l,m,0,0,x.width,x.height,c,u,T)}else{const m=lC(n.image);i.texSubImage2D(l,0,0,0,s,r,c,u,m)}}}generateMipmaps(e){const{gl:n,backend:i}=this,{textureGPU:s,glTextureType:r}=i.get(e);i.state.bindTexture(r,s),n.generateMipmap(r)}deallocateRenderBuffers(e){const{gl:n,backend:i}=this;if(e){const s=i.get(e);if(s.renderBufferStorageSetup=void 0,s.framebuffers){for(const r in s.framebuffers)n.deleteFramebuffer(s.framebuffers[r]);delete s.framebuffers}if(s.depthRenderbuffer&&(n.deleteRenderbuffer(s.depthRenderbuffer),delete s.depthRenderbuffer),s.stencilRenderbuffer&&(n.deleteRenderbuffer(s.stencilRenderbuffer),delete s.stencilRenderbuffer),s.msaaFrameBuffer&&(n.deleteFramebuffer(s.msaaFrameBuffer),delete s.msaaFrameBuffer),s.msaaRenderbuffers){for(let r=0;r<s.msaaRenderbuffers.length;r++)n.deleteRenderbuffer(s.msaaRenderbuffers[r]);delete s.msaaRenderbuffers}}}destroyTexture(e,n=!1){const{gl:i,backend:s}=this,{textureGPU:r,renderTarget:o}=s.get(e);this.deallocateRenderBuffers(o),n===!1&&i.deleteTexture(r),s.delete(e)}copyTextureToTexture(e,n,i=null,s=null,r=0,o=0){const{gl:l,backend:c}=this,{state:u}=this.backend,{textureGPU:h,glTextureType:f,glType:m,glFormat:A}=c.get(n);u.bindTexture(f,h);let x,T,E,M,N,I,F,G,O;const D=e.isCompressedTexture?e.mipmaps[o]:e.image;if(i!==null)x=i.max.x-i.min.x,T=i.max.y-i.min.y,E=i.isBox3?i.max.z-i.min.z:1,M=i.min.x,N=i.min.y,I=i.isBox3?i.min.z:0;else{const ne=Math.pow(2,-r);x=Math.floor(D.width*ne),T=Math.floor(D.height*ne),e.isDataArrayTexture||e.isArrayTexture?E=D.depth:e.isData3DTexture?E=Math.floor(D.depth*ne):E=1,M=0,N=0,I=0}s!==null?(F=s.x,G=s.y,O=s.z):(F=0,G=0,O=0),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,n.unpackAlignment);const j=l.getParameter(l.UNPACK_ROW_LENGTH),L=l.getParameter(l.UNPACK_IMAGE_HEIGHT),U=l.getParameter(l.UNPACK_SKIP_PIXELS),q=l.getParameter(l.UNPACK_SKIP_ROWS),K=l.getParameter(l.UNPACK_SKIP_IMAGES);l.pixelStorei(l.UNPACK_ROW_LENGTH,D.width),l.pixelStorei(l.UNPACK_IMAGE_HEIGHT,D.height),l.pixelStorei(l.UNPACK_SKIP_PIXELS,M),l.pixelStorei(l.UNPACK_SKIP_ROWS,N),l.pixelStorei(l.UNPACK_SKIP_IMAGES,I);const H=e.isDataArrayTexture||e.isData3DTexture||n.isArrayTexture,X=n.isDataArrayTexture||n.isData3DTexture||n.isArrayTexture;if(e.isDepthTexture){const ne=c.get(e),Q=c.get(n),Y=c.get(ne.renderTarget),ue=c.get(Q.renderTarget),pe=Y.framebuffers[ne.cacheKey],Ee=ue.framebuffers[Q.cacheKey];u.bindFramebuffer(l.READ_FRAMEBUFFER,pe),u.bindFramebuffer(l.DRAW_FRAMEBUFFER,Ee);for(let oe=0;oe<E;oe++)H&&(l.framebufferTextureLayer(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,ne.textureGPU,r,I+oe),l.framebufferTextureLayer(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0,h,o,O+oe)),l.blitFramebuffer(M,N,x,T,F,G,x,T,l.DEPTH_BUFFER_BIT,l.NEAREST);u.bindFramebuffer(l.READ_FRAMEBUFFER,null),u.bindFramebuffer(l.DRAW_FRAMEBUFFER,null)}else if(r!==0||e.isRenderTargetTexture||c.has(e)){const ne=c.get(e);this._srcFramebuffer===null&&(this._srcFramebuffer=l.createFramebuffer()),this._dstFramebuffer===null&&(this._dstFramebuffer=l.createFramebuffer()),u.bindFramebuffer(l.READ_FRAMEBUFFER,this._srcFramebuffer),u.bindFramebuffer(l.DRAW_FRAMEBUFFER,this._dstFramebuffer);for(let Q=0;Q<E;Q++)H?l.framebufferTextureLayer(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,ne.textureGPU,r,I+Q):l.framebufferTexture2D(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,ne.textureGPU,r),X?l.framebufferTextureLayer(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0,h,o,O+Q):l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,h,o),r!==0?l.blitFramebuffer(M,N,x,T,F,G,x,T,l.COLOR_BUFFER_BIT,l.NEAREST):X?l.copyTexSubImage3D(f,o,F,G,O+Q,M,N,x,T):l.copyTexSubImage2D(f,o,F,G,M,N,x,T);u.bindFramebuffer(l.READ_FRAMEBUFFER,null),u.bindFramebuffer(l.DRAW_FRAMEBUFFER,null)}else X?e.isDataTexture||e.isData3DTexture?l.texSubImage3D(f,o,F,G,O,x,T,E,A,m,D.data):n.isCompressedArrayTexture?l.compressedTexSubImage3D(f,o,F,G,O,x,T,E,A,D.data):l.texSubImage3D(f,o,F,G,O,x,T,E,A,m,D):e.isDataTexture?l.texSubImage2D(l.TEXTURE_2D,o,F,G,x,T,A,m,D.data):e.isCompressedTexture?l.compressedTexSubImage2D(l.TEXTURE_2D,o,F,G,D.width,D.height,A,D.data):l.texSubImage2D(l.TEXTURE_2D,o,F,G,x,T,A,m,D);l.pixelStorei(l.UNPACK_ROW_LENGTH,j),l.pixelStorei(l.UNPACK_IMAGE_HEIGHT,L),l.pixelStorei(l.UNPACK_SKIP_PIXELS,U),l.pixelStorei(l.UNPACK_SKIP_ROWS,q),l.pixelStorei(l.UNPACK_SKIP_IMAGES,K),o===0&&n.generateMipmaps&&l.generateMipmap(f),u.unbindTexture()}copyFramebufferToTexture(e,n,i){const{gl:s}=this,{state:r}=this.backend,{textureGPU:o}=this.backend.get(e),{x:l,y:c,z:u,w:h}=i,f=e.isDepthTexture===!0||n.renderTarget&&n.renderTarget.samples>0,m=n.renderTarget?n.renderTarget.height:this.backend.getDrawingBufferSize().y;if(f){const A=l!==0||c!==0;let x,T;if(e.isDepthTexture===!0?(x=s.DEPTH_BUFFER_BIT,T=s.DEPTH_ATTACHMENT,n.stencil&&(x|=s.STENCIL_BUFFER_BIT)):(x=s.COLOR_BUFFER_BIT,T=s.COLOR_ATTACHMENT0),A){const E=this.backend.get(n.renderTarget),M=E.framebuffers[n.getCacheKey()],N=E.msaaFrameBuffer;r.bindFramebuffer(s.DRAW_FRAMEBUFFER,M),r.bindFramebuffer(s.READ_FRAMEBUFFER,N);const I=m-c-h;s.blitFramebuffer(l,I,l+u,I+h,l,I,l+u,I+h,x,s.NEAREST),r.bindFramebuffer(s.READ_FRAMEBUFFER,M),r.bindTexture(s.TEXTURE_2D,o),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,l,I,u,h),r.unbindTexture()}else{const E=s.createFramebuffer();r.bindFramebuffer(s.DRAW_FRAMEBUFFER,E),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,T,s.TEXTURE_2D,o,0),s.blitFramebuffer(0,0,u,h,0,0,u,h,x,s.NEAREST),s.deleteFramebuffer(E)}}else r.bindTexture(s.TEXTURE_2D,o),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,l,m-h-c,u,h),r.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(n)}setupRenderBufferStorage(e,n,i,s=!1){const{gl:r}=this,o=n.renderTarget,{depthTexture:l,depthBuffer:c,stencilBuffer:u,width:h,height:f}=o;if(r.bindRenderbuffer(r.RENDERBUFFER,e),c&&!u){let m=r.DEPTH_COMPONENT24;s===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(r.RENDERBUFFER,o.samples,m,h,f):i>0?(l&&l.isDepthTexture&&l.type===r.FLOAT&&(m=r.DEPTH_COMPONENT32F),r.renderbufferStorageMultisample(r.RENDERBUFFER,i,m,h,f)):r.renderbufferStorage(r.RENDERBUFFER,m,h,f),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e)}else c&&u&&(i>0?r.renderbufferStorageMultisample(r.RENDERBUFFER,i,r.DEPTH24_STENCIL8,h,f):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,h,f),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e));r.bindRenderbuffer(r.RENDERBUFFER,null)}async copyTextureToBuffer(e,n,i,s,r,o){const{backend:l,gl:c}=this,{textureGPU:u,glFormat:h,glType:f}=this.backend.get(e),m=c.createFramebuffer();l.state.bindFramebuffer(c.READ_FRAMEBUFFER,m);const A=e.isCubeTexture?c.TEXTURE_CUBE_MAP_POSITIVE_X+o:c.TEXTURE_2D;c.framebufferTexture2D(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,A,u,0);const x=this._getTypedArrayType(f),T=this._getBytesPerTexel(f,h),M=s*r*T,N=c.createBuffer();c.bindBuffer(c.PIXEL_PACK_BUFFER,N),c.bufferData(c.PIXEL_PACK_BUFFER,M,c.STREAM_READ),c.readPixels(n,i,s,r,h,f,0),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),await l.utils._clientWaitAsync();const I=new x(M/x.BYTES_PER_ELEMENT);return c.bindBuffer(c.PIXEL_PACK_BUFFER,N),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,I),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l.state.bindFramebuffer(c.READ_FRAMEBUFFER,null),c.deleteFramebuffer(m),I}_getTypedArrayType(e){const{gl:n}=this;if(e===n.UNSIGNED_BYTE)return Uint8Array;if(e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5||e===n.UNSIGNED_SHORT)return Uint16Array;if(e===n.UNSIGNED_INT)return Uint32Array;if(e===n.HALF_FLOAT)return Uint16Array;if(e===n.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,n){const{gl:i}=this;let s=0;if(e===i.UNSIGNED_BYTE&&(s=1),(e===i.UNSIGNED_SHORT_4_4_4_4||e===i.UNSIGNED_SHORT_5_5_5_1||e===i.UNSIGNED_SHORT_5_6_5||e===i.UNSIGNED_SHORT||e===i.HALF_FLOAT)&&(s=2),(e===i.UNSIGNED_INT||e===i.FLOAT)&&(s=4),n===i.RGBA)return s*4;if(n===i.RGB)return s*3;if(n===i.ALPHA)return s}dispose(){const{gl:e}=this;this._srcFramebuffer!==null&&e.deleteFramebuffer(this._srcFramebuffer),this._dstFramebuffer!==null&&e.deleteFramebuffer(this._dstFramebuffer)}}function lC(a){return a.isDataTexture?a.image.data:typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&a instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&a instanceof OffscreenCanvas?a:a.data}class Kqe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let n=this.extensions[e];return n===void 0&&(n=this.gl.getExtension(e),this.extensions[e]=n),n}has(e){return this.availableExtensions.includes(e)}}class Yqe{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,n=this.backend.extensions;if(n.has("EXT_texture_filter_anisotropic")===!0){const i=n.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const QK={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-s3tc",EXT_texture_compression_bptc:"texture-compression-bc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class Xqe{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,n){const{gl:i,mode:s,object:r,type:o,info:l,index:c}=this;c!==0?i.drawElements(s,n,o,e):i.drawArrays(s,e,n),l.update(r,n,1)}renderInstances(e,n,i){const{gl:s,mode:r,type:o,index:l,object:c,info:u}=this;i!==0&&(l!==0?s.drawElementsInstanced(r,n,o,e,i):s.drawArraysInstanced(r,e,n,i),u.update(c,n,i))}renderMultiDraw(e,n,i){const{extensions:s,mode:r,object:o,info:l}=this;if(i===0)return;const c=s.get("WEBGL_multi_draw");if(c===null)for(let u=0;u<i;u++)this.render(e[u],n[u]);else{this.index!==0?c.multiDrawElementsWEBGL(r,n,0,this.type,e,0,i):c.multiDrawArraysWEBGL(r,e,0,n,0,i);let u=0;for(let h=0;h<i;h++)u+=n[h];l.update(o,u,1)}}renderMultiDrawInstances(e,n,i,s){const{extensions:r,mode:o,object:l,info:c}=this;if(i===0)return;const u=r.get("WEBGL_multi_draw");if(u===null)for(let h=0;h<i;h++)this.renderInstances(e[h],n[h],s[h]);else{this.index!==0?u.multiDrawElementsInstancedWEBGL(o,n,0,this.type,e,0,s,0,i):u.multiDrawArraysInstancedWEBGL(o,e,0,n,0,s,0,i);let h=0;for(let f=0;f<i;f++)h+=n[f]*s[f];c.update(l,h,1)}}}class doe{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.frames=[],this.pendingResolve=!1,this.timestamps=new Map}getTimestampFrames(){return this.frames}getTimestamp(e){let n=this.timestamps.get(e);return n===void 0&&(yt(`TimestampQueryPool: No timestamp available for uid ${e}.`),n=0),n}hasTimestamp(e){return this.timestamps.has(e)}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class Qqe extends doe{constructor(e,n,i=2048){if(super(i),this.gl=e,this.type=n,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){yt("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let s=0;s<this.maxQueries;s++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return ji(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const n=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(n,"inactive"),this.queryOffsets.set(e,n),n}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const n=this.queryOffsets.get(e);if(n==null||this.activeQuery!==null)return;const i=this.queries[n];if(i)try{this.queryStates.get(n)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,i),this.activeQuery=n,this.queryStates.set(n,"started"))}catch(s){Rt("Error in beginQuery:",s),this.activeQuery=null,this.queryStates.set(n,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const n=this.queryOffsets.get(e);if(n!=null&&this.activeQuery===n)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(n,"ended"),this.activeQuery=null}catch(i){Rt("Error in endQuery:",i),this.queryStates.set(n,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=new Map;for(const[r,o]of this.queryOffsets)if(this.queryStates.get(o)==="ended"){const c=this.queries[o];e.set(r,this.resolveQuery(c))}if(e.size===0)return this.lastValue;const n={},i=[];for(const[r,o]of e){const l=r.match(/^(.*):f(\d+)$/),c=parseInt(l[2]);i.includes(c)===!1&&i.push(c),n[c]===void 0&&(n[c]=0);const u=await o;this.timestamps.set(r,u),n[c]+=u}const s=n[i[i.length-1]];return this.lastValue=s,this.frames=i,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,s}catch(e){return Rt("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(n=>{if(this.isDisposed){n(this.lastValue);return}let i,s=!1;const r=()=>{i&&(clearTimeout(i),i=null)},o=c=>{s||(s=!0,r(),n(c))},l=()=>{if(this.isDisposed){o(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){o(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){i=setTimeout(l,1);return}const h=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);n(Number(h)/1e6)}catch(c){Rt("Error checking query:",c),n(this.lastValue)}};l()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}class JK extends uoe{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const n=this.parameters,i={antialias:e.currentSamples>0,alpha:!0,depth:e.depth,stencil:e.stencil},s=n.context!==void 0?n.context:e.domElement.getContext("webgl2",i);function r(o){o.preventDefault();const l={api:"WebGL",message:o.statusMessage||"Unknown reason",reason:null,originalEvent:o};e.onDeviceLost(l)}this._onContextLost=r,e.domElement.addEventListener("webglcontextlost",r,!1),this.gl=s,this.extensions=new Kqe(this),this.capabilities=new Yqe(this),this.attributeUtils=new qqe(this),this.textureUtils=new $qe(this),this.bufferRenderer=new Xqe(this),this.state=new Hqe(this),this.utils=new Wqe(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile"),this.drawBuffersIndexedExt=this.extensions.get("OES_draw_buffers_indexed")}get coordinateSystem(){return Ro}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,n,i=null){const s=this.gl;if(this.set(e.texture,{textureGPU:n,glInternalFormat:s.RGBA8}),i!==null){const r=e.stencilBuffer?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:i,glInternalFormat:r}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer===!0&&e.multiview===!1&&yt("WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e._autoAllocateDepthBuffer=!1}}initTimestampQuery(e,n){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new Qqe(this.gl,e,2048));const i=this.timestampQueryPool[e];i.allocateQueriesForContext(n)!==null&&i.beginQuery(n)}prepareTimestampBuffer(e,n){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e].endQuery(n)}getContext(){return this.gl}beginRender(e){const{state:n}=this,i=this.get(e);if(e.viewport)this.updateViewport(e);else{const{width:r,height:o}=this.getDrawingBufferSize();n.viewport(0,0,r,o)}if(e.scissor){const{x:r,y:o,width:l,height:c}=e.scissorValue;n.scissor(r,e.height-c-o,l,c)}this.initTimestampQuery(Fd.RENDER,this.getTimestampUID(e)),i.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const s=e.occlusionQueryCount;s>0&&(i.currentOcclusionQueries=i.occlusionQueries,i.currentOcclusionQueryObjects=i.occlusionQueryObjects,i.lastOcclusionObject=null,i.occlusionQueries=new Array(s),i.occlusionQueryObjects=new Array(s),i.occlusionQueryIndex=0)}finishRender(e){const{gl:n,state:i}=this,s=this.get(e),r=s.previousContext;i.resetVertexState();const o=e.occlusionQueryCount;o>0&&(o>s.occlusionQueryIndex&&n.endQuery(n.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const l=e.textures;if(l!==null)for(let c=0;c<l.length;c++){const u=l[c];u.generateMipmaps&&this.generateMipmaps(u)}if(this._currentContext=r,this._resolveRenderTarget(e),r!==null)if(this._setFramebuffer(r),r.viewport)this.updateViewport(r);else{const{width:c,height:u}=this.getDrawingBufferSize();i.viewport(0,0,c,u)}this.prepareTimestampBuffer(Fd.RENDER,this.getTimestampUID(e))}resolveOccludedAsync(e){const n=this.get(e),{currentOcclusionQueries:i,currentOcclusionQueryObjects:s}=n;if(i&&s){const r=new WeakSet,{gl:o}=this;n.currentOcclusionQueryObjects=null,n.currentOcclusionQueries=null;const l=()=>{let c=0;for(let u=0;u<i.length;u++){const h=i[u];h!==null&&o.getQueryParameter(h,o.QUERY_RESULT_AVAILABLE)&&(o.getQueryParameter(h,o.QUERY_RESULT)===0&&r.add(s[u]),i[u]=null,o.deleteQuery(h),c++)}c<i.length?requestAnimationFrame(l):n.occluded=r};l()}}isOccluded(e,n){const i=this.get(e);return i.occluded&&i.occluded.has(n)}updateViewport(e){const{state:n}=this,{x:i,y:s,width:r,height:o}=e.viewportValue;n.viewport(i,e.height-o-s,r,o)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,n,i,s=null,r=!0,o=!0){const{gl:l,renderer:c}=this;s===null&&(s={textures:null,clearColorValue:this.getClearColor()});let u=0;if(e&&(u|=l.COLOR_BUFFER_BIT),n&&(u|=l.DEPTH_BUFFER_BIT),i&&(u|=l.STENCIL_BUFFER_BIT),u!==0){let h;s.clearColorValue?h=s.clearColorValue:h=this.getClearColor();const f=c.getClearDepth(),m=c.getClearStencil();if(n&&this.state.setDepthMask(!0),s.textures===null)l.clearColor(h.r,h.g,h.b,h.a),l.clear(u);else{if(r&&this._setFramebuffer(s),e)for(let A=0;A<s.textures.length;A++)A===0?l.clearBufferfv(l.COLOR,A,[h.r,h.g,h.b,h.a]):l.clearBufferfv(l.COLOR,A,[0,0,0,1]);n&&i?l.clearBufferfi(l.DEPTH_STENCIL,0,f,m):n?l.clearBufferfv(l.DEPTH,0,[f]):i&&l.clearBufferiv(l.STENCIL,0,[m]),r&&o&&this._resolveRenderTarget(s)}}}beginCompute(e){const{state:n,gl:i}=this;n.bindFramebuffer(i.FRAMEBUFFER,null),this.initTimestampQuery(Fd.COMPUTE,this.getTimestampUID(e))}compute(e,n,i,s,r=null){const{state:o,gl:l}=this;this.discard===!1&&(o.enable(l.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:c,transformBuffers:u,attributes:h}=this.get(s),f=this._getVaoKey(h),m=this.vaoCache[f];m===void 0?this.vaoCache[f]=this._createVao(h):o.setVertexState(m),o.useProgram(c),this._bindUniforms(i);const A=this._getTransformFeedback(u);l.bindTransformFeedback(l.TRANSFORM_FEEDBACK,A),l.beginTransformFeedback(l.POINTS),r=r!==null?r:n.count,Array.isArray(r)?(ji("WebGLBackend.compute(): The count parameter must be a single number, not an array."),r=r[0]):r&&typeof r=="object"&&r.isIndirectStorageBufferAttribute&&(ji("WebGLBackend.compute(): The count parameter must be a single number, not IndirectStorageBufferAttribute"),r=n.count),h[0].isStorageInstancedBufferAttribute?l.drawArraysInstanced(l.POINTS,0,1,r):l.drawArrays(l.POINTS,0,r),l.endTransformFeedback(),l.bindTransformFeedback(l.TRANSFORM_FEEDBACK,null);for(let x=0;x<u.length;x++){const T=u[x];T.pbo&&this.has(T.pbo)&&this.textureUtils.copyBufferToTexture(T.transformBuffer,T.pbo),T.switchBuffers()}}finishCompute(e){const{state:n,gl:i}=this;this.discard=!1,n.disable(i.RASTERIZER_DISCARD),this.prepareTimestampBuffer(Fd.COMPUTE,this.getTimestampUID(e)),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:n,pipeline:i,material:s,context:r,hardwareClippingPlanes:o}=e,{programGPU:l}=this.get(i),{gl:c,state:u}=this,h=this.get(r),f=e.getDrawParameters();if(f===null)return;this._bindUniforms(e.getBindings());const m=n.isMesh&&n.matrixWorld.determinant()<0;u.setMaterial(s,m,o),r.textures!==null&&r.textures.length>1&&u.setMRTBlending(r.textures),u.useProgram(l);const A=e.getAttributes(),x=this.get(A);let T=x.vaoGPU;if(T===void 0){const j=this._getVaoKey(A);T=this.vaoCache[j],T===void 0&&(T=this._createVao(A),this.vaoCache[j]=T,x.vaoGPU=T)}const E=e.getIndex(),M=E!==null?this.get(E).bufferGPU:null;u.setVertexState(T,M);const N=h.lastOcclusionObject;if(N!==n&&N!==void 0){if(N!==null&&N.occlusionTest===!0&&(c.endQuery(c.ANY_SAMPLES_PASSED),h.occlusionQueryIndex++),n.occlusionTest===!0){const j=c.createQuery();c.beginQuery(c.ANY_SAMPLES_PASSED,j),h.occlusionQueries[h.occlusionQueryIndex]=j,h.occlusionQueryObjects[h.occlusionQueryIndex]=n}h.lastOcclusionObject=n}const I=this.bufferRenderer;n.isPoints?I.mode=c.POINTS:n.isLineSegments?I.mode=c.LINES:n.isLine?I.mode=c.LINE_STRIP:n.isLineLoop?I.mode=c.LINE_LOOP:s.wireframe===!0?(u.setLineWidth(s.wireframeLinewidth*this.renderer.getPixelRatio()),I.mode=c.LINES):I.mode=c.TRIANGLES;const{vertexCount:F,instanceCount:G}=f;let{firstVertex:O}=f;if(I.object=n,E!==null){O*=E.array.BYTES_PER_ELEMENT;const j=this.get(E);I.index=E.count,I.type=j.type}else I.index=0;const D=()=>{n.isBatchedMesh?n._multiDrawInstances!==null?(ji("WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),I.renderMultiDrawInstances(n._multiDrawStarts,n._multiDrawCounts,n._multiDrawCount,n._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?I.renderMultiDraw(n._multiDrawStarts,n._multiDrawCounts,n._multiDrawCount):ji("WebGLBackend: WEBGL_multi_draw not supported."):G>1?I.renderInstances(O,F,G):I.render(O,F)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const j=this.get(e.camera),L=e.camera.cameras,U=e.getBindingGroup("cameraIndex").bindings[0];if(j.indexesGPU===void 0||j.indexesGPU.length!==L.length){const Q=new Uint32Array([0,0,0,0]),Y=[];for(let ue=0,pe=L.length;ue<pe;ue++){const Ee=c.createBuffer();Q[0]=ue,c.bindBuffer(c.UNIFORM_BUFFER,Ee),c.bufferData(c.UNIFORM_BUFFER,Q,c.STATIC_DRAW),Y.push(Ee)}j.indexesGPU=Y}const q=this.get(U),K=this.renderer.getPixelRatio(),H=this._currentContext.renderTarget,X=this._isRenderCameraDepthArray(this._currentContext),ne=this._currentContext.activeCubeFace;if(X){const Q=this.get(H.depthTexture);if(Q.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){Q.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:Y}=H;for(let ue=0,pe=L.length;ue<pe;ue++)this.renderer._activeCubeFace=ue,this._currentContext.activeCubeFace=ue,this._setFramebuffer(this._currentContext),this.clear(!1,!0,Y,this._currentContext,!1,!1);this.renderer._activeCubeFace=ne,this._currentContext.activeCubeFace=ne}}for(let Q=0,Y=L.length;Q<Y;Q++){const ue=L[Q];if(n.layers.test(ue.layers)){X&&(this.renderer._activeCubeFace=Q,this._currentContext.activeCubeFace=Q,this._setFramebuffer(this._currentContext));const pe=ue.viewport;if(pe!==void 0){const Ee=pe.x*K,oe=pe.y*K,Ae=pe.width*K,be=pe.height*K;u.viewport(Math.floor(Ee),Math.floor(e.context.height-be-oe),Math.floor(Ae),Math.floor(be))}u.bindBufferBase(c.UNIFORM_BUFFER,q.index,j.indexesGPU[Q]),D()}this._currentContext.activeCubeFace=ne,this.renderer._activeCubeFace=ne}}else D()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,n){this.textureUtils.createTexture(e,n)}updateTexture(e,n){this.textureUtils.updateTexture(e,n)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e,n=!1){this.textureUtils.destroyTexture(e,n)}async copyTextureToBuffer(e,n,i,s,r,o){return this.textureUtils.copyTextureToBuffer(e,n,i,s,r,o)}updateSampler(){return""}createNodeBuilder(e,n){return new Vqe(e,n)}createProgram(e){const n=this.gl,{stage:i,code:s}=e,r=i==="fragment"?n.createShader(n.FRAGMENT_SHADER):n.createShader(n.VERTEX_SHADER);n.shaderSource(r,s),n.compileShader(r),this.set(e,{shaderGPU:r})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,n){const i=this.gl,s=e.pipeline,{fragmentProgram:r,vertexProgram:o}=s,l=i.createProgram(),c=this.get(r).shaderGPU,u=this.get(o).shaderGPU;if(i.attachShader(l,c),i.attachShader(l,u),i.linkProgram(l),this.set(s,{programGPU:l,fragmentShader:c,vertexShader:u}),n!==null&&this.parallel){const h=new Promise(f=>{const m=this.parallel,A=()=>{i.getProgramParameter(l,m.COMPLETION_STATUS_KHR)?(this._completeCompile(e,s),f()):requestAnimationFrame(A)};A()});n.push(h);return}this._completeCompile(e,s)}_handleSource(e,n){const i=e.split(`
`),s=[],r=Math.max(n-6,0),o=Math.min(n+6,i.length);for(let l=r;l<o;l++){const c=l+1;s.push(`${c===n?">":" "} ${c}: ${i[l]}`)}return s.join(`
`)}_getShaderErrors(e,n,i){const s=e.getShaderParameter(n,e.COMPILE_STATUS),o=(e.getShaderInfoLog(n)||"").trim();if(s&&o==="")return"";const l=/ERROR: 0:(\d+)/.exec(o);if(l){const c=parseInt(l[1]);return i.toUpperCase()+`

`+o+`

`+this._handleSource(e.getShaderSource(n),c)}else return o}_logProgramError(e,n,i){if(this.renderer.debug.checkShaderErrors){const s=this.gl,o=(s.getProgramInfoLog(e)||"").trim();if(s.getProgramParameter(e,s.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(s,e,i,n);else{const l=this._getShaderErrors(s,i,"vertex"),c=this._getShaderErrors(s,n,"fragment");Rt("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(e,s.VALIDATE_STATUS)+`

Program Info Log: `+o+`
`+l+`
`+c)}else o!==""&&yt("WebGLProgram: Program Info Log:",o)}}_completeCompile(e,n){const{state:i,gl:s}=this,r=this.get(n),{programGPU:o,fragmentShader:l,vertexShader:c}=r;s.getProgramParameter(o,s.LINK_STATUS)===!1&&this._logProgramError(o,l,c),i.useProgram(o);const u=e.getBindings();this._setupBindings(u,o),this.set(n,{programGPU:o})}createComputePipeline(e,n){const{state:i,gl:s}=this,r={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(r);const{computeProgram:o}=e,l=s.createProgram(),c=this.get(r).shaderGPU,u=this.get(o).shaderGPU,h=o.transforms,f=[],m=[];for(let E=0;E<h.length;E++){const M=h[E];f.push(M.varyingName),m.push(M.attributeNode)}s.attachShader(l,c),s.attachShader(l,u),s.transformFeedbackVaryings(l,f,s.SEPARATE_ATTRIBS),s.linkProgram(l),s.getProgramParameter(l,s.LINK_STATUS)===!1&&this._logProgramError(l,c,u),i.useProgram(l),this._setupBindings(n,l);const A=o.attributes,x=[],T=[];for(let E=0;E<A.length;E++){const M=A[E].node.attribute;x.push(M),this.has(M)||this.attributeUtils.createAttribute(M,s.ARRAY_BUFFER)}for(let E=0;E<m.length;E++){const M=m[E].attribute;this.has(M)||this.attributeUtils.createAttribute(M,s.ARRAY_BUFFER);const N=this.get(M);T.push(N)}this.set(e,{programGPU:l,transformBuffers:T,attributes:x})}createBindings(e,n){if(this._knownBindings.has(n)===!1){this._knownBindings.add(n);let i=0,s=0;for(const r of n){this.set(r,{textures:s,uniformBuffers:i});for(const o of r.bindings)o.isUniformBuffer&&i++,o.isSampledTexture&&s++}}this.updateBindings(e,n)}updateBindings(e){const{gl:n}=this,i=this.get(e);let s=i.uniformBuffers,r=i.textures;for(const o of e.bindings){const l=this.get(o);if(o.isUniformsGroup||o.isUniformBuffer){const c=o.buffer;let{bufferGPU:u}=this.get(c);u===void 0?(u=n.createBuffer(),n.bindBuffer(n.UNIFORM_BUFFER,u),n.bufferData(n.UNIFORM_BUFFER,c.byteLength,n.DYNAMIC_DRAW),this.set(c,{bufferGPU:u})):n.bindBuffer(n.UNIFORM_BUFFER,u);const h=o.updateRanges;if(n.bindBuffer(n.UNIFORM_BUFFER,u),h.length===0)n.bufferData(n.UNIFORM_BUFFER,c,n.DYNAMIC_DRAW);else{const f=ax(c),m=f?1:c.BYTES_PER_ELEMENT;for(let A=0,x=h.length;A<x;A++){const T=h[A],E=T.start*m,M=T.count*m,N=E*(f?c.BYTES_PER_ELEMENT:1);n.bufferSubData(n.UNIFORM_BUFFER,N,c,E,M)}}l.index=s++,l.bufferGPU=u,this.set(o,l)}else if(o.isSampledTexture){const{textureGPU:c,glTextureType:u}=this.get(o.texture);l.index=r++,l.textureGPU=c,l.glTextureType=u,this.set(o,l)}}}updateBinding(e){const n=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const s=this.get(e).bufferGPU,r=e.buffer,o=e.updateRanges;if(n.bindBuffer(n.UNIFORM_BUFFER,s),o.length===0)n.bufferData(n.UNIFORM_BUFFER,r,n.DYNAMIC_DRAW);else{const l=ax(r),c=l?1:r.BYTES_PER_ELEMENT;for(let u=0,h=o.length;u<h;u++){const f=o[u],m=f.start*c,A=f.count*c,x=m*(l?r.BYTES_PER_ELEMENT:1);n.bufferSubData(n.UNIFORM_BUFFER,x,r,m,A)}}}}createIndexAttribute(e){const n=this.gl;this.attributeUtils.createAttribute(e,n.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const n=this.gl;this.attributeUtils.createAttribute(e,n.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const n=this.gl;this.attributeUtils.createAttribute(e,n.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const n=Object.keys(QK).filter(s=>QK[s]===e),i=this.extensions;for(let s=0;s<n.length;s++)if(i.has(n[s]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,n,i=null,s=null,r=0,o=0){this.textureUtils.copyTextureToTexture(e,n,i,s,r,o)}copyFramebufferToTexture(e,n,i){this.textureUtils.copyFramebufferToTexture(e,n,i)}_setFramebuffer(e){const{gl:n,state:i}=this;let s=null;if(e.textures!==null){const r=e.renderTarget,o=this.get(r),{samples:l,depthBuffer:c,stencilBuffer:u}=r,h=r.isWebGLCubeRenderTarget===!0,f=r.isRenderTarget3D===!0,m=r.depth>1,A=r.isXRRenderTarget===!0,x=A===!0&&r._hasExternalTextures===!0;let T=o.msaaFrameBuffer,E=o.depthRenderbuffer;const M=this.extensions.get("WEBGL_multisampled_render_to_texture"),N=this.extensions.get("OVR_multiview2"),I=this._useMultisampledExtension(r),F=ire(e);let G;if(h?(o.cubeFramebuffers||(o.cubeFramebuffers={}),G=o.cubeFramebuffers[F]):A&&x===!1?G=this._xrFramebuffer:(o.framebuffers||(o.framebuffers={}),G=o.framebuffers[F]),G===void 0){G=n.createFramebuffer(),i.bindFramebuffer(n.FRAMEBUFFER,G);const O=e.textures,D=[];if(h){o.cubeFramebuffers[F]=G;const{textureGPU:L}=this.get(O[0]),U=this.renderer._activeCubeFace,q=this.renderer._activeMipmapLevel;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+U,L,q)}else{o.framebuffers[F]=G;for(let L=0;L<O.length;L++){const U=O[L],q=this.get(U);q.renderTarget=e.renderTarget,q.cacheKey=F;const K=n.COLOR_ATTACHMENT0+L;if(r.multiview)N.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,K,q.textureGPU,0,l,0,2);else if(f||m){const H=this.renderer._activeCubeFace,X=this.renderer._activeMipmapLevel;n.framebufferTextureLayer(n.FRAMEBUFFER,K,q.textureGPU,X,H)}else if(I)M.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,K,n.TEXTURE_2D,q.textureGPU,0,l);else{const H=this.renderer._activeMipmapLevel;n.framebufferTexture2D(n.FRAMEBUFFER,K,n.TEXTURE_2D,q.textureGPU,H)}}}const j=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(r._autoAllocateDepthBuffer===!0){const L=n.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(L,e,0,I),o.xrDepthRenderbuffer=L,D.push(u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT),n.bindRenderbuffer(n.RENDERBUFFER,L),n.framebufferRenderbuffer(n.FRAMEBUFFER,j,n.RENDERBUFFER,L)}else if(e.depthTexture!==null){D.push(u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT);const L=this.get(e.depthTexture);if(L.renderTarget=e.renderTarget,L.cacheKey=F,r.multiview)N.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,j,L.textureGPU,0,l,0,2);else if(x&&I)M.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,j,n.TEXTURE_2D,L.textureGPU,0,l);else if(e.depthTexture.isArrayTexture){const U=this.renderer._activeCubeFace;n.framebufferTextureLayer(n.FRAMEBUFFER,j,L.textureGPU,0,U)}else if(e.depthTexture.isCubeTexture){const U=this.renderer._activeCubeFace;n.framebufferTexture2D(n.FRAMEBUFFER,j,n.TEXTURE_CUBE_MAP_POSITIVE_X+U,L.textureGPU,0)}else n.framebufferTexture2D(n.FRAMEBUFFER,j,n.TEXTURE_2D,L.textureGPU,0)}o.depthInvalidationArray=D}else{if(this._isRenderCameraDepthArray(e)){i.bindFramebuffer(n.FRAMEBUFFER,G);const D=this.renderer._activeCubeFace,j=this.get(e.depthTexture),L=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.framebufferTextureLayer(n.FRAMEBUFFER,L,j.textureGPU,0,D)}if((A||I||r.multiview)&&r._isOpaqueFramebuffer!==!0){i.bindFramebuffer(n.FRAMEBUFFER,G);const D=this.get(e.textures[0]);r.multiview?N.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,D.textureGPU,0,l,0,2):I?M.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,D.textureGPU,0,l):n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,D.textureGPU,0);const j=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(r._autoAllocateDepthBuffer===!0){const L=o.xrDepthRenderbuffer;n.bindRenderbuffer(n.RENDERBUFFER,L),n.framebufferRenderbuffer(n.FRAMEBUFFER,j,n.RENDERBUFFER,L)}else{const L=this.get(e.depthTexture);r.multiview?N.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,j,L.textureGPU,0,l,0,2):I?M.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,j,n.TEXTURE_2D,L.textureGPU,0,l):n.framebufferTexture2D(n.FRAMEBUFFER,j,n.TEXTURE_2D,L.textureGPU,0)}}}if(l>0&&I===!1&&!r.multiview){if(T===void 0){const O=[];T=n.createFramebuffer(),i.bindFramebuffer(n.FRAMEBUFFER,T);const D=[],j=e.textures;for(let L=0;L<j.length;L++){D[L]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,D[L]),O.push(n.COLOR_ATTACHMENT0+L);const U=e.textures[L],q=this.get(U);n.renderbufferStorageMultisample(n.RENDERBUFFER,l,q.glInternalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+L,n.RENDERBUFFER,D[L])}if(n.bindRenderbuffer(n.RENDERBUFFER,null),o.msaaFrameBuffer=T,o.msaaRenderbuffers=D,c&&E===void 0){E=n.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(E,e,l),o.depthRenderbuffer=E;const L=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;O.push(L)}o.invalidationArray=O}s=o.msaaFrameBuffer}else s=G;i.drawBuffers(e,G)}i.bindFramebuffer(n.FRAMEBUFFER,s)}_getVaoKey(e){let n="";for(let i=0;i<e.length;i++){const s=this.get(e[i]);n+=":"+s.id}return n}_createVao(e){const{gl:n}=this,i=n.createVertexArray();n.bindVertexArray(i);for(let s=0;s<e.length;s++){const r=e[s],o=this.get(r);n.bindBuffer(n.ARRAY_BUFFER,o.bufferGPU),n.enableVertexAttribArray(s);let l,c;r.isInterleavedBufferAttribute===!0?(l=r.data.stride*o.bytesPerElement,c=r.offset*o.bytesPerElement):(l=0,c=0),o.isInteger?n.vertexAttribIPointer(s,r.itemSize,o.type,l,c):n.vertexAttribPointer(s,r.itemSize,o.type,r.normalized,l,c),r.isInstancedBufferAttribute&&!r.isInterleavedBufferAttribute?n.vertexAttribDivisor(s,r.meshPerAttribute):r.isInterleavedBufferAttribute&&r.data.isInstancedInterleavedBuffer&&n.vertexAttribDivisor(s,r.data.meshPerAttribute)}return n.bindBuffer(n.ARRAY_BUFFER,null),i}_getTransformFeedback(e){let n="";for(let r=0;r<e.length;r++)n+=":"+e[r].id;let i=this.transformFeedbackCache[n];if(i!==void 0)return i;const{gl:s}=this;i=s.createTransformFeedback(),s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,i);for(let r=0;r<e.length;r++){const o=e[r];s.bindBufferBase(s.TRANSFORM_FEEDBACK_BUFFER,r,o.transformBuffer)}return s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[n]=i,i}_setupBindings(e,n){const i=this.gl;for(const s of e)for(const r of s.bindings){const l=this.get(r).index;if(r.isUniformsGroup||r.isUniformBuffer){const c=i.getUniformBlockIndex(n,r.name);i.uniformBlockBinding(n,c,l)}else if(r.isSampledTexture){const c=i.getUniformLocation(n,r.name);i.uniform1i(c,l)}}}_bindUniforms(e){const{gl:n,state:i}=this;for(const s of e)for(const r of s.bindings){const o=this.get(r),l=o.index;r.isUniformsGroup||r.isUniformBuffer?i.bindBufferBase(n.UNIFORM_BUFFER,l,o.bufferGPU):r.isSampledTexture&&i.bindTexture(o.glTextureType,o.textureGPU,n.TEXTURE0+l)}}_resolveRenderTarget(e){const{gl:n,state:i}=this,s=e.renderTarget;if(e.textures!==null&&s){const r=this.get(s);if(s.samples>0&&this._useMultisampledExtension(s)===!1){const o=r.framebuffers[e.getCacheKey()];let l=n.COLOR_BUFFER_BIT;s.resolveDepthBuffer&&(s.depthBuffer&&(l|=n.DEPTH_BUFFER_BIT),s.stencilBuffer&&s.resolveStencilBuffer&&(l|=n.STENCIL_BUFFER_BIT));const c=r.msaaFrameBuffer,u=r.msaaRenderbuffers,h=e.textures,f=h.length>1;if(i.bindFramebuffer(n.READ_FRAMEBUFFER,c),i.bindFramebuffer(n.DRAW_FRAMEBUFFER,o),f)for(let m=0;m<h.length;m++)n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0+m,n.RENDERBUFFER,null),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+m,n.TEXTURE_2D,null,0);for(let m=0;m<h.length;m++){if(f){const{textureGPU:A}=this.get(h[m]);n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,u[m]),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,A,0)}if(e.scissor){const{x:A,y:x,width:T,height:E}=e.scissorValue,M=e.height-E-x;n.blitFramebuffer(A,M,A+T,M+E,A,M,A+T,M+E,l,n.NEAREST)}else n.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,l,n.NEAREST)}if(f)for(let m=0;m<h.length;m++){const{textureGPU:A}=this.get(h[m]);n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0+m,n.RENDERBUFFER,u[m]),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+m,n.TEXTURE_2D,A,0)}this._supportsInvalidateFramebuffer===!0&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,r.invalidationArray)}else if(s.resolveDepthBuffer===!1&&r.framebuffers){const o=r.framebuffers[e.getCacheKey()];i.bindFramebuffer(n.DRAW_FRAMEBUFFER,o),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,r.depthInvalidationArray)}}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer!==!1}dispose(){this.textureUtils!==null&&this.textureUtils.dispose();const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const u_={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},YA=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},xo={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},Tl={Store:"store"},Ri={Load:"load",Clear:"clear"},ZK={CCW:"ccw",CW:"cw"},eY={None:"none",Back:"back"},Ax={Uint16:"uint16",Uint32:"uint32"},We={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rg11b10ufloat",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-unorm-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},Q5={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},DA={Linear:"linear",Nearest:"nearest"},ti={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDst:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},SA={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},tY={None:0,All:15},gg={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},J5={Storage:"storage",ReadOnlyStorage:"read-only-storage"},Z5={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},nY={NonFiltering:"non-filtering",Comparison:"comparison"},TA={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},aY={TwoD:"2d",ThreeD:"3d"},vr={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},Jqe={All:"all"},cC={Vertex:"vertex",Instance:"instance"},HO={CoreFeaturesAndLimits:"core-features-and-limits",DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionBCSliced3D:"texture-compression-bc-sliced-3d",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TextureCompressionASTCSliced3D:"texture-compression-astc-sliced-3d",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",Float32Blendable:"float32-blendable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups",TextureFormatsTier1:"texture-formats-tier1",TextureFormatsTier2:"texture-formats-tier2"},iY={"texture-compression-s3tc":"texture-compression-bc","texture-compression-etc1":"texture-compression-etc2"};class Zqe extends loe{constructor(e,n,i){super(e,n?n.value:null),this.textureNode=n,this.groupNode=i}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class eHe extends ioe{constructor(e,n){super(e,n?n.array:null),this.attribute=n,this.isStorageBuffer=!0}}let tHe=0;class nHe extends eHe{constructor(e,n){super("StorageBuffer_"+tHe++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:Po.READ_WRITE,this.groupNode=n}get buffer(){return this.nodeUniform.value}}class aHe extends k0{constructor(e){super(),this.device=e;const n=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,i=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,s=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:DA.Linear}),this.flipYSampler=e.createSampler({minFilter:DA.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:n}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:i}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:s})}getTransferPipeline(e){let n=this.transferPipelines[e];return n===void 0&&(n=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:u_.TriangleStrip,stripIndexFormat:Ax.Uint32},layout:"auto"}),this.transferPipelines[e]=n),n}getFlipYPipeline(e){let n=this.flipYPipelines[e];return n===void 0&&(n=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:u_.TriangleStrip,stripIndexFormat:Ax.Uint32},layout:"auto"}),this.flipYPipelines[e]=n),n}flipY(e,n,i=0){const s=n.format,{width:r,height:o}=n.size,l=this.getTransferPipeline(s),c=this.getFlipYPipeline(s),u=this.device.createTexture({size:{width:r,height:o,depthOrArrayLayers:1},format:s,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),h=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:vr.TwoD,baseArrayLayer:i}),f=u.createView({baseMipLevel:0,mipLevelCount:1,dimension:vr.TwoD,baseArrayLayer:0}),m=this.device.createCommandEncoder({}),A=(x,T,E)=>{const M=x.getBindGroupLayout(0),N=this.device.createBindGroup({layout:M,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:T}]}),I=m.beginRenderPass({colorAttachments:[{view:E,loadOp:Ri.Clear,storeOp:Tl.Store,clearValue:[0,0,0,0]}]});I.setPipeline(x),I.setBindGroup(0,N),I.draw(4,1,0,0),I.end()};A(l,h,f),A(c,f,h),this.device.queue.submit([m.finish()]),u.destroy()}generateMipmaps(e,n,i=0,s=null){const r=this.get(e);r.layers===void 0&&(r.layers=[]);const o=r.layers[i]||this._mipmapCreateBundles(e,n,i),l=s||this.device.createCommandEncoder({label:"mipmapEncoder"});this._mipmapRunBundles(l,o),s===null&&this.device.queue.submit([l.finish()]),r.layers[i]=o}_mipmapCreateBundles(e,n,i){const s=this.getTransferPipeline(n.format),r=s.getBindGroupLayout(0);let o=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:vr.TwoD,baseArrayLayer:i});const l=[];for(let c=1;c<n.mipLevelCount;c++){const u=this.device.createBindGroup({layout:r,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:o}]}),h=e.createView({baseMipLevel:c,mipLevelCount:1,dimension:vr.TwoD,baseArrayLayer:i}),f={colorAttachments:[{view:h,loadOp:Ri.Clear,storeOp:Tl.Store,clearValue:[0,0,0,0]}]},m=this.device.createRenderBundleEncoder({colorFormats:[n.format]});m.setPipeline(s),m.setBindGroup(0,u),m.draw(4,1,0,0),l.push({renderBundles:[m.finish()],passDescriptor:f}),o=h}return l}_mipmapRunBundles(e,n){const i=n.length;for(let s=0;s<i;s++){const r=n[s],o=e.beginRenderPass(r.passDescriptor);o.executeBundles(r.renderBundles),o.end()}}}const iHe={[zP]:"never",[jx]:"less",[GP]:"equal",[Bx]:"less-equal",[qP]:"greater",[Ux]:"greater-equal",[WP]:"always",[HP]:"not-equal"},sHe=[0,1,3,2,4,5];class rHe{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this._samplerCache=new Map}updateSampler(e){const n=this.backend,i=e.minFilter+"-"+e.magFilter+"-"+e.wrapS+"-"+e.wrapT+"-"+(e.wrapR||"0")+"-"+e.anisotropy+"-"+(e.compareFunction||0);let s=this._samplerCache.get(i);if(s===void 0){const o={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};o.magFilter===DA.Linear&&o.minFilter===DA.Linear&&o.mipmapFilter===DA.Linear&&(o.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(o.compare=iHe[e.compareFunction]),s={sampler:n.device.createSampler(o),usedTimes:0},this._samplerCache.set(i,s)}const r=n.get(e);if(r.sampler!==s.sampler){if(r.sampler!==void 0){const o=this._samplerCache.get(r.samplerKey);o.usedTimes--,o.usedTimes===0&&this._samplerCache.delete(r.samplerKey)}r.samplerKey=i,r.sampler=s.sampler,s.usedTimes++}return i}createDefaultTexture(e){let n;const i=WO(e);e.isCubeTexture?n=this._getDefaultCubeTextureGPU(i):n=this._getDefaultTextureGPU(i),this.backend.get(e).texture=n}createTexture(e,n={}){const i=this.backend,s=i.get(e);if(s.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");if(e.isExternalTexture){s.texture=e.sourceTexture,s.initialized=!0;return}n.needsMipmaps===void 0&&(n.needsMipmaps=!1),n.levels===void 0&&(n.levels=1),n.depth===void 0&&(n.depth=1);const{width:r,height:o,depth:l,levels:c}=n;e.isFramebufferTexture&&(n.renderTarget?n.format=this.backend.utils.getCurrentColorFormat(n.renderTarget):n.format=this.backend.utils.getPreferredCanvasFormat());const u=this._getDimension(e),h=e.internalFormat||n.format||WO(e,i.device);s.format=h;const{samples:f,primarySamples:m,isMSAA:A}=i.utils.getTextureSampleData(e);let x=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(x|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&h!==We.RGB9E5UFloat&&(x|=GPUTextureUsage.RENDER_ATTACHMENT);const T={label:e.name,size:{width:r,height:o,depthOrArrayLayers:l},mipLevelCount:c,sampleCount:m,dimension:u,format:h,usage:x};if(h===void 0){yt("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}if(e.isCubeTexture&&(T.textureBindingViewDimension=vr.Cube),s.texture=i.device.createTexture(T),A){const E=Object.assign({},T);E.label=E.label+"-msaa",E.sampleCount=f,E.mipLevelCount=1,s.msaaTexture=i.device.createTexture(E)}s.initialized=!0,s.textureDescriptorGPU=T}destroyTexture(e,n=!1){const i=this.backend,s=i.get(e);s.texture!==void 0&&n===!1&&s.texture.destroy(),s.msaaTexture!==void 0&&s.msaaTexture.destroy(),i.delete(e)}generateMipmaps(e,n=null){const i=this.backend.get(e);if(e.isCubeTexture)for(let s=0;s<6;s++)this._generateMipmaps(i.texture,i.textureDescriptorGPU,s,n);else{const s=e.image.depth||1;for(let r=0;r<s;r++)this._generateMipmaps(i.texture,i.textureDescriptorGPU,r,n)}}getColorBuffer(){const e=this.backend,n=e.renderer.getCanvasTarget(),{width:i,height:s}=e.getDrawingBufferSize(),r=e.renderer.currentSamples,o=n.colorTexture,l=e.get(o);if(o.width===i&&o.height===s&&o.samples===r)return l.texture;let c=l.texture;return c&&c.destroy(),c=e.device.createTexture({label:"colorBuffer",size:{width:i,height:s,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.currentSamples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),o.source.width=i,o.source.height=s,o.samples=r,l.texture=c,c}getDepthBuffer(e=!0,n=!1){const i=this.backend,s=i.renderer.getCanvasTarget(),{width:r,height:o}=i.getDrawingBufferSize(),l=i.renderer.currentSamples,c=s.depthTexture;if(c.width===r&&c.height===o&&c.samples===l&&c.depth===e&&c.stencil===n)return i.get(c).texture;const u=i.get(c).texture;let h,f;if(n?(h=rl,f=yc):e&&(h=ho,f=Ei),u!==void 0){if(c.image.width===r&&c.image.height===o&&c.format===h&&c.type===f&&c.samples===l)return u;this.destroyTexture(c)}return c.name="depthBuffer",c.format=h,c.type=f,c.image.width=r,c.image.height=o,c.samples=l,this.createTexture(c,{width:r,height:o}),i.get(c).texture}updateTexture(e,n){const i=this.backend.get(e),s=e.mipmaps,{textureDescriptorGPU:r}=i;if(!(e.isRenderTargetTexture||r===void 0)){if(e.isDataTexture)if(s.length>0)for(let o=0,l=s.length;o<l;o++){const c=s[o];this._copyBufferToTexture(c,i.texture,r,0,e.flipY,0,o)}else this._copyBufferToTexture(n.image,i.texture,r,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let o=0;o<n.image.depth;o++)this._copyBufferToTexture(n.image,i.texture,r,o,e.flipY,o);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,i.texture,r);else if(e.isCubeTexture)this._copyCubeMapToTexture(e,i.texture,r);else if(s.length>0)for(let o=0,l=s.length;o<l;o++){const c=s[o];this._copyImageToTexture(c,i.texture,r,0,e.flipY,e.premultiplyAlpha,o)}else this._copyImageToTexture(n.image,i.texture,r,0,e.flipY,e.premultiplyAlpha);i.version=e.version}}async copyTextureToBuffer(e,n,i,s,r,o){const l=this.backend.device,c=this.backend.get(e),u=c.texture,h=c.textureDescriptorGPU.format,f=this._getBytesPerTexel(h);let m=s*f;m=Math.ceil(m/256)*256;const A=l.createBuffer({size:(r-1)*m+s*f,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),x=l.createCommandEncoder();x.copyTextureToBuffer({texture:u,origin:{x:n,y:i,z:o}},{buffer:A,bytesPerRow:m},{width:s,height:r});const T=this._getTypedArrayType(h);l.queue.submit([x.finish()]),await A.mapAsync(GPUMapMode.READ);const E=A.getMappedRange();return new T(E)}dispose(){this._samplerCache.clear()}_getDefaultTextureGPU(e){let n=this.defaultTexture[e];if(n===void 0){const i=new _s;i.minFilter=Mi,i.magFilter=Mi,this.createTexture(i,{width:1,height:1,format:e}),this.defaultTexture[e]=n=i}return this.backend.get(n).texture}_getDefaultCubeTextureGPU(e){let n=this.defaultCubeTexture[e];if(n===void 0){const i=new M0;i.minFilter=Mi,i.magFilter=Mi,this.createTexture(i,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=n=i}return this.backend.get(n).texture}_copyCubeMapToTexture(e,n,i){const s=e.images,r=e.mipmaps;for(let o=0;o<6;o++){const l=s[o],c=e.flipY===!0?sHe[o]:o;l.isDataTexture?this._copyBufferToTexture(l.image,n,i,c,e.flipY):this._copyImageToTexture(l,n,i,c,e.flipY,e.premultiplyAlpha);for(let u=0;u<r.length;u++){const f=r[u].images[o];f.isDataTexture?this._copyBufferToTexture(f.image,n,i,c,e.flipY,0,u+1):this._copyImageToTexture(f,n,i,c,e.flipY,e.premultiplyAlpha,u+1)}}}_copyImageToTexture(e,n,i,s,r,o,l=0){const c=this.backend.device,u=l>0?e.width:i.size.width,h=l>0?e.height:i.size.height;try{c.queue.copyExternalImageToTexture({source:e,flipY:r},{texture:n,mipLevel:l,origin:{x:0,y:0,z:s},premultipliedAlpha:o},{width:u,height:h,depthOrArrayLayers:1})}catch{}}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new aHe(this.backend.device)),e}_generateMipmaps(e,n,i=0,s=null){this._getPassUtils().generateMipmaps(e,n,i,s)}_flipY(e,n,i=0){this._getPassUtils().flipY(e,n,i)}_copyBufferToTexture(e,n,i,s,r,o=0,l=0){const c=this.backend.device,u=e.data,h=this._getBytesPerTexel(i.format),f=e.width*h;c.queue.writeTexture({texture:n,mipLevel:l,origin:{x:0,y:0,z:s}},u,{offset:e.width*e.height*h*o,bytesPerRow:f},{width:e.width,height:e.height,depthOrArrayLayers:1}),r===!0&&this._flipY(n,i,s)}_copyCompressedBufferToTexture(e,n,i){const s=this.backend.device,r=this._getBlockData(i.format),o=i.size.depthOrArrayLayers>1;for(let l=0;l<e.length;l++){const c=e[l],u=c.width,h=c.height,f=o?i.size.depthOrArrayLayers:1,m=Math.ceil(u/r.width)*r.byteLength,A=m*Math.ceil(h/r.height);for(let x=0;x<f;x++)s.queue.writeTexture({texture:n,mipLevel:l,origin:{x:0,y:0,z:x}},c.data,{offset:x*A,bytesPerRow:m,rowsPerImage:Math.ceil(h/r.height)},{width:Math.ceil(u/r.width)*r.width,height:Math.ceil(h/r.height)*r.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===We.BC1RGBAUnorm||e===We.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===We.BC2RGBAUnorm||e===We.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===We.BC3RGBAUnorm||e===We.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===We.BC4RUnorm||e===We.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===We.BC5RGUnorm||e===We.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===We.BC6HRGBUFloat||e===We.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===We.BC7RGBAUnorm||e===We.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===We.ETC2RGB8Unorm||e===We.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===We.ETC2RGB8A1Unorm||e===We.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===We.ETC2RGBA8Unorm||e===We.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===We.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===We.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===We.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===We.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===We.ASTC4x4Unorm||e===We.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===We.ASTC5x4Unorm||e===We.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===We.ASTC5x5Unorm||e===We.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===We.ASTC6x5Unorm||e===We.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===We.ASTC6x6Unorm||e===We.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===We.ASTC8x5Unorm||e===We.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===We.ASTC8x6Unorm||e===We.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===We.ASTC8x8Unorm||e===We.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===We.ASTC10x5Unorm||e===We.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===We.ASTC10x6Unorm||e===We.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===We.ASTC10x8Unorm||e===We.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===We.ASTC10x10Unorm||e===We.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===We.ASTC12x10Unorm||e===We.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===We.ASTC12x12Unorm||e===We.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let n=Q5.ClampToEdge;return e===ym?n=Q5.Repeat:e===vm&&(n=Q5.MirrorRepeat),n}_convertFilterMode(e){let n=DA.Linear;return(e===Mi||e===qT||e===Od)&&(n=DA.Nearest),n}_getBytesPerTexel(e){if(e===We.R8Unorm||e===We.R8Snorm||e===We.R8Uint||e===We.R8Sint)return 1;if(e===We.R16Uint||e===We.R16Sint||e===We.R16Float||e===We.RG8Unorm||e===We.RG8Snorm||e===We.RG8Uint||e===We.RG8Sint)return 2;if(e===We.R32Uint||e===We.R32Sint||e===We.R32Float||e===We.RG16Uint||e===We.RG16Sint||e===We.RG16Float||e===We.RGBA8Unorm||e===We.RGBA8UnormSRGB||e===We.RGBA8Snorm||e===We.RGBA8Uint||e===We.RGBA8Sint||e===We.BGRA8Unorm||e===We.BGRA8UnormSRGB||e===We.RGB9E5UFloat||e===We.RGB10A2Unorm||e===We.RG11B10UFloat||e===We.Depth32Float||e===We.Depth24Plus||e===We.Depth24PlusStencil8||e===We.Depth32FloatStencil8)return 4;if(e===We.RG32Uint||e===We.RG32Sint||e===We.RG32Float||e===We.RGBA16Uint||e===We.RGBA16Sint||e===We.RGBA16Float)return 8;if(e===We.RGBA32Uint||e===We.RGBA32Sint||e===We.RGBA32Float)return 16}_getTypedArrayType(e){if(e===We.R8Uint)return Uint8Array;if(e===We.R8Sint)return Int8Array;if(e===We.R8Unorm)return Uint8Array;if(e===We.R8Snorm)return Int8Array;if(e===We.RG8Uint)return Uint8Array;if(e===We.RG8Sint)return Int8Array;if(e===We.RG8Unorm)return Uint8Array;if(e===We.RG8Snorm)return Int8Array;if(e===We.RGBA8Uint)return Uint8Array;if(e===We.RGBA8Sint)return Int8Array;if(e===We.RGBA8Unorm||e===We.RGBA8UnormSRGB)return Uint8Array;if(e===We.RGBA8Snorm)return Int8Array;if(e===We.R16Uint)return Uint16Array;if(e===We.R16Sint)return Int16Array;if(e===We.RG16Uint)return Uint16Array;if(e===We.RG16Sint)return Int16Array;if(e===We.RGBA16Uint)return Uint16Array;if(e===We.RGBA16Sint)return Int16Array;if(e===We.R16Float||e===We.RG16Float||e===We.RGBA16Float)return Uint16Array;if(e===We.R32Uint)return Uint32Array;if(e===We.R32Sint)return Int32Array;if(e===We.R32Float)return Float32Array;if(e===We.RG32Uint)return Uint32Array;if(e===We.RG32Sint)return Int32Array;if(e===We.RG32Float)return Float32Array;if(e===We.RGBA32Uint)return Uint32Array;if(e===We.RGBA32Sint)return Int32Array;if(e===We.RGBA32Float)return Float32Array;if(e===We.BGRA8Unorm||e===We.BGRA8UnormSRGB)return Uint8Array;if(e===We.RGB10A2Unorm||e===We.RGB9E5UFloat||e===We.RG11B10UFloat)return Uint32Array;if(e===We.Depth32Float)return Float32Array;if(e===We.Depth24Plus||e===We.Depth24PlusStencil8)return Uint32Array;if(e===We.Depth32FloatStencil8)return Float32Array}_getDimension(e){let n;return e.is3DTexture||e.isData3DTexture?n=aY.ThreeD:n=aY.TwoD,n}}function WO(a,e=null){const n=a.format,i=a.type,s=a.colorSpace,r=Vn.getTransfer(s);let o;if(a.isCompressedTexture===!0||a.isCompressedArrayTexture===!0)switch(n){case Qp:case Jp:o=r===An?We.BC1RGBAUnormSRGB:We.BC1RGBAUnorm;break;case Zp:o=r===An?We.BC2RGBAUnormSRGB:We.BC2RGBAUnorm;break;case em:o=r===An?We.BC3RGBAUnormSRGB:We.BC3RGBAUnorm;break;case Hy:o=We.BC4RUnorm;break;case Wy:o=We.BC4RSnorm;break;case p0:o=We.BC5RGUnorm;break;case $y:o=We.BC5RGSnorm;break;case qy:o=r===An?We.BC7RGBAUnormSRGB:We.BC7RGBAUnorm;break;case wy:case Ty:o=r===An?We.ETC2RGB8UnormSRGB:We.ETC2RGB8Unorm;break;case Ey:o=r===An?We.ETC2RGBA8UnormSRGB:We.ETC2RGBA8Unorm;break;case My:o=We.EACR11Unorm;break;case Cy:o=We.EACR11Snorm;break;case f0:o=We.EACRG11Unorm;break;case Ny:o=We.EACRG11Snorm;break;case Ry:o=r===An?We.ASTC4x4UnormSRGB:We.ASTC4x4Unorm;break;case Py:o=r===An?We.ASTC5x4UnormSRGB:We.ASTC5x4Unorm;break;case Iy:o=r===An?We.ASTC5x5UnormSRGB:We.ASTC5x5Unorm;break;case Ly:o=r===An?We.ASTC6x5UnormSRGB:We.ASTC6x5Unorm;break;case Dy:o=r===An?We.ASTC6x6UnormSRGB:We.ASTC6x6Unorm;break;case ky:o=r===An?We.ASTC8x5UnormSRGB:We.ASTC8x5Unorm;break;case Oy:o=r===An?We.ASTC8x6UnormSRGB:We.ASTC8x6Unorm;break;case Fy:o=r===An?We.ASTC8x8UnormSRGB:We.ASTC8x8Unorm;break;case jy:o=r===An?We.ASTC10x5UnormSRGB:We.ASTC10x5Unorm;break;case By:o=r===An?We.ASTC10x6UnormSRGB:We.ASTC10x6Unorm;break;case Uy:o=r===An?We.ASTC10x8UnormSRGB:We.ASTC10x8Unorm;break;case Vy:o=r===An?We.ASTC10x10UnormSRGB:We.ASTC10x10Unorm;break;case zy:o=r===An?We.ASTC12x10UnormSRGB:We.ASTC12x10Unorm;break;case Gy:o=r===An?We.ASTC12x12UnormSRGB:We.ASTC12x12Unorm;break;case fs:o=r===An?We.RGBA8UnormSRGB:We.RGBA8Unorm;break;default:Rt("WebGPURenderer: Unsupported texture format.",n)}else switch(n){case fs:switch(i){case e0:o=We.RGBA8Snorm;break;case t0:o=We.RGBA16Sint;break;case Bu:o=We.RGBA16Uint;break;case Ei:o=We.RGBA32Uint;break;case jr:o=We.RGBA32Sint;break;case os:o=r===An?We.RGBA8UnormSRGB:We.RGBA8Unorm;break;case cs:o=We.RGBA16Float;break;case ls:o=We.RGBA32Float;break;default:Rt("WebGPURenderer: Unsupported texture type with RGBAFormat.",i)}break;case Fx:switch(i){case $T:o=We.RGB9E5UFloat;break;case KT:o=We.RG11B10UFloat;break;default:Rt("WebGPURenderer: Unsupported texture type with RGBFormat.",i)}break;case r1:switch(i){case e0:o=We.R8Snorm;break;case t0:o=We.R16Sint;break;case Bu:o=We.R16Uint;break;case Ei:o=We.R32Uint;break;case jr:o=We.R32Sint;break;case os:o=We.R8Unorm;break;case cs:o=We.R16Float;break;case ls:o=We.R32Float;break;default:Rt("WebGPURenderer: Unsupported texture type with RedFormat.",i)}break;case ol:switch(i){case e0:o=We.RG8Snorm;break;case t0:o=We.RG16Sint;break;case Bu:o=We.RG16Uint;break;case Ei:o=We.RG32Uint;break;case jr:o=We.RG32Sint;break;case os:o=We.RG8Unorm;break;case cs:o=We.RG16Float;break;case ls:o=We.RG32Float;break;default:Rt("WebGPURenderer: Unsupported texture type with RGFormat.",i)}break;case ho:switch(i){case Bu:o=We.Depth16Unorm;break;case Ei:o=We.Depth24Plus;break;case ls:o=We.Depth32Float;break;default:Rt("WebGPURenderer: Unsupported texture type with DepthFormat.",i)}break;case rl:switch(i){case yc:o=We.Depth24PlusStencil8;break;case ls:e&&e.features.has(HO.Depth32FloatStencil8)===!1&&Rt('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),o=We.Depth32FloatStencil8;break;default:Rt("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",i)}break;case E0:switch(i){case jr:o=We.R32Sint;break;case Ei:o=We.R32Uint;break;default:Rt("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",i)}break;case o1:switch(i){case jr:o=We.RG32Sint;break;case Ei:o=We.RG32Uint;break;default:Rt("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",i)}break;case l1:switch(i){case jr:o=We.RGBA32Sint;break;case Ei:o=We.RGBA32Uint;break;default:Rt("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",i)}break;default:Rt("WebGPURenderer: Unsupported texture format.",n)}return o}const oHe=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,lHe=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,sY={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},cHe=a=>{a=a.trim();const e=a.match(oHe);if(e!==null&&e.length===4){const n=e[2],i=[];let s=null;for(;(s=lHe.exec(n))!==null;)i.push({name:s[1],type:s[2]});const r=[];for(let h=0;h<i.length;h++){const{name:f,type:m}=i[h];let A=m;A.startsWith("ptr")?A="pointer":(A.startsWith("texture")&&(A=m.split("<")[0]),A=sY[A]),r.push(new k7(A,f))}const o=a.substring(e[0].length),l=e[3]||"void",c=e[1]!==void 0?e[1]:"";return{type:sY[l]||l,inputs:r,name:c,inputsCode:n,blockCode:o,outputType:l}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class uHe extends F7{constructor(e){const{type:n,inputs:i,name:s,inputsCode:r,blockCode:o,outputType:l}=cHe(e);super(n,i,s),this.inputsCode=r,this.blockCode=o,this.outputType=l}getCode(e=this.name){const n=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${n}`+this.blockCode}}class dHe extends toe{parseFunction(e){return new uHe(e)}}const hHe={[Po.READ_ONLY]:"read",[Po.WRITE_ONLY]:"write",[Po.READ_WRITE]:"read_write"},rY={[ym]:"repeat",[Ur]:"clamp",[vm]:"mirror"},uC={vertex:YA.VERTEX,fragment:YA.FRAGMENT,compute:YA.COMPUTE},oY={instance:!0,swizzleAssign:!1,storageBuffer:!0},fHe={"^^":"tsl_xor"},pHe={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},lY={},S2={tsl_xor:new ao("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new ao("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new ao("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new ao("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new ao("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new ao("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new ao("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new ao("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new ao("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new ao("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new ao("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new ao("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new ao(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},mHe={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>",floatpack_snorm_2x16:"pack2x16snorm",floatpack_unorm_2x16:"pack2x16unorm",floatpack_float16_2x16:"pack2x16float",floatunpack_snorm_2x16:"unpack2x16snorm",floatunpack_unorm_2x16:"unpack2x16unorm",floatunpack_float16_2x16:"unpack2x16float"};let hoe="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(hoe+=`diagnostic( off, derivative_uniformity );
`);class gHe extends eoe{constructor(e,n){super(e,n,new dHe),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}_generateTextureSample(e,n,i,s,r,o=this.shaderStage){return o==="fragment"?s?r?`textureSample( ${n}, ${n}_sampler, ${i}, ${s}, ${r} )`:`textureSample( ${n}, ${n}_sampler, ${i}, ${s} )`:r?`textureSample( ${n}, ${n}_sampler, ${i}, ${r} )`:`textureSample( ${n}, ${n}_sampler, ${i} )`:this.generateTextureSampleLevel(e,n,i,"0",s)}generateTextureSampleLevel(e,n,i,s,r,o){return this.isUnfilterable(e)===!1?o?`textureSampleLevel( ${n}, ${n}_sampler, ${i}, ${s}, ${o} )`:`textureSampleLevel( ${n}, ${n}_sampler, ${i}, ${s} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,n,i,o,s):this.generateTextureLod(e,n,i,r,o,s)}generateWrapFunction(e){const n=`tsl_coord_${rY[e.wrapS]}S_${rY[e.wrapT]}_${e.is3DTexture||e.isData3DTexture?"3d":"2d"}T`;let i=lY[n];if(i===void 0){const s=[],r=e.is3DTexture||e.isData3DTexture?"vec3f":"vec2f";let o=`fn ${n}( coord : ${r} ) -> ${r} {

	return ${r}(
`;const l=(c,u)=>{c===ym?(s.push(S2.repeatWrapping_float),o+=`		tsl_repeatWrapping_float( coord.${u} )`):c===Ur?(s.push(S2.clampWrapping_float),o+=`		tsl_clampWrapping_float( coord.${u} )`):c===vm?(s.push(S2.mirrorWrapping_float),o+=`		tsl_mirrorWrapping_float( coord.${u} )`):(o+=`		coord.${u}`,yt(`WebGPURenderer: Unsupported texture wrap type "${c}" for vertex shader.`))};l(e.wrapS,"x"),o+=`,
`,l(e.wrapT,"y"),(e.is3DTexture||e.isData3DTexture)&&(o+=`,
`,l(e.wrapR,"z")),o+=`
	);

}
`,lY[n]=i=new ao(o,s)}return i.build(this),n}generateArrayDeclaration(e,n){return`array< ${this.getType(e)}, ${n} >`}generateTextureDimension(e,n,i){const s=this.getDataFromNode(e,this.shaderStage,this.globalCache);s.dimensionsSnippet===void 0&&(s.dimensionsSnippet={});let r=s.dimensionsSnippet[i];if(s.dimensionsSnippet[i]===void 0){let o,l;const{primarySamples:c}=this.renderer.backend.utils.getTextureSampleData(e),u=c>1;e.is3DTexture||e.isData3DTexture?l="vec3<u32>":l="vec2<u32>",u||e.isStorageTexture?o=n:o=`${n}${i?`, u32( ${i} )`:""}`,r=new s3(new r3(`textureDimensions( ${o} )`,l)),s.dimensionsSnippet[i]=r,(e.isArrayTexture||e.isDataArrayTexture||e.is3DTexture||e.isData3DTexture)&&(s.arrayLayerCount=new s3(new r3(`textureNumLayers(${n})`,"u32"))),e.isTextureCube&&(s.cubeFaceCount=new s3(new r3("6u","u32")))}return r.build(this)}generateFilteredTexture(e,n,i,s,r="0u"){this._include("biquadraticTexture");const o=this.generateWrapFunction(e),l=this.generateTextureDimension(e,n,r);return s&&(i=`${i} + vec2<f32>(${s}) / ${l}`),`tsl_biquadraticTexture( ${n}, ${o}( ${i} ), ${l}, u32( ${r} ) )`}generateTextureLod(e,n,i,s,r,o="0u"){const l=this.generateWrapFunction(e),c=this.generateTextureDimension(e,n,o),u=e.is3DTexture||e.isData3DTexture?"vec3":"vec2";r&&(i=`${i} + ${u}<f32>(${r}) / ${u}<f32>( ${c} )`);const h=`${u}<u32>( ${l}( ${i} ) * ${u}<f32>( ${c} ) )`;return this.generateTextureLoad(e,n,h,o,s,null)}generateTextureLoad(e,n,i,s,r,o){s===null&&(s="0u"),o&&(i=`${i} + ${o}`);let l;return r?l=`textureLoad( ${n}, ${i}, ${r}, u32( ${s} ) )`:(l=`textureLoad( ${n}, ${i}, u32( ${s} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(l+=".x")),l}generateTextureStore(e,n,i,s,r){let o;return s?o=`textureStore( ${n}, ${i}, ${s}, ${r} )`:o=`textureStore( ${n}, ${i}, ${r} )`,o}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===ls||this.isSampleCompare(e)===!1&&e.minFilter===Mi&&e.magFilter===Mi||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,n,i,s,r,o=this.shaderStage){let l=null;return this.isUnfilterable(e)?l=this.generateTextureLod(e,n,i,s,r,"0",o):l=this._generateTextureSample(e,n,i,s,r,o),l}generateTextureGrad(e,n,i,s,r,o,l=this.shaderStage){if(l==="fragment")return o?`textureSampleGrad( ${n}, ${n}_sampler, ${i},  ${s[0]}, ${s[1]}, ${o} )`:`textureSampleGrad( ${n}, ${n}_sampler, ${i},  ${s[0]}, ${s[1]} )`;Rt(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${l} shader.`)}generateTextureCompare(e,n,i,s,r,o,l=this.shaderStage){if(l==="fragment")return e.isDepthTexture===!0&&e.isArrayTexture===!0?o?`textureSampleCompare( ${n}, ${n}_sampler, ${i}, ${r}, ${s}, ${o} )`:`textureSampleCompare( ${n}, ${n}_sampler, ${i}, ${r}, ${s} )`:o?`textureSampleCompare( ${n}, ${n}_sampler, ${i}, ${s}, ${o} )`:`textureSampleCompare( ${n}, ${n}_sampler, ${i}, ${s} )`;Rt(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${l} shader.`)}generateTextureLevel(e,n,i,s,r,o){return this.isUnfilterable(e)===!1?o?`textureSampleLevel( ${n}, ${n}_sampler, ${i}, ${s}, ${o} )`:`textureSampleLevel( ${n}, ${n}_sampler, ${i}, ${s} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,n,i,o,s):this.generateTextureLod(e,n,i,r,o,s)}generateTextureBias(e,n,i,s,r,o,l=this.shaderStage){if(l==="fragment")return o?`textureSampleBias( ${n}, ${n}_sampler, ${i}, ${s}, ${o} )`:`textureSampleBias( ${n}, ${n}_sampler, ${i}, ${s} )`;Rt(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${l} shader.`)}getPropertyName(e,n=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(n==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const i=e.name,s=e.type;return s==="texture"||s==="cubeTexture"||s==="cubeDepthTexture"||s==="storageTexture"||s==="texture3D"?i:s==="buffer"||s==="storageBuffer"||s==="indirectStorageBuffer"?this.isCustomStruct(e)?i:i+".value":e.groupNode.name+"."+i}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const n=fHe[e];return n!==void 0?(this._include(n),n):null}getNodeAccess(e,n){return n!=="compute"?e.isAtomic===!0?(yt("WebGPURenderer: Atomic operations are only supported in compute shaders."),Po.READ_WRITE):Po.READ_ONLY:e.access}getStorageAccess(e,n){return hHe[this.getNodeAccess(e,n)]}getUniformFromNode(e,n,i,s=null){const r=super.getUniformFromNode(e,n,i,s),o=this.getDataFromNode(e,i,this.globalCache);if(o.uniformGPU===void 0){let l;const c=e.groupNode,u=c.name,h=this.getBindGroupArray(u,i);if(n==="texture"||n==="cubeTexture"||n==="cubeDepthTexture"||n==="storageTexture"||n==="texture3D"){let f=null;const m=this.getNodeAccess(e,i);if(n==="texture"||n==="storageTexture"?e.value.is3DTexture===!0?f=new qO(r.name,r.node,c,m):f=new rI(r.name,r.node,c,m):n==="cubeTexture"||n==="cubeDepthTexture"?f=new coe(r.name,r.node,c,m):n==="texture3D"&&(f=new qO(r.name,r.node,c,m)),f.store=e.isStorageTextureNode===!0,f.mipLevel=f.store?e.mipLevel:0,f.setVisibility(uC[i]),this.isUnfilterable(e.value)===!1&&f.store===!1){const A=new Zqe(`${r.name}_sampler`,r.node,c);A.setVisibility(uC[i]),h.push(A,f),l=[A,f]}else h.push(f),l=[f]}else if(n==="buffer"||n==="storageBuffer"||n==="indirectStorageBuffer"){const f=this.getSharedDataFromNode(e);let m=f.buffer;if(m===void 0){const A=n==="buffer"?roe:nHe;m=new A(e,c),f.buffer=m}m.setVisibility(m.getVisibility()|uC[i]),h.push(m),l=m,r.name=s||"NodeBuffer_"+r.id}else{const f=this.uniformGroups[i]||(this.uniformGroups[i]={});let m=f[u];m===void 0&&(m=new ooe(u,c),m.setVisibility(uC[i]),f[u]=m,h.push(m)),l=this.getNodeUniform(r,n),m.addUniform(l)}o.uniformGPU=l}return r}getBuiltin(e,n,i,s=this.shaderStage){const r=this.builtins[s]||(this.builtins[s]=new Map);return r.has(e)===!1&&r.set(e,{name:e,property:n,type:i}),n}hasBuiltin(e,n=this.shaderStage){return this.builtins[n]!==void 0&&this.builtins[n].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const n=e.layout,i=this.flowShaderNode(e),s=[];for(const o of n.inputs)s.push(o.name+" : "+this.getType(o.type));let r=`fn ${n.name}( ${s.join(", ")} ) -> ${this.getType(n.type)} {
${i.vars}
${i.code}
`;return i.result&&(r+=`	return ${i.result};
`),r+=`
}
`,r}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,n=this.shaderStage){(this.directives[n]||(this.directives[n]=new Set)).add(e)}getDirectives(e){const n=[],i=this.directives[e];if(i!==void 0)for(const s of i)n.push(`enable ${s};`);return n.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const n=[],i=this.builtins[e];if(i!==void 0)for(const{name:s,property:r,type:o}of i.values())n.push(`@builtin( ${s} ) ${r} : ${o}`);return n.join(`,
	`)}getScopedArray(e,n,i,s){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:n,bufferType:i,bufferCount:s}),e}getScopedArrays(e){if(e!=="compute")return;const n=[];for(const{name:i,scope:s,bufferType:r,bufferCount:o}of this.scopedArrays.values()){const l=this.getType(r);n.push(`var<${s}> ${i}: array< ${l}, ${o} >;`)}return n.join(`
`)}getAttributes(e){const n=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const i=this.getBuiltins("attribute");i&&n.push(i);const s=this.getAttributesArray();for(let r=0,o=s.length;r<o;r++){const l=s[r],c=l.name,u=this.getType(l.type);n.push(`@location( ${r} ) ${c} : ${u}`)}}return n.join(`,
	`)}getStructMembers(e){const n=[];for(const i of e.members){const s=e.output?"@location( "+i.index+" ) ":"";let r=this.getType(i.type);i.atomic&&(r="atomic< "+r+" >"),n.push(`	${s+i.name} : ${r}`)}return e.output&&n.push(`	${this.getBuiltins("output")}`),n.join(`,
`)}getStructs(e){let n="";const i=this.structs[e];if(i.length>0){const s=[];for(const r of i){let o=`struct ${r.name} {
`;o+=this.getStructMembers(r),o+=`
};`,s.push(o)}n=`
`+s.join(`

`)+`
`}return n}getVar(e,n,i=null){let s=`var ${n} : `;return i!==null?s+=this.generateArrayDeclaration(e,i):s+=this.getType(e),s}getVars(e){const n=[],i=this.vars[e];if(i!==void 0)for(const s of i)n.push(`	${this.getVar(s.type,s.name,s.count)};`);return`
${n.join(`
`)}
`}getVaryings(e){const n=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const r=this.varyings,o=this.vars[e];for(let l=0;l<r.length;l++){const c=r[l];if(c.needsInterpolation){let u=`@location( ${l} )`;if(c.interpolationType){const h=c.interpolationSampling!==null?`, ${c.interpolationSampling} )`:" )";u+=` @interpolate( ${c.interpolationType}${h}`}else/^(int|uint|ivec|uvec)/.test(c.type)&&(u+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);n.push(`${u} ${c.name} : ${this.getType(c.type)}`)}else e==="vertex"&&o.includes(c)===!1&&o.push(c)}}const i=this.getBuiltins(e);i&&n.push(i);const s=n.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+s):s}isCustomStruct(e){const n=e.value,i=e.node,s=(n.isBufferAttribute||n.isInstancedBufferAttribute)&&i.structTypeNode!==null,r=i.value&&i.value.array&&typeof i.value.itemSize=="number"&&i.value.array.length>i.value.itemSize;return s&&!r}getUniforms(e){const n=this.uniforms[e],i=[],s=[],r=[],o={};for(const c of n){const u=c.groupNode.name,h=this.bindingsIndexes[u];if(c.type==="texture"||c.type==="cubeTexture"||c.type==="cubeDepthTexture"||c.type==="storageTexture"||c.type==="texture3D"){const f=c.node.value;this.isUnfilterable(f)===!1&&c.node.isStorageTextureNode!==!0&&(this.isSampleCompare(f)?i.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var ${c.name}_sampler : sampler_comparison;`):i.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var ${c.name}_sampler : sampler;`));let m,A="";const{primarySamples:x}=this.renderer.backend.utils.getTextureSampleData(f);if(x>1&&(A="_multisampled"),f.isCubeTexture===!0&&f.isDepthTexture===!0)m="texture_depth_cube";else if(f.isCubeTexture===!0)m="texture_cube<f32>";else if(f.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&f.compareFunction===null?m=`texture${A}_2d<f32>`:m=`texture_depth${A}_2d${f.isArrayTexture===!0?"_array":""}`;else if(c.node.isStorageTextureNode===!0){const T=WO(f),E=this.getStorageAccess(c.node,e),M=c.node.value.is3DTexture,N=c.node.value.isArrayTexture;m=`texture_storage_${M?"3d":`2d${N?"_array":""}`}<${T}, ${E}>`}else if(f.isArrayTexture===!0||f.isDataArrayTexture===!0||f.isCompressedArrayTexture===!0)m="texture_2d_array<f32>";else if(f.is3DTexture===!0||f.isData3DTexture===!0)m="texture_3d<f32>";else{const T=this.getComponentTypeFromTexture(f).charAt(0);m=`texture${A}_2d<${T}32>`}i.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var ${c.name} : ${m};`)}else if(c.type==="buffer"||c.type==="storageBuffer"||c.type==="indirectStorageBuffer"){const f=c.node,m=this.getType(f.getNodeType(this)),A=f.bufferCount,x=A>0&&c.type==="buffer"?", "+A:"",T=f.isStorageBufferNode?`storage, ${this.getStorageAccess(f,e)}`:"uniform";if(this.isCustomStruct(c))s.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var<${T}> ${c.name} : ${m};`);else{const M=`	value : array< ${f.isAtomic?`atomic<${m}>`:`${m}`}${x} >`;s.push(this._getWGSLStructBinding(c.name,M,T,h.binding++,h.group))}}else{const f=this.getType(this.getVectorType(c.type)),m=c.groupNode.name;(o[m]||(o[m]={index:h.binding++,id:h.group,snippets:[]})).snippets.push(`	${c.name} : ${f}`)}}for(const c in o){const u=o[c];r.push(this._getWGSLStructBinding(c,u.snippets.join(`,
`),"uniform",u.index,u.id))}return[...i,...s,...r].join(`
`)}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const n in e){this.shaderStage=n;const i=e[n];i.uniforms=this.getUniforms(n),i.attributes=this.getAttributes(n),i.varyings=this.getVaryings(n),i.structs=this.getStructs(n),i.vars=this.getVars(n),i.codes=this.getCodes(n),i.directives=this.getDirectives(n),i.scopedArrays=this.getScopedArrays(n);let s=`// code

`;s+=this.flowCode[n];const r=this.flowNodes[n],o=r[r.length-1],l=o.outputNode,c=l!==void 0&&l.isOutputStructNode===!0;for(const u of r){const h=this.getFlowData(u),f=u.name;if(f&&(s.length>0&&(s+=`
`),s+=`	// flow -> ${f}
`),s+=`${h.code}
	`,u===o&&n!=="compute"){if(s+=`// result

	`,n==="vertex")s+=`varyings.Vertex = ${h.result};`;else if(n==="fragment")if(c)i.returnType=l.getNodeType(this),i.structs+="var<private> output : "+i.returnType+";",s+=`return ${h.result};`;else{let m="	@location(0) color: vec4<f32>";const A=this.getBuiltins("output");A&&(m+=`,
	`+A),i.returnType="OutputStruct",i.structs+=this._getWGSLStruct("OutputStruct",m),i.structs+=`
var<private> output : OutputStruct;`,s+=`output.color = ${h.result};

	return output;`}}}i.flow=s}if(this.shaderStage=null,this.material!==null)this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment);else{const n=this.object.workgroupSize;this.computeShader=this._getWGSLComputeCode(e.compute,n)}}getMethod(e,n=null){let i;return n!==null&&(i=this._getWGSLMethod(e+"_"+n)),i===void 0&&(i=this._getWGSLMethod(e)),i||e}getBitcastMethod(e){return`bitcast<${this.getType(e)}>`}getFloatPackingMethod(e){return this.getMethod(`floatpack_${e}_2x16`)}getFloatUnpackingMethod(e){return this.getMethod(`floatunpack_${e}_2x16`)}getTernary(e,n,i){return`select( ${i}, ${n}, ${e} )`}getType(e){return pHe[e]||e}isAvailable(e){let n=oY[e];return n===void 0&&(e==="float32Filterable"?n=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(n=this.renderer.hasFeature("clip-distances")),oY[e]=n),n}_getWGSLMethod(e){return S2[e]!==void 0&&this._include(e),mHe[e]}_include(e){const n=S2[e];return n.build(this),this.addInclude(n),n}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${hoe}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,n){const[i,s,r]=n;return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${i}, ${s}, ${r} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x
		+ globalId.y * ( ${i} * numWorkgroups.x )
		+ globalId.z * ( ${i} * numWorkgroups.x ) * ( ${s} * numWorkgroups.y );

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,n){return`
struct ${e} {
${n}
};`}_getWGSLStructBinding(e,n,i,s=0,r=0){const o=e+"Struct";return`${this._getWGSLStruct(o,n)}
@binding( ${s} ) @group( ${r} )
var<${i}> ${e} : ${o};`}}class AHe{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let n;return e.depthTexture!==null?n=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?n=We.Depth24PlusStencil8:e.depth&&(n=We.Depth24Plus),n}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let n;if(e.isFramebufferTexture)n=1;else if(e.isDepthTexture&&!e.renderTarget){const r=this.backend.renderer,o=r.getRenderTarget();n=o?o.samples:r.currentSamples}else e.renderTarget&&(n=e.renderTarget.samples);n=n||1;const i=n>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:n,primarySamples:i?1:n,isMSAA:i}}getCurrentColorFormat(e){let n;return e.textures!==null?n=this.getTextureFormatGPU(e.textures[0]):n=this.getPreferredCanvasFormat(),n}getCurrentColorFormats(e){return e.textures!==null?e.textures.map(n=>this.getTextureFormatGPU(n)):[this.getPreferredCanvasFormat()]}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,n){if(e.isPoints)return u_.PointList;if(e.isLineSegments||e.isMesh&&n.wireframe===!0)return u_.LineList;if(e.isLine)return u_.LineStrip;if(e.isMesh)return u_.TriangleList}getSampleCount(e){return e>=4?4:1}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.currentSamples)}getPreferredCanvasFormat(){const n=this.backend.parameters.outputType;if(n===void 0)return navigator.gpu.getPreferredCanvasFormat();if(n===os)return We.BGRA8Unorm;if(n===cs)return We.RGBA16Float;throw new Error("Unsupported output buffer type.")}}const foe=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]);typeof Float16Array<"u"&&foe.set(Float16Array,["float16"]);const yHe=new Map([[sj,["float16"]]]),vHe=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class _He{constructor(e){this.backend=e}createAttribute(e,n){const i=this._getBufferAttribute(e),s=this.backend,r=s.get(i);let o=r.buffer;if(o===void 0){const l=s.device;let c=i.array;if(e.normalized===!1){if(c.constructor===Int16Array||c.constructor===Int8Array)c=new Int32Array(c);else if((c.constructor===Uint16Array||c.constructor===Uint8Array)&&(c=new Uint32Array(c),n&GPUBufferUsage.INDEX))for(let f=0;f<c.length;f++)c[f]===65535&&(c[f]=4294967295)}if(i.array=c,(i.isStorageBufferAttribute||i.isStorageInstancedBufferAttribute)&&i.itemSize===3){c=new c.constructor(i.count*4);for(let f=0;f<i.count;f++)c.set(i.array.subarray(f*3,f*3+3),f*4);i.itemSize=4,i.array=c,r._force3to4BytesAlignment=!0}const u=c.byteLength,h=u+(4-u%4)%4;o=l.createBuffer({label:i.name,size:h,usage:n,mappedAtCreation:!0}),new c.constructor(o.getMappedRange()).set(c),o.unmap(),r.buffer=o}}updateAttribute(e){const n=this._getBufferAttribute(e),i=this.backend,s=i.device,r=i.get(n),o=i.get(n).buffer;let l=n.array;if(r._force3to4BytesAlignment===!0){l=new l.constructor(n.count*4);for(let u=0;u<n.count;u++)l.set(n.array.subarray(u*3,u*3+3),u*4);n.array=l}const c=n.updateRanges;if(c.length===0)s.queue.writeBuffer(o,0,l,0);else{const u=ax(l),h=u?1:l.BYTES_PER_ELEMENT;for(let f=0,m=c.length;f<m;f++){const A=c[f];let x,T;if(r._force3to4BytesAlignment===!0){const M=Math.floor(A.start/3),N=Math.ceil(A.count/3);x=M*4*h,T=N*4*h}else x=A.start*h,T=A.count*h;const E=x*(u?l.BYTES_PER_ELEMENT:1);s.queue.writeBuffer(o,E,l,x,T)}n.clearUpdateRanges()}}createShaderVertexBuffers(e){const n=e.getAttributes(),i=new Map;for(let s=0;s<n.length;s++){const r=n[s],o=r.array.BYTES_PER_ELEMENT,l=this._getBufferAttribute(r);let c=i.get(l);if(c===void 0){let f,m;r.isInterleavedBufferAttribute===!0?(f=r.data.stride*o,m=r.data.isInstancedInterleavedBuffer?cC.Instance:cC.Vertex):(f=r.itemSize*o,m=r.isInstancedBufferAttribute?cC.Instance:cC.Vertex),r.normalized===!1&&(r.array.constructor===Int16Array||r.array.constructor===Uint16Array)&&(f=4),c={arrayStride:f,attributes:[],stepMode:m},i.set(l,c)}const u=this._getVertexFormat(r),h=r.isInterleavedBufferAttribute===!0?r.offset*o:0;c.attributes.push({shaderLocation:s,offset:h,format:u})}return Array.from(i.values())}destroyAttribute(e){const n=this.backend;n.get(this._getBufferAttribute(e)).buffer.destroy(),n.delete(e)}async getArrayBufferAsync(e){const n=this.backend,i=n.device,r=n.get(this._getBufferAttribute(e)).buffer,o=r.size,l=i.createBuffer({label:`${e.name}_readback`,size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),c=i.createCommandEncoder({label:`readback_encoder_${e.name}`});c.copyBufferToBuffer(r,0,l,0,o);const u=c.finish();i.queue.submit([u]),await l.mapAsync(GPUMapMode.READ);const h=l.getMappedRange(),f=new e.array.constructor(h.slice(0));return l.unmap(),f.buffer}_getVertexFormat(e){const{itemSize:n,normalized:i}=e,s=e.array.constructor,r=e.constructor;let o;if(n===1)o=vHe.get(s);else{const c=(yHe.get(r)||foe.get(s))[i?1:0];if(c){const u=s.BYTES_PER_ELEMENT*n,f=Math.floor((u+3)/4)*4/s.BYTES_PER_ELEMENT;if(f%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");o=`${c}x${f}`}}return o||Rt("WebGPUAttributeUtils: Vertex format not supported yet."),o}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class xHe{constructor(e){this.layoutGPU=e,this.usedTimes=0}}class bHe{constructor(e){this.backend=e,this._bindGroupLayoutCache=new Map}createBindingsLayout(e){const n=this.backend,i=n.device,s=n.get(e);if(s.layout)return s.layout.layoutGPU;const r=this._createLayoutEntries(e),o=JSON.stringify(r);let l=this._bindGroupLayoutCache.get(o);return l===void 0&&(l=new xHe(i.createBindGroupLayout({entries:r})),this._bindGroupLayoutCache.set(o,l)),l.usedTimes++,s.layout=l,s.layoutKey=o,l.layoutGPU}createBindings(e,n,i,s=0){const{backend:r}=this,o=r.get(e),l=this.createBindingsLayout(e);let c;i>0&&(o.groups===void 0&&(o.groups=[],o.versions=[]),o.versions[i]===s&&(c=o.groups[i])),c===void 0&&(c=this.createBindGroup(e,l),i>0&&(o.groups[i]=c,o.versions[i]=s)),o.group=c}updateBinding(e){const n=this.backend,i=n.device,s=e.buffer,r=n.get(e).buffer,o=e.updateRanges;if(o.length===0)i.queue.writeBuffer(r,0,s,0);else{const l=ax(s),c=l?1:s.BYTES_PER_ELEMENT;for(let u=0,h=o.length;u<h;u++){const f=o[u],m=f.start*c,A=f.count*c,x=m*(l?s.BYTES_PER_ELEMENT:1);i.queue.writeBuffer(r,x,s,m,A)}e.clearUpdateRanges()}}createBindGroupIndex(e,n){const s=this.backend.device,r=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,o=e[0],l=s.createBuffer({label:"bindingCameraIndex_"+o,size:16,usage:r});s.queue.writeBuffer(l,0,e,0);const c=[{binding:0,resource:{buffer:l}}];return s.createBindGroup({label:"bindGroupCameraIndex_"+o,layout:n,entries:c})}createBindGroup(e,n){const i=this.backend,s=i.device;let r=0;const o=[];for(const l of e.bindings){if(l.isUniformBuffer){const c=i.get(l);if(c.buffer===void 0){const u=l.byteLength,h=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,f=[];l.visibility&YA.VERTEX&&f.push("vertex"),l.visibility&YA.FRAGMENT&&f.push("fragment"),l.visibility&YA.COMPUTE&&f.push("compute");const m=`(${f.join(",")})`,A=s.createBuffer({label:`bindingBuffer${l.id}_${l.name}_${m}`,size:u,usage:h});c.buffer=A}o.push({binding:r,resource:{buffer:c.buffer}})}else if(l.isStorageBuffer){const c=i.get(l);if(c.buffer===void 0){const u=l.attribute;c.buffer=i.get(u).buffer}o.push({binding:r,resource:{buffer:c.buffer}})}else if(l.isSampledTexture){const c=i.get(l.texture);let u;if(c.externalTexture!==void 0)u=s.importExternalTexture({source:c.externalTexture});else{const h=l.store?1:c.texture.mipLevelCount,f=l.store?l.mipLevel:0;let m=`view-${c.texture.width}-${c.texture.height}`;if(c.texture.depthOrArrayLayers>1&&(m+=`-${c.texture.depthOrArrayLayers}`),m+=`-${h}-${f}`,u=c[m],u===void 0){const A=Jqe.All;let x;l.isSampledCubeTexture?x=vr.Cube:l.isSampledTexture3D?x=vr.ThreeD:l.texture.isArrayTexture||l.texture.isDataArrayTexture||l.texture.isCompressedArrayTexture?x=vr.TwoDArray:x=vr.TwoD,u=c[m]=c.texture.createView({aspect:A,dimension:x,mipLevelCount:h,baseMipLevel:f})}}o.push({binding:r,resource:u})}else if(l.isSampler){const c=i.get(l.texture);o.push({binding:r,resource:c.sampler})}r++}return s.createBindGroup({label:"bindGroup_"+e.name,layout:n,entries:o})}_createLayoutEntries(e){const n=[];let i=0;for(const s of e.bindings){const r=this.backend,o={binding:i,visibility:s.visibility};if(s.isUniformBuffer||s.isStorageBuffer){const l={};s.isStorageBuffer&&(s.visibility&YA.COMPUTE&&(s.access===Po.READ_WRITE||s.access===Po.WRITE_ONLY)?l.type=J5.Storage:l.type=J5.ReadOnlyStorage),o.buffer=l}else if(s.isSampledTexture&&s.store){const l={};l.format=this.backend.get(s.texture).texture.format;const c=s.access;c===Po.READ_WRITE?l.access=Z5.ReadWrite:c===Po.WRITE_ONLY?l.access=Z5.WriteOnly:l.access=Z5.ReadOnly,s.texture.isArrayTexture?l.viewDimension=vr.TwoDArray:s.texture.is3DTexture&&(l.viewDimension=vr.ThreeD),o.storageTexture=l}else if(s.isSampledTexture){const l={},{primarySamples:c}=r.utils.getTextureSampleData(s.texture);if(c>1&&(l.multisampled=!0,s.texture.isDepthTexture||(l.sampleType=TA.UnfilterableFloat)),s.texture.isDepthTexture)r.compatibilityMode&&s.texture.compareFunction===null?l.sampleType=TA.UnfilterableFloat:l.sampleType=TA.Depth;else if(s.texture.isDataTexture||s.texture.isDataArrayTexture||s.texture.isData3DTexture){const u=s.texture.type;u===jr?l.sampleType=TA.SInt:u===Ei?l.sampleType=TA.UInt:u===ls&&(this.backend.hasFeature("float32-filterable")?l.sampleType=TA.Float:l.sampleType=TA.UnfilterableFloat)}s.isSampledCubeTexture?l.viewDimension=vr.Cube:s.texture.isArrayTexture||s.texture.isDataArrayTexture||s.texture.isCompressedArrayTexture?l.viewDimension=vr.TwoDArray:s.isSampledTexture3D&&(l.viewDimension=vr.ThreeD),o.texture=l}else if(s.isSampler){const l={};s.texture.isDepthTexture&&(s.texture.compareFunction!==null?l.type=nY.Comparison:r.compatibilityMode&&(l.type=nY.NonFiltering)),o.sampler=l}else Rt(`WebGPUBindingUtils: Unsupported binding "${s}".`);n.push(o),i++}return n}deleteBindGroupData(e){const{backend:n}=this,i=n.get(e);i.layout&&(i.layout.usedTimes--,i.layout.usedTimes===0&&this._bindGroupLayoutCache.delete(i.layoutKey),i.layout=void 0,i.layoutKey=void 0)}dispose(){this._bindGroupLayoutCache.clear()}}class SHe{constructor(e){this.backend=e,this._activePipelines=new WeakMap}setPipeline(e,n){this._activePipelines.get(e)!==n&&(e.setPipeline(n),this._activePipelines.set(e,n))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,n){const{object:i,material:s,geometry:r,pipeline:o}=e,{vertexProgram:l,fragmentProgram:c}=o,u=this.backend,h=u.device,f=u.utils,m=u.get(o),A=[];for(const H of e.getBindings()){const X=u.get(H),{layoutGPU:ne}=X.layout;A.push(ne)}const x=u.attributeUtils.createShaderVertexBuffers(e);let T;s.blending!==hl&&(s.blending!==fl||s.transparent!==!1)&&(T=this._getBlending(s));let E={};s.stencilWrite===!0&&(E={compare:this._getStencilCompare(s),failOp:this._getStencilOperation(s.stencilFail),depthFailOp:this._getStencilOperation(s.stencilZFail),passOp:this._getStencilOperation(s.stencilZPass)});const M=this._getColorWriteMask(s),N=[];if(e.context.textures!==null){const H=e.context.textures;for(let X=0;X<H.length;X++){const ne=f.getTextureFormatGPU(H[X]);X===0?N.push({format:ne,blend:T,writeMask:M}):N.push({format:ne,writeMask:M})}}else{const H=f.getCurrentColorFormat(e.context);N.push({format:H,blend:T,writeMask:M})}const I=u.get(l).module,F=u.get(c).module,G=this._getPrimitiveState(i,r,s),O=this._getDepthCompare(s),D=f.getCurrentDepthStencilFormat(e.context),j=this._getSampleCount(e.context),L={label:`renderPipeline_${s.name||s.type}_${s.id}`,vertex:Object.assign({},I,{buffers:x}),fragment:Object.assign({},F,{targets:N}),primitive:G,multisample:{count:j,alphaToCoverageEnabled:s.alphaToCoverage&&j>1},layout:h.createPipelineLayout({bindGroupLayouts:A})},U={},q=e.context.depth,K=e.context.stencil;if((q===!0||K===!0)&&(q===!0&&(U.format=D,U.depthWriteEnabled=s.depthWrite,U.depthCompare=O),K===!0&&(U.stencilFront=E,U.stencilBack={},U.stencilReadMask=s.stencilFuncMask,U.stencilWriteMask=s.stencilWriteMask),s.polygonOffset===!0&&(U.depthBias=s.polygonOffsetUnits,U.depthBiasSlopeScale=s.polygonOffsetFactor,U.depthBiasClamp=0),L.depthStencil=U),h.pushErrorScope("validation"),n===null)m.pipeline=h.createRenderPipeline(L),h.popErrorScope().then(H=>{H!==null&&(m.error=!0,Rt(H.message))});else{const H=new Promise(async X=>{try{m.pipeline=await h.createRenderPipelineAsync(L)}catch{}const ne=await h.popErrorScope();ne!==null&&(m.error=!0,Rt(ne.message)),X()});n.push(H)}}createBundleEncoder(e,n="renderBundleEncoder"){const i=this.backend,{utils:s,device:r}=i,o=s.getCurrentDepthStencilFormat(e),l=s.getCurrentColorFormats(e),c=this._getSampleCount(e),u={label:n,colorFormats:l,depthStencilFormat:o,sampleCount:c};return r.createRenderBundleEncoder(u)}createComputePipeline(e,n){const i=this.backend,s=i.device,r=i.get(e.computeProgram).module,o=i.get(e),l=[];for(const c of n){const u=i.get(c),{layoutGPU:h}=u.layout;l.push(h)}o.pipeline=s.createComputePipeline({compute:r,layout:s.createPipelineLayout({bindGroupLayouts:l})})}_getBlending(e){let n,i;const s=e.blending,r=e.blendSrc,o=e.blendDst,l=e.blendEquation;if(s===QA){const c=e.blendSrcAlpha!==null?e.blendSrcAlpha:r,u=e.blendDstAlpha!==null?e.blendDstAlpha:o,h=e.blendEquationAlpha!==null?e.blendEquationAlpha:l;n={srcFactor:this._getBlendFactor(r),dstFactor:this._getBlendFactor(o),operation:this._getBlendOperation(l)},i={srcFactor:this._getBlendFactor(c),dstFactor:this._getBlendFactor(u),operation:this._getBlendOperation(h)}}else{const c=e.premultipliedAlpha,u=(h,f,m,A)=>{n={srcFactor:h,dstFactor:f,operation:SA.Add},i={srcFactor:m,dstFactor:A,operation:SA.Add}};if(c)switch(s){case fl:u(ti.One,ti.OneMinusSrcAlpha,ti.One,ti.OneMinusSrcAlpha);break;case xy:u(ti.One,ti.One,ti.One,ti.One);break;case by:u(ti.Zero,ti.OneMinusSrc,ti.Zero,ti.One);break;case Sy:u(ti.Dst,ti.OneMinusSrcAlpha,ti.Zero,ti.One);break}else switch(s){case fl:u(ti.SrcAlpha,ti.OneMinusSrcAlpha,ti.One,ti.OneMinusSrcAlpha);break;case xy:u(ti.SrcAlpha,ti.One,ti.One,ti.One);break;case by:Rt("WebGPURenderer: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Sy:Rt("WebGPURenderer: MultiplyBlending requires material.premultipliedAlpha = true");break}}if(n!==void 0&&i!==void 0)return{color:n,alpha:i};Rt("WebGPURenderer: Invalid blending: ",s)}_getBlendFactor(e){let n;switch(e){case Oh:n=ti.Zero;break;case EP:n=ti.One;break;case MP:n=ti.Src;break;case CP:n=ti.OneMinusSrc;break;case q_:n=ti.SrcAlpha;break;case H_:n=ti.OneMinusSrcAlpha;break;case PP:n=ti.Dst;break;case IP:n=ti.OneMinusDst;break;case NP:n=ti.DstAlpha;break;case RP:n=ti.OneMinusDstAlpha;break;case LP:n=ti.SrcAlphaSaturated;break;case m7e:n=ti.Constant;break;case g7e:n=ti.OneMinusConstant;break;default:Rt("WebGPURenderer: Blend factor not supported.",e)}return n}_getStencilCompare(e){let n;const i=e.stencilFunc;switch(i){case mee:n=xo.Never;break;case CN:n=xo.Always;break;case gee:n=xo.Less;break;case yee:n=xo.LessEqual;break;case Aee:n=xo.Equal;break;case xee:n=xo.GreaterEqual;break;case vee:n=xo.Greater;break;case _ee:n=xo.NotEqual;break;default:Rt("WebGPURenderer: Invalid stencil function.",i)}return n}_getStencilOperation(e){let n;switch(e){case Tg:n=gg.Keep;break;case lee:n=gg.Zero;break;case cee:n=gg.Replace;break;case pee:n=gg.Invert;break;case uee:n=gg.IncrementClamp;break;case dee:n=gg.DecrementClamp;break;case hee:n=gg.IncrementWrap;break;case fee:n=gg.DecrementWrap;break;default:Rt("WebGPURenderer: Invalid stencil operation.",n)}return n}_getBlendOperation(e){let n;switch(e){case Co:n=SA.Add;break;case TP:n=SA.Subtract;break;case wP:n=SA.ReverseSubtract;break;case KF:n=SA.Min;break;case YF:n=SA.Max;break;default:Rt("WebGPUPipelineUtils: Blend equation not supported.",e)}return n}_getPrimitiveState(e,n,i){const s={},r=this.backend.utils;s.topology=r.getPrimitiveTopology(e,i),n.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(s.stripIndexFormat=n.index.array instanceof Uint16Array?Ax.Uint16:Ax.Uint32);let o=i.side===Di;return e.isMesh&&e.matrixWorld.determinant()<0&&(o=!o),s.frontFace=o===!0?ZK.CW:ZK.CCW,s.cullMode=i.side===er?eY.None:eY.Back,s}_getColorWriteMask(e){return e.colorWrite===!0?tY.All:tY.None}_getDepthCompare(e){let n;if(e.depthTest===!1)n=xo.Always;else{const i=e.depthFunc;switch(i){case W_:n=xo.Never;break;case $_:n=xo.Always;break;case K_:n=xo.Less;break;case gm:n=xo.LessEqual;break;case Y_:n=xo.Equal;break;case X_:n=xo.GreaterEqual;break;case Q_:n=xo.Greater;break;case J_:n=xo.NotEqual;break;default:Rt("WebGPUPipelineUtils: Invalid depth function.",i)}}return n}}class THe extends doe{constructor(e,n,i=2048){super(i),this.device=e,this.type=n,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${n}`});const s=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${n}`,size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${n}`,size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return ji(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const n=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e,n),n}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),n=this.currentQueryIndex,i=n*8;this.currentQueryIndex=0,this.queryOffsets.clear();const s=this.device.createCommandEncoder();s.resolveQuerySet(this.querySet,0,n,this.resolveBuffer,0),s.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,i);const r=s.finish();if(this.device.queue.submit([r]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,i),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const o=new BigUint64Array(this.resultBuffer.getMappedRange(0,i)),l={},c=[];for(const[h,f]of e){const m=h.match(/^(.*):f(\d+)$/),A=parseInt(m[2]);c.includes(A)===!1&&c.push(A),l[A]===void 0&&(l[A]=0);const x=o[f],T=o[f+1],E=Number(T-x)/1e6;this.timestamps.set(h,E),l[A]+=E}const u=l[c[c.length-1]];return this.resultBuffer.unmap(),this.lastValue=u,this.frames=c,u}catch(e){return Rt("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){Rt("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){Rt("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class wHe extends uoe{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.defaultRenderPassdescriptor=null,this.utils=new AHe(this),this.attributeUtils=new _He(this),this.bindingUtils=new bHe(this),this.pipelineUtils=new SHe(this),this.textureUtils=new rHe(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const n=this.parameters;let i;if(n.device===void 0){const s={powerPreference:n.powerPreference,featureLevel:n.compatibilityMode?"compatibility":void 0},r=typeof navigator<"u"?await navigator.gpu.requestAdapter(s):null;if(r===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const o=Object.values(HO),l=[];for(const u of o)r.features.has(u)&&l.push(u);const c={requiredFeatures:l,requiredLimits:n.requiredLimits};i=await r.requestDevice(c)}else i=n.device;i.lost.then(s=>{if(s.reason==="destroyed")return;const r={api:"WebGPU",message:s.message||"Unknown reason",reason:s.reason||null,originalEvent:s};e.onDeviceLost(r)}),this.device=i,this.trackTimestamp=this.trackTimestamp&&this.hasFeature(HO.TimestampQuery),this.updateSize()}get context(){const e=this.renderer.getCanvasTarget(),n=this.get(e);let i=n.context;if(i===void 0){const s=this.parameters;e.isDefaultCanvasTarget===!0&&s.context!==void 0?i=s.context:i=e.domElement.getContext("webgpu"),"setAttribute"in e.domElement&&e.domElement.setAttribute("data-engine",`three.js r${w0} webgpu`);const r=s.alpha?"premultiplied":"opaque",o=s.outputType===cs?"extended":"standard";i.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:r,toneMapping:{mode:o}}),n.context=i}return i}get coordinateSystem(){return bc}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){const e=this.renderer,n=e.getCanvasTarget(),i=this.get(n),s=e.currentSamples;let r=i.descriptor;if(r===void 0||i.samples!==s){r={colorAttachments:[{view:null}]},(e.depth===!0||e.stencil===!0)&&(r.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(e.depth,e.stencil).createView()});const l=r.colorAttachments[0];s>0?l.view=this.textureUtils.getColorBuffer().createView():l.resolveTarget=void 0,i.descriptor=r,i.samples=s}const o=r.colorAttachments[0];return s>0?o.resolveTarget=this.context.getCurrentTexture().createView():o.view=this.context.getCurrentTexture().createView(),r}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,n={}){const i=e.renderTarget,s=this.get(i);let r=s.descriptors;(r===void 0||s.width!==i.width||s.height!==i.height||s.samples!==i.samples)&&(r={},s.descriptors=r);const o=e.getCacheKey();let l=r[o];if(l===void 0){const u=e.textures,h=[];let f;const m=this._isRenderCameraDepthArray(e);for(let A=0;A<u.length;A++){const x=this.get(u[A]),T={label:`colorAttachment_${A}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:vr.TwoD};if(i.isRenderTarget3D)f=e.activeCubeFace,T.baseArrayLayer=0,T.dimension=vr.ThreeD,T.depthOrArrayLayers=u[A].image.depth;else if(i.isRenderTarget&&u[A].image.depth>1)if(m===!0){const E=e.camera.cameras;for(let M=0;M<E.length;M++){const N={...T,baseArrayLayer:M,arrayLayerCount:1,dimension:vr.TwoD},I=x.texture.createView(N);h.push({view:I,resolveTarget:void 0,depthSlice:void 0})}}else T.dimension=vr.TwoDArray,T.depthOrArrayLayers=u[A].image.depth;if(m!==!0){const E=x.texture.createView(T);let M,N;x.msaaTexture!==void 0?(M=x.msaaTexture.createView(),N=E):(M=E,N=void 0),h.push({view:M,resolveTarget:N,depthSlice:f})}}if(l={textureViews:h},e.depth){const A=this.get(e.depthTexture),x={};(e.depthTexture.isArrayTexture||e.depthTexture.isCubeTexture)&&(x.dimension=vr.TwoD,x.arrayLayerCount=1,x.baseArrayLayer=e.activeCubeFace),l.depthStencilView=A.texture.createView(x)}r[o]=l,s.width=i.width,s.height=i.height,s.samples=i.samples,s.activeMipmapLevel=e.activeMipmapLevel,s.activeCubeFace=e.activeCubeFace}const c={colorAttachments:[]};for(let u=0;u<l.textureViews.length;u++){const h=l.textureViews[u];let f={r:0,g:0,b:0,a:1};u===0&&n.clearValue&&(f=n.clearValue),c.colorAttachments.push({view:h.view,depthSlice:h.depthSlice,resolveTarget:h.resolveTarget,loadOp:n.loadOp||Ri.Load,storeOp:n.storeOp||Tl.Store,clearValue:f})}return l.depthStencilView&&(c.depthStencilAttachment={view:l.depthStencilView}),c}beginRender(e){const n=this.get(e),i=this.device,s=e.occlusionQueryCount;let r;s>0&&(n.currentOcclusionQuerySet&&n.currentOcclusionQuerySet.destroy(),n.currentOcclusionQueryBuffer&&n.currentOcclusionQueryBuffer.destroy(),n.currentOcclusionQuerySet=n.occlusionQuerySet,n.currentOcclusionQueryBuffer=n.occlusionQueryBuffer,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,r=i.createQuerySet({type:"occlusion",count:s,label:`occlusionQuerySet_${e.id}`}),n.occlusionQuerySet=r,n.occlusionQueryIndex=0,n.occlusionQueryObjects=new Array(s),n.lastOcclusionObject=null);let o;e.textures===null?o=this._getDefaultRenderPassDescriptor():o=this._getRenderPassDescriptor(e,{loadOp:Ri.Load}),this.initTimestampQuery(Fd.RENDER,this.getTimestampUID(e),o),o.occlusionQuerySet=r;const l=o.depthStencilAttachment;if(e.textures!==null){const u=o.colorAttachments;for(let h=0;h<u.length;h++){const f=u[h];e.clearColor?(f.clearValue=h===0?e.clearColorValue:{r:0,g:0,b:0,a:1},f.loadOp=Ri.Clear):f.loadOp=Ri.Load,f.storeOp=Tl.Store}}else{const u=o.colorAttachments[0];e.clearColor?(u.clearValue=e.clearColorValue,u.loadOp=Ri.Clear):u.loadOp=Ri.Load,u.storeOp=Tl.Store}e.depth&&(e.clearDepth?(l.depthClearValue=e.clearDepthValue,l.depthLoadOp=Ri.Clear):l.depthLoadOp=Ri.Load,l.depthStoreOp=Tl.Store),e.stencil&&(e.clearStencil?(l.stencilClearValue=e.clearStencilValue,l.stencilLoadOp=Ri.Clear):l.stencilLoadOp=Ri.Load,l.stencilStoreOp=Tl.Store);const c=i.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const u=e.camera.cameras;!n.layerDescriptors||n.layerDescriptors.length!==u.length?this._createDepthLayerDescriptors(e,n,o,u):this._updateDepthLayerDescriptors(e,n,u),n.bundleEncoders=[],n.bundleSets=[];for(let h=0;h<u.length;h++){const f=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+h),m={attributes:{},bindingGroups:[],pipeline:null,index:null};n.bundleEncoders.push(f),n.bundleSets.push(m)}n.currentPass=null}else{const u=c.beginRenderPass(o);n.currentPass=u,e.viewport&&this.updateViewport(e),e.scissor&&this.updateScissor(e)}n.descriptor=o,n.encoder=c,n.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},n.renderBundles=[]}_createDepthLayerDescriptors(e,n,i,s){const r=i.depthStencilAttachment;n.layerDescriptors=[];const o=this.get(e.depthTexture);o.viewCache||(o.viewCache=[]);for(let l=0;l<s.length;l++){const c={...i,colorAttachments:[{...i.colorAttachments[0],view:i.colorAttachments[l].view}]};if(i.depthStencilAttachment){const u=l;o.viewCache[u]||(o.viewCache[u]=o.texture.createView({dimension:vr.TwoD,baseArrayLayer:l,arrayLayerCount:1})),c.depthStencilAttachment={view:o.viewCache[u],depthLoadOp:r.depthLoadOp||Ri.Clear,depthStoreOp:r.depthStoreOp||Tl.Store,depthClearValue:r.depthClearValue||1},e.stencil&&(c.depthStencilAttachment.stencilLoadOp=r.stencilLoadOp,c.depthStencilAttachment.stencilStoreOp=r.stencilStoreOp,c.depthStencilAttachment.stencilClearValue=r.stencilClearValue)}else c.depthStencilAttachment={...r};n.layerDescriptors.push(c)}}_updateDepthLayerDescriptors(e,n,i){for(let s=0;s<i.length;s++){const r=n.layerDescriptors[s];if(r.depthStencilAttachment){const o=r.depthStencilAttachment;e.depth&&(e.clearDepth?(o.depthClearValue=e.clearDepthValue,o.depthLoadOp=Ri.Clear):o.depthLoadOp=Ri.Load),e.stencil&&(e.clearStencil?(o.stencilClearValue=e.clearStencilValue,o.stencilLoadOp=Ri.Clear):o.stencilLoadOp=Ri.Load)}}}finishRender(e){const n=this.get(e),i=e.occlusionQueryCount;n.renderBundles.length>0&&n.currentPass.executeBundles(n.renderBundles),i>n.occlusionQueryIndex&&n.currentPass.endOcclusionQuery();const s=n.encoder;if(this._isRenderCameraDepthArray(e)===!0){const r=[];for(let o=0;o<n.bundleEncoders.length;o++){const l=n.bundleEncoders[o];r.push(l.finish())}for(let o=0;o<n.layerDescriptors.length;o++)if(o<r.length){const l=n.layerDescriptors[o],c=s.beginRenderPass(l);if(e.viewport){const{x:u,y:h,width:f,height:m,minDepth:A,maxDepth:x}=e.viewportValue;c.setViewport(u,h,f,m,A,x)}if(e.scissor){const{x:u,y:h,width:f,height:m}=e.scissorValue;c.setScissorRect(u,h,f,m)}c.executeBundles([r[o]]),c.end()}}else n.currentPass&&n.currentPass.end();if(i>0){const r=i*8;let o=this.occludedResolveCache.get(r);o===void 0&&(o=this.device.createBuffer({size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(r,o));const l=this.device.createBuffer({size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});n.encoder.resolveQuerySet(n.occlusionQuerySet,0,i,o,0),n.encoder.copyBufferToBuffer(o,0,l,0,r),n.occlusionQueryBuffer=l,this.resolveOccludedAsync(e)}if(this.device.queue.submit([n.encoder.finish()]),e.textures!==null){const r=e.textures;for(let o=0;o<r.length;o++){const l=r[o];l.generateMipmaps===!0&&this.textureUtils.generateMipmaps(l)}}}isOccluded(e,n){const i=this.get(e);return i.occluded&&i.occluded.has(n)}async resolveOccludedAsync(e){const n=this.get(e),{currentOcclusionQueryBuffer:i,currentOcclusionQueryObjects:s}=n;if(i&&s){const r=new WeakSet;n.currentOcclusionQueryObjects=null,n.currentOcclusionQueryBuffer=null,await i.mapAsync(GPUMapMode.READ);const o=i.getMappedRange(),l=new BigUint64Array(o);for(let c=0;c<s.length;c++)l[c]===BigInt(0)&&r.add(s[c]);i.destroy(),n.occluded=r}}updateViewport(e){const{currentPass:n}=this.get(e),{x:i,y:s,width:r,height:o,minDepth:l,maxDepth:c}=e.viewportValue;n.setViewport(i,s,r,o,l,c)}updateScissor(e){const{currentPass:n}=this.get(e),{x:i,y:s,width:r,height:o}=e.scissorValue;n.setScissorRect(i,s,r,o)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,n,i,s=null){const r=this.device,o=this.renderer;let l=[],c,u,h,f;if(e){const x=this.getClearColor();u={r:x.r,g:x.g,b:x.b,a:x.a}}if(s===null){h=o.depth,f=o.stencil;const x=this._getDefaultRenderPassDescriptor();if(e){l=x.colorAttachments;const T=l[0];T.clearValue=u,T.loadOp=Ri.Clear,T.storeOp=Tl.Store}(h||f)&&(c=x.depthStencilAttachment)}else{h=s.depth,f=s.stencil;const x={loadOp:e?Ri.Clear:Ri.Load,clearValue:e?u:void 0};h&&(x.depthLoadOp=n?Ri.Clear:Ri.Load,x.depthClearValue=n?o.getClearDepth():void 0,x.depthStoreOp=Tl.Store),f&&(x.stencilLoadOp=i?Ri.Clear:Ri.Load,x.stencilClearValue=i?o.getClearStencil():void 0,x.stencilStoreOp=Tl.Store);const T=this._getRenderPassDescriptor(s,x);l=T.colorAttachments,c=T.depthStencilAttachment}h&&c&&(n?(c.depthLoadOp=Ri.Clear,c.depthClearValue=o.getClearDepth(),c.depthStoreOp=Tl.Store):(c.depthLoadOp=Ri.Load,c.depthStoreOp=Tl.Store)),f&&c&&(i?(c.stencilLoadOp=Ri.Clear,c.stencilClearValue=o.getClearStencil(),c.stencilStoreOp=Tl.Store):(c.stencilLoadOp=Ri.Load,c.stencilStoreOp=Tl.Store));const m=r.createCommandEncoder({label:"clear"});m.beginRenderPass({colorAttachments:l,depthStencilAttachment:c}).end(),r.queue.submit([m.finish()])}beginCompute(e){const n=this.get(e),i={label:"computeGroup_"+e.id};this.initTimestampQuery(Fd.COMPUTE,this.getTimestampUID(e),i),n.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),n.passEncoderGPU=n.cmdEncoderGPU.beginComputePass(i)}compute(e,n,i,s,r=null){const o=this.get(n),{passEncoderGPU:l}=this.get(e),c=this.get(s).pipeline;this.pipelineUtils.setPipeline(l,c);for(let u=0,h=i.length;u<h;u++){const f=i[u],m=this.get(f);l.setBindGroup(u,m.group)}if(r===null&&(r=n.count),r&&typeof r=="object"&&r.isIndirectStorageBufferAttribute){const u=this.get(r).buffer;l.dispatchWorkgroupsIndirect(u,0);return}if(typeof r=="number"){const u=r;if(o.dispatchSize===void 0||o.count!==u){o.dispatchSize=[0,1,1],o.count=u;const h=n.workgroupSize;let f=h[0];for(let x=1;x<h.length;x++)f*=h[x];const m=Math.ceil(u/f),A=this.device.limits.maxComputeWorkgroupsPerDimension;r=[m,1,1],m>A&&(r[0]=Math.min(m,A),r[1]=Math.ceil(m/A)),o.dispatchSize=r}r=o.dispatchSize}l.dispatchWorkgroups(r[0],r[1]||1,r[2]||1)}finishCompute(e){const n=this.get(e);n.passEncoderGPU.end(),this.device.queue.submit([n.cmdEncoderGPU.finish()])}draw(e,n){const{object:i,material:s,context:r,pipeline:o}=e,l=e.getBindings(),c=this.get(r),u=this.get(o),h=u.pipeline;if(u.error===!0)return;const f=e.getIndex(),m=f!==null,A=e.getDrawParameters();if(A===null)return;const x=(E,M)=>{this.pipelineUtils.setPipeline(E,h),M.pipeline=h;const N=M.bindingGroups;for(let F=0,G=l.length;F<G;F++){const O=l[F],D=this.get(O);N[O.index]!==O.id&&(E.setBindGroup(O.index,D.group),N[O.index]=O.id)}if(m===!0&&M.index!==f){const F=this.get(f).buffer,G=f.array instanceof Uint16Array?Ax.Uint16:Ax.Uint32;E.setIndexBuffer(F,G),M.index=f}const I=e.getVertexBuffers();for(let F=0,G=I.length;F<G;F++){const O=I[F];if(M.attributes[F]!==O){const D=this.get(O).buffer;E.setVertexBuffer(F,D),M.attributes[F]=O}}r.stencil===!0&&s.stencilWrite===!0&&c.currentStencilRef!==s.stencilRef&&(E.setStencilReference(s.stencilRef),c.currentStencilRef=s.stencilRef)},T=(E,M)=>{if(x(E,M),i.isBatchedMesh===!0){const N=i._multiDrawStarts,I=i._multiDrawCounts,F=i._multiDrawCount,G=i._multiDrawInstances;G!==null&&ji("WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let O=0;O<F;O++){const D=G?G[O]:1,j=D>1?0:O;m===!0?E.drawIndexed(I[O],D,N[O]/f.array.BYTES_PER_ELEMENT,0,j):E.draw(I[O],D,N[O],j),n.update(i,I[O],D)}}else if(m===!0){const{vertexCount:N,instanceCount:I,firstVertex:F}=A,G=e.getIndirect();if(G!==null){const O=this.get(G).buffer,D=e.getIndirectOffset(),j=Array.isArray(D)?D:[D];for(let L=0;L<j.length;L++)E.drawIndexedIndirect(O,j[L])}else E.drawIndexed(N,I,F,0,0);n.update(i,N,I)}else{const{vertexCount:N,instanceCount:I,firstVertex:F}=A,G=e.getIndirect();if(G!==null){const O=this.get(G).buffer,D=e.getIndirectOffset(),j=Array.isArray(D)?D:[D];for(let L=0;L<j.length;L++)E.drawIndirect(O,j[L])}else E.draw(N,I,F,0);n.update(i,N,I)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const E=this.get(e.camera),M=e.camera.cameras,N=e.getBindingGroup("cameraIndex");if(E.indexesGPU===void 0||E.indexesGPU.length!==M.length){const F=this.get(N),G=[],O=new Uint32Array([0,0,0,0]);for(let D=0,j=M.length;D<j;D++){O[0]=D;const{layoutGPU:L}=F.layout,U=this.bindingUtils.createBindGroupIndex(O,L);G.push(U)}E.indexesGPU=G}const I=this.renderer.getPixelRatio();for(let F=0,G=M.length;F<G;F++){const O=M[F];if(i.layers.test(O.layers)){const D=O.viewport;let j=c.currentPass,L=c.currentSets;if(c.bundleEncoders){const U=c.bundleEncoders[F],q=c.bundleSets[F];j=U,L=q}D&&j.setViewport(Math.floor(D.x*I),Math.floor(D.y*I),Math.floor(D.width*I),Math.floor(D.height*I),r.viewportValue.minDepth,r.viewportValue.maxDepth),N&&E.indexesGPU&&(j.setBindGroup(N.index,E.indexesGPU[F]),L.bindingGroups[N.index]=N.id),T(j,L)}}}else if(c.currentPass){if(c.occlusionQuerySet!==void 0){const E=c.lastOcclusionObject;E!==i&&(E!==null&&E.occlusionTest===!0&&(c.currentPass.endOcclusionQuery(),c.occlusionQueryIndex++),i.occlusionTest===!0&&(c.currentPass.beginOcclusionQuery(c.occlusionQueryIndex),c.occlusionQueryObjects[c.occlusionQueryIndex]=i),c.lastOcclusionObject=i)}T(c.currentPass,c.currentSets)}}needsRenderUpdate(e){const n=this.get(e),{object:i,material:s}=e,r=this.utils,o=r.getSampleCountRenderContext(e.context),l=r.getCurrentColorSpace(e.context),c=r.getCurrentColorFormat(e.context),u=r.getCurrentDepthStencilFormat(e.context),h=r.getPrimitiveTopology(i,s);let f=!1;return(n.material!==s||n.materialVersion!==s.version||n.transparent!==s.transparent||n.blending!==s.blending||n.premultipliedAlpha!==s.premultipliedAlpha||n.blendSrc!==s.blendSrc||n.blendDst!==s.blendDst||n.blendEquation!==s.blendEquation||n.blendSrcAlpha!==s.blendSrcAlpha||n.blendDstAlpha!==s.blendDstAlpha||n.blendEquationAlpha!==s.blendEquationAlpha||n.colorWrite!==s.colorWrite||n.depthWrite!==s.depthWrite||n.depthTest!==s.depthTest||n.depthFunc!==s.depthFunc||n.stencilWrite!==s.stencilWrite||n.stencilFunc!==s.stencilFunc||n.stencilFail!==s.stencilFail||n.stencilZFail!==s.stencilZFail||n.stencilZPass!==s.stencilZPass||n.stencilFuncMask!==s.stencilFuncMask||n.stencilWriteMask!==s.stencilWriteMask||n.side!==s.side||n.alphaToCoverage!==s.alphaToCoverage||n.sampleCount!==o||n.colorSpace!==l||n.colorFormat!==c||n.depthStencilFormat!==u||n.primitiveTopology!==h||n.clippingContextCacheKey!==e.clippingContextCacheKey)&&(n.material=s,n.materialVersion=s.version,n.transparent=s.transparent,n.blending=s.blending,n.premultipliedAlpha=s.premultipliedAlpha,n.blendSrc=s.blendSrc,n.blendDst=s.blendDst,n.blendEquation=s.blendEquation,n.blendSrcAlpha=s.blendSrcAlpha,n.blendDstAlpha=s.blendDstAlpha,n.blendEquationAlpha=s.blendEquationAlpha,n.colorWrite=s.colorWrite,n.depthWrite=s.depthWrite,n.depthTest=s.depthTest,n.depthFunc=s.depthFunc,n.stencilWrite=s.stencilWrite,n.stencilFunc=s.stencilFunc,n.stencilFail=s.stencilFail,n.stencilZFail=s.stencilZFail,n.stencilZPass=s.stencilZPass,n.stencilFuncMask=s.stencilFuncMask,n.stencilWriteMask=s.stencilWriteMask,n.side=s.side,n.alphaToCoverage=s.alphaToCoverage,n.sampleCount=o,n.colorSpace=l,n.colorFormat=c,n.depthStencilFormat=u,n.primitiveTopology=h,n.clippingContextCacheKey=e.clippingContextCacheKey,f=!0),f}getRenderCacheKey(e){const{object:n,material:i}=e,s=this.utils,r=e.context,o=n.isMesh&&n.matrixWorld.determinant()<0;return[i.transparent,i.blending,i.premultipliedAlpha,i.blendSrc,i.blendDst,i.blendEquation,i.blendSrcAlpha,i.blendDstAlpha,i.blendEquationAlpha,i.colorWrite,i.depthWrite,i.depthTest,i.depthFunc,i.stencilWrite,i.stencilFunc,i.stencilFail,i.stencilZFail,i.stencilZPass,i.stencilFuncMask,i.stencilWriteMask,i.side,o,s.getSampleCountRenderContext(r),s.getCurrentColorSpace(r),s.getCurrentColorFormat(r),s.getCurrentDepthStencilFormat(r),s.getPrimitiveTopology(n,i),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}updateSampler(e){return this.textureUtils.updateSampler(e)}createDefaultTexture(e){return this.textureUtils.createDefaultTexture(e)}createTexture(e,n){this.textureUtils.createTexture(e,n)}updateTexture(e,n){this.textureUtils.updateTexture(e,n)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e,n=!1){this.textureUtils.destroyTexture(e,n)}async copyTextureToBuffer(e,n,i,s,r,o){return this.textureUtils.copyTextureToBuffer(e,n,i,s,r,o)}initTimestampQuery(e,n,i){if(!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new THe(this.device,e,2048));const s=this.timestampQueryPool[e],r=s.allocateQueriesForContext(n);i.timestampWrites={querySet:s.querySet,beginningOfPassWriteIndex:r,endOfPassWriteIndex:r+1}}createNodeBuilder(e,n){return new gHe(e,n)}createProgram(e){const n=this.get(e);n.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,n){this.pipelineUtils.createRenderPipeline(e,n)}createComputePipeline(e,n){this.pipelineUtils.createComputePipeline(e,n)}beginBundle(e){const n=this.get(e);n._currentPass=n.currentPass,n._currentSets=n.currentSets,n.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},n.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,n){const i=this.get(e),r=i.currentPass.finish();this.get(n).bundleGPU=r,i.currentSets=i._currentSets,i.currentPass=i._currentPass}addBundle(e,n){this.get(e).renderBundles.push(this.get(n).bundleGPU)}createBindings(e,n,i,s){this.bindingUtils.createBindings(e,n,i,s)}updateBindings(e,n,i,s){this.bindingUtils.createBindings(e,n,i,s)}updateBinding(e){this.bindingUtils.updateBinding(e)}deleteBindGroupData(e){this.bindingUtils.deleteBindGroupData(e)}createIndexAttribute(e){let n=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(n|=GPUBufferUsage.STORAGE),this.attributeUtils.createAttribute(e,n)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.delete(this.renderer.getCanvasTarget())}getMaxAnisotropy(){return 16}hasFeature(e){return iY[e]!==void 0&&(e=iY[e]),this.device.features.has(e)}copyTextureToTexture(e,n,i=null,s=null,r=0,o=0){let l=0,c=0,u=0,h=0,f=0,m=0,A=e.image.width,x=e.image.height,T=1;i!==null&&(i.isBox3===!0?(h=i.min.x,f=i.min.y,m=i.min.z,A=i.max.x-i.min.x,x=i.max.y-i.min.y,T=i.max.z-i.min.z):(h=i.min.x,f=i.min.y,A=i.max.x-i.min.x,x=i.max.y-i.min.y,T=1)),s!==null&&(l=s.x,c=s.y,u=s.z||0);const E=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+n.id}),M=this.get(e).texture,N=this.get(n).texture;E.copyTextureToTexture({texture:M,mipLevel:r,origin:{x:h,y:f,z:m}},{texture:N,mipLevel:o,origin:{x:l,y:c,z:u}},[A,x,T]),this.device.queue.submit([E.finish()]),o===0&&n.generateMipmaps&&this.textureUtils.generateMipmaps(n)}copyFramebufferToTexture(e,n,i){const s=this.get(n);let r=null;n.renderTarget?e.isDepthTexture?r=this.get(n.depthTexture).texture:r=this.get(n.textures[0]).texture:e.isDepthTexture?r=this.textureUtils.getDepthBuffer(n.depth,n.stencil):r=this.context.getCurrentTexture();const o=this.get(e).texture;if(r.format!==o.format){Rt("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",r.format,o.format);return}let l;if(s.currentPass?(s.currentPass.end(),l=s.encoder):l=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),l.copyTextureToTexture({texture:r,origin:[i.x,i.y,0]},{texture:o},[i.z,i.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e,l),s.currentPass){const{descriptor:c}=s;for(let u=0;u<c.colorAttachments.length;u++)c.colorAttachments[u].loadOp=Ri.Load;n.depth&&(c.depthStencilAttachment.depthLoadOp=Ri.Load),n.stencil&&(c.depthStencilAttachment.stencilLoadOp=Ri.Load),s.currentPass=l.beginRenderPass(c),s.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},n.viewport&&this.updateViewport(n),n.scissor&&this.updateScissor(n)}else this.device.queue.submit([l.finish()])}dispose(){if(this.bindingUtils.dispose(),this.textureUtils.dispose(),this.occludedResolveCache){for(const e of this.occludedResolveCache.values())e.destroy();this.occludedResolveCache.clear()}if(this.timestampQueryPool)for(const e of Object.values(this.timestampQueryPool))e!==null&&e.dispose();this.parameters.device===void 0&&this.device!==null&&this.device.destroy()}}class EHe extends sw{constructor(e,n,i,s,r,o){super(e,n,i,s,r,o),this.iesMap=null}copy(e,n){return super.copy(e,n),this.iesMap=e.iesMap,this}}class MHe extends sw{constructor(e,n,i,s,r,o){super(e,n,i,s,r,o),this.aspect=null}copy(e,n){return super.copy(e,n),this.aspect=e.aspect,this}}class CHe extends noe{constructor(){super(),this.addMaterial(aBe,"MeshPhongMaterial"),this.addMaterial(Zse,"MeshStandardMaterial"),this.addMaterial(KBe,"MeshPhysicalMaterial"),this.addMaterial(JBe,"MeshToonMaterial"),this.addMaterial(Xje,"MeshBasicMaterial"),this.addMaterial(tBe,"MeshLambertMaterial"),this.addMaterial(Hje,"MeshNormalMaterial"),this.addMaterial(e7e,"MeshMatcapMaterial"),this.addMaterial(Bje,"LineBasicMaterial"),this.addMaterial(Vje,"LineDashedMaterial"),this.addMaterial(s7e,"PointsMaterial"),this.addMaterial(tre,"SpriteMaterial"),this.addMaterial(c7e,"ShadowMaterial"),this.addLight(WVe,Dj),this.addLight(aqe,A4),this.addLight(iqe,kj),this.addLight(O7,sw),this.addLight(lqe,y4),this.addLight(cqe,Ij),this.addLight(uqe,Fj),this.addLight(sqe,EHe),this.addLight(oqe,MHe),this.addToneMapping(vre,DP),this.addToneMapping(_re,kP),this.addToneMapping(xre,OP),this.addToneMapping(bre,FP),this.addToneMapping(Sre,jP),this.addToneMapping(Tre,BP)}}class poe extends Rqe{constructor(e={}){let n;e.forceWebGL?n=JK:(n=wHe,e.getFallback=()=>(yt("WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new JK(e)));const i=new n(e);super(i,e),this.library=new CHe,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}Z.BRDF_GGX;Z.BRDF_Lambert;Z.BasicPointShadowFilter;Z.BasicShadowFilter;Z.Break;Z.Const;Z.Continue;Z.DFGLUT;Z.D_GGX;Z.Discard;Z.EPSILON;Z.F_Schlick;const NHe=Z.Fn;Z.INFINITY;const RHe=Z.If,PHe=Z.Loop;Z.NodeAccess;Z.NodeShaderStage;Z.NodeType;Z.NodeUpdateType;Z.PCFShadowFilter;Z.PCFSoftShadowFilter;Z.PI;Z.PI2;Z.TWO_PI;Z.HALF_PI;Z.PointShadowFilter;Z.Return;Z.Schlick_to_F0;Z.ScriptableNodeResources;Z.ShaderNode;Z.Stack;Z.Switch;Z.TBNViewMatrix;Z.VSMShadowFilter;Z.V_GGX_SmithCorrelated;Z.Var;Z.VarIntent;Z.abs;Z.acesFilmicToneMapping;Z.acos;Z.add;Z.addMethodChaining;Z.addNodeElement;Z.agxToneMapping;Z.all;Z.alphaT;Z.and;Z.anisotropy;Z.anisotropyB;Z.anisotropyT;Z.any;Z.append;Z.array;Z.arrayBuffer;const IHe=Z.asin;Z.assign;Z.atan;Z.atan2;Z.atomicAdd;Z.atomicAnd;Z.atomicFunc;Z.atomicLoad;Z.atomicMax;Z.atomicMin;Z.atomicOr;Z.atomicStore;Z.atomicSub;Z.atomicXor;Z.attenuationColor;Z.attenuationDistance;Z.attribute;Z.attributeArray;Z.backgroundBlurriness;Z.backgroundIntensity;Z.backgroundRotation;Z.batch;Z.bentNormalView;Z.billboarding;Z.bitAnd;Z.bitNot;Z.bitOr;Z.bitXor;Z.bitangentGeometry;Z.bitangentLocal;Z.bitangentView;Z.bitangentWorld;Z.bitcast;Z.blendBurn;Z.blendColor;Z.blendDodge;Z.blendOverlay;Z.blendScreen;Z.blur;Z.bool;Z.buffer;Z.bufferAttribute;Z.bumpMap;Z.burn;Z.builtin;Z.builtinAOContext;Z.builtinShadowContext;Z.bvec2;Z.bvec3;Z.bvec4;Z.bypass;Z.cache;Z.call;Z.cameraFar;Z.cameraIndex;Z.cameraNear;Z.cameraNormalMatrix;Z.cameraPosition;Z.cameraProjectionMatrix;Z.cameraProjectionMatrixInverse;Z.cameraViewMatrix;Z.cameraViewport;Z.cameraWorldMatrix;Z.cbrt;Z.cdl;Z.ceil;Z.checker;Z.cineonToneMapping;Z.clamp;Z.clearcoat;Z.clearcoatNormalView;Z.clearcoatRoughness;Z.code;Z.color;Z.colorSpaceToWorking;Z.colorToDirection;Z.compute;Z.computeKernel;Z.computeSkinning;Z.context;Z.convert;Z.convertColorSpace;Z.convertToTexture;Z.countLeadingZeros;Z.countOneBits;Z.countTrailingZeros;const LHe=Z.cos;Z.cross;Z.cubeTexture;Z.cubeTextureBase;Z.dFdx;Z.dFdy;Z.dashSize;Z.debug;Z.decrement;Z.decrementBefore;Z.defaultBuildStages;Z.defaultShaderStages;Z.defined;Z.degrees;Z.deltaTime;Z.densityFog;Z.densityFogFactor;Z.depth;Z.depthPass;Z.determinant;Z.difference;Z.diffuseColor;Z.directPointLight;Z.directionToColor;Z.directionToFaceDirection;Z.dispersion;Z.distance;Z.div;Z.dodge;Z.dot;Z.drawIndex;Z.dynamicBufferAttribute;Z.element;Z.emissive;Z.equal;Z.equals;Z.equirectUV;const DHe=Z.exp;Z.exp2;Z.expression;Z.faceDirection;Z.faceForward;Z.faceforward;const kHe=Z.float;Z.floatBitsToInt;Z.floatBitsToUint;Z.floor;Z.fog;Z.fract;Z.frameGroup;Z.frameId;Z.frontFacing;Z.fwidth;Z.gain;Z.gapSize;Z.getConstNodeType;Z.getCurrentStack;Z.getDirection;Z.getDistanceAttenuation;Z.getGeometryRoughness;Z.getNormalFromDepth;Z.interleavedGradientNoise;Z.vogelDiskSample;Z.getParallaxCorrectNormal;Z.getRoughness;Z.getScreenPosition;Z.getShIrradianceAt;Z.getShadowMaterial;Z.getShadowRenderObjectFunction;Z.getTextureIndex;Z.getViewPosition;Z.globalId;Z.glsl;Z.glslFn;Z.grayscale;Z.greaterThan;Z.greaterThanEqual;Z.hash;Z.highpModelNormalViewMatrix;Z.highpModelViewMatrix;Z.hue;Z.increment;Z.incrementBefore;Z.instance;const OHe=Z.instanceIndex;Z.instancedArray;Z.instancedBufferAttribute;Z.instancedDynamicBufferAttribute;Z.instancedMesh;Z.int;Z.intBitsToFloat;Z.inverse;Z.inverseSqrt;Z.inversesqrt;Z.invocationLocalIndex;Z.invocationSubgroupIndex;Z.ior;Z.iridescence;Z.iridescenceIOR;Z.iridescenceThickness;Z.ivec2;Z.ivec3;Z.ivec4;Z.js;Z.label;Z.length;Z.lengthSq;Z.lessThan;Z.lessThanEqual;Z.lightPosition;Z.lightProjectionUV;Z.lightShadowMatrix;Z.lightTargetDirection;Z.lightTargetPosition;Z.lightViewPosition;Z.lightingContext;Z.lights;Z.linearDepth;Z.linearToneMapping;Z.localId;Z.log;Z.log2;Z.logarithmicDepthToViewZ;Z.luminance;Z.mat2;Z.mat3;Z.mat4;Z.matcapUV;Z.materialAO;Z.materialAlphaTest;Z.materialAnisotropy;Z.materialAnisotropyVector;Z.materialAttenuationColor;Z.materialAttenuationDistance;Z.materialClearcoat;Z.materialClearcoatNormal;Z.materialClearcoatRoughness;Z.materialColor;Z.materialDispersion;Z.materialEmissive;Z.materialEnvIntensity;Z.materialEnvRotation;Z.materialIOR;Z.materialIridescence;Z.materialIridescenceIOR;Z.materialIridescenceThickness;Z.materialLightMap;Z.materialLineDashOffset;Z.materialLineDashSize;Z.materialLineGapSize;Z.materialLineScale;Z.materialLineWidth;Z.materialMetalness;Z.materialNormal;Z.materialOpacity;Z.materialPointSize;Z.materialReference;Z.materialReflectivity;Z.materialRefractionRatio;Z.materialRotation;Z.materialRoughness;Z.materialSheen;Z.materialSheenRoughness;Z.materialShininess;Z.materialSpecular;Z.materialSpecularColor;Z.materialSpecularIntensity;Z.materialSpecularStrength;Z.materialThickness;Z.materialTransmission;Z.max;Z.maxMipLevel;Z.mediumpModelViewMatrix;Z.metalness;Z.min;Z.mix;Z.mixElement;Z.mod;Z.modInt;Z.modelDirection;Z.modelNormalMatrix;Z.modelPosition;Z.modelRadius;Z.modelScale;Z.modelViewMatrix;Z.modelViewPosition;Z.modelViewProjection;Z.modelWorldMatrix;Z.modelWorldMatrixInverse;Z.morphReference;Z.mrt;Z.mul;Z.mx_aastep;Z.mx_add;Z.mx_atan2;Z.mx_cell_noise_float;Z.mx_contrast;Z.mx_divide;Z.mx_fractal_noise_float;Z.mx_fractal_noise_vec2;Z.mx_fractal_noise_vec3;Z.mx_fractal_noise_vec4;Z.mx_frame;Z.mx_heighttonormal;Z.mx_hsvtorgb;Z.mx_ifequal;Z.mx_ifgreater;Z.mx_ifgreatereq;Z.mx_invert;Z.mx_modulo;Z.mx_multiply;Z.mx_noise_float;Z.mx_noise_vec3;Z.mx_noise_vec4;Z.mx_place2d;Z.mx_power;Z.mx_ramp4;Z.mx_ramplr;Z.mx_ramptb;Z.mx_rgbtohsv;Z.mx_rotate2d;Z.mx_rotate3d;Z.mx_safepower;Z.mx_separate;Z.mx_splitlr;Z.mx_splittb;Z.mx_srgb_texture_to_lin_rec709;Z.mx_subtract;Z.mx_timer;Z.mx_transform_uv;Z.mx_unifiednoise2d;Z.mx_unifiednoise3d;Z.mx_worley_noise_float;Z.mx_worley_noise_vec2;Z.mx_worley_noise_vec3;const FHe=Z.negate;Z.neutralToneMapping;Z.nodeArray;Z.nodeImmutable;Z.nodeObject;Z.nodeObjectIntent;Z.nodeObjects;Z.nodeProxy;Z.nodeProxyIntent;Z.normalFlat;Z.normalGeometry;Z.normalLocal;Z.normalMap;Z.normalView;Z.normalViewGeometry;Z.normalWorld;Z.normalWorldGeometry;Z.normalize;Z.not;Z.notEqual;Z.numWorkgroups;Z.objectDirection;Z.objectGroup;Z.objectPosition;Z.objectRadius;Z.objectScale;Z.objectViewPosition;Z.objectWorldMatrix;Z.OnBeforeObjectUpdate;Z.OnBeforeMaterialUpdate;Z.OnObjectUpdate;Z.OnMaterialUpdate;Z.oneMinus;Z.or;Z.orthographicDepthToViewZ;Z.oscSawtooth;Z.oscSine;Z.oscSquare;Z.oscTriangle;Z.output;Z.outputStruct;Z.overlay;Z.overloadingFn;Z.packHalf2x16;Z.packSnorm2x16;Z.packUnorm2x16;Z.parabola;Z.parallaxDirection;Z.parallaxUV;Z.parameter;Z.pass;Z.passTexture;Z.pcurve;Z.perspectiveDepthToViewZ;Z.pmremTexture;Z.pointShadow;Z.pointUV;Z.pointWidth;Z.positionGeometry;Z.positionLocal;Z.positionPrevious;Z.positionView;Z.positionViewDirection;Z.positionWorld;Z.positionWorldDirection;Z.posterize;Z.pow;Z.pow2;Z.pow3;Z.pow4;Z.premultiplyAlpha;Z.property;Z.radians;Z.rand;Z.range;Z.rangeFog;Z.rangeFogFactor;Z.reciprocal;Z.reference;Z.referenceBuffer;Z.reflect;Z.reflectVector;Z.reflectView;Z.reflector;Z.refract;Z.refractVector;Z.refractView;Z.reinhardToneMapping;Z.remap;Z.remapClamp;Z.renderGroup;Z.renderOutput;Z.rendererReference;Z.replaceDefaultUV;Z.rotate;Z.rotateUV;Z.roughness;Z.round;Z.rtt;Z.sRGBTransferEOTF;Z.sRGBTransferOETF;Z.sample;Z.sampler;Z.samplerComparison;Z.saturate;Z.saturation;Z.screen;Z.screenCoordinate;Z.screenDPR;Z.screenSize;Z.screenUV;Z.scriptable;Z.scriptableValue;Z.select;Z.setCurrentStack;Z.setName;Z.shaderStages;Z.shadow;Z.shadowPositionWorld;Z.shapeCircle;Z.sharedUniformGroup;Z.sheen;Z.sheenRoughness;Z.shiftLeft;Z.shiftRight;Z.shininess;Z.sign;const jHe=Z.sin;Z.sinc;Z.skinning;Z.smoothstep;Z.smoothstepElement;Z.specularColor;Z.specularF90;Z.spherizeUV;Z.split;Z.spritesheetUV;const BHe=Z.sqrt;Z.stack;Z.step;Z.stepElement;const UHe=Z.storage;Z.storageBarrier;Z.storageObject;Z.storageTexture;Z.string;Z.struct;Z.sub;Z.subgroupAdd;Z.subgroupAll;Z.subgroupAnd;Z.subgroupAny;Z.subgroupBallot;Z.subgroupBroadcast;Z.subgroupBroadcastFirst;Z.subBuild;Z.subgroupElect;Z.subgroupExclusiveAdd;Z.subgroupExclusiveMul;Z.subgroupInclusiveAdd;Z.subgroupInclusiveMul;Z.subgroupIndex;Z.subgroupMax;Z.subgroupMin;Z.subgroupMul;Z.subgroupOr;Z.subgroupShuffle;Z.subgroupShuffleDown;Z.subgroupShuffleUp;Z.subgroupShuffleXor;Z.subgroupSize;Z.subgroupXor;Z.tan;Z.tangentGeometry;Z.tangentLocal;Z.tangentView;Z.tangentWorld;Z.texture;Z.texture3D;Z.textureBarrier;Z.textureBicubic;Z.textureBicubicLevel;Z.textureCubeUV;Z.textureLoad;Z.textureSize;Z.textureLevel;Z.textureStore;Z.thickness;Z.time;Z.toneMapping;Z.toneMappingExposure;Z.toonOutlinePass;Z.transformDirection;Z.transformNormal;Z.transformNormalToView;Z.transformedClearcoatNormalView;Z.transformedNormalView;Z.transformedNormalWorld;Z.transmission;Z.transpose;Z.triNoise3D;Z.triplanarTexture;Z.triplanarTextures;Z.trunc;Z.uint;Z.uintBitsToFloat;const VHe=Z.uniform;Z.uniformArray;Z.uniformCubeTexture;Z.uniformGroup;Z.uniformFlow;Z.uniformTexture;Z.unpackHalf2x16;Z.unpackSnorm2x16;Z.unpackUnorm2x16;Z.unpremultiplyAlpha;Z.userData;Z.uv;Z.uvec2;Z.uvec3;Z.uvec4;Z.varying;Z.varyingProperty;Z.vec2;Z.vec3;Z.vec4;Z.vectorComponents;Z.velocity;Z.vertexColor;Z.vertexIndex;Z.vertexStage;Z.vibrance;Z.viewZToLogarithmicDepth;Z.viewZToOrthographicDepth;Z.viewZToPerspectiveDepth;Z.viewport;Z.viewportCoordinate;Z.viewportDepthTexture;Z.viewportLinearDepth;Z.viewportMipTexture;Z.viewportResolution;Z.viewportSafeUV;Z.viewportSharedTexture;Z.viewportSize;Z.viewportTexture;Z.viewportUV;Z.wgsl;Z.wgslFn;Z.workgroupArray;Z.workgroupBarrier;Z.workgroupId;Z.workingToColorSpace;Z.xor;const cY=new Mr,dC=new ye;class moe extends jj{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],n=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],i=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(i),this.setAttribute("position",new mn(e,3)),this.setAttribute("uv",new mn(n,2))}applyMatrix4(e){const n=this.attributes.instanceStart,i=this.attributes.instanceEnd;return n!==void 0&&(n.applyMatrix4(e),i.applyMatrix4(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let n;e instanceof Float32Array?n=e:Array.isArray(e)&&(n=new Float32Array(e));const i=new XS(n,6,1);return this.setAttribute("instanceStart",new kl(i,3,0)),this.setAttribute("instanceEnd",new kl(i,3,3)),this.instanceCount=this.attributes.instanceStart.count,this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let n;e instanceof Float32Array?n=e:Array.isArray(e)&&(n=new Float32Array(e));const i=new XS(n,6,1);return this.setAttribute("instanceColorStart",new kl(i,3,0)),this.setAttribute("instanceColorEnd",new kl(i,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new yj(e.geometry)),this}fromLineSegments(e){const n=e.geometry;return this.setPositions(n.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Mr);const e=this.attributes.instanceStart,n=this.attributes.instanceEnd;e!==void 0&&n!==void 0&&(this.boundingBox.setFromBufferAttribute(e),cY.setFromBufferAttribute(n),this.boundingBox.union(cY))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Cr),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,n=this.attributes.instanceEnd;if(e!==void 0&&n!==void 0){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let s=0;for(let r=0,o=e.count;r<o;r++)dC.fromBufferAttribute(e,r),s=Math.max(s,i.distanceToSquared(dC)),dC.fromBufferAttribute(n,r),s=Math.max(s,i.distanceToSquared(dC));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}}hn.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Nt(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};El.line={uniforms:XT.merge([hn.common,hn.fog,hn.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			float alpha = opacity;
			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class j7 extends mo{constructor(e){super({type:"LineMaterial",uniforms:XT.clone(El.line.uniforms),vertexShader:El.line.vertexShader,fragmentShader:El.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){e===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){e===!0!==this.dashed&&(this.needsUpdate=!0),e===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(e===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),e===!0?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}const e6=new qn,uY=new ye,dY=new ye,bo=new qn,So=new qn,Rh=new qn,t6=new ye,n6=new _n,To=new Zee,hY=new ye,hC=new Mr,fC=new Cr,Ph=new qn;let Vh,ay;function fY(a,e,n){return Ph.set(0,0,-e,1).applyMatrix4(a.projectionMatrix),Ph.multiplyScalar(1/Ph.w),Ph.x=ay/n.width,Ph.y=ay/n.height,Ph.applyMatrix4(a.projectionMatrixInverse),Ph.multiplyScalar(1/Ph.w),Math.abs(Math.max(Ph.x,Ph.y))}function zHe(a,e){const n=a.matrixWorld,i=a.geometry,s=i.attributes.instanceStart,r=i.attributes.instanceEnd,o=Math.min(i.instanceCount,s.count);for(let l=0,c=o;l<c;l++){To.start.fromBufferAttribute(s,l),To.end.fromBufferAttribute(r,l),To.applyMatrix4(n);const u=new ye,h=new ye;Vh.distanceSqToSegment(To.start,To.end,h,u),h.distanceTo(u)<ay*.5&&e.push({point:h,pointOnLine:u,distance:Vh.origin.distanceTo(h),object:a,face:null,faceIndex:l,uv:null,uv1:null})}}function GHe(a,e,n){const i=e.projectionMatrix,r=a.material.resolution,o=a.matrixWorld,l=a.geometry,c=l.attributes.instanceStart,u=l.attributes.instanceEnd,h=Math.min(l.instanceCount,c.count),f=-e.near;Vh.at(1,Rh),Rh.w=1,Rh.applyMatrix4(e.matrixWorldInverse),Rh.applyMatrix4(i),Rh.multiplyScalar(1/Rh.w),Rh.x*=r.x/2,Rh.y*=r.y/2,Rh.z=0,t6.copy(Rh),n6.multiplyMatrices(e.matrixWorldInverse,o);for(let m=0,A=h;m<A;m++){if(bo.fromBufferAttribute(c,m),So.fromBufferAttribute(u,m),bo.w=1,So.w=1,bo.applyMatrix4(n6),So.applyMatrix4(n6),bo.z>f&&So.z>f)continue;if(bo.z>f){const I=bo.z-So.z,F=(bo.z-f)/I;bo.lerp(So,F)}else if(So.z>f){const I=So.z-bo.z,F=(So.z-f)/I;So.lerp(bo,F)}bo.applyMatrix4(i),So.applyMatrix4(i),bo.multiplyScalar(1/bo.w),So.multiplyScalar(1/So.w),bo.x*=r.x/2,bo.y*=r.y/2,So.x*=r.x/2,So.y*=r.y/2,To.start.copy(bo),To.start.z=0,To.end.copy(So),To.end.z=0;const T=To.closestPointToPointParameter(t6,!0);To.at(T,hY);const E=Xy.lerp(bo.z,So.z,T),M=E>=-1&&E<=1,N=t6.distanceTo(hY)<ay*.5;if(M&&N){To.start.fromBufferAttribute(c,m),To.end.fromBufferAttribute(u,m),To.start.applyMatrix4(o),To.end.applyMatrix4(o);const I=new ye,F=new ye;Vh.distanceSqToSegment(To.start,To.end,F,I),n.push({point:F,pointOnLine:I,distance:Vh.origin.distanceTo(F),object:a,face:null,faceIndex:m,uv:null,uv1:null})}}}class qHe extends Na{constructor(e=new moe,n=new j7({color:Math.random()*16777215})){super(e,n),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,n=e.attributes.instanceStart,i=e.attributes.instanceEnd,s=new Float32Array(2*n.count);for(let o=0,l=0,c=n.count;o<c;o++,l+=2)uY.fromBufferAttribute(n,o),dY.fromBufferAttribute(i,o),s[l]=l===0?0:s[l-1],s[l+1]=s[l]+uY.distanceTo(dY);const r=new XS(s,2,1);return e.setAttribute("instanceDistanceStart",new kl(r,1,0)),e.setAttribute("instanceDistanceEnd",new kl(r,1,1)),this}raycast(e,n){const i=this.material.worldUnits,s=e.camera;s===null&&!i&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const r=e.params.Line2!==void 0&&e.params.Line2.threshold||0;Vh=e.ray;const o=this.matrixWorld,l=this.geometry,c=this.material;ay=c.linewidth+r,l.boundingSphere===null&&l.computeBoundingSphere(),fC.copy(l.boundingSphere).applyMatrix4(o);let u;if(i)u=ay*.5;else{const f=Math.max(s.near,fC.distanceToPoint(Vh.origin));u=fY(s,f,c.resolution)}if(fC.radius+=u,Vh.intersectsSphere(fC)===!1)return;l.boundingBox===null&&l.computeBoundingBox(),hC.copy(l.boundingBox).applyMatrix4(o);let h;if(i)h=ay*.5;else{const f=Math.max(s.near,hC.distanceToPoint(Vh.origin));h=fY(s,f,c.resolution)}hC.expandByScalar(h),Vh.intersectsBox(hC)!==!1&&(i?zHe(this,n):GHe(this,s,n))}onBeforeRender(e){const n=this.material.uniforms;n&&n.resolution&&(e.getViewport(e6),this.material.uniforms.resolution.value.set(e6.z,e6.w))}}class goe extends moe{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const n=e.length-3,i=new Float32Array(2*n);for(let s=0;s<n;s+=3)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5];return super.setPositions(i),this}setColors(e){const n=e.length-3,i=new Float32Array(2*n);for(let s=0;s<n;s+=3)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5];return super.setColors(i),this}setFromPoints(e){const n=e.length-1,i=new Float32Array(6*n);for(let s=0;s<n;s++)i[6*s]=e[s].x,i[6*s+1]=e[s].y,i[6*s+2]=e[s].z||0,i[6*s+3]=e[s+1].x,i[6*s+4]=e[s+1].y,i[6*s+5]=e[s+1].z||0;return super.setPositions(i),this}fromLine(e){const n=e.geometry;return this.setPositions(n.attributes.position.array),this}}class HHe extends qHe{constructor(e=new goe,n=new j7({color:Math.random()*16777215})){super(e,n),this.isLine2=!0,this.type="Line2"}}class pY extends ew{constructor(e,n={}){const i=n.font;if(i===void 0)super();else{const s=i.generateShapes(e,n.size,n.direction);n.depth===void 0&&(n.depth=50),n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),super(s,n)}this.type="TextGeometry"}}class WHe{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,n=100,i="ltr"){const s=[],r=$He(e,n,this.data,i);for(let o=0,l=r.length;o<l;o++)s.push(...r[o].toShapes());return s}}function $He(a,e,n,i){const s=Array.from(a),r=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,l=[];let c=0,u=0;(i=="rtl"||i=="tb")&&s.reverse();for(let h=0;h<s.length;h++){const f=s[h];if(f===`
`)c=0,u-=o;else{const m=KHe(f,r,c,u,n);i=="tb"?(c=0,u+=n.ascender*r):c+=m.offsetX,l.push(m.path)}}return l}function KHe(a,e,n,i,s){const r=s.glyphs[a]||s.glyphs["?"];if(!r){console.error('THREE.Font: character "'+a+'" does not exists in font family '+s.familyName+".");return}const o=new tte;let l,c,u,h,f,m,A,x;if(r.o){const T=r._cachedOutline||(r._cachedOutline=r.o.split(" "));for(let E=0,M=T.length;E<M;)switch(T[E++]){case"m":l=T[E++]*e+n,c=T[E++]*e+i,o.moveTo(l,c);break;case"l":l=T[E++]*e+n,c=T[E++]*e+i,o.lineTo(l,c);break;case"q":u=T[E++]*e+n,h=T[E++]*e+i,f=T[E++]*e+n,m=T[E++]*e+i,o.quadraticCurveTo(f,m,u,h);break;case"b":u=T[E++]*e+n,h=T[E++]*e+i,f=T[E++]*e+n,m=T[E++]*e+i,A=T[E++]*e+n,x=T[E++]*e+i,o.bezierCurveTo(f,m,A,x,u,h);break}}return{offsetX:r.ha*e,path:o}}function $O(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=Array(e);n<e;n++)i[n]=a[n];return i}function YHe(a){if(Array.isArray(a))return a}function XHe(a){if(Array.isArray(a))return $O(a)}function Aoe(a,e,n){if(typeof a=="function"?a===e:a.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function QHe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function mY(a,e,n,i,s,r,o){try{var l=a[r](o),c=l.value}catch(u){return void n(u)}l.done?e(c):Promise.resolve(c).then(i,s)}function JHe(a){return function(){var e=this,n=arguments;return new Promise(function(i,s){var r=a.apply(e,n);function o(c){mY(r,i,s,o,l,"next",c)}function l(c){mY(r,i,s,o,l,"throw",c)}o(void 0)})}}function oI(a,e,n){return e=yx(e),oWe(a,U7()?Reflect.construct(e,n||[],yx(a).constructor):e.apply(a,n))}function ZHe(a,e){if(e.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lI(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function T2(a,e){return a.get(Aoe(a,e))}function a6(a,e,n){ZHe(a,e),e.set(a,n)}function i6(a,e,n){return a.set(Aoe(a,e),n),n}function B7(a,e,n){if(U7())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var s=new(a.bind.apply(a,i));return s}function eWe(a,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,yoe(i.key),i)}}function cI(a,e,n){return e&&eWe(a.prototype,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Ao(a,e,n){return(e=yoe(e))in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}function KO(){return KO=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(a,e,n){var i=lWe(a,e);if(i){var s=Object.getOwnPropertyDescriptor(i,e);return s.get?s.get.call(arguments.length<3?a:n):s.value}},KO.apply(null,arguments)}function yx(a){return yx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yx(a)}function uI(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&XO(a,e)}function U7(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(U7=function(){return!!a})()}function tWe(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function nWe(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i,s,r,o,l=[],c=!0,u=!1;try{if(r=(n=n.call(a)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function aWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gY(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,i)}return n}function Fi(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?gY(Object(n),!0).forEach(function(i){Ao(a,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):gY(Object(n)).forEach(function(i){Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(n,i))})}return a}function sWe(a,e){if(a==null)return{};var n,i,s=rWe(a,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);for(i=0;i<r.length;i++)n=r[i],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(a,n)&&(s[n]=a[n])}return s}function rWe(a,e){if(a==null)return{};var n={};for(var i in a)if({}.hasOwnProperty.call(a,i)){if(e.indexOf(i)!==-1)continue;n[i]=a[i]}return n}function oWe(a,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QHe(a)}function YO(){var a,e,n=typeof Symbol=="function"?Symbol:{},i=n.iterator||"@@iterator",s=n.toStringTag||"@@toStringTag";function r(A,x,T,E){var M=x&&x.prototype instanceof l?x:l,N=Object.create(M.prototype);return Qc(N,"_invoke",(function(I,F,G){var O,D,j,L=0,U=G||[],q=!1,K={p:0,n:0,v:a,a:H,f:H.bind(a,4),d:function(X,ne){return O=X,D=0,j=a,K.n=ne,o}};function H(X,ne){for(D=X,j=ne,e=0;!q&&L&&!Q&&e<U.length;e++){var Q,Y=U[e],ue=K.p,pe=Y[2];X>3?(Q=pe===ne)&&(j=Y[(D=Y[4])?5:(D=3,3)],Y[4]=Y[5]=a):Y[0]<=ue&&((Q=X<2&&ue<Y[1])?(D=0,K.v=ne,K.n=Y[1]):ue<pe&&(Q=X<3||Y[0]>ne||ne>pe)&&(Y[4]=X,Y[5]=ne,K.n=pe,D=0))}if(Q||X>1)return o;throw q=!0,ne}return function(X,ne,Q){if(L>1)throw TypeError("Generator is already running");for(q&&ne===1&&H(ne,Q),D=ne,j=Q;(e=D<2?a:j)||!q;){O||(D?D<3?(D>1&&(K.n=-1),H(D,j)):K.n=j:K.v=j);try{if(L=2,O){if(D||(X="next"),e=O[X]){if(!(e=e.call(O,j)))throw TypeError("iterator result is not an object");if(!e.done)return e;j=e.value,D<2&&(D=0)}else D===1&&(e=O.return)&&e.call(O),D<2&&(j=TypeError("The iterator does not provide a '"+X+"' method"),D=1);O=a}else if((e=(q=K.n<0)?j:I.call(F,K))!==o)break}catch(Y){O=a,D=1,j=Y}finally{L=1}}return{value:e,done:q}}})(A,T,E),!0),N}var o={};function l(){}function c(){}function u(){}e=Object.getPrototypeOf;var h=[][i]?e(e([][i]())):(Qc(e={},i,function(){return this}),e),f=u.prototype=l.prototype=Object.create(h);function m(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,u):(A.__proto__=u,Qc(A,s,"GeneratorFunction")),A.prototype=Object.create(f),A}return c.prototype=u,Qc(f,"constructor",u),Qc(u,"constructor",c),c.displayName="GeneratorFunction",Qc(u,s,"GeneratorFunction"),Qc(f),Qc(f,s,"Generator"),Qc(f,i,function(){return this}),Qc(f,"toString",function(){return"[object Generator]"}),(YO=function(){return{w:r,m}})()}function Qc(a,e,n,i){var s=Object.defineProperty;try{s({},"",{})}catch{s=0}Qc=function(r,o,l,c){function u(h,f){Qc(r,h,function(m){return this._invoke(h,f,m)})}o?s?s(r,o,{value:l,enumerable:!c,configurable:!c,writable:!c}):r[o]=l:(u("next",0),u("throw",1),u("return",2))},Qc(a,e,n,i)}function XO(a,e){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},XO(a,e)}function vs(a,e){return YHe(a)||nWe(a,e)||voe(a,e)||aWe()}function lWe(a,e){for(;!{}.hasOwnProperty.call(a,e)&&(a=yx(a))!==null;);return a}function s6(a,e,n,i){var s=KO(yx(a.prototype),e,n);return typeof s=="function"?function(r){return s.apply(n,r)}:s}function Wi(a){return XHe(a)||tWe(a)||voe(a)||iWe()}function cWe(a,e){if(typeof a!="object"||!a)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var i=n.call(a,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function yoe(a){var e=cWe(a,"string");return typeof e=="symbol"?e:e+""}function voe(a,e){if(a){if(typeof a=="string")return $O(a,e);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$O(a,e):void 0}}var _oe=function(e){e instanceof Array?e.forEach(_oe):(e.map&&e.map.dispose(),e.dispose())},V7=function(e){e.geometry&&e.geometry.dispose(),e.material&&_oe(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(V7)},Zi=function(e){if(e&&e.children)for(;e.children.length;){var n=e.children[0];e.remove(n),V7(n)}};function Ul(a,e){var n=new e;return{linkProp:function(s){return{default:n[s](),onChange:function(o,l){l[a][s](o)},triggerUpdate:!1}},linkMethod:function(s){return function(r){for(var o=r[a],l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];var h=o[s].apply(o,c);return h===o?this:h}}}}var hs=100;function AY(){return hs}function Qu(a,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-a)*Math.PI/180,s=(90-e)*Math.PI/180,r=hs*(1+n),o=Math.sin(i);return{x:r*o*Math.cos(s),y:r*Math.cos(i),z:r*o*Math.sin(s)}}function xoe(a){var e=a.x,n=a.y,i=a.z,s=Math.sqrt(e*e+n*n+i*i),r=Math.acos(n/s),o=Math.atan2(i,e);return{lat:90-r*180/Math.PI,lng:90-o*180/Math.PI-(o<-Math.PI/2?360:0),altitude:s/hs-1}}function kA(a){return a*Math.PI/180}var mT=window.THREE?window.THREE:{BackSide:Di,BufferAttribute:Ua,Color:on,Mesh:Na,ShaderMaterial:mo},uWe=`
uniform float hollowRadius;

varying vec3 vVertexWorldPosition;
varying vec3 vVertexNormal;
varying float vCameraDistanceToObjCenter;
varying float vVertexAngularDistanceToHollowRadius;

void main() {    
  vVertexNormal	= normalize(normalMatrix * normal);
  vVertexWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
  
  vec4 objCenterViewPosition = modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0);
  vCameraDistanceToObjCenter = length(objCenterViewPosition);
  
  float edgeAngle = atan(hollowRadius / vCameraDistanceToObjCenter);
  float vertexAngle = acos(dot(normalize(modelViewMatrix * vec4(position, 1.0)), normalize(objCenterViewPosition)));
  vVertexAngularDistanceToHollowRadius = vertexAngle - edgeAngle;

  gl_Position	= projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}`,dWe=`
uniform vec3 color;
uniform float coefficient;
uniform float power;
uniform float hollowRadius;

varying vec3 vVertexNormal;
varying vec3 vVertexWorldPosition;
varying float vCameraDistanceToObjCenter;
varying float vVertexAngularDistanceToHollowRadius;

void main() {
  if (vCameraDistanceToObjCenter < hollowRadius) discard; // inside the hollowRadius
  if (vVertexAngularDistanceToHollowRadius < 0.0) discard; // frag position is within the hollow radius

  vec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;
  vec3 viewCameraToVertex	= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;
  viewCameraToVertex = normalize(viewCameraToVertex);
  float intensity	= pow(
    coefficient + dot(vVertexNormal, viewCameraToVertex),
    power
  );
  gl_FragColor = vec4(color, intensity);
}`;function hWe(a,e,n,i){return new mT.ShaderMaterial({depthWrite:!1,transparent:!0,vertexShader:uWe,fragmentShader:dWe,uniforms:{coefficient:{value:a},color:{value:new mT.Color(e)},power:{value:n},hollowRadius:{value:i}}})}function fWe(a,e){for(var n=a.clone(),i=new Float32Array(a.attributes.position.count*3),s=0,r=i.length;s<r;s++){var o=a.attributes.normal.array[s],l=a.attributes.position.array[s];i[s]=l+o*e}return n.setAttribute("position",new mT.BufferAttribute(i,3)),n}var pWe=(function(a){function e(n){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=s.color,o=r===void 0?"gold":r,l=s.size,c=l===void 0?2:l,u=s.coefficient,h=u===void 0?.5:u,f=s.power,m=f===void 0?1:f,A=s.hollowRadius,x=A===void 0?0:A,T=s.backside,E=T===void 0?!0:T;lI(this,e),i=oI(this,e);var M=fWe(n,c),N=hWe(h,o,m,x);return E&&(N.side=mT.BackSide),i.geometry=M,i.material=N,i}return uI(e,a),cI(e)})(mT.Mesh),Ih=window.THREE?window.THREE:{Color:on,Group:ll,LineBasicMaterial:Hr,LineSegments:Zu,Mesh:Na,MeshPhongMaterial:m4,SphereGeometry:vu,SRGBColorSpace:Fr,TextureLoader:g4},boe=Wr({props:{globeImageUrl:{},bumpImageUrl:{},showGlobe:{default:!0,onChange:function(e,n){n.globeGroup.visible=!!e},triggerUpdate:!1},showGraticules:{default:!1,onChange:function(e,n){n.graticulesObj.visible=!!e},triggerUpdate:!1},showAtmosphere:{default:!0,onChange:function(e,n){n.atmosphereObj&&(n.atmosphereObj.visible=!!e)},triggerUpdate:!1},atmosphereColor:{default:"lightskyblue"},atmosphereAltitude:{default:.15},globeCurvatureResolution:{default:4},globeTileEngineUrl:{onChange:function(e,n){n.tileEngine.tileUrl=e}},globeTileEngineMaxLevel:{default:17,onChange:function(e,n){n.tileEngine.maxLevel=e},triggerUpdate:!1},updatePov:{onChange:function(e,n){n.tileEngine.updatePov(e)},triggerUpdate:!1},onReady:{default:function(){},triggerUpdate:!1}},methods:{globeMaterial:function(e,n){return n!==void 0?(e.globeObj.material=n||e.defaultGlobeMaterial,this):e.globeObj.material},globeTileEngineClearCache:function(e){e.tileEngine.clearTiles()},_destructor:function(e){Zi(e.globeObj),Zi(e.tileEngine),Zi(e.graticulesObj)}},stateInit:function(){var e=new Ih.MeshPhongMaterial({color:0}),n=new Ih.Mesh(void 0,e);n.rotation.y=-Math.PI/2;var i=new A5e(hs),s=new Ih.Group;s.__globeObjType="globe",s.add(n),s.add(i);var r=new Ih.LineSegments(new rne(kDe(),hs,2),new Ih.LineBasicMaterial({color:"lightgrey",transparent:!0,opacity:.1}));return{globeGroup:s,globeObj:n,graticulesObj:r,defaultGlobeMaterial:e,tileEngine:i}},init:function(e,n){Zi(e),n.scene=e,n.scene.add(n.globeGroup),n.scene.add(n.graticulesObj),n.ready=!1},update:function(e,n){var i=e.globeObj.material;if(e.tileEngine.visible=!(e.globeObj.visible=!e.globeTileEngineUrl),n.hasOwnProperty("globeCurvatureResolution")){var s;(s=e.globeObj.geometry)===null||s===void 0||s.dispose();var r=Math.max(4,Math.round(360/e.globeCurvatureResolution));e.globeObj.geometry=new Ih.SphereGeometry(hs,r,r/2),e.tileEngine.curvatureResolution=e.globeCurvatureResolution}if(n.hasOwnProperty("globeImageUrl")&&(e.globeImageUrl?new Ih.TextureLoader().load(e.globeImageUrl,function(l){l.colorSpace=Ih.SRGBColorSpace,i.map=l,i.color=null,i.needsUpdate=!0,!e.ready&&(e.ready=!0)&&setTimeout(e.onReady)}):!i.color&&(i.color=new Ih.Color(0))),n.hasOwnProperty("bumpImageUrl")&&(e.bumpImageUrl?e.bumpImageUrl&&new Ih.TextureLoader().load(e.bumpImageUrl,function(l){i.bumpMap=l,i.needsUpdate=!0}):(i.bumpMap=null,i.needsUpdate=!0)),(n.hasOwnProperty("atmosphereColor")||n.hasOwnProperty("atmosphereAltitude"))&&(e.atmosphereObj&&(e.scene.remove(e.atmosphereObj),Zi(e.atmosphereObj)),e.atmosphereColor&&e.atmosphereAltitude)){var o=e.atmosphereObj=new pWe(e.globeObj.geometry,{color:e.atmosphereColor,size:hs*e.atmosphereAltitude,hollowRadius:hs,coefficient:.1,power:3.5});o.visible=!!e.showAtmosphere,o.__globeObjType="atmosphere",e.scene.add(o)}!e.ready&&(!e.globeImageUrl||e.globeTileEngineUrl)&&(e.ready=!0,e.onReady())}}),Wf=function(e){return isNaN(e)?parseInt(Hn(e).toHex(),16):e},Hd=function(e){return e&&isNaN(e)?Jy(e).opacity:1},_0=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s,r=1,o=/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.eE+-]+)\s*\)$/.exec(e.trim().toLowerCase());if(o){var l=o.slice(1),c=vs(l,4),u=c[0],h=c[1],f=c[2],m=c[3];s=new on("rgb(".concat(+u,",").concat(+h,",").concat(+f,")")),r=Math.min(+m,1)}else s=new on(e);i&&s.convertLinearToSRGB();var A=s.toArray();return n?[].concat(Wi(A),[r]):A};function mWe(a,e,n){return a.opacity=e,a.transparent=e<1,a.depthWrite=e>=1,a}var yY=window.THREE?window.THREE:{BufferAttribute:Ua};function $f(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float32Array;if(e===1)return new yY.BufferAttribute(new n(a),e);for(var i=new yY.BufferAttribute(new n(a.length*e),e),s=0,r=a.length;s<r;s++)i.set(a[s],s*e);return i}function gWe(a){for(var e=a.itemSize,n=[],i=0;i<a.count;i++)n.push(a.array.slice(i*e,(i+1)*e));return n}var r6=new WeakMap,pC=new WeakMap,mC=new WeakMap,Rc=(function(a){function e(n){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=s.dataBindAttr,o=r===void 0?"__data":r,l=s.objBindAttr,c=l===void 0?"__threeObj":l,u=s.removeDelay,h=u===void 0?0:u;return lI(this,e),i=oI(this,e),Ao(i,"scene",void 0),a6(i,r6,void 0),a6(i,pC,void 0),a6(i,mC,void 0),i.scene=n,i6(r6,i,o),i6(pC,i,c),i6(mC,i,h),i.onRemoveObj(function(){}),i}return uI(e,a),cI(e,[{key:"onCreateObj",value:function(i){var s=this;return s6(e,"onCreateObj",this)([function(r){var o=i(r);return r[T2(pC,s)]=o,o[T2(r6,s)]=r,s.scene.add(o),o}]),this}},{key:"onRemoveObj",value:function(i){var s=this;return s6(e,"onRemoveObj",this)([function(r,o){var l=s6(e,"getData",s)([r]);i(r,o);var c=function(){s.scene.remove(r),Zi(r),delete l[T2(pC,s)]};T2(mC,s)?setTimeout(c,T2(mC,s)):c()}]),this}}])})(W6e),wd=window.THREE?window.THREE:{BufferGeometry:zn,CylinderGeometry:d1,Matrix4:_n,Mesh:Na,MeshLambertMaterial:nh,Object3D:ni,Vector3:ye},vY=Object.assign({},tB),_Y=vY.BufferGeometryUtils||vY,Soe=Wr({props:{pointsData:{default:[]},pointLat:{default:"lat"},pointLng:{default:"lng"},pointColor:{default:function(){return"#ffffaa"}},pointAltitude:{default:.1},pointRadius:{default:.25},pointResolution:{default:12,triggerUpdate:!1},pointsMerge:{default:!1},pointsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,n,i){var s=i.tweenGroup;Zi(e),n.scene=e,n.tweenGroup=s,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjPoint"})},update:function(e,n){var i=Yt(e.pointLat),s=Yt(e.pointLng),r=Yt(e.pointAltitude),o=Yt(e.pointRadius),l=Yt(e.pointColor),c=new wd.CylinderGeometry(1,1,1,e.pointResolution);c.applyMatrix4(new wd.Matrix4().makeRotationX(Math.PI/2)),c.applyMatrix4(new wd.Matrix4().makeTranslation(0,0,-.5));var u=2*Math.PI*hs/360,h={};if(!e.pointsMerge&&n.hasOwnProperty("pointsMerge")&&Zi(e.scene),e.dataMapper.scene=e.pointsMerge?new wd.Object3D:e.scene,e.dataMapper.onCreateObj(A).onUpdateObj(x).digest(e.pointsData),e.pointsMerge){var f=e.pointsData.length?(_Y.mergeGeometries||_Y.mergeBufferGeometries)(e.pointsData.map(function(T){var E=e.dataMapper.getObj(T),M=E.geometry.clone();E.updateMatrix(),M.applyMatrix4(E.matrix);var N=_0(l(T));return M.setAttribute("color",$f(Array(M.getAttribute("position").count).fill(N),4)),M})):new wd.BufferGeometry,m=new wd.Mesh(f,new wd.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0}));m.__globeObjType="points",m.__data=e.pointsData,e.dataMapper.clear(),Zi(e.scene),e.scene.add(m)}function A(){var T=new wd.Mesh(c);return T.__globeObjType="point",T}function x(T,E){var M=function(j){var L=T.__currentTargetD=j,U=L.r,q=L.alt,K=L.lat,H=L.lng;Object.assign(T.position,Qu(K,H));var X=e.pointsMerge?new wd.Vector3(0,0,0):e.scene.localToWorld(new wd.Vector3(0,0,0));T.lookAt(X),T.scale.x=T.scale.y=Math.min(30,U)*u,T.scale.z=Math.max(q*hs,.1)},N={alt:+r(E),r:+o(E),lat:+i(E),lng:+s(E)},I=T.__currentTargetD||Object.assign({},N,{alt:-.001});if(Object.keys(N).some(function(D){return I[D]!==N[D]})&&(e.pointsMerge||!e.pointsTransitionDuration||e.pointsTransitionDuration<0?M(N):e.tweenGroup.add(new gl(I).to(N,e.pointsTransitionDuration).easing(Nr.Quadratic.InOut).onUpdate(M).start())),!e.pointsMerge){var F=l(E),G=F?Hd(F):0,O=!!G;T.visible=O,O&&(h.hasOwnProperty(F)||(h[F]=new wd.MeshLambertMaterial({color:Wf(F),transparent:G<1,opacity:G})),T.material=h[F])}}}}),Toe=function(){return{uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:`
    `.concat(_a.common,`
    `).concat(_a.logdepthbuf_pars_vertex,`
  
    uniform float dashTranslate; 

    attribute vec4 color;
    varying vec4 vColor;
    
    attribute float relDistance;
    varying float vRelDistance;

    void main() {
      // pass through colors and distances
      vColor = color;
      vRelDistance = relDistance + dashTranslate;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  
      `).concat(_a.logdepthbuf_vertex,`
    }
  `),fragmentShader:`
    `.concat(_a.logdepthbuf_pars_fragment,`

    uniform float dashOffset; 
    uniform float dashSize;
    uniform float gapSize; 
    
    varying vec4 vColor;
    varying float vRelDistance;
    
    void main() {
      // ignore pixels in the gap
      if (vRelDistance < dashOffset) discard;
      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;
    
      // set px color: [r, g, b, a], interpolated between vertices 
      gl_FragColor = vColor; 
  
      `).concat(_a.logdepthbuf_fragment,`
    }
  `)}},QO=function(e){return e.uniforms.uSurfaceRadius={type:"float",value:0},e.vertexShader=(`attribute float surfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.vertexShader).replace("void main() {",["void main() {","vSurfaceRadius = surfaceRadius;","vPos = position;"].join(`
`)),e.fragmentShader=(`uniform float uSurfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.fragmentShader).replace("void main() {",["void main() {","if (length(vPos) < max(uSurfaceRadius, vSurfaceRadius)) discard;"].join(`
`)),e},AWe=function(e){return e.vertexShader=`
    attribute float r;
    
    const float PI = 3.1415926535897932384626433832795;
    float toRad(in float a) {
      return a * PI / 180.0;
    }
    
    vec3 Polar2Cartesian(in vec3 c) { // [lat, lng, r]
      float phi = toRad(90.0 - c.x);
      float theta = toRad(90.0 - c.y);
      float r = c.z;
      return vec3( // x,y,z
        r * sin(phi) * cos(theta),
        r * cos(phi),
        r * sin(phi) * sin(theta)
      );
    }
    
    vec2 Cartesian2Polar(in vec3 p) {
      float r = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);
      float phi = acos(p.y / r);
      float theta = atan(p.z, p.x);
      return vec2( // lat,lng
        90.0 - phi * 180.0 / PI,
        90.0 - theta * 180.0 / PI - (theta < -PI / 2.0 ? 360.0 : 0.0)
      );
    }
    `.concat(e.vertexShader.replace("}",`                  
        vec3 pos = Polar2Cartesian(vec3(Cartesian2Polar(position), r));
        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
      }
    `),`
  `),e},z7=function(e,n){return e.onBeforeCompile=function(i){e.userData.shader=n(i)},e},yWe=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(s){return s};if(e.userData.shader)n(e.userData.shader.uniforms);else{var i=e.onBeforeCompile;e.onBeforeCompile=function(s){i(s),n(s.uniforms)}}},vWe=["stroke"],Ed=window.THREE?window.THREE:{BufferGeometry:zn,CubicBezierCurve3:fj,Curve:ed,Group:ll,Line:Kd,Mesh:Na,NormalBlending:fl,ShaderMaterial:mo,TubeGeometry:nw,Vector3:ye},_We=hx.default||hx,woe=Wr({props:{arcsData:{default:[]},arcStartLat:{default:"startLat"},arcStartLng:{default:"startLng"},arcStartAltitude:{default:0},arcEndLat:{default:"endLat"},arcEndLng:{default:"endLng"},arcEndAltitude:{default:0},arcColor:{default:function(){return"#ffffaa"}},arcAltitude:{},arcAltitudeAutoScale:{default:.5},arcStroke:{},arcCurveResolution:{default:64,triggerUpdate:!1},arcCircularResolution:{default:6,triggerUpdate:!1},arcDashLength:{default:1},arcDashGap:{default:0},arcDashInitialGap:{default:0},arcDashAnimateTime:{default:0},arcsTransitionDuration:{default:1e3,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var n;(n=e.ticker)===null||n===void 0||n.pause()},resumeAnimation:function(e){var n;(n=e.ticker)===null||n===void 0||n.resume()},_destructor:function(e){var n;e.sharedMaterial.dispose(),(n=e.ticker)===null||n===void 0||n.dispose()}},stateInit:function(e){var n=e.tweenGroup;return{tweenGroup:n,ticker:new _We,sharedMaterial:new Ed.ShaderMaterial(Fi(Fi({},Toe()),{},{transparent:!0,blending:Ed.NormalBlending}))}},init:function(e,n){Zi(e),n.scene=e,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjArc"}).onCreateObj(function(){var i=new Ed.Group;return i.__globeObjType="arc",i}),n.ticker.onTick.add(function(i,s){n.dataMapper.entries().map(function(r){var o=vs(r,2),l=o[1];return l}).filter(function(r){return r.children.length&&r.children[0].material&&r.children[0].__dashAnimateStep}).forEach(function(r){var o=r.children[0],l=o.__dashAnimateStep*s,c=o.material.uniforms.dashTranslate.value%1e9;o.material.uniforms.dashTranslate.value=c+l})})},update:function(e){var n=Yt(e.arcStartLat),i=Yt(e.arcStartLng),s=Yt(e.arcStartAltitude),r=Yt(e.arcEndLat),o=Yt(e.arcEndLng),l=Yt(e.arcEndAltitude),c=Yt(e.arcAltitude),u=Yt(e.arcAltitudeAutoScale),h=Yt(e.arcStroke),f=Yt(e.arcColor),m=Yt(e.arcDashLength),A=Yt(e.arcDashGap),x=Yt(e.arcDashInitialGap),T=Yt(e.arcDashAnimateTime);e.dataMapper.onUpdateObj(function(I,F){var G=h(F),O=G!=null;if(!I.children.length||O!==(I.children[0].type==="Mesh")){Zi(I);var D=O?new Ed.Mesh:new Ed.Line(new Ed.BufferGeometry);D.material=e.sharedMaterial.clone(),I.add(D)}var j=I.children[0];Object.assign(j.material.uniforms,{dashSize:{value:m(F)},gapSize:{value:A(F)},dashOffset:{value:x(F)}});var L=T(F);j.__dashAnimateStep=L>0?1e3/L:0;var U=M(f(F),e.arcCurveResolution,O?e.arcCircularResolution+1:1),q=N(e.arcCurveResolution,O?e.arcCircularResolution+1:1,!0);j.geometry.setAttribute("color",U),j.geometry.setAttribute("relDistance",q);var K=function(Q){var Y=I.__currentTargetD=Q,ue=Y.stroke,pe=sWe(Y,vWe),Ee=E(pe);O?(j.geometry&&j.geometry.dispose(),j.geometry=new Ed.TubeGeometry(Ee,e.arcCurveResolution,ue/2,e.arcCircularResolution),j.geometry.setAttribute("color",U),j.geometry.setAttribute("relDistance",q)):j.geometry.setFromPoints(Ee.getPoints(e.arcCurveResolution))},H={stroke:G,alt:c(F),altAutoScale:+u(F),startLat:+n(F),startLng:+i(F),startAlt:+s(F),endLat:+r(F),endLng:+o(F),endAlt:+l(F)},X=I.__currentTargetD||Object.assign({},H,{altAutoScale:-.001});Object.keys(H).some(function(ne){return X[ne]!==H[ne]})&&(!e.arcsTransitionDuration||e.arcsTransitionDuration<0?K(H):e.tweenGroup.add(new gl(X).to(H,e.arcsTransitionDuration).easing(Nr.Quadratic.InOut).onUpdate(K).start()))}).digest(e.arcsData);function E(I){var F=I.alt,G=I.altAutoScale,O=I.startLat,D=I.startLng,j=I.startAlt,L=I.endLat,U=I.endLng,q=I.endAlt,K=function(te){var fe=vs(te,3),Le=fe[0],Fe=fe[1],Ie=fe[2],at=Qu(Fe,Le,Ie),je=at.x,Ve=at.y,Me=at.z;return new Ed.Vector3(je,Ve,Me)},H=[D,O],X=[U,L],ne=F;if(ne==null&&(ne=A0(H,X)/2*G+Math.max(j,q)),ne||j||q){var Q=Xj(H,X),Y=function(te,fe){return fe+(fe-te)*(te<fe?.5:.25)},ue=[.25,.75].map(function(ce){return[].concat(Wi(Q(ce)),[Y(ce<.5?j:q,ne)])}),pe=vs(ue,2),Ee=pe[0],oe=pe[1],Ae=B7(Ed.CubicBezierCurve3,Wi([[].concat(H,[j]),Ee,oe,[].concat(X,[q])].map(K)));return Ae}else{var be=.001;return Ce.apply(void 0,Wi([[].concat(H,[be]),[].concat(X,[be])].map(K)))}function Ce(ce,te){var fe=ce.angleTo(te),Le=fe===0?function(){return ce.clone()}:function(Ie){return new Ed.Vector3().addVectors(ce.clone().multiplyScalar(Math.sin((1-Ie)*fe)),te.clone().multiplyScalar(Math.sin(Ie*fe))).divideScalar(Math.sin(fe))},Fe=new Ed.Curve;return Fe.getPoint=Le,Fe}}function M(I,F){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,O=F+1,D;if(I instanceof Array||I instanceof Function){var j=I instanceof Array?bm().domain(I.map(function(ne,Q){return Q/(I.length-1)})).range(I):I;D=function(Q){return _0(j(Q),!0,!0)}}else{var L=_0(I,!0,!0);D=function(){return L}}for(var U=[],q=0,K=O;q<K;q++)for(var H=D(q/(K-1)),X=0;X<G;X++)U.push(H);return $f(U,4)}function N(I){for(var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=I+1,D=[],j=0,L=O;j<L;j++)for(var U=j/(L-1),q=0;q<F;q++)D.push(U);return G&&D.reverse(),$f(D,1)}}}),Ag=window.THREE?window.THREE:{BufferGeometry:zn,DoubleSide:er,Mesh:Na,MeshLambertMaterial:nh,Object3D:ni},xY=Object.assign({},tB),bY=xY.BufferGeometryUtils||xY,Eoe=Wr({props:{hexBinPointsData:{default:[]},hexBinPointLat:{default:"lat"},hexBinPointLng:{default:"lng"},hexBinPointWeight:{default:1},hexBinResolution:{default:4},hexMargin:{default:.2},hexTopCurvatureResolution:{default:5},hexTopColor:{default:function(){return"#ffffaa"}},hexSideColor:{default:function(){return"#ffffaa"}},hexAltitude:{default:function(e){var n=e.sumWeight;return n*.01}},hexBinMerge:{default:!1},hexTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,n,i){var s=i.tweenGroup;Zi(e),n.scene=e,n.tweenGroup=s,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjHexbin"})},update:function(e,n){var i=Yt(e.hexBinPointLat),s=Yt(e.hexBinPointLng),r=Yt(e.hexBinPointWeight),o=Yt(e.hexAltitude),l=Yt(e.hexTopColor),c=Yt(e.hexSideColor),u=Yt(e.hexMargin),h=pOe(e.hexBinPointsData.map(function(N){return Fi(Fi({},N),{},{h3Idx:ZOe(i(N),s(N),e.hexBinResolution)})}),"h3Idx"),f=Object.entries(h).map(function(N){var I=vs(N,2),F=I[0],G=I[1];return{h3Idx:F,points:G,sumWeight:G.reduce(function(O,D){return O+ +r(D)},0)}}),m={};if(!e.hexBinMerge&&n.hasOwnProperty("hexBinMerge")&&Zi(e.scene),e.dataMapper.scene=e.hexBinMerge?new Ag.Object3D:e.scene,e.dataMapper.id(function(N){return N.h3Idx}).onCreateObj(E).onUpdateObj(M).digest(f),e.hexBinMerge){var A=f.length?(bY.mergeGeometries||bY.mergeBufferGeometries)(f.map(function(N){var I=e.dataMapper.getObj(N),F=I.geometry.toNonIndexed();I.updateMatrix(),F.applyMatrix4(I.matrix);var G=_0(l(N)),O=_0(c(N)),D=F.getAttribute("position").count,j=F.groups[0].count;return F.setAttribute("color",$f(Wi(new Array(D)).map(function(L,U){return U>=j?G:O}),4)),F})):new Ag.BufferGeometry,x=new Ag.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0,side:Ag.DoubleSide});x.onBeforeCompile=function(N){x.userData.shader=QO(N)};var T=new Ag.Mesh(A,x);T.__globeObjType="hexBinPoints",T.__data=f,e.dataMapper.clear(),Zi(e.scene),e.scene.add(T)}function E(N){var I=new Ag.Mesh;I.__hexCenter=wne(N.h3Idx),I.__hexGeoJson=Ene(N.h3Idx,!0).reverse();var F=I.__hexCenter[1];return I.__hexGeoJson.forEach(function(G){var O=G[0];Math.abs(F-O)>170&&(G[0]+=F>O?360:-360)}),I.__globeObjType="hexbin",I}function M(N,I){var F=function(Y,ue,pe){return Y-(Y-ue)*pe},G=Math.max(0,Math.min(1,+u(I))),O=vs(N.__hexCenter,2),D=O[0],j=O[1],L=G===0?N.__hexGeoJson:N.__hexGeoJson.map(function(Q){var Y=vs(Q,2),ue=Y[0],pe=Y[1];return[[ue,j],[pe,D]].map(function(Ee){var oe=vs(Ee,2),Ae=oe[0],be=oe[1];return F(Ae,be,G)})}),U=e.hexTopCurvatureResolution;N.geometry&&N.geometry.dispose(),N.geometry=new rB([L],0,hs,!1,!0,!0,U);var q={alt:+o(I)},K=function(Y){var ue=N.__currentTargetD=Y,pe=ue.alt;N.scale.x=N.scale.y=N.scale.z=1+pe;var Ee=hs/(pe+1);N.geometry.setAttribute("surfaceRadius",$f(Array(N.geometry.getAttribute("position").count).fill(Ee),1))},H=N.__currentTargetD||Object.assign({},q,{alt:-.001});if(Object.keys(q).some(function(Q){return H[Q]!==q[Q]})&&(e.hexBinMerge||!e.hexTransitionDuration||e.hexTransitionDuration<0?K(q):e.tweenGroup.add(new gl(H).to(q,e.hexTransitionDuration).easing(Nr.Quadratic.InOut).onUpdate(K).start())),!e.hexBinMerge){var X=c(I),ne=l(I);[X,ne].forEach(function(Q){if(!m.hasOwnProperty(Q)){var Y=Hd(Q);m[Q]=z7(new Ag.MeshLambertMaterial({color:Wf(Q),transparent:Y<1,opacity:Y,side:Ag.DoubleSide}),QO)}}),N.material=[X,ne].map(function(Q){return m[Q]})}}}}),Moe=function(e){return e*e},Wp=function(e){return e*Math.PI/180};function xWe(a,e){var n=Math.sqrt,i=Math.cos,s=function(h){return Moe(Math.sin(h/2))},r=Wp(a[1]),o=Wp(e[1]),l=Wp(a[0]),c=Wp(e[0]);return 2*Math.asin(n(s(o-r)+i(r)*i(o)*s(c-l)))}var bWe=Math.sqrt(2*Math.PI);function SWe(a,e){return Math.exp(-Moe(a/e)/2)/(e*bWe)}var TWe=function(e){var n=vs(e,2),i=n[0],s=n[1],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=o.lngAccessor,c=l===void 0?function(E){return E[0]}:l,u=o.latAccessor,h=u===void 0?function(E){return E[1]}:u,f=o.weightAccessor,m=f===void 0?function(){return 1}:f,A=o.bandwidth,x=[i,s],T=A*Math.PI/180;return dLe(r.map(function(E){var M=m(E);if(!M)return 0;var N=xWe(x,[c(E),h(E)]);return SWe(N,T)*M}))},wWe=(function(){var a=JHe(YO().m(function e(n){var i,s,r,o,l,c,u,h,f,m,A,x,T,E,M,N,I,F,G,O,D,j,L,U,q,K,H,X,ne,Q,Y,ue,pe,Ee,oe,Ae,be,Ce,ce,te,fe=arguments,Le,Fe,Ie;return YO().w(function(at){for(;;)switch(at.n){case 0:if(s=fe.length>1&&fe[1]!==void 0?fe[1]:[],r=fe.length>2&&fe[2]!==void 0?fe[2]:{},o=r.lngAccessor,l=o===void 0?function(je){return je[0]}:o,c=r.latAccessor,u=c===void 0?function(je){return je[1]}:c,h=r.weightAccessor,f=h===void 0?function(){return 1}:h,m=r.bandwidth,(i=navigator)!==null&&i!==void 0&&i.gpu){at.n=1;break}return console.warn("WebGPU not enabled in browser. Please consider enabling it to improve performance."),at.a(2,n.map(function(je){return TWe(je,s,{lngAccessor:l,latAccessor:u,weightAccessor:f,bandwidth:m})}));case 1:return A=4,x=NHe,T=RHe,E=VHe,M=UHe,N=kHe,I=OHe,F=PHe,G=BHe,O=jHe,D=LHe,j=IHe,L=DHe,U=FHe,q=M(new u3(new Float32Array(n.flat().map(Wp)),2),"vec2",n.length),K=M(new u3(new Float32Array(s.map(function(je){return[Wp(l(je)),Wp(u(je)),f(je)]}).flat()),3),"vec3",s.length),H=new u3(n.length,1),X=M(H,"float",n.length),ne=N(Math.PI),Q=G(ne.mul(2)),Y=function(Ve){return Ve.mul(Ve)},ue=function(Ve){return Y(O(Ve.div(2)))},pe=function(Ve,Me){var ze=N(Ve[1]),Je=N(Me[1]),rt=N(Ve[0]),ve=N(Me[0]);return N(2).mul(j(G(ue(Je.sub(ze)).add(D(ze).mul(D(Je)).mul(ue(ve.sub(rt)))))))},Ee=function(Ve,Me){return L(U(Y(Ve.div(Me)).div(2))).div(Me.mul(Q))},oe=E(Wp(m)),Ae=E(Wp(m*A)),be=E(s.length),Ce=x(function(){var je=q.element(I),Ve=X.element(I);Ve.assign(0),F(be,function(Me){var ze=Me.i,Je=K.element(ze),rt=Je.z;T(rt,function(){var ve=pe(Je.xy,je.xy);T(ve&&ve.lessThan(Ae),function(){Ve.addAssign(Ee(ve,oe).mul(rt))})})})}),ce=Ce().compute(n.length),te=new poe,at.n=2,te.computeAsync(ce);case 2:return Le=Array,Fe=Float32Array,at.n=3,te.getArrayBufferAsync(H);case 3:return Ie=at.v,at.a(2,Le.from.call(Le,new Fe(Ie)))}},e)}));return function(n){return a.apply(this,arguments)}})(),gC=window.THREE?window.THREE:{Mesh:Na,MeshLambertMaterial:nh,SphereGeometry:vu},EWe=3.5,MWe=.1,SY=100,CWe=function(e){var n=Jy(t8e(e));return n.opacity=Math.cbrt(e),n.formatRgb()},Coe=Wr({props:{heatmapsData:{default:[]},heatmapPoints:{default:function(e){return e}},heatmapPointLat:{default:function(e){return e[0]}},heatmapPointLng:{default:function(e){return e[1]}},heatmapPointWeight:{default:1},heatmapBandwidth:{default:2.5},heatmapColorFn:{default:function(){return CWe}},heatmapColorSaturation:{default:1.5},heatmapBaseAltitude:{default:.01},heatmapTopAltitude:{},heatmapsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,n,i){var s=i.tweenGroup;Zi(e),n.scene=e,n.tweenGroup=s,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjHeatmap"}).onCreateObj(function(){var r=new gC.Mesh(new gC.SphereGeometry(hs),z7(new gC.MeshLambertMaterial({vertexColors:!0,transparent:!0}),AWe));return r.__globeObjType="heatmap",r})},update:function(e){var n=Yt(e.heatmapPoints),i=Yt(e.heatmapPointLat),s=Yt(e.heatmapPointLng),r=Yt(e.heatmapPointWeight),o=Yt(e.heatmapBandwidth),l=Yt(e.heatmapColorFn),c=Yt(e.heatmapColorSaturation),u=Yt(e.heatmapBaseAltitude),h=Yt(e.heatmapTopAltitude);e.dataMapper.onUpdateObj(function(f,m){var A=o(m),x=l(m),T=c(m),E=u(m),M=h(m),N=n(m).map(function(D){var j=i(D),L=s(D),U=Qu(j,L),q=U.x,K=U.y,H=U.z;return{x:q,y:K,z:H,lat:j,lng:L,weight:r(D)}}),I=Math.max(MWe,A/EWe),F=Math.ceil(360/(I||-1));f.geometry.parameters.widthSegments!==F&&(f.geometry.dispose(),f.geometry=new gC.SphereGeometry(hs,F,F/2));var G=gWe(f.geometry.getAttribute("position")),O=G.map(function(D){var j=vs(D,3),L=j[0],U=j[1],q=j[2],K=xoe({x:L,y:U,z:q}),H=K.lng,X=K.lat;return[H,X]});wWe(O,N,{latAccessor:function(j){return j.lat},lngAccessor:function(j){return j.lng},weightAccessor:function(j){return j.weight},bandwidth:A}).then(function(D){var j=Wi(new Array(SY)).map(function(K,H){return _0(x(H/(SY-1)))}),L=function(H){var X=f.__currentTargetD=H,ne=X.kdeVals,Q=X.topAlt,Y=X.saturation,ue=lLe(ne.map(Math.abs))||1e-15,pe=Ete([0,ue/Y],j);f.geometry.setAttribute("color",$f(ne.map(function(oe){return pe(Math.abs(oe))}),4));var Ee=bm([0,ue],[hs*(1+E),hs*(1+(Q||E))]);f.geometry.setAttribute("r",$f(ne.map(Ee)))},U={kdeVals:D,topAlt:M,saturation:T},q=f.__currentTargetD||Object.assign({},U,{kdeVals:D.map(function(){return 0}),topAlt:M&&E,saturation:.5});q.kdeVals.length!==D.length&&(q.kdeVals=D.slice()),Object.keys(U).some(function(K){return q[K]!==U[K]})&&(!e.heatmapsTransitionDuration||e.heatmapsTransitionDuration<0?L(U):e.tweenGroup.add(new gl(q).to(U,e.heatmapsTransitionDuration).easing(Nr.Quadratic.InOut).onUpdate(L).start()))})}).digest(e.heatmapsData)}}),yg=window.THREE?window.THREE:{DoubleSide:er,Group:ll,LineBasicMaterial:Hr,LineSegments:Zu,Mesh:Na,MeshBasicMaterial:oo},Noe=Wr({props:{polygonsData:{default:[]},polygonGeoJsonGeometry:{default:"geometry"},polygonSideColor:{default:function(){return"#ffffaa"}},polygonSideMaterial:{},polygonCapColor:{default:function(){return"#ffffaa"}},polygonCapMaterial:{},polygonStrokeColor:{},polygonAltitude:{default:.01},polygonCapCurvatureResolution:{default:5},polygonsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,n,i){var s=i.tweenGroup;Zi(e),n.scene=e,n.tweenGroup=s,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjPolygon"}).id(function(r){return r.id}).onCreateObj(function(){var r=new yg.Group;return r.__defaultSideMaterial=z7(new yg.MeshBasicMaterial({side:yg.DoubleSide,depthWrite:!0}),QO),r.__defaultCapMaterial=new yg.MeshBasicMaterial({side:yg.DoubleSide,depthWrite:!0}),r.add(new yg.Mesh(void 0,[r.__defaultSideMaterial,r.__defaultCapMaterial])),r.add(new yg.LineSegments(void 0,new yg.LineBasicMaterial)),r.__globeObjType="polygon",r})},update:function(e){var n=Yt(e.polygonGeoJsonGeometry),i=Yt(e.polygonAltitude),s=Yt(e.polygonCapCurvatureResolution),r=Yt(e.polygonCapColor),o=Yt(e.polygonCapMaterial),l=Yt(e.polygonSideColor),c=Yt(e.polygonSideMaterial),u=Yt(e.polygonStrokeColor),h=[];e.polygonsData.forEach(function(f){var m={data:f,capColor:r(f),capMaterial:o(f),sideColor:l(f),sideMaterial:c(f),strokeColor:u(f),altitude:+i(f),capCurvatureResolution:+s(f)},A=n(f),x=f.__id||"".concat(Math.round(Math.random()*1e9));f.__id=x,A.type==="Polygon"?h.push(Fi({id:"".concat(x,"_0"),coords:A.coordinates},m)):A.type==="MultiPolygon"?h.push.apply(h,Wi(A.coordinates.map(function(T,E){return Fi({id:"".concat(x,"_").concat(E),coords:T},m)}))):console.warn("Unsupported GeoJson geometry type: ".concat(A.type,". Skipping geometry..."))}),e.dataMapper.onUpdateObj(function(f,m){var A=m.coords,x=m.capColor,T=m.capMaterial,E=m.sideColor,M=m.sideMaterial,N=m.strokeColor,I=m.altitude,F=m.capCurvatureResolution,G=vs(f.children,2),O=G[0],D=G[1],j=!!N;D.visible=j;var L=!!(x||T),U=!!(E||M);NWe(O.geometry.parameters||{},{polygonGeoJson:A,curvatureResolution:F,closedTop:L,includeSides:U})||(O.geometry&&O.geometry.dispose(),O.geometry=new rB(A,0,hs,!1,L,U,F)),j&&(!D.geometry.parameters||D.geometry.parameters.geoJson.coordinates!==A||D.geometry.parameters.resolution!==F)&&(D.geometry&&D.geometry.dispose(),D.geometry=new rne({type:"Polygon",coordinates:A},hs,F));var q=U?0:-1,K=L?U?1:0:-1;if(q>=0&&(O.material[q]=M||f.__defaultSideMaterial),K>=0&&(O.material[K]=T||f.__defaultCapMaterial),[[!M&&E,q],[!T&&x,K]].forEach(function(ue){var pe=vs(ue,2),Ee=pe[0],oe=pe[1];if(!(!Ee||oe<0)){var Ae=O.material[oe],be=Hd(Ee);Ae.color.set(Wf(Ee)),Ae.transparent=be<1,Ae.opacity=be}}),j){var H=D.material,X=Hd(N);H.color.set(Wf(N)),H.transparent=X<1,H.opacity=X}var ne={alt:I},Q=function(pe){var Ee=f.__currentTargetD=pe,oe=Ee.alt;O.scale.x=O.scale.y=O.scale.z=1+oe,j&&(D.scale.x=D.scale.y=D.scale.z=1+oe+1e-4),yWe(f.__defaultSideMaterial,function(Ae){return Ae.uSurfaceRadius.value=hs/(oe+1)})},Y=f.__currentTargetD||Object.assign({},ne,{alt:-.001});Object.keys(ne).some(function(ue){return Y[ue]!==ne[ue]})&&(!e.polygonsTransitionDuration||e.polygonsTransitionDuration<0||Y.alt===ne.alt?Q(ne):e.tweenGroup.add(new gl(Y).to(ne,e.polygonsTransitionDuration).easing(Nr.Quadratic.InOut).onUpdate(Q).start()))}).digest(h)}});function NWe(a,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return function(i,s){return i===s}};return Object.entries(e).every(function(i){var s=vs(i,2),r=s[0],o=s[1];return a.hasOwnProperty(r)&&n(r)(a[r],o)})}var zv=window.THREE?window.THREE:{BufferGeometry:zn,DoubleSide:er,Mesh:Na,MeshLambertMaterial:nh,Vector3:ye},TY=Object.assign({},tB),wY=TY.BufferGeometryUtils||TY,Roe=Wr({props:{hexPolygonsData:{default:[]},hexPolygonGeoJsonGeometry:{default:"geometry"},hexPolygonColor:{default:function(){return"#ffffaa"}},hexPolygonAltitude:{default:.001},hexPolygonResolution:{default:3},hexPolygonMargin:{default:.2},hexPolygonUseDots:{default:!1},hexPolygonCurvatureResolution:{default:5},hexPolygonDotResolution:{default:12},hexPolygonsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,n,i){var s=i.tweenGroup;Zi(e),n.scene=e,n.tweenGroup=s,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjHexPolygon"}).onCreateObj(function(){var r=new zv.Mesh(void 0,new zv.MeshLambertMaterial({side:zv.DoubleSide}));return r.__globeObjType="hexPolygon",r})},update:function(e){var n=Yt(e.hexPolygonGeoJsonGeometry),i=Yt(e.hexPolygonColor),s=Yt(e.hexPolygonAltitude),r=Yt(e.hexPolygonResolution),o=Yt(e.hexPolygonMargin),l=Yt(e.hexPolygonUseDots),c=Yt(e.hexPolygonCurvatureResolution),u=Yt(e.hexPolygonDotResolution);e.dataMapper.onUpdateObj(function(h,f){var m=n(f),A=r(f),x=s(f),T=Math.max(0,Math.min(1,+o(f))),E=l(f),M=c(f),N=u(f),I=i(f),F=Hd(I);h.material.color.set(Wf(I)),h.material.transparent=F<1,h.material.opacity=F;var G={alt:x,margin:T,curvatureResolution:M},O={geoJson:m,h3Res:A},D=h.__currentTargetD||Object.assign({},G,{alt:-.001}),j=h.__currentMemD||O;if(Object.keys(G).some(function(K){return D[K]!==G[K]})||Object.keys(O).some(function(K){return j[K]!==O[K]})){h.__currentMemD=O;var L=[];m.type==="Polygon"?V$(m.coordinates,A,!0).forEach(function(K){return L.push(K)}):m.type==="MultiPolygon"?m.coordinates.forEach(function(K){return V$(K,A,!0).forEach(function(H){return L.push(H)})}):console.warn("Unsupported GeoJson geometry type: ".concat(m.type,". Skipping geometry..."));var U=L.map(function(K){var H=wne(K),X=Ene(K,!0).reverse(),ne=H[1];return X.forEach(function(Q){var Y=Q[0];Math.abs(ne-Y)>170&&(Q[0]+=ne>Y?360:-360)}),{h3Idx:K,hexCenter:H,hexGeoJson:X}}),q=function(H){var X=h.__currentTargetD=H,ne=X.alt,Q=X.margin,Y=X.curvatureResolution;h.geometry&&h.geometry.dispose(),h.geometry=U.length?(wY.mergeGeometries||wY.mergeBufferGeometries)(U.map(function(ue){var pe=vs(ue.hexCenter,2),Ee=pe[0],oe=pe[1];if(E){var Ae=Qu(Ee,oe,ne),be=Qu(ue.hexGeoJson[0][1],ue.hexGeoJson[0][0],ne),Ce=.85*(1-Q)*new zv.Vector3(Ae.x,Ae.y,Ae.z).distanceTo(new zv.Vector3(be.x,be.y,be.z)),ce=new Gx(Ce,N);return ce.rotateX(kA(-Ee)),ce.rotateY(kA(oe)),ce.translate(Ae.x,Ae.y,Ae.z),ce}else{var te=function(Fe,Ie,at){return Fe-(Fe-Ie)*at},fe=Q===0?ue.hexGeoJson:ue.hexGeoJson.map(function(Le){var Fe=vs(Le,2),Ie=Fe[0],at=Fe[1];return[[Ie,oe],[at,Ee]].map(function(je){var Ve=vs(je,2),Me=Ve[0],ze=Ve[1];return te(Me,ze,Q)})});return new rB([fe],hs,hs*(1+ne),!1,!0,!1,Y)}})):new zv.BufferGeometry};!e.hexPolygonsTransitionDuration||e.hexPolygonsTransitionDuration<0?q(G):e.tweenGroup.add(new gl(D).to(G,e.hexPolygonsTransitionDuration).easing(Nr.Quadratic.InOut).onUpdate(q).start())}}).digest(e.hexPolygonsData)}}),RWe=window.THREE?window.THREE:{Vector3:ye};function PWe(a,e){var n=function(o,l){var c=o[o.length-1];return[].concat(Wi(o),Wi(Array(l-o.length).fill(c)))},i=Math.max(a.length,e.length),s=MLe.apply(void 0,Wi([a,e].map(function(r){return r.map(function(o){var l=o.x,c=o.y,u=o.z;return[l,c,u]})}).map(function(r){return n(r,i)})));return function(r){return r===0?a:r===1?e:s(r).map(function(o){var l=vs(o,3),c=l[0],u=l[1],h=l[2];return new RWe.Vector3(c,u,h)})}}var wA=window.THREE?window.THREE:{BufferGeometry:zn,Color:on,Group:ll,Line:Kd,NormalBlending:fl,ShaderMaterial:mo,Vector3:ye},IWe=hx.default||hx,Poe=Wr({props:{pathsData:{default:[]},pathPoints:{default:function(e){return e}},pathPointLat:{default:function(e){return e[0]}},pathPointLng:{default:function(e){return e[1]}},pathPointAlt:{default:.001},pathResolution:{default:2},pathColor:{default:function(){return"#ffffaa"}},pathStroke:{},pathDashLength:{default:1},pathDashGap:{default:0},pathDashInitialGap:{default:0},pathDashAnimateTime:{default:0},pathTransitionDuration:{default:1e3,triggerUpdate:!1},rendererSize:{}},methods:{pauseAnimation:function(e){var n;(n=e.ticker)===null||n===void 0||n.pause()},resumeAnimation:function(e){var n;(n=e.ticker)===null||n===void 0||n.resume()},_destructor:function(e){var n;(n=e.ticker)===null||n===void 0||n.dispose()}},stateInit:function(e){var n=e.tweenGroup;return{tweenGroup:n,ticker:new IWe,sharedMaterial:new wA.ShaderMaterial(Fi(Fi({},Toe()),{},{transparent:!0,blending:wA.NormalBlending}))}},init:function(e,n){Zi(e),n.scene=e,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjPath"}).onCreateObj(function(){var i=new wA.Group;return i.__globeObjType="path",i}),n.ticker.onTick.add(function(i,s){n.dataMapper.entries().map(function(r){var o=vs(r,2),l=o[1];return l}).filter(function(r){return r.children.length&&r.children[0].material&&r.children[0].__dashAnimateStep}).forEach(function(r){var o=r.children[0],l=o.__dashAnimateStep*s;if(o.type==="Line"){var c=o.material.uniforms.dashTranslate.value%1e9;o.material.uniforms.dashTranslate.value=c+l}else if(o.type==="Line2"){for(var u=o.material.dashOffset-l,h=o.material.dashSize+o.material.gapSize;u<=-h;)u+=h;o.material.dashOffset=u}})})},update:function(e){var n=Yt(e.pathPoints),i=Yt(e.pathPointLat),s=Yt(e.pathPointLng),r=Yt(e.pathPointAlt),o=Yt(e.pathStroke),l=Yt(e.pathColor),c=Yt(e.pathDashLength),u=Yt(e.pathDashGap),h=Yt(e.pathDashInitialGap),f=Yt(e.pathDashAnimateTime);e.dataMapper.onUpdateObj(function(E,M){var N=o(M),I=N!=null;if(!E.children.length||I===(E.children[0].type==="Line")){Zi(E);var F=I?new HHe(new goe,new j7):new wA.Line(new wA.BufferGeometry,e.sharedMaterial.clone());E.add(F)}var G=E.children[0],O=A(n(M),i,s,r,e.pathResolution),D=f(M);if(G.__dashAnimateStep=D>0?1e3/D:0,I){G.material.resolution=e.rendererSize;{var U=c(M),q=u(M),K=h(M);G.material.dashed=q>0,G.material.dashed?G.material.defines.USE_DASH="":delete G.material.defines.USE_DASH,G.material.dashed&&(G.material.dashScale=1/m(O),G.material.dashSize=U,G.material.gapSize=q,G.material.dashOffset=-K)}{var H=l(M);if(H instanceof Array){var X=x(l(M),O.length-1,1,!1);G.geometry.setColors(X.array),G.material.vertexColors=!0}else{var ne=H,Q=Hd(ne);G.material.color=new wA.Color(Wf(ne)),G.material.transparent=Q<1,G.material.opacity=Q,G.material.vertexColors=!1}}G.material.needsUpdate=!0}else{Object.assign(G.material.uniforms,{dashSize:{value:c(M)},gapSize:{value:u(M)},dashOffset:{value:h(M)}});var j=x(l(M),O.length),L=T(O.length,1,!0);G.geometry.setAttribute("color",j),G.geometry.setAttribute("relDistance",L)}var Y=PWe(E.__currentTargetD&&E.__currentTargetD.points||[O[0]],O),ue=function(Ae){var be=E.__currentTargetD=Ae,Ce=be.stroke,ce=be.interpolK,te=E.__currentTargetD.points=Y(ce);if(I){var fe;G.geometry.setPositions((fe=[]).concat.apply(fe,Wi(te.map(function(Le){var Fe=Le.x,Ie=Le.y,at=Le.z;return[Fe,Ie,at]})))),G.material.linewidth=Ce,G.material.dashed&&G.computeLineDistances()}else G.geometry.setFromPoints(te),G.geometry.computeBoundingSphere()},pe={stroke:N,interpolK:1},Ee=Object.assign({},E.__currentTargetD||pe,{interpolK:0});Object.keys(pe).some(function(oe){return Ee[oe]!==pe[oe]})&&(!e.pathTransitionDuration||e.pathTransitionDuration<0?ue(pe):e.tweenGroup.add(new gl(Ee).to(pe,e.pathTransitionDuration).easing(Nr.Quadratic.InOut).onUpdate(ue).start()))}).digest(e.pathsData);function m(E){var M=0,N;return E.forEach(function(I){N&&(M+=N.distanceTo(I)),N=I}),M}function A(E,M,N,I,F){var G=function(L,U,q){for(var K=[],H=1;H<=q;H++)K.push(L+(U-L)*H/(q+1));return K},O=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,q=[],K=null;return L.forEach(function(H){if(K){for(;Math.abs(K[1]-H[1])>180;)K[1]+=360*(K[1]<H[1]?1:-1);var X=Math.sqrt(Math.pow(H[0]-K[0],2)+Math.pow(H[1]-K[1],2));if(X>U)for(var ne=Math.floor(X/U),Q=G(K[0],H[0],ne),Y=G(K[1],H[1],ne),ue=G(K[2],H[2],ne),pe=0,Ee=Q.length;pe<Ee;pe++)q.push([Q[pe],Y[pe],ue[pe]])}q.push(K=H)}),q},D=function(L){var U=vs(L,3),q=U[0],K=U[1],H=U[2],X=Qu(q,K,H),ne=X.x,Q=X.y,Y=X.z;return new wA.Vector3(ne,Q,Y)};return O(E.map(function(j){return[M(j),N(j),I(j)]}),F).map(D)}function x(E,M){var N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,F=M+1,G;if(E instanceof Array||E instanceof Function){var O=E instanceof Array?bm().domain(E.map(function(H,X){return X/(E.length-1)})).range(E):E;G=function(X){return _0(O(X),I,!0)}}else{var D=_0(E,I,!0);G=function(){return D}}for(var j=[],L=0,U=F;L<U;L++)for(var q=G(L/(U-1)),K=0;K<N;K++)j.push(q);return $f(j,I?4:3)}function T(E){for(var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,I=E+1,F=[],G=0,O=I;G<O;G++)for(var D=G/(O-1),j=0;j<M;j++)F.push(D);return N&&F.reverse(),$f(F,1)}}}),AC=window.THREE?window.THREE:{Euler:fo,Mesh:Na,MeshLambertMaterial:nh,SphereGeometry:vu},Ioe=Wr({props:{tilesData:{default:[]},tileLat:{default:"lat"},tileLng:{default:"lng"},tileAltitude:{default:.01},tileWidth:{default:1},tileHeight:{default:1},tileUseGlobeProjection:{default:!0},tileMaterial:{default:function(){return new AC.MeshLambertMaterial({color:"#ffbb88",opacity:.4,transparent:!0})}},tileCurvatureResolution:{default:5},tilesTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,n,i){var s=i.tweenGroup;Zi(e),n.scene=e,n.tweenGroup=s,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjTile"}).onCreateObj(function(){var r=new AC.Mesh;return r.__globeObjType="tile",r})},update:function(e){var n=Yt(e.tileLat),i=Yt(e.tileLng),s=Yt(e.tileAltitude),r=Yt(e.tileWidth),o=Yt(e.tileHeight),l=Yt(e.tileUseGlobeProjection),c=Yt(e.tileMaterial),u=Yt(e.tileCurvatureResolution);e.dataMapper.onUpdateObj(function(h,f){h.material=c(f);var m=l(f),A=u(f),x=function(N){var I=h.__currentTargetD=N,F=I.lat,G=I.lng,O=I.alt,D=I.width,j=I.height,L=Gv(G),U=Gv(-F);h.geometry&&h.geometry.dispose(),h.geometry=new AC.SphereGeometry(hs*(1+O),Math.ceil(D/(A||-1)),Math.ceil(j/(A||-1)),Gv(90-D/2)+(m?L:0),Gv(D),Gv(90-j/2)+(m?U:0),Gv(j)),m||h.setRotationFromEuler(new AC.Euler(U,L,0,"YXZ"))},T={lat:+n(f),lng:+i(f),alt:+s(f),width:+r(f),height:+o(f)},E=h.__currentTargetD||Object.assign({},T,{width:0,height:0});Object.keys(T).some(function(M){return E[M]!==T[M]})&&(!e.tilesTransitionDuration||e.tilesTransitionDuration<0?x(T):e.tweenGroup.add(new gl(E).to(T,e.tilesTransitionDuration).easing(Nr.Quadratic.InOut).onUpdate(x).start()))}).digest(e.tilesData)}}),Gv=function(e){return e*Math.PI/180},w2=window.THREE?window.THREE:{BufferGeometry:zn,Color:on,Points:lj,PointsMaterial:JT},Loe=Wr({props:{particlesData:{default:[]},particlesList:{default:function(e){return e}},particleLat:{default:"lat"},particleLng:{default:"lng"},particleAltitude:{default:.01},particlesSize:{default:.5},particlesSizeAttenuation:{default:!0},particlesColor:{default:function(){return"white"}},particlesTexture:{}},init:function(e,n){Zi(e),n.scene=e,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjParticles"}).onCreateObj(function(){var i=new w2.Points(new w2.BufferGeometry,new w2.PointsMaterial);return i.__globeObjType="particles",i}).onUpdateObj(function(i,s){var r=Yt(n.particlesList),o=Yt(n.particleLat),l=Yt(n.particleLng),c=Yt(n.particleAltitude);i.geometry.setAttribute("position",$f(r(s).map(function(u){return Object.values(Qu(o(u),l(u),c(u)))}),3))})},update:function(e,n){["particlesData","particlesList","particleLat","particleLng","particleAltitude"].some(function(l){return n.hasOwnProperty(l)})&&e.dataMapper.digest(e.particlesData);var i=Yt(e.particlesColor),s=Yt(e.particlesSize),r=Yt(e.particlesSizeAttenuation),o=Yt(e.particlesTexture);e.dataMapper.entries().forEach(function(l){var c=vs(l,2),u=c[0],h=c[1];if(h.material.size=s(u),h.material.sizeAttenuation=r(u),e.particlesTexture)h.material.color=new w2.Color(16777215),h.material.transparent=!1,h.material.alphaTest=.5,h.material.map=o(u);else{var f=i(u),m=Hd(f);h.material.color=new w2.Color(Wf(f)),h.material.transparent=m<1,h.material.opacity=m,h.material.alphaTest=0}})}}),LWe=window.THREE?window.THREE:{BufferGeometry:zn},DWe=(function(a){function e(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:32;lI(this,e),n=oI(this,e),n.type="CircleLineGeometry",n.parameters={radius:i,segmentCount:s};for(var r=[],o=0;o<=s;o++){var l=(o/s-.25)*Math.PI*2;r.push({x:Math.cos(l)*i,y:Math.sin(l)*i,z:0})}return n.setFromPoints(r),n}return uI(e,a),cI(e)})(LWe.BufferGeometry),qv=window.THREE?window.THREE:{Color:on,Group:ll,Line:Kd,LineBasicMaterial:Hr,Vector3:ye},kWe=hx.default||hx,Doe=Wr({props:{ringsData:{default:[]},ringLat:{default:"lat"},ringLng:{default:"lng"},ringAltitude:{default:.0015},ringColor:{default:function(){return"#ffffaa"},triggerUpdate:!1},ringResolution:{default:64,triggerUpdate:!1},ringMaxRadius:{default:2,triggerUpdate:!1},ringPropagationSpeed:{default:1,triggerUpdate:!1},ringRepeatPeriod:{default:700,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var n;(n=e.ticker)===null||n===void 0||n.pause()},resumeAnimation:function(e){var n;(n=e.ticker)===null||n===void 0||n.resume()},_destructor:function(e){var n;(n=e.ticker)===null||n===void 0||n.dispose()}},init:function(e,n,i){var s=i.tweenGroup;Zi(e),n.scene=e,n.tweenGroup=s,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjRing",removeDelay:3e4}).onCreateObj(function(){var r=new qv.Group;return r.__globeObjType="ring",r}),n.ticker=new kWe,n.ticker.onTick.add(function(r){if(n.ringsData.length){var o=Yt(n.ringColor),l=Yt(n.ringAltitude),c=Yt(n.ringMaxRadius),u=Yt(n.ringPropagationSpeed),h=Yt(n.ringRepeatPeriod);n.dataMapper.entries().filter(function(f){var m=vs(f,2),A=m[1];return A}).forEach(function(f){var m=vs(f,2),A=m[0],x=m[1];if((x.__nextRingTime||0)<=r){var T=h(A)/1e3;x.__nextRingTime=r+(T<=0?1/0:T);var E=new qv.Line(new DWe(1,n.ringResolution),new qv.LineBasicMaterial),M=o(A),N=M instanceof Array||M instanceof Function,I;N?M instanceof Array?(I=bm().domain(M.map(function(q,K){return K/(M.length-1)})).range(M),E.material.transparent=M.some(function(q){return Hd(q)<1})):(I=M,E.material.transparent=!0):(E.material.color=new qv.Color(Wf(M)),mWe(E.material,Hd(M)));var F=hs*(1+l(A)),G=c(A),O=G*Math.PI/180,D=u(A),j=D<=0,L=function(K){var H=K.t,X=(j?1-H:H)*O;if(E.scale.x=E.scale.y=F*Math.sin(X),E.position.z=F*(1-Math.cos(X)),N){var ne=I(H);E.material.color=new qv.Color(Wf(ne)),E.material.transparent&&(E.material.opacity=Hd(ne))}};if(D===0)L({t:0}),x.add(E);else{var U=Math.abs(G/D)*1e3;n.tweenGroup.add(new gl({t:0}).to({t:1},U).onUpdate(L).onStart(function(){return x.add(E)}).onComplete(function(){x.remove(E),V7(E)}).start())}}})}})},update:function(e){var n=Yt(e.ringLat),i=Yt(e.ringLng),s=Yt(e.ringAltitude),r=e.scene.localToWorld(new qv.Vector3(0,0,0));e.dataMapper.onUpdateObj(function(o,l){var c=n(l),u=i(l),h=s(l);Object.assign(o.position,Qu(c,u,h)),o.lookAt(r)}).digest(e.ringsData)}}),OWe={0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},:{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},:{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},:{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},:{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},:{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},:{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},:{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},:{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},:{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},:{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},:{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},:{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},:{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},:{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},:{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},:{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},:{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},:{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},:{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"":{x_min:0,x_max:0,ha:853},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},:{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},:{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},:{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},:{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},:{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},:{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},:{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},:{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},:{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},:{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},:{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},:{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},:{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},:{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},:{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},:{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},:{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},:{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},:{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},:{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},:{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},:{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},:{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},:{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},:{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},:{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},:{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},:{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},:{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},:{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},:{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},FWe="normal",jWe=1189,BWe=-100,UWe="normal",VWe={yMin:-334,xMin:-111,yMax:1189,xMax:1672},zWe=1e3,GWe={postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) agenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"agenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:`Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r
\r
Permission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r
\r
The above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r
\r
The Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r
\r
This License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r
\r
The Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r
\r
THE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.`,manufacturer_name:"agenta ltd",font_sub_family_name:"Regular"},qWe=-334,HWe="Helvetiker",WWe=1522,$We=50,KWe={glyphs:OWe,cssFontWeight:FWe,ascender:jWe,underlinePosition:BWe,cssFontStyle:UWe,boundingBox:VWe,resolution:zWe,original_font_information:GWe,descender:qWe,familyName:HWe,lineHeight:WWe,underlineThickness:$We},Md=Fi(Fi({},window.THREE?window.THREE:{BoxGeometry:Yf,CircleGeometry:Gx,DoubleSide:er,Group:ll,Mesh:Na,MeshLambertMaterial:nh,TextGeometry:pY,Vector3:ye}),{},{Font:WHe,TextGeometry:pY}),koe=Wr({props:{labelsData:{default:[]},labelLat:{default:"lat"},labelLng:{default:"lng"},labelAltitude:{default:.002},labelText:{default:"text"},labelSize:{default:.5},labelTypeFace:{default:KWe,onChange:function(e,n){n.font=new Md.Font(e)}},labelColor:{default:function(){return"lightgrey"}},labelRotation:{default:0},labelResolution:{default:3},labelIncludeDot:{default:!0},labelDotRadius:{default:.1},labelDotOrientation:{default:function(){return"bottom"}},labelsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,n,i){var s=i.tweenGroup;Zi(e),n.scene=e,n.tweenGroup=s;var r=new Md.CircleGeometry(1,32);n.dataMapper=new Rc(e,{objBindAttr:"__threeObjLabel"}).onCreateObj(function(){var o=new Md.MeshLambertMaterial;o.side=er;var l=new Md.Group;l.add(new Md.Mesh(r,o));var c=new Md.Mesh(void 0,o);l.add(c);var u=new Md.Mesh;return u.visible=!1,c.add(u),l.__globeObjType="label",l})},update:function(e){var n=Yt(e.labelLat),i=Yt(e.labelLng),s=Yt(e.labelAltitude),r=Yt(e.labelText),o=Yt(e.labelSize),l=Yt(e.labelRotation),c=Yt(e.labelColor),u=Yt(e.labelIncludeDot),h=Yt(e.labelDotRadius),f=Yt(e.labelDotOrientation),m=new Set(["right","top","bottom"]),A=2*Math.PI*hs/360;e.dataMapper.onUpdateObj(function(x,T){var E=vs(x.children,2),M=E[0],N=E[1],I=vs(N.children,1),F=I[0],G=c(T),O=Hd(G);N.material.color.set(Wf(G)),N.material.transparent=O<1,N.material.opacity=O;var D=u(T),j=f(T);!D||!m.has(j)&&(j="bottom");var L=D?+h(T)*A:1e-12;M.scale.x=M.scale.y=L;var U=+o(T)*A;if(N.geometry&&N.geometry.dispose(),N.geometry=new Md.TextGeometry(r(T),{font:e.font,size:U,depth:0,bevelEnabled:!0,bevelThickness:0,bevelSize:0,curveSegments:e.labelResolution}),F.geometry&&F.geometry.dispose(),N.geometry.computeBoundingBox(),F.geometry=B7(Md.BoxGeometry,Wi(new Md.Vector3().subVectors(N.geometry.boundingBox.max,N.geometry.boundingBox.min).clampScalar(0,1/0).toArray())),j!=="right"&&N.geometry.center(),D){var q=L+U/2;j==="right"&&(N.position.x=q),N.position.y={right:-U/2,top:q+U/2,bottom:-q-U/2}[j]}var K=function(Q){var Y=x.__currentTargetD=Q,ue=Y.lat,pe=Y.lng,Ee=Y.alt,oe=Y.rot,Ae=Y.scale;Object.assign(x.position,Qu(ue,pe,Ee)),x.lookAt(e.scene.localToWorld(new Md.Vector3(0,0,0))),x.rotateY(Math.PI),x.rotateZ(-oe*Math.PI/180),x.scale.x=x.scale.y=x.scale.z=Ae},H={lat:+n(T),lng:+i(T),alt:+s(T),rot:+l(T),scale:1},X=x.__currentTargetD||Object.assign({},H,{scale:1e-12});Object.keys(H).some(function(ne){return X[ne]!==H[ne]})&&(!e.labelsTransitionDuration||e.labelsTransitionDuration<0?K(H):e.tweenGroup.add(new gl(X).to(H,e.labelsTransitionDuration).easing(Nr.Quadratic.InOut).onUpdate(K).start()))}).digest(e.labelsData)}}),YWe=Fi(Fi({},window.THREE?window.THREE:{}),{},{CSS2DObject:Q4e}),Ooe=Wr({props:{htmlElementsData:{default:[]},htmlLat:{default:"lat"},htmlLng:{default:"lng"},htmlAltitude:{default:0},htmlElement:{},htmlElementVisibilityModifier:{triggerUpdate:!1},htmlTransitionDuration:{default:1e3,triggerUpdate:!1},isBehindGlobe:{onChange:function(){this.updateObjVisibility()},triggerUpdate:!1}},methods:{updateObjVisibility:function(e,n){if(e.dataMapper){var i=n?[n]:e.dataMapper.entries().map(function(s){var r=vs(s,2),o=r[1];return o}).filter(function(s){return s});i.forEach(function(s){var r=!e.isBehindGlobe||!e.isBehindGlobe(s.position);e.htmlElementVisibilityModifier?(s.visible=!0,e.htmlElementVisibilityModifier(s.element,r)):s.visible=r})}}},init:function(e,n,i){var s=i.tweenGroup;Zi(e),n.scene=e,n.tweenGroup=s,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjHtml"}).onCreateObj(function(r){var o=Yt(n.htmlElement)(r),l=new YWe.CSS2DObject(o);return l.__globeObjType="html",l})},update:function(e,n){var i=this,s=Yt(e.htmlLat),r=Yt(e.htmlLng),o=Yt(e.htmlAltitude);n.hasOwnProperty("htmlElement")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(l,c){var u=function(m){var A=l.__currentTargetD=m,x=A.alt,T=A.lat,E=A.lng;Object.assign(l.position,Qu(T,E,x)),i.updateObjVisibility(l)},h={lat:+s(c),lng:+r(c),alt:+o(c)};!e.htmlTransitionDuration||e.htmlTransitionDuration<0||!l.__currentTargetD?u(h):e.tweenGroup.add(new gl(l.__currentTargetD).to(h,e.htmlTransitionDuration).easing(Nr.Quadratic.InOut).onUpdate(u).start())}).digest(e.htmlElementsData)}}),yC=window.THREE?window.THREE:{Group:ll,Mesh:Na,MeshLambertMaterial:nh,SphereGeometry:vu},Foe=Wr({props:{objectsData:{default:[]},objectLat:{default:"lat"},objectLng:{default:"lng"},objectAltitude:{default:.01},objectFacesSurface:{default:!0},objectRotation:{},objectThreeObject:{default:new yC.Mesh(new yC.SphereGeometry(1,16,8),new yC.MeshLambertMaterial({color:"#ffffaa",transparent:!0,opacity:.7}))}},init:function(e,n){Zi(e),n.scene=e,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjObject"}).onCreateObj(function(i){var s=Yt(n.objectThreeObject)(i);n.objectThreeObject===s&&(s=s.clone());var r=new yC.Group;return r.add(s),r.__globeObjType="object",r})},update:function(e,n){var i=Yt(e.objectLat),s=Yt(e.objectLng),r=Yt(e.objectAltitude),o=Yt(e.objectFacesSurface),l=Yt(e.objectRotation);n.hasOwnProperty("objectThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(c,u){var h=+i(u),f=+s(u),m=+r(u);Object.assign(c.position,Qu(h,f,m)),o(u)?c.setRotationFromEuler(new fo(kA(-h),kA(f),0,"YXZ")):c.rotation.set(0,0,0);var A=c.children[0],x=l(u);x&&A.setRotationFromEuler(new fo(kA(x.x||0),kA(x.y||0),kA(x.z||0)))}).digest(e.objectsData)}}),joe=Wr({props:{customLayerData:{default:[]},customThreeObject:{},customThreeObjectUpdate:{triggerUpdate:!1}},init:function(e,n){Zi(e),n.scene=e,n.dataMapper=new Rc(e,{objBindAttr:"__threeObjCustom"}).onCreateObj(function(i){var s=Yt(n.customThreeObject)(i,hs);return s&&(n.customThreeObject===s&&(s=s.clone()),s.__globeObjType="custom"),s})},update:function(e,n){e.customThreeObjectUpdate||Zi(e.scene);var i=Yt(e.customThreeObjectUpdate);n.hasOwnProperty("customThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(s,r){return i(s,r,hs)}).digest(e.customLayerData)}}),vC=window.THREE?window.THREE:{Camera:u1,Group:ll,Vector2:Nt,Vector3:ye},XWe=["globeLayer","pointsLayer","arcsLayer","hexBinLayer","heatmapsLayer","polygonsLayer","hexedPolygonsLayer","pathsLayer","tilesLayer","particlesLayer","ringsLayer","labelsLayer","htmlElementsLayer","objectsLayer","customLayer"],Boe=Ul("globeLayer",boe),QWe=Object.assign.apply(Object,Wi(["globeImageUrl","bumpImageUrl","globeCurvatureResolution","globeTileEngineUrl","globeTileEngineMaxLevel","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude"].map(function(a){return Ao({},a,Boe.linkProp(a))}))),JWe=Object.assign.apply(Object,Wi(["globeMaterial","globeTileEngineClearCache"].map(function(a){return Ao({},a,Boe.linkMethod(a))}))),ZWe=Ul("pointsLayer",Soe),e$e=Object.assign.apply(Object,Wi(["pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration"].map(function(a){return Ao({},a,ZWe.linkProp(a))}))),t$e=Ul("arcsLayer",woe),n$e=Object.assign.apply(Object,Wi(["arcsData","arcStartLat","arcStartLng","arcStartAltitude","arcEndLat","arcEndLng","arcEndAltitude","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration"].map(function(a){return Ao({},a,t$e.linkProp(a))}))),a$e=Ul("hexBinLayer",Eoe),i$e=Object.assign.apply(Object,Wi(["hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration"].map(function(a){return Ao({},a,a$e.linkProp(a))}))),s$e=Ul("heatmapsLayer",Coe),r$e=Object.assign.apply(Object,Wi(["heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration"].map(function(a){return Ao({},a,s$e.linkProp(a))}))),o$e=Ul("hexedPolygonsLayer",Roe),l$e=Object.assign.apply(Object,Wi(["hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration"].map(function(a){return Ao({},a,o$e.linkProp(a))}))),c$e=Ul("polygonsLayer",Noe),u$e=Object.assign.apply(Object,Wi(["polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration"].map(function(a){return Ao({},a,c$e.linkProp(a))}))),d$e=Ul("pathsLayer",Poe),h$e=Object.assign.apply(Object,Wi(["pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration"].map(function(a){return Ao({},a,d$e.linkProp(a))}))),f$e=Ul("tilesLayer",Ioe),p$e=Object.assign.apply(Object,Wi(["tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration"].map(function(a){return Ao({},a,f$e.linkProp(a))}))),m$e=Ul("particlesLayer",Loe),g$e=Object.assign.apply(Object,Wi(["particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture"].map(function(a){return Ao({},a,m$e.linkProp(a))}))),A$e=Ul("ringsLayer",Doe),y$e=Object.assign.apply(Object,Wi(["ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod"].map(function(a){return Ao({},a,A$e.linkProp(a))}))),v$e=Ul("labelsLayer",koe),_$e=Object.assign.apply(Object,Wi(["labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration"].map(function(a){return Ao({},a,v$e.linkProp(a))}))),x$e=Ul("htmlElementsLayer",Ooe),b$e=Object.assign.apply(Object,Wi(["htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration"].map(function(a){return Ao({},a,x$e.linkProp(a))}))),S$e=Ul("objectsLayer",Foe),T$e=Object.assign.apply(Object,Wi(["objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject"].map(function(a){return Ao({},a,S$e.linkProp(a))}))),w$e=Ul("customLayer",joe),E$e=Object.assign.apply(Object,Wi(["customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(a){return Ao({},a,w$e.linkProp(a))}))),M$e=Wr({props:Fi(Fi(Fi(Fi(Fi(Fi(Fi(Fi(Fi(Fi(Fi(Fi(Fi(Fi(Fi({onGlobeReady:{triggerUpdate:!1},rendererSize:{default:new vC.Vector2(window.innerWidth,window.innerHeight),onChange:function(e,n){n.pathsLayer.rendererSize(e)},triggerUpdate:!1}},QWe),e$e),n$e),i$e),r$e),u$e),l$e),h$e),p$e),g$e),y$e),_$e),b$e),T$e),E$e),methods:Fi({getGlobeRadius:AY,getCoords:function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return Qu.apply(void 0,i)},toGeoCoords:function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return xoe.apply(void 0,i)},setPointOfView:function(e,n){var i=n instanceof vC.Camera?n.position:n,s=AY(),r=void 0;if(e.scene&&i){var o,l,c,u;r=function(f){o===void 0&&(o=i.clone().applyMatrix4(e.scene.matrixWorld.clone().invert())),l===void 0&&(l=o.length()),c===void 0&&(c=Math.sqrt(Math.pow(l,2)-Math.pow(s,2))),u===void 0&&(u=Math.acos(c/l));var m=o.distanceTo(f);if(m<c)return!1;var A=f.length(),x=Math.acos((Math.pow(l,2)+Math.pow(m,2)-Math.pow(A,2))/(2*l*m));return x<u}}e.layersThatNeedUpdatePov.forEach(function(h){return h.updatePov(n)}),e.layersThatNeedBehindGlobeChecker.forEach(function(h){return h.isBehindGlobe(r)})},pauseAnimation:function(e){return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),e.pausableLayers.forEach(function(n){var i;return(i=n.pauseAnimation)===null||i===void 0?void 0:i.call(n)}),this},resumeAnimation:function(e){return e.animationFrameRequestId===null&&this._animationCycle(),e.pausableLayers.forEach(function(n){var i;return(i=n.resumeAnimation)===null||i===void 0?void 0:i.call(n)}),this},_animationCycle:function(e){e.animationFrameRequestId=requestAnimationFrame(this._animationCycle),e.tweenGroup.update()},_destructor:function(e){this.pauseAnimation(),e.destructableLayers.forEach(function(n){return n._destructor()})}},JWe),stateInit:function(){var e=new T4,n={tweenGroup:e},i={globeLayer:boe(n),pointsLayer:Soe(n),arcsLayer:woe(n),hexBinLayer:Eoe(n),heatmapsLayer:Coe(n),polygonsLayer:Noe(n),hexedPolygonsLayer:Roe(n),pathsLayer:Poe(n),tilesLayer:Ioe(n),particlesLayer:Loe(n),ringsLayer:Doe(n),labelsLayer:koe(n),htmlElementsLayer:Ooe(n),objectsLayer:Foe(n),customLayer:joe(n)};return Fi(Fi({tweenGroup:e},i),{},{layersThatNeedUpdatePov:Object.values(i).filter(function(s){return s.hasOwnProperty("updatePov")}),layersThatNeedBehindGlobeChecker:Object.values(i).filter(function(s){return s.hasOwnProperty("isBehindGlobe")}),destructableLayers:Object.values(i).filter(function(s){return s.hasOwnProperty("_destructor")}),pausableLayers:Object.values(i).filter(function(s){return s.hasOwnProperty("pauseAnimation")})})},init:function(e,n,i){var s=i.animateIn,r=s===void 0?!0:s,o=i.waitForGlobeReady,l=o===void 0?!0:o;Zi(e),n.scene=e,n.scene.visible=!1,XWe.forEach(function(u){var h=new vC.Group;n.scene.add(h),n[u](h)});var c=function(){if(r){n.scene.scale.set(1e-6,1e-6,1e-6),n.tweenGroup.add(new gl({k:1e-6}).to({k:1},600).easing(Nr.Quadratic.Out).onUpdate(function(f){var m=f.k;return n.scene.scale.set(m,m,m)}).start());var h=new vC.Vector3(0,1,0);n.tweenGroup.add(new gl({rot:Math.PI*2}).to({rot:0},1200).easing(Nr.Quintic.Out).onUpdate(function(f){var m=f.rot;return n.scene.setRotationFromAxisAngle(h,m)}).start())}n.scene.visible=!0,n.onGlobeReady&&n.onGlobeReady()};l?n.globeLayer.onReady(c):c(),this._animationCycle()},update:function(e){}});function C$e(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=(function(s){function r(){var o;lI(this,r);for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return o=oI(this,r,[].concat(c)),o.__kapsuleInstance=B7(a,[].concat(Wi(n?[o]:[]),c)),o}return uI(r,s),cI(r)})(e);return Object.keys(a()).forEach(function(s){return i.prototype[s]=function(){var r,o=(r=this.__kapsuleInstance)[s].apply(r,arguments);return o===this.__kapsuleInstance?this:o}}),i}var N$e=window.THREE?window.THREE:{Group:ll},Uoe=C$e(M$e,N$e.Group,!0);const o6={type:"change"},G7={type:"start"},q7={type:"end"},EY=1e-6,Ii={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},_C=new Nt,vg=new Nt,R$e=new ye,xC=new ye,l6=new ye,Hv=new Er,MY=new ye,bC=new ye,c6=new ye,SC=new ye;class P$e extends x4{constructor(e,n=null){super(e,n),this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:ou.ROTATE,MIDDLE:ou.DOLLY,RIGHT:ou.PAN},this.target=new ye,this.state=Ii.NONE,this.keyState=Ii.NONE,this._lastPosition=new ye,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new ye,this._movePrev=new Nt,this._moveCurr=new Nt,this._lastAxis=new ye,this._zoomStart=new Nt,this._zoomEnd=new Nt,this._panStart=new Nt,this._panEnd=new Nt,this._pointers=[],this._pointerPositions={},this._onPointerMove=L$e.bind(this),this._onPointerDown=I$e.bind(this),this._onPointerUp=D$e.bind(this),this._onPointerCancel=k$e.bind(this),this._onContextMenu=z$e.bind(this),this._onMouseWheel=V$e.bind(this),this._onKeyDown=F$e.bind(this),this._onKeyUp=O$e.bind(this),this._onTouchStart=G$e.bind(this),this._onTouchMove=q$e.bind(this),this._onTouchEnd=H$e.bind(this),this._onMouseDown=j$e.bind(this),this._onMouseMove=B$e.bind(this),this._onMouseUp=U$e.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,n!==null&&(this.connect(n),this.handleResize()),this.update()}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),n=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-n.clientLeft,this.screen.top=e.top+window.pageYOffset-n.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>EY&&(this.dispatchEvent(o6),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>EY||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(o6),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=Ii.NONE,this.keyState=Ii.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(o6),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(vg.copy(this._panEnd).sub(this._panStart),vg.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,n=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;vg.x*=e,vg.y*=n}vg.multiplyScalar(this._eye.length()*this.panSpeed),xC.copy(this._eye).cross(this.object.up).setLength(vg.x),xC.add(R$e.copy(this.object.up).setLength(vg.y)),this.object.position.add(xC),this.target.add(xC),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(vg.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){SC.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=SC.length();e?(this._eye.copy(this.object.position).sub(this.target),MY.copy(this._eye).normalize(),bC.copy(this.object.up).normalize(),c6.crossVectors(bC,MY).normalize(),bC.setLength(this._moveCurr.y-this._movePrev.y),c6.setLength(this._moveCurr.x-this._movePrev.x),SC.copy(bC.add(c6)),l6.crossVectors(SC,this._eye).normalize(),e*=this.rotateSpeed,Hv.setFromAxisAngle(l6,e),this._eye.applyQuaternion(Hv),this.object.up.applyQuaternion(Hv),this._lastAxis.copy(l6),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),Hv.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(Hv),this.object.up.applyQuaternion(Hv)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===Ii.TOUCH_ZOOM_PAN?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=Xy.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,e!==1&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=Xy.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,n){return _C.set((e-this.screen.left)/this.screen.width,(n-this.screen.top)/this.screen.height),_C}_getMouseOnCircle(e,n){return _C.set((e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-n))/this.screen.width),_C}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let n=0;n<this._pointers.length;n++)if(this._pointers[n].pointerId==e.pointerId){this._pointers.splice(n,1);return}}_trackPointer(e){let n=this._pointerPositions[e.pointerId];n===void 0&&(n=new Nt,this._pointerPositions[e.pointerId]=n),n.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const n=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[n.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function I$e(a){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(a.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),this._addPointer(a),a.pointerType==="touch"?this._onTouchStart(a):this._onMouseDown(a))}function L$e(a){this.enabled!==!1&&(a.pointerType==="touch"?this._onTouchMove(a):this._onMouseMove(a))}function D$e(a){this.enabled!==!1&&(a.pointerType==="touch"?this._onTouchEnd(a):this._onMouseUp(),this._removePointer(a),this._pointers.length===0&&(this.domElement.releasePointerCapture(a.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp)))}function k$e(a){this._removePointer(a)}function O$e(){this.enabled!==!1&&(this.keyState=Ii.NONE,window.addEventListener("keydown",this._onKeyDown))}function F$e(a){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===Ii.NONE&&(a.code===this.keys[Ii.ROTATE]&&!this.noRotate?this.keyState=Ii.ROTATE:a.code===this.keys[Ii.ZOOM]&&!this.noZoom?this.keyState=Ii.ZOOM:a.code===this.keys[Ii.PAN]&&!this.noPan&&(this.keyState=Ii.PAN)))}function j$e(a){let e;switch(a.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case ou.DOLLY:this.state=Ii.ZOOM;break;case ou.ROTATE:this.state=Ii.ROTATE;break;case ou.PAN:this.state=Ii.PAN;break;default:this.state=Ii.NONE}const n=this.keyState!==Ii.NONE?this.keyState:this.state;n===Ii.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(a.pageX,a.pageY)),this._movePrev.copy(this._moveCurr)):n===Ii.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(a.pageX,a.pageY)),this._zoomEnd.copy(this._zoomStart)):n===Ii.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(a.pageX,a.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(G7)}function B$e(a){const e=this.keyState!==Ii.NONE?this.keyState:this.state;e===Ii.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(a.pageX,a.pageY))):e===Ii.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(a.pageX,a.pageY)):e===Ii.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(a.pageX,a.pageY))}function U$e(){this.state=Ii.NONE,this.dispatchEvent(q7)}function V$e(a){if(this.enabled!==!1&&this.noZoom!==!0){switch(a.preventDefault(),a.deltaMode){case 2:this._zoomStart.y-=a.deltaY*.025;break;case 1:this._zoomStart.y-=a.deltaY*.01;break;default:this._zoomStart.y-=a.deltaY*25e-5;break}this.dispatchEvent(G7),this.dispatchEvent(q7)}}function z$e(a){this.enabled!==!1&&a.preventDefault()}function G$e(a){if(this._trackPointer(a),this._pointers.length===1)this.state=Ii.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);else{this.state=Ii.TOUCH_ZOOM_PAN;const e=this._pointers[0].pageX-this._pointers[1].pageX,n=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+n*n);const i=(this._pointers[0].pageX+this._pointers[1].pageX)/2,s=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(i,s)),this._panEnd.copy(this._panStart)}this.dispatchEvent(G7)}function q$e(a){if(this._trackPointer(a),this._pointers.length===1)this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(a.pageX,a.pageY));else{const e=this._getSecondPointerPosition(a),n=a.pageX-e.x,i=a.pageY-e.y;this._touchZoomDistanceEnd=Math.sqrt(n*n+i*i);const s=(a.pageX+e.x)/2,r=(a.pageY+e.y)/2;this._panEnd.copy(this._getMouseOnScreen(s,r))}}function H$e(a){switch(this._pointers.length){case 0:this.state=Ii.NONE;break;case 1:this.state=Ii.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(a.pageX,a.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=Ii.TOUCH_ZOOM_PAN;for(let e=0;e<this._pointers.length;e++)if(this._pointers[e].pointerId!==a.pointerId){const n=this._pointerPositions[this._pointers[e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(n.x,n.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(q7)}const CY={type:"change"},H7={type:"start"},Voe={type:"end"},TC=new c1,NY=new Nd,W$e=Math.cos(70*Xy.DEG2RAD),Or=new ye,ac=2*Math.PI,Xi={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},u6=1e-6;class $$e extends x4{constructor(e,n=null){super(e,n),this.state=Xi.NONE,this.target=new ye,this.cursor=new ye,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:ou.ROTATE,MIDDLE:ou.DOLLY,RIGHT:ou.PAN},this.touches={ONE:UA.ROTATE,TWO:UA.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new ye,this._lastQuaternion=new Er,this._lastTargetPosition=new ye,this._quat=new Er().setFromUnitVectors(e.up,new ye(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Dk,this._sphericalDelta=new Dk,this._scale=1,this._panOffset=new ye,this._rotateStart=new Nt,this._rotateEnd=new Nt,this._rotateDelta=new Nt,this._panStart=new Nt,this._panEnd=new Nt,this._panDelta=new Nt,this._dollyStart=new Nt,this._dollyEnd=new Nt,this._dollyDelta=new Nt,this._dollyDirection=new ye,this._mouse=new Nt,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Y$e.bind(this),this._onPointerDown=K$e.bind(this),this._onPointerUp=X$e.bind(this),this._onContextMenu=aKe.bind(this),this._onMouseWheel=Z$e.bind(this),this._onKeyDown=eKe.bind(this),this._onTouchStart=tKe.bind(this),this._onTouchMove=nKe.bind(this),this._onMouseDown=Q$e.bind(this),this._onMouseMove=J$e.bind(this),this._interceptControlDown=iKe.bind(this),this._interceptControlUp=sKe.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(CY),this.update(),this.state=Xi.NONE}update(e=null){const n=this.object.position;Or.copy(n).sub(this.target),Or.applyQuaternion(this._quat),this._spherical.setFromVector3(Or),this.autoRotate&&this.state===Xi.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,s=this.maxAzimuthAngle;isFinite(i)&&isFinite(s)&&(i<-Math.PI?i+=ac:i>Math.PI&&(i-=ac),s<-Math.PI?s+=ac:s>Math.PI&&(s-=ac),i<=s?this._spherical.theta=Math.max(i,Math.min(s,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(i+s)/2?Math.max(i,this._spherical.theta):Math.min(s,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let r=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),r=o!=this._spherical.radius}if(Or.setFromSpherical(this._spherical),Or.applyQuaternion(this._quatInverse),n.copy(this.target).add(Or),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){const l=Or.length();o=this._clampDistance(l*this._scale);const c=l-o;this.object.position.addScaledVector(this._dollyDirection,c),this.object.updateMatrixWorld(),r=!!c}else if(this.object.isOrthographicCamera){const l=new ye(this._mouse.x,this._mouse.y,0);l.unproject(this.object);const c=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),r=c!==this.object.zoom;const u=new ye(this._mouse.x,this._mouse.y,0);u.unproject(this.object),this.object.position.sub(u).add(l),this.object.updateMatrixWorld(),o=Or.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(TC.origin.copy(this.object.position),TC.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(TC.direction))<W$e?this.object.lookAt(this.target):(NY.setFromNormalAndCoplanarPoint(this.object.up,this.target),TC.intersectPlane(NY,this.target))))}else if(this.object.isOrthographicCamera){const o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),r=!0)}return this._scale=1,this._performCursorZoom=!1,r||this._lastPosition.distanceToSquared(this.object.position)>u6||8*(1-this._lastQuaternion.dot(this.object.quaternion))>u6||this._lastTargetPosition.distanceToSquared(this.target)>u6?(this.dispatchEvent(CY),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?ac/60*this.autoRotateSpeed*e:ac/60/60*this.autoRotateSpeed}_getZoomScale(e){const n=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*n)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,n){Or.setFromMatrixColumn(n,0),Or.multiplyScalar(-e),this._panOffset.add(Or)}_panUp(e,n){this.screenSpacePanning===!0?Or.setFromMatrixColumn(n,1):(Or.setFromMatrixColumn(n,0),Or.crossVectors(this.object.up,Or)),Or.multiplyScalar(e),this._panOffset.add(Or)}_pan(e,n){const i=this.domElement;if(this.object.isPerspectiveCamera){const s=this.object.position;Or.copy(s).sub(this.target);let r=Or.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*r/i.clientHeight,this.object.matrix),this._panUp(2*n*r/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(n*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,n){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const i=this.domElement.getBoundingClientRect(),s=e-i.left,r=n-i.top,o=i.width,l=i.height;this._mouse.x=s/o*2-1,this._mouse.y=-(r/l)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(ac*this._rotateDelta.x/n.clientHeight),this._rotateUp(ac*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let n=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(ac*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),n=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-ac*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),n=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(ac*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),n=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-ac*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),n=!0;break}n&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),i=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._rotateStart.set(i,s)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),i=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._panStart.set(i,s)}}_handleTouchStartDolly(e){const n=this._getSecondPointerPosition(e),i=e.pageX-n.x,s=e.pageY-n.y,r=Math.sqrt(i*i+s*s);this._dollyStart.set(0,r)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),s=.5*(e.pageX+i.x),r=.5*(e.pageY+i.y);this._rotateEnd.set(s,r)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(ac*this._rotateDelta.x/n.clientHeight),this._rotateUp(ac*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),i=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._panEnd.set(i,s)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const n=this._getSecondPointerPosition(e),i=e.pageX-n.x,s=e.pageY-n.y,r=Math.sqrt(i*i+s*s);this._dollyEnd.set(0,r),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const o=(e.pageX+n.x)*.5,l=(e.pageY+n.y)*.5;this._updateZoomParameters(o,l)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==e.pointerId){this._pointers.splice(n,1);return}}_isTrackingPointer(e){for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==e.pointerId)return!0;return!1}_trackPointer(e){let n=this._pointerPositions[e.pointerId];n===void 0&&(n=new Nt,this._pointerPositions[e.pointerId]=n),n.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const n=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[n]}_customWheelEvent(e){const n=e.deltaMode,i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(n){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}}function K$e(a){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(a.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(a)&&(this._addPointer(a),a.pointerType==="touch"?this._onTouchStart(a):this._onMouseDown(a)))}function Y$e(a){this.enabled!==!1&&(a.pointerType==="touch"?this._onTouchMove(a):this._onMouseMove(a))}function X$e(a){switch(this._removePointer(a),this._pointers.length){case 0:this.domElement.releasePointerCapture(a.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Voe),this.state=Xi.NONE;break;case 1:const e=this._pointers[0],n=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:n.x,pageY:n.y});break}}function Q$e(a){let e;switch(a.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case ou.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(a),this.state=Xi.DOLLY;break;case ou.ROTATE:if(a.ctrlKey||a.metaKey||a.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(a),this.state=Xi.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(a),this.state=Xi.ROTATE}break;case ou.PAN:if(a.ctrlKey||a.metaKey||a.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(a),this.state=Xi.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(a),this.state=Xi.PAN}break;default:this.state=Xi.NONE}this.state!==Xi.NONE&&this.dispatchEvent(H7)}function J$e(a){switch(this.state){case Xi.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(a);break;case Xi.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(a);break;case Xi.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(a);break}}function Z$e(a){this.enabled===!1||this.enableZoom===!1||this.state!==Xi.NONE||(a.preventDefault(),this.dispatchEvent(H7),this._handleMouseWheel(this._customWheelEvent(a)),this.dispatchEvent(Voe))}function eKe(a){this.enabled!==!1&&this._handleKeyDown(a)}function tKe(a){switch(this._trackPointer(a),this._pointers.length){case 1:switch(this.touches.ONE){case UA.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(a),this.state=Xi.TOUCH_ROTATE;break;case UA.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(a),this.state=Xi.TOUCH_PAN;break;default:this.state=Xi.NONE}break;case 2:switch(this.touches.TWO){case UA.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(a),this.state=Xi.TOUCH_DOLLY_PAN;break;case UA.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(a),this.state=Xi.TOUCH_DOLLY_ROTATE;break;default:this.state=Xi.NONE}break;default:this.state=Xi.NONE}this.state!==Xi.NONE&&this.dispatchEvent(H7)}function nKe(a){switch(this._trackPointer(a),this.state){case Xi.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(a),this.update();break;case Xi.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(a),this.update();break;case Xi.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(a),this.update();break;case Xi.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(a),this.update();break;default:this.state=Xi.NONE}}function aKe(a){this.enabled!==!1&&a.preventDefault()}function iKe(a){a.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function sKe(a){a.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const rKe={type:"change"},RY=1e-6,PY=new Er;class oKe extends x4{constructor(e,n=null){super(e,n),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new ye(0,0,0),this._rotationVector=new ye(0,0,0),this._lastQuaternion=new Er,this._lastPosition=new ye,this._status=0,this._onKeyDown=lKe.bind(this),this._onKeyUp=cKe.bind(this),this._onPointerMove=dKe.bind(this),this._onPointerDown=uKe.bind(this),this._onPointerUp=hKe.bind(this),this._onPointerCancel=fKe.bind(this),this._onContextMenu=pKe.bind(this),n!==null&&this.connect(n)}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(e){if(this.enabled===!1)return;const n=this.object,i=e*this.movementSpeed,s=e*this.rollSpeed;n.translateX(this._moveVector.x*i),n.translateY(this._moveVector.y*i),n.translateZ(this._moveVector.z*i),PY.set(this._rotationVector.x*s,this._rotationVector.y*s,this._rotationVector.z*s,1).normalize(),n.quaternion.multiply(PY),(this._lastPosition.distanceToSquared(n.position)>RY||8*(1-this._lastQuaternion.dot(n.quaternion))>RY)&&(this.dispatchEvent(rKe),this._lastQuaternion.copy(n.quaternion),this._lastPosition.copy(n.position))}_updateMovementVector(){const e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}function lKe(a){if(!(a.altKey||this.enabled===!1)){switch(a.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1;break}this._updateMovementVector(),this._updateRotationVector()}}function cKe(a){if(this.enabled!==!1){switch(a.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0;break}this._updateMovementVector(),this._updateRotationVector()}}function uKe(a){if(this.enabled!==!1)if(this.dragToLook)this._status++;else{switch(a.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1;break}this._updateMovementVector()}}function dKe(a){if(this.enabled!==!1&&(!this.dragToLook||this._status>0)){const e=this._getContainerDimensions(),n=e.size[0]/2,i=e.size[1]/2;this._moveState.yawLeft=-(a.pageX-e.offset[0]-n)/n,this._moveState.pitchDown=(a.pageY-e.offset[1]-i)/i,this._updateRotationVector()}}function hKe(a){if(this.enabled!==!1){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(a.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0;break}this._updateMovementVector()}this._updateRotationVector()}}function fKe(){this.enabled!==!1&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function pKe(a){this.enabled!==!1&&a.preventDefault()}const mKe={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class dI{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const gKe=new P0(-1,1,1,-1,0,1);class AKe extends zn{constructor(){super(),this.setAttribute("position",new mn([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new mn([0,2,0,0,2,0],2))}}const yKe=new AKe;class vKe{constructor(e){this._mesh=new Na(yKe,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,gKe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class _Ke extends dI{constructor(e,n="tDiffuse"){super(),this.textureID=n,this.uniforms=null,this.material=null,e instanceof mo?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=XT.clone(e.uniforms),this.material=new mo({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this._fsQuad=new vKe(this.material)}render(e,n,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this._fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}class IY extends dI{constructor(e,n){super(),this.scene=e,this.camera=n,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,n,i){const s=e.getContext(),r=e.state;r.buffers.color.setMask(!1),r.buffers.depth.setMask(!1),r.buffers.color.setLocked(!0),r.buffers.depth.setLocked(!0);let o,l;this.inverse?(o=0,l=1):(o=1,l=0),r.buffers.stencil.setTest(!0),r.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),r.buffers.stencil.setFunc(s.ALWAYS,o,4294967295),r.buffers.stencil.setClear(l),r.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),r.buffers.color.setLocked(!1),r.buffers.depth.setLocked(!1),r.buffers.color.setMask(!0),r.buffers.depth.setMask(!0),r.buffers.stencil.setLocked(!1),r.buffers.stencil.setFunc(s.EQUAL,1,4294967295),r.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),r.buffers.stencil.setLocked(!0)}}class xKe extends dI{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class bKe{constructor(e,n){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),n===void 0){const i=e.getSize(new Nt);this._width=i.width,this._height=i.height,n=new vc(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:cs}),n.texture.name="EffectComposer.rt1"}else this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new _Ke(mKe),this.copyPass.material.blending=hl,this.clock=new _4}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,n){this.passes.splice(n,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const n=this.passes.indexOf(e);n!==-1&&this.passes.splice(n,1)}isLastEnabledPass(e){for(let n=e+1;n<this.passes.length;n++)if(this.passes[n].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const n=this.renderer.getRenderTarget();let i=!1;for(let s=0,r=this.passes.length;s<r;s++){const o=this.passes[s];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),o.needsSwap){if(i){const l=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(l.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(l.EQUAL,1,4294967295)}this.swapBuffers()}IY!==void 0&&(o instanceof IY?i=!0:o instanceof xKe&&(i=!1))}}this.renderer.setRenderTarget(n)}reset(e){if(e===void 0){const n=this.renderer.getSize(new Nt);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,n){this._width=e,this._height=n;const i=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(i,s),this.renderTarget2.setSize(i,s);for(let r=0;r<this.passes.length;r++)this.passes[r].setSize(i,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class SKe extends dI{constructor(e,n,i=null,s=null,r=null){super(),this.scene=e,this.camera=n,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=r,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this.isRenderPass=!0,this._oldClearColor=new on}render(e,n,i){const s=e.autoClear;e.autoClear=!1;let r,o;this.overrideMaterial!==null&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(r=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(r),this.overrideMaterial!==null&&(this.scene.overrideMaterial=o),e.autoClear=s}}function Ec(){return Ec=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(a[i]=n[i])}return a},Ec.apply(null,arguments)}function TKe(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function gT(a,e){return gT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gT(a,e)}function wKe(a,e){a.prototype=Object.create(e.prototype),a.prototype.constructor=a,gT(a,e)}function JO(a){return JO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},JO(a)}function EKe(a){try{return Function.toString.call(a).indexOf("[native code]")!==-1}catch{return typeof a=="function"}}function zoe(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zoe=function(){return!!a})()}function MKe(a,e,n){if(zoe())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var s=new(a.bind.apply(a,i));return n&&gT(s,n.prototype),s}function ZO(a){var e=typeof Map=="function"?new Map:void 0;return ZO=function(i){if(i===null||!EKe(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(i))return e.get(i);e.set(i,s)}function s(){return MKe(i,arguments,JO(this).constructor)}return s.prototype=Object.create(i.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),gT(s,i)},ZO(a)}var $h=(function(a){wKe(e,a);function e(n){var i;return i=a.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+n+" for more information.")||this,TKe(i)}return e})(ZO(Error));function d6(a){return Math.round(a*255)}function CKe(a,e,n){return d6(a)+","+d6(e)+","+d6(n)}function IR(a,e,n,i){if(i===void 0&&(i=CKe),e===0)return i(n,n,n);var s=(a%360+360)%360/60,r=(1-Math.abs(2*n-1))*e,o=r*(1-Math.abs(s%2-1)),l=0,c=0,u=0;s>=0&&s<1?(l=r,c=o):s>=1&&s<2?(l=o,c=r):s>=2&&s<3?(c=r,u=o):s>=3&&s<4?(c=o,u=r):s>=4&&s<5?(l=o,u=r):s>=5&&s<6&&(l=r,u=o);var h=n-r/2,f=l+h,m=c+h,A=u+h;return i(f,m,A)}var LY={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function NKe(a){if(typeof a!="string")return a;var e=a.toLowerCase();return LY[e]?"#"+LY[e]:a}var RKe=/^#[a-fA-F0-9]{6}$/,PKe=/^#[a-fA-F0-9]{8}$/,IKe=/^#[a-fA-F0-9]{3}$/,LKe=/^#[a-fA-F0-9]{4}$/,h6=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,DKe=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,kKe=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,OKe=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function vx(a){if(typeof a!="string")throw new $h(3);var e=NKe(a);if(e.match(RKe))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(PKe)){var n=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:n}}if(e.match(IKe))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(LKe)){var i=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:i}}var s=h6.exec(e);if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10)};var r=DKe.exec(e.substring(0,50));if(r)return{red:parseInt(""+r[1],10),green:parseInt(""+r[2],10),blue:parseInt(""+r[3],10),alpha:parseFloat(""+r[4])>1?parseFloat(""+r[4])/100:parseFloat(""+r[4])};var o=kKe.exec(e);if(o){var l=parseInt(""+o[1],10),c=parseInt(""+o[2],10)/100,u=parseInt(""+o[3],10)/100,h="rgb("+IR(l,c,u)+")",f=h6.exec(h);if(!f)throw new $h(4,e,h);return{red:parseInt(""+f[1],10),green:parseInt(""+f[2],10),blue:parseInt(""+f[3],10)}}var m=OKe.exec(e.substring(0,50));if(m){var A=parseInt(""+m[1],10),x=parseInt(""+m[2],10)/100,T=parseInt(""+m[3],10)/100,E="rgb("+IR(A,x,T)+")",M=h6.exec(E);if(!M)throw new $h(4,e,E);return{red:parseInt(""+M[1],10),green:parseInt(""+M[2],10),blue:parseInt(""+M[3],10),alpha:parseFloat(""+m[4])>1?parseFloat(""+m[4])/100:parseFloat(""+m[4])}}throw new $h(5)}function FKe(a){var e=a.red/255,n=a.green/255,i=a.blue/255,s=Math.max(e,n,i),r=Math.min(e,n,i),o=(s+r)/2;if(s===r)return a.alpha!==void 0?{hue:0,saturation:0,lightness:o,alpha:a.alpha}:{hue:0,saturation:0,lightness:o};var l,c=s-r,u=o>.5?c/(2-s-r):c/(s+r);switch(s){case e:l=(n-i)/c+(n<i?6:0);break;case n:l=(i-e)/c+2;break;default:l=(e-n)/c+4;break}return l*=60,a.alpha!==void 0?{hue:l,saturation:u,lightness:o,alpha:a.alpha}:{hue:l,saturation:u,lightness:o}}function F0(a){return FKe(vx(a))}var jKe=function(e){return e.length===7&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e},e8=jKe;function RA(a){var e=a.toString(16);return e.length===1?"0"+e:e}function f6(a){return RA(Math.round(a*255))}function BKe(a,e,n){return e8("#"+f6(a)+f6(e)+f6(n))}function Goe(a,e,n){return IR(a,e,n,BKe)}function UKe(a,e,n){if(typeof a=="object"&&e===void 0&&n===void 0)return Goe(a.hue,a.saturation,a.lightness);throw new $h(1)}function VKe(a,e,n,i){if(typeof a=="object"&&e===void 0&&n===void 0&&i===void 0)return a.alpha>=1?Goe(a.hue,a.saturation,a.lightness):"rgba("+IR(a.hue,a.saturation,a.lightness)+","+a.alpha+")";throw new $h(2)}function qoe(a,e,n){if(typeof a=="number"&&typeof e=="number"&&typeof n=="number")return e8("#"+RA(a)+RA(e)+RA(n));if(typeof a=="object"&&e===void 0&&n===void 0)return e8("#"+RA(a.red)+RA(a.green)+RA(a.blue));throw new $h(6)}function hI(a,e,n,i){if(typeof a=="object"&&e===void 0&&n===void 0&&i===void 0)return a.alpha>=1?qoe(a.red,a.green,a.blue):"rgba("+a.red+","+a.green+","+a.blue+","+a.alpha+")";throw new $h(7)}var zKe=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},GKe=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&typeof e.alpha=="number"},qKe=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},HKe=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&typeof e.alpha=="number"};function j0(a){if(typeof a!="object")throw new $h(8);if(GKe(a))return hI(a);if(zKe(a))return qoe(a);if(HKe(a))return VKe(a);if(qKe(a))return UKe(a);throw new $h(8)}function Hoe(a,e,n){return function(){var s=n.concat(Array.prototype.slice.call(arguments));return s.length>=e?a.apply(this,s):Hoe(a,e,s)}}function _u(a){return Hoe(a,a.length,[])}function WKe(a,e){if(e==="transparent")return e;var n=F0(e);return j0(Ec({},n,{hue:n.hue+parseFloat(a)}))}_u(WKe);function Xx(a,e,n){return Math.max(a,Math.min(e,n))}function $Ke(a,e){if(e==="transparent")return e;var n=F0(e);return j0(Ec({},n,{lightness:Xx(0,1,n.lightness-parseFloat(a))}))}_u($Ke);function KKe(a,e){if(e==="transparent")return e;var n=F0(e);return j0(Ec({},n,{saturation:Xx(0,1,n.saturation-parseFloat(a))}))}_u(KKe);function YKe(a,e){if(e==="transparent")return e;var n=F0(e);return j0(Ec({},n,{lightness:Xx(0,1,n.lightness+parseFloat(a))}))}_u(YKe);function XKe(a,e,n){if(e==="transparent")return n;if(n==="transparent")return e;if(a===0)return n;var i=vx(e),s=Ec({},i,{alpha:typeof i.alpha=="number"?i.alpha:1}),r=vx(n),o=Ec({},r,{alpha:typeof r.alpha=="number"?r.alpha:1}),l=s.alpha-o.alpha,c=parseFloat(a)*2-1,u=c*l===-1?c:c+l,h=1+c*l,f=(u/h+1)/2,m=1-f,A={red:Math.floor(s.red*f+o.red*m),green:Math.floor(s.green*f+o.green*m),blue:Math.floor(s.blue*f+o.blue*m),alpha:s.alpha*parseFloat(a)+o.alpha*(1-parseFloat(a))};return hI(A)}var QKe=_u(XKe),Woe=QKe;function JKe(a,e){if(e==="transparent")return e;var n=vx(e),i=typeof n.alpha=="number"?n.alpha:1,s=Ec({},n,{alpha:Xx(0,1,(i*100+parseFloat(a)*100)/100)});return hI(s)}var ZKe=_u(JKe),eYe=ZKe;function tYe(a,e){if(e==="transparent")return e;var n=F0(e);return j0(Ec({},n,{saturation:Xx(0,1,n.saturation+parseFloat(a))}))}_u(tYe);function nYe(a,e){return e==="transparent"?e:j0(Ec({},F0(e),{hue:parseFloat(a)}))}_u(nYe);function aYe(a,e){return e==="transparent"?e:j0(Ec({},F0(e),{lightness:parseFloat(a)}))}_u(aYe);function iYe(a,e){return e==="transparent"?e:j0(Ec({},F0(e),{saturation:parseFloat(a)}))}_u(iYe);function sYe(a,e){return e==="transparent"?e:Woe(parseFloat(a),"rgb(0, 0, 0)",e)}_u(sYe);function rYe(a,e){return e==="transparent"?e:Woe(parseFloat(a),"rgb(255, 255, 255)",e)}_u(rYe);function oYe(a,e){if(e==="transparent")return e;var n=vx(e),i=typeof n.alpha=="number"?n.alpha:1,s=Ec({},n,{alpha:Xx(0,1,+(i*100-parseFloat(a)*100).toFixed(2)/100)});return hI(s)}_u(oYe);var t8="http://www.w3.org/1999/xhtml";const DY={svg:"http://www.w3.org/2000/svg",xhtml:t8,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $oe(a){var e=a+="",n=e.indexOf(":");return n>=0&&(e=a.slice(0,n))!=="xmlns"&&(a=a.slice(n+1)),DY.hasOwnProperty(e)?{space:DY[e],local:a}:a}function lYe(a){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===t8&&e.documentElement.namespaceURI===t8?e.createElement(a):e.createElementNS(n,a)}}function cYe(a){return function(){return this.ownerDocument.createElementNS(a.space,a.local)}}function Koe(a){var e=$oe(a);return(e.local?cYe:lYe)(e)}function uYe(){}function Yoe(a){return a==null?uYe:function(){return this.querySelector(a)}}function dYe(a){typeof a!="function"&&(a=Yoe(a));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var r=e[s],o=r.length,l=i[s]=new Array(o),c,u,h=0;h<o;++h)(c=r[h])&&(u=a.call(c,c.__data__,h,r))&&("__data__"in c&&(u.__data__=c.__data__),l[h]=u);return new Ju(i,this._parents)}function hYe(a){return a==null?[]:Array.isArray(a)?a:Array.from(a)}function fYe(){return[]}function pYe(a){return a==null?fYe:function(){return this.querySelectorAll(a)}}function mYe(a){return function(){return hYe(a.apply(this,arguments))}}function gYe(a){typeof a=="function"?a=mYe(a):a=pYe(a);for(var e=this._groups,n=e.length,i=[],s=[],r=0;r<n;++r)for(var o=e[r],l=o.length,c,u=0;u<l;++u)(c=o[u])&&(i.push(a.call(c,c.__data__,u,o)),s.push(c));return new Ju(i,s)}function AYe(a){return function(){return this.matches(a)}}function Xoe(a){return function(e){return e.matches(a)}}var yYe=Array.prototype.find;function vYe(a){return function(){return yYe.call(this.children,a)}}function _Ye(){return this.firstElementChild}function xYe(a){return this.select(a==null?_Ye:vYe(typeof a=="function"?a:Xoe(a)))}var bYe=Array.prototype.filter;function SYe(){return Array.from(this.children)}function TYe(a){return function(){return bYe.call(this.children,a)}}function wYe(a){return this.selectAll(a==null?SYe:TYe(typeof a=="function"?a:Xoe(a)))}function EYe(a){typeof a!="function"&&(a=AYe(a));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var r=e[s],o=r.length,l=i[s]=[],c,u=0;u<o;++u)(c=r[u])&&a.call(c,c.__data__,u,r)&&l.push(c);return new Ju(i,this._parents)}function Qoe(a){return new Array(a.length)}function MYe(){return new Ju(this._enter||this._groups.map(Qoe),this._parents)}function LR(a,e){this.ownerDocument=a.ownerDocument,this.namespaceURI=a.namespaceURI,this._next=null,this._parent=a,this.__data__=e}LR.prototype={constructor:LR,appendChild:function(a){return this._parent.insertBefore(a,this._next)},insertBefore:function(a,e){return this._parent.insertBefore(a,e)},querySelector:function(a){return this._parent.querySelector(a)},querySelectorAll:function(a){return this._parent.querySelectorAll(a)}};function CYe(a){return function(){return a}}function NYe(a,e,n,i,s,r){for(var o=0,l,c=e.length,u=r.length;o<u;++o)(l=e[o])?(l.__data__=r[o],i[o]=l):n[o]=new LR(a,r[o]);for(;o<c;++o)(l=e[o])&&(s[o]=l)}function RYe(a,e,n,i,s,r,o){var l,c,u=new Map,h=e.length,f=r.length,m=new Array(h),A;for(l=0;l<h;++l)(c=e[l])&&(m[l]=A=o.call(c,c.__data__,l,e)+"",u.has(A)?s[l]=c:u.set(A,c));for(l=0;l<f;++l)A=o.call(a,r[l],l,r)+"",(c=u.get(A))?(i[l]=c,c.__data__=r[l],u.delete(A)):n[l]=new LR(a,r[l]);for(l=0;l<h;++l)(c=e[l])&&u.get(m[l])===c&&(s[l]=c)}function PYe(a){return a.__data__}function IYe(a,e){if(!arguments.length)return Array.from(this,PYe);var n=e?RYe:NYe,i=this._parents,s=this._groups;typeof a!="function"&&(a=CYe(a));for(var r=s.length,o=new Array(r),l=new Array(r),c=new Array(r),u=0;u<r;++u){var h=i[u],f=s[u],m=f.length,A=LYe(a.call(h,h&&h.__data__,u,i)),x=A.length,T=l[u]=new Array(x),E=o[u]=new Array(x),M=c[u]=new Array(m);n(h,f,T,E,M,A,e);for(var N=0,I=0,F,G;N<x;++N)if(F=T[N]){for(N>=I&&(I=N+1);!(G=E[I])&&++I<x;);F._next=G||null}}return o=new Ju(o,i),o._enter=l,o._exit=c,o}function LYe(a){return typeof a=="object"&&"length"in a?a:Array.from(a)}function DYe(){return new Ju(this._exit||this._groups.map(Qoe),this._parents)}function kYe(a,e,n){var i=this.enter(),s=this,r=this.exit();return typeof a=="function"?(i=a(i),i&&(i=i.selection())):i=i.append(a+""),e!=null&&(s=e(s),s&&(s=s.selection())),n==null?r.remove():n(r),i&&s?i.merge(s).order():s}function OYe(a){for(var e=a.selection?a.selection():a,n=this._groups,i=e._groups,s=n.length,r=i.length,o=Math.min(s,r),l=new Array(s),c=0;c<o;++c)for(var u=n[c],h=i[c],f=u.length,m=l[c]=new Array(f),A,x=0;x<f;++x)(A=u[x]||h[x])&&(m[x]=A);for(;c<s;++c)l[c]=n[c];return new Ju(l,this._parents)}function FYe(){for(var a=this._groups,e=-1,n=a.length;++e<n;)for(var i=a[e],s=i.length-1,r=i[s],o;--s>=0;)(o=i[s])&&(r&&o.compareDocumentPosition(r)^4&&r.parentNode.insertBefore(o,r),r=o);return this}function jYe(a){a||(a=BYe);function e(f,m){return f&&m?a(f.__data__,m.__data__):!f-!m}for(var n=this._groups,i=n.length,s=new Array(i),r=0;r<i;++r){for(var o=n[r],l=o.length,c=s[r]=new Array(l),u,h=0;h<l;++h)(u=o[h])&&(c[h]=u);c.sort(e)}return new Ju(s,this._parents).order()}function BYe(a,e){return a<e?-1:a>e?1:a>=e?0:NaN}function UYe(){var a=arguments[0];return arguments[0]=this,a.apply(null,arguments),this}function VYe(){return Array.from(this)}function zYe(){for(var a=this._groups,e=0,n=a.length;e<n;++e)for(var i=a[e],s=0,r=i.length;s<r;++s){var o=i[s];if(o)return o}return null}function GYe(){let a=0;for(const e of this)++a;return a}function qYe(){return!this.node()}function HYe(a){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var s=e[n],r=0,o=s.length,l;r<o;++r)(l=s[r])&&a.call(l,l.__data__,r,s);return this}function WYe(a){return function(){this.removeAttribute(a)}}function $Ye(a){return function(){this.removeAttributeNS(a.space,a.local)}}function KYe(a,e){return function(){this.setAttribute(a,e)}}function YYe(a,e){return function(){this.setAttributeNS(a.space,a.local,e)}}function XYe(a,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(a):this.setAttribute(a,n)}}function QYe(a,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,n)}}function JYe(a,e){var n=$oe(a);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?$Ye:WYe:typeof e=="function"?n.local?QYe:XYe:n.local?YYe:KYe)(n,e))}function Joe(a){return a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView}function ZYe(a){return function(){this.style.removeProperty(a)}}function eXe(a,e,n){return function(){this.style.setProperty(a,e,n)}}function tXe(a,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(a):this.style.setProperty(a,i,n)}}function nXe(a,e,n){return arguments.length>1?this.each((e==null?ZYe:typeof e=="function"?tXe:eXe)(a,e,n??"")):aXe(this.node(),a)}function aXe(a,e){return a.style.getPropertyValue(e)||Joe(a).getComputedStyle(a,null).getPropertyValue(e)}function iXe(a){return function(){delete this[a]}}function sXe(a,e){return function(){this[a]=e}}function rXe(a,e){return function(){var n=e.apply(this,arguments);n==null?delete this[a]:this[a]=n}}function oXe(a,e){return arguments.length>1?this.each((e==null?iXe:typeof e=="function"?rXe:sXe)(a,e)):this.node()[a]}function Zoe(a){return a.trim().split(/^|\s+/)}function W7(a){return a.classList||new ele(a)}function ele(a){this._node=a,this._names=Zoe(a.getAttribute("class")||"")}ele.prototype={add:function(a){var e=this._names.indexOf(a);e<0&&(this._names.push(a),this._node.setAttribute("class",this._names.join(" ")))},remove:function(a){var e=this._names.indexOf(a);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(a){return this._names.indexOf(a)>=0}};function tle(a,e){for(var n=W7(a),i=-1,s=e.length;++i<s;)n.add(e[i])}function nle(a,e){for(var n=W7(a),i=-1,s=e.length;++i<s;)n.remove(e[i])}function lXe(a){return function(){tle(this,a)}}function cXe(a){return function(){nle(this,a)}}function uXe(a,e){return function(){(e.apply(this,arguments)?tle:nle)(this,a)}}function dXe(a,e){var n=Zoe(a+"");if(arguments.length<2){for(var i=W7(this.node()),s=-1,r=n.length;++s<r;)if(!i.contains(n[s]))return!1;return!0}return this.each((typeof e=="function"?uXe:e?lXe:cXe)(n,e))}function hXe(){this.textContent=""}function fXe(a){return function(){this.textContent=a}}function pXe(a){return function(){var e=a.apply(this,arguments);this.textContent=e??""}}function mXe(a){return arguments.length?this.each(a==null?hXe:(typeof a=="function"?pXe:fXe)(a)):this.node().textContent}function gXe(){this.innerHTML=""}function AXe(a){return function(){this.innerHTML=a}}function yXe(a){return function(){var e=a.apply(this,arguments);this.innerHTML=e??""}}function vXe(a){return arguments.length?this.each(a==null?gXe:(typeof a=="function"?yXe:AXe)(a)):this.node().innerHTML}function _Xe(){this.nextSibling&&this.parentNode.appendChild(this)}function xXe(){return this.each(_Xe)}function bXe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function SXe(){return this.each(bXe)}function TXe(a){var e=typeof a=="function"?a:Koe(a);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function wXe(){return null}function EXe(a,e){var n=typeof a=="function"?a:Koe(a),i=e==null?wXe:typeof e=="function"?e:Yoe(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function MXe(){var a=this.parentNode;a&&a.removeChild(this)}function CXe(){return this.each(MXe)}function NXe(){var a=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(a,this.nextSibling):a}function RXe(){var a=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(a,this.nextSibling):a}function PXe(a){return this.select(a?RXe:NXe)}function IXe(a){return arguments.length?this.property("__data__",a):this.node().__data__}function LXe(a){return function(e){a.call(this,e,this.__data__)}}function DXe(a){return a.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function kXe(a){return function(){var e=this.__on;if(e){for(var n=0,i=-1,s=e.length,r;n<s;++n)r=e[n],(!a.type||r.type===a.type)&&r.name===a.name?this.removeEventListener(r.type,r.listener,r.options):e[++i]=r;++i?e.length=i:delete this.__on}}}function OXe(a,e,n){return function(){var i=this.__on,s,r=LXe(e);if(i){for(var o=0,l=i.length;o<l;++o)if((s=i[o]).type===a.type&&s.name===a.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=r,s.options=n),s.value=e;return}}this.addEventListener(a.type,r,n),s={type:a.type,name:a.name,value:e,listener:r,options:n},i?i.push(s):this.__on=[s]}}function FXe(a,e,n){var i=DXe(a+""),s,r=i.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,u=l.length,h;c<u;++c)for(s=0,h=l[c];s<r;++s)if((o=i[s]).type===h.type&&o.name===h.name)return h.value}return}for(l=e?OXe:kXe,s=0;s<r;++s)this.each(l(i[s],e,n));return this}function ale(a,e,n){var i=Joe(a),s=i.CustomEvent;typeof s=="function"?s=new s(e,n):(s=i.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),a.dispatchEvent(s)}function jXe(a,e){return function(){return ale(this,a,e)}}function BXe(a,e){return function(){return ale(this,a,e.apply(this,arguments))}}function UXe(a,e){return this.each((typeof e=="function"?BXe:jXe)(a,e))}function*VXe(){for(var a=this._groups,e=0,n=a.length;e<n;++e)for(var i=a[e],s=0,r=i.length,o;s<r;++s)(o=i[s])&&(yield o)}var zXe=[null];function Ju(a,e){this._groups=a,this._parents=e}function GXe(){return this}Ju.prototype={constructor:Ju,select:dYe,selectAll:gYe,selectChild:xYe,selectChildren:wYe,filter:EYe,data:IYe,enter:MYe,exit:DYe,join:kYe,merge:OYe,selection:GXe,order:FYe,sort:jYe,call:UYe,nodes:VYe,node:zYe,size:GYe,empty:qYe,each:HYe,attr:JYe,style:nXe,property:oXe,classed:dXe,text:mXe,html:vXe,raise:xXe,lower:SXe,append:TXe,insert:EXe,remove:CXe,clone:PXe,datum:IXe,on:FXe,dispatch:UXe,[Symbol.iterator]:VXe};function qXe(a){return typeof a=="string"?new Ju([[document.querySelector(a)]],[document.documentElement]):new Ju([[a]],zXe)}function HXe(a){let e;for(;e=a.sourceEvent;)a=e;return a}function WXe(a,e){if(a=HXe(a),e===void 0&&(e=a.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=a.clientX,i.y=a.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[a.clientX-s.left-e.clientLeft,a.clientY-s.top-e.clientTop]}}return[a.pageX,a.pageY]}var xw,Ms,ile,sle,OA,kY,rle,ole,lle,$7,n8,a8,AT={},cle=[],$Xe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,fI=Array.isArray;function Kh(a,e){for(var n in e)a[n]=e[n];return a}function K7(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function KXe(a,e,n){var i,s,r,o={};for(r in e)r=="key"?i=e[r]:r=="ref"?s=e[r]:o[r]=e[r];if(arguments.length>2&&(o.children=arguments.length>3?xw.call(arguments,2):n),typeof a=="function"&&a.defaultProps!=null)for(r in a.defaultProps)o[r]===void 0&&(o[r]=a.defaultProps[r]);return xS(a,o,i,s,null)}function xS(a,e,n,i,s){var r={type:a,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++ile,__i:-1,__u:0};return s==null&&Ms.vnode!=null&&Ms.vnode(r),r}function pI(a){return a.children}function f3(a,e){this.props=a,this.context=e}function _x(a,e){if(e==null)return a.__?_x(a.__,a.__i+1):null;for(var n;e<a.__k.length;e++)if((n=a.__k[e])!=null&&n.__e!=null)return n.__e;return typeof a.type=="function"?_x(a):null}function ule(a){var e,n;if((a=a.__)!=null&&a.__c!=null){for(a.__e=a.__c.base=null,e=0;e<a.__k.length;e++)if((n=a.__k[e])!=null&&n.__e!=null){a.__e=a.__c.base=n.__e;break}return ule(a)}}function OY(a){(!a.__d&&(a.__d=!0)&&OA.push(a)&&!DR.__r++||kY!=Ms.debounceRendering)&&((kY=Ms.debounceRendering)||rle)(DR)}function DR(){for(var a,e,n,i,s,r,o,l=1;OA.length;)OA.length>l&&OA.sort(ole),a=OA.shift(),l=OA.length,a.__d&&(n=void 0,i=void 0,s=(i=(e=a).__v).__e,r=[],o=[],e.__P&&((n=Kh({},i)).__v=i.__v+1,Ms.vnode&&Ms.vnode(n),Y7(e.__P,n,i,e.__n,e.__P.namespaceURI,32&i.__u?[s]:null,r,s??_x(i),!!(32&i.__u),o),n.__v=i.__v,n.__.__k[n.__i]=n,fle(r,n,o),i.__e=i.__=null,n.__e!=s&&ule(n)));DR.__r=0}function dle(a,e,n,i,s,r,o,l,c,u,h){var f,m,A,x,T,E,M,N=i&&i.__k||cle,I=e.length;for(c=YXe(n,e,N,c,I),f=0;f<I;f++)(A=n.__k[f])!=null&&(m=A.__i==-1?AT:N[A.__i]||AT,A.__i=f,E=Y7(a,A,m,s,r,o,l,c,u,h),x=A.__e,A.ref&&m.ref!=A.ref&&(m.ref&&X7(m.ref,null,A),h.push(A.ref,A.__c||x,A)),T==null&&x!=null&&(T=x),(M=!!(4&A.__u))||m.__k===A.__k?c=hle(A,c,a,M):typeof A.type=="function"&&E!==void 0?c=E:x&&(c=x.nextSibling),A.__u&=-7);return n.__e=T,c}function YXe(a,e,n,i,s){var r,o,l,c,u,h=n.length,f=h,m=0;for(a.__k=new Array(s),r=0;r<s;r++)(o=e[r])!=null&&typeof o!="boolean"&&typeof o!="function"?(typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?o=a.__k[r]=xS(null,o,null,null,null):fI(o)?o=a.__k[r]=xS(pI,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?o=a.__k[r]=xS(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):a.__k[r]=o,c=r+m,o.__=a,o.__b=a.__b+1,l=null,(u=o.__i=XXe(o,n,c,f))!=-1&&(f--,(l=n[u])&&(l.__u|=2)),l==null||l.__v==null?(u==-1&&(s>h?m--:s<h&&m++),typeof o.type!="function"&&(o.__u|=4)):u!=c&&(u==c-1?m--:u==c+1?m++:(u>c?m--:m++,o.__u|=4))):a.__k[r]=null;if(f)for(r=0;r<h;r++)(l=n[r])!=null&&(2&l.__u)==0&&(l.__e==i&&(i=_x(l)),mle(l,l));return i}function hle(a,e,n,i){var s,r;if(typeof a.type=="function"){for(s=a.__k,r=0;s&&r<s.length;r++)s[r]&&(s[r].__=a,e=hle(s[r],e,n,i));return e}a.__e!=e&&(i&&(e&&a.type&&!e.parentNode&&(e=_x(a)),n.insertBefore(a.__e,e||null)),e=a.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function XXe(a,e,n,i){var s,r,o,l=a.key,c=a.type,u=e[n],h=u!=null&&(2&u.__u)==0;if(u===null&&l==null||h&&l==u.key&&c==u.type)return n;if(i>(h?1:0)){for(s=n-1,r=n+1;s>=0||r<e.length;)if((u=e[o=s>=0?s--:r++])!=null&&(2&u.__u)==0&&l==u.key&&c==u.type)return o}return-1}function FY(a,e,n){e[0]=="-"?a.setProperty(e,n??""):a[e]=n==null?"":typeof n!="number"||$Xe.test(e)?n:n+"px"}function wC(a,e,n,i,s){var r,o;e:if(e=="style")if(typeof n=="string")a.style.cssText=n;else{if(typeof i=="string"&&(a.style.cssText=i=""),i)for(e in i)n&&e in n||FY(a.style,e,"");if(n)for(e in n)i&&n[e]==i[e]||FY(a.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(lle,"$1")),o=e.toLowerCase(),e=o in a||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),a.l||(a.l={}),a.l[e+r]=n,n?i?n.u=i.u:(n.u=$7,a.addEventListener(e,r?a8:n8,r)):a.removeEventListener(e,r?a8:n8,r);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in a)try{a[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?a.removeAttribute(e):a.setAttribute(e,e=="popover"&&n==1?"":n))}}function jY(a){return function(e){if(this.l){var n=this.l[e.type+a];if(e.t==null)e.t=$7++;else if(e.t<n.u)return;return n(Ms.event?Ms.event(e):e)}}}function Y7(a,e,n,i,s,r,o,l,c,u){var h,f,m,A,x,T,E,M,N,I,F,G,O,D,j,L,U,q=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(c=!!(32&n.__u),r=[l=e.__e=n.__e]),(h=Ms.__b)&&h(e);e:if(typeof q=="function")try{if(M=e.props,N="prototype"in q&&q.prototype.render,I=(h=q.contextType)&&i[h.__c],F=h?I?I.props.value:h.__:i,n.__c?E=(f=e.__c=n.__c).__=f.__E:(N?e.__c=f=new q(M,F):(e.__c=f=new f3(M,F),f.constructor=q,f.render=JXe),I&&I.sub(f),f.state||(f.state={}),f.__n=i,m=f.__d=!0,f.__h=[],f._sb=[]),N&&f.__s==null&&(f.__s=f.state),N&&q.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=Kh({},f.__s)),Kh(f.__s,q.getDerivedStateFromProps(M,f.__s))),A=f.props,x=f.state,f.__v=e,m)N&&q.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),N&&f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(N&&q.getDerivedStateFromProps==null&&M!==A&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(M,F),e.__v==n.__v||!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(M,f.__s,F)===!1){for(e.__v!=n.__v&&(f.props=M,f.state=f.__s,f.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(K){K&&(K.__=e)}),G=0;G<f._sb.length;G++)f.__h.push(f._sb[G]);f._sb=[],f.__h.length&&o.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(M,f.__s,F),N&&f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(A,x,T)})}if(f.context=F,f.props=M,f.__P=a,f.__e=!1,O=Ms.__r,D=0,N){for(f.state=f.__s,f.__d=!1,O&&O(e),h=f.render(f.props,f.state,f.context),j=0;j<f._sb.length;j++)f.__h.push(f._sb[j]);f._sb=[]}else do f.__d=!1,O&&O(e),h=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++D<25);f.state=f.__s,f.getChildContext!=null&&(i=Kh(Kh({},i),f.getChildContext())),N&&!m&&f.getSnapshotBeforeUpdate!=null&&(T=f.getSnapshotBeforeUpdate(A,x)),L=h,h!=null&&h.type===pI&&h.key==null&&(L=ple(h.props.children)),l=dle(a,fI(L)?L:[L],e,n,i,s,r,o,l,c,u),f.base=e.__e,e.__u&=-161,f.__h.length&&o.push(f),E&&(f.__E=f.__=null)}catch(K){if(e.__v=null,c||r!=null)if(K.then){for(e.__u|=c?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;r[r.indexOf(l)]=null,e.__e=l}else{for(U=r.length;U--;)K7(r[U]);i8(e)}else e.__e=n.__e,e.__k=n.__k,K.then||i8(e);Ms.__e(K,e,n)}else r==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):l=e.__e=QXe(n.__e,e,n,i,s,r,o,c,u);return(h=Ms.diffed)&&h(e),128&e.__u?void 0:l}function i8(a){a&&a.__c&&(a.__c.__e=!0),a&&a.__k&&a.__k.forEach(i8)}function fle(a,e,n){for(var i=0;i<n.length;i++)X7(n[i],n[++i],n[++i]);Ms.__c&&Ms.__c(e,a),a.some(function(s){try{a=s.__h,s.__h=[],a.some(function(r){r.call(s)})}catch(r){Ms.__e(r,s.__v)}})}function ple(a){return typeof a!="object"||a==null||a.__b&&a.__b>0?a:fI(a)?a.map(ple):Kh({},a)}function QXe(a,e,n,i,s,r,o,l,c){var u,h,f,m,A,x,T,E=n.props||AT,M=e.props,N=e.type;if(N=="svg"?s="http://www.w3.org/2000/svg":N=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),r!=null){for(u=0;u<r.length;u++)if((A=r[u])&&"setAttribute"in A==!!N&&(N?A.localName==N:A.nodeType==3)){a=A,r[u]=null;break}}if(a==null){if(N==null)return document.createTextNode(M);a=document.createElementNS(s,N,M.is&&M),l&&(Ms.__m&&Ms.__m(e,r),l=!1),r=null}if(N==null)E===M||l&&a.data==M||(a.data=M);else{if(r=r&&xw.call(a.childNodes),!l&&r!=null)for(E={},u=0;u<a.attributes.length;u++)E[(A=a.attributes[u]).name]=A.value;for(u in E)if(A=E[u],u!="children"){if(u=="dangerouslySetInnerHTML")f=A;else if(!(u in M)){if(u=="value"&&"defaultValue"in M||u=="checked"&&"defaultChecked"in M)continue;wC(a,u,null,A,s)}}for(u in M)A=M[u],u=="children"?m=A:u=="dangerouslySetInnerHTML"?h=A:u=="value"?x=A:u=="checked"?T=A:l&&typeof A!="function"||E[u]===A||wC(a,u,A,E[u],s);if(h)l||f&&(h.__html==f.__html||h.__html==a.innerHTML)||(a.innerHTML=h.__html),e.__k=[];else if(f&&(a.innerHTML=""),dle(e.type=="template"?a.content:a,fI(m)?m:[m],e,n,i,N=="foreignObject"?"http://www.w3.org/1999/xhtml":s,r,o,r?r[0]:n.__k&&_x(n,0),l,c),r!=null)for(u=r.length;u--;)K7(r[u]);l||(u="value",N=="progress"&&x==null?a.removeAttribute("value"):x!=null&&(x!==a[u]||N=="progress"&&!x||N=="option"&&x!=E[u])&&wC(a,u,x,E[u],s),u="checked",T!=null&&T!=a[u]&&wC(a,u,T,E[u],s))}return a}function X7(a,e,n){try{if(typeof a=="function"){var i=typeof a.__u=="function";i&&a.__u(),i&&e==null||(a.__u=a(e))}else a.current=e}catch(s){Ms.__e(s,n)}}function mle(a,e,n){var i,s;if(Ms.unmount&&Ms.unmount(a),(i=a.ref)&&(i.current&&i.current!=a.__e||X7(i,null,e)),(i=a.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(r){Ms.__e(r,e)}i.base=i.__P=null}if(i=a.__k)for(s=0;s<i.length;s++)i[s]&&mle(i[s],e,n||typeof a.type!="function");n||K7(a.__e),a.__c=a.__=a.__e=void 0}function JXe(a,e,n){return this.constructor(a,n)}function ZXe(a,e,n){var i,s,r,o;e==document&&(e=document.documentElement),Ms.__&&Ms.__(a,e),s=(i=!1)?null:e.__k,r=[],o=[],Y7(e,a=e.__k=KXe(pI,null,[a]),s||AT,AT,e.namespaceURI,s?null:e.firstChild?xw.call(e.childNodes):null,r,s?s.__e:e.firstChild,i,o),fle(r,a,o)}function gle(a,e,n){var i,s,r,o,l=Kh({},a.props);for(r in a.type&&a.type.defaultProps&&(o=a.type.defaultProps),e)r=="key"?i=e[r]:r=="ref"?s=e[r]:l[r]=e[r]===void 0&&o!=null?o[r]:e[r];return arguments.length>2&&(l.children=arguments.length>3?xw.call(arguments,2):n),xS(a.type,l,i||a.key,s||a.ref,null)}xw=cle.slice,Ms={__e:function(a,e,n,i){for(var s,r,o;e=e.__;)if((s=e.__c)&&!s.__)try{if((r=s.constructor)&&r.getDerivedStateFromError!=null&&(s.setState(r.getDerivedStateFromError(a)),o=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(a,i||{}),o=s.__d),o)return s.__E=s}catch(l){a=l}throw a}},ile=0,sle=function(a){return a!=null&&a.constructor===void 0},f3.prototype.setState=function(a,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Kh({},this.state),typeof a=="function"&&(a=a(Kh({},n),this.props)),a&&Kh(n,a),a!=null&&this.__v&&(e&&this._sb.push(e),OY(this))},f3.prototype.forceUpdate=function(a){this.__v&&(this.__e=!0,a&&this.__h.push(a),OY(this))},f3.prototype.render=pI,OA=[],rle=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ole=function(a,e){return a.__v.__b-e.__v.__b},DR.__r=0,lle=/(PointerCapture)$|Capture$/i,$7=0,n8=jY(!1),a8=jY(!0);function BY(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=Array(e);n<e;n++)i[n]=a[n];return i}function eQe(a){if(Array.isArray(a))return a}function tQe(a,e,n){return(e=oQe(e))in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}function nQe(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i,s,r,o,l=[],c=!0,u=!1;try{if(r=(n=n.call(a)).next,e!==0)for(;!(c=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function aQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UY(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,i)}return n}function iQe(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UY(Object(n),!0).forEach(function(i){tQe(a,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):UY(Object(n)).forEach(function(i){Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(n,i))})}return a}function sQe(a,e){return eQe(a)||nQe(a,e)||lQe(a,e)||aQe()}function rQe(a,e){if(typeof a!="object"||!a)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var i=n.call(a,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function oQe(a){var e=rQe(a,"string");return typeof e=="symbol"?e:e+""}function kR(a){"@babel/helpers - typeof";return kR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kR(a)}function lQe(a,e){if(a){if(typeof a=="string")return BY(a,e);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?BY(a,e):void 0}}var s8=function(e){if(kR(e)!=="object")return e;var n=gle(e);if(n.props){var i;n.props=iQe({},n.props),n!=null&&(i=n.props)!==null&&i!==void 0&&i.children&&(n.props.children=Array.isArray(n.props.children)?n.props.children.map(s8):s8(n.props.children))}return n},cQe=function(e){return sle(gle(e))},uQe=function(e,n){delete n.__k,ZXe(s8(e),n)};function dQe(a,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=a:s.appendChild(document.createTextNode(a))}}var hQe=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;dQe(hQe);var fQe=Wr({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=i.style,r=s===void 0?{}:s,o=!!e&&kR(e)==="object"&&!!e.node&&typeof e.node=="function",l=qXe(o?e.node():e);l.style("position")==="static"&&l.style("position","relative"),n.tooltipEl=l.append("div").attr("class","float-tooltip-kap"),Object.entries(r).forEach(function(u){var h=sQe(u,2),f=h[0],m=h[1];return n.tooltipEl.style(f,m)}),n.tooltipEl.style("left","-10000px").style("display","none");var c="tooltip-".concat(Math.round(Math.random()*1e12));n.mouseInside=!1,l.on("mousemove.".concat(c),function(u){n.mouseInside=!0;var h=WXe(u),f=l.node(),m=f.offsetWidth,A=f.offsetHeight,x=[n.offsetX===null||n.offsetX===void 0?"-".concat(h[0]/m*100,"%"):typeof n.offsetX=="number"?"calc(-50% + ".concat(n.offsetX,"px)"):n.offsetX,n.offsetY===null||n.offsetY===void 0?A>130&&A-h[1]<100?"calc(-100% - 6px)":"21px":typeof n.offsetY=="number"?n.offsetY<0?"calc(-100% - ".concat(Math.abs(n.offsetY),"px)"):"".concat(n.offsetY,"px"):n.offsetY];n.tooltipEl.style("left",h[0]+"px").style("top",h[1]+"px").style("transform","translate(".concat(x.join(","),")")),n.content&&n.tooltipEl.style("display","inline")}),l.on("mouseover.".concat(c),function(){n.mouseInside=!0,n.content&&n.tooltipEl.style("display","inline")}),l.on("mouseout.".concat(c),function(){n.mouseInside=!1,n.tooltipEl.style("display","none")})},update:function(e){e.tooltipEl.style("display",e.content&&e.mouseInside?"inline":"none"),e.content?e.content instanceof HTMLElement?(e.tooltipEl.text(""),e.tooltipEl.append(function(){return e.content})):typeof e.content=="string"?e.tooltipEl.html(e.content):cQe(e.content)?(e.tooltipEl.text(""),uQe(e.content,e.tooltipEl.node())):(e.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",e.content,e.content.toString())):e.tooltipEl.text("")}});function pQe(a,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=a:s.appendChild(document.createTextNode(a))}}var mQe=`.scene-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;pQe(mQe);function r8(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=Array(e);n<e;n++)i[n]=a[n];return i}function gQe(a){if(Array.isArray(a))return a}function AQe(a){if(Array.isArray(a))return r8(a)}function yQe(a,e,n){return(e=wQe(e))in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}function vQe(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function _Qe(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var i,s,r,o,l=[],c=!0,u=!1;try{if(r=(n=n.call(a)).next,e!==0)for(;!(c=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function xQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SQe(a,e){return gQe(a)||_Qe(a,e)||Ale(a,e)||xQe()}function EA(a){return AQe(a)||vQe(a)||Ale(a)||bQe()}function TQe(a,e){if(typeof a!="object"||!a)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var i=n.call(a,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function wQe(a){var e=TQe(a,"string");return typeof e=="symbol"?e:e+""}function Ale(a,e){if(a){if(typeof a=="string")return r8(a,e);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r8(a,e):void 0}}var Ts=window.THREE?window.THREE:{WebGLRenderer:lte,Scene:Vx,PerspectiveCamera:Zs,Raycaster:Jee,SRGBColorSpace:Fr,TextureLoader:g4,Vector2:Nt,Vector3:ye,Box3:Mr,Color:on,Mesh:Na,SphereGeometry:vu,MeshBasicMaterial:oo,BackSide:Di,Clock:_4},yle=Wr({props:{width:{default:window.innerWidth,onChange:function(e,n,i){isNaN(e)&&(n.width=i)}},height:{default:window.innerHeight,onChange:function(e,n,i){isNaN(e)&&(n.height=i)}},viewOffset:{default:[0,0]},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,n){n.hoverObj=null,n.tooltip&&n.tooltip.content(null)},triggerUpdate:!1},pointerRaycasterThrottleMs:{default:50,triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},pointsHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){e.controls.enabled&&e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach(function(o){return o.render(e.scene,e.camera)});var n=+new Date;if(e.enablePointerInteraction&&n-e.lastRaycasterCheck>=e.pointerRaycasterThrottleMs){e.lastRaycasterCheck=n;var i=null;if(e.hoverDuringDrag||!e.isPointerDragging){var s=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y);e.hoverOrderComparator&&s.sort(function(o,l){return e.hoverOrderComparator(o.object,l.object)});var r=s.find(function(o){return e.hoverFilter(o.object)})||null;i=r?r.object:null,e.intersection=r||null}i!==e.hoverObj&&(e.onHover(i,e.hoverObj,e.intersection),e.tooltip.content(i&&Yt(e.tooltipContent)(i,e.intersection)||null),e.hoverObj=i)}e.tweenGroup.update()}return this},getPointerPos:function(e){var n=e.pointerPos,i=n.x,s=n.y;return{x:i,y:s}},cameraPosition:function(e,n,i,s){var r=e.camera;if(n&&e.initialised){var o=n,l=i||{x:0,y:0,z:0};if(!s)h(o),f(l);else{var c=Object.assign({},r.position),u=m();e.tweenGroup.add(new gl(c).to(o,s).easing(Nr.Quadratic.Out).onUpdate(h).start()),e.tweenGroup.add(new gl(u).to(l,s/3).easing(Nr.Quadratic.Out).onUpdate(f).start())}return this}return Object.assign({},r.position,{lookAt:m()});function h(A){var x=A.x,T=A.y,E=A.z;x!==void 0&&(r.position.x=x),T!==void 0&&(r.position.y=T),E!==void 0&&(r.position.z=E)}function f(A){var x=new Ts.Vector3(A.x,A.y,A.z);e.controls.enabled&&e.controls.target?e.controls.target=x:r.lookAt(x)}function m(){return Object.assign(new Ts.Vector3(0,0,-1e3).applyQuaternion(r.quaternion).add(r.position))}},zoomToFit:function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,s=arguments.length,r=new Array(s>3?s-3:0),o=3;o<s;o++)r[o-3]=arguments[o];return this.fitToBbox(this.getBbox.apply(this,r),n,i)},fitToBbox:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,r=e.camera;if(n){var o=new Ts.Vector3(0,0,0),l=Math.max.apply(Math,EA(Object.entries(n).map(function(A){var x=SQe(A,2),T=x[0],E=x[1];return Math.max.apply(Math,EA(E.map(function(M){return Math.abs(o[T]-M)})))})))*2,c=(1-s*2/e.height)*r.fov,u=l/Math.atan(c*Math.PI/180),h=u/r.aspect,f=Math.max(u,h);if(f>0){var m=o.clone().sub(r.position).normalize().multiplyScalar(-f);this.cameraPosition(m,o,i)}}return this},getBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=new Ts.Box3(new Ts.Vector3(0,0,0),new Ts.Vector3(0,0,0)),s=e.objects.filter(n);return s.length?(s.forEach(function(r){return i.expandByObject(r)}),Object.assign.apply(Object,EA(["x","y","z"].map(function(r){return yQe({},r,[i.min[r],i.max[r]])})))):null},getScreenCoords:function(e,n,i,s){var r=new Ts.Vector3(n,i,s);return r.project(this.camera()),{x:(r.x+1)*e.width/2,y:-(r.y-1)*e.height/2}},getSceneCoords:function(e,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,r=new Ts.Vector2(n/e.width*2-1,-(i/e.height)*2+1),o=new Ts.Raycaster;return o.setFromCamera(r,e.camera),Object.assign({},o.ray.at(s,new Ts.Vector3))},intersectingObjects:function(e,n,i){var s=new Ts.Vector2(n/e.width*2-1,-(i/e.height)*2+1),r=new Ts.Raycaster;return r.params.Line.threshold=e.lineHoverPrecision,r.params.Points.threshold=e.pointsHoverPrecision,r.setFromCamera(s,e.camera),r.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new Ts.Scene,camera:new Ts.PerspectiveCamera,clock:new Ts.Clock,tweenGroup:new T4,lastRaycasterCheck:0}},init:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=i.controlType,r=s===void 0?"trackball":s,o=i.useWebGPU,l=o===void 0?!1:o,c=i.rendererConfig,u=c===void 0?{}:c,h=i.extraRenderers,f=h===void 0?[]:h,m=i.waitForLoadComplete,A=m===void 0?!0:m;e.innerHTML="",e.appendChild(n.container=document.createElement("div")),n.container.className="scene-container",n.container.style.position="relative",n.container.appendChild(n.navInfo=document.createElement("div")),n.navInfo.className="scene-nav-info",n.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[r]||"",n.navInfo.style.display=n.showNavInfo?null:"none",n.tooltip=new fQe(n.container),n.pointerPos=new Ts.Vector2,n.pointerPos.x=-2,n.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(x){return n.container.addEventListener(x,function(T){if(x==="pointerdown"&&(n.isPointerPressed=!0),!n.isPointerDragging&&T.type==="pointermove"&&(T.pressure>0||n.isPointerPressed)&&(T.pointerType==="mouse"||T.movementX===void 0||[T.movementX,T.movementY].some(function(N){return Math.abs(N)>1}))&&(n.isPointerDragging=!0),n.enablePointerInteraction){var E=M(n.container);n.pointerPos.x=T.pageX-E.left,n.pointerPos.y=T.pageY-E.top}function M(N){var I=N.getBoundingClientRect(),F=window.pageXOffset||document.documentElement.scrollLeft,G=window.pageYOffset||document.documentElement.scrollTop;return{top:I.top+G,left:I.left+F}}},{passive:!0})}),n.container.addEventListener("pointerup",function(x){n.isPointerPressed&&(n.isPointerPressed=!1,!(n.isPointerDragging&&(n.isPointerDragging=!1,!n.clickAfterDrag))&&requestAnimationFrame(function(){x.button===0&&n.onClick(n.hoverObj||null,x,n.intersection),x.button===2&&n.onRightClick&&n.onRightClick(n.hoverObj||null,x,n.intersection)}))},{passive:!0,capture:!0}),n.container.addEventListener("contextmenu",function(x){n.onRightClick&&x.preventDefault()}),n.renderer=new(l?poe:Ts.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},u)),n.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),n.container.appendChild(n.renderer.domElement),n.extraRenderers=f,n.extraRenderers.forEach(function(x){x.domElement.style.position="absolute",x.domElement.style.top="0px",x.domElement.style.pointerEvents="none",n.container.appendChild(x.domElement)}),n.postProcessingComposer=new bKe(n.renderer),n.postProcessingComposer.addPass(new SKe(n.scene,n.camera)),n.controls=new{trackball:P$e,orbit:$$e,fly:oKe}[r](n.camera,n.renderer.domElement),r==="fly"&&(n.controls.movementSpeed=300,n.controls.rollSpeed=Math.PI/6,n.controls.dragToLook=!0),(r==="trackball"||r==="orbit")&&(n.controls.minDistance=.1,n.controls.maxDistance=n.skyRadius,n.controls.addEventListener("start",function(){n.controlsEngaged=!0}),n.controls.addEventListener("change",function(){n.controlsEngaged&&(n.controlsDragging=!0)}),n.controls.addEventListener("end",function(){n.controlsEngaged=!1,n.controlsDragging=!1})),[n.renderer,n.postProcessingComposer].concat(EA(n.extraRenderers)).forEach(function(x){return x.setSize(n.width,n.height)}),n.camera.aspect=n.width/n.height,n.camera.updateProjectionMatrix(),n.camera.position.z=1e3,n.scene.add(n.skysphere=new Ts.Mesh),n.skysphere.visible=!1,n.loadComplete=n.scene.visible=!A,window.scene=n.scene},update:function(e,n){if(e.width&&e.height&&(n.hasOwnProperty("width")||n.hasOwnProperty("height"))){var i,s=e.width,r=e.height;e.container.style.width="".concat(s,"px"),e.container.style.height="".concat(r,"px"),[e.renderer,e.postProcessingComposer].concat(EA(e.extraRenderers)).forEach(function(A){return A.setSize(s,r)}),e.camera.aspect=s/r;var o=e.viewOffset.slice(0,2);o.some(function(A){return A})&&(i=e.camera).setViewOffset.apply(i,[s,r].concat(EA(o),[s,r])),e.camera.updateProjectionMatrix()}if(n.hasOwnProperty("viewOffset")){var l,c=e.width,u=e.height,h=e.viewOffset.slice(0,2);h.some(function(A){return A})?(l=e.camera).setViewOffset.apply(l,[c,u].concat(EA(h),[c,u])):e.camera.clearViewOffset()}if(n.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&n.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=e.skyRadius*2.5,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new Ts.SphereGeometry(e.skyRadius)),n.hasOwnProperty("backgroundColor")){var f=vx(e.backgroundColor).alpha;f===void 0&&(f=1),e.renderer.setClearColor(new Ts.Color(eYe(1,e.backgroundColor)),f)}n.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?new Ts.TextureLoader().load(e.backgroundImageUrl,function(A){A.colorSpace=Ts.SRGBColorSpace,e.skysphere.material=new Ts.MeshBasicMaterial({map:A,side:Ts.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&m()}):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&m())),n.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),n.hasOwnProperty("lights")&&((n.lights||[]).forEach(function(A){return e.scene.remove(A)}),e.lights.forEach(function(A){return e.scene.add(A)})),n.hasOwnProperty("objects")&&((n.objects||[]).forEach(function(A){return e.scene.remove(A)}),e.objects.forEach(function(A){return e.scene.add(A)}));function m(){e.loadComplete=e.scene.visible=!0}}});function EQe(a,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=a:s.appendChild(document.createTextNode(a))}}var MQe=`.scene-container .clickable {
  cursor: pointer;
}`;EQe(MQe);function o8(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,i=Array(e);n<e;n++)i[n]=a[n];return i}function CQe(a){if(Array.isArray(a))return o8(a)}function bw(a,e,n){return(e=DQe(e))in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}function NQe(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function RQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VY(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,i)}return n}function FA(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?VY(Object(n),!0).forEach(function(i){bw(a,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):VY(Object(n)).forEach(function(i){Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(n,i))})}return a}function PQe(a,e){if(a==null)return{};var n,i,s=IQe(a,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);for(i=0;i<r.length;i++)n=r[i],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(a,n)&&(s[n]=a[n])}return s}function IQe(a,e){if(a==null)return{};var n={};for(var i in a)if({}.hasOwnProperty.call(a,i)){if(e.indexOf(i)!==-1)continue;n[i]=a[i]}return n}function mI(a){return CQe(a)||NQe(a)||kQe(a)||RQe()}function LQe(a,e){if(typeof a!="object"||!a)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var i=n.call(a,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function DQe(a){var e=LQe(a,"string");return typeof e=="symbol"?e:e+""}function kQe(a,e){if(a){if(typeof a=="string")return o8(a,e);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o8(a,e):void 0}}function vle(a,e){var n=new e;return n._destructor&&n._destructor(),{linkProp:function(s){return{default:n[s](),onChange:function(o,l){l[a][s](o)},triggerUpdate:!1}},linkMethod:function(s){return function(r){for(var o=r[a],l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];var h=o[s].apply(o,c);return h===o?this:h}}}}var OQe=["rendererConfig","waitForGlobeReady"],E2=FA(FA({},window.THREE?window.THREE:{AmbientLight:y4,DirectionalLight:A4,Vector2:Nt,REVISION:w0}),{},{CSS2DRenderer:J4e}),_le=vle("globe",Uoe),FQe=Object.assign.apply(Object,mI(["globeImageUrl","bumpImageUrl","globeTileEngineUrl","globeTileEngineMaxLevel","globeCurvatureResolution","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude","onGlobeReady","pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration","arcsData","arcStartLat","arcStartLng","arcStartAltitude","arcEndLat","arcEndLng","arcEndAltitude","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration","polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration","pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration","heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration","hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration","hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration","tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration","particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture","ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod","labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration","htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration","objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject","customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(a){return bw({},a,_le.linkProp(a))}))),jQe=Object.assign.apply(Object,mI(["globeMaterial","globeTileEngineClearCache","getGlobeRadius","getCoords","toGeoCoords"].map(function(a){return bw({},a,_le.linkMethod(a))}))),xle=vle("renderObjs",yle),BQe=Object.assign.apply(Object,mI(["width","height","backgroundColor","backgroundImageUrl","enablePointerInteraction"].map(function(a){return bw({},a,xle.linkProp(a))}))),UQe=Object.assign.apply(Object,mI(["lights","postProcessingComposer"].map(function(a){return bw({},a,xle.linkMethod(a))}))),VQe=Wr({props:FA(FA({onZoom:{triggerUpdate:!1},onGlobeClick:{triggerUpdate:!1},onGlobeRightClick:{triggerUpdate:!1},pointLabel:{default:"name",triggerUpdate:!1},onPointClick:{triggerUpdate:!1},onPointRightClick:{triggerUpdate:!1},onPointHover:{triggerUpdate:!1},arcLabel:{default:"name",triggerUpdate:!1},onArcClick:{triggerUpdate:!1},onArcRightClick:{triggerUpdate:!1},onArcHover:{triggerUpdate:!1},polygonLabel:{default:"name",triggerUpdate:!1},onPolygonClick:{triggerUpdate:!1},onPolygonRightClick:{triggerUpdate:!1},onPolygonHover:{triggerUpdate:!1},pathLabel:{default:"name",triggerUpdate:!1},onPathClick:{triggerUpdate:!1},onPathRightClick:{triggerUpdate:!1},onPathHover:{triggerUpdate:!1},onHeatmapClick:{triggerUpdate:!1},onHeatmapRightClick:{triggerUpdate:!1},onHeatmapHover:{triggerUpdate:!1},hexLabel:{triggerUpdate:!1},onHexClick:{triggerUpdate:!1},onHexRightClick:{triggerUpdate:!1},onHexHover:{triggerUpdate:!1},hexPolygonLabel:{triggerUpdate:!1},onHexPolygonClick:{triggerUpdate:!1},onHexPolygonRightClick:{triggerUpdate:!1},onHexPolygonHover:{triggerUpdate:!1},tileLabel:{default:"name",triggerUpdate:!1},onTileClick:{triggerUpdate:!1},onTileRightClick:{triggerUpdate:!1},onTileHover:{triggerUpdate:!1},particleLabel:{default:"name",triggerUpdate:!1},onParticleClick:{triggerUpdate:!1},onParticleRightClick:{triggerUpdate:!1},onParticleHover:{triggerUpdate:!1},labelLabel:{triggerUpdate:!1},onLabelClick:{triggerUpdate:!1},onLabelRightClick:{triggerUpdate:!1},onLabelHover:{triggerUpdate:!1},objectLabel:{default:"name",triggerUpdate:!1},onObjectClick:{triggerUpdate:!1},onObjectRightClick:{triggerUpdate:!1},onObjectHover:{triggerUpdate:!1},customLayerLabel:{default:"name",triggerUpdate:!1},onCustomLayerClick:{triggerUpdate:!1},onCustomLayerRightClick:{triggerUpdate:!1},onCustomLayerHover:{triggerUpdate:!1},pointerEventsFilter:{default:function(){return!0},triggerUpdate:!1},lineHoverPrecision:{default:.2,triggerUpdate:!1,onChange:function(e,n){n.renderObjs.lineHoverPrecision(e),n.renderObjs.pointsHoverPrecision(e)}},showPointerCursor:{default:!0,triggerUpdate:!1},globeOffset:{default:[0,0],triggerUpdate:!1,onChange:function(e,n){return Array.isArray(e)&&e.length===2&&n.renderObjs.viewOffset(e.map(function(i){return-i}))}}},FQe),BQe),methods:FA(FA({pauseAnimation:function(e){var n;return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),(n=e.globe)===null||n===void 0||n.pauseAnimation(),this},resumeAnimation:function(e){var n;return e.animationFrameRequestId===null&&this._animationCycle(),(n=e.globe)===null||n===void 0||n.resumeAnimation(),this},_animationCycle:function(e){e.renderObjs.tick(),e.tweenGroup.update(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},pointOfView:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=o();if(n.lat===void 0&&n.lng===void 0&&n.altitude===void 0)return s;var r=Object.assign({},s,n);if(["lat","lng","altitude"].forEach(function(c){return r[c]=+r[c]}),!i)l(r);else{for(;s.lng-r.lng>180;)s.lng-=360;for(;s.lng-r.lng<-180;)s.lng+=360;e.tweenGroup.add(new gl(s).to(r,i).easing(Nr.Cubic.InOut).onUpdate(l).start())}return this;function o(){return e.globe.toGeoCoords(e.renderObjs.cameraPosition())}function l(c){var u=c.lat,h=c.lng,f=c.altitude;e.renderObjs.cameraPosition(e.globe.getCoords(u,h,f)),e.globe.setPointOfView(e.renderObjs.camera())}},getScreenCoords:function(e){for(var n,i=arguments.length,s=new Array(i>1?i-1:0),r=1;r<i;r++)s[r-1]=arguments[r];var o=(n=e.globe).getCoords.apply(n,s);return e.renderObjs.getScreenCoords(o.x,o.y,o.z)},toGlobeCoords:function(e,n,i){var s=e.renderObjs.intersectingObjects(n,i).find(function(c){return(c.object.__globeObjType||c.object.parent.__globeObjType)==="globe"});if(!s)return null;var r=e.globe.toGeoCoords(s.point),o=r.lat,l=r.lng;return{lat:o,lng:l}},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},_destructor:function(e){e.globe._destructor(),this.pauseAnimation(),this.pointsData([]),this.arcsData([]),this.polygonsData([]),this.pathsData([]),this.heatmapsData([]),this.hexBinPointsData([]),this.hexPolygonsData([]),this.tilesData([]),this.particlesData([]),this.labelsData([]),this.htmlElementsData([]),this.objectsData([]),this.customLayerData([])}},jQe),UQe),stateInit:function(e){var n=e.rendererConfig,i=e.waitForGlobeReady,s=i===void 0?!0:i,r=PQe(e,OQe),o=new Uoe(FA({waitForGlobeReady:s},r));return{globe:o,renderObjs:yle({controlType:"orbit",rendererConfig:n,waitForLoadComplete:s,extraRenderers:[new E2.CSS2DRenderer]}).skyRadius(o.getGlobeRadius()*500).showNavInfo(!1).objects([o]).lights([new E2.AmbientLight(13421772,Math.PI),new E2.DirectionalLight(16777215,.6*Math.PI)]),tweenGroup:new T4}},init:function(e,n){var i=this;e.innerHTML="",e.appendChild(n.container=document.createElement("div")),n.container.style.position="relative";var s=document.createElement("div");n.container.appendChild(s),n.renderObjs(s),n.globe.rendererSize(n.renderObjs.renderer().getSize(new E2.Vector2)),this.pointOfView({altitude:2.5});var r=n.globe.getGlobeRadius(),o=n.renderObjs.controls();n.renderObjs.camera().near=.05,o.minDistance=r+Math.max(.001,n.renderObjs.camera().near*1.1),o.maxDistance=r*100,o.enablePan=!1,o.enableDamping=!0,o.dampingFactor=.1,o.rotateSpeed=.3,o.zoomSpeed=.3,o.zoomToCursor=!0,o.addEventListener("change",function(){o.target.setScalar(0);var u=i.pointOfView();o.rotateSpeed=u.altitude*.3,o.zoomSpeed=Math.sqrt(u.altitude)*.5,n.globe.setPointOfView(n.renderObjs.camera()),n.onZoom&&n.onZoom(u)});var l=function(h){for(var f=h;f&&!f.hasOwnProperty("__globeObjType");)f=f.parent;return f},c={point:function(h){return h},arc:function(h){return h},polygon:function(h){return h.data},path:function(h){return h},heatmap:function(h){return h},hexbin:function(h){return h},hexPolygon:function(h){return h},tile:function(h){return h},particles:function(h,f){return!f||!f.hasOwnProperty("index")||h.length<=f.index?h:h[f.index]},label:function(h){return h},object:function(h){return h},custom:function(h){return h}};E2.REVISION<155&&(n.renderObjs.renderer().useLegacyLights=!1),n.renderObjs.hoverFilter(function(u){var h=l(u);if(!h)return!1;var f=h.__globeObjType;if(f!=="globe"&&!c.hasOwnProperty(f))return!1;var m=c.hasOwnProperty(f)&&h.__data?c[f](h.__data):null;return["points","hexBinPoints"].some(function(A){return A===f})&&Array.isArray(m)?!1:n.pointerEventsFilter(h,m)}).tooltipContent(function(u,h){var f={point:n.pointLabel,arc:n.arcLabel,polygon:n.polygonLabel,path:n.pathLabel,hexbin:n.hexLabel,hexPolygon:n.hexPolygonLabel,tile:n.tileLabel,particles:n.particleLabel,label:n.labelLabel,object:n.objectLabel,custom:n.customLayerLabel},m=l(u),A=m&&m.__globeObjType;return m&&A&&f.hasOwnProperty(A)&&c.hasOwnProperty(A)&&Yt(f[A])(c[A](m.__data,h))||""}).onHover(function(u,h,f){var m={point:n.onPointHover,arc:n.onArcHover,polygon:n.onPolygonHover,path:n.onPathHover,heatmap:n.onHeatmapHover,hexbin:n.onHexHover,hexPolygon:n.onHexPolygonHover,tile:n.onTileHover,particles:n.onParticleHover,label:n.onLabelHover,object:n.onObjectHover,custom:n.onCustomLayerHover},A={globe:n.onGlobeClick,point:n.onPointClick,arc:n.onArcClick,polygon:n.onPolygonClick,path:n.onPathClick,heatmap:n.onHeatmapClick,hexbin:n.onHexClick,hexPolygon:n.onHexPolygonClick,tile:n.onTileClick,particles:n.onParticleClick,label:n.onLabelClick,object:n.onObjectClick,custom:n.onCustomLayerClick},x=l(u);if(x&&!m.hasOwnProperty(x.__globeObjType)&&(x=null),x!==n.hoverObj){var T,E=n.hoverObj?n.hoverObj.__globeObjType:null,M=n.hoverData,N=x?x.__globeObjType:null,I=(T=x)!==null&&T!==void 0&&T.__data?c[N](x.__data,f):null;E&&E!==N&&m[E]&&m[E](null,M||null),N&&m[N]&&m[N](I,E===N?M:null),n.renderObjs.renderer().domElement.classList[N&&A[N]&&Yt(n.showPointerCursor)(N,I)?"add":"remove"]("clickable"),n.hoverObj=x,n.hoverData=I}}).onClick(function(u,h,f){if(u){var m={globe:n.onGlobeClick,point:n.onPointClick,arc:n.onArcClick,polygon:n.onPolygonClick,path:n.onPathClick,heatmap:n.onHeatmapClick,hexbin:n.onHexClick,hexPolygon:n.onHexPolygonClick,tile:n.onTileClick,particles:n.onParticleClick,label:n.onLabelClick,object:n.onObjectClick,custom:n.onCustomLayerClick},A=l(u),x=A.__globeObjType;if(A&&m.hasOwnProperty(x)&&m[x]){var T=[h],E=f!=null&&f.isVector3?f:f?.point;if(x==="globe"){var M=i.toGeoCoords(E),N=M.lat,I=M.lng;T.unshift({lat:N,lng:I})}else T.push(i.toGeoCoords(E));c.hasOwnProperty(x)&&T.unshift(c[x](A.__data,f)),m[x].apply(m,T)}}}).onRightClick(function(u,h,f){if(u){var m={globe:n.onGlobeRightClick,point:n.onPointRightClick,arc:n.onArcRightClick,polygon:n.onPolygonRightClick,path:n.onPathRightClick,heatmap:n.onHeatmapRightClick,hexbin:n.onHexRightClick,hexPolygon:n.onHexPolygonRightClick,tile:n.onTileRightClick,particles:n.onParticleRightClick,label:n.onLabelRightClick,object:n.onObjectRightClick,custom:n.onCustomLayerRightClick},A=l(u),x=A.__globeObjType;if(A&&m.hasOwnProperty(x)&&m[x]){var T=[h],E=f!=null&&f.isVector3?f:f?.point;if(x==="globe"){var M=i.toGeoCoords(E),N=M.lat,I=M.lng;T.unshift({lat:N,lng:I})}else T.push(i.toGeoCoords(E));c.hasOwnProperty(x)&&T.unshift(c[x](A.__data,f)),m[x].apply(m,T)}}}),this._animationCycle()}}),p6={exports:{}},m6,zY;function zQe(){if(zY)return m6;zY=1;var a="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return m6=a,m6}var g6,GY;function GQe(){if(GY)return g6;GY=1;var a=zQe();function e(){}function n(){}return n.resetWarningCache=e,g6=function(){function i(o,l,c,u,h,f){if(f!==a){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}i.isRequired=i;function s(){return i}var r={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:s,element:i,elementType:i,instanceOf:s,node:i,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:n,resetWarningCache:e};return r.PropTypes=r,r},g6}var qY;function qQe(){return qY||(qY=1,p6.exports=GQe()()),p6.exports}var HQe=qQe();const ie=f8(HQe);var WQe={width:ie.number,height:ie.number,globeOffset:ie.arrayOf(ie.number),backgroundColor:ie.string,backgroundImageUrl:ie.string,globeImageUrl:ie.string,bumpImageUrl:ie.string,globeTileEngineUrl:ie.func,showGlobe:ie.bool,showGraticules:ie.bool,showAtmosphere:ie.bool,atmosphereColor:ie.string,atmosphereAltitude:ie.number,globeMaterial:ie.object,onGlobeReady:ie.func,onGlobeClick:ie.func,onGlobeRightClick:ie.func,pointsData:ie.arrayOf(ie.object),pointLat:ie.oneOfType([ie.number,ie.string,ie.func]),pointLng:ie.oneOfType([ie.number,ie.string,ie.func]),pointColor:ie.oneOfType([ie.string,ie.func]),pointAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),pointRadius:ie.oneOfType([ie.number,ie.string,ie.func]),pointResolution:ie.number,pointsMerge:ie.bool,pointsTransitionDuration:ie.number,pointLabel:ie.oneOfType([ie.string,ie.func]),onPointClick:ie.func,onPointRightClick:ie.func,onPointHover:ie.func,arcsData:ie.arrayOf(ie.object),arcStartLat:ie.oneOfType([ie.number,ie.string,ie.func]),arcStartLng:ie.oneOfType([ie.number,ie.string,ie.func]),arcEndLat:ie.oneOfType([ie.number,ie.string,ie.func]),arcEndLng:ie.oneOfType([ie.number,ie.string,ie.func]),arcColor:ie.oneOfType([ie.string,ie.arrayOf(ie.string),ie.func]),arcAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),arcAltitudeAutoScale:ie.oneOfType([ie.number,ie.string,ie.func]),arcStroke:ie.oneOfType([ie.number,ie.string,ie.func]),arcCurveResolution:ie.number,arcCircularResolution:ie.number,arcDashLength:ie.oneOfType([ie.number,ie.string,ie.func]),arcDashGap:ie.oneOfType([ie.number,ie.string,ie.func]),arcDashInitialGap:ie.oneOfType([ie.number,ie.string,ie.func]),arcDashAnimateTime:ie.oneOfType([ie.number,ie.string,ie.func]),arcsTransitionDuration:ie.number,arcLabel:ie.oneOfType([ie.string,ie.func]),onArcClick:ie.func,onArcRightClick:ie.func,onArcHover:ie.func,polygonsData:ie.arrayOf(ie.object),polygonGeoJsonGeometry:ie.oneOfType([ie.string,ie.func]),polygonCapColor:ie.oneOfType([ie.string,ie.func]),polygonCapMaterial:ie.oneOfType([ie.object,ie.string,ie.func]),polygonSideColor:ie.oneOfType([ie.string,ie.func]),polygonSideMaterial:ie.oneOfType([ie.object,ie.string,ie.func]),polygonStrokeColor:ie.oneOfType([ie.string,ie.func]),polygonAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),polygonCapCurvatureResolution:ie.oneOfType([ie.number,ie.string,ie.func]),polygonsTransitionDuration:ie.number,polygonLabel:ie.oneOfType([ie.string,ie.func]),onPolygonClick:ie.func,onPolygonRightClick:ie.func,onPolygonHover:ie.func,pathsData:ie.array,pathPoints:ie.oneOfType([ie.array,ie.string,ie.func]),pathPointLat:ie.oneOfType([ie.number,ie.string,ie.func]),pathPointLng:ie.oneOfType([ie.number,ie.string,ie.func]),pathPointAlt:ie.oneOfType([ie.number,ie.string,ie.func]),pathResolution:ie.number,pathColor:ie.oneOfType([ie.string,ie.arrayOf(ie.string),ie.func]),pathStroke:ie.oneOfType([ie.number,ie.string,ie.func]),pathDashLength:ie.oneOfType([ie.number,ie.string,ie.func]),pathDashGap:ie.oneOfType([ie.number,ie.string,ie.func]),pathDashInitialGap:ie.oneOfType([ie.number,ie.string,ie.func]),pathDashAnimateTime:ie.oneOfType([ie.number,ie.string,ie.func]),pathTransitionDuration:ie.number,pathLabel:ie.oneOfType([ie.string,ie.func]),onPathClick:ie.func,onPathRightClick:ie.func,onPathHover:ie.func,heatmapsData:ie.array,heatmapPoints:ie.oneOfType([ie.array,ie.string,ie.func]),heatmapPointLat:ie.oneOfType([ie.number,ie.string,ie.func]),heatmapPointLng:ie.oneOfType([ie.number,ie.string,ie.func]),heatmapPointWeight:ie.oneOfType([ie.number,ie.string,ie.func]),heatmapBandwidth:ie.oneOfType([ie.number,ie.string,ie.func]),heatmapColorFn:ie.oneOfType([ie.string,ie.func]),heatmapColorSaturation:ie.oneOfType([ie.number,ie.string,ie.func]),heatmapBaseAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),heatmapTopAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),heatmapsTransitionDuration:ie.number,onHeatmapClick:ie.func,onHeatmapRightClick:ie.func,onHeatmapHover:ie.func,hexBinPointsData:ie.arrayOf(ie.object),hexBinPointLat:ie.oneOfType([ie.number,ie.string,ie.func]),hexBinPointLng:ie.oneOfType([ie.number,ie.string,ie.func]),hexBinPointWeight:ie.oneOfType([ie.number,ie.string,ie.func]),hexBinResolution:ie.number,hexMargin:ie.oneOfType([ie.number,ie.func]),hexTopColor:ie.func,hexSideColor:ie.func,hexAltitude:ie.oneOfType([ie.number,ie.func]),hexTopCurvatureResolution:ie.number,hexBinMerge:ie.bool,hexTransitionDuration:ie.number,hexLabel:ie.oneOfType([ie.string,ie.func]),onHexClick:ie.func,onHexRightClick:ie.func,onHexHover:ie.func,hexPolygonsData:ie.arrayOf(ie.object),hexPolygonGeoJsonGeometry:ie.oneOfType([ie.string,ie.func]),hexPolygonColor:ie.oneOfType([ie.string,ie.func]),hexPolygonAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),hexPolygonResolution:ie.oneOfType([ie.number,ie.string,ie.func]),hexPolygonMargin:ie.oneOfType([ie.number,ie.string,ie.func]),hexPolygonUseDots:ie.oneOfType([ie.bool,ie.string,ie.func]),hexPolygonCurvatureResolution:ie.oneOfType([ie.number,ie.string,ie.func]),hexPolygonDotResolution:ie.oneOfType([ie.number,ie.string,ie.func]),hexPolygonsTransitionDuration:ie.number,hexPolygonLabel:ie.oneOfType([ie.string,ie.func]),onHexPolygonClick:ie.func,onHexPolygonRightClick:ie.func,onHexPolygonHover:ie.func,tilesData:ie.arrayOf(ie.object),tileLat:ie.oneOfType([ie.number,ie.string,ie.func]),tileLng:ie.oneOfType([ie.number,ie.string,ie.func]),tileAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),tileWidth:ie.oneOfType([ie.number,ie.string,ie.func]),tileHeight:ie.oneOfType([ie.number,ie.string,ie.func]),tileUseGlobeProjection:ie.oneOfType([ie.bool,ie.string,ie.func]),tileMaterial:ie.oneOfType([ie.object,ie.string,ie.func]),tileCurvatureResolution:ie.oneOfType([ie.number,ie.string,ie.func]),tilesTransitionDuration:ie.number,tileLabel:ie.oneOfType([ie.string,ie.func]),onTileClick:ie.func,onTileRightClick:ie.func,onTileHover:ie.func,particlesData:ie.arrayOf(ie.object),particlesList:ie.oneOfType([ie.string,ie.func]),particleLat:ie.oneOfType([ie.number,ie.string,ie.func]),particleLng:ie.oneOfType([ie.number,ie.string,ie.func]),particleAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),particlesSize:ie.oneOfType([ie.number,ie.string,ie.func]),particlesSizeAttenuation:ie.oneOfType([ie.bool,ie.string,ie.func]),particlesColor:ie.oneOfType([ie.string,ie.func]),particlesTexture:ie.oneOfType([ie.string,ie.func]),particleLabel:ie.oneOfType([ie.string,ie.func]),onParticleClick:ie.func,onParticleRightClick:ie.func,onParticleHover:ie.func,ringsData:ie.arrayOf(ie.object),ringLat:ie.oneOfType([ie.number,ie.string,ie.func]),ringLng:ie.oneOfType([ie.number,ie.string,ie.func]),ringAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),ringColor:ie.oneOfType([ie.string,ie.arrayOf(ie.string),ie.func]),ringResolution:ie.number,ringMaxRadius:ie.oneOfType([ie.number,ie.string,ie.func]),ringPropagationSpeed:ie.oneOfType([ie.number,ie.string,ie.func]),ringRepeatPeriod:ie.oneOfType([ie.number,ie.string,ie.func]),labelsData:ie.arrayOf(ie.object),labelLat:ie.oneOfType([ie.number,ie.string,ie.func]),labelLng:ie.oneOfType([ie.number,ie.string,ie.func]),labelAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),labelRotation:ie.oneOfType([ie.number,ie.string,ie.func]),labelText:ie.oneOfType([ie.string,ie.func]),labelSize:ie.oneOfType([ie.number,ie.string,ie.func]),labelTypeFace:ie.object,labelColor:ie.oneOfType([ie.string,ie.func]),labelResolution:ie.number,labelIncludeDot:ie.oneOfType([ie.bool,ie.string,ie.func]),labelDotRadius:ie.oneOfType([ie.number,ie.string,ie.func]),labelDotOrientation:ie.oneOfType([ie.string,ie.func]),labelsTransitionDuration:ie.number,labelLabel:ie.oneOfType([ie.string,ie.func]),onLabelClick:ie.func,onLabelRightClick:ie.func,onLabelHover:ie.func,htmlElementsData:ie.arrayOf(ie.object),htmlLat:ie.oneOfType([ie.number,ie.string,ie.func]),htmlLng:ie.oneOfType([ie.number,ie.string,ie.func]),htmlAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),htmlElement:ie.oneOfType([ie.string,ie.func]),htmlElementVisibilityModifier:ie.func,htmlTransitionDuration:ie.number,objectsData:ie.arrayOf(ie.object),objectLat:ie.oneOfType([ie.number,ie.string,ie.func]),objectLng:ie.oneOfType([ie.number,ie.string,ie.func]),objectAltitude:ie.oneOfType([ie.number,ie.string,ie.func]),objectRotation:ie.oneOfType([ie.shape({x:ie.number,y:ie.number,z:ie.number}),ie.string,ie.func]),objectFacesSurface:ie.oneOfType([ie.bool,ie.string,ie.func]),objectThreeObject:ie.oneOfType([ie.object,ie.string,ie.func]),objectLabel:ie.oneOfType([ie.string,ie.func]),onObjectClick:ie.func,onObjectRightClick:ie.func,onObjectHover:ie.func,customLayerData:ie.arrayOf(ie.object),customThreeObject:ie.oneOfType([ie.object,ie.string,ie.func]),customThreeObjectUpdate:ie.oneOfType([ie.string,ie.func]),customLayerLabel:ie.oneOfType([ie.string,ie.func]),onCustomLayerClick:ie.func,onCustomLayerRightClick:ie.func,onCustomLayerHover:ie.func,enablePointerInteraction:ie.bool,pointerEventsFilter:ie.func,lineHoverPrecision:ie.number,showPointerCursor:ie.oneOfType([ie.bool,ie.func]),onZoom:ie.func},Q7=Hwe(VQe,{methodNames:["pauseAnimation","resumeAnimation","pointOfView","lights","scene","camera","renderer","postProcessingComposer","controls","getGlobeRadius","getCoords","getScreenCoords","toGeoCoords","toGlobeCoords","globeTileEngineClearCache"],initPropNames:["animateIn","waitForGlobeReady","rendererConfig"]});Q7.displayName="Globe";Q7.propTypes=WQe;const Wv={spain:{lat:40,lng:-4,name:"Espaa",code:"ES",color:"#FF4444",continent:"europe"},england:{lat:53,lng:-1.5,name:"Reino Unido",code:"UK",color:"#4466FF",continent:"europe"},germany:{lat:51,lng:10,name:"Alemania",code:"DE",color:"#FFCC00",continent:"europe"},italy:{lat:42.5,lng:12.5,name:"Italia",code:"IT",color:"#33CC33",continent:"europe"},france:{lat:46.5,lng:2.5,name:"Francia",code:"FR",color:"#5555FF",continent:"europe"},portugal:{lat:39.5,lng:-8,name:"Portugal",code:"PT",color:"#22AA44",continent:"europe"},netherlands:{lat:52.3,lng:5.3,name:"Pases Bajos",code:"NL",color:"#FF7700",continent:"europe"},belgium:{lat:50.8,lng:4.4,name:"Blgica",code:"BE",color:"#FFDD00",continent:"europe"},turkey:{lat:39,lng:35,name:"Turqua",code:"TR",color:"#E30A17",continent:"europe"},scotland:{lat:56.5,lng:-4,name:"Escocia",code:"SCO",color:"#003399",continent:"europe"},switzerland:{lat:46.8,lng:8.2,name:"Suiza",code:"CH",color:"#FF0000",continent:"europe"},austria:{lat:47.5,lng:14.5,name:"Austria",code:"AT",color:"#ED2939",continent:"europe"},greece:{lat:38.5,lng:23.7,name:"Grecia",code:"GR",color:"#0D5EAF",continent:"europe"},denmark:{lat:56,lng:10,name:"Dinamarca",code:"DK",color:"#C60C30",continent:"europe"},croatia:{lat:45.1,lng:15.2,name:"Croacia",code:"HR",color:"#FF3333",continent:"europe"},czech:{lat:49.8,lng:15.5,name:"Chequia",code:"CZ",color:"#11457E",continent:"europe"},argentina:{lat:-34.6,lng:-58.4,name:"Argentina",code:"AR",color:"#75AADB",continent:"southamerica"},brazil:{lat:-14.2,lng:-51.9,name:"Brasil",code:"BR",color:"#009739",continent:"southamerica"},colombia:{lat:4.6,lng:-74.1,name:"Colombia",code:"CO",color:"#FCD116",continent:"southamerica"},chile:{lat:-33.4,lng:-70.6,name:"Chile",code:"CL",color:"#D52B1E",continent:"southamerica"},uruguay:{lat:-34.9,lng:-56.2,name:"Uruguay",code:"UY",color:"#001489",continent:"southamerica"},ecuador:{lat:-.2,lng:-78.5,name:"Ecuador",code:"EC",color:"#FFD100",continent:"southamerica"},paraguay:{lat:-25.3,lng:-57.6,name:"Paraguay",code:"PY",color:"#D52B1E",continent:"southamerica"},peru:{lat:-12,lng:-77,name:"Per",code:"PE",color:"#D91023",continent:"southamerica"},bolivia:{lat:-16.5,lng:-68.2,name:"Bolivia",code:"BO",color:"#007934",continent:"southamerica"},venezuela:{lat:10.5,lng:-66.9,name:"Venezuela",code:"VE",color:"#CF142B",continent:"southamerica"},usa:{lat:39.8,lng:-98.6,name:"USA",code:"US",color:"#3C3B6E",continent:"world"},saudiArabia:{lat:23.9,lng:45.1,name:"Arabia Saud",code:"SA",color:"#006C35",continent:"world"},mexico:{lat:23.6,lng:-102.6,name:"Mxico",code:"MX",color:"#006847",continent:"world"},japan:{lat:36.2,lng:138.3,name:"Japn",code:"JP",color:"#BC002D",continent:"world"}},$Qe=768;function KQe({countries:a,selectedCountry:e,onCountryClick:n}){const i=ge.useRef(),[s,r]=ge.useState(400),[o,l]=ge.useState(!1);ge.useEffect(()=>{const h=()=>{const f=window.innerWidth,m=window.innerHeight;if(l(f<$Qe),f<500)r(Math.min(280,f*.7));else if(f<768)r(Math.min(340,f*.55));else if(f<1200){const A=f*.55,x=m-160;r(Math.min(520,A*.85,x*.8))}else{const A=f*.55,x=m-160;r(Math.min(620,A*.85,x*.8))}};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]),ge.useEffect(()=>{i.current&&i.current.pointOfView({lat:48,lng:5,altitude:2},0)},[]),ge.useEffect(()=>{if(i.current&&e&&Wv[e]){const{lat:h,lng:f}=Wv[e];i.current.pointOfView({lat:h,lng:f,altitude:1.6},600)}},[e]);const c=ge.useMemo(()=>a.map(h=>{const f=Wv[h.id];return f?{id:h.id,lat:f.lat,lng:f.lng,name:h.name,flag:h.flag,code:f.code,color:f.color,continent:f.continent,leagues:h.leagues.length,isSelected:e===h.id}:null}).filter(Boolean),[a,e]),u=ge.useCallback(h=>{const f=document.createElement("div");return f.className=`globe-marker ${h.isSelected?"globe-marker--selected":""}`,f.style.setProperty("--marker-color",h.isSelected?"#00FF88":h.color),f.innerHTML=`<span class="globe-marker__code">${h.code}</span>`,f.addEventListener("click",m=>{m.stopPropagation(),h?.id&&n(h.id)}),f.title=`${h.name}  ${h.leagues} liga${h.leagues!==1?"s":""}`,f},[n]);if(o){if(e)return null;const h=a.filter(A=>Wv[A.id]?.continent==="europe"),f=a.filter(A=>Wv[A.id]?.continent==="southamerica"),m=a.filter(A=>Wv[A.id]?.continent==="world");return d.jsxs("div",{className:"countries-mobile",children:[d.jsxs("h3",{className:"countries-mobile__title",children:[d.jsx(dc,{size:16})," Selecciona un pas"]}),d.jsxs("div",{className:"countries-mobile__list",children:[h.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"countries-mobile__header",children:" Europa"}),h.map(A=>d.jsxs("button",{className:`countries-mobile__item ${e===A.id?"selected":""}`,onClick:()=>n(A.id),children:[d.jsx("span",{className:"countries-mobile__flag",children:A.flag}),d.jsx("span",{className:"countries-mobile__name",children:A.name}),d.jsxs("span",{className:"countries-mobile__leagues",children:[A.leagues.length," liga",A.leagues.length>1?"s":""]})]},A.id))]}),f.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"countries-mobile__header",children:" Sudamrica"}),f.map(A=>d.jsxs("button",{className:`countries-mobile__item ${e===A.id?"selected":""}`,onClick:()=>n(A.id),children:[d.jsx("span",{className:"countries-mobile__flag",children:A.flag}),d.jsx("span",{className:"countries-mobile__name",children:A.name}),d.jsxs("span",{className:"countries-mobile__leagues",children:[A.leagues.length," liga",A.leagues.length>1?"s":""]})]},A.id))]}),m.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"countries-mobile__header",children:" Resto del Mundo"}),m.map(A=>d.jsxs("button",{className:`countries-mobile__item ${e===A.id?"selected":""}`,onClick:()=>n(A.id),children:[d.jsx("span",{className:"countries-mobile__flag",children:A.flag}),d.jsx("span",{className:"countries-mobile__name",children:A.name}),d.jsxs("span",{className:"countries-mobile__leagues",children:[A.leagues.length," liga",A.leagues.length>1?"s":""]})]},A.id))]})]})]})}return d.jsxs("div",{className:"globe-wrapper",children:[d.jsx(Q7,{ref:i,width:s,height:s,globeImageUrl:"//unpkg.com/three-globe/example/img/earth-night.jpg",backgroundColor:"rgba(0,0,0,0)",htmlElementsData:c,htmlLat:"lat",htmlLng:"lng",htmlAltitude:.03,htmlElement:u,htmlTransitionDuration:300,atmosphereColor:"lightskyblue",atmosphereAltitude:.15}),d.jsx("p",{className:"globe-hint",children:"Arrastra para girar  Clic en un pas"})]})}const YQe=[{id:"spain",name:"Espaa",flag:"",leagues:["laliga","segunda","primeraRFEF","segundaRFEF"]},{id:"england",name:"Inglaterra",flag:"",leagues:["premierLeague","championship"]},{id:"italy",name:"Italia",flag:"",leagues:["serieA","serieB"]},{id:"germany",name:"Alemania",flag:"",leagues:["bundesliga","bundesliga2"]},{id:"france",name:"Francia",flag:"",leagues:["ligue1","ligue2"]},{id:"netherlands",name:"Pases Bajos",flag:"",leagues:["eredivisie"]},{id:"portugal",name:"Portugal",flag:"",leagues:["primeiraLiga"]},{id:"belgium",name:"Blgica",flag:"",leagues:["belgianPro"]},{id:"turkey",name:"Turqua",flag:"",leagues:["superLig"]},{id:"scotland",name:"Escocia",flag:"",leagues:["scottishPrem"]},{id:"switzerland",name:"Suiza",flag:"",leagues:["swissSuperLeague"]},{id:"austria",name:"Austria",flag:"",leagues:["austrianBundesliga"]},{id:"greece",name:"Grecia",flag:"",leagues:["greekSuperLeague"]},{id:"denmark",name:"Dinamarca",flag:"",leagues:["danishSuperliga"]},{id:"croatia",name:"Croacia",flag:"",leagues:["croatianLeague"]},{id:"czech",name:"Chequia",flag:"",leagues:["czechLeague"]}],XQe=[{id:"argentina",name:"Argentina",flag:"",leagues:["argentinaPrimera"]},{id:"brazil",name:"Brasil",flag:"",leagues:["brasileiraoA"]},{id:"colombia",name:"Colombia",flag:"",leagues:["colombiaPrimera"]},{id:"chile",name:"Chile",flag:"",leagues:["chilePrimera"]},{id:"uruguay",name:"Uruguay",flag:"",leagues:["uruguayPrimera"]},{id:"ecuador",name:"Ecuador",flag:"",leagues:["ecuadorLigaPro"]},{id:"paraguay",name:"Paraguay",flag:"",leagues:["paraguayPrimera"]},{id:"peru",name:"Per",flag:"",leagues:["peruLiga1"]},{id:"bolivia",name:"Bolivia",flag:"",leagues:["boliviaPrimera"]},{id:"venezuela",name:"Venezuela",flag:"",leagues:["venezuelaPrimera"]}],QQe=[{id:"usa",name:"Estados Unidos",flag:"",leagues:["mls"]},{id:"saudiArabia",name:"Arabia Saud",flag:"",leagues:["saudiPro"]},{id:"mexico",name:"Mxico",flag:"",leagues:["ligaMX"]},{id:"japan",name:"Japn",flag:"",leagues:["jLeague"]}],HY=[...YQe,...XQe,...QQe];function EC(a){switch(a){case"laliga":return hu();case"segunda":return fu();case"primeraRFEF":return pu();case"segundaRFEF":return mu();case"premierLeague":return pf();case"serieA":return mf();case"bundesliga":return gf();case"ligue1":return Af();case"eredivisie":return yf();case"primeiraLiga":return vf();case"championship":return _f();case"belgianPro":return xf();case"superLig":return bf();case"scottishPrem":return Sf();case"serieB":return Tf();case"bundesliga2":return wf();case"ligue2":return Ef();case"swissSuperLeague":return Mf();case"austrianBundesliga":return Cf();case"greekSuperLeague":return Nf();case"danishSuperliga":return Rf();case"croatianLeague":return Pf();case"czechLeague":return If();case"argentinaPrimera":return Lf();case"brasileiraoA":return Df();case"colombiaPrimera":return kf();case"chilePrimera":return Of();case"uruguayPrimera":return Ff();case"ecuadorLigaPro":return jf();case"paraguayPrimera":return Bf();case"peruLiga1":return Uf();case"boliviaPrimera":return Vf();case"venezuelaPrimera":return zf();case"mls":return hy();case"saudiPro":return fy();case"ligaMX":return py();case"jLeague":return my();default:return[]}}function $v(a){switch(a){case"primeraRFEF":return wF();case"segundaRFEF":return EF();default:return null}}const MC=Object.fromEntries(Object.entries(Wa).map(([a,e])=>[a,e.name])),A6=["primeraRFEF","segundaRFEF"],JQe=Array.from({length:22},(a,e)=>{const n=2025-e;return{id:`${n}-${String(n+1).slice(2)}`,label:`${n}/${String(n+1).slice(2)}`,startYear:n}});function ZQe(){const{t:a}=Sa(),{state:e,dispatch:n}=Va(),{user:i,isAuthenticated:s}=Mc(),[r,o]=ge.useState(1),[l,c]=ge.useState(JQe[0]),[u,h]=ge.useState(null),[f,m]=ge.useState(null),[A,x]=ge.useState(null),[T,E]=ge.useState(null),[M,N]=ge.useState(""),[I,F]=ge.useState(!1),[G,O]=ge.useState(null),[D,j]=ge.useState([]),L=f&&A6.includes(f),U=2,q=ge.useMemo(()=>{let te=[];if(!f)return te;L&&A?te=$v(f)[A]?.teams||[]:L||(te=EC(f));const fe={1:{pct:.12,min:15e6,max:5e8},2:{pct:.1,min:5e6,max:12e7},3:{pct:.07,min:15e5,max:3e7},4:{pct:.05,min:3e5,max:5e6},5:{pct:.03,min:1e5,max:15e5}},Le=Pl(f),Fe=fe[Le]||fe[1];return te.forEach(Ie=>{if(!Ie.budget||!Ie.reputation){const at=(Ie.players||[]).reduce((Ve,Me)=>Ve+(Me.value||0),0),je=Ie.players?.length?Ie.players.reduce((Ve,Me)=>Ve+(Me.overall||0),0)/Ie.players.length:70;if(Ie.reputation||(je>=82?Ie.reputation=5:je>=78?Ie.reputation=4:je>=73?Ie.reputation=3:je>=68?Ie.reputation=2:Ie.reputation=1),!Ie.budget){const Ve=Math.max(at*Fe.pct,Fe.min),Me=[.5,.7,1,1.5,2.5][Ie.reputation-1]||1;Ie.budget=Math.round(Math.min(Ve*Me,Fe.max))}}}),te},[f,A,L]),K=ge.useMemo(()=>M?q.filter(te=>te.name?.toLowerCase().includes(M.toLowerCase())||te.city?.toLowerCase().includes(M.toLowerCase())):q,[q,M]),H=()=>{r===1?u?h(null):n({type:"SET_SCREEN",payload:"main_menu"}):r===2&&(L&&A?(x(null),E(null)):(o(1),m(null),x(null),E(null)))},X=te=>{m(te),x(null),o(2)},ne=te=>{x(te)},Q=te=>{if(!te.budget||!te.reputation){const fe=(te.players||[]).reduce((je,Ve)=>je+(Ve.value||0),0),Le=te.players?.length?te.players.reduce((je,Ve)=>je+(Ve.overall||0),0)/te.players.length:70,Fe={1:{pct:.12,min:15e6,max:5e8},2:{pct:.1,min:5e6,max:12e7},3:{pct:.07,min:15e5,max:3e7},4:{pct:.05,min:3e5,max:5e6},5:{pct:.03,min:1e5,max:15e5}},Ie=Pl(f),at=Fe[Ie]||Fe[1];if(te.reputation||(Le>=82?te.reputation=5:Le>=78?te.reputation=4:Le>=73?te.reputation=3:Le>=68?te.reputation=2:te.reputation=1),!te.budget){const je=Math.max(fe*at.pct,at.min),Ve=[.5,.7,1,1.5,2.5][te.reputation-1]||1;te.budget=Math.round(Math.min(je*Ve,at.max))}}E(te)},Y=()=>[...hu(),...fu(),...pu(),...mu(),...pf(),...mf(),...gf(),...Af(),...yf(),...vf(),..._f(),...xf(),...bf(),...Sf(),...Tf(),...wf(),...Ef(),...Mf(),...Cf(),...Nf(),...Rf(),...Pf(),...If(),...Lf(),...Df(),...kf(),...Of(),...Ff(),...jf(),...Bf(),...Uf(),...Vf(),...zf(),...hy(),...fy(),...py(),...my()],ue=()=>{if(!T||!f)return;const te=Y(),fe=SP(te,T);j(fe),F(!0)},pe=async()=>{if(!T||!f||!G)return;let te;L&&A?te=$v(f)?.[A]?.teams||[]:te=EC(f);const fe=zh(te,T.id),Le=DT(T.id,T.reputation),Fe=dP(Le.capacity);n({type:"NEW_GAME",payload:{teamId:T.id,team:{...T},leagueId:f,group:A,stadiumInfo:Le,stadiumLevel:Fe,preseasonMatches:G.matches,preseasonPhase:!0}}),n({type:"SET_LEAGUE_TABLE",payload:fe.table}),n({type:"SET_FIXTURES",payload:fe.fixtures}),n({type:"SET_PLAYER_LEAGUE",payload:f}),L&&A&&n({type:"SET_PLAYER_GROUP",payload:A});const Ie=[{id:"laliga",getter:hu},{id:"segunda",getter:fu},{id:"primeraRFEF",getter:pu},{id:"segundaRFEF",getter:mu},{id:"premierLeague",getter:pf},{id:"serieA",getter:mf},{id:"bundesliga",getter:gf},{id:"ligue1",getter:Af},{id:"eredivisie",getter:yf},{id:"primeiraLiga",getter:vf},{id:"championship",getter:_f},{id:"belgianPro",getter:xf},{id:"superLig",getter:bf},{id:"scottishPrem",getter:Sf},{id:"serieB",getter:Tf},{id:"bundesliga2",getter:wf},{id:"ligue2",getter:Ef},{id:"swissSuperLeague",getter:Mf},{id:"austrianBundesliga",getter:Cf},{id:"greekSuperLeague",getter:Nf},{id:"danishSuperliga",getter:Rf},{id:"croatianLeague",getter:Pf},{id:"czechLeague",getter:If},{id:"argentinaPrimera",getter:Lf},{id:"brasileiraoA",getter:Df},{id:"colombiaPrimera",getter:kf},{id:"chilePrimera",getter:Of},{id:"uruguayPrimera",getter:Ff},{id:"ecuadorLigaPro",getter:jf},{id:"paraguayPrimera",getter:Bf},{id:"peruLiga1",getter:Uf},{id:"boliviaPrimera",getter:Vf},{id:"venezuelaPrimera",getter:zf},{id:"mls",getter:hy},{id:"saudiPro",getter:fy},{id:"ligaMX",getter:py},{id:"jLeague",getter:my}],at=[];for(const Ue of Ie){const it=Ue.getter();for(const wt of it)at.push({...wt,id:wt.id,name:wt.name,players:wt.players||[],budget:wt.budget||(wt.reputation>4?1e8:wt.reputation>3?5e7:2e7),leagueId:Ue.id})}n({type:"UPDATE_LEAGUE_TEAMS",payload:at});const je=kx(f,L?A:null);if(n({type:"SET_OTHER_LEAGUES",payload:je}),fm(f))try{const Ue={},it={};for(const[tt,pt]of Object.entries(kT)){const Te=Wa[tt];if(!Te||!Te.getTeams)continue;const st=Te.getTeams();if(!st||st.length===0)continue;const mt=[...st].sort((ht,Qe)=>(Qe.reputation||70)-(ht.reputation||70));Ue[tt]=mt.map((ht,Qe)=>({teamId:ht.id||ht.teamId,teamName:ht.name||ht.teamName,shortName:ht.shortName||"",reputation:ht.reputation||70,overall:ht.overall||70,leaguePosition:Qe+1})),st.forEach(ht=>{it[ht.id||ht.teamId]=ht})}const wt=AP(Ue,it),Mt=new Set;Object.values(wt).forEach(tt=>tt.forEach(pt=>Mt.add(pt.teamId)));const _e=Object.values(it).filter(tt=>!Mt.has(tt.id||tt.teamId)).sort((tt,pt)=>(pt.reputation||0)-(tt.reputation||0));for(const tt of["copaLibertadores","copaSudamericana"]){const pt=32-wt[tt].length;if(pt>0){const Te=_e.splice(0,pt);wt[tt].push(...Te.map(st=>({teamId:st.id||st.teamId,teamName:st.name||st.teamName,shortName:st.shortName||"",league:st.league||"unknown",leaguePosition:0,reputation:st.reputation||60,overall:st.overall||65,players:st.players||[],...st}))),Te.forEach(st=>Mt.add(st.id||st.teamId))}}const le=yP(wt);n({type:"INIT_SA_COMPETITIONS",payload:le});const Ge=["copaLibertadores","copaSudamericana"].find(tt=>wt[tt].some(pt=>(pt.teamId||pt.id)===T.id));if(Ge){const tt={copaLibertadores:"South American Champions Cup",copaSudamericana:"Copa Sudamericana"};n({type:"ADD_MESSAGE",payload:{id:Date.now()+50,type:"southamerican",title:"Competicin Continental!",content:`Tu equipo jugar la ${tt[Ge]} esta temporada.`,date:"Semana 1"}})}}catch(Ue){console.error("Error bootstrapping SA competitions:",Ue)}else try{const Ue={},it={};for(const[tt,pt]of Object.entries(hP)){const Te=Wa[tt];if(!Te||!Te.getTeams)continue;const st=Te.getTeams();if(!st||st.length===0)continue;const mt=[...st].sort((ht,Qe)=>(Qe.reputation||70)-(ht.reputation||70));Ue[tt]=mt.map((ht,Qe)=>({teamId:ht.id||ht.teamId,teamName:ht.name||ht.teamName,shortName:ht.shortName||"",reputation:ht.reputation||70,overall:ht.overall||70,leaguePosition:Qe+1})),st.forEach(ht=>{it[ht.id||ht.teamId]=ht})}const wt=fP(Ue,it),Mt=new Set;Object.values(wt).forEach(tt=>tt.forEach(pt=>Mt.add(pt.teamId)));const _e=Object.values(it).filter(tt=>!Mt.has(tt.id||tt.teamId)).sort((tt,pt)=>(pt.reputation||0)-(tt.reputation||0));for(const tt of["championsLeague","europaLeague","conferenceleague"]){const pt=32-wt[tt].length;if(pt>0){const Te=_e.splice(0,pt);wt[tt].push(...Te.map(st=>({teamId:st.id||st.teamId,teamName:st.name||st.teamName,shortName:st.shortName||"",league:st.league||"unknown",leaguePosition:0,reputation:st.reputation||60,overall:st.overall||65,players:st.players||[],...st}))),Te.forEach(st=>Mt.add(st.id||st.teamId))}}const le=mP(wt);n({type:"INIT_EUROPEAN_COMPETITIONS",payload:le});const Ge=["championsLeague","europaLeague","conferenceleague"].find(tt=>wt[tt].some(pt=>(pt.teamId||pt.id)===T.id));if(Ge){const tt={championsLeague:"Continental Champions Cup",europaLeague:"Continental Shield",conferenceleague:"Continental Trophy"};n({type:"ADD_MESSAGE",payload:{id:Date.now()+50,type:"european",title:"Competicin Europea!",content:`Tu equipo jugar la ${tt[Ge]} esta temporada.`,date:"Semana 1"}})}}catch(Ue){console.error("Error bootstrapping European competitions:",Ue)}let Me=null,ze=0;try{const Ue=e.otherLeagues||{},it=OT(f,T,Ue,fe.table);it&&it.teams.length>=2&&(Me=FT(it.teams,T.id),Me&&(ze=Me.rounds.length))}catch(Ue){console.warn("Error initializing cup competition:",Ue)}Me&&n({type:"INIT_CUP_COMPETITION",payload:Me});try{const it=fe.fixtures.length>0?Math.max(...fe.fixtures.map(_e=>_e.week)):38,wt=RF(it,{hasEuropean:!0,cupRounds:ze}),Mt=IF(fe.fixtures,wt.leagueWeekMap);n({type:"SET_FIXTURES",payload:Mt}),n({type:"SET_EUROPEAN_CALENDAR",payload:wt})}catch(Ue){console.error("Error building season calendar:",Ue)}const Je=HF(T,f,fe.table);n({type:"SET_SEASON_OBJECTIVES",payload:Je}),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"welcome",title:"Bienvenido al club!",content:`Has sido nombrado nuevo entrenador del ${T.name}. La aficin espera grandes cosas de ti.`,date:"Semana 1"}});const rt=Je?.find(Ue=>Ue.priority==="critical");rt&&n({type:"ADD_MESSAGE",payload:{id:Date.now()+1,type:"objectives",title:a("objectives.seasonObjectives"),content:`${a("objectives.boardExpects")}: ${rt.nameKey?a(rt.nameKey):rt.name}. ${rt.descKey?a(rt.descKey):rt.description}.`,date:`${a("common.week")} 1`}}),Me&&n({type:"ADD_MESSAGE",payload:{id:Date.now()+2,type:"cup",title:`${Me.config?.icon||""} ${Me.config?.name||"Copa"}`,content:`Tu equipo participar en la ${Me.config?.name||"Copa Nacional"} esta temporada. ${Me.rounds.length} rondas hasta la final.`,date:"Semana 1"}});const ve=localStorage.getItem("pcfutbol_pending_slot");if(ve!==null&&s&&i){const Ue=parseInt(ve,10);localStorage.removeItem("pcfutbol_pending_slot");const it={gameStarted:!0,currentWeek:1,currentSeason:1,teamId:T.id,team:{...T},money:T.budget,leagueTable:fe.table,fixtures:fe.fixtures,seasonObjectives:Je};try{await GZ(i.uid,Ue,it),console.log(` Partida guardada automticamente en hueco ${Ue+1}`)}catch(wt){console.error("Error guardando partida inicial:",wt)}}},Ee=te=>te?te>=1e6?`${(te/1e6).toFixed(0)}M`:`${(te/1e3).toFixed(0)}K`:"0",oe=te=>te?.budget?te.budget>=15e7?{label:"Fcil",color:"#30d158",stars:1}:te.budget>=8e7?{label:"Normal",color:"#ffd60a",stars:2}:te.budget>=4e7?{label:"Medio",color:"#ff9f0a",stars:3}:te.budget>=15e6?{label:"Difcil",color:"#ff6b35",stars:4}:{label:"Muy difcil",color:"#ff453a",stars:5}:{label:"Normal",color:"#ffd60a",stars:3},Ae=te=>te?.players?.length?Math.round(te.players.reduce((fe,Le)=>fe+Le.overall,0)/te.players.length):0,Ce=r===1?"countries":r===2?L&&!A?"groups":"teams":"countries",ce=()=>r===1?1:2;return d.jsxs("div",{className:"pcf-team-select",children:[d.jsxs("div",{className:"pcf-ts-header",children:[d.jsx("div",{className:"header-left",children:d.jsxs("button",{className:"btn-back",onClick:H,children:[" ",r===1?u?"Pases":"Men":"Atrs"]})}),d.jsx("div",{className:"header-center",children:d.jsx("h1",{children:"SELECCIN DE EQUIPO"})}),d.jsx("div",{className:"header-right",children:d.jsxs("div",{className:"step-indicator",children:["Paso ",ce()," de ",U]})})]}),d.jsxs("div",{className:"pcf-ts-progress",children:[d.jsxs("div",{className:`progress-step ${r>=1?"active":""}`,children:[d.jsx("div",{className:"step-num",children:"1"}),d.jsx("div",{className:"step-label",children:"PAS / LIGA"})]}),d.jsx("div",{className:`progress-line ${r>=2?"active":""}`}),d.jsxs("div",{className:`progress-step ${r>=2?"active":""}`,children:[d.jsx("div",{className:"step-num",children:"2"}),d.jsx("div",{className:"step-label",children:"EQUIPO"})]})]}),d.jsxs("div",{className:"pcf-ts-content",children:[Ce==="countries"&&d.jsx("div",{className:"map-selection",children:d.jsxs("div",{className:"map-selection__row",children:[d.jsx("div",{className:"map-selection__map",children:d.jsx(KQe,{countries:HY,selectedCountry:u?.id,onCountryClick:te=>{const fe=HY.find(Le=>Le.id===te);fe&&h(fe)}})}),d.jsx("div",{className:"map-selection__panel",children:u?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"map-selection__title",children:[d.jsx("span",{className:"flag",children:u.flag}),u.name]}),d.jsx("div",{className:"map-selection__leagues",children:u.leagues.map(te=>{const fe=EC(te),Le=A6.includes(te),Fe=Le?$v(te):null,Ie=Fe?Object.keys(Fe).length:0;return d.jsxs("button",{className:`map-selection__league ${fe.length===0?"disabled":""}`,onClick:()=>fe.length>0&&X(te),disabled:fe.length===0,children:[d.jsxs("div",{children:[d.jsx("div",{className:"map-selection__league-name",children:MC[te]}),d.jsx("div",{className:"map-selection__league-info",children:fe.length>0?Le?a("teamSelection.groupsAndTeams",{groups:Ie,teams:fe.length}):a("teamSelection.teamsCount",{count:fe.length}):"Prximamente"})]}),d.jsx("span",{className:"map-selection__league-arrow",children:fe.length>0?d.jsx(_r,{size:14}):d.jsx(vy,{size:14})})]},te)})})]}):d.jsxs("div",{className:"map-selection__placeholder",children:[d.jsx("div",{className:"map-selection__placeholder-icon",children:d.jsx(sTe,{size:32})}),d.jsx("div",{className:"map-selection__placeholder-text",children:"Selecciona un pas en el mapa"})]})})]})}),Ce==="leagues"&&u&&d.jsxs("div",{className:"leagues-grid",children:[d.jsxs("h2",{children:[u.flag," Ligas de ",u.name]}),d.jsx("div",{className:"leagues-list",children:u.leagues.map(te=>{const fe=EC(te),Le=A6.includes(te),Fe=Le?$v(te):null,Ie=Fe?Object.keys(Fe).length:0;return d.jsxs("button",{className:`league-card ${fe.length===0?"disabled":""}`,onClick:()=>fe.length>0&&X(te),disabled:fe.length===0,children:[d.jsx("div",{className:"league-icon",children:d.jsx(Lo,{size:20})}),d.jsxs("div",{className:"info",children:[d.jsx("span",{className:"name",children:MC[te]}),d.jsx("span",{className:"meta",children:fe.length>0?Le?`${Ie} grupos  ${fe.length} equipos`:a("teamSelection.teamsAvailable",{count:fe.length}):a("teamSelection.comingSoon")})]}),d.jsx("span",{className:"arrow",children:fe.length>0?d.jsx(_r,{size:14}):d.jsx(vy,{size:14})})]},te)})})]}),Ce==="groups"&&f&&d.jsxs("div",{className:"groups-grid",children:[d.jsxs("h2",{children:[d.jsx(yy,{size:20})," ",MC[f]," - ",a("teamSelection.selectGroup")]}),d.jsx("div",{className:"groups-list",children:Object.entries($v(f)||{}).map(([te,fe])=>d.jsxs("button",{className:"group-card",onClick:()=>ne(te),children:[d.jsx("div",{className:"group-icon",children:d.jsx(Ai,{size:20})}),d.jsxs("div",{className:"info",children:[d.jsx("span",{className:"name",children:fe.name}),d.jsxs("span",{className:"meta",children:[fe.region?`${fe.region}  `:"",a("teamSelection.teamsCount",{count:fe.teams.length})]})]}),d.jsx("span",{className:"arrow",children:""})]},te))})]}),Ce==="teams"&&d.jsxs("div",{className:"teams-layout",children:[d.jsxs("div",{className:"teams-panel",children:[d.jsxs("div",{className:"panel-header",children:[d.jsxs("span",{className:"league-name",children:[u?.flag," ",MC[f],A&&` - ${$v(f)?.[A]?.name}`]}),d.jsx("span",{className:"team-count",children:a("teamSelection.teamsCount",{count:q.length})})]}),d.jsx("div",{className:"search-box",children:d.jsx("input",{type:"text",placeholder:a("teamSelection.searchTeam"),value:M,onChange:te=>N(te.target.value)})}),d.jsx("div",{className:"teams-list",children:K.map((te,fe)=>{const Le=oe(te),Fe=Ae(te),Ie=T?.id===te.id;return d.jsxs("button",{className:`team-row ${Ie?"selected":""}`,onClick:()=>Q(te),children:[d.jsx("span",{className:"team-num",children:fe+1}),d.jsx("div",{className:"team-badge",style:{background:te.colors?.primary||"#1a3a5a",color:te.colors?.secondary||"#fff"},children:te.shortName?.slice(0,3)||te.name?.slice(0,3)}),d.jsxs("div",{className:"team-info",children:[d.jsx("span",{className:"name",children:te.name}),d.jsx("span",{className:"city",children:te.city})]}),d.jsx("span",{className:"team-ovr",children:Fe||"??"}),d.jsx("span",{className:"team-diff",style:{color:Le.color},children:Array.from({length:Le.stars},(at,je)=>d.jsx(Br,{size:12,style:{fill:"currentColor"}},je))})]},te.id)})})]}),d.jsx("div",{className:"details-panel",children:T?d.jsxs("div",{className:"team-details",children:[d.jsxs("div",{className:"team-header",style:{"--primary":T.colors?.primary||"#1a3a5a","--secondary":T.colors?.secondary||"#fff"},children:[d.jsx("div",{className:"badge-large",children:T.shortName||T.name?.slice(0,3)}),d.jsxs("div",{className:"team-title",children:[d.jsx("h2",{children:T.name}),d.jsxs("p",{children:[T.city,", ",u?.name]})]})]}),d.jsxs("div",{className:"stats-grid",children:[d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"icon",children:d.jsx(Ol,{size:16})}),d.jsx("span",{className:"label",children:a("teamSelection.stadium")}),d.jsx("span",{className:"value",children:T.stadium||a("teamSelection.municipal")})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"icon",children:d.jsx(Hu,{size:16})}),d.jsx("span",{className:"label",children:a("teamSelection.capacity")}),d.jsx("span",{className:"value",children:(T.stadiumCapacity||15e3).toLocaleString()})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"icon",children:d.jsx(mm,{size:16})}),d.jsx("span",{className:"label",children:a("common.budget")}),d.jsx("span",{className:"value highlight",children:Ee(T.budget)})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"icon",children:d.jsx(Br,{size:16})}),d.jsx("span",{className:"label",children:a("teamSelection.reputation")}),d.jsxs("span",{className:"value",children:[T.reputation||70,"/100"]})]})]}),d.jsxs("div",{className:"difficulty-bar",children:[d.jsx("span",{className:"label",children:"Dificultad:"}),d.jsxs("span",{className:"difficulty-value",style:{color:oe(T).color},children:[oe(T).label," ",Array.from({length:oe(T).stars},(te,fe)=>d.jsx(Br,{size:12,style:{fill:"currentColor"}},fe))]})]}),T.players&&T.players.length>0&&d.jsxs("div",{className:"squad-preview",children:[d.jsxs("h3",{children:[d.jsx(Br,{size:16})," Jugadores destacados"]}),d.jsx("div",{className:"players-list",children:T.players.sort((te,fe)=>fe.overall-te.overall).slice(0,5).map((te,fe)=>d.jsxs("div",{className:"player-row",children:[d.jsx("span",{className:"pos",children:ds(te.position)}),d.jsx("span",{className:"name",children:te.name}),d.jsx("span",{className:"ovr",children:te.overall})]},fe))}),d.jsxs("div",{className:"squad-total",children:[d.jsx(yy,{size:14})," ",T.players.length," jugadores en plantilla"]})]}),d.jsxs("button",{className:"btn-start",onClick:ue,children:[d.jsx(Lo,{size:16})," COMENZAR CON ",T.name?.toUpperCase()]})]}):d.jsxs("div",{className:"no-selection",children:[d.jsx("span",{className:"icon",children:d.jsx(_r,{size:24,style:{transform:"rotate(180deg)"}})}),d.jsx("p",{children:"Selecciona un equipo de la lista"})]})})]})]}),I&&d.jsx("div",{className:"preseason-modal-overlay",children:d.jsxs("div",{className:"preseason-modal",children:[d.jsxs("div",{className:"preseason-header",children:[d.jsx(pm,{size:32,className:"header-icon"}),d.jsxs("div",{children:[d.jsxs("h1",{children:["Pretemporada ",T?.name]}),d.jsx("p",{children:"Elige tu paquete de amistosos"})]})]}),d.jsx("div",{className:"preseason-options",children:D.map(te=>{const fe=te.matches.length>0?Math.round(te.matches.reduce((Le,Fe)=>Le+(Fe.opponent?.reputation||0),0)/te.matches.length):0;return d.jsxs("div",{className:`preseason-card ${G?.id===te.id?"selected":""}`,onClick:()=>O(te),children:[d.jsxs("div",{className:"card-header",children:[d.jsx(Lo,{size:20}),d.jsx("h3",{children:te.name}),d.jsxs("span",{className:"avg-ovr",children:["Media: ",fe," OVR"]})]}),d.jsx("div",{className:"matches-preview",children:d.jsx("ul",{children:te.matches.map((Le,Fe)=>d.jsxs("li",{children:[d.jsx("span",{className:"match-location",children:Le.isHome?d.jsx(qh,{size:14}):d.jsx(k2,{size:14})}),d.jsx("span",{className:"opponent-name",children:Le.opponent?.name||"TBD"}),d.jsxs("span",{className:"opponent-ovr",children:[Le.opponent?.reputation||"??"," OVR"]}),Le.isPresentationMatch&&d.jsxs("span",{className:"presentation-badge",children:[d.jsx(jg,{size:12})," ",a("teamSelection.presentation")]})]},Fe))})})]},te.id)})}),d.jsxs("div",{className:"preseason-actions",children:[d.jsx("button",{className:"btn-back",onClick:()=>{F(!1),O(null)},children:a("common.back")}),d.jsxs("button",{className:"btn-confirm",onClick:pe,disabled:!G,children:[a("teamSelection.startSeason"),d.jsx(_r,{size:20})]})]})]})})]})}const OR={referencePrice:30,elasticity:.75,baseDemandRate:.65},eJe={laliga:["real-madrid","barcelona","atletico-madrid","sevilla","athletic-club"],segunda:["deportivo","racing-santander","zaragoza","malaga","levante","sporting-gijon"],primeraRFEF:["recreativo","deportivo-b","real-sociedad-b"],segundaRFEF:[],premierLeague:["manchester-city","liverpool","arsenal","manchester-united","chelsea","tottenham"],bundesliga:["bayern-munich","borussia-dortmund","rb-leipzig","bayer-leverkusen"],serieA:["juventus","inter","milan","napoli","roma"],ligue1:["psg","marseille","lyon","monaco"]};function tJe({capacity:a,seasonTicketPrice:e,teamOverall:n=70,leaguePosition:i=10,totalTeams:s=20,previousSeasonPosition:r=null,teamReputation:o=70}){const l=Math.floor(a*.8),c=.3+n/100*.52,h=Math.max(.6,Math.min(1.4,500/e)),m=.8+(s-i+1)/s*.3;let A=1;r!==null&&(A=.9+(s-r+1)/s*.2);const x=.85+o/100*.3,E=l*c*h*m*A*x;return Math.max(100,Math.min(l,Math.round(E)))}function nJe(a,e,n){let i=1;return(eJe[n]||[]).includes(a?.id)&&(i+=.5),e<=3?i+=.3:e<=6&&(i+=.15),a?.reputation>=80?i+=.2:a?.reputation>=70&&(i+=.1),Math.min(2,i)}function ble({teamOverall:a=70,teamReputation:e=70,leaguePosition:n=10,totalTeams:i=20,division:s=1}={}){const r=s===1?50:s===2?25:15,o=.4+a/100*1.1,l=.7+e/100*.6,u=.7+(i-n+1)/i*.6,h=r*o*l*u;return Math.round(Math.max(10,Math.min(150,h)))}function Sle(a,e=1,n=null){const{elasticity:i}=OR,s=n||OR.referencePrice,r=a/s;let o;if(a<=s?o=1+(1-r)*i*.5:o=Math.pow(s/a,1.4),e>1.3&&a>s){const l=(e-1.3)*.25;o=Math.min(o+l,.95)}return Math.max(.08,Math.min(1.3,o))}function aJe(a,e,n=0,i=70){let s=1;const r=a/e;return r<=.15?s+=.2:r<=.3?s+=.1:r>=.9?s-=.35:r>=.8?s-=.25:r>=.7&&(s-=.12),n>=5?s+=.2:n>=3?s+=.12:n<=-5?s-=.3:n<=-3?s-=.2:n<=-2&&(s-=.08),s*=.75+i/100*.35,r>=.85&&n<=-3&&(s*=.7),Math.max(.35,Math.min(1.35,s))}function iJe(a,e){return[["real-madrid","atletico-madrid"],["barcelona","espanyol"],["sevilla","betis"],["athletic-club","real-sociedad"],["valencia","villarreal"],["deportivo","celta"],["sporting-gijon","oviedo"],["manchester-city","manchester-united"],["liverpool","everton"],["arsenal","tottenham"],["inter","milan"],["roma","lazio"],["bayern-munich","borussia-dortmund"],["psg","marseille"]].some(([i,s])=>a===i&&e===s||a===s&&e===i)}function FR({stadiumCapacity:a,seasonTickets:e,ticketPrice:n,rivalTeam:i,rivalPosition:s,teamPosition:r,totalTeams:o,streak:l,morale:c,leagueId:u,homeTeamId:h,awayTeamId:f,teamOverall:m=70,teamReputation:A=70,division:x=1}){const T=a-e,E=T*OR.baseDemandRate,M=ble({teamOverall:m,teamReputation:A,leaguePosition:r,totalTeams:o,division:x}),N=nJe(i,s,u),I=Sle(n,N,M),F=aJe(r,o,l,c),G=iJe(h,f)?1.3:1,O=E*N*I*F*G,D=Math.min(Math.round(O),T),j=e+D,L=j/a;return{attendance:j,ticketSales:D,seasonTickets:e,fillRate:L,availableSeats:T,factors:{rival:N,price:I,performance:F,derby:G}}}function sJe({stadiumCapacity:a,seasonTickets:e,ticketPrice:n,rivalTeam:i,rivalPosition:s,teamPosition:r,totalTeams:o,streak:l,morale:c,leagueId:u,homeTeamId:h,awayTeamId:f,teamOverall:m=70,teamReputation:A=70,division:x=1}){const T=FR({stadiumCapacity:a,seasonTickets:e,ticketPrice:n,rivalTeam:i,rivalPosition:s,teamPosition:r,totalTeams:o,streak:l,morale:c,leagueId:u,homeTeamId:h,awayTeamId:f,teamOverall:m,teamReputation:A,division:x}),E=.1,M=Math.round(T.attendance*(1-E)),N=Math.min(a,Math.round(T.attendance*(1+E)));let I="Normal";const F=T.factors.rival*T.factors.derby;return F>=1.8?I=" Partidazo":F>=1.4?I=" Muy atractivo":F>=1.2?I=" Buen cartel":F<=.8&&(I=" Poco atractivo"),{...T,prediction:{low:M,expected:T.attendance,high:N,attractionLevel:I}}}function rJe({activeTab:a,onTabChange:e,isRanked:n}){const{t:i}=Sa(),{state:s,dispatch:r}=Va(),o=["objectives","calendar","stadium","finance","facilities","messages"],l=[{id:"overview",icon:qh,label:i("sidebar.office")},{id:"plantilla",icon:Hu,label:i("sidebar.squad")},{id:"formation",icon:yy,label:i("sidebar.formation")},{id:"objectives",icon:Fs,label:i("sidebar.objectives")},{id:"calendar",icon:pm,label:i("sidebar.calendar")},{id:"transfers",icon:gu,label:i("sidebar.transfers")},{id:"competitions",icon:Ay,label:i("sidebar.competitions")},{id:"stadium",icon:Ol,label:i("sidebar.stadium")},{id:"finance",icon:UF,label:i("sidebar.bank")},{id:"facilities",icon:zT,label:i("sidebar.facilities")},{id:"messages",icon:_y,label:i("sidebar.messages")}],c=n?l.filter(x=>!o.includes(x.id)):l,[u,h]=ge.useState(!1),f=ge.useRef(0);ge.useEffect(()=>{a==="messages"&&(f.current=(s.messages||[]).length)},[a,s.messages]);const m=Math.max(0,(s.messages||[]).length-f.current),A=()=>{r({type:"SET_SCREEN",payload:"main_menu"})};return d.jsxs(d.Fragment,{children:[d.jsxs("aside",{className:"sidebar",children:[d.jsxs("div",{className:"sidebar__logo",children:[d.jsx(jF,{className:"sidebar__logo-icon",size:28,strokeWidth:2.5}),d.jsx("span",{className:"sidebar__logo-text",children:"PC Gaffer"})]}),d.jsxs("div",{className:"sidebar__team",children:[d.jsx("div",{className:"sidebar__team-badge",children:s.team?.shortName||"???"}),d.jsx("span",{className:"sidebar__team-name",children:s.team?.name})]}),d.jsx("nav",{className:"sidebar__nav",children:c.map(x=>{const T=x.icon;return d.jsxs("button",{className:`sidebar__item ${a===x.id?"active":""}`,onClick:()=>e(x.id),children:[d.jsx(T,{className:"sidebar__item-icon",size:20,strokeWidth:2}),d.jsx("span",{className:"sidebar__item-label",children:x.label}),x.id==="messages"&&m>0&&d.jsx("span",{className:"sidebar__badge sidebar__badge--pulse",children:m>9?"9+":m})]},x.id)})}),d.jsxs("div",{className:"sidebar__footer",children:[d.jsxs("button",{className:"sidebar__settings-btn",onClick:()=>h(!0),children:[d.jsx(BT,{size:18,strokeWidth:2}),d.jsx("span",{children:i("sidebar.options")})]}),d.jsxs("button",{className:"sidebar__menu-btn",onClick:A,children:[d.jsx(OZ,{size:18,strokeWidth:2}),d.jsx("span",{children:i("sidebar.mainMenu")})]})]})]}),u&&d.jsx("div",{className:"sidebar__settings-overlay",children:d.jsx("div",{className:"sidebar__settings-panel",children:d.jsx(qF,{onClose:()=>h(!1)})})})]})}function WY({activeTab:a,onTabChange:e,onAdvanceWeek:n,onSimulate:i,simulating:s,isRanked:r}){const{t:o}=Sa(),{state:l,dispatch:c}=Va(),u=["objectives","calendar","stadium","finance","facilities","messages"],h=[{id:"overview",icon:d.jsx(qh,{size:20}),label:o("mobileNav.home")},{id:"plantilla",icon:d.jsx(Hu,{size:20}),label:o("sidebar.squad")},{id:"competitions",icon:d.jsx(Ay,{size:20}),label:o("mobileNav.competitions")},{id:"menu",icon:d.jsx(uTe,{size:20}),label:o("mobileNav.more")}],f=[{id:"formation",icon:d.jsx(Lo,{size:20}),label:o("sidebar.formation")},{id:"objectives",icon:d.jsx(Fs,{size:20}),label:o("sidebar.objectives")},{id:"calendar",icon:d.jsx(pm,{size:20}),label:o("sidebar.calendar")},{id:"transfers",icon:d.jsx(ju,{size:20}),label:o("sidebar.transfers")},{id:"stadium",icon:d.jsx(Ol,{size:20}),label:o("sidebar.stadium")},{id:"finance",icon:d.jsx(Q2e,{size:20}),label:o("sidebar.finance")},{id:"facilities",icon:d.jsx(zT,{size:20}),label:o("sidebar.facilities")},{id:"messages",icon:d.jsx(_y,{size:20}),label:o("sidebar.messages")}],[m,A]=ge.useState(!1),[x,T]=ge.useState(!1),[E,M]=ge.useState(!1),N=s||l.preseasonPhase||!!l.pendingEuropeanMatch||!!l.pendingSAMatch||!!l.pendingCupMatch,I=r?f.filter(L=>!u.includes(L.id)):f,F=L=>{L==="menu"?A(!0):e(L)},G=L=>{e(L),A(!1)},O=()=>{c({type:"SET_SCREEN",payload:"main_menu"}),A(!1)},D=()=>{A(!1),T(!0)},j=I.some(L=>L.id===a);return d.jsxs(d.Fragment,{children:[d.jsxs("nav",{className:"mobile-nav",children:[!r&&d.jsxs("div",{className:"mobile-nav__actions",children:[d.jsxs("div",{className:"mobile-nav__sim-wrapper",children:[d.jsxs("button",{className:"mobile-nav__action-btn mobile-nav__action-btn--sim",onClick:()=>!N&&M(!E),disabled:N,children:[d.jsx(jZ,{size:14})," ",o(s?"office.simulating":"office.simulate")]}),E&&!N&&(()=>{const L=l.fixtures?.length>0?Math.max(...l.fixtures.map(H=>H.week)):38,U=Math.ceil(L/2),q=l.currentWeek>=U,K=[{weeks:3,label:o("office.threeMatches")},q?{weeks:L-l.currentWeek+1,label:o("office.endOfSeason")}:{weeks:U-l.currentWeek,label:o("office.halfSeason")}];return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mobile-nav__sim-backdrop",onClick:()=>M(!1)}),d.jsx("div",{className:"mobile-nav__sim-dropdown",children:K.map(H=>d.jsx("button",{onClick:()=>{i(H.weeks),M(!1)},children:H.label},H.label))})]})})()]}),d.jsxs("button",{className:"mobile-nav__action-btn mobile-nav__action-btn--advance",onClick:n,children:[d.jsx(zF,{size:14})," ",o("mobileNav.advance")]})]}),d.jsx("div",{className:"mobile-nav__tabs",children:h.map(L=>d.jsxs("button",{className:`mobile-nav__tab ${L.id==="menu"?j?"active":"":a===L.id?"active":""}`,onClick:()=>F(L.id),children:[d.jsx("span",{className:"icon",children:L.icon}),d.jsx("span",{className:"label",children:L.label})]},L.id))})]}),m&&d.jsx("div",{className:"mobile-menu",onClick:()=>A(!1),children:d.jsxs("div",{className:"mobile-menu__content",onClick:L=>L.stopPropagation(),children:[d.jsxs("div",{className:"mobile-menu__header",children:[d.jsx("h3",{children:o("mobileNav.menu")}),d.jsx("button",{className:"close-btn",onClick:()=>A(!1),children:d.jsx(zr,{size:16})})]}),d.jsx("div",{className:"mobile-menu__items",children:I.map(L=>d.jsxs("button",{className:`mobile-menu__item ${a===L.id?"active":""}`,onClick:()=>G(L.id),children:[d.jsx("span",{className:"icon",children:L.icon}),d.jsx("span",{className:"label",children:L.label})]},L.id))}),d.jsxs("div",{className:"mobile-menu__footer",children:[d.jsxs("button",{className:"mobile-menu__footer-btn",onClick:D,children:[d.jsx("span",{className:"icon",children:d.jsx(BT,{size:20})}),d.jsx("span",{className:"label",children:o("sidebar.options")})]}),d.jsxs("button",{className:"mobile-menu__footer-btn mobile-menu__footer-btn--exit",onClick:O,children:[d.jsx("span",{className:"icon",children:d.jsx(VF,{size:20})}),d.jsx("span",{className:"label",children:o("sidebar.mainMenu")})]})]})]})}),x&&d.jsx("div",{className:"mobile-settings-overlay",children:d.jsx(qF,{onClose:()=>T(!1)})})]})}const _g=52;function oJe(){const{t:a}=Sa(),{state:e,dispatch:n}=Va(),[i,s]=ge.useState("salary"),[r,o]=ge.useState(null),[l,c]=ge.useState(null),u=e.team?.players||[],h=e.money||0,f=ge.useMemo(()=>u.reduce((Y,ue)=>Y+(ue.salary||0),0),[u]),m=f*_g,A=h>0?Math.round(m/h*100):0,x=e.currentWeek||1,T=ge.useMemo(()=>u.filter(Y=>{const ue=Y.contractYears??Y.personality?.contractYears??2,pe=Y.personality?.happiness??70,Ee=Y.personality?.wantsToLeave??!1,oe=Y.personality?.lastRenewalWeek||0;return oe>0&&oe<=x&&x-oe<30?!1:ue<=1||pe<=40||Ee}),[u,x]),E=ge.useMemo(()=>[...u].sort((Y,ue)=>{switch(i){case"salary":return(ue.salary||0)-(Y.salary||0);case"contract":const pe=Y.contractYears??Y.personality?.contractYears??2,Ee=ue.contractYears??ue.personality?.contractYears??2;return pe-Ee;case"ovr":return(ue.overall||0)-(Y.overall||0);case"age":return(Y.age||99)-(ue.age||99);default:return 0}}),[u,i]),M=Y=>Math.abs(Y)>=1e6?`${(Y/1e6).toFixed(1)}M`:Math.abs(Y)>=1e3?`${Math.round(Y/1e3)}K`:`${Y}`,N=Y=>{const ue=DS(Y);return ue==="GK"?"#ffd700":["CB","RB","LB","RWB","LWB"].includes(ue)?"#00d4ff":["CDM","CM","CAM","RM","LM"].includes(ue)?"#30d158":"#ff453a"},I=Y=>{const ue=Y.contractYears??Y.personality?.contractYears??2;return ue<=0?{status:"expired",label:a("plantilla.expired"),color:"#ff453a"}:ue<=1?{status:"urgent",label:a("plantilla.oneYear",{years:ue}),color:"#ff9500"}:{status:"ok",label:a("plantilla.multipleYears",{years:ue}),color:"#30d158"}},F=Y=>co(Y,e.leagueId||e.playerLeagueId),G=Y=>{const ue=Y.salary||3e4,pe=Y.age||25,Ee=Y.overall||70,oe=Y.potential||Ee,Ae=Y.personality?.minutesPlayed??50;let be,Ce;pe<=21?(be=.85,Ce=4):pe<=23?(be=.95,Ce=4):pe<=27?(be=1.1,Ce=4):pe<=30?(be=1.15,Ce=3):pe<=33?(be=.95,Ce=2):(be=.75,Ce=2);const ce=.55+Ee/100*1;let te=1;if(pe<=25&&oe>Ee){const Ie=oe-Ee;te=1+Math.min(.3,Ie*.02)}let fe;Ae>=75?fe=1.1:Ae>=50?fe=1:Ae>=25?fe=.9:fe=.8;const Le=Math.round(ue*be*ce*te*fe),Fe=Math.round(Ee*Ee*3);return{salary:Math.max(Fe,Le),years:Ce}},O=Y=>{if(Y.retiring)return!1;const ue=Y.contractYears??Y.personality?.contractYears??2,pe=Y.personality?.lastRenewalWeek||0,Ee=e.currentWeek||1;return pe>0&&pe<=Ee&&Ee-pe<30?!1:ue<=2},D=Y=>{const ue=Y.contractYears??Y.personality?.contractYears??2,pe=Y.personality?.happiness??70,Ee=Y.personality?.wantsToLeave??!1,oe=Y.personality?.lastRenewalWeek||0;return oe>0&&oe<=x&&x-oe<30?!1:ue<=1||pe<=40||Ee},j=Y=>{const ue=G(Y);o(Y),c({type:"renew",demand:ue})},L=Y=>{const ue=F(Y);o(Y),c({type:"sell",value:ue})},U=Y=>{const ue=(Y.salary||0)*_g,pe=Y.contractYears??Y.contract??Y.personality?.contractYears??2,Ee=(Y.salary||0)*_g*pe;o(Y),c({type:"release",yearlySaved:ue,severanceCost:Ee,contractYears:pe})},q=()=>{if(!r||!l)return;const Y=l.demand.salary,ue=l.demand.years;n({type:"UPDATE_PLAYER",payload:{...r,salary:Y,contractYears:ue,contract:ue,personality:{...r.personality,contractYears:ue,happiness:Math.min(100,(r.personality?.happiness||70)+15),wantsToLeave:!1,lastRenewalWeek:e.currentWeek}}}),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"contract",title:`${r.name} ha renovado`,content:`Nuevo contrato: ${ue} aos, ${M(Y)}/sem`,date:`Semana ${e.currentWeek}`}}),Q()},K=()=>{!r||!l||(n({type:"UPDATE_PLAYER",payload:{...r,transferListed:!0,askingPrice:l.value}}),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"transfer",title:`${r.name} en venta`,content:`Precio: ${M(l.value)}`,date:`Semana ${e.currentWeek}`}}),Q())},H=Y=>{o(Y),c({type:"unlist"})},X=()=>{r&&(n({type:"UPDATE_PLAYER",payload:{...r,transferListed:!1,askingPrice:void 0}}),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"transfer",title:`${r.name} retirado del mercado`,content:"Ya no est disponible para la venta",date:`Semana ${e.currentWeek}`}}),Q())},ne=()=>{if(!r||!l)return;const Y=l.severanceCost||0;Y>0&&n({type:"UPDATE_MONEY",payload:-Y}),n({type:"REMOVE_PLAYER",payload:r.name}),r.overall>=75&&n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"morale",title:`El vestuario nota la marcha de ${r.name}`,content:"La moral del equipo se ha resentido",date:`Semana ${e.currentWeek}`}}),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"contract",title:`${r.name} ha sido liberado`,content:Y>0?`Indemnizacin pagada: ${M(Y)}`:"Jugador liberado sin coste",date:`Semana ${e.currentWeek}`}}),Q()},Q=()=>{o(null),c(null)};return d.jsxs("div",{className:"plantilla",children:[d.jsxs("div",{className:"plantilla__header",children:[d.jsxs("div",{className:"header-title",children:[d.jsxs("h2",{children:[d.jsx(yy,{size:16})," ",a("plantilla.title")]}),d.jsxs("span",{className:"player-count",children:[u.length," ",a("plantilla.players")]})]}),d.jsxs("div",{className:"header-finances",children:[d.jsxs("div",{className:"finance-box budget",children:[d.jsx("span",{className:"label",children:a("plantilla.budget")}),d.jsx("span",{className:"value",children:M(h)})]}),d.jsxs("div",{className:"finance-box salary",children:[d.jsx("span",{className:"label",children:a("plantilla.weeklySalary")}),d.jsxs("span",{className:"value",children:[M(m),a("plantilla.perYear")]}),d.jsxs("span",{className:"yearly",children:[M(f),a("plantilla.perWeek")," (",A,"% ",a("plantilla.ofBudget"),")"]})]})]})]}),T.length>0&&d.jsxs("div",{className:"plantilla__alerts",children:[d.jsxs("div",{className:"alert-header",children:[d.jsx("span",{className:"alert-icon",children:d.jsx(OF,{size:14})}),d.jsx("span",{className:"alert-title",children:a("plantilla.playersNeedAttention",{count:T.length})})]}),d.jsxs("div",{className:"alert-list",children:[T.slice(0,3).map(Y=>{const ue=I(Y),pe=Y.personality?.wantsToLeave,Ee=O(Y);return d.jsxs("div",{className:"alert-item",onClick:()=>{Ee?j(Y):(o(Y),c({type:"mobile-actions",player:Y}))},children:[d.jsx("span",{className:"pos",style:{color:N(Y.position)},children:ds(Y.position)}),d.jsx("span",{className:"name",children:Y.name}),d.jsx("span",{className:"reason",children:Y.retiring?d.jsxs(d.Fragment,{children:[d.jsx(Mq,{size:12})," ",a("plantilla.retiring")]}):pe?d.jsxs(d.Fragment,{children:[d.jsx(Mq,{size:12})," ",a("plantilla.wantsToLeaveAlert")]}):d.jsxs(d.Fragment,{children:[d.jsx(or,{size:12})," ",ue.label]})})]},Y.name)}),T.length>3&&d.jsx("span",{className:"more",children:a("plantilla.more",{count:T.length-3})})]})]}),d.jsxs("div",{className:"plantilla__sort",children:[d.jsxs("span",{children:[a("plantilla.sortBy"),":"]}),d.jsxs("button",{className:i==="salary"?"active":"",onClick:()=>s("salary"),children:[d.jsx(ju,{size:12})," ",a("common.salary")]}),d.jsxs("button",{className:i==="contract"?"active":"",onClick:()=>s("contract"),children:[d.jsx(pm,{size:12})," ",a("common.contract")]}),d.jsx("button",{className:i==="ovr"?"active":"",onClick:()=>s("ovr"),children:" OVR"}),d.jsxs("button",{className:i==="age"?"active":"",onClick:()=>s("age"),children:[d.jsx(Z2e,{size:12})," ",a("common.age")]})]}),d.jsxs("div",{className:"plantilla__table-header",children:[d.jsx("span",{className:"col-pos",children:a("common.position")}),d.jsx("span",{className:"col-name",children:a("plantilla.player")}),d.jsx("span",{className:"col-ovr",children:"MED"}),d.jsx("span",{className:"col-salary",children:a("common.salary")}),d.jsx("span",{className:"col-contract",children:a("common.contract")})]}),d.jsx("div",{className:"plantilla__list",children:E.map(Y=>{const ue=I(Y),pe=Y.contractYears??Y.personality?.contractYears??2,Ee=(Y.salary||0)*_g,oe=Ee*pe,Ae=D(Y),be=Y.transferListed;return d.jsxs("div",{className:`player-row ${Ae?"attention":""} ${be?"listed":""}`,onClick:Ce=>{window.innerWidth<=768&&!Ce.target.closest(".player-actions")&&(o(Y),c({type:"mobile-actions",player:Y}))},children:[d.jsxs("div",{className:"player-main",children:[d.jsx("span",{className:"pos",style:{background:N(Y.position)},children:ds(Y.position)}),d.jsxs("div",{className:"info",children:[d.jsxs("div",{className:"name-row",children:[d.jsx("span",{className:"name",children:Y.name}),(Y.onLoan||be||Y.retiring)&&d.jsxs("div",{className:"player-tags",children:[Y.onLoan&&d.jsxs("span",{className:"tag-loan",children:[" ",a("plantilla.onLoanTag")]}),be&&!Y.onLoan&&d.jsxs("span",{className:"tag-listed tag-listed--clickable",onClick:Ce=>{Ce.stopPropagation(),H(Y)},title:a("plantilla.removeFromSale"),children:[" ",a("plantilla.forSaleTag")]}),Y.retiring&&d.jsxs("span",{className:"tag-retiring",children:[d.jsx(BZ,{size:12})," ",a("plantilla.retiring")]})]})]}),d.jsxs("span",{className:"meta",children:[Y.overall," OVR  ",Y.age," ",a("plantilla.years")]})]})]}),d.jsx("span",{className:"player-ovr-badge",children:Y.overall}),d.jsxs("div",{className:"player-contract",children:[d.jsxs("span",{className:"salary",children:[M(Ee),a("plantilla.perYear")]}),d.jsxs("span",{className:"yearly",children:[M(oe)," ",a("plantilla.total")," (",pe,a("plantilla.years").charAt(0),")"]})]}),d.jsxs("div",{className:"player-status",children:[d.jsxs("span",{className:"contract",style:{color:ue.color},children:[d.jsx(pm,{size:12})," ",ue.label]}),d.jsx("span",{className:`renew-icon ${O(Y)&&!Y.retiring?"":"hidden"}`,title:a("plantilla.canRenew"),children:d.jsx(yD,{size:12})})]}),d.jsx("div",{className:"player-actions",children:Y.onLoan?d.jsx(d.Fragment,{children:d.jsxs("span",{className:"loan-info-badge",title:`${a("plantilla.loanedBadge")} - ${Y.loanFromTeam}`,children:[" ",a("plantilla.loanedBadge")]})}):d.jsxs(d.Fragment,{children:[d.jsx("button",{className:"btn-renew",onClick:()=>j(Y),title:Y.retiring?a("plantilla.playerRetiring"):O(Y)?a("plantilla.renew"):a("plantilla.cannotRenew"),disabled:!O(Y),children:d.jsx(yD,{size:14})}),be?d.jsx("button",{className:"btn-sell btn-sell--listed",onClick:()=>H(Y),title:a("plantilla.removeFromSale"),children:""}):d.jsx("button",{className:"btn-sell",onClick:()=>L(Y),title:a("plantilla.putForSale"),children:d.jsx(O2,{size:14})}),d.jsx("button",{className:"btn-release",onClick:()=>U(Y),title:a("plantilla.release"),children:d.jsx(FE,{size:14})})]})})]},Y.name)})}),l&&r&&d.jsx("div",{className:"plantilla__modal-overlay",onClick:Q,children:d.jsxs("div",{className:"plantilla__modal",onClick:Y=>Y.stopPropagation(),children:[l.type==="mobile-actions"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"modal-header",children:d.jsx("h3",{children:r.name})}),d.jsxs("div",{className:"modal-content",children:[d.jsxs("div",{className:"player-summary",children:[d.jsx("span",{className:"pos",style:{background:N(r.position)},children:ds(r.position)}),d.jsx("span",{className:"ovr",children:r.overall}),d.jsxs("span",{className:"age",children:[r.age," ",a("plantilla.years")]})]}),d.jsx("div",{className:"mobile-action-list",children:r.onLoan?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"mobile-action-info",children:[" ",a("plantilla.loanedBy",{team:r.loanFromTeam})]}),d.jsxs("button",{className:"mobile-action-btn mobile-action-btn--cancel",onClick:Q,children:[d.jsx(zr,{size:14})," ",a("common.close")]})]}):d.jsxs(d.Fragment,{children:[d.jsxs("button",{className:"mobile-action-btn",onClick:()=>{Q(),j(r)},disabled:!O(r),children:[d.jsx(yD,{size:14})," ",a("plantilla.renewContract")]}),r.transferListed?d.jsxs("button",{className:"mobile-action-btn mobile-action-btn--unlist",onClick:()=>{Q(),H(r)},children:[" ",a("plantilla.removeFromSale")]}):d.jsxs("button",{className:"mobile-action-btn",onClick:()=>{Q(),L(r)},children:[d.jsx(O2,{size:14})," ",a("plantilla.putForSale")]}),d.jsxs("button",{className:"mobile-action-btn mobile-action-btn--danger",onClick:()=>{Q(),U(r)},children:[d.jsx(FE,{size:14})," ",a("plantilla.releasePlayerBtn")]}),d.jsxs("button",{className:"mobile-action-btn mobile-action-btn--cancel",onClick:Q,children:[d.jsx(zr,{size:14})," ",a("common.cancel")]})]})})]})]}),l.type==="renew"&&(()=>{const Y=r.personality?.contractYears||r.contractYears||1,ue=(r.salary||0)*_g,pe=l.demand.salary*_g,Ee=pe-ue;return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"modal-header renew",children:d.jsx("h3",{children:a("plantilla.renewPlayer",{name:r.name})})}),d.jsxs("div",{className:"modal-content",children:[d.jsxs("div",{className:"player-summary",children:[d.jsx("span",{className:"pos",style:{background:N(r.position)},children:ds(r.position)}),d.jsx("span",{className:"ovr",children:r.overall}),d.jsxs("span",{className:"age",children:[r.age," ",a("plantilla.years")]})]}),d.jsxs("div",{className:"comparison",children:[d.jsxs("div",{className:"current",children:[d.jsx("span",{className:"label",children:a("plantilla.currentContractLabel")}),d.jsxs("span",{className:"salary",children:[M(ue),a("plantilla.perYear")]}),d.jsxs("span",{className:"yearly",children:[a("plantilla.total"),": ",M(ue*Y)]}),d.jsxs("span",{className:"years",children:[Y," ",a("plantilla.years")]})]}),d.jsx("div",{className:"arrow",children:""}),d.jsxs("div",{className:"new",children:[d.jsx("span",{className:"label",children:a("plantilla.demands")}),d.jsxs("span",{className:"salary",children:[M(pe),a("plantilla.perYear")]}),d.jsxs("span",{className:"yearly",children:[a("plantilla.total"),": ",M(pe*l.demand.years)]}),d.jsxs("span",{className:"years",children:[l.demand.years," ",a("plantilla.years")]})]})]}),d.jsxs("div",{className:"impact",children:[d.jsx("span",{className:"impact-label",children:a("plantilla.budgetImpact")}),d.jsxs("span",{className:`impact-value ${Ee>0?"negative":"positive"}`,children:[Ee>0?"+":"",M(Ee),a("plantilla.perYear")]})]}),d.jsxs("div",{className:"modal-actions",children:[d.jsx("button",{className:"btn-confirm",onClick:q,children:a("plantilla.acceptAndRenew")}),d.jsx("button",{className:"btn-cancel",onClick:Q,children:a("common.cancel")})]})]})]})})(),l.type==="sell"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"modal-header sell",children:d.jsxs("h3",{children:[d.jsx(O2,{size:14})," ",a("plantilla.sellPlayer",{name:r.name})]})}),d.jsxs("div",{className:"modal-content",children:[d.jsxs("div",{className:"player-summary",children:[d.jsx("span",{className:"pos",style:{background:N(r.position)},children:ds(r.position)}),d.jsx("span",{className:"ovr",children:r.overall}),d.jsxs("span",{className:"age",children:[r.age," ",a("plantilla.years")]})]}),d.jsxs("div",{className:"sell-info",children:[d.jsxs("div",{className:"value-box",children:[d.jsx("span",{className:"label",children:a("plantilla.marketValue")}),d.jsx("span",{className:"value",children:M(l.value)})]}),d.jsxs("div",{className:"salary-box",children:[d.jsx("span",{className:"label",children:a("plantilla.currentSalary")}),d.jsxs("span",{className:"value",children:[M((r.salary||0)*_g),a("plantilla.perYear")]})]})]}),d.jsxs("div",{className:"impact",children:[d.jsxs("span",{className:"impact-label",children:[d.jsx(ju,{size:12})," ",a("plantilla.ifSold")]}),d.jsxs("span",{className:"impact-value positive",children:["+",M(l.value)," + ",M((r.salary||0)*_g),a("plantilla.perYear")," ",a("plantilla.savedSalary")]})]}),d.jsx("p",{className:"note",children:a("plantilla.sellNote")}),d.jsxs("div",{className:"modal-actions",children:[d.jsxs("button",{className:"btn-confirm",onClick:K,children:[d.jsx(O2,{size:14})," ",a("plantilla.putForSale")]}),d.jsx("button",{className:"btn-cancel",onClick:Q,children:a("common.cancel")})]})]})]}),l.type==="unlist"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"modal-header unlist",children:d.jsxs("h3",{children:[" ",a("plantilla.unlistPlayer",{name:r.name})]})}),d.jsxs("div",{className:"modal-content",children:[d.jsxs("div",{className:"player-summary",children:[d.jsx("span",{className:"pos",style:{background:N(r.position)},children:ds(r.position)}),d.jsx("span",{className:"ovr",children:r.overall}),d.jsxs("span",{className:"age",children:[r.age," ",a("plantilla.years")]})]}),d.jsxs("div",{className:"sell-info",children:[d.jsx("p",{children:a("plantilla.unlistQuestion")}),d.jsx("p",{className:"note",children:a("plantilla.unlistNote")})]}),d.jsxs("div",{className:"modal-actions",children:[d.jsxs("button",{className:"btn-confirm",onClick:X,children:[" ",a("plantilla.confirmUnlist")]}),d.jsx("button",{className:"btn-cancel",onClick:Q,children:a("common.cancel")})]})]})]}),l.type==="release"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"modal-header release",children:d.jsxs("h3",{children:[d.jsx(FE,{size:14})," ",a("plantilla.releasePlayer",{name:r.name})]})}),d.jsxs("div",{className:"modal-content",children:[d.jsxs("div",{className:"player-summary",children:[d.jsx("span",{className:"pos",style:{background:N(r.position)},children:ds(r.position)}),d.jsx("span",{className:"ovr",children:r.overall}),d.jsxs("span",{className:"age",children:[r.age," ",a("plantilla.years")]})]}),d.jsxs("div",{className:"warning-box danger",children:[d.jsx("span",{className:"warning-icon",children:d.jsx(Cq,{size:14})}),d.jsx("span",{className:"warning-text",children:a("plantilla.severanceWarning",{years:l.contractYears})})]}),d.jsxs("div",{className:"impact",children:[d.jsxs("span",{className:"impact-label",children:[d.jsx(Cq,{size:12})," ",a("plantilla.severanceCost")]}),d.jsxs("span",{className:"impact-value negative",children:["-",M(l.severanceCost)]})]}),d.jsxs("div",{className:"impact",children:[d.jsxs("span",{className:"impact-label",children:[d.jsx(ju,{size:12})," ",a("plantilla.salarySaved")]}),d.jsxs("span",{className:"impact-value positive",children:["+",M(l.yearlySaved),a("plantilla.perYear")]})]}),r.overall>=75&&d.jsx("div",{className:"morale-warning",children:d.jsx("span",{children:a("plantilla.moraleWarning")})}),h<l.severanceCost&&d.jsx("div",{className:"morale-warning",children:d.jsxs("span",{children:[d.jsx(kd,{size:12})," ",a("plantilla.insufficientFunds")]})}),d.jsxs("div",{className:"modal-actions",children:[d.jsxs("button",{className:"btn-confirm danger",onClick:ne,disabled:h<l.severanceCost,children:[d.jsx(FE,{size:14})," ",a("plantilla.payAndRelease")," (",M(l.severanceCost),")"]}),d.jsx("button",{className:"btn-cancel",onClick:Q,children:a("common.cancel")})]})]})]})]})})]})}const d_={"4-3-3":[{id:"GK",x:50,y:90},{id:"RB",x:85,y:70},{id:"CB1",x:65,y:78},{id:"CB2",x:35,y:78},{id:"LB",x:15,y:70},{id:"CM1",x:70,y:50},{id:"CDM",x:50,y:55},{id:"CM2",x:30,y:50},{id:"RW",x:80,y:25},{id:"ST",x:50,y:18},{id:"LW",x:20,y:25}],"4-4-2":[{id:"GK",x:50,y:90},{id:"RB",x:85,y:70},{id:"CB1",x:65,y:78},{id:"CB2",x:35,y:78},{id:"LB",x:15,y:70},{id:"RM",x:85,y:48},{id:"CM1",x:60,y:52},{id:"CM2",x:40,y:52},{id:"LM",x:15,y:48},{id:"ST1",x:60,y:20},{id:"ST2",x:40,y:20}],"4-2-3-1":[{id:"GK",x:50,y:90},{id:"RB",x:85,y:70},{id:"CB1",x:65,y:78},{id:"CB2",x:35,y:78},{id:"LB",x:15,y:70},{id:"CDM1",x:60,y:55},{id:"CDM2",x:40,y:55},{id:"RW",x:75,y:35},{id:"CAM",x:50,y:35},{id:"LW",x:25,y:35},{id:"ST",x:50,y:15}],"3-5-2":[{id:"GK",x:50,y:90},{id:"CB1",x:75,y:75},{id:"CB2",x:50,y:80},{id:"CB3",x:25,y:75},{id:"RM",x:90,y:48},{id:"CM1",x:65,y:50},{id:"CDM",x:50,y:55},{id:"CM2",x:35,y:50},{id:"LM",x:10,y:48},{id:"ST1",x:60,y:20},{id:"ST2",x:40,y:20}],"5-3-2":[{id:"GK",x:50,y:90},{id:"RB",x:90,y:65},{id:"CB1",x:70,y:75},{id:"CB2",x:50,y:80},{id:"CB3",x:30,y:75},{id:"LB",x:10,y:65},{id:"CM1",x:65,y:48},{id:"CDM",x:50,y:52},{id:"CM2",x:35,y:48},{id:"ST1",x:60,y:20},{id:"ST2",x:40,y:20}],"4-1-4-1":[{id:"GK",x:50,y:90},{id:"RB",x:85,y:70},{id:"CB1",x:65,y:78},{id:"CB2",x:35,y:78},{id:"LB",x:15,y:70},{id:"CDM",x:50,y:58},{id:"RM",x:85,y:40},{id:"CM1",x:60,y:45},{id:"CM2",x:40,y:45},{id:"LM",x:15,y:40},{id:"ST",x:50,y:18}],"3-4-3":[{id:"GK",x:50,y:90},{id:"CB1",x:70,y:75},{id:"CB2",x:50,y:80},{id:"CB3",x:30,y:75},{id:"RM",x:85,y:50},{id:"CM1",x:60,y:52},{id:"CM2",x:40,y:52},{id:"LM",x:15,y:50},{id:"RW",x:75,y:22},{id:"ST",x:50,y:18},{id:"LW",x:25,y:22}],"5-4-1":[{id:"GK",x:50,y:90},{id:"RB",x:90,y:68},{id:"CB1",x:70,y:75},{id:"CB2",x:50,y:78},{id:"CB3",x:30,y:75},{id:"LB",x:10,y:68},{id:"RM",x:85,y:45},{id:"CM1",x:60,y:50},{id:"CM2",x:40,y:50},{id:"LM",x:15,y:45},{id:"ST",x:50,y:18}],"4-5-1":[{id:"GK",x:50,y:90},{id:"RB",x:85,y:70},{id:"CB1",x:65,y:78},{id:"CB2",x:35,y:78},{id:"LB",x:15,y:70},{id:"RM",x:88,y:45},{id:"CM1",x:65,y:50},{id:"CDM",x:50,y:55},{id:"CM2",x:35,y:50},{id:"LM",x:12,y:45},{id:"ST",x:50,y:18}],"4-3-3 (MCO)":[{id:"GK",x:50,y:90},{id:"RB",x:85,y:70},{id:"CB1",x:65,y:78},{id:"CB2",x:35,y:78},{id:"LB",x:15,y:70},{id:"CM1",x:65,y:52},{id:"CM2",x:35,y:52},{id:"CAM",x:50,y:40},{id:"RW",x:80,y:25},{id:"ST",x:50,y:18},{id:"LW",x:20,y:25}],"4-4-2 (Diamante)":[{id:"GK",x:50,y:90},{id:"RB",x:85,y:70},{id:"CB1",x:65,y:78},{id:"CB2",x:35,y:78},{id:"LB",x:15,y:70},{id:"CDM",x:50,y:58},{id:"CM1",x:70,y:48},{id:"CM2",x:30,y:48},{id:"CAM",x:50,y:35},{id:"ST1",x:60,y:20},{id:"ST2",x:40,y:20}],"4-1-2-1-2":[{id:"GK",x:50,y:90},{id:"RB",x:85,y:70},{id:"CB1",x:65,y:78},{id:"CB2",x:35,y:78},{id:"LB",x:15,y:70},{id:"CDM",x:50,y:58},{id:"CM1",x:65,y:46},{id:"CM2",x:35,y:46},{id:"CAM",x:50,y:34},{id:"ST1",x:60,y:20},{id:"ST2",x:40,y:20}],"3-4-1-2":[{id:"GK",x:50,y:90},{id:"CB1",x:70,y:75},{id:"CB2",x:50,y:80},{id:"CB3",x:30,y:75},{id:"RM",x:85,y:50},{id:"CM1",x:60,y:52},{id:"CM2",x:40,y:52},{id:"LM",x:15,y:50},{id:"CAM",x:50,y:35},{id:"ST1",x:60,y:22},{id:"ST2",x:40,y:22}],"4-3-2-1":[{id:"GK",x:50,y:90},{id:"RB",x:85,y:70},{id:"CB1",x:65,y:78},{id:"CB2",x:35,y:78},{id:"LB",x:15,y:70},{id:"CDM",x:50,y:55},{id:"CM1",x:65,y:48},{id:"CM2",x:35,y:48},{id:"RW",x:70,y:32},{id:"LW",x:30,y:32},{id:"ST",x:50,y:18}],"5-2-3":[{id:"GK",x:50,y:90},{id:"RB",x:90,y:65},{id:"CB1",x:70,y:75},{id:"CB2",x:50,y:80},{id:"CB3",x:30,y:75},{id:"LB",x:10,y:65},{id:"CM1",x:60,y:48},{id:"CM2",x:40,y:48},{id:"RW",x:78,y:25},{id:"ST",x:50,y:18},{id:"LW",x:22,y:25}]},CC=[{key:"overall",label:"MED",short:"MED"}];function lJe(){const{t:a}=Sa(),{state:e,dispatch:n}=Va(),[i,s]=ge.useState(e.lineup||{}),[r,o]=ge.useState(null),[l,c]=ge.useState(!1),[u,h]=ge.useState(null),[f,m]=ge.useState("titulares"),[A,x]=ge.useState(!1),[T,E]=ge.useState(!1),[M,N]=ge.useState(!1),I=e.formation||"4-3-3",F=e.tactic||"balanced",G=d_[I]||d_["4-3-3"],O=e.team?.players||[],D=B3(e.team,I,F);ge.useEffect(()=>{const ce=JSON.stringify(e.lineup||{}),te=JSON.stringify(i);ce!==te&&s(e.lineup||{})},[e.lineup]),ge.useEffect(()=>{Object.keys(i).length>0&&n({type:"SET_LINEUP",payload:i})},[i,n]);const j=e.convocados||[],L=ge.useMemo(()=>{const ce=Object.values(i).map(ze=>ze?.name).filter(Boolean),te=[],fe=[],Le=[],Fe={GK:0,CB:1,RB:2,LB:3,RWB:4,LWB:5,CDM:6,CM:7,RM:8,LM:9,CAM:10,RW:11,LW:12,CF:13,ST:14},Ie=(ze,Je)=>{const rt=Fe[ze.position]??99,ve=Fe[Je.position]??99;return rt!==ve?rt-ve:Je.overall-ze.overall},at=[...O].sort((ze,Je)=>Je.overall-ze.overall),je=j.length>0;if(at.forEach((ze,Je)=>{const rt=ce.includes(ze.name),ve={...ze,number:Je+1};rt?te.push(ve):je?j.includes(ze.name)?fe.push(ve):Le.push(ve):!ze.injured&&fe.length<5?fe.push(ve):Le.push(ve)}),je&&fe.length<5){const ze=5-fe.length;Le.filter(rt=>!rt.injured).slice(0,ze).forEach(rt=>{fe.push(rt),Le.splice(Le.indexOf(rt),1)})}const Ve={};G.forEach((ze,Je)=>{Ve[ze.id]=Je});const Me=Object.entries(i);return te.sort((ze,Je)=>{const rt=Me.find(([Ue,it])=>it?.name===ze.name)?.[0],ve=Me.find(([Ue,it])=>it?.name===Je.name)?.[0];return(Ve[rt]??99)-(Ve[ve]??99)}),fe.sort(Ie),Le.sort(Ie),{titulares:te,convocados:fe,noConvocados:Le}},[O,i,j]),U=ge.useMemo(()=>{const ce={};return Object.entries(i).forEach(([te,fe])=>{fe?.name&&(ce[fe.name]=te)}),ce},[i]);ge.useEffect(()=>{e.lineup&&Object.keys(e.lineup).length>0&&s(e.lineup)},[]),ge.useEffect(()=>{Object.keys(i).length===0&&O.length>=11&&q()},[O]);const q=()=>{const ce={},te=new Set;G.forEach(Fe=>{const Ie=Lh(Fe.id),at=O.filter(je=>!te.has(je.name)&&!je.injured&&!je.suspended).sort((je,Ve)=>{const Me=rc(je.position,Ie),ze=rc(Ve.position,Ie),Je=Me.factor*je.overall;return ze.factor*Ve.overall-Je})[0];at&&(ce[Fe.id]=at,te.add(at.name))}),s(ce),n({type:"SET_LINEUP",payload:ce});const fe=new Set(Object.values(ce).map(Fe=>Fe?.name).filter(Boolean)),Le=(e.convocados||[]).filter(Fe=>!fe.has(Fe));if(Le.length<5){const Fe=5-Le.length,Ie=O.filter(at=>!fe.has(at.name)&&!Le.includes(at.name)&&!at.injured).sort((at,je)=>je.overall-at.overall).slice(0,Fe).map(at=>at.name);Le.push(...Ie)}n({type:"SET_CONVOCADOS",payload:Le})},K=ce=>{h(ce),c(!0)},H=ce=>{if(u){const te={...i};Object.keys(te).forEach(fe=>{te[fe]?.name===ce.name&&delete te[fe]}),te[u]=ce,s(te),n({type:"SET_LINEUP",payload:te})}o(ce),c(!1),h(null)},X=ce=>{if(!r){o(ce);return}if(r.name===ce.name){o(null);return}const te=r,fe=ce,Le=Object.entries(i).find(([at,je])=>je?.name===te.name)?.[0],Fe=Object.entries(i).find(([at,je])=>je?.name===fe.name)?.[0];if(Le&&!Fe&&(fe.suspended||fe.injured)){o(null);return}if(!Le&&Fe&&(te.suspended||te.injured)){o(null);return}const Ie={...i};if(Le&&Fe)Ie[Le]=fe,Ie[Fe]=te;else if(Le&&!Fe){Ie[Le]=fe;const at=j.length>0?[...j]:L.convocados.map(Ve=>Ve.name);if(at.includes(fe.name)){const Ve=at.filter(Me=>Me!==fe.name);Ve.push(te.name),n({type:"SET_CONVOCADOS",payload:Ve})}else{const Ve=at.filter(Me=>Me!==fe.name&&Me!==te.name);n({type:"SET_CONVOCADOS",payload:Ve})}}else if(!Le&&Fe){Ie[Fe]=te;const at=j.length>0?[...j]:L.convocados.map(Ve=>Ve.name);if(at.includes(te.name)){const Ve=at.filter(Me=>Me!==te.name);Ve.push(fe.name),n({type:"SET_CONVOCADOS",payload:Ve})}else{const Ve=at.filter(Me=>Me!==te.name&&Me!==fe.name);n({type:"SET_CONVOCADOS",payload:Ve})}}else{const at=j.includes(te.name)||!j.length&&L.convocados.some(Ve=>Ve.name===te.name),je=j.includes(fe.name)||!j.length&&L.convocados.some(Ve=>Ve.name===fe.name);if(at!==je){let Ve;j.length>0?(Ve=[...j],at?(Ve=Ve.filter(Me=>Me!==te.name),Ve.push(fe.name)):(Ve=Ve.filter(Me=>Me!==fe.name),Ve.push(te.name))):(Ve=L.convocados.map(Me=>Me.name),at?(Ve=Ve.filter(Me=>Me!==te.name),Ve.push(fe.name)):(Ve=Ve.filter(Me=>Me!==fe.name),Ve.push(te.name))),n({type:"SET_CONVOCADOS",payload:Ve})}}(Le||Fe)&&(s(Ie),n({type:"SET_LINEUP",payload:Ie})),o(null)},ne=.7,Q=(ce,te)=>{if(!ce||!te||ce.name===te.name)return null;const fe=U[ce.name],Le=fe?Lh(fe):ce.position,Fe=U[te.name],Ie=Fe?Lh(Fe):te.position,at=rc(te.position,Le),je=rc(ce.position,Ie);return at.factor>=je.factor?at:je},Y=(ce,te)=>{const fe=Q(ce,te);return fe!==null&&fe.factor>=ne},ue=ce=>{const te=DS(ce);return te==="GK"?"#f1c40f":["RB","CB","LB","RWB","LWB"].includes(te)?"#3498db":["CDM","CM","CAM","RM","LM"].includes(te)?"#2ecc71":"#e74c3c"},pe=ce=>{const te=ue(ce);return{color:te,background:`${te}33`,border:`1px solid ${te}66`,padding:"0.2rem 0.5rem",borderRadius:"4px",fontWeight:700,fontSize:"0.75rem",textShadow:"0 1px 2px rgba(0,0,0,0.3)"}},Ee=ce=>{const te=DS(ce);return te==="GK"?"pos-gk":["RB","CB","LB","RWB","LWB","DF"].includes(te)?"pos-def":["CDM","CM","CAM","RM","LM","MF"].includes(te)?"pos-mid":"pos-fwd"},oe=ce=>ce>=85?5:ce>=80?4:ce>=75?3:ce>=70?2:1,Ae=ce=>Array.from({length:5},(te,fe)=>d.jsx(Br,{size:12,className:fe<ce?"star-filled":"star-empty",fill:fe<ce?"currentColor":"none"},fe)),Ce=(e.currentDate?new Date(e.currentDate):new Date).toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long"});return d.jsxs("div",{className:"pcf-formation",children:[d.jsxs("div",{className:"pcf-header",children:[d.jsxs("div",{className:"pcf-header__team",children:[d.jsx("div",{className:"team-badge",children:e.team?.name?.charAt(0)||"E"}),d.jsx("span",{className:"team-name",children:e.team?.name||"Mi Equipo"})]}),d.jsx("div",{className:"pcf-header__title",children:d.jsx("h1",{children:a("formation.title").toUpperCase()})}),d.jsx("div",{className:"pcf-header__info",children:d.jsxs("div",{className:"date-display",children:[d.jsx("span",{className:"label",children:a("calendar.date")}),d.jsx("span",{className:"value",children:Ce})]})})]}),d.jsxs("div",{className:"pcf-content",children:[d.jsxs("div",{className:"pcf-table-container",children:[d.jsxs("div",{className:"pcf-table",children:[d.jsxs("div",{className:"table-header titulares",children:[d.jsx("span",{className:"col-num",children:"N"}),d.jsx("span",{className:"col-name",children:a("plantilla.player")}),d.jsx("span",{className:"col-status"}),CC.map(ce=>d.jsx("span",{className:"col-attr",children:ce.short},ce.key)),d.jsx("span",{className:"col-pos",children:a("common.position").substring(0,3).toUpperCase()})]}),d.jsx("div",{className:"table-body",children:L.titulares.map((ce,te)=>{const fe=r?.name===ce.name,Le=r&&!fe&&Y(r,ce),Fe=U[ce.name],Ie=Fe?Lh(Fe):null,at=Ie?rc(ce.position,Ie):null,je=Le?Q(r,ce):null,Ve=je?je.level==="perfect"?"swap-perfect":je.level==="good"?"swap-good":"swap-decent":"";return d.jsxs("div",{className:`table-row titulares ${Ee(ce.position)} ${fe?"selected":""} ${Le?`compatible-swap ${Ve}`:""} ${ce.injured?"injured":""} ${ce.suspended?ce.suspensionType==="red"?"suspended-red":"suspended-yellow":""}`,onClick:()=>X(ce),children:[d.jsx("span",{className:"col-num",children:ce.number}),d.jsx("span",{className:"col-name",children:ce.name}),d.jsxs("span",{className:"col-status",children:[(()=>{const Me=(e.playerForm||{})[ce.name]||"normal",ze=IE[Me];return d.jsx("span",{className:`form-arrow form-${Me}`,style:{color:ze.color},title:`Forma: ${ze.label} (${ze.matchBonus>0?"+":""}${Math.round(ze.matchBonus*100)}%)`,children:ze.arrow})})(),ce.injured&&ce.injuryWeeksLeft>0&&d.jsxs("span",{className:"status-icon injury",children:[d.jsx(su,{size:12}),ce.injuryWeeksLeft,"s"]}),ce.suspended&&ce.suspensionType==="red"&&d.jsxs("span",{className:"status-icon red",children:[d.jsx(sc,{size:12,className:"card-red"}),ce.suspensionMatches,"p"]}),ce.suspended&&ce.suspensionType==="double_yellow"&&d.jsxs("span",{className:"status-icon red",children:[d.jsxs(d.Fragment,{children:[d.jsx(sc,{size:12,className:"card-yellow"}),d.jsx(sc,{size:12,className:"card-yellow"})]}),ce.suspensionMatches,"p"]}),ce.suspended&&ce.suspensionType==="yellow"&&d.jsxs("span",{className:"status-icon yellow",children:[d.jsx(sc,{size:12,className:"card-yellow"}),"5"]}),!ce.suspended&&!ce.injured&&ce.postInjuryBonus>0&&ce.postInjuryWeeksLeft>0&&d.jsxs("span",{className:"status-icon boost",children:[d.jsx(dl,{size:12}),ce.postInjuryWeeksLeft,"s"]}),!ce.suspended&&!ce.injured&&!(ce.postInjuryBonus>0&&ce.postInjuryWeeksLeft>0)&&(ce.yellowCards||0)>=4&&d.jsx("span",{className:"status-icon warning",children:d.jsx(wr,{size:12})})]}),CC.map(Me=>{const ze=ce.overall+(ce.postInjuryBonus||0),Je=at?Math.round(ze*at.factor):ze,rt=ce.postInjuryBonus>0&&ce.postInjuryWeeksLeft>0,ve=at?`fit-${at.level}`:"",Ue=rt?"boosted":"";return d.jsx("span",{className:`col-attr ${ve||(Je>=80?"high":Je<=60?"low":"")} ${Ue}`,title:rt?`${ce.overall} + ${ce.postInjuryBonus} bonus (${ce.postInjuryWeeksLeft}w)`:at&&at.level!=="perfect"?`${ce.overall}  ${Je} (${ds(ce.position)} ${a("formation.playingAs")} ${ds(Ie)})`:"",children:Je},Me.key)}),d.jsx("span",{className:"col-pos",style:pe(Ie||ce.position),children:ds(Ie||ce.position)})]},ce.name)})})]}),d.jsx("div",{className:"pcf-section-header convocados",children:a("formation.reserves").toUpperCase()}),d.jsx("div",{className:"pcf-table",children:d.jsx("div",{className:"table-body",children:L.convocados.map((ce,te)=>{const fe=r?.name===ce.name,Le=r&&!fe&&Y(r,ce),Fe=Le?Q(r,ce):null,Ie=Fe?Fe.level==="perfect"?"swap-perfect":Fe.level==="good"?"swap-good":"swap-decent":"";return d.jsxs("div",{className:`table-row convocados ${Ee(ce.position)} ${fe?"selected":""} ${Le?`compatible-swap ${Ie}`:""} ${ce.injured?"injured":""} ${ce.suspended?ce.suspensionType==="red"?"suspended-red":"suspended-yellow":""}`,onClick:()=>X(ce),children:[d.jsx("span",{className:"col-num",children:ce.number}),d.jsx("span",{className:"col-name",children:ce.name}),d.jsxs("span",{className:"col-status",children:[(()=>{const at=(e.playerForm||{})[ce.name]||"normal",je=IE[at];return d.jsx("span",{className:`form-arrow form-${at}`,style:{color:je.color},title:`Forma: ${je.label} (${je.matchBonus>0?"+":""}${Math.round(je.matchBonus*100)}%)`,children:je.arrow})})(),ce.injured&&ce.injuryWeeksLeft>0&&d.jsxs("span",{className:"status-icon injury",children:[d.jsx(su,{size:12}),ce.injuryWeeksLeft,"s"]}),ce.suspended&&ce.suspensionType==="red"&&d.jsxs("span",{className:"status-icon red",children:[d.jsx(sc,{size:12,className:"card-red"}),ce.suspensionMatches,"p"]}),ce.suspended&&ce.suspensionType==="double_yellow"&&d.jsxs("span",{className:"status-icon red",children:[d.jsxs(d.Fragment,{children:[d.jsx(sc,{size:12,className:"card-yellow"}),d.jsx(sc,{size:12,className:"card-yellow"})]}),ce.suspensionMatches,"p"]}),ce.suspended&&ce.suspensionType==="yellow"&&d.jsxs("span",{className:"status-icon yellow",children:[d.jsx(sc,{size:12,className:"card-yellow"}),"5"]}),!ce.suspended&&!ce.injured&&ce.postInjuryBonus>0&&ce.postInjuryWeeksLeft>0&&d.jsxs("span",{className:"status-icon boost",children:[d.jsx(dl,{size:12}),ce.postInjuryWeeksLeft,"s"]}),!ce.suspended&&!ce.injured&&!(ce.postInjuryBonus>0&&ce.postInjuryWeeksLeft>0)&&(ce.yellowCards||0)>=4&&d.jsx("span",{className:"status-icon warning",children:d.jsx(wr,{size:12})})]}),CC.map(at=>{const je=(ce[at.key]||ce.overall)+(ce.postInjuryBonus||0),Ve=ce.postInjuryBonus>0&&ce.postInjuryWeeksLeft>0;return d.jsx("span",{className:`col-attr ${je>=80?"high":je<=60?"low":""} ${Ve?"boosted":""}`,children:je},at.key)}),d.jsx("span",{className:"col-pos",style:pe(ce.position),children:ds(ce.position)})]},ce.name)})})}),d.jsx("div",{className:"pcf-section-header noconvocados",children:a("formation.notCalled").toUpperCase()}),d.jsx("div",{className:"pcf-table pcf-table--noconvocados",children:d.jsx("div",{className:"table-body table-body--scroll",children:L.noConvocados.map((ce,te)=>{const fe=r?.name===ce.name,Le=r&&!fe&&Y(r,ce),Fe=Le?Q(r,ce):null,Ie=Fe?Fe.level==="perfect"?"swap-perfect":Fe.level==="good"?"swap-good":"swap-decent":"";return d.jsxs("div",{className:`table-row noconvocados ${Ee(ce.position)} ${fe?"selected":""} ${Le?`compatible-swap ${Ie}`:""} ${ce.injured?"injured":""} ${ce.suspended?ce.suspensionType==="red"?"suspended-red":"suspended-yellow":""}`,onClick:()=>X(ce),children:[d.jsx("span",{className:"col-num",children:ce.number}),d.jsx("span",{className:"col-name",children:ce.name}),d.jsxs("span",{className:"col-status",children:[(()=>{const at=(e.playerForm||{})[ce.name]||"normal",je=IE[at];return d.jsx("span",{className:`form-arrow form-${at}`,style:{color:je.color},title:`Forma: ${je.label} (${je.matchBonus>0?"+":""}${Math.round(je.matchBonus*100)}%)`,children:je.arrow})})(),ce.injured&&ce.injuryWeeksLeft>0&&d.jsxs("span",{className:"status-icon injury",children:[d.jsx(su,{size:12}),ce.injuryWeeksLeft,"s"]}),ce.suspended&&ce.suspensionType==="red"&&d.jsxs("span",{className:"status-icon red",children:[d.jsx(sc,{size:12,className:"card-red"}),ce.suspensionMatches,"p"]}),ce.suspended&&ce.suspensionType==="double_yellow"&&d.jsxs("span",{className:"status-icon red",children:[d.jsxs(d.Fragment,{children:[d.jsx(sc,{size:12,className:"card-yellow"}),d.jsx(sc,{size:12,className:"card-yellow"})]}),ce.suspensionMatches,"p"]}),ce.suspended&&ce.suspensionType==="yellow"&&d.jsxs("span",{className:"status-icon yellow",children:[d.jsx(sc,{size:12,className:"card-yellow"}),"5"]}),!ce.suspended&&!ce.injured&&ce.postInjuryBonus>0&&ce.postInjuryWeeksLeft>0&&d.jsxs("span",{className:"status-icon boost",children:[d.jsx(dl,{size:12}),ce.postInjuryWeeksLeft,"s"]}),!ce.suspended&&!ce.injured&&!(ce.postInjuryBonus>0&&ce.postInjuryWeeksLeft>0)&&(ce.yellowCards||0)>=4&&d.jsx("span",{className:"status-icon warning",children:d.jsx(wr,{size:12})})]}),CC.map(at=>{const je=(ce[at.key]||ce.overall)+(ce.postInjuryBonus||0),Ve=ce.postInjuryBonus>0&&ce.postInjuryWeeksLeft>0;return d.jsx("span",{className:`col-attr ${je>=80?"high":je<=60?"low":""} ${Ve?"boosted":""}`,children:je},at.key)}),d.jsx("span",{className:"col-pos",style:pe(ce.position),children:ds(ce.position)})]},ce.name)})})})]}),d.jsxs("div",{className:"pcf-sidebar",children:[d.jsxs("div",{className:"pcf-pitch",children:[d.jsxs("div",{className:"pitch-bg",children:[d.jsx("div",{className:"pitch-line center"}),d.jsx("div",{className:"pitch-circle"}),d.jsx("div",{className:"pitch-area top"}),d.jsx("div",{className:"pitch-area bottom"})]}),G.map(ce=>{const te=i[ce.id],fe=Lh(ce.id),Le=te?rc(te.position,fe):null,Fe=(te?.overall||0)+(te?.postInjuryBonus||0),Ie=te&&Le?Math.round(Fe*Le.factor):Fe||void 0,at=Le?rAe[Le.level]:"#fff",je=te?.postInjuryBonus>0&&te?.postInjuryWeeksLeft>0;return d.jsx("div",{className:`pitch-slot ${te?"filled":"empty"} ${je?"boosted":""}`,style:{left:`${ce.x}%`,top:`${ce.y}%`},onClick:()=>K(ce.id),children:te?d.jsxs("div",{className:"player-dot",style:{background:ue(te.position),borderColor:at,boxShadow:je?"0 0 10px 3px rgba(48, 209, 88, 0.6)":void 0},children:[d.jsx("span",{className:"ovr",children:Ie}),(()=>{const Ve=(e.playerForm||{})[te.name]||"normal",Me=IE[Ve];return d.jsx("span",{className:`pitch-form-arrow form-${Ve}`,style:{position:"absolute",top:"-10px",right:"-10px",color:Me.color,fontWeight:"bold",fontSize:"12px",lineHeight:1,textShadow:"0 0 4px rgba(0,0,0,0.9), 0 0 2px rgba(0,0,0,0.9)",zIndex:5},title:`Forma: ${Me.label} (${Me.matchBonus>0?"+":""}${Math.round(Me.matchBonus*100)}%)`,children:Me.arrow})})()]}):d.jsx("div",{className:"empty-dot",children:d.jsx("span",{children:"+"})})},ce.id)})]}),d.jsxs("div",{className:"pcf-params",children:[d.jsx("div",{className:"params-header",children:a("formation.parameters")}),d.jsxs("div",{className:"params-section",children:[d.jsxs("div",{className:"param-item",children:[d.jsx("span",{className:"label",children:a("formation.rating")}),d.jsx("span",{className:"stars",children:Ae(oe(D.overall))})]}),d.jsxs("div",{className:"param-item",children:[d.jsx("span",{className:"label",children:a("formation.teamAverage")}),d.jsx("span",{className:"value big",children:Math.round(D.overall)})]})]}),r&&d.jsxs("div",{className:"params-player",children:[d.jsx("div",{className:"player-name",children:r.name}),r.role&&d.jsxs("div",{className:"player-role",children:[d.jsx("span",{className:"role-icon",children:r.role.icon}),d.jsx("span",{className:"role-name",children:r.role.name})]}),r.role?.desc&&d.jsx("div",{className:"role-desc",children:r.role.desc}),d.jsxs("div",{className:"player-info-grid",children:[d.jsxs("div",{className:"info-item",children:[d.jsx("span",{className:"label",children:a("common.age")}),d.jsxs("span",{className:"value",children:[r.age," ",a("formation.years")]})]}),d.jsxs("div",{className:"info-item",children:[d.jsx("span",{className:"label",children:a("common.position")}),d.jsx("span",{className:"value",children:r.position})]})]})]})]}),d.jsxs("div",{className:"pcf-buttons",children:[d.jsxs("button",{className:"pcf-btn",onClick:()=>x(!0),children:[d.jsx(BF,{size:16})," ",a("formation.injured").toUpperCase()]}),d.jsxs("button",{className:"pcf-btn",onClick:()=>E(!0),children:[d.jsx(v_,{size:16})," ",a("formation.statistics").toUpperCase()]}),d.jsxs("button",{className:"pcf-btn",onClick:()=>N(!0),children:[d.jsx(Fs,{size:16})," ",a("formation.tactic").toUpperCase()]})]})]})]}),l&&d.jsx("div",{className:"pcf-modal-overlay",onClick:()=>c(!1),children:d.jsxs("div",{className:"pcf-modal",onClick:ce=>ce.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h3",{children:a("formation.selectPlayer")}),d.jsx("button",{onClick:()=>c(!1),children:d.jsx(zr,{size:14})})]}),d.jsx("div",{className:"modal-body",children:O.filter(ce=>!ce.injured&&!ce.suspended).sort((ce,te)=>{const fe=Lh(u),Le=rc(ce.position,fe),Fe=rc(te.position,fe);return Fe.factor!==Le.factor?Fe.factor-Le.factor:te.overall-ce.overall}).map(ce=>{const te=Lh(u),fe=rc(ce.position,te),Le=fe.level==="perfect"?"fit-perfect":fe.level==="good"?"fit-good":fe.level==="decent"?"fit-decent":"",Fe=Object.values(i).some(Ie=>Ie?.name===ce.name);return d.jsxs("div",{className:`modal-player ${Le} ${Fe?"in-lineup":""}`,onClick:()=>H(ce),children:[d.jsx("span",{className:"pos",style:{color:ue(ce.position)},children:ds(ce.position)}),d.jsx("span",{className:"name",children:ce.name}),d.jsx("span",{className:"ovr",children:ce.overall}),fe.level==="perfect"&&d.jsx("span",{className:"badge",children:d.jsx(uo,{size:10})}),fe.level==="good"&&d.jsx("span",{className:"badge good",children:""})]},ce.name)})})]})}),A&&d.jsx(cJe,{onClose:()=>x(!1),players:O,facilities:e.team?.facilities,dispatch:n,budget:e.team?.budget}),T&&d.jsx(uJe,{onClose:()=>E(!1),players:O,team:e.team,leagueTable:e.leagueTable,teamId:e.teamId,playerSeasonStats:e.playerSeasonStats}),M&&d.jsx(hJe,{onClose:()=>N(!1),currentTactic:F,currentFormation:I,dispatch:n,onFormationChange:ce=>{n({type:"SET_FORMATION",payload:ce}),s({}),setTimeout(()=>{const te={},fe=new Set;(d_[ce]||d_["4-3-3"]).forEach(at=>{const je=Lh(at.id),Ve=O.filter(Me=>!fe.has(Me.name)&&!Me.injured&&!Me.suspended).sort((Me,ze)=>{const Je=rc(Me.position,je),rt=rc(ze.position,je),ve=Je.factor*Me.overall;return rt.factor*ze.overall-ve})[0];Ve&&(te[at.id]=Ve,fe.add(Ve.name))}),s(te),n({type:"SET_LINEUP",payload:te});const Fe=new Set(Object.values(te).map(at=>at?.name).filter(Boolean)),Ie=(e.convocados||[]).filter(at=>!Fe.has(at));if(Ie.length<5){const at=5-Ie.length,je=O.filter(Ve=>!Fe.has(Ve.name)&&!Ie.includes(Ve.name)&&!Ve.injured).sort((Ve,Me)=>Me.overall-Ve.overall).slice(0,at).map(Ve=>Ve.name);Ie.push(...je)}n({type:"SET_CONVOCADOS",payload:Ie})},50)}})]})}function cJe({onClose:a,players:e,facilities:n,dispatch:i,budget:s}){const{t:r}=Sa(),o=iwe(),l=e.filter(M=>M.injured&&M.injuryWeeksLeft>0),c=n?.medicalCenter||1,u=c+1,[h,f]=ge.useState(0),[m,A]=ge.useState([]),x=5e5,T=1+Math.floor(c/2),E=M=>{h>=u||s<x||(i({type:"TREAT_INJURY",payload:{playerId:M.id||M.name,weeksReduced:T,cost:x}}),f(N=>N+1),A(N=>[...N,M.name]),o.success(`${M.name} tratado (-${T} semanas)`))};return d.jsx("div",{className:"pcf-modal-overlay",onClick:a,children:d.jsxs("div",{className:"pcf-modal pcf-modal--injured",onClick:M=>M.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsxs("h3",{children:[d.jsx(BF,{size:20,style:{marginRight:8}})," ",r("formation.injured")]}),d.jsx("button",{onClick:a,children:d.jsx(zr,{size:18})})]}),d.jsxs("div",{className:"modal-body",children:[l.length===0?d.jsxs("div",{className:"no-injured",children:[d.jsx("span",{className:"icon",children:d.jsx(uo,{size:14})}),d.jsx("p",{children:r("formation.noInjuredPlayers")})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"injured-info",children:[d.jsxs("span",{children:["Tratamientos disponibles: ",u-h,"/",u]}),d.jsxs("span",{children:["Coste por tratamiento: ",(x/1e3).toFixed(0),"K"]})]}),d.jsx("div",{className:"injured-list",children:l.map(M=>{const N=m.includes(M.name),I=N?Math.max(0,M.injuryWeeksLeft-T):M.injuryWeeksLeft;return d.jsxs("div",{className:`injured-player ${N?"treated":""}`,children:[d.jsxs("div",{className:"player-info",children:[d.jsx("span",{className:"pos",children:ds(M.position)}),d.jsx("span",{className:"name",children:M.name}),d.jsx("span",{className:"ovr",children:M.overall})]}),d.jsx("div",{className:"injury-info",children:d.jsxs("span",{className:`weeks ${N?"reduced":""}`,children:[d.jsx(or,{size:12})," ",I," semana",I!==1?"s":"",N&&d.jsx("span",{className:"treat-badge",children:d.jsx(uo,{size:10})})]})}),N?d.jsx("span",{className:"treated-label",children:"Tratado"}):d.jsx("button",{className:"btn-treat",onClick:()=>E(M),disabled:h>=u||s<x,children:"Tratar"})]},M.name)})})]}),d.jsxs("div",{className:"medical-info",children:[d.jsxs("span",{children:[d.jsx(Ol,{size:14,style:{marginRight:4}})," ",r("formation.medicalLevel",{level:c})]}),d.jsx("span",{className:"hint",children:r("formation.upgradeMedical")})]})]}),d.jsx("div",{className:"modal-footer",children:d.jsx("button",{className:"btn-confirm",onClick:a,children:r("common.close")})})]})})}function uJe({onClose:a,players:e,team:n,leagueTable:i,teamId:s,playerSeasonStats:r}){const{t:o}=Sa(),[l,c]=ge.useState("equipo"),u=Math.round(e.reduce((G,O)=>G+O.overall,0)/e.length)||0,h=e.reduce((G,O)=>G+(O.value||0),0),f=Math.round(e.reduce((G,O)=>G+(O.age||25),0)/e.length)||0,m=[...e].sort((G,O)=>O.overall-G.overall).slice(0,5),A=[...e].sort((G,O)=>(O.value||0)-(G.value||0)).slice(0,5),x=(i||[]).find(G=>G.teamId===s),T=x?{played:x.played||0,won:x.won||0,drawn:x.drawn||0,lost:x.lost||0,goalsFor:x.goalsFor||0,goalsAgainst:x.goalsAgainst||0}:{played:0,won:0,drawn:0,lost:0,goalsFor:0,goalsAgainst:0},E=r||{},M=new Set(e.map(G=>G.name)),N=Object.entries(E).filter(([G,O])=>M.has(G)&&O.goals>0).sort((G,O)=>O[1].goals-G[1].goals).slice(0,5),I=Object.entries(E).filter(([G,O])=>M.has(G)&&O.assists>0).sort((G,O)=>O[1].assists-G[1].assists).slice(0,5),F=Object.entries(E).filter(([G,O])=>M.has(G)&&O.matchesPlayed>0).sort((G,O)=>O[1].matchesPlayed-G[1].matchesPlayed).slice(0,5);return d.jsx("div",{className:"pcf-modal-overlay",onClick:a,children:d.jsxs("div",{className:"pcf-modal pcf-modal--stats",onClick:G=>G.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsxs("h3",{children:[d.jsx(v_,{size:20,style:{marginRight:8}})," ",o("formation.statistics")]}),d.jsx("button",{onClick:a,children:d.jsx(zr,{size:18})})]}),d.jsxs("div",{className:"modal-tabs",children:[d.jsx("button",{className:l==="equipo"?"active":"",onClick:()=>c("equipo"),children:o("formation.statsTeam")}),d.jsx("button",{className:l==="temporada"?"active":"",onClick:()=>c("temporada"),children:o("formation.statsSeason")}),d.jsx("button",{className:l==="jugadores"?"active":"",onClick:()=>c("jugadores"),children:o("formation.statsPlayers")}),d.jsx("button",{className:l==="top"?"active":"",onClick:()=>c("top"),children:o("formation.statsTop")})]}),d.jsxs("div",{className:"modal-body",children:[l==="equipo"&&d.jsxs("div",{className:"stats-grid",children:[d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"value",children:e.length}),d.jsx("span",{className:"label",children:o("formation.players")})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"value",children:u}),d.jsx("span",{className:"label",children:o("formation.avgOVR")})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("span",{className:"value",children:f}),d.jsx("span",{className:"label",children:o("formation.avgAge")})]}),d.jsxs("div",{className:"stat-card",children:[d.jsxs("span",{className:"value",children:["",(h/1e6).toFixed(1),"M"]}),d.jsx("span",{className:"label",children:o("formation.squadValue")})]})]}),l==="temporada"&&d.jsxs("div",{className:"season-stats",children:[d.jsxs("div",{className:"stats-row",children:[d.jsx("span",{className:"label",children:o("formation.matches")}),d.jsx("span",{className:"value",children:T.played})]}),d.jsxs("div",{className:"stats-row",children:[d.jsx("span",{className:"label",children:o("formation.wins")}),d.jsx("span",{className:"value win",children:T.won})]}),d.jsxs("div",{className:"stats-row",children:[d.jsx("span",{className:"label",children:o("formation.draws")}),d.jsx("span",{className:"value draw",children:T.drawn})]}),d.jsxs("div",{className:"stats-row",children:[d.jsx("span",{className:"label",children:o("formation.losses")}),d.jsx("span",{className:"value loss",children:T.lost})]}),d.jsxs("div",{className:"stats-row",children:[d.jsx("span",{className:"label",children:o("formation.goalsFor")}),d.jsx("span",{className:"value",children:T.goalsFor})]}),d.jsxs("div",{className:"stats-row",children:[d.jsx("span",{className:"label",children:o("formation.goalsAgainst")}),d.jsx("span",{className:"value",children:T.goalsAgainst})]}),d.jsxs("div",{className:"stats-row highlight",children:[d.jsx("span",{className:"label",children:o("formation.goalDiff")}),d.jsxs("span",{className:`value ${T.goalsFor-T.goalsAgainst>=0?"positive":"negative"}`,children:[T.goalsFor-T.goalsAgainst>=0?"+":"",T.goalsFor-T.goalsAgainst]})]})]}),l==="jugadores"&&d.jsxs("div",{className:"top-players",children:[N.length>0&&d.jsxs("div",{className:"top-section",children:[d.jsx("h4",{children:"Goleadores"}),N.map(([G,O],D)=>d.jsxs("div",{className:"top-row",children:[d.jsx("span",{className:"rank",children:D+1}),d.jsx("span",{className:"name",children:G}),d.jsxs("span",{className:"value",children:[O.goals," gol",O.goals!==1?"es":""]})]},G))]}),I.length>0&&d.jsxs("div",{className:"top-section",children:[d.jsx("h4",{children:"Asistentes"}),I.map(([G,O],D)=>d.jsxs("div",{className:"top-row",children:[d.jsx("span",{className:"rank",children:D+1}),d.jsx("span",{className:"name",children:G}),d.jsxs("span",{className:"value",children:[O.assists," asist."]})]},G))]}),F.length>0&&d.jsxs("div",{className:"top-section",children:[d.jsx("h4",{children:o("formation.mostMatches")}),F.map(([G,O],D)=>d.jsxs("div",{className:"top-row",children:[d.jsx("span",{className:"rank",children:D+1}),d.jsx("span",{className:"name",children:G}),d.jsxs("span",{className:"value",children:[O.matchesPlayed," PJ"]})]},G))]}),N.length===0&&I.length===0&&F.length===0&&d.jsx("p",{style:{color:"#8899aa",textAlign:"center",padding:"2rem 0"},children:o("formation.noStatsYet")})]}),l==="top"&&d.jsxs("div",{className:"top-players",children:[d.jsxs("div",{className:"top-section",children:[d.jsxs("h4",{children:[d.jsx(Ai,{size:14})," ",o("formation.topRated")]}),m.map((G,O)=>d.jsxs("div",{className:"top-row",children:[d.jsx("span",{className:"rank",children:O+1}),d.jsx("span",{className:"name",children:G.name}),d.jsx("span",{className:"value",children:G.overall})]},G.name))]}),d.jsxs("div",{className:"top-section",children:[d.jsxs("h4",{children:[d.jsx(ju,{size:14})," ",o("formation.mostValuable")]}),A.map((G,O)=>d.jsxs("div",{className:"top-row",children:[d.jsx("span",{className:"rank",children:O+1}),d.jsx("span",{className:"name",children:G.name}),d.jsxs("span",{className:"value",children:["",((G.value||0)/1e6).toFixed(1),"M"]})]},G.name))]})]})]}),d.jsx("div",{className:"modal-footer",children:d.jsx("button",{className:"btn-confirm",onClick:a,children:o("common.close")})})]})})}function dJe({positions:a,isActive:e}){return d.jsxs("svg",{viewBox:"0 0 100 120",className:"mini-pitch",children:[d.jsx("rect",{x:"2",y:"2",width:"96",height:"116",rx:"3",fill:e?"#1a3a2a":"#0d1a14",stroke:e?"#2d8a4e":"#1a2f22",strokeWidth:"1"}),d.jsx("line",{x1:"2",y1:"60",x2:"98",y2:"60",stroke:e?"#2d8a4e":"#1a2f22",strokeWidth:"0.5"}),d.jsx("circle",{cx:"50",cy:"60",r:"10",fill:"none",stroke:e?"#2d8a4e":"#1a2f22",strokeWidth:"0.5"}),d.jsx("rect",{x:"25",y:"2",width:"50",height:"18",fill:"none",stroke:e?"#2d8a4e":"#1a2f22",strokeWidth:"0.5"}),d.jsx("rect",{x:"25",y:"100",width:"50",height:"18",fill:"none",stroke:e?"#2d8a4e":"#1a2f22",strokeWidth:"0.5"}),a.map((n,i)=>{const s=4+n.y/100*112,r=2+n.x/100*96,o=n.id==="GK";return d.jsxs("g",{children:[d.jsx("circle",{cx:r,cy:s,r:o?3.5:3,fill:e?o?"#ffd60a":"#30d158":o?"#aa8800":"#446655"}),d.jsx("text",{x:r,y:s+7,textAnchor:"middle",fontSize:"4.5",fontWeight:"bold",fill:e?"#fff":"#556",children:ds(n.id)})]},i)})]})}function hJe({onClose:a,currentTactic:e,currentFormation:n,dispatch:i,onFormationChange:s}){const{t:r}=Sa(),[o,l]=ge.useState(e),[c,u]=ge.useState(n),[h,f]=ge.useState(!1),[m,A]=ge.useState("formation"),x=[{label:"4 Defensas",formations:["4-3-3","4-3-3 (MCO)","4-4-2","4-4-2 (Diamante)","4-2-3-1","4-1-4-1","4-5-1","4-1-2-1-2","4-3-2-1"]},{label:"3 Defensas",formations:["3-5-2","3-4-3","3-4-1-2"]},{label:"5 Defensas",formations:["5-3-2","5-4-1","5-2-3"]}],T=[{id:"defensive",name:r("formation.tacDefensive"),desc:r("formation.tacDefensiveDesc"),iconType:"shield",bonus:r("formation.tacDefensiveBonus"),detail:r("formation.tacDefensiveDetail"),color:"#0a84ff"},{id:"balanced",name:r("formation.tacBalanced"),desc:r("formation.tacBalancedDesc"),iconType:"scale",bonus:r("formation.tacBalancedBonus"),detail:r("formation.tacBalancedDetail"),color:"#8e8e93"},{id:"attacking",name:r("formation.tacAttacking"),desc:r("formation.tacAttackingDesc"),iconType:"swords",bonus:r("formation.tacAttackingBonus"),detail:r("formation.tacAttackingDetail"),color:"#ff453a"},{id:"possession",name:r("formation.tacPossession"),desc:r("formation.tacPossessionDesc"),iconType:"target",bonus:r("formation.tacPossessionBonus"),detail:r("formation.tacPossessionDetail"),color:"#30d158"},{id:"counter",name:r("formation.tacCounter"),desc:r("formation.tacCounterDesc"),iconType:"zap",bonus:r("formation.tacCounterBonus"),detail:r("formation.tacCounterDetail"),color:"#ff9f0a"}],E=ge.useMemo(()=>{const N=d_[c];return N?N.filter(I=>I.id!=="GK").map(I=>ds(I.id)):[]},[c]),M=()=>{i({type:"SET_TACTIC",payload:o}),c!==n&&s&&s(c),f(!0),setTimeout(()=>{f(!1),a()},1500)};return d.jsx("div",{className:"pcf-modal-overlay",onClick:a,children:d.jsxs("div",{className:"pcf-modal pcf-modal--tactic",onClick:N=>N.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsxs("h3",{children:[d.jsx(Fs,{size:20,style:{marginRight:8}})," ",r("formation.tacticAndFormation")]}),d.jsx("button",{onClick:a,children:d.jsx(zr,{size:18})})]}),d.jsxs("div",{className:"tactic-tabs",children:[d.jsxs("button",{className:`tab ${m==="formation"?"active":""}`,onClick:()=>A("formation"),children:[" ",r("formation.formation")]}),d.jsxs("button",{className:`tab ${m==="tactic"?"active":""}`,onClick:()=>A("tactic"),children:[" ",r("formation.tactic")]})]}),d.jsxs("div",{className:"modal-body",children:[m==="formation"&&d.jsxs("div",{className:"formation-visual-selector",children:[x.map(N=>d.jsxs("div",{className:"formation-group",children:[d.jsx("div",{className:"group-label",children:N.label}),d.jsx("div",{className:"formation-grid",children:N.formations.map(I=>{const F=d_[I];if(!F)return null;const G=c===I;return d.jsxs("div",{className:`formation-card ${G?"active":""}`,onClick:()=>u(I),children:[d.jsx(dJe,{positions:F,isActive:G}),d.jsx("div",{className:"formation-name",children:I})]},I)})})]},N.label)),d.jsxs("div",{className:"formation-detail",children:[d.jsxs("div",{className:"detail-header",children:[d.jsx("span",{className:"detail-name",children:c}),d.jsx("span",{className:"detail-desc",children:H6[c]?.description})]}),d.jsx("div",{className:"detail-positions",children:E.map((N,I)=>d.jsx("span",{className:"pos-tag",children:N},I))})]})]}),m==="tactic"&&d.jsx("div",{className:"tactic-options",children:T.map(N=>{const I={shield:x_,scale:UZ,swords:ef,target:Fs,zap:ru}[N.iconType]||BT;return d.jsxs("div",{className:`tactic-option ${o===N.id?"active":""}`,onClick:()=>l(N.id),style:{"--tactic-color":N.color},children:[d.jsx("span",{className:"icon",style:{color:N.color},children:d.jsx(I,{size:24})}),d.jsxs("div",{className:"info",children:[d.jsx("span",{className:"name",children:N.name}),d.jsx("span",{className:"desc",children:N.desc}),d.jsx("span",{className:"bonus",children:N.bonus}),N.detail&&d.jsx("span",{className:"detail",children:N.detail})]}),o===N.id&&d.jsx(rS,{size:20,className:"check",style:{color:N.color}})]},N.id)})})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn-cancel",onClick:a,children:r("common.cancel")}),d.jsx("button",{className:"btn-confirm",onClick:M,children:r("formation.apply")})]}),h&&d.jsxs("div",{className:"tactic-toast",children:[d.jsx(uo,{size:14})," ",c,"  ",T.find(N=>N.id===o)?.name]})]})})}function fJe(){const{state:a}=Va(),{t:e}=Sa(),n=ge.useRef(null),i=ge.useMemo(()=>fm(a.playerLeagueId),[a.playerLeagueId]),s=ge.useMemo(()=>a.europeanCompetitions?gP(a.europeanCompetitions,a.teamId):null,[a.europeanCompetitions,a.teamId]),r=ge.useMemo(()=>a.saCompetitions?vP(a.saCompetitions,a.teamId):null,[a.saCompetitions,a.teamId]),o=ge.useMemo(()=>{if(a.europeanCalendar)return a.europeanCalendar;const X=Array.isArray(a.fixtures)?a.fixtures:[],ne=X.length>0?Math.max(...X.map(Q=>Q.week)):38;return{leagueWeekMap:Array.from({length:ne},(Q,Y)=>Y+1),europeanWeeks:{},allEuropeanWeeks:[],cupWeeks:[],totalWeeks:ne}},[a.europeanCalendar,a.fixtures]),l=o.totalWeeks,c=!!a.europeanCompetitions?.initialized||!!a.saCompetitions?.initialized||o.allEuropeanWeeks?.length>0,u=!!a.cupCompetition||o.cupWeeks?.length>0,h=ge.useMemo(()=>{const{leagueWeekMap:X,allEuropeanWeeks:ne,europeanWeeks:Q,cupWeeks:Y}=o,ue=[],pe={};X&&X.forEach((Le,Fe)=>{pe[Le]=Fe+1});const Ee=new Set(ne||[]),oe=new Set(Y||[]),Ae={},be={league:"J",playoff:"PO",r16:"8v",qf:"4t",sf:"SF",final:"F"};if(Q)for(const[Le,Fe]of Object.entries(Q))Array.isArray(Fe)&&Fe.forEach((Ie,at)=>{Ae[Ie]={phase:Le,matchday:at+1,total:Fe.length}});const Ce={championsLeague:"champions",europaLeague:"europa",conferenceleague:"conference",copaLibertadores:"champions",copaSudamericana:"europa"},ce=i?r&&Ce[r.competitionId]||"champions":s&&Ce[s.competitionId]||"champions",te={};(a.fixtures||[]).forEach(Le=>{te[Le.week]||(te[Le.week]=[]),te[Le.week].push(Le)});let fe=0;for(let Le=1;Le<=l;Le++){if(pe[Le]!==void 0){const Fe=pe[Le],Ie=te[Le]||[];ue.push({week:Le,type:"league",number:Fe,competitionClass:"",label:String(Fe),played:Ie.length>0&&Ie.every(at=>at.played)})}if(Ee.has(Le)&&c){fe++;const Fe=Ae[Le];let Ie=`J${fe}`;if(Fe)if(Fe.phase==="league")Ie=`J${Fe.matchday}`;else{const at=be[Fe.phase]||Fe.phase;Ie=Fe.total>1?`${at}${Fe.matchday}`:at}ue.push({week:Le,type:"european",number:fe,competitionClass:ce,label:Ie,played:Le<a.currentWeek})}if(oe.has(Le)&&u){const Fe=(Y||[]).indexOf(Le)+1,Ie=PF(Le,o),at=Ie!==null&&a.cupCompetition.rounds?.[Ie]?.name||`Ronda ${Fe}`,je=Ie!==null&&a.cupCompetition.rounds?.[Ie]?.matches?.some(Me=>Me.played);let Ve=at;Ve.length>4&&(Ve=`R${Fe}`),ue.push({week:Le,type:"cup",number:Fe,roundIdx:Ie,competitionClass:"cup",label:Ve,fullLabel:at,played:je||Le<a.currentWeek})}}return ue},[o,a.cupCompetition,a.fixtures,l,c,u,s,r,i,a.currentWeek]),[f,m]=ge.useState(()=>{const X=a.currentWeek||1;let ne=0;for(let Q=0;Q<h.length;Q++){if(h[Q].week===X){ne=Q;break}if(h[Q].week>X){ne=Q;break}ne=Q}return ne});ge.useEffect(()=>{h.length>0&&f>=h.length&&m(h.length-1)},[h,f]);const A=h.length>0?Math.min(Math.max(0,f),h.length-1):0,x=h[A],T=x?.week||a.currentWeek||1;ge.useEffect(()=>{if(!n.current)return;const X=n.current.children[A];X&&X.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[A]);const E=ge.useMemo(()=>x?.type!=="league"?[]:a.fixtures?.filter(X=>X.week===T)||[],[a.fixtures,T,x?.type]),M=ge.useMemo(()=>{if(x?.type!=="european")return[];const X=i?a.saCompetitions:a.europeanCompetitions;if(!X?.competitions)return[];let ne;if(i?(ne=QG()[T]||null,ne&&(ne={phase:ne.phase,matchday:ne.isLeague?ne.matchday:ne.leg,isLeague:ne.isLeague,isKnockout:ne.isKnockout})):ne=hN(T,o),!ne)return[];const{phase:Q,matchday:Y}=ne,ue=[];for(const[pe,Ee]of Object.entries(X.competitions)){if(!Ee||Ee.phase==="completed")continue;const oe=[],Ae={};if((Ee.teams||[]).forEach(be=>{Ae[be.teamId]=be.teamName||be.shortName||be.teamId}),Q==="league"){const be=Ee.matchdays?.[Y-1];if(!be)continue;be.forEach(Ce=>{const ce=Ee.results?.find(te=>te.matchday===Y&&te.homeTeamId===Ce.homeTeamId&&te.awayTeamId===Ce.awayTeamId);oe.push({homeTeamId:Ce.homeTeamId,awayTeamId:Ce.awayTeamId,homeName:Ae[Ce.homeTeamId]||Ce.homeTeamId,awayName:Ae[Ce.awayTeamId]||Ce.awayTeamId,played:!!ce,homeScore:ce?.homeScore??null,awayScore:ce?.awayScore??null,isPlayer:Ce.homeTeamId===a.teamId||Ce.awayTeamId===a.teamId})})}else{let be,Ce;Q==="final"?(be=Ee.finalMatchup?[Ee.finalMatchup]:[],Ce=Ee.finalResult?[Ee.finalResult]:[]):(be=Ee[`${Q}Matchups`]||[],Ce=Ee[`${Q}Results`]||[]),be.forEach((ce,te)=>{const fe=Ce[te],Le=ce.team1?.teamName||ce.team1?.shortName||"???",Fe=ce.team2?.teamName||ce.team2?.shortName||"???",Ie=Q==="final",at=Y===1||Ie,je=at?ce.team1?.teamId:ce.team2?.teamId,Ve=at?ce.team2?.teamId:ce.team1?.teamId,Me=at?Le:Fe,ze=at?Fe:Le;let Je=!1,rt=null,ve=null;if(fe){const Ue=at?fe.leg1:fe.leg2;if(Ue)Je=!0,rt=Ue.homeScore,ve=Ue.awayScore;else if(Ie&&fe.winner&&(Je=!0,fe.aggregate)){const it=fe.aggregate.split("-").map(Number);rt=it[0],ve=it[1]}}oe.push({homeTeamId:je,awayTeamId:Ve,homeName:Me,awayName:ze,played:Je,homeScore:rt,awayScore:ve,isPlayer:je===a.teamId||Ve===a.teamId,knockout:!0,aggregate:fe?.aggregate,winner:fe?.winner?.teamId})})}if(oe.length>0){const be={championsLeague:"champions",europaLeague:"europa",conferenceleague:"conference",copaLibertadores:"champions",copaSudamericana:"europa"};ue.push({compId:pe,name:Ee.config?.name||pe,shortName:Ee.config?.shortName||pe,icon:Ee.config?.icon||"",cssClass:be[pe]||"champions",fixtures:oe})}}return ue},[x?.type,T,a.europeanCompetitions,a.saCompetitions,o,a.teamId,i]),N=ge.useMemo(()=>{if(x?.type!=="cup")return[];if(!a.cupCompetition)return[];const X=x.roundIdx;if(X==null)return[];const ne=a.cupCompetition.rounds?.[X];return ne?ne.matches.map(Q=>({homeTeam:Q.homeTeam,awayTeam:Q.awayTeam,homeName:Q.homeTeam?.teamName||"",awayName:Q.awayTeam?.teamName||"",played:Q.played,homeScore:Q.homeScore,awayScore:Q.awayScore,winnerId:Q.winnerId,bye:Q.bye,penalties:Q.penalties,isPlayer:Q.homeTeam?.teamId===a.teamId||Q.awayTeam?.teamId===a.teamId})):[]},[x?.type,x?.roundIdx,a.cupCompetition,a.teamId]),I=X=>a.leagueTable?.find(Q=>Q.teamId===X)?.teamName||X,F=X=>X?X.replace(/^(FC |CF |CD |UD |RC |SD |CA |RCD )/,"").replace(/( CF| FC| CD| UD| Balompi| de Ftbol)$/,"").trim():"???",G=X=>F(I(X)),O=X=>X.homeTeam===a.teamId||X.awayTeam===a.teamId,D=X=>X.homeTeam===a.teamId,j=X=>{if(!X.played||!O(X))return null;const ne=D(X),Q=ne?X.homeScore:X.awayScore,Y=ne?X.awayScore:X.homeScore;return Q>Y?"W":Q<Y?"L":"D"},L=X=>{if(!X.played||!X.isPlayer)return null;const ne=X.homeTeamId===a.teamId,Q=ne?X.homeScore:X.awayScore,Y=ne?X.awayScore:X.homeScore;return Q>Y?"W":Q<Y?"L":"D"},q=(()=>{if(!x)return{label:"Jornada",sublabel:"1"};const X={league:"Jornada",playoff:"Playoff",r16:"Octavos",qf:"Cuartos",sf:"Semi",final:"Final"};switch(x.type){case"league":return{label:"Jornada",sublabel:String(x.number)};case"european":{let ne;if(i){const Ee=QG()[x.week];Ee&&(ne={phase:Ee.phase,matchday:Ee.isLeague?Ee.matchday:Ee.leg,total:Ee.isLeague?8:Vp[Ee.phase]?.length||1})}else ne=hN(x.week,o);const Q=e(i?"calendar.southAmerican":"calendar.european"),Y=ne?X[ne.phase]||ne.phase:Q,ue=ne&&(ne.phase==="league"||ne.total>1)?String(ne.matchday):"";return{label:Y,sublabel:ue||x.label}}case"cup":return{label:e("calendar.cup"),sublabel:x.fullLabel||x.label};default:return{label:e("calendar.week"),sublabel:String(x.week)}}})(),K=(X,{homeName:ne,awayName:Q,homeIsPlayer:Y,awayIsPlayer:ue,played:pe,homeScore:Ee,awayScore:oe,playerResult:Ae,statusType:be,extraClass:Ce,penalties:ce})=>d.jsxs("div",{className:`fixture-card ${Y||ue?"is-player":""} ${pe?"played":""} ${Ce||""}`,children:[d.jsx("div",{className:`team home ${Y?"is-you":""}`,children:d.jsx("span",{className:"team-name",children:ne})}),d.jsx("div",{className:"match-center",children:pe?d.jsxs("div",{className:`score ${Ae?`result-${Ae.toLowerCase()}`:""}`,children:[d.jsx("span",{className:"home-score",children:Ee}),d.jsx("span",{className:"separator",children:"-"}),d.jsx("span",{className:"away-score",children:oe}),ce&&d.jsx("span",{className:"penalties-tag",children:"(Pen)"})]}):d.jsx("div",{className:"vs-badge",children:d.jsx("span",{children:"vs"})})}),d.jsx("div",{className:`team away ${ue?"is-you":""}`,children:d.jsx("span",{className:"team-name",children:Q})}),d.jsx("div",{className:"match-status",children:pe?d.jsx("span",{className:`status-dot ${Ae==="W"?"win":Ae==="L"?"loss":Ae==="D"?"draw":"neutral"}`}):be==="pending"?d.jsx("span",{className:"status-badge pending",children:d.jsx(or,{size:14})}):be==="missed"?d.jsx("span",{className:"status-badge missed",children:"!"}):d.jsx("span",{className:"status-badge upcoming",children:d.jsx(Yp,{size:10})})})]},X),H=()=>T===a.currentWeek?"pending":T<a.currentWeek?"missed":"upcoming";return d.jsxs("div",{className:"calendar-v2",children:[d.jsxs("div",{className:"calendar-v2__header",children:[d.jsxs("h2",{children:[d.jsx(tSe,{size:24})," Calendario"]}),d.jsxs("div",{className:"header-badges",children:[d.jsx("span",{className:"league-badge",children:BAe(a.leagueId)}),d.jsxs("span",{className:"season-badge",children:["Temporada ",a.currentSeason||1]})]})]}),d.jsxs("div",{className:"calendar-v2__nav",children:[d.jsx("button",{className:"nav-btn",onClick:()=>m(Math.max(0,A-1)),disabled:A<=0,children:d.jsx(OZ,{size:20})}),d.jsxs("div",{className:"nav-title",children:[d.jsx("span",{className:"week-label",children:q.label}),d.jsx("span",{className:"week-number",children:q.sublabel})]}),d.jsx("button",{className:"nav-btn",onClick:()=>m(Math.min(h.length-1,A+1)),disabled:A>=h.length-1,children:d.jsx(_r,{size:20})})]}),d.jsx("div",{className:"calendar-v2__carousel",ref:n,children:h.map((X,ne)=>d.jsx("button",{className:["carousel-btn",`carousel-btn--${X.type}`,X.competitionClass&&`carousel-btn--${X.competitionClass}`,ne===A&&"selected",X.week===a.currentWeek&&"current",X.played&&"played"].filter(Boolean).join(" "),onClick:()=>m(ne),title:X.type==="cup"?X.fullLabel:X.type==="european"?i?`Sudamericana ${X.label}`:`Europa ${X.label}`:`Jornada ${X.number}`,children:X.label},`${X.type}-${X.week}`))}),d.jsxs("div",{className:"calendar-v2__fixtures",children:[x?.type==="league"&&(E.length===0?d.jsxs("div",{className:"no-fixtures",children:[d.jsx(Yp,{size:48}),d.jsx("p",{children:"No hay partidos en esta jornada"})]}):E.map((X,ne)=>{O(X);const Q=j(X);return K(X.id||ne,{homeName:G(X.homeTeam),awayName:G(X.awayTeam),homeIsPlayer:X.homeTeam===a.teamId,awayIsPlayer:X.awayTeam===a.teamId,played:X.played,homeScore:X.homeScore,awayScore:X.awayScore,playerResult:Q,statusType:H()})})),x?.type==="european"&&(M.length===0?d.jsxs("div",{className:"no-fixtures",children:[d.jsx(Yp,{size:48}),d.jsx("p",{children:e(i?"calendar.noSouthAmericanMatches":"calendar.noEuropeanMatches")})]}):M.map(X=>d.jsxs("div",{className:"competition-section",children:[d.jsxs("div",{className:`competition-badge competition-badge--${X.cssClass}`,children:[d.jsx("span",{className:"comp-icon",children:X.icon}),d.jsx("span",{className:"comp-name",children:X.shortName})]}),X.fixtures.map((ne,Q)=>{const Y=L(ne);return K(`${X.compId}-${Q}`,{homeName:F(ne.homeName),awayName:F(ne.awayName),homeIsPlayer:ne.homeTeamId===a.teamId,awayIsPlayer:ne.awayTeamId===a.teamId,played:ne.played,homeScore:ne.homeScore,awayScore:ne.awayScore,playerResult:Y,statusType:H(),extraClass:`euro-fixture euro-fixture--${X.cssClass}`})})]},X.compId))),x?.type==="cup"&&(N.length===0?d.jsxs("div",{className:"no-fixtures",children:[d.jsx(Yp,{size:48}),d.jsx("p",{children:e("calendar.noCupMatches")})]}):d.jsxs("div",{className:"competition-section",children:[d.jsxs("div",{className:"competition-badge competition-badge--cup",children:[d.jsx("span",{className:"comp-icon",children:a.cupCompetition?.config?.icon||""}),d.jsx("span",{className:"comp-name",children:a.cupCompetition?.config?.shortName||"Copa"}),d.jsx("span",{className:"comp-phase",children:x.fullLabel})]}),N.map((X,ne)=>{if(X.bye)return K(`cup-bye-${ne}`,{homeName:F(X.homeName),awayName:"",homeIsPlayer:X.homeTeam?.teamId===a.teamId,awayIsPlayer:!1,played:!0,homeScore:null,awayScore:null,playerResult:X.isPlayer?"W":null,statusType:"played",extraClass:"cup-fixture"});const Q=X.isPlayer&&X.winnerId===a.teamId;X.isPlayer&&X.played&&(X.winnerId,a.teamId);const Y=X.played&&X.isPlayer?Q?"W":"L":null;return K(`cup-${ne}`,{homeName:F(X.homeName),awayName:F(X.awayName),homeIsPlayer:X.homeTeam?.teamId===a.teamId,awayIsPlayer:X.awayTeam?.teamId===a.teamId,played:X.played,homeScore:X.homeScore,awayScore:X.awayScore,playerResult:Y,statusType:H(),extraClass:"cup-fixture",penalties:X.penalties})})]}))]})]})}function Tle({value:a,onChange:e,options:n=[],placeholder:i="Seleccionar...",searchable:s,searchPlaceholder:r="Buscar...",compact:o=!1,className:l=""}){const[c,u]=ge.useState(!1),[h,f]=ge.useState(""),[m,A]=ge.useState(-1),x=ge.useRef(null),T=ge.useRef(null),E=ge.useRef(null),M=ge.useMemo(()=>{const U=[];for(const q of n)if(q.group)for(const K of q.items||[])U.push({...K,groupLabel:q.group,groupIcon:q.icon});else U.push(q);return U},[n]),N=s!==void 0?s:M.length>10,I=M.find(U=>U.value===a),F=ge.useMemo(()=>{const U=h.toLowerCase().trim(),q=[];for(const K of n)if(K.group){const H=U?K.items.filter(X=>X.label.toLowerCase().includes(U)||X.icon&&X.icon.toLowerCase().includes(U)||K.group.toLowerCase().includes(U)):K.items;H.length>0&&q.push({...K,items:H})}else(!U||K.label.toLowerCase().includes(U))&&q.push(K);return q},[n,h]),G=ge.useMemo(()=>{const U=[];for(const q of F)if(q.group)for(const K of q.items||[])U.push(K);else U.push(q);return U},[F]);ge.useEffect(()=>{const U=q=>{x.current&&!x.current.contains(q.target)&&(u(!1),f(""))};if(c)return document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[c]),ge.useEffect(()=>{c&&N&&T.current&&T.current.focus()},[c,N]),ge.useEffect(()=>{if(c&&E.current&&a){const U=E.current.querySelector(".custom-select__option.active");U&&U.scrollIntoView({block:"nearest"})}},[c,a]);const O=U=>{if(!c){["Enter"," ","ArrowDown"].includes(U.key)&&(U.preventDefault(),u(!0),A(G.findIndex(q=>q.value===a)));return}switch(U.key){case"ArrowDown":U.preventDefault(),A(q=>Math.min(q+1,G.length-1));break;case"ArrowUp":U.preventDefault(),A(q=>Math.max(q-1,0));break;case"Enter":U.preventDefault(),m>=0&&m<G.length&&D(G[m].value);break;case"Escape":u(!1),f("");break}};ge.useEffect(()=>{if(c&&E.current&&m>=0){const U=E.current.querySelectorAll(".custom-select__option");U[m]&&U[m].scrollIntoView({block:"nearest"})}},[m,c]);const D=U=>{e(U),u(!1),f(""),A(-1)},j=()=>{u(U=>!U),c&&(f(""),A(-1))};let L=-1;return d.jsxs("div",{ref:x,className:`custom-select ${c?"open":""} ${o?"compact":""} ${l}`,onKeyDown:O,children:[d.jsxs("button",{type:"button",className:"custom-select__trigger",onClick:j,"aria-expanded":c,"aria-haspopup":"listbox",children:[d.jsx("span",{className:"custom-select__trigger-text",children:I?d.jsxs(d.Fragment,{children:[I.icon&&d.jsx("span",{className:"custom-select__icon",children:I.icon}),I.label]}):d.jsx("span",{className:"custom-select__placeholder",children:i})}),d.jsx(S0,{size:o?14:16,className:"custom-select__chevron"})]}),c&&d.jsxs("div",{className:"custom-select__dropdown",children:[N&&d.jsxs("div",{className:"custom-select__search",children:[d.jsx(T0,{size:14}),d.jsx("input",{ref:T,type:"text",placeholder:r,value:h,onChange:U=>{f(U.target.value),A(0)},onClick:U=>U.stopPropagation()})]}),d.jsxs("div",{ref:E,className:"custom-select__list",role:"listbox",children:[F.length===0&&d.jsx("div",{className:"custom-select__empty",children:"Sin resultados"}),F.map((U,q)=>{if(U.group)return d.jsxs("div",{className:"custom-select__group",children:[d.jsxs("div",{className:"custom-select__group-label",children:[U.icon&&d.jsx("span",{className:"custom-select__group-icon",children:U.icon}),U.group]}),U.items.map(K=>{L++;const H=L;return d.jsxs("button",{type:"button",role:"option","aria-selected":K.value===a,className:`custom-select__option ${K.value===a?"active":""} ${H===m?"highlighted":""}`,onClick:()=>D(K.value),onMouseEnter:()=>A(H),children:[K.icon&&d.jsx("span",{className:"custom-select__option-icon",children:K.icon}),d.jsx("span",{className:"custom-select__option-label",children:K.label}),K.value===a&&d.jsx("span",{className:"custom-select__check",children:""})]},K.value)})]},`g-${q}`);{L++;const K=L;return d.jsxs("button",{type:"button",role:"option","aria-selected":U.value===a,className:`custom-select__option ${U.value===a?"active":""} ${K===m?"highlighted":""}`,onClick:()=>D(U.value),onMouseEnter:()=>A(K),children:[U.icon&&d.jsx("span",{className:"custom-select__option-icon",children:U.icon}),d.jsx("span",{className:"custom-select__option-label",children:U.label}),U.value===a&&d.jsx("span",{className:"custom-select__check",children:""})]},U.value)}})]})]})]})}const y6={laliga:{name:"Liga Ibrica",champions:[1,2,3,4],europaLeague:[5,6],conference:[7],relegation:[18,19,20],teams:20},segunda:{name:"Segunda Divisin",promotion:[1,2],playoff:[3,4,5,6],relegation:[19,20,21,22],teams:22},primeraRFEF:{name:"Primera Federacin",isGroupLeague:!0,promotion:[1],playoff:[2,3,4,5],relegation:[],relegationFromBottom:5,teams:0},segundaRFEF:{name:"Segunda Federacin",isGroupLeague:!0,promotion:[1],playoff:[2,3,4,5],relegation:[],teams:0},premierLeague:{name:"First League",champions:[1,2,3,4],europaLeague:[5],conference:[6,7],relegation:[18,19,20],teams:20},serieA:{name:"Calcio League",champions:[1,2,3,4],europaLeague:[5,6],conference:[7],relegation:[18,19,20],teams:20},bundesliga:{name:"Erste Liga",champions:[1,2,3,4],europaLeague:[5,6],conference:[7],relegation:[16,17,18],teams:18},ligue1:{name:"Division Premire",champions:[1,2,3],europaLeague:[4],conference:[5],relegation:[16,17,18],teams:18},championship:{name:"Second League",promotion:[1,2],playoff:[3,4,5,6],relegation:[22,23,24],teams:24},serieB:{name:"Calcio B",promotion:[1,2],playoff:[3,4,5,6,7,8],relegation:[18,19,20],teams:20},bundesliga2:{name:"Zweite Liga",promotion:[1,2],playoff:[3],relegation:[16,17,18],teams:18},ligue2:{name:"Division Seconde",promotion:[1,2],playoff:[3,4,5],relegation:[16,17,18],teams:18},eredivisie:{name:"Dutch First",champions:[1],europaLeague:[2,3],conference:[4],relegation:[16,17,18],teams:18},primeiraLiga:{name:"Liga Lusitana",champions:[1],europaLeague:[2,3],conference:[4],relegation:[16,17,18],teams:18},belgianPro:{name:"Belgian First",champions:[1],europaLeague:[2],conference:[3],relegation:[15,16],teams:16},superLig:{name:"Anatolian League",champions:[1],europaLeague:[2,3],conference:[4],relegation:[16,17,18],teams:18},scottishPrem:{name:"Highland League",champions:[1],europaLeague:[2],conference:[3],relegation:[11,12],teams:12},swissSuperLeague:{name:"Alpine League",champions:[1],europaLeague:[2],conference:[3],relegation:[11,12],teams:12},austrianBundesliga:{name:"Erste Liga (AT)",champions:[1],europaLeague:[2],conference:[3],relegation:[11,12],teams:12},greekSuperLeague:{name:"Super League",champions:[1],europaLeague:[2],conference:[3],relegation:[13,14],teams:14},danishSuperliga:{name:"Superligaen",champions:[1],europaLeague:[2],conference:[3],relegation:[11,12],teams:12},croatianLeague:{name:"HNL",champions:[1],europaLeague:[2],conference:[3],relegation:[9,10],teams:10},czechLeague:{name:"Chance Liga",champions:[1],europaLeague:[2],conference:[3],relegation:[15,16],teams:16},argentinaPrimera:{name:"Liga Profesional",libertadores:[1,2,3,4],sudamericana:[5,6],relegation:[25,26,27,28],teams:28},brasileiraoA:{name:"Srie A",libertadores:[1,2,3,4],sudamericana:[5,6,7,8],relegation:[17,18,19,20],teams:20},colombiaPrimera:{name:"Liga BetPlay",libertadores:[1,2,3],sudamericana:[4,5,6],relegation:[18,19,20],teams:20},chilePrimera:{name:"Primera Divisin (CL)",libertadores:[1,2],sudamericana:[3,4],relegation:[14,15,16],teams:16},uruguayPrimera:{name:"Primera Divisin (UY)",libertadores:[1,2],sudamericana:[3,4],relegation:[14,15,16],teams:16},ecuadorLigaPro:{name:"LigaPro",libertadores:[1,2],sudamericana:[3,4],relegation:[14,15,16],teams:16},paraguayPrimera:{name:"Divisin de Honor",libertadores:[1],sudamericana:[2,3],relegation:[11,12],teams:12},peruLiga1:{name:"Liga 1",libertadores:[1,2],sudamericana:[3,4],relegation:[16,17,18],teams:18},boliviaPrimera:{name:"Divisin Profesional",libertadores:[1],sudamericana:[2,3],relegation:[14,15,16],teams:16},venezuelaPrimera:{name:"Liga FUTVE",libertadores:[1,2],sudamericana:[3,4],relegation:[16,17,18],teams:18}};function pJe(){const{state:a,dispatch:e}=Va(),{t:n}=Sa(),i=a.playerLeagueId||"laliga",[s,r]=ge.useState(i),[o,l]=ge.useState(null),[c,u]=ge.useState(!1),[h,f]=ge.useState("current");ge.useEffect(()=>{if(!a.gameStarted)return;if(!a.otherLeagues||Object.keys(a.otherLeagues).length===0||Object.values(a.otherLeagues).every(X=>X.isGroupLeague?!X.groups||Object.keys(X.groups).length===0:!X.table||X.table.length===0)){console.log("Inicializando otras ligas...");let ne=kx(i,a.playerGroupId);for(let Q=1;Q<(a.currentWeek||1);Q++)ne=nZ(ne,Q);e({type:"SET_OTHER_LEAGUES",payload:ne})}},[a.gameStarted,a.otherLeagues,i,a.currentWeek,e]);const m=y6[s]?.isGroupLeague||a.otherLeagues?.[s]?.isGroupLeague||Wa[s]?.isGroupLeague,A=a.playerGroupId,x=ge.useMemo(()=>{if(!m)return[];const H=a.otherLeagues?.[s],X=H?.groups?Object.keys(H.groups):[];return s===i&&A&&(X.includes(A)||X.push(A)),X.sort()},[m,s,i,A,a.otherLeagues]);ge.useEffect(()=>{m&&x.length>0&&!x.includes(o)?l(x[0]):m||l(null)},[m,x,o]);const T=ge.useMemo(()=>{if(m){if(s===i&&o===A)return a.leagueTable||[];const H=a.otherLeagues?.[s];return!H?.groups||!o?[]:H.groups[o]?.table||[]}return s===i?a.leagueTable||[]:a.otherLeagues?.[s]?.table||[]},[s,o,m,i,A,a.leagueTable,a.otherLeagues]),E=Jg(s),M=ge.useMemo(()=>{if(!E)return null;if(s===i)return{aperturaTable:a.aperturaTable,currentTournament:a.currentTournament||"apertura",currentTable:a.leagueTable||[]};const H=a.otherLeagues?.[s];return H?{aperturaTable:H.aperturaTable,accumulatedTable:H.accumulatedTable,currentTournament:H.currentTournament||"apertura",currentTable:H.table||[]}:null},[E,s,i,a.aperturaTable,a.currentTournament,a.leagueTable,a.otherLeagues]),N=ge.useMemo(()=>{if(!E||!M)return T;const H=h==="current"?M.currentTournament:h;return H==="apertura"?M.currentTournament==="apertura"?M.currentTable:M.aperturaTable||[]:H==="clausura"?M.currentTournament==="clausura"?M.currentTable:[]:H==="acumulada"?M.accumulatedTable?M.accumulatedTable:M.aperturaTable?WAe(M.aperturaTable,M.currentTable):M.currentTable:T},[E,M,h,T]);ge.useEffect(()=>{f("current")},[s]);const I=y6[s]||y6.laliga,F=s===i,G=E?h==="current"?M?.currentTournament||"apertura":h:null,O=!E||G==="acumulada",D=H=>E&&!O?"":I.champions?.includes(H)||I.libertadores?.includes(H)?"champions":I.europaLeague?.includes(H)||I.sudamericana?.includes(H)?"europa":I.conference?.includes(H)?"conference":I.promotion?.includes(H)?"promotion":I.playoff?.includes(H)?"playoff":I.relegation?.includes(H)||I.relegationFromBottom&&N.length>0&&H>N.length-I.relegationFromBottom?"relegation":"",j=H=>{if(!H)return"??";const X=H.split(" ").filter(ne=>!["CF","FC","CD","UD","RC","SD","CA","Real","Atltico","Athletic","Deportivo"].includes(ne));return X.length===0?H.substring(0,3).toUpperCase():X.length===1?X[0].substring(0,3).toUpperCase():X.slice(0,2).map(ne=>ne[0]).join("").toUpperCase()},L=E?N:T,U=c?L:L.slice(0,10),q=L.findIndex(H=>H.isPlayer)+1,K=L.length>0;return d.jsxs("div",{className:"league-table-v2",children:[d.jsxs("div",{className:"league-table-v2__header",children:[d.jsxs("h2",{children:[d.jsx(Ai,{size:24}),n("leagueTable.title")]}),d.jsx("div",{className:"league-selector",children:d.jsx(Tle,{value:s,onChange:H=>{r(H),u(!1),l(null)},searchPlaceholder:n("leagueTable.searchLeague"),options:[{group:n("leagueTable.countries.spain"),icon:"",items:[{value:"laliga",label:"Liga Ibrica"},{value:"segunda",label:"Segunda Ibrica"},{value:"primeraRFEF",label:"Primera Federacin"},{value:"segundaRFEF",label:"Segunda Federacin"}]},{group:n("leagueTable.countries.england"),icon:"",items:[{value:"premierLeague",label:"First League"},{value:"championship",label:"Second League"}]},{group:n("leagueTable.countries.italy"),icon:"",items:[{value:"serieA",label:"Calcio League"},{value:"serieB",label:"Calcio B"}]},{group:n("leagueTable.countries.germany"),icon:"",items:[{value:"bundesliga",label:"Erste Liga"},{value:"bundesliga2",label:"Zweite Liga"}]},{group:n("leagueTable.countries.france"),icon:"",items:[{value:"ligue1",label:"Division Premire"},{value:"ligue2",label:"Division Seconde"}]},{group:n("leagueTable.countries.restOfEurope"),icon:"",items:[{value:"eredivisie",icon:"",label:"Dutch First"},{value:"primeiraLiga",icon:"",label:"Liga Lusitana"},{value:"belgianPro",icon:"",label:"Belgian First"},{value:"superLig",icon:"",label:"Anatolian League"},{value:"scottishPrem",icon:"",label:"Highland League"},{value:"swissSuperLeague",icon:"",label:"Alpine League"},{value:"austrianBundesliga",icon:"",label:"Erste Liga (AT)"},{value:"greekSuperLeague",icon:"",label:"Super League"},{value:"danishSuperliga",icon:"",label:"Superligaen"},{value:"croatianLeague",icon:"",label:"HNL"},{value:"czechLeague",icon:"",label:"Chance Liga"}]},{group:n("leagueTable.countries.southAmerica"),icon:"",items:[{value:"argentinaPrimera",icon:"",label:"Liga Profesional"},{value:"brasileiraoA",icon:"",label:"Srie A"},{value:"colombiaPrimera",icon:"",label:"Liga BetPlay"},{value:"chilePrimera",icon:"",label:"Primera Divisin"},{value:"uruguayPrimera",icon:"",label:"Primera Divisin"},{value:"ecuadorLigaPro",icon:"",label:"LigaPro"},{value:"paraguayPrimera",icon:"",label:"Divisin de Honor"},{value:"peruLiga1",icon:"",label:"Liga 1"},{value:"boliviaPrimera",icon:"",label:"Div. Profesional"},{value:"venezuelaPrimera",icon:"",label:"Liga FUTVE"}]}]})})]}),F&&d.jsxs("div",{className:"league-table-v2__player-badge",children:[" ",n("leagueTable.yourLeague")]}),!K&&d.jsxs("div",{className:"league-table-v2__no-data",children:[d.jsx(dc,{size:48}),d.jsx("p",{children:n("leagueTable.noData")}),d.jsx("p",{className:"hint",children:n("leagueTable.noDataHint")})]}),m&&x.length>0&&d.jsx("div",{className:"league-table-v2__group-tabs",children:x.map(H=>d.jsxs("button",{className:`group-tab ${o===H?"active":""}`,onClick:()=>{l(H),u(!1)},children:[n("leagueTable.group")," ",H.replace("grupo","")]},H))}),E&&K&&d.jsxs("div",{className:"league-table-v2__tournament-tabs",children:[(()=>{const H=s===i?null:a.otherLeagues?.[s],X=s===i?a.aperturaClausuraFinal:H?.finalResult;return X?.winner?d.jsxs("div",{className:"tournament-indicator tournament-champion",children:[" ",n("leagueTable.championLabel"),": ",d.jsx("strong",{children:X.winnerName}),X.hadFinal&&d.jsxs("span",{className:"final-score",children:[" ","(",n("leagueTable.firstLeg"),": ",X.leg1?.homeScore,"-",X.leg1?.awayScore,", ",n("leagueTable.secondLeg"),": ",X.leg2?.homeScore,"-",X.leg2?.awayScore,")"]}),!X.hadFinal&&d.jsxs("span",{children:["  ",n("leagueTable.bothTournamentsChampion")]})]}):d.jsxs("div",{className:"tournament-indicator",children:[" ",M?.currentTournament==="apertura"?n("leagueTable.apertura"):n("leagueTable.clausura")," ",n("leagueTable.inProgress")]})})(),d.jsxs("div",{className:"tournament-tab-buttons",children:[d.jsxs("button",{className:`tournament-tab ${(h==="current"?M?.currentTournament:h)==="apertura"?"active":""} ${M?.currentTournament==="apertura"?"is-live":""}`,onClick:()=>f("apertura"),children:[n("leagueTable.apertura"),M?.currentTournament==="apertura"&&d.jsx("span",{className:"live-dot"})]}),d.jsxs("button",{className:`tournament-tab ${(h==="current"?M?.currentTournament:h)==="clausura"?"active":""} ${M?.currentTournament==="clausura"?"is-live":""}`,onClick:()=>f("clausura"),disabled:M?.currentTournament==="apertura",children:[n("leagueTable.clausura"),M?.currentTournament==="clausura"&&d.jsx("span",{className:"live-dot"})]}),d.jsx("button",{className:`tournament-tab ${(h==="current"?"":h)==="acumulada"?"active":""}`,onClick:()=>f("acumulada"),disabled:M?.currentTournament==="apertura",children:n("leagueTable.acumulada")})]})]}),K&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"league-table-v2__legend",children:[I.champions&&O&&d.jsxs("span",{className:"legend-item champions",children:[d.jsx("span",{className:"dot"})," ",n("leagueTable.championsLeague")]}),I.libertadores&&O&&d.jsxs("span",{className:"legend-item champions",children:[d.jsx("span",{className:"dot"})," ",n("leagueTable.libertadores")]}),I.europaLeague&&O&&d.jsxs("span",{className:"legend-item europa",children:[d.jsx("span",{className:"dot"})," ",n("leagueTable.europaLeague")]}),I.sudamericana&&O&&d.jsxs("span",{className:"legend-item europa",children:[d.jsx("span",{className:"dot"})," ",n("leagueTable.sudamericana")]}),I.conference&&O&&d.jsxs("span",{className:"legend-item conference",children:[d.jsx("span",{className:"dot"})," ",n("leagueTable.conferenceLeague")]}),I.promotion&&O&&d.jsxs("span",{className:"legend-item promotion",children:[d.jsx("span",{className:"dot"})," ",n("leagueTable.promotion")]}),I.playoff&&O&&d.jsxs("span",{className:"legend-item playoff",children:[d.jsx("span",{className:"dot"})," ",n("leagueTable.playoffPromotion")]}),O&&d.jsxs("span",{className:"legend-item relegation",children:[d.jsx("span",{className:"dot"})," ",n("leagueTable.relegation")]})]}),d.jsxs("div",{className:"league-table-v2__table",children:[d.jsxs("div",{className:"table-header",children:[d.jsx("span",{className:"col-pos",children:"#"}),d.jsx("span",{className:"col-team",children:n("leagueTable.team")}),d.jsx("span",{className:"col-pj",children:n("leagueTable.played")}),d.jsx("span",{className:"col-w",children:n("leagueTable.won")}),d.jsx("span",{className:"col-d",children:n("leagueTable.drawn")}),d.jsx("span",{className:"col-l",children:n("leagueTable.lost")}),d.jsx("span",{className:"col-gf",children:n("leagueTable.goalsFor")}),d.jsx("span",{className:"col-ga",children:n("leagueTable.goalsAgainst")}),d.jsx("span",{className:"col-gd",children:n("leagueTable.goalDifference")}),d.jsx("span",{className:"col-pts",children:n("leagueTable.points")}),d.jsx("span",{className:"col-form",children:n("leagueTable.form")})]}),d.jsx("div",{className:"table-body",children:U.map((H,X)=>{const ne=X+1,Q=D(ne);return d.jsxs("div",{className:`table-row ${Q} ${H.isPlayer?"is-player":""}`,children:[d.jsx("span",{className:"col-pos",children:d.jsx("span",{className:`pos-badge ${Q}`,children:ne})}),d.jsxs("span",{className:"col-team",children:[d.jsx("span",{className:"team-badge",children:j(H.teamName)}),d.jsxs("span",{className:"team-info",children:[d.jsx("span",{className:"team-name",children:H.teamName}),(H.form||[]).length>0&&d.jsx("span",{className:"team-form-mobile",children:(H.form||[]).slice(-5).map((Y,ue)=>d.jsx("span",{className:`form-pip form-${Y?.toLowerCase()}`},ue))})]})]}),d.jsx("span",{className:"col-pj",children:H.played||0}),d.jsx("span",{className:"col-w",children:H.won}),d.jsx("span",{className:"col-d",children:H.drawn}),d.jsx("span",{className:"col-l",children:H.lost}),d.jsx("span",{className:"col-gf",children:H.goalsFor||0}),d.jsx("span",{className:"col-ga",children:H.goalsAgainst||0}),d.jsxs("span",{className:`col-gd ${H.goalDifference>0?"positive":H.goalDifference<0?"negative":""}`,children:[H.goalDifference>0?"+":"",H.goalDifference]}),d.jsx("span",{className:"col-pts",children:H.points}),d.jsx("span",{className:"col-form",children:(H.form||[]).slice(-5).map((Y,ue)=>d.jsx("span",{className:`form-dot form-${Y?.toLowerCase()}`,children:n(Y==="W"?"leagueTable.formW":Y==="L"?"leagueTable.formL":"leagueTable.formD")},ue))})]},H.teamId)})}),!c&&L.length>10&&d.jsxs(d.Fragment,{children:[F&&q>10&&d.jsxs("div",{className:"player-position-indicator",children:[d.jsx("span",{className:"dots",children:""}),d.jsxs("div",{className:`table-row is-player ${D(q)}`,children:[d.jsx("span",{className:"col-pos",children:d.jsx("span",{className:`pos-badge ${D(q)}`,children:q})}),d.jsxs("span",{className:"col-team",children:[d.jsx("span",{className:"team-badge",children:j(L[q-1]?.teamName)}),d.jsx("span",{className:"team-name",children:L[q-1]?.teamName})]}),d.jsx("span",{className:"col-pj",children:L[q-1]?.played||0}),d.jsx("span",{className:"col-w",children:L[q-1]?.won}),d.jsx("span",{className:"col-d",children:L[q-1]?.drawn}),d.jsx("span",{className:"col-l",children:L[q-1]?.lost}),d.jsx("span",{className:"col-gf",children:L[q-1]?.goalsFor||0}),d.jsx("span",{className:"col-ga",children:L[q-1]?.goalsAgainst||0}),d.jsxs("span",{className:"col-gd",children:[L[q-1]?.goalDifference>0?"+":"",L[q-1]?.goalDifference]}),d.jsx("span",{className:"col-pts",children:L[q-1]?.points}),d.jsx("span",{className:"col-form",children:(L[q-1]?.form||[]).slice(-5).map((H,X)=>d.jsx("span",{className:`form-dot form-${H?.toLowerCase()}`,children:n(H==="W"?"leagueTable.formW":H==="L"?"leagueTable.formL":"leagueTable.formD")},X))})]}),d.jsx("span",{className:"dots",children:""})]}),d.jsxs("button",{className:"show-more-btn",onClick:()=>u(!0),children:[d.jsx(S0,{size:16}),n("leagueTable.showAllTeams",{count:L.length})]})]}),c&&L.length>10&&d.jsxs("button",{className:"show-more-btn",onClick:()=>u(!1),children:[d.jsx(jT,{size:16}),n("leagueTable.showLess")]})]})]})]})}function Kv({value:a,onChange:e,step:n=5e5,min:i=0,max:s,disabled:r,suffix:o="",prefix:l=""}){const[c,u]=ge.useState(null),h=ge.useRef(null),f=ge.useRef(0),m=ge.useRef(a);ge.useEffect(()=>{m.current=a},[a]);const A=I=>{if(I<1e6)return`${Math.round(I/1e3)}K`;const F=I/1e6;if(F>=100)return`${Math.round(F)}M`;const G=F.toFixed(1),O=F.toFixed(2);return O.endsWith("0")?`${G}M`:`${O}M`},x=I=>I<1e6?5e4:I<5e6?1e5:I<2e7?25e4:I<5e7?5e5:1e6,T=ge.useCallback(I=>{let F=Math.max(i,I);return s!==void 0&&(F=Math.min(s,F)),F},[i,s]),E=ge.useCallback((I,F=1)=>{const G=m.current,O=x(G),D=T(I==="up"?G+O*F:G-O*F);m.current=D,e(D)},[T,e]),M=ge.useCallback(I=>{if(r)return;f.current=0,E(I),u(I);const F=setTimeout(()=>{const G=setInterval(()=>{f.current++;const O=f.current;let D=1;O>40?D=3:O>15&&(D=2),E(I,D)},150);h.current=G},500);h.current=F},[r,E]),N=ge.useCallback(()=>{u(null),f.current=0,h.current&&(clearTimeout(h.current),clearInterval(h.current),h.current=null)},[]);return ge.useEffect(()=>()=>{h.current&&(clearTimeout(h.current),clearInterval(h.current))},[]),d.jsxs("div",{className:`money-input ${r?"disabled":""}`,children:[d.jsx("button",{className:`money-btn minus ${c==="down"?"active":""}`,onMouseDown:()=>M("down"),onMouseUp:N,onMouseLeave:N,onTouchStart:()=>M("down"),onTouchEnd:N,disabled:r||a<=i,children:""}),d.jsxs("div",{className:"money-display",children:[d.jsx("span",{className:"money-prefix",children:l}),d.jsx("span",{className:"money-value",children:A(a)}),o&&d.jsx("span",{className:"money-suffix",children:o})]}),d.jsx("button",{className:`money-btn plus ${c==="up"?"active":""}`,onMouseDown:()=>M("up"),onMouseUp:N,onMouseLeave:N,onTouchStart:()=>M("up"),onTouchEnd:N,disabled:r||s!==void 0&&a>=s,children:"+"})]})}const l8={4:{name:"Elite Mundial",prestige:95,wageMultiplier:2,attractiveness:1,teams:["Real Madrid","Barcelona","Manchester City","Bayern Mnchen","PSG"]},3:{name:"Top Europeo",prestige:80,wageMultiplier:1.5,attractiveness:.85,teams:["Liverpool","Chelsea","Arsenal","Manchester United","Atltico Madrid","Juventus","Inter","Milan","Borussia Dortmund","Tottenham","Napoli"]},2:{name:"Primera Divisin",prestige:60,wageMultiplier:1,attractiveness:.65,teams:["Sevilla","Real Sociedad","Athletic Club","Villarreal","Valencia","Real Betis","West Ham","Newcastle","Aston Villa","Brighton","Roma","Lazio","Atalanta","Fiorentina","RB Leipzig","Bayer Leverkusen","Olympique Lyon","Monaco","Marseille"]},1:{name:"Modesto",prestige:40,wageMultiplier:.7,attractiveness:.4,teams:["Rayo Vallecano","Getafe","Osasuna","Celta Vigo","Mallorca","Girona","Alavs","Espanyol","Valladolid","Elche","Bournemouth","Fulham","Wolves","Crystal Palace","Brentford","Nottingham Forest","Everton","Leicester City"]},0:{name:"Menor",prestige:20,wageMultiplier:.4,attractiveness:.2,teams:[]}};function Zd(a){for(const[e,n]of Object.entries(l8))if(n.teams.includes(a))return parseInt(e);return 0}function $Y(a){return l8[a]||l8[0]}const iy={ambitious:{name:"Ambicioso",nameKey:"transfers.persAmbitious",icon:"",desc:"Quiere jugar en los mejores equipos",descKey:"transfers.persDescAmbitious",tierUpBonus:.3,tierDownPenalty:-.4,moneyInfluence:.3,loyaltyFactor:.5},loyal:{name:"Leal",nameKey:"transfers.persLoyal",icon:"",desc:"Muy difcil que deje su club",descKey:"transfers.persDescLoyal",tierUpBonus:.1,tierDownPenalty:-.2,moneyInfluence:.2,loyaltyFactor:1.5},mercenary:{name:"Mercenario",nameKey:"transfers.persMercenary",icon:"",desc:"Solo le importa el dinero",descKey:"transfers.persDescMercenary",tierUpBonus:.1,tierDownPenalty:0,moneyInfluence:.9,loyaltyFactor:.3},homesick:{name:"Familiar",nameKey:"transfers.persHomesick",icon:"",desc:"Prefiere estar cerca de casa",descKey:"transfers.persDescHomesick",tierUpBonus:0,tierDownPenalty:-.1,moneyInfluence:.4,loyaltyFactor:1.2,prefersLocal:!0},professional:{name:"Profesional",nameKey:"transfers.persProfessional",icon:"",desc:"Evala todo con equilibrio",descKey:"transfers.persDescProfessional",tierUpBonus:.15,tierDownPenalty:-.15,moneyInfluence:.5,loyaltyFactor:.8},adventurous:{name:"Aventurero",nameKey:"transfers.persAdventurous",icon:"",desc:"Le gusta cambiar de aires",descKey:"transfers.persDescAdventurous",tierUpBonus:.2,tierDownPenalty:.05,moneyInfluence:.4,loyaltyFactor:.4}};function wle(a){const e={ambitious:a.overall>=80?.3:.15,loyal:a.age>=30?.25:.1,mercenary:.15,homesick:.1,professional:.35,adventurous:a.age<=24?.2:.1},n=Object.values(e).reduce((o,l)=>o+l,0),i=(a.name||"").split("").reduce((o,l,c)=>o+l.charCodeAt(0)*(c+1),0),s=Math.sin(i*9301+49297)*1e4;let r=(s-Math.floor(s))*n;for(const[o,l]of Object.entries(e))if(r-=l,r<=0)return o;return"professional"}const mJe=[["Real Madrid","Barcelona"],["Real Betis","Sevilla"],["Atltico Madrid","Real Madrid"],["Athletic Club","Real Sociedad"],["Valencia","Villarreal"],["Espanyol","Barcelona"],["Celta Vigo","Deportivo de La Corua"],["Liverpool","Manchester United"],["Arsenal","Tottenham"],["Manchester City","Manchester United"],["Chelsea","Arsenal"],["Everton","Liverpool"],["Inter","Milan"],["Juventus","Inter"],["Roma","Lazio"],["Napoli","Juventus"],["Bayern Mnchen","Borussia Dortmund"],["FC Schalke 04","Borussia Dortmund"],["PSG","Marseille"],["Olympique Lyon","AS Saint-tienne"],["Boca Juniors","River Plate"],["Racing Club","Independiente"],["San Lorenzo","Huracn"],["Flamengo","Vasco da Gama"],["Corinthians","Palmeiras"],["Grmio","Internacional"],["So Paulo","Corinthians"],["Atltico Nacional","Independiente Medelln"],["Millonarios","Santa Fe"],["Colo-Colo","Universidad de Chile"],["Universidad Catlica","Colo-Colo"],["Pearol","Nacional"]];function gJe(a,e){if(!a||!e)return!1;const n=r=>r.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),i=r=>r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=(r,o)=>{const l=n(r),c=n(o);if(l===c)return!0;if(c.length<3)return!1;const u=l.length<=c.length?l:c,h=l.length<=c.length?c:l;return new RegExp(`(^|\\s)${i(u)}($|\\s)`).test(h)};return mJe.some(([r,o])=>s(a,r)&&s(e,o)||s(a,o)&&s(e,r))}function Ele(a,e,n){const i=Zd(e.name),s=Zd(n.name),r=i-s,o=a.salary||5e4,l=iy[a.personality||"professional"];let c=1.1;if(r>0){const u=r*.4;c+=u,l.name==="Ambicioso"?c+=r*.2:l.name==="Mercenario"?c+=r*.15:l.name==="Aventurero"&&(c-=r*.1)}return r<0&&(c=Math.max(1,c-Math.abs(r)*.1)),a.age>=30&&(c+=.1),a.age>=33&&(c+=.15),Math.round(o*c)}function AJe(a,e,n,i){const s=Zd(n.name),r=Zd(i.name),o=s-r,l=iy[e.personality||"professional"],c=e.salary||5e4,u=a.salary||c,h=Ele(e,n,i),f=u/h;let m=.5;o>0?(m-=o*.15,m+=l.tierDownPenalty):o<0&&(m+=Math.abs(o)*.1,m+=l.tierUpBonus),f>=1.5?m+=.3*l.moneyInfluence+.15:f>=1.2?m+=.2*l.moneyInfluence+.1:f>=1?m+=.1*l.moneyInfluence:f>=.8?m-=.15:m-=.35,e.age>=32&&(m+=.1),e.age<=23&&(m+=.05);const A=e.role?.name?.includes("Titular")||e.overall>=(n.avgOverall||75);A&&o>0&&(m-=.2),!A&&o<=0&&(m+=.15);const x=e.yearsAtClub||Math.floor(Math.random()*5);x>=5&&(m-=.1*l.loyaltyFactor),x>=8&&(m-=.15*l.loyaltyFactor),m=Math.max(.02,Math.min(.95,m));const T=Math.random()<m;let E="";return T?o<0?E="Quiere dar el salto a un club ms grande":f>=1.3?E="La oferta econmica es muy atractiva":A?E="Acepta el nuevo reto":E="Busca ms minutos de juego":o>1?E="No quiere dar un paso atrs en su carrera":f<.9?E="La oferta salarial es insuficiente":x>=5?E="Tiene un vnculo especial con el club":E="No le convence el proyecto deportivo",{accepted:T,reason:E,probability:Math.round(m*100),requiredSalary:h,personalityEffect:l.name,tierDiff:o}}function bS(a,e,n){const i=Zd(e?.name),s=Zd(n?.name),r=i-s;let o=50;o-=r*12,a.overall>=90?o-=25:a.overall>=85?o-=15:a.overall>=80?o-=8:a.overall<=70?o+=10:a.overall<=65&&(o+=18),a.age<=21?o-=10:a.age<=23?o-=5:a.age>=33?o+=15:a.age>=30&&(o+=8);const l=a.contractYears||a.contract||2;l>=4?o-=10:l>=3?o-=4:l<=1&&(o+=15);const c=iy[a.personality];c&&(c.name==="Leal"?o-=12:c.name==="Ambicioso"&&r>0?o-=10:c.name==="Mercenario"?o+=12:c.name==="Aventurero"&&(o+=8));const h=(a.name||"").split("").reduce((T,E,M)=>T+E.charCodeAt(0)*(M+1),0)%20-10;o+=h,o=Math.max(5,Math.min(95,o));let f,m,A;o>=75?(f="Muy Fcil",m="transfers.veryEasy",A="#30d158"):o>=60?(f="Fcil",m="transfers.easy",A="#30d158"):o>=40?(f="Normal",m="transfers.normal",A="#ffd60a"):o>=25?(f="Difcil",m="transfers.hard",A="#ff9f0a"):o>=12?(f="Muy Difcil",m="transfers.veryHard",A="#ff453a"):(f="Casi Imposible",m="transfers.almostImpossible",A="#ff453a");const x=1.7-o/100*.75;return{difficulty:f,difficultyKey:m,color:A,percentage:o,tierDiff:r,askingMultiplier:x}}const jR={0:{name:"Sin ojeador",description:"Sugerencias bsicas sin filtrar",accuracy:.2,maxSuggestions:10,features:["Jugadores aleatorios de la liga"]},1:{name:"Ojeador Amateur",description:"Filtra por posiciones que necesitas",accuracy:.5,maxSuggestions:15,features:["Filtra por posicin","Identifica carencias"]},2:{name:"Ojeador Profesional",description:"Ajusta por presupuesto y nivel",accuracy:.75,maxSuggestions:20,features:["Filtra por posicin","Ajuste de presupuesto","Anlisis de nivel"]},3:{name:"Ojeador lite",description:"Sugerencias perfectas para tu equipo",accuracy:.95,maxSuggestions:20,features:["Anlisis completo","Personalidad compatible","Potencial de mejora","Dificultad de fichaje"]}};function yJe(a,e=0){const n=a?.players||[],i=[],s={GK:{positions:["GK"],ideal:2,current:0,avgOvr:0},CB:{positions:["CB"],ideal:4,current:0,avgOvr:0},FB:{positions:["RB","LB","RWB","LWB"],ideal:4,current:0,avgOvr:0},CDM:{positions:["CDM"],ideal:2,current:0,avgOvr:0},CM:{positions:["CM","CAM"],ideal:4,current:0,avgOvr:0},WM:{positions:["RM","LM"],ideal:2,current:0,avgOvr:0},WIN:{positions:["RW","LW"],ideal:2,current:0,avgOvr:0},ST:{positions:["ST","CF"],ideal:3,current:0,avgOvr:0}};n.forEach(l=>{for(const[c,u]of Object.entries(s))if(u.positions.includes(l.position)){u.current++,u.avgOvr=(u.avgOvr*(u.current-1)+l.overall)/u.current;break}});const r=n.length>0?Math.round(n.reduce((l,c)=>l+c.overall,0)/n.length):70;for(const[l,c]of Object.entries(s)){const u=c.ideal-c.current,h=r-c.avgOvr;let f="low",m="";u>=2?(f="critical",m=`Faltan ${u} jugadores`):u===1?(f="high",m="Falta profundidad"):h>=5&&c.current>0?(f="medium",m=`Nivel bajo (${Math.round(c.avgOvr)} vs ${r} media)`):h>=3&&c.current>0&&(f="low",m="Mejorable"),(f!=="low"||e>=2&&h>0)&&i.push({group:l,positions:c.positions,priority:f,reason:m,current:c.current,ideal:c.ideal,avgOvr:Math.round(c.avgOvr),targetOvr:Math.max(r,Math.round(c.avgOvr)+3)})}const o={critical:0,high:1,medium:2,low:3};return i.sort((l,c)=>o[l.priority]-o[c.priority]),{needs:i,teamAvgOvr:r}}function vJe(a,e,n=0,i=0,s=null){const r=jR[n]||jR[0],{needs:o,teamAvgOvr:l}=yJe(a,n);Zd(a?.name||"");const c=a?.id;let u=[];console.log(`[Ojeador] Equipos recibidos: ${(e||[]).length}, Mi equipo: ${c}`),(e||[]).forEach(f=>{f.id!==c&&(f.players||[]).forEach(m=>{m.personality||(m.personality=wle(m)),u.push({...m,teamId:f.id,teamName:f.name,teamTier:Zd(f.name)})})});let h=[];if(s){const f={ST:["ST","CF"],CF:["CF","ST"],CB:["CB"],RB:["RB","RWB"],LB:["LB","LWB"],RWB:["RWB","RB"],LWB:["LWB","LB"],CDM:["CDM","CM"],CM:["CM","CDM","CAM"],CAM:["CAM","CM"],RM:["RM","RW"],LM:["LM","LW"],RW:["RW","RM"],LW:["LW","LM"],GK:["GK"]},m=new Set(f[s]||[s]);u=u.filter(A=>{const x=(A.position||"").replace(/\d+$/,"").toUpperCase().trim();return m.has(x)})}if(n===0)u=u.sort(()=>Math.random()-.5),h=u.slice(0,r.maxSuggestions);else{const f=new Set;o.forEach(A=>A.positions.forEach(x=>f.add(x)));let m=u.filter(A=>{if(!s&&f.size>0&&!f.has(A.position)&&Math.random()>.2||n>=2&&co(A)>i*.7)return!1;if(n>=2){const x=l-8,T=l+12;if(A.overall<x||A.overall>T)return!1}return!(n>=3&&bS(A,{name:A.teamName},{name:a?.name||""}).percentage<15)});n>=3?(m=m.map(A=>{let x=0;const T=o.find(F=>F.positions.includes(A.position));T&&(T.priority==="critical"?x+=30:T.priority==="high"?x+=20:T.priority==="medium"?x+=10:x+=5);const E=Math.abs(A.overall-l);E<=3?x+=15:E<=5?x+=10:E<=8&&(x+=5),A.age<=23?x+=15:A.age<=26?x+=10:A.age<=29&&(x+=5);const N=co(A)/i;N<=.2?x+=10:N<=.4&&(x+=5),A.personality==="adventurous"?x+=10:A.personality==="mercenary"?x+=8:A.personality==="professional"&&(x+=5);const I=bS(A,{name:A.teamName},{name:a?.name||""});return I.tierDiff>0&&(x-=I.tierDiff*5),{...A,scoutScore:x}}),m.sort((A,x)=>x.scoutScore-A.scoutScore)):m.sort((A,x)=>{const T=x.overall-A.overall;return Math.abs(T)>3?T:Math.random()-.5}),h=m.slice(0,r.maxSuggestions)}return h=h.map(f=>{const m=co(f),A=bS(f,{name:f.teamName},{name:a?.name||""}),x=o.find(T=>T.positions.includes(f.position));return{...f,marketValue:m,difficulty:A,matchesNeed:!!x,needPriority:x?.priority||null,recommendation:_Je(f,x,A,n)}}),{suggestions:h,needs:o,teamAvgOvr:l,scoutingLevel:n,config:r}}function _Je(a,e,n,i){if(i<2)return null;const s=[];return e&&(e.priority==="critical"?s.push(`Cubre una necesidad crtica en ${e.group}`):e.priority==="high"&&s.push(`Refuerzo importante para ${e.group}`)),a.age<=22?s.push("Gran potencial de mejora"):a.age>=30&&s.push("Experiencia inmediata"),n.percentage>=70?s.push("Fichaje muy asequible"):n.percentage>=50?s.push("Negociacin viable"):n.percentage<30&&s.push(" Difcil de convencer"),iy[a.personality]&&(a.personality==="adventurous"?s.push("Abierto a nuevos retos"):a.personality==="mercenary"?s.push("Sensible a buenas ofertas"):a.personality==="ambitious"&&n.tierDiff<=0&&s.push("Buscar subir de nivel")),s.length>0?s.join(". ")+".":null}const Mle=[{id:"laliga",name:"Liga Ibrica",country:"Espaa",flagUrl:"https://flagcdn.com/es.svg",color:"#ff4444"},{id:"segunda",name:"Segunda Ibrica",country:"Espaa",flagUrl:"https://flagcdn.com/es.svg",color:"#ff8844"},{id:"primeraRFEF",name:"Primera Federacin",country:"Espaa",flagUrl:"https://flagcdn.com/es.svg",color:"#cc6600"},{id:"segundaRFEF",name:"Segunda Federacin",country:"Espaa",flagUrl:"https://flagcdn.com/es.svg",color:"#996633"},{id:"premierLeague",name:"First League",country:"Inglaterra",flagUrl:"https://flagcdn.com/gb-eng.svg",color:"#3d195b"},{id:"championship",name:"Second League",country:"Inglaterra",flagUrl:"https://flagcdn.com/gb-eng.svg",color:"#5b2d8e"},{id:"serieA",name:"Calcio League",country:"Italia",flagUrl:"https://flagcdn.com/it.svg",color:"#008c45"},{id:"serieB",name:"Calcio B",country:"Italia",flagUrl:"https://flagcdn.com/it.svg",color:"#00b359"},{id:"bundesliga",name:"Erste Liga",country:"Alemania",flagUrl:"https://flagcdn.com/de.svg",color:"#dd0000"},{id:"bundesliga2",name:"Zweite Liga",country:"Alemania",flagUrl:"https://flagcdn.com/de.svg",color:"#ff3333"},{id:"ligue1",name:"Division Premire",country:"Francia",flagUrl:"https://flagcdn.com/fr.svg",color:"#091c3e"},{id:"ligue2",name:"Division Seconde",country:"Francia",flagUrl:"https://flagcdn.com/fr.svg",color:"#1a3366"},{id:"eredivisie",name:"Dutch First",country:"Pases Bajos",flagUrl:"https://flagcdn.com/nl.svg",color:"#ff6600"},{id:"primeiraLiga",name:"Liga Lusitana",country:"Portugal",flagUrl:"https://flagcdn.com/pt.svg",color:"#006600"},{id:"belgianPro",name:"Belgian First",country:"Blgica",flagUrl:"https://flagcdn.com/be.svg",color:"#cc9900"},{id:"superLig",name:"Anatolian League",country:"Turqua",flagUrl:"https://flagcdn.com/tr.svg",color:"#e30a17"},{id:"scottishPrem",name:"Highland League",country:"Escocia",flagUrl:"https://flagcdn.com/gb-sct.svg",color:"#003399"},{id:"swissSuperLeague",name:"Alpine League",country:"Suiza",flagUrl:"https://flagcdn.com/ch.svg",color:"#ff0000"},{id:"austrianBundesliga",name:"Erste Liga (AT)",country:"Austria",flagUrl:"https://flagcdn.com/at.svg",color:"#ed2939"},{id:"greekSuperLeague",name:"Super League",country:"Grecia",flagUrl:"https://flagcdn.com/gr.svg",color:"#0d5eaf"},{id:"danishSuperliga",name:"Superligaen",country:"Dinamarca",flagUrl:"https://flagcdn.com/dk.svg",color:"#c8102e"},{id:"croatianLeague",name:"HNL",country:"Croacia",flagUrl:"https://flagcdn.com/hr.svg",color:"#0046a8"},{id:"czechLeague",name:"Chance Liga",country:"Chequia",flagUrl:"https://flagcdn.com/cz.svg",color:"#11457e"},{id:"argentinaPrimera",name:"Liga Profesional",country:"Argentina",flagUrl:"https://flagcdn.com/ar.svg",color:"#75aadb"},{id:"brasileiraoA",name:"Srie A",country:"Brasil",flagUrl:"https://flagcdn.com/br.svg",color:"#009739"},{id:"colombiaPrimera",name:"Liga BetPlay",country:"Colombia",flagUrl:"https://flagcdn.com/co.svg",color:"#fcd116"},{id:"chilePrimera",name:"Primera Divisin",country:"Chile",flagUrl:"https://flagcdn.com/cl.svg",color:"#d52b1e"},{id:"uruguayPrimera",name:"Primera Divisin",country:"Uruguay",flagUrl:"https://flagcdn.com/uy.svg",color:"#001489"},{id:"ecuadorLigaPro",name:"LigaPro",country:"Ecuador",flagUrl:"https://flagcdn.com/ec.svg",color:"#ffd100"},{id:"paraguayPrimera",name:"Divisin de Honor",country:"Paraguay",flagUrl:"https://flagcdn.com/py.svg",color:"#d52b1e"},{id:"peruLiga1",name:"Liga 1",country:"Per",flagUrl:"https://flagcdn.com/pe.svg",color:"#d91023"},{id:"boliviaPrimera",name:"Divisin Profesional",country:"Bolivia",flagUrl:"https://flagcdn.com/bo.svg",color:"#007934"},{id:"venezuelaPrimera",name:"Liga FUTVE",country:"Venezuela",flagUrl:"https://flagcdn.com/ve.svg",color:"#cf142b"},{id:"mls",name:"American League",country:"Estados Unidos",flagUrl:"https://flagcdn.com/us.svg",color:"#013474"},{id:"saudiPro",name:"Arabian League",country:"Arabia Saud",flagUrl:"https://flagcdn.com/sa.svg",color:"#006C35"},{id:"ligaMX",name:"Azteca League",country:"Mxico",flagUrl:"https://flagcdn.com/mx.svg",color:"#006847"},{id:"jLeague",name:"Sakura League",country:"Japn",flagUrl:"https://flagcdn.com/jp.svg",color:"#BC002D"}];function xJe(a,e){let n=a||[];return e&&(n=n.filter(i=>i.leagueId===e)),n.map(i=>({...i,tier:Zd(i.name),avgOverall:i.players?.length>0?Math.round(i.players.reduce((s,r)=>s+r.overall,0)/i.players.length):70,totalValue:i.players?.reduce((s,r)=>s+co(r),0)||0})).sort((i,s)=>s.avgOverall-i.avgOverall)}const bJe={ambitious:Ai,mercenary:ju,loyal:BF,competitor:ef,professional:yy,patriot:dc,adventurous:dc};function SJe(){const{t:a}=Sa(),{state:e,dispatch:n}=Va(),[i,s]=ge.useState("explorar"),[r,o]=ge.useState(""),[l,c]=ge.useState({position:"all",ageMin:16,ageMax:40,ovrMin:50,priceMax:2e8}),[u,h]=ge.useState(null),[f,m]=ge.useState(!1),A=Array.isArray(e.fixtures)?e.fixtures:[];A.length>0&&Math.max(...A.map(O=>O.week));const x=NF(e.currentWeek||1,{preseasonPhase:e.preseasonPhase||!1}),T=e.globalMarket?.summary||{recentTransfers:[],activeRumors:[],totalTransfers:0},E=e.team,M=E?.players||[],N=ge.useMemo(()=>{const O=[];return(e.leagueTeams||[]).forEach(D=>{D.id!==e.teamId&&(D.players||[]).forEach(j=>{O.push({...j,teamName:D.name,teamId:D.id,leagueId:D.leagueId})})}),(e.freeAgents||[]).forEach(D=>{O.push({...D,teamName:a("transfers.freeAgent"),teamId:null,isFreeAgent:!0})}),O},[e.leagueTeams,e.teamId,e.freeAgents]),I=ge.useMemo(()=>N.filter(O=>!(r&&!O.name.toLowerCase().includes(r.toLowerCase())||l.position!=="all"&&!{GK:["GK"],DEF:["CB","RB","LB","RWB","LWB"],MID:["CM","CDM","CAM","RM","LM"],FWD:["ST","CF","RW","LW"]}[l.position]?.includes(O.position)||O.age<l.ageMin||O.age>l.ageMax||O.overall<l.ovrMin||l.freeOnly&&!O.isFreeAgent)).sort((O,D)=>D.overall-O.overall),[N,r,l]),F=e.facilities?.scouting||0,G=[{id:"explorar",label:a("transfers.explore"),icon:Ol},{id:"ojeador",label:a("transfers.scout"),icon:Fs},{id:"buscar",label:a("transfers.search"),icon:T0},{id:"recibidas",label:a("transfers.received"),icon:OF,badge:(e.incomingOffers?.filter(O=>O.status==="pending")?.length||0)+(e.incomingLoanOffers?.filter(O=>O.status==="pending")?.length||0)||void 0},{id:"enviadas",label:a("transfers.sent"),icon:gu,badge:e.outgoingOffers?.filter(O=>O.status==="pending")?.length}];return d.jsxs("div",{className:"transfers-v2",children:[d.jsxs("div",{className:"transfers-header",children:[d.jsxs("div",{className:"header-left",children:[d.jsx("h1",{children:a("transfers.title")}),d.jsxs("div",{className:"window-status open",children:[d.jsx(or,{size:16}),d.jsx("span",{children:e.preseasonPhase?a("transfers.preseasonOpen"):a("transfers.matchdayOpen",{week:e.currentWeek})})]})]}),d.jsx("div",{className:"header-right",children:d.jsxs("div",{className:"budget-display",children:[d.jsx(mm,{size:18}),d.jsx("span",{className:"label",children:a("common.budget")}),d.jsx("span",{className:"amount",children:Sn(e.money||0)})]})})]}),d.jsx("div",{className:"transfers-tabs",children:G.map(O=>d.jsxs("button",{className:`tab ${i===O.id?"active":""}`,onClick:()=>s(O.id),children:[d.jsx(O.icon,{size:18}),d.jsx("span",{children:O.label}),O.badge>0&&d.jsx("span",{className:"badge",children:O.badge})]},O.id))}),d.jsxs("div",{className:"transfers-content",children:[i==="resumen"&&d.jsx(TJe,{windowStatus:x,summary:T,myTeam:E,preseasonPhase:e.preseasonPhase}),i==="explorar"&&d.jsx(IJe,{leagueTeams:e.leagueTeams||[],myTeamId:e.teamId,playerLeagueId:e.leagueId,onSelectPlayer:h,blockedPlayers:e.blockedPlayers||[]}),i==="ojeador"&&d.jsx(LJe,{myTeam:E,leagueTeams:e.leagueTeams||[],scoutingLevel:F,budget:e.money,onSelectPlayer:h,facilities:e.facilities,dispatch:n,blockedPlayers:e.blockedPlayers||[]}),i==="buscar"&&d.jsx(wJe,{players:I,searchQuery:r,setSearchQuery:o,filters:l,setFilters:c,showFilters:f,setShowFilters:m,onSelectPlayer:h,budget:e.money,blockedPlayers:e.blockedPlayers||[]}),i==="recibidas"&&d.jsx(EJe,{offers:e.incomingOffers||[],incomingLoanOffers:e.incomingLoanOffers||[],myPlayers:M,dispatch:n,state:e}),i==="enviadas"&&d.jsx(MJe,{offers:e.outgoingOffers||[],dispatch:n,budget:e.money,activeLoans:e.activeLoans||[],teamId:e.teamId,state:e})]}),u&&d.jsx(DJe,{player:u,onClose:O=>{if(O&&u){const D=u.id||u.name;n({type:"BLOCK_PLAYER",payload:D})}h(null)},budget:e.money,dispatch:n,myTeam:E,blockedPlayers:e.blockedPlayers||[],scoutingDiscount:[0,10,20,30][e.facilities?.scouting||0]})]})}function TJe({windowStatus:a,summary:e,myTeam:n,preseasonPhase:i}){const{t:s}=Sa();return d.jsxs("div",{className:"tab-resumen",children:[d.jsxs("div",{className:"market-status-card",children:[d.jsx("div",{className:"status-icon",children:a.open?d.jsx(ru,{className:"open"}):d.jsx(or,{className:"closed"})}),d.jsxs("div",{className:"status-info",children:[d.jsx("h3",{children:s("transfers.marketOpen")}),d.jsx("p",{children:s(i?"transfers.preseasonMsg":"transfers.marketAlwaysOpen")})]})]}),d.jsxs("div",{className:"quick-stats",children:[d.jsxs("div",{className:"stat-card",children:[d.jsx(kZ,{size:24}),d.jsx("div",{className:"stat-value",children:e.totalTransfers||0}),d.jsx("div",{className:"stat-label",children:s("transfers.totalTransfers")})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx(dl,{size:24}),d.jsx("div",{className:"stat-value",children:Sn(e.totalSpent||0)}),d.jsx("div",{className:"stat-label",children:s("transfers.moneyMoved")})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx(bN,{size:24}),d.jsx("div",{className:"stat-value",children:e.activeRumors?.length||0}),d.jsx("div",{className:"stat-label",children:s("transfers.activeRumors")})]})]}),d.jsxs("div",{className:"section",children:[d.jsxs("h3",{children:[d.jsx(dl,{size:18})," ",s("transfers.recentTransfers")]}),d.jsxs("div",{className:"transfers-list",children:[(e.recentTransfers||[]).slice(0,5).map((r,o)=>d.jsxs("div",{className:"transfer-item",children:[d.jsxs("div",{className:"player-info",children:[d.jsx("span",{className:"position",children:r.player?.position}),d.jsx("span",{className:"name",children:r.player?.name}),d.jsx("span",{className:"overall",children:r.player?.overall})]}),d.jsxs("div",{className:"transfer-flow",children:[d.jsx("span",{className:"from",children:r.from?.name}),d.jsx(jS,{size:16}),d.jsx("span",{className:"to",children:r.to?.name})]}),d.jsx("div",{className:"price",children:Sn(r.price)})]},o)),(!e.recentTransfers||e.recentTransfers.length===0)&&d.jsx("div",{className:"empty-state",children:d.jsx("p",{children:s("transfers.noRecentTransfers")})})]})]}),d.jsxs("div",{className:"section",children:[d.jsxs("h3",{children:[d.jsx(bN,{size:18})," ",s("transfers.marketRumors")]}),d.jsxs("div",{className:"rumors-list",children:[(e.activeRumors||[]).slice(0,5).map((r,o)=>d.jsxs("div",{className:"rumor-item",children:[d.jsx("div",{className:"rumor-text",children:r.text}),d.jsx("div",{className:"rumor-reliability",children:d.jsx("span",{className:`reliability ${r.reliability>60?"high":r.reliability>40?"medium":"low"}`,children:s("transfers.reliable",{pct:r.reliability})})})]},o)),(!e.activeRumors||e.activeRumors.length===0)&&d.jsx("div",{className:"empty-state",children:d.jsx("p",{children:s("transfers.noActiveRumors")})})]})]})]})}function wJe({players:a,searchQuery:e,setSearchQuery:n,filters:i,setFilters:s,showFilters:r,setShowFilters:o,onSelectPlayer:l,budget:c,blockedPlayers:u=[]}){const{t:h}=Sa();return d.jsxs("div",{className:"tab-buscar",children:[d.jsxs("div",{className:"search-bar",children:[d.jsxs("div",{className:"search-input-wrapper",children:[d.jsx(T0,{size:18}),d.jsx("input",{type:"text",placeholder:h("transfers.searchPlaceholder"),value:e,onChange:f=>n(f.target.value)}),e&&d.jsx("button",{className:"clear-btn",onClick:()=>n(""),children:d.jsx(zr,{size:16})})]}),d.jsxs("button",{className:`filter-toggle ${r?"active":""}`,onClick:()=>o(!r),children:[d.jsx(Ak,{size:18}),h("transfers.filters")]})]}),r&&d.jsxs("div",{className:"filters-panel",children:[d.jsxs("div",{className:"filter-group",children:[d.jsx("label",{children:h("transfers.position")}),d.jsx(Tle,{compact:!0,value:i.position,onChange:f=>s({...i,position:f}),searchable:!1,options:[{value:"all",label:h("transfers.posAll")},{value:"GK",label:h("transfers.posGK")},{value:"DEF",label:h("transfers.posDEF")},{value:"MID",label:h("transfers.posMID")},{value:"FWD",label:h("transfers.posFWD")}]})]}),d.jsxs("div",{className:"filter-group",children:[d.jsx("label",{children:h("transfers.ageRange",{min:i.ageMin,max:i.ageMax})}),d.jsx("input",{type:"range",min:"16",max:"40",value:i.ageMax,onChange:f=>s({...i,ageMax:parseInt(f.target.value)})})]}),d.jsxs("div",{className:"filter-group",children:[d.jsx("label",{children:h("transfers.minOVR",{ovr:i.ovrMin})}),d.jsx("input",{type:"range",min:"50",max:"95",value:i.ovrMin,onChange:f=>s({...i,ovrMin:parseInt(f.target.value)})})]}),d.jsx("div",{className:"filter-group",children:d.jsxs("label",{children:[d.jsx("input",{type:"checkbox",checked:i.freeOnly||!1,onChange:f=>s({...i,freeOnly:f.target.checked})}),h("transfers.freeAgentsOnly")]})})]}),d.jsx("div",{className:"players-grid",children:a.slice(0,50).map((f,m)=>{const A=f.id||f.name,x=u.includes(A);return d.jsxs("div",{className:`player-card ${f.isFreeAgent?"free-agent":""} ${x?"blocked":""}`,onClick:()=>!x&&l(f),children:[d.jsxs("div",{className:"card-header",children:[d.jsx("span",{className:"position","data-pos":f.position,children:ds(f.position)}),d.jsx("span",{className:"overall",children:f.overall}),x&&d.jsx("span",{className:"blocked-icon",children:d.jsx(xP,{size:14})})]}),d.jsxs("div",{className:"card-body",children:[d.jsx("h4",{children:f.name}),d.jsx("p",{className:"team",children:f.isFreeAgent?d.jsx("span",{className:"free-badge",children:h("transfers.free")}):f.teamName}),d.jsxs("div",{className:"meta",children:[d.jsxs("span",{children:[f.age," ",h("transfers.years")]}),d.jsx("span",{className:"value",children:Sn(co(f,f.leagueId))})]}),x&&d.jsx("span",{className:"blocked-label",children:h("transfers.blockedThisSeason")}),!x&&!f.isFreeAgent&&(f.contractYears||0)<=1&&d.jsx("span",{className:"contract-expiring",children:h("transfers.contractExpiring")})]})]},m)})})]})}function EJe({offers:a,incomingLoanOffers:e=[],myPlayers:n,dispatch:i,state:s}){const{t:r}=Sa(),o=a.filter(x=>x.status==="pending"),l=a.filter(x=>x.status!=="pending"),c=e.filter(x=>x.status==="pending"),u=x=>{i({type:"ACCEPT_INCOMING_OFFER",payload:x})},h=x=>{i({type:"REJECT_INCOMING_OFFER",payload:x})},f=x=>{i({type:"COUNTER_INCOMING_OFFER",payload:x})},m=x=>{const T=s?.team?.players?.find(M=>M.name===x.playerId);if(!T)return;const E=AZ(T,s,"out");if(!E.canLoan){i({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"warning",title:r("transfers.cannotLoan"),content:E.errors.join(". "),date:`${r("transfers.weekShort",{week:s.currentWeek})}`}});return}i({type:"ACCEPT_LOAN_OFFER",payload:x})},A=x=>{i({type:"REJECT_LOAN_OFFER",payload:x})};return o.length===0&&l.length===0&&c.length===0?d.jsxs("div",{className:"tab-ofertas empty",children:[d.jsx(OF,{size:48,className:"empty-icon"}),d.jsx("h3",{children:r("transfers.noOffersReceived")}),d.jsx("p",{children:r("transfers.noInterestYet")})]}):d.jsxs("div",{className:"tab-ofertas",children:[o.length>0&&d.jsx("h4",{className:"section-title",children:r("transfers.pendingTransferOffers")}),o.map((x,T)=>d.jsxs("div",{className:"offer-card incoming",children:[d.jsxs("div",{className:"offer-header",children:[d.jsxs("div",{className:"from-team",children:[d.jsx(Ol,{size:20}),d.jsx("span",{children:x.fromTeam})]}),d.jsxs("div",{className:"offer-badges",children:[d.jsx("span",{className:"offer-type-badge transfer",children:r("transfers.transferBadge")}),d.jsx("span",{className:`status ${x.status}`,children:r("transfers.pending")})]})]}),d.jsxs("div",{className:"offer-player",children:[d.jsx("span",{className:"position",children:x.player?.position}),d.jsx("span",{className:"name",children:x.player?.name}),d.jsx("span",{className:"overall",children:x.player?.overall})]}),d.jsxs("div",{className:"offer-amount",children:[d.jsx(mm,{size:18}),d.jsx("span",{children:Sn(x.amount)}),x.expiryWeek&&d.jsxs("span",{className:"expiry-tag",children:[d.jsx(or,{size:12})," ",r("transfers.expiresWeek",{week:x.expiryWeek}),s.currentWeek>=x.expiryWeek-1&&d.jsx("span",{className:"urgent",children:" "})]})]}),d.jsxs("div",{className:"offer-actions",children:[d.jsxs("button",{className:"btn-accept",onClick:()=>u(x),children:[d.jsx(uo,{size:16})," ",r("transfers.accept")]}),d.jsxs("button",{className:"btn-counter",onClick:()=>f(x),children:[d.jsx(kZ,{size:16})," ",r("transfers.askMore")]}),d.jsxs("button",{className:"btn-reject",onClick:()=>h(x),children:[d.jsx(zr,{size:16})," ",r("transfers.reject")]})]})]},x.id||T)),c.length>0&&d.jsx("h4",{className:"section-title",children:r("transfers.pendingLoanOffers")}),c.map((x,T)=>d.jsxs("div",{className:"offer-card incoming loan-offer",children:[d.jsxs("div",{className:"offer-header",children:[d.jsxs("div",{className:"from-team",children:[d.jsx(BS,{size:20}),d.jsx("span",{children:x.toTeamName})]}),d.jsxs("div",{className:"offer-badges",children:[d.jsx("span",{className:"offer-type-badge loan",children:r("transfers.loanBadge")}),d.jsx("span",{className:"status pending",children:r("transfers.pending")})]})]}),d.jsxs("div",{className:"offer-player",children:[d.jsx("span",{className:"position",children:x.playerData?.position}),d.jsx("span",{className:"name",children:x.playerData?.name||x.playerId}),d.jsx("span",{className:"overall",children:x.playerData?.overall})]}),d.jsxs("div",{className:"loan-offer-terms",children:[d.jsxs("div",{className:"loan-term",children:[d.jsx("span",{className:"term-label",children:r("transfers.loanFee")}),d.jsx("span",{className:"term-value",children:Sn(x.loanFee)})]}),d.jsxs("div",{className:"loan-term",children:[d.jsx("span",{className:"term-label",children:r("transfers.receiverSalary")}),d.jsxs("span",{className:"term-value",children:[Math.round(x.salaryShare*100),"%"]})]}),x.purchaseOption&&d.jsxs("div",{className:"loan-term",children:[d.jsx("span",{className:"term-label",children:r("transfers.purchaseOption")}),d.jsx("span",{className:"term-value",children:Sn(x.purchaseOption)})]})]}),d.jsxs("div",{className:"offer-actions",children:[d.jsxs("button",{className:"btn-accept",onClick:()=>m(x),children:[d.jsx(uo,{size:16})," ",r("transfers.accept")]}),d.jsxs("button",{className:"btn-reject",onClick:()=>A(x),children:[d.jsx(zr,{size:16})," ",r("transfers.reject")]})]})]},x.id||`loan_${T}`)),l.length>0&&d.jsx("h4",{className:"section-title past",children:r("transfers.history")}),l.slice(0,5).map((x,T)=>d.jsxs("div",{className:`offer-card incoming ${x.status}`,children:[d.jsxs("div",{className:"offer-header",children:[d.jsxs("div",{className:"from-team",children:[d.jsx(Ol,{size:20}),d.jsx("span",{children:x.fromTeam})]}),d.jsx("span",{className:`status ${x.status}`,children:x.status==="rejected"?r("transfers.rejected"):x.status})]}),d.jsxs("div",{className:"offer-player",children:[d.jsx("span",{className:"position",children:x.player?.position}),d.jsx("span",{className:"name",children:x.player?.name})]}),d.jsx("div",{className:"offer-amount faded",children:Sn(x.amount)})]},x.id||T))]})}function MJe({offers:a,dispatch:e,budget:n,activeLoans:i=[],teamId:s,state:r}){const{t:o}=Sa(),l=T=>{e({type:"ACCEPT_COUNTER_OFFER",payload:T})},c=T=>{e({type:"REMOVE_OUTGOING_OFFER",payload:T.id})},u=i.filter(T=>T.fromTeamId===s&&T.status==="active"),h=i.filter(T=>T.toTeamId===s&&T.status==="active"),f=T=>{if(!T.purchaseOption||n<T.purchaseOption){e({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"warning",title:o("transfers.cannotExecute"),content:T.purchaseOption?o("transfers.insufficientBudget"):o("transfers.noPurchaseOption"),date:`${o("transfers.weekShort",{week:r?.currentWeek})}`}});return}e({type:"EXERCISE_LOAN_PURCHASE",payload:{loanId:T.id}})};if(a.length===0&&u.length===0&&h.length===0)return d.jsxs("div",{className:"tab-ofertas empty",children:[d.jsx(gu,{size:48,className:"empty-icon"}),d.jsx("h3",{children:o("transfers.noSentOffers")}),d.jsx("p",{children:o("transfers.noSentOffersDesc")})]});const m=[...a].sort((T,E)=>T.status==="pending"&&E.status!=="pending"?-1:T.status!=="pending"&&E.status==="pending"?1:(E.submittedWeek||0)-(T.submittedWeek||0)),A=a.some(T=>T.status==="resolved"),x=()=>{e({type:"CLEAR_RESOLVED_OFFERS"})};return d.jsxs("div",{className:"tab-ofertas",children:[a.length>0&&d.jsxs("div",{className:"section-title-row",children:[d.jsxs("h4",{className:"section-title",children:[d.jsx(Fs,{size:16})," ",o("transfers.transferOffers")]}),A&&d.jsxs("button",{className:"btn-clear-resolved",onClick:x,children:[d.jsx(UT,{size:14})," ",o("transfers.clear")]})]}),m.map((T,E)=>{const M=T.clubResponse==="accepted"&&T.playerResponse==="accepted",N=T.clubResponse==="countered",I=T.status==="pending",F=T.status==="resolved";return d.jsxs("div",{className:`offer-card-v2 ${I?"pending":""} ${M?"success":""}`,children:[d.jsxs("div",{className:"offer-v2-header",children:[d.jsx("span",{className:"pos-badge","data-pos":T.player?.position,children:ds(T.player?.position)}),d.jsxs("div",{className:"offer-v2-info",children:[d.jsx("span",{className:"name",children:T.player?.name||T.playerName}),d.jsxs("span",{className:"team",children:[T.toTeam,"  ",T.player?.age," ",o("transfers.years")]})]}),d.jsx("span",{className:"ovr-badge",children:T.player?.overall})]}),d.jsxs("div",{className:"offer-v2-amounts",children:[d.jsxs("span",{children:[d.jsx(mm,{size:14})," ",Sn(T.amount)]}),d.jsxs("span",{children:[d.jsx(Hu,{size:14})," ",Sn((T.salaryOffer||0)*52),"/",o("transfers.year")]}),d.jsx("span",{className:"week-tag",children:o("transfers.weekShort",{week:T.submittedWeek||"?"})})]}),I&&d.jsxs("div",{className:"offer-v2-pending",children:[d.jsx(or,{size:16}),d.jsx("span",{children:o("transfers.pendingResponse")}),d.jsxs("button",{className:"btn-withdraw-small",onClick:()=>c(T),children:[d.jsx(zr,{size:14})," ",o("transfers.withdraw")]})]}),F&&d.jsxs("div",{className:"offer-v2-responses",children:[d.jsxs("div",{className:`response-row ${T.clubResponse}`,children:[d.jsx(Ol,{size:16}),d.jsx("span",{className:"response-label",children:o("transfers.club")}),T.clubResponse==="accepted"&&d.jsxs("span",{className:"response-result accepted",children:[d.jsx(yN,{size:14})," ",o("transfers.accepts")]}),T.clubResponse==="rejected"&&d.jsxs("span",{className:"response-result rejected",children:[d.jsx(kd,{size:14})," ",T.clubReason]}),T.clubResponse==="countered"&&d.jsxs("span",{className:"response-result countered",children:[d.jsx(__,{size:14})," ",T.clubReason]})]}),d.jsxs("div",{className:`response-row ${T.playerResponse}`,children:[d.jsx($C,{size:16}),d.jsx("span",{className:"response-label",children:o("transfers.playerLabel")}),T.playerResponse==="accepted"&&d.jsxs("span",{className:"response-result accepted",children:[d.jsx(yN,{size:14})," ",o("transfers.accepts")]}),T.playerResponse==="rejected"&&d.jsxs("span",{className:"response-result rejected",children:[d.jsx(kd,{size:14})," ",T.playerReason]})]})]}),M&&d.jsxs("div",{className:"offer-v2-result success",children:[d.jsx(jg,{size:16})," ",o("transfers.transferCompleted")]}),N&&T.playerResponse==="accepted"&&d.jsxs("div",{className:"offer-v2-counter",children:[d.jsxs("span",{children:[" ",o("transfers.clubAsks",{amount:Sn(T.clubCounterAmount)})]}),d.jsxs("div",{className:"counter-btns",children:[n>=(T.clubCounterAmount||0)&&d.jsxs("button",{className:"btn-accept-counter",onClick:()=>l(T),children:[d.jsx(uo,{size:14})," ",o("transfers.acceptCounter")]}),d.jsxs("button",{className:"btn-withdraw",onClick:()=>c(T),children:[d.jsx(zr,{size:14})," ",o("transfers.withdraw")]})]})]}),N&&T.playerResponse==="rejected"&&d.jsxs("div",{className:"offer-v2-result failed",children:[d.jsx(kd,{size:16})," ",o("transfers.playerRejectedCantComplete"),d.jsx("button",{className:"btn-withdraw-small",onClick:()=>c(T),children:o("transfers.deleteBtn")})]}),F&&!M&&!N&&d.jsxs("div",{className:"offer-v2-result failed",children:[d.jsx(kd,{size:16})," ",o("transfers.offerRejected"),d.jsx("button",{className:"btn-withdraw-small",onClick:()=>c(T),children:o("transfers.deleteBtn")})]})]},T.id||E)}),u.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("h4",{className:"section-title loan-section-title",children:[d.jsx(BS,{size:16})," ",o("transfers.loanedOutPlayers")]}),d.jsx("div",{className:"loan-active-list",children:u.map(T=>d.jsxs("div",{className:"loan-active-card loaned-out",children:[d.jsxs("div",{className:"la-header",children:[d.jsxs("span",{className:"la-direction out",children:['" ',o("transfers.loanedOut")]}),d.jsxs("span",{className:"la-weeks",children:[d.jsx(or,{size:14})," ",o("transfers.weeksShort",{weeks:T.weeksRemaining})]})]}),d.jsxs("div",{className:"la-player",children:[d.jsx("span",{className:"la-pos","data-pos":T.playerData?.position,children:T.playerData?.position||"?"}),d.jsxs("div",{className:"la-info",children:[d.jsx("span",{className:"la-name",children:T.playerData?.name||T.playerId}),d.jsxs("span",{className:"la-team",children:['" ',o("transfers.atTeam",{team:T.toTeamName})]})]}),d.jsx("span",{className:"la-ovr",children:T.playerData?.overall||"?"})]}),T.purchaseOption&&d.jsxs("div",{className:"la-purchase-info",children:[d.jsx(Fs,{size:14}),d.jsxs("span",{children:[o("transfers.purchaseOption"),": ",Sn(T.purchaseOption)]})]})]},T.id))})]}),h.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("h4",{className:"section-title loan-section-title",children:[d.jsx(BS,{size:16})," ",o("transfers.loanedInPlayers")]}),d.jsx("div",{className:"loan-active-list",children:h.map(T=>d.jsxs("div",{className:"loan-active-card loaned-in",children:[d.jsxs("div",{className:"la-header",children:[d.jsxs("span",{className:"la-direction in",children:[" ",o("transfers.onLoan")]}),d.jsxs("span",{className:"la-weeks",children:[d.jsx(or,{size:14})," ",o("transfers.weeksShort",{weeks:T.weeksRemaining})]})]}),d.jsxs("div",{className:"la-player",children:[d.jsx("span",{className:"la-pos","data-pos":T.playerData?.position,children:T.playerData?.position||"?"}),d.jsxs("div",{className:"la-info",children:[d.jsx("span",{className:"la-name",children:T.playerData?.name||T.playerId}),d.jsxs("span",{className:"la-team",children:["  ",o("transfers.ownedBy",{team:T.fromTeamName})]})]}),d.jsx("span",{className:"la-ovr",children:T.playerData?.overall||"?"})]}),T.purchaseOption&&d.jsxs("div",{className:"la-purchase-action",children:[d.jsxs("div",{className:"la-purchase-info",children:[d.jsx(Fs,{size:14}),d.jsx("span",{children:o("transfers.purchaseOptionAmount",{amount:Sn(T.purchaseOption)})})]}),d.jsxs("button",{className:"la-purchase-btn",onClick:()=>f(T),disabled:n<T.purchaseOption,children:[d.jsx(mm,{size:14})," ",o("transfers.buyAmount",{amount:Sn(T.purchaseOption)})]})]})]},T.id))})]})]})}const CJe=new Set(["Argentina","Brasil","Colombia","Chile","Uruguay","Ecuador","Paraguay","Per","Bolivia","Venezuela"]),NJe=new Set(["Estados Unidos","Arabia Saud","Mxico","Japn"]);function RJe(a){return CJe.has(a)?"sa":NJe.has(a)?"world":"eu"}const PJe=(()=>{const a={};return Mle.forEach(e=>{a[e.country]||(a[e.country]={country:e.country,flagUrl:e.flagUrl,leagues:[],continent:RJe(e.country)}),a[e.country].leagues.push(e)}),Object.values(a)})();function IJe({leagueTeams:a,myTeamId:e,playerLeagueId:n,onSelectPlayer:i,blockedPlayers:s=[]}){const{t:r}=Sa(),[o,l]=ge.useState(null),[c,u]=ge.useState(null),[h,f]=ge.useState(""),[m,A]=ge.useState("eu"),x=ge.useMemo(()=>xJe(a,o),[a,o]),T=ge.useMemo(()=>h?x.filter(N=>N.name?.toLowerCase().includes(h.toLowerCase())):x,[x,h]),E=ge.useMemo(()=>PJe.filter(N=>N.continent===m),[m]);if(!o)return d.jsxs("div",{className:"tab-explorar",children:[d.jsxs("div",{className:"explorar-continent-tabs",children:[d.jsxs("button",{className:`continent-tab ${m==="eu"?"active":""}`,onClick:()=>A("eu"),children:[d.jsx("span",{children:""})," ",r("transfers.europe")]}),d.jsxs("button",{className:`continent-tab ${m==="sa"?"active":""}`,onClick:()=>A("sa"),children:[d.jsx("span",{children:""})," ",r("transfers.southAmerica")]}),d.jsxs("button",{className:`continent-tab ${m==="world"?"active":""}`,onClick:()=>A("world"),children:[d.jsx("span",{children:""})," ",r("transfers.restOfWorld")]})]}),d.jsx("div",{className:"explorar-country-grid",children:E.map(N=>{const I=N.leagues.reduce((F,G)=>F+(a||[]).filter(O=>O.leagueId===G.id).length,0);return d.jsxs("div",{className:"explorar-country-card",children:[d.jsxs("div",{className:"country-card-header",children:[d.jsx("img",{src:N.flagUrl,alt:N.country,className:"country-card-flag"}),d.jsxs("div",{className:"country-card-info",children:[d.jsx("span",{className:"country-card-name",children:N.country}),d.jsx("span",{className:"country-card-meta",children:r("transfers.leaguesMeta",{count:N.leagues.length,plural:N.leagues.length>1?"s":"",teams:I})})]})]}),d.jsx("div",{className:"country-card-leagues",children:N.leagues.map(F=>{const G=(a||[]).filter(O=>O.leagueId===F.id).length;return d.jsxs("button",{className:"country-card-league",onClick:()=>{l(F.id),f("")},children:[d.jsx("span",{className:"league-name",children:F.name}),d.jsx("span",{className:"league-count",children:G})]},F.id)})})]},N.country)})})]});const M=Mle.find(N=>N.id===o);return c?d.jsxs("div",{className:"tab-explorar",children:[d.jsxs("div",{className:"explorar-header with-back",children:[d.jsx("button",{className:"back-btn",onClick:()=>{u(null)},children:d.jsx(jS,{size:18,style:{transform:"rotate(180deg)"}})}),d.jsxs("div",{className:"header-info",children:[d.jsxs("h3",{children:[d.jsx("img",{src:M?.flagUrl,alt:"",className:"header-flag"}),c.name]}),d.jsx("p",{children:r("transfers.playersAvgOvr",{count:c.players?.length||0,avg:c.avgOverall||"??"})})]})]}),d.jsx("div",{className:"teams-tabs",children:x.map(N=>d.jsxs("button",{className:`team-tab ${N.id===c.id?"active":""} ${N.id===e?"my-team":""}`,onClick:()=>N.id!==e&&u(N),disabled:N.id===e,children:[d.jsx("span",{className:"tab-name",children:N.shortName||N.name?.split(" ").pop()}),d.jsx("span",{className:"tab-ovr",children:N.avgOverall})]},N.id))}),d.jsxs("div",{className:"squad-table-header",children:[d.jsx("span",{className:"col-pos",children:r("transfers.posHeader")}),d.jsx("span",{className:"col-name",children:r("transfers.playerHeader")}),d.jsx("span",{className:"col-age",children:r("transfers.age").toUpperCase()}),d.jsx("span",{className:"col-ovr",children:r("transfers.ovrHeader")}),d.jsx("span",{className:"col-value",children:r("transfers.playerValue").toUpperCase()})]}),d.jsx("div",{className:"squad-list",children:(c.players||[]).sort((N,I)=>I.overall-N.overall).map((N,I)=>{const F=N.id||N.name,G=s.includes(F);return d.jsxs("div",{className:`squad-player ${G?"blocked":""}`,onClick:()=>!G&&i({...N,teamName:c.name,teamId:c.id}),children:[d.jsx("span",{className:"player-pos","data-pos":N.position,children:ds(N.position)}),d.jsx("span",{className:"player-name",children:N.name}),d.jsx("span",{className:"player-age",children:N.age}),d.jsx("span",{className:"player-ovr",children:N.overall}),d.jsx("span",{className:"player-value",children:Sn(co(N,o))}),G&&d.jsx("span",{className:"blocked-badge",children:d.jsx(xP,{size:14})})]},I)})})]}):d.jsxs("div",{className:"tab-explorar",children:[d.jsxs("div",{className:"explorar-header with-back",children:[d.jsx("button",{className:"back-btn",onClick:()=>{l(null),f("")},children:d.jsx(jS,{size:18,style:{transform:"rotate(180deg)"}})}),d.jsxs("div",{className:"header-info",children:[d.jsxs("h3",{children:[d.jsx("img",{src:M?.flagUrl,alt:"",className:"header-flag"}),M?.name]}),d.jsx("p",{children:r("transfers.nTeams",{count:x.length})})]})]}),x.length>8&&d.jsxs("div",{className:"explorar-search",children:[d.jsx(T0,{size:16}),d.jsx("input",{type:"text",placeholder:r("transfers.searchTeamPlaceholder"),value:h,onChange:N=>f(N.target.value)}),h&&d.jsx("button",{className:"clear-btn",onClick:()=>f(""),children:d.jsx(zr,{size:14})})]}),d.jsx("div",{className:"teams-compact-grid",children:T.map(N=>{const I=N.id===e;return d.jsxs("div",{className:`team-compact ${I?"my-team":""}`,onClick:()=>!I&&u(N),children:[d.jsx("div",{className:"tc-badge",style:{background:N.colors?.primary||`hsl(${(N.name?.charCodeAt(0)||0)*7%360}, 50%, 35%)`},children:N.shortName?.slice(0,3)||N.name?.slice(0,3)}),d.jsxs("div",{className:"tc-info",children:[d.jsx("span",{className:"tc-name",children:N.name}),d.jsxs("span",{className:"tc-meta",children:[d.jsx(Hu,{size:11})," ",N.players?.length||0,d.jsx(Br,{size:11})," ",N.avgOverall]})]}),I&&d.jsx("span",{className:"tc-mine",children:r("transfers.yourTeam")})]},N.id)})})]})}function LJe({myTeam:a,leagueTeams:e,scoutingLevel:n,budget:i,onSelectPlayer:s,facilities:r,dispatch:o,blockedPlayers:l=[]}){const{t:c}=Sa(),[u,h]=ge.useState(null),[f,m]=ge.useState(!1),[A,x]=ge.useState(null),T=jR[n]||jR[0],E=[{en:"GK",es:"POR"},{en:"CB",es:"DFC"},{en:"LB",es:"LI"},{en:"RB",es:"LD"},{en:"LWB",es:"CRI"},{en:"RWB",es:"CRD"},{en:"CDM",es:"MCD"},{en:"CM",es:"MC"},{en:"CAM",es:"MCO"},{en:"LM",es:"MI"},{en:"RM",es:"MD"},{en:"LW",es:"EI"},{en:"RW",es:"ED"},{en:"ST",es:"DC"},{en:"CF",es:"SD"}],M=()=>{m(!0),setTimeout(()=>{const N=vJe(a,e,n,i,A);h(N),m(!1)},1e3)};return d.jsxs("div",{className:"tab-ojeador",children:[d.jsx("div",{className:"ojeador-header",children:d.jsxs("div",{className:"ojeador-level",children:[d.jsx("div",{className:"level-icon",children:d.jsx(Fs,{size:24})}),d.jsxs("div",{className:"level-info",children:[d.jsx("span",{className:"level-name",children:T.name}),d.jsx("span",{className:"level-desc",children:T.description})]}),d.jsxs("div",{className:"level-badge",children:[c("transfers.level")," ",n]})]})}),d.jsxs("div",{className:"position-selector",children:[d.jsxs("span",{className:"position-selector__label",children:[c("transfers.positionToSearch"),":"]}),d.jsx("div",{className:"position-selector__chips",children:E.map(N=>d.jsx("button",{className:`pos-chip ${A===N.en?"pos-chip--active":""}`,onClick:()=>x(A===N.en?null:N.en),children:N.es},N.en))})]}),d.jsx("button",{className:"generate-btn",onClick:M,disabled:f,children:f?d.jsxs(d.Fragment,{children:[d.jsx(__,{size:18,className:"spinning"}),c("transfers.analyzingMarket")]}):d.jsxs(d.Fragment,{children:[d.jsx(T0,{size:18}),A?c("transfers.searchSpecific",{pos:E.find(N=>N.en===A)?.es||""}):c("transfers.searchPlayers")]})}),u&&d.jsxs("div",{className:"suggestions-section",children:[d.jsx("div",{className:"suggestions-header",children:d.jsxs("h4",{children:[d.jsx(Br,{size:16})," ",c("transfers.playersFound",{count:u.suggestions.length})]})}),d.jsx("div",{className:"suggestions-list",children:u.suggestions.map((N,I)=>{const F=N.id||N.name,G=l.includes(F);return d.jsxs("div",{className:`suggestion-card ${G?"blocked":""}`,onClick:()=>!G&&s(N),children:[d.jsx("div",{className:"suggestion-pos","data-pos":N.position,children:ds(N.position)}),d.jsxs("div",{className:"suggestion-main",children:[d.jsx("span",{className:"name",children:N.name}),d.jsxs("span",{className:"meta",children:[N.teamName,"  ",N.age," ",c("transfers.years")]})]}),d.jsxs("div",{className:"suggestion-stats",children:[d.jsx("span",{className:"overall",children:N.overall}),d.jsx("span",{className:"value",children:G?d.jsx(xP,{size:14}):Sn(N.marketValue)})]}),!G&&d.jsx("div",{className:"difficulty-indicator",style:{background:N.difficulty?.color},title:N.difficulty?.difficulty})]},I)})})]})]})}function DJe({player:a,onClose:e,budget:n,dispatch:i,myTeam:s,blockedPlayers:r=[],scoutingDiscount:o=0}){const{t:l}=Sa(),{state:c}=Va(),u=Array.isArray(c.fixtures)?c.fixtures:[];u.length>0&&Math.max(...u.map(Qe=>Qe.week)),NF(c.currentWeek||1,{preseasonPhase:c.preseasonPhase||!1});const[h,f]=ge.useState(0),[m,A]=ge.useState(0),[x,T]=ge.useState(4),[E,M]=ge.useState("pending"),[N,I]=ge.useState("locked"),[F,G]=ge.useState(null),[O,D]=ge.useState(null),[j,L]=ge.useState(""),[U,q]=ge.useState(0),[K,H]=ge.useState("transfer"),[X,ne]=ge.useState(null),[Q,Y]=ge.useState(!1),[ue,pe]=ge.useState(0),[Ee,oe]=ge.useState(50),[Ae,be]=ge.useState(0),[Ce,ce]=ge.useState(!0),te=co(a,a.leagueId||c.leagueId),fe=a.salary||5e4,Le=ge.useMemo(()=>a.personality||wle(a),[a.name,a.personality,a.overall,a.age]),Fe=iy[Le],Ie=a.isFreeAgent||!1,at=!Ie&&(a.contractYears||2)<=1,je=Zd(a.teamName),Ve=Zd(s?.name||""),Me=je-Ve,ze=$Y(je),Je=$Y(Ve),rt=ge.useMemo(()=>bS({...a,personality:Le},{name:a.teamName},{name:s?.name||""}),[a.name,a.overall,Le,a.teamName,s?.name]),ve=ge.useMemo(()=>Ele({...a,salary:fe,personality:Le},{name:a.teamName},{name:s?.name||""}),[a.name,fe,Le,a.teamName,s?.name]),Ue=1-o/100,it=Math.round(te*Ue),wt=Qe=>Math.round(Qe/1e5)*1e5;ge.useEffect(()=>{if(f(wt(it*.95)),A(wt(Math.max(ve*1.1,1e5))),q(wt(Ie?it*.15:it*.1)),!Ie){const Qe=fN(a,c.leagueId);pe(Qe);const Xe=gZ(a,{name:Je?.name||"Mid Table"});oe(Math.round(Xe*100)),be(wt(it*.9)),ce(!0)}},[it,ve,Ie]),ge.useEffect(()=>{Ie||Y(gJe(a.teamName,s?.name))},[a.teamName,s?.name,Ie]);const Mt=ge.useMemo(()=>{const Qe=bS(a,{name:a.teamName,id:a.teamId},{name:c.team?.name,id:c.teamId}),Xe=Math.round(it*Qe.askingMultiplier),ct=h/Xe;let Tt;return ct>=1.15?Tt=98:ct>=.95?Tt=80:ct>=.8?Tt=55:ct>=.65?Tt=30:ct>=.5?Tt=10:Tt=2,Math.max(2,Math.min(98,Tt))},[h,it,a,c.team,c.teamId]),_e=ge.useMemo(()=>{const Qe=m/ve;let Xe=50;if(Me>0){Xe-=Me*15;const Tt=Fe;Tt&&(Xe+=(Tt.tierDownPenalty||0)*100)}else if(Me<0){Xe+=Math.abs(Me)*10;const Tt=Fe;Tt&&(Xe+=(Tt.tierUpBonus||0)*100)}const ct=Fe?.moneyInfluence||.5;return Qe>=1.5?Xe+=30*ct+15:Qe>=1.2?Xe+=20*ct+10:Qe>=1?Xe+=10*ct:Qe>=.8?Xe-=15:Xe-=35,a.age>=32&&(Xe+=10),a.age<=23&&(Xe+=5),Math.max(5,Math.min(95,Math.round(Xe)))},[m,ve,Me,Fe,a.age]),le=ge.useMemo(()=>{if(K!=="loan"||Ie)return 0;const Qe=(c.leagueTeams||[]).find(kt=>kt.id===a.teamId);if(!Qe)return 50;const Xe=Qe.players||[],ct=Xe.length>0?Math.round(Xe.reduce((kt,vt)=>kt+(vt.overall||70),0)/Xe.length):70;let Tt=50;return a.overall<ct-3?Tt+=20:a.overall<ct&&(Tt+=10),a.age<=23&&je>=3&&(Tt+=15),(a.contractYears||2)>=3&&(Tt+=10),ue>=te*.2&&(Tt+=10),Ce&&Ae>=te*.9&&(Tt+=10),je>=4?Tt-=15:je>=3&&(Tt-=10),a.overall>=83&&(Tt-=25),Math.max(5,Math.min(95,Tt))},[K,Ie,a,ue,Ae,Ce,te,je,c.leagueTeams]),Ge=ge.useMemo(()=>{if(!Ie&&K!=="precontract")return 0;const Xe=Math.round(ve*(Ie?1.3:1.15)),ct=Math.round(te*(Ie?.15:.1)),Tt=m/Xe,kt=ct>0?U/ct:1;let vt=50;return Tt>=1.2?vt+=25:Tt>=1?vt+=15:Tt>=.8?vt-=10:vt-=30,kt>=1.5?vt+=15:kt>=1?vt+=10:kt>=.5?vt+=0:vt-=15,Ve>=3?vt+=15:Ve>=2?vt+=5:Ve<=0&&(vt-=15),Math.max(5,Math.min(95,Math.round(vt)))},[Ie,K,m,ve,te,U,Ve]),tt=()=>{const Qe=AZ(a,c,"in");if(!Qe.canLoan){i({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"warning",title:l("transfers.loanNotPossible"),content:Qe.errors.join(". "),date:`${l("transfers.weekShort",{week:c.currentWeek})}`}});return}if(n<ue){i({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"warning",title:l("transfers.insufficientBudgetTitle"),content:l("transfers.insufficientForLoanFee",{amount:Sn(ue)}),date:`${l("transfers.weekShort",{week:c.currentWeek})}`}});return}const Xe=(c.leagueTeams||[]).find(ct=>ct.id===a.teamId);Xe&&(M("negotiating"),setTimeout(()=>{const ct=Kye(Xe,a,{id:c.teamId,name:s?.name},{loanFee:ue,purchaseOption:Ce?Ae:null});ct.accepted?(i({type:"LOAN_IN_PLAYER",payload:{player:{name:a.name,position:a.position,overall:a.overall,age:a.age,salary:a.salary||5e4,value:te},fromTeamId:a.teamId,fromTeamName:a.teamName,loanFee:ue,salaryShare:Ee/100,purchaseOption:Ce?Ae:null}}),D("success"),M("accepted")):(D("failed"),L(l("transfers.loanDenied",{team:a.teamName,player:a.name,reasons:ct.reasons.filter(Tt=>!Tt.positive).map(Tt=>Tt.text).join(". ")})),M("rejected"))},1200))},pt=()=>{I("rejected"),D("failed"),L(l("transfers.noAgreementReached")),ne(null)},Te=()=>{I("negotiating"),ne(null),setTimeout(()=>{const Qe=AJe({salary:m},{...a,personality:Le,salary:fe},{name:a.teamName},{name:s?.name});Qe.accepted?(I("accepted"),D("success"),mt()):(I("rejected"),D("failed"),L(Qe.reason||l("transfers.playerRejectedDefinitely")))},1200)},st=()=>{I("negotiating"),setTimeout(()=>{({...a});const Qe=Ve,Xe=iy[Le]||iy.professional,Tt=Math.round(ve*(Ie?1.3:1.15)),kt=Math.round(te*(Ie?.15:.1)),vt=m/Tt,Tn=kt>0?U/kt:1;let Ne=.5;if(vt>=1.2?Ne+=.25:vt>=1?Ne+=.15:vt>=.8?Ne-=.1:Ne-=.3,Tn>=1.5?Ne+=.15:Tn>=1?Ne+=.1:Tn>=.5?Ne+=0:Ne-=.15,Qe>=3?Ne+=.15:Qe>=2?Ne+=.05:Qe<=0&&(Ne-=.15),Ne+=Xe.moneyInfluence*(vt-1)*.3,a.overall>=85&&Qe<3&&(Ne-=.2),Ne=Math.max(.05,Math.min(.95,Ne)),Math.random()<Ne)I("accepted"),D("success"),mt();else{let Ht;vt<.8?Ht=l("transfers.insufficientSalaryOffer"):Tn<.5?Ht=l("transfers.wantsHigherBonus"):Qe<=1&&a.overall>=80?Ht=l("transfers.teamLevelNotConvincing"):Ht=l("transfers.overallOfferNotConvincing");const $t=Math.round(Tt*1.1),zt=$t<=m?Math.round(m*1.25):$t;$t<=m&&(Qe<=1&&a.overall>=80?Ht=l("transfers.needsMoreMoney"):Ht=l("transfers.wantsFinancialImprovement")),ne({salary:zt,reason:Ht}),I("counter")}},1200)},mt=()=>{const Qe={...a,personality:Le,salary:m,contractYears:x,teamId:c.teamId,isFreeAgent:!1};if(i({type:"SIGN_PLAYER",payload:{player:Qe,fee:U}}),Ie&&i({type:"REMOVE_FREE_AGENT",payload:{playerName:a.name}}),K==="precontract"&&!Ie){const Xe=(c.leagueTeams||[]).map(ct=>ct.id===a.teamId?{...ct,players:(ct.players||[]).filter(Tt=>Tt.name!==a.name)}:ct);i({type:"UPDATE_LEAGUE_TEAMS",payload:Xe})}i({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"transfer",title:l(Ie?"transfers.freeAgentSigned":"transfers.preContractSigned"),content:l("transfers.playerJoined",{name:a.name,bonus:Sn(U),salary:Sn(m*52)}),date:`${l("transfers.weekShort",{week:c.currentWeek})}`}})},ht=Qe=>Qe>=70?"#30d158":Qe>=50?"#ffd60a":Qe>=30?"#ff9f0a":"#ff453a";return d.jsx("div",{className:"transfer-modal-overlay",onClick:()=>e(O==="failed"),children:d.jsxs("div",{className:"transfer-modal",onClick:Qe=>Qe.stopPropagation(),children:[d.jsx("button",{className:"modal-close-btn",onClick:()=>e(O==="failed"),children:d.jsx(zr,{size:20})}),O&&d.jsx("div",{className:`final-result-overlay ${O}`,children:d.jsx("div",{className:"result-content",children:O==="success"?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"result-icon",children:d.jsx(jg,{size:48})}),d.jsx("h2",{children:l(K==="loan"?"transfers.loanSuccess":"transfers.signingSuccess")}),d.jsx("p",{className:"player-name",children:a.name}),d.jsxs("div",{className:"result-details",children:[d.jsxs("span",{children:[d.jsx(mm,{size:16})," ",Sn(K==="loan"?ue:Ie||K==="precontract"?U:h)]}),K==="loan"?d.jsxs("span",{children:[d.jsx(pm,{size:16})," ",l("transfers.seasonLabel")]}):d.jsxs(d.Fragment,{children:[d.jsxs("span",{children:[d.jsx(pm,{size:16})," ",x," ",l("transfers.years")]}),d.jsxs("span",{children:[d.jsx(dl,{size:16})," ",Sn(m*52*x)," ",l("transfers.totalWord")]})]})]}),d.jsxs("button",{className:"result-btn success",onClick:()=>e(!1),children:[d.jsx(uo,{size:18})," ",l("transfers.close")]})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"result-icon",children:d.jsx(kd,{size:48})}),d.jsx("h2",{children:l("transfers.signingFailed")}),d.jsx("p",{className:"fail-reason",children:j}),d.jsxs("p",{className:"block-notice",children:[d.jsx(xP,{size:14})," ",l("transfers.blockedUntilNextSeason")]}),d.jsx("div",{className:"result-actions",children:d.jsx("button",{className:"result-btn close",onClick:()=>e(!0),children:l("transfers.close")})})]})})}),d.jsxs("div",{className:"modal-layout",children:[d.jsxs("div",{className:"player-column",children:[d.jsxs("div",{className:"player-card",children:[d.jsxs("div",{className:"card-top",children:[d.jsx("span",{className:"position-badge","data-pos":a.position,children:ds(a.position)}),d.jsx("span",{className:"overall-badge",children:a.overall})]}),d.jsx("div",{className:"player-avatar",children:d.jsx("span",{className:"avatar-letter",children:a.name?.charAt(0)})}),d.jsx("h3",{className:"player-name",children:a.name}),d.jsxs("div",{className:"player-team",children:[d.jsx(Ol,{size:14}),Ie?d.jsx("span",{className:"free-badge",children:l("transfers.freeAgent")}):a.teamName]}),d.jsxs("div",{className:"player-tier",children:[d.jsx("span",{className:"tier-dot",style:{background:`hsl(${je*30+120}, 70%, 50%)`}}),ze.name]})]}),d.jsxs("div",{className:"player-stats",children:[d.jsxs("div",{className:"stat-row",children:[d.jsx("span",{className:"stat-label",children:l("transfers.age")}),d.jsxs("span",{className:"stat-value",children:[a.age," ",l("transfers.years")]})]}),d.jsxs("div",{className:"stat-row",children:[d.jsx("span",{className:"stat-label",children:l("transfers.playerValue")}),d.jsx("span",{className:"stat-value",children:Sn(te)})]}),d.jsxs("div",{className:"stat-row",children:[d.jsx("span",{className:"stat-label",children:l("transfers.salary")}),d.jsxs("span",{className:"stat-value",children:[Sn(fe*52),"/",l("transfers.year")]})]}),d.jsxs("div",{className:"stat-row",children:[d.jsx("span",{className:"stat-label",children:l("transfers.contract")}),d.jsx("span",{className:"stat-value",children:Ie?l("transfers.noContract"):`${a.contractYears||2} ${l("transfers.years")}`})]})]}),d.jsxs("div",{className:"player-personality",children:[d.jsx("span",{className:"personality-icon",children:(()=>{const Qe=bJe[a.personality?.type]||UZ;return d.jsx(Qe,{size:16})})()}),d.jsxs("div",{className:"personality-text",children:[d.jsx("span",{className:"personality-name",children:Fe?.nameKey?l(Fe.nameKey):Fe?.name||l("transfers.persProfessional")}),d.jsx("span",{className:"personality-desc",children:Fe?.descKey?l(Fe.descKey):Fe?.desc})]})]}),d.jsxs("div",{className:"difficulty-indicator",children:[d.jsxs("div",{className:"difficulty-header",children:[d.jsx("span",{children:l("transfers.difficulty")}),d.jsx("span",{style:{color:rt.color},children:rt.difficultyKey?l(rt.difficultyKey):rt.difficulty})]}),d.jsx("div",{className:"difficulty-bar-bg",children:d.jsx("div",{className:"difficulty-bar-fill",style:{width:`${100-rt.percentage}%`,background:rt.color}})}),Me>0&&d.jsxs("span",{className:"tier-warning",children:[d.jsx(wr,{size:14})," ",l("transfers.tierDropWarning",{count:Me,plural:Me>1?"es":""})]})]})]}),d.jsxs("div",{className:"negotiation-column",children:[d.jsxs("div",{className:"player-mobile-header",children:[d.jsx("span",{className:"pos-badge","data-pos":a.position,children:ds(a.position)}),d.jsxs("div",{className:"info",children:[d.jsx("span",{className:"name",children:a.name}),d.jsxs("span",{className:"meta",children:[Ie?l("transfers.freeAgentLabel"):a.teamName,"  ",a.age," ",l("transfers.years"),"  ",Sn(te)]})]}),d.jsx("span",{className:"ovr",children:a.overall})]}),!Ie&&d.jsxs("div",{className:"pre-contract-toggle",children:[d.jsx("button",{className:`toggle-btn ${K==="transfer"?"active":""}`,onClick:()=>{H("transfer"),M("pending"),I("locked"),D(null),L("")},children:l("transfers.signing")}),d.jsx("button",{className:`toggle-btn ${K==="loan"?"active":""}`,onClick:()=>{H("loan"),M("pending"),I("locked"),D(null),L("")},children:l("transfers.loanToggle")}),at&&d.jsx("button",{className:`toggle-btn ${K==="precontract"?"active":""}`,onClick:()=>{H("precontract"),M("pending"),I("pending"),D(null),L("")},children:l("transfers.preContractToggle")})]}),!Ie&&K==="loan"&&d.jsxs("div",{className:`negotiation-section loan-request-section ${E}`,children:[d.jsxs("div",{className:"section-header",children:[d.jsxs("div",{className:"section-title",children:[d.jsx(BS,{size:18}),d.jsx("span",{children:l("transfers.requestLoan")})]}),d.jsxs("div",{className:`status-badge ${E}`,children:[E==="pending"&&d.jsxs(d.Fragment,{children:[d.jsx(or,{size:12})," ",l("transfers.pending")]}),E==="negotiating"&&d.jsxs(d.Fragment,{children:[d.jsx(or,{size:12})," ",l("transfers.negotiating")]}),E==="accepted"&&d.jsxs(d.Fragment,{children:[d.jsx(yN,{size:12})," ",l("transfers.accepted")]}),E==="rejected"&&d.jsxs(d.Fragment,{children:[d.jsx(kd,{size:12})," ",l("transfers.rejected")]})]})]}),d.jsxs("div",{className:"offer-row",children:[d.jsx("label",{children:l("transfers.loanFee")}),d.jsx(Kv,{value:ue,onChange:Qe=>pe(Xe=>typeof Qe=="function"?Qe(Xe):Qe),step:5e5,min:1e5,max:n,disabled:E!=="pending"})]}),d.jsxs("div",{className:"contract-row",children:[d.jsx("label",{children:l("transfers.salaryPercentLabel")}),d.jsx("div",{className:"contract-buttons",children:[30,40,50,60,70,80].map(Qe=>d.jsxs("button",{className:`contract-btn ${Ee===Qe?"active":""}`,onClick:()=>oe(Qe),disabled:E!=="pending",children:[Qe,"%"]},Qe))}),d.jsx("span",{className:"salary-hint",children:l("transfers.salaryPayHint",{amount:Sn(Math.round((a.salary||5e4)*(Ee/100)*52))})})]}),d.jsxs("div",{className:"offer-row",children:[d.jsx("label",{children:l("transfers.purchaseOptionLabel")}),Ce?d.jsx(Kv,{value:Ae,onChange:Qe=>be(Xe=>typeof Qe=="function"?Qe(Xe):Qe),step:1e6,min:1e5,disabled:E!=="pending"}):d.jsx("div",{style:{padding:"0.6rem 1rem",background:"rgba(255,255,255,0.04)",border:"1px solid var(--border, #2a4a6a)",borderRadius:"8px",color:"rgba(255,255,255,0.5)",textAlign:"center",fontSize:"0.9rem"},children:l("transfers.noPurchaseOption")}),d.jsxs("div",{className:"lm-quick-btns",style:{display:"flex",gap:"0.35rem",marginTop:"0.4rem"},children:[d.jsx("button",{style:{flex:1,padding:"0.35rem 0.5rem",background:"rgba(255,255,255,0.05)",border:"1px solid #2a4a6a",borderRadius:"6px",color:Ce?"#7a8a9a":"#0a84ff",fontSize:"0.75rem",cursor:"pointer"},onClick:()=>{ce(!1),be(0)},disabled:E!=="pending",children:l("transfers.noOption")}),d.jsxs("button",{style:{flex:1,padding:"0.35rem 0.5rem",background:"rgba(255,255,255,0.05)",border:"1px solid #2a4a6a",borderRadius:"6px",color:"#7a8a9a",fontSize:"0.75rem",cursor:"pointer"},onClick:()=>{ce(!0),be(wt(te*.9))},disabled:E!=="pending",children:["90% ",l("transfers.value")]}),d.jsxs("button",{style:{flex:1,padding:"0.35rem 0.5rem",background:"rgba(255,255,255,0.05)",border:"1px solid #2a4a6a",borderRadius:"6px",color:"#7a8a9a",fontSize:"0.75rem",cursor:"pointer"},onClick:()=>{ce(!0),be(wt(te))},disabled:E!=="pending",children:["100% ",l("transfers.value")]})]})]}),d.jsxs("div",{className:"probability-row",children:[d.jsx("span",{className:"prob-label",children:l("transfers.estimatedProbability")}),d.jsx("div",{className:"prob-bar-container",children:d.jsx("div",{className:"prob-bar",style:{width:`${le}%`,background:ht(le)}})}),d.jsxs("span",{className:"prob-value",style:{color:ht(le)},children:[le,"%"]})]}),E==="pending"&&d.jsx("button",{className:"btn-send-club",onClick:tt,disabled:n<ue,children:n<ue?l("transfers.insufficientBudget",{amount:Sn(n)}):l("transfers.sendLoanRequest")}),E==="negotiating"&&d.jsxs("div",{className:"negotiating-indicator",children:[d.jsx(__,{size:18,className:"spinning"}),d.jsx("span",{children:l("transfers.waitingClubResponse")})]})]}),!Ie&&K==="transfer"&&d.jsxs("div",{className:"negotiation-section unified-offer-section",children:[d.jsx("div",{className:"section-header",children:d.jsxs("div",{className:"section-title",children:[d.jsx(Fs,{size:18}),d.jsx("span",{children:l("transfers.prepareOffer")}),Q&&d.jsxs("span",{className:"rivalry-badge",children:[" ",l("transfers.directRival")]})]})}),d.jsxs("div",{className:"offer-row",children:[d.jsxs("label",{children:[d.jsx(Ol,{size:14})," ",l("transfers.transferToClub")]}),d.jsx(Kv,{value:h,onChange:Qe=>f(Xe=>typeof Qe=="function"?Qe(Xe):Qe),step:5e5,min:0,max:c.money})]}),d.jsxs("div",{className:"probability-row",children:[d.jsxs("span",{className:"prob-label",children:[d.jsx(Ol,{size:12})," ",l("transfers.clubAccepts")]}),d.jsx("div",{className:"prob-bar-container",children:d.jsx("div",{className:"prob-bar",style:{width:`${Mt}%`,background:ht(Mt)}})}),d.jsxs("span",{className:"prob-value",style:{color:ht(Mt)},children:[Mt,"%"]})]}),d.jsx("div",{className:"offer-divider"}),d.jsxs("div",{className:"offer-row",children:[d.jsxs("label",{children:[d.jsx($C,{size:14})," ",l("transfers.annualSalary")]}),d.jsx(Kv,{value:m*52,onChange:Qe=>A(Math.round(Qe/52)),step:1e5,min:0,suffix:`/${l("transfers.year")}`}),d.jsx("span",{className:"salary-hint",children:l("transfers.minEstimated",{amount:Sn(ve*52)})})]}),d.jsxs("div",{className:"contract-row",children:[d.jsx("label",{children:l("transfers.contractDuration")}),d.jsx("div",{className:"contract-buttons",children:[2,3,4,5].map(Qe=>d.jsxs("button",{className:`contract-btn ${x===Qe?"active":""}`,onClick:()=>T(Qe),children:[Qe," ",l("transfers.years")]},Qe))})]}),d.jsxs("div",{className:"probability-row",children:[d.jsxs("span",{className:"prob-label",children:[d.jsx($C,{size:12})," ",l("transfers.playerAccepts")]}),d.jsx("div",{className:"prob-bar-container",children:d.jsx("div",{className:"prob-bar",style:{width:`${_e}%`,background:ht(_e)}})}),d.jsxs("span",{className:"prob-value",style:{color:ht(_e)},children:[_e,"%"]})]}),d.jsxs("div",{className:"offer-summary-box",children:[d.jsxs("div",{className:"summary-line",children:[d.jsxs("span",{children:[" ",l("transfers.totalTransferCost")]}),d.jsx("span",{className:"amount",children:Sn(h)})]}),d.jsxs("div",{className:"summary-line",children:[d.jsxs("span",{children:[" ",l("transfers.totalContractCost")]}),d.jsx("span",{className:"amount",children:Sn(m*52*x)})]}),d.jsxs("div",{className:"summary-line total",children:[d.jsxs("span",{children:[" ",l("transfers.totalInvestment")]}),d.jsx("span",{className:"amount",children:Sn(h+m*52*x)})]})]}),d.jsxs("button",{className:"btn-send-offer",onClick:()=>{i({type:"ADD_OUTGOING_OFFER",payload:{id:Date.now(),playerName:a.name,player:{name:a.name,position:a.position,overall:a.overall,age:a.age},toTeam:a.teamName,toTeamId:a.teamId,amount:h,salaryOffer:m,contractYears:x,status:"pending",submittedWeek:c.currentWeek}}),i({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"transfer",title:l("transfers.offerSentTitle"),content:l("transfers.offerSentContent",{name:a.name,team:a.teamName,amount:Sn(h),salary:Sn(m*52)}),date:`${l("transfers.weekShort",{week:c.currentWeek})}`}}),e()},disabled:n<h||h<=0,children:[d.jsx(jS,{size:18})," ",l("transfers.sendOffer")]}),d.jsxs("p",{className:"offer-hint",children:[" ",l("transfers.responseAfterMatch")]})]}),(Ie||K==="precontract")&&d.jsxs("div",{className:`negotiation-section free-agent-section ${N}`,children:[d.jsxs("div",{className:"section-header",children:[d.jsxs("div",{className:"section-title",children:[d.jsx($C,{size:18}),d.jsx("span",{children:l(Ie?"transfers.freeAgentNegotiation":"transfers.preContractSection")})]}),d.jsxs("div",{className:`status-badge ${N}`,children:[N==="pending"&&d.jsxs(d.Fragment,{children:[d.jsx(or,{size:12})," ",l("transfers.pending")]}),N==="locked"&&d.jsxs(d.Fragment,{children:[d.jsx(or,{size:12})," ",l("transfers.pending")]}),N==="negotiating"&&d.jsxs(d.Fragment,{children:[d.jsx(or,{size:12})," ",l("transfers.negotiating")]}),N==="accepted"&&d.jsxs(d.Fragment,{children:[d.jsx(yN,{size:12})," ",l("transfers.accepted")]}),N==="rejected"&&d.jsxs(d.Fragment,{children:[d.jsx(kd,{size:12})," ",l("transfers.rejected")]}),N==="counter"&&d.jsxs(d.Fragment,{children:[d.jsx(__,{size:12})," ",l("transfers.counterOffer")]})]})]}),Ie&&d.jsxs("div",{className:"free-agent-info",children:[d.jsx("span",{className:"free-badge-large",children:l("transfers.freeAgent")}),d.jsx("p",{children:l("transfers.freeAgentInfo")})]}),K==="precontract"&&!Ie&&d.jsxs("div",{className:"free-agent-info pre-contract-info",children:[d.jsx("span",{className:"pre-contract-badge",children:l("transfers.preContractBadge")}),d.jsx("p",{children:l("transfers.preContractInfo")})]}),d.jsxs("div",{className:"offer-row",children:[d.jsx("label",{children:l("transfers.signingBonus")}),d.jsx(Kv,{value:U,onChange:Qe=>q(Xe=>typeof Qe=="function"?Qe(Xe):Qe),step:5e5,min:0,disabled:N==="negotiating"||N==="accepted"}),d.jsx("span",{className:"salary-hint",children:l("transfers.suggested",{amount:Sn(Math.round(te*(Ie?.15:.1)))})})]}),d.jsxs("div",{className:"offer-row",children:[d.jsx("label",{children:l("transfers.annualSalary")}),d.jsx(Kv,{value:m*52,onChange:Qe=>A(Math.round(Qe/52)),step:1e5,min:0,disabled:N==="negotiating"||N==="accepted",suffix:`/${l("transfers.year")}`}),d.jsx("span",{className:"formatted-amount total-cost",children:l("transfers.totalCostFormatted",{amount:Sn(m*52*x),years:x,plural:x>1?"s":""})}),d.jsx("span",{className:"salary-hint",children:l("transfers.minEstimated",{amount:Sn(Math.round(ve*(Ie?1.3:1.15)*52))})})]}),d.jsxs("div",{className:"contract-row",children:[d.jsx("label",{children:l("transfers.contractDuration")}),d.jsx("div",{className:"contract-buttons",children:[2,3,4,5].map(Qe=>d.jsxs("button",{className:`contract-btn ${x===Qe?"active":""}`,onClick:()=>T(Qe),disabled:N==="negotiating"||N==="accepted",children:[Qe," ",l("transfers.years")]},Qe))})]}),d.jsxs("div",{className:"probability-row",children:[d.jsx("span",{className:"prob-label",children:l("transfers.acceptanceProbability")}),d.jsx("div",{className:"prob-bar-container",children:d.jsx("div",{className:"prob-bar",style:{width:`${Ge}%`,background:ht(Ge)}})}),d.jsxs("span",{className:"prob-value",style:{color:ht(Ge)},children:[Ge,"%"]})]}),N==="counter"&&X&&d.jsxs("div",{className:"counter-offer-box player-counter",children:[d.jsx("span",{className:"counter-label",children:l("transfers.playerCounterLabel")}),d.jsxs("span",{className:"counter-amount",children:[Sn(X.salary*52),"/",l("transfers.year")]}),d.jsx("span",{className:"counter-total",children:l("transfers.counterTotalCost",{amount:Sn(X.salary*52*x)})}),d.jsx("p",{className:"counter-reason",children:X.reason}),d.jsxs("div",{className:"counter-actions",children:[d.jsx("button",{className:"btn-counter-reject",onClick:pt,children:l("transfers.reject")}),d.jsx("button",{className:"btn-counter-accept",onClick:Te,children:l("transfers.counterOfferStatus")}),d.jsx("button",{className:"btn-counter-accept",onClick:()=>{A(X.salary),I("accepted"),D("success"),mt(),ne(null)},children:l("transfers.accept")})]})]}),d.jsxs("div",{className:"total-cost-row",children:[d.jsx("span",{className:"cost-label",children:l("transfers.totalCostLabel")}),d.jsxs("span",{className:"cost-value",children:[Sn(U)," + ",Sn(m*52),"/",l("transfers.year"),"  ",x," ",l("transfers.years")]})]}),(N==="pending"||N==="locked")&&d.jsx("button",{className:"btn-send-player",onClick:st,disabled:n<U,children:n<U?l("transfers.insufficientBudget",{amount:Sn(n)}):l(Ie?"transfers.presentOffer":"transfers.offerPreContract")}),N==="negotiating"&&d.jsxs("div",{className:"negotiating-indicator",children:[d.jsx(__,{size:18,className:"spinning"}),d.jsx("span",{children:l("transfers.playerEvaluating")})]})]})]})]})]})})}const KY=()=>typeof window<"u"&&window.innerWidth<=768;class kJe extends ge.Component{state={hasError:!1};static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){console.warn("Stadium3D error:",e)}render(){return this.state.hasError?d.jsxs("div",{className:"stadium-3d-fallback",children:[d.jsx("span",{children:d.jsx(Ol,{size:20})}),d.jsx("p",{children:"3D view not available"})]}):this.props.children}}const OJe=()=>[...hu(),...fu(),...pu(),...mu(),...pf(),...mf(),...gf(),...Af(),...yf(),...vf(),..._f(),...xf(),...bf(),...Sf(),...Tf(),...wf(),...Ef(),...Mf(),...Cf(),...Nf(),...Rf(),...Pf(),...If(),...Lf(),...Df(),...kf(),...Of(),...Ff(),...jf(),...Bf(),...Uf(),...Vf(),...zf()],FJe=p8.lazy(()=>Yh(()=>import("./Stadium3D-CYXysfJ5.js"),[])),YY=19,XY=[{name:"Municipal",capacity:8e3,maintenance:5e5,upgradeCost:null,prestige:1},{name:"Moderno",capacity:18e3,maintenance:12e5,upgradeCost:8e6,prestige:2},{name:"Grande",capacity:35e3,maintenance:25e5,upgradeCost:25e6,prestige:3},{name:"lite",capacity:55e3,maintenance:4e6,upgradeCost:6e7,prestige:4},{name:"Legendario",capacity:8e4,maintenance:6e6,upgradeCost:12e7,prestige:5}],jJe=[{id:"local",name:"Banco Regional",offer:5e5,minPrestige:1,duration:3},{id:"telecom",name:"TeleCom Plus",offer:15e5,minPrestige:2,duration:3},{id:"car",name:"AutoMotor",offer:3e6,minPrestige:3,duration:5},{id:"airline",name:"FlyAir",offer:5e6,minPrestige:4,duration:5},{id:"tech",name:"TechCorp",offer:8e6,minPrestige:5,duration:5}],BJe=[{id:"friendly",icon:d.jsx(Lo,{size:16}),income:2e5,grassDamage:5,cooldown:1},{id:"concert",icon:d.jsx(yk,{size:16}),income:5e5,grassDamage:20,cooldown:3},{id:"corporate",icon:d.jsx(gu,{size:16}),income:15e4,grassDamage:3,cooldown:1},{id:"legends",icon:d.jsx(Ai,{size:16}),income:4e5,grassDamage:8,cooldown:2}];function UJe(){const{t:a}=Sa(),{state:e,dispatch:n}=Va(),[i,s]=ge.useState("general"),[r,o]=ge.useState(KY);ge.useEffect(()=>{const Ue=()=>o(KY());return window.addEventListener("resize",Ue),()=>window.removeEventListener("resize",Ue)},[]);const l=e.stadium||{},c=e.facilities?.stadium??l.level??0,u=Math.max(0,Math.min(XY.length-1,c)),h=XY[u],f=l.realCapacity||h?.capacity||8e3,m=e.currentWeek||1,A=4,x=l.seasonTicketsCampaignOpen??m<=A,T=l.seasonTicketPrice??400,E=l.ticketPrice??30,M=l.ticketPriceLocked??!1,N=l.accumulatedTicketIncome??0,I=e.team?.players||[],F=I.length>0?Math.round(I.reduce((Ue,it)=>Ue+(it.overall||70),0)/I.length):70,G=e.leagueTable?.findIndex(Ue=>Ue.teamId===e.team?.id)+1||10,O=e.leagueTable?.length||20,D=e.team?.reputation||70,j=Math.floor(f*.8),L=tJe({capacity:f,seasonTicketPrice:T,teamOverall:F,leaguePosition:G,totalTeams:O,previousSeasonPosition:l.previousSeasonPosition||null,teamReputation:D}),U=x?L:l.seasonTicketsFinal??L,q=l.grassCondition??100,K=l.naming||null,H=l.lastEventWeek??0;K?.yearlyIncome,h?.maintenance;const X=e.playerLeagueId||"laliga",ne=["segunda","segundaRFEF","primeraRFEF"].includes(X)?2:1,Q=ble({teamOverall:F,teamReputation:D,leaguePosition:G,totalTeams:O,division:ne}),Y=Math.max(0,f-U),ue=Sle(E,1,Q),pe=Math.round(Y*OR.baseDemandRate*ue),Ee=U+pe,oe=Math.min(1,Ee/f),Ae=oe*.03,be=1+h.prestige*.01+Ae,Ce=(e.currentWeek||1)-H,ce=Ce>=2,te=jJe.filter(Ue=>Ue.minPrestige<=h.prestige&&!K),fe=Ue=>{n({type:"UPDATE_STADIUM",payload:{...l,...Ue}})},Le=Ue=>{if(!x)return;const it=Math.max(200,Math.min(1e3,T+Ue));fe({seasonTicketPrice:it})},Fe=()=>{if(!x)return;const Ue=L,it=Ue*T;fe({seasonTicketsCampaignOpen:!1,seasonTicketsFinal:Ue,seasonTicketPriceFinal:T,seasonTicketIncomeCollected:it}),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"stadium",title:a("stadium.seasonTicketsClosed"),content:a("stadium.seasonTicketsMessage",{count:Ue.toLocaleString(),price:T,total:ze(it)}),date:`Semana ${e.currentWeek}`}})},Ie=Ue=>{if(M)return;const it=Math.max(5,Math.min(150,E+Ue));fe({ticketPrice:it})},at=Ue=>{fe({naming:{sponsorId:Ue.id,name:Ue.name,yearsLeft:Ue.duration,yearlyIncome:Ue.offer}}),n({type:"UPDATE_MONEY",payload:Ue.offer}),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"stadium",title:a("stadium.namingRights"),content:a("stadium.namingMessage",{sponsor:Ue.name,amount:(Ue.offer/1e6).toFixed(1),duration:Ue.duration}),date:`Semana ${e.currentWeek}`}})},je=()=>{const Ue=K?Math.round(K.yearlyIncome*K.yearsLeft*.5):0;if(Ue>0&&e.money<Ue){n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"warning",title:a("stadium.insufficientFunds"),content:a("stadium.penaltyRequired",{amount:(Ue/1e6).toFixed(1)}),date:`Semana ${e.currentWeek}`}});return}fe({naming:null}),Ue>0&&n({type:"UPDATE_MONEY",payload:-Ue}),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"stadium",title:a("stadium.sponsorshipCancelled"),content:Ue>0?a("stadium.stadiumNameRestored",{amount:(Ue/1e6).toFixed(1)}):a("stadium.stadiumNameRestoredFree"),date:`Semana ${e.currentWeek}`}})},Ve=Ue=>{if(!ce)return;const it=Math.max(0,q-Ue.grassDamage);fe({grassCondition:it,lastEventWeek:e.currentWeek||1}),n({type:"UPDATE_MONEY",payload:Ue.income}),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"stadium",title:`${Ue.icon} ${Ue.name}`,content:a("stadium.eventHosted",{amount:(Ue.income/1e3).toFixed(0)}),date:`Semana ${e.currentWeek}`}})},Me=()=>{e.money<2e5||(fe({grassCondition:100}),n({type:"UPDATE_MONEY",payload:-2e5}))},ze=Ue=>Math.abs(Ue)>=1e6?`${(Ue/1e6).toFixed(1)}M`:Math.abs(Ue)>=1e3?`${(Ue/1e3).toFixed(0)}K`:`${Math.round(Ue)}`,Je=l.name||e.team?.stadium||`Estadio ${h.name}`,rt=K?`${Je} - ${K.name} Arena`:Je,ve=ge.useMemo(()=>{if(!e.fixtures||!e.team)return null;const Ue=e.currentWeek||1;return e.fixtures.find(it=>it.week>=Ue&&!it.played&&it.homeTeam===e.team.id)},[e.fixtures,e.team,e.currentWeek]);return ge.useMemo(()=>{if(!ve)return null;const Ue=OJe(),it=e.leagueTable||[],wt=Ue.find(tt=>tt.id===ve.awayTeam),Mt=it.find(tt=>tt.teamId===ve.awayTeam),_e=it.find(tt=>tt.teamId===e.team?.id),le=it.length||20;if(!wt)return null;const Ge=l.matchPriceAdjust?E+l.matchPriceAdjust:E;return{rivalTeam:wt,rivalName:wt.shortName||wt.name,week:ve.week,prediction:sJe({stadiumCapacity:f,seasonTickets:U,ticketPrice:Ge,rivalTeam:wt,rivalPosition:Mt?.played>0?it.findIndex(tt=>tt.teamId===wt.id)+1:10,teamPosition:_e?.played>0?it.findIndex(tt=>tt.teamId===e.team?.id)+1:10,totalTeams:le,streak:_e?.streak||0,morale:_e?.morale||70,leagueId:e.playerLeagueId||"laliga",homeTeamId:e.team?.id,awayTeamId:wt.id,teamOverall:F,teamReputation:D,division:ne}),matchPrice:Ge}},[ve,e.leagueTable,e.team,e.playerLeagueId,f,U,E,l.matchPriceAdjust]),d.jsxs("div",{className:"stadium-simple",children:[!r&&d.jsx("div",{className:"stadium-simple__3d-viewer",children:d.jsx(kJe,{children:d.jsx(ge.Suspense,{fallback:d.jsx("div",{className:"stadium-3d-loading",children:a("stadium.loadingStadium")}),children:d.jsx(FJe,{level:u,naming:K,grassCondition:q})})})}),d.jsxs("div",{className:"stadium-simple__header",children:[d.jsxs("div",{className:"stadium-info",children:[d.jsx("h1",{children:rt}),d.jsxs("p",{children:[h.name,"  ",f.toLocaleString()," ",a("stadium.seats")]})]}),d.jsxs("div",{className:"stadium-stats",children:[d.jsxs("div",{className:"stat",children:[d.jsxs("span",{className:"value",children:["+",((be-1)*100).toFixed(1),"%"]}),d.jsx("span",{className:"label",children:a("stadium.homeAdvantage")})]}),d.jsxs("div",{className:"stat",children:[d.jsxs("span",{className:"value",children:[Math.round(oe*100),"%"]}),d.jsx("span",{className:"label",children:a("stadium.occupation")})]}),d.jsxs("div",{className:"stat",children:[d.jsxs("span",{className:"value",children:[q,"%"]}),d.jsx("span",{className:"label",children:a("stadium.grass")})]}),d.jsxs("div",{className:"stat highlight",children:[d.jsx("span",{className:"value",children:ze(e.money)}),d.jsx("span",{className:"label",children:a("stadium.budget")})]})]})]}),d.jsxs("div",{className:"stadium-simple__tabs",children:[d.jsxs("button",{className:i==="general"?"active":"",onClick:()=>s("general"),children:[d.jsx(v_,{size:14})," ",a("stadium.general")]}),d.jsxs("button",{className:i==="sponsors"?"active":"",onClick:()=>s("sponsors"),children:[d.jsx(ju,{size:14})," ",a("stadium.sponsorship")]}),d.jsxs("button",{className:i==="events"?"active":"",onClick:()=>s("events"),children:[d.jsx(yk,{size:14})," ",a("stadium.events")]})]}),i==="general"&&d.jsxs("div",{className:"stadium-simple__general",children:[d.jsxs("div",{className:"card",children:[d.jsxs("h3",{children:[d.jsx(WC,{size:14})," ",a("stadium.seasonTicketCampaign")]}),x?d.jsxs(d.Fragment,{children:[d.jsxs("p",{className:"card-hint campaign-open",children:[d.jsx(lTe,{size:12})," ",a("stadium.campaignOpen",{deadline:A,current:m})]}),d.jsxs("div",{className:"season-price-section",children:[d.jsx("label",{children:a("stadium.seasonTicketPrice")}),d.jsxs("div",{className:"price-control",children:[d.jsx("button",{onClick:()=>Le(-50),children:"-50"}),d.jsxs("span",{className:"price-value",children:["",T]}),d.jsx("button",{onClick:()=>Le(50),children:"+50"})]}),d.jsx("p",{className:"price-detail",children:a("stadium.pricePerMatch",{matches:YY,pricePerMatch:ze(T/YY)})})]}),d.jsxs("div",{className:"season-preview",children:[d.jsx("label",{children:a("stadium.expectedSubscribers")}),d.jsxs("div",{className:"abonados-info",children:[d.jsx("span",{className:"big-number",children:L.toLocaleString()}),d.jsxs("span",{className:"of-total",children:["/ ",j.toLocaleString()," ",a("stadium.maxShort")]})]}),d.jsx("div",{className:"progress-bar",children:d.jsx("div",{className:"fill",style:{width:`${L/j*100}%`}})}),d.jsxs("div",{className:"abonados-factors",children:[d.jsxs("span",{title:"Overall medio",children:[" ",F]}),d.jsxs("span",{title:"Posicin liga",children:[d.jsx(v_,{size:12})," ",G,""]}),d.jsxs("span",{title:"Reputacin",children:[d.jsx(Ai,{size:12})," ",D]})]})]}),d.jsxs("button",{className:"btn-close-campaign",onClick:Fe,children:[d.jsx(uo,{size:14})," ",a("stadium.closeCampaign")]})]}):d.jsxs("div",{className:"campaign-closed-card",children:[d.jsxs("div",{className:"campaign-closed-header",children:[d.jsx("span",{className:"lock-icon",children:d.jsx(vy,{size:14})}),d.jsx("span",{children:a("stadium.campaignClosed")})]}),d.jsxs("div",{className:"campaign-closed-stats",children:[d.jsxs("div",{className:"campaign-stat main",children:[d.jsx("span",{className:"stat-value",children:U.toLocaleString()}),d.jsx("span",{className:"stat-label",children:a("stadium.subscribers")})]}),d.jsx("div",{className:"campaign-stat-divider"}),d.jsxs("div",{className:"campaign-stat",children:[d.jsxs("span",{className:"stat-value",children:["",l.seasonTicketPriceFinal||T]}),d.jsx("span",{className:"stat-label",children:a("stadium.pricePerTicket")})]}),d.jsx("div",{className:"campaign-stat-divider"}),d.jsxs("div",{className:"campaign-stat",children:[d.jsx("span",{className:"stat-value",children:ze((U||0)*(l.seasonTicketPriceFinal||T))}),d.jsx("span",{className:"stat-label",children:a("stadium.collected")})]})]}),d.jsx("div",{className:"campaign-closed-bar",children:d.jsx("div",{className:"bar-fill",style:{width:`${Math.min(100,U/Math.floor(f*.8)*100)}%`}})}),d.jsx("div",{className:"campaign-closed-footer",children:d.jsx("span",{children:a("stadium.ofCapacitySubscribed",{percent:Math.round(U/f*100)})})})]})]}),d.jsxs("div",{className:"card",children:[d.jsxs("h3",{children:[d.jsx(WC,{size:14})," ",a("stadium.ticketPrice")]}),d.jsx("p",{className:"card-hint",children:M?d.jsxs(d.Fragment,{children:[d.jsx(vy,{size:12})," ",a("stadium.priceLocked")]}):a("stadium.setPriceBeforeLeague")}),d.jsxs("div",{className:"price-control",children:[d.jsx("button",{onClick:()=>Ie(-5),disabled:M,className:M?"locked":"",children:"-5"}),d.jsxs("span",{className:"price-value",children:["",E]}),d.jsx("button",{onClick:()=>Ie(5),disabled:M,className:M?"locked":"",children:"+5"})]}),d.jsxs("div",{className:"accumulated-income",children:[d.jsxs("div",{className:"accumulated-row",children:[d.jsxs("span",{className:"label",children:[d.jsx(ju,{size:12})," ",a("stadium.accumulatedTicketIncome")]}),d.jsx("span",{className:"value accumulated-value",children:ze(N)})]}),d.jsx("p",{className:"accumulated-hint",children:a("stadium.onlyTicketsSold")})]}),(l.lastMatchTicketSales!=null||l.lastMatchIncome!=null)&&d.jsxs("div",{className:"last-match-info",children:[d.jsxs("h4",{children:[d.jsx(v_,{size:12})," ",a("stadium.lastHomeMatchday")]}),d.jsxs("div",{className:"last-match-stats",children:[l.lastMatchTicketSales!=null&&d.jsxs("div",{className:"stat-row",children:[d.jsxs("span",{className:"label",children:[d.jsx(WC,{size:12})," ",a("stadium.ticketsSold")]}),d.jsx("span",{className:"value",children:l.lastMatchTicketSales.toLocaleString()})]}),l.lastMatchAttendance!=null&&d.jsxs("div",{className:"stat-row",children:[d.jsxs("span",{className:"label",children:[d.jsx(Hu,{size:12})," ",a("stadium.totalAttendance")]}),d.jsx("span",{className:"value",children:l.lastMatchAttendance.toLocaleString()})]}),l.lastMatchIncome!=null&&d.jsxs("div",{className:"stat-row income",children:[d.jsxs("span",{className:"label",children:[d.jsx(ju,{size:12})," ",a("stadium.ticketIncome")]}),d.jsx("span",{className:"value",children:ze(l.lastMatchIncome)})]})]})]})]}),d.jsxs("div",{className:"card grass-card",children:[d.jsxs("h3",{children:[d.jsx(GF,{size:14})," ",a("stadium.grassCondition")]}),d.jsxs("div",{className:"grass-bar",children:[d.jsx("div",{className:`fill ${q<50?"danger":q<70?"warning":""}`,style:{width:`${q}%`}}),d.jsxs("span",{className:"grass-percent",children:[q,"%"]})]}),d.jsxs("div",{className:"grass-status",children:[q>=80&&d.jsxs("span",{className:"status good",children:[d.jsx(uo,{size:12})," ",a("stadium.optimal")]}),q>=50&&q<80&&d.jsxs("span",{className:"status warning",children:[d.jsx(wr,{size:12})," ",a("stadium.injuryRisk",{percent:Math.round((100-q)/2)})]}),q<50&&d.jsxs("span",{className:"status danger",children:[d.jsx(kd,{size:12})," ",a("stadium.injuryRisk",{percent:Math.round(100-q)})]})]}),d.jsxs("p",{className:"grass-hint",children:[q<100?a("stadium.recovers"):a("stadium.perfectCondition"),q<70&&`  ${a("stadium.poorGrassWarning")}`]}),q<70&&d.jsxs("button",{className:"repair-btn",onClick:Me,disabled:e.money<2e5,children:[d.jsx(zT,{size:14})," ",a("stadium.repairGrass",{cost:ze(2e5)})]})]})]}),i==="sponsors"&&d.jsx("div",{className:"stadium-simple__sponsors",children:K?d.jsxs("div",{className:"current-sponsor",children:[d.jsxs("h3",{children:[d.jsx(O2,{size:14})," ",a("stadium.currentSponsor")]}),d.jsxs("div",{className:"sponsor-info",children:[d.jsx("span",{className:"sponsor-name",children:K.name}),d.jsxs("span",{className:"sponsor-income",children:[ze(K.yearlyIncome),a("stadium.perYear")]}),d.jsx("span",{className:"sponsor-years",children:a("stadium.yearsRemaining",{years:K.yearsLeft})})]}),d.jsx("button",{className:"cancel-btn",onClick:je,children:a("stadium.cancelContract")}),d.jsxs("span",{className:"cancel-warning",children:[d.jsx(wr,{size:12})," ",a("stadium.penalty",{amount:ze(Math.round(K.yearlyIncome*K.yearsLeft*.5))})]})]}):d.jsxs(d.Fragment,{children:[d.jsxs("h3",{children:[d.jsx(ju,{size:14})," ",a("stadium.namingOffers")]}),d.jsx("p",{className:"hint",children:a("stadium.sellStadiumName")}),te.length>0?d.jsx("div",{className:"sponsors-list",children:te.map(Ue=>d.jsxs("div",{className:"sponsor-offer",children:[d.jsxs("div",{className:"offer-info",children:[d.jsx("span",{className:"name",children:Ue.name}),d.jsxs("span",{className:"price",children:[ze(Ue.offer),"/ao"]}),d.jsxs("span",{className:"duration",children:[Ue.duration," aos"]})]}),d.jsx("button",{onClick:()=>at(Ue),children:a("stadium.accept")})]},Ue.id))}):d.jsx("p",{className:"no-offers",children:a("stadium.upgradeForSponsors")})]})}),i==="events"&&d.jsxs("div",{className:"stadium-simple__events",children:[d.jsxs("h3",{children:[d.jsx(yk,{size:14})," ",a("stadium.organizeEvents")]}),d.jsx("p",{className:"hint",children:a("stadium.generateExtraIncome")}),!ce&&d.jsxs("div",{className:"cooldown-notice",children:[" ",a("stadium.waitMoreWeeks",{weeks:2-Ce})]}),d.jsx("div",{className:"events-list",children:BJe.map(Ue=>d.jsxs("div",{className:`event-item ${ce?"":"disabled"}`,children:[d.jsx("span",{className:"event-icon",children:Ue.icon}),d.jsxs("div",{className:"event-info",children:[d.jsx("span",{className:"event-name",children:a(`stadium.events.${Ue.id}`)}),d.jsxs("span",{className:"event-details",children:[ze(Ue.income),"  ",a("stadium.grassDamage",{percent:Ue.grassDamage})]})]}),d.jsx("button",{onClick:()=>Ve({...Ue,name:a(`stadium.events.${Ue.id}`)}),disabled:!ce||q<30,children:a("stadium.organize")})]},Ue.id))}),q<30&&d.jsxs("p",{className:"grass-warning",children:[d.jsx(wr,{size:12})," ",a("stadium.repairGrassBeforeEvents")]})]})]})}const VJe=a=>[{id:"stadium",name:a("facilities.facilityNames.stadium"),icon:d.jsx(Ol,{size:20}),category:"income",color:"#4a9eff",description:a("facilities.facilityDescs.stadium"),hasSpec:!1,levels:[{name:a("facilities.levelNames.municipal"),capacity:8e3},{name:a("facilities.levelNames.modern"),capacity:18e3},{name:a("facilities.levelNames.large"),capacity:35e3},{name:a("facilities.levelNames.elite"),capacity:55e3},{name:a("facilities.levelNames.legendary"),capacity:8e4}],benefits:[a("facilities.benefits.seats",{count:"8,000"}),a("facilities.benefits.seats",{count:"18,000"}),a("facilities.benefits.seats",{count:"35,000"}),a("facilities.benefits.seats",{count:"55,000"}),a("facilities.benefits.seats",{count:"80,000"})],upgradeCost:[8e6,25e6,6e7,12e7]},{id:"sponsorship",name:a("facilities.facilityNames.sponsorship"),icon:d.jsx(gu,{size:20}),category:"income",color:"#ffd60a",description:a("facilities.facilityDescs.sponsorship"),hasSpec:!1,levels:[{name:a("facilities.levelNames.basic"),income:25e3},{name:a("facilities.levelNames.active"),income:7e4},{name:a("facilities.levelNames.professional"),income:14e4},{name:a("facilities.levelNames.premium"),income:235e3}],benefits:["1M/"+a("common.season").toLowerCase(),"3M/"+a("common.season").toLowerCase(),"6M/"+a("common.season").toLowerCase(),"10M/"+a("common.season").toLowerCase()],upgradeCost:[2e6,6e6,18e6]},{id:"youth",name:a("facilities.facilityNames.youth"),icon:d.jsx(GF,{size:20}),category:"development",color:"#64d97b",description:a("facilities.facilityDescs.youth"),hasSpec:!0,levels:[{name:a("facilities.levelNames.basic"),talentMax:60},{name:a("facilities.levelNames.developed"),talentMax:65},{name:a("facilities.levelNames.advanced"),talentMax:70},{name:a("facilities.levelNames.elite"),talentMax:75}],benefits:[a("facilities.benefits.youthPlayer",{range:"50-60"}),a("facilities.benefits.youthPlayer",{range:"55-65"}),a("facilities.benefits.youthPlayer",{range:"58-70"}),a("facilities.benefits.youthPlayer",{range:"62-75"})],upgradeCost:[5e6,15e6,4e7]},{id:"medical",name:a("facilities.facilityNames.medical"),icon:d.jsx(su,{size:20}),category:"support",color:"#ff6b6b",description:a("facilities.facilityDescs.medical"),hasSpec:!0,levels:[{name:a("facilities.levelNames.basic"),reduction:0},{name:a("facilities.levelNames.improved"),reduction:20},{name:a("facilities.levelNames.advanced"),reduction:35},{name:a("facilities.levelNames.elite"),reduction:50}],benefits:[a("facilities.benefits.standardRecovery"),a("facilities.benefits.injuryReduction",{percent:20,treatments:1}),a("facilities.benefits.injuryReduction",{percent:35,treatments:1}),a("facilities.benefits.injuryReduction",{percent:50,treatments:2})],upgradeCost:[3e6,12e6,35e6]},{id:"scouting",name:a("facilities.facilityNames.scouting"),icon:d.jsx(T0,{size:20}),category:"support",color:"#bf5af2",description:a("facilities.facilityDescs.scouting"),hasSpec:!1,levels:[{name:a("facilities.levelNames.local"),discount:0},{name:a("facilities.levelNames.national"),discount:10},{name:a("facilities.levelNames.european"),discount:20},{name:a("facilities.levelNames.worldwide"),discount:30}],benefits:[a("facilities.benefits.noTransferAdvantage"),a("facilities.benefits.transferDiscount",{percent:10}),a("facilities.benefits.transferDiscount",{percent:20}),a("facilities.benefits.transferDiscount",{percent:30})],upgradeCost:[2e6,8e6,2e7]}],zJe={income:{nameKey:"facilities.categories.income",icon:d.jsx(ju,{size:14}),color:"#ffd60a"},development:{nameKey:"facilities.categories.development",icon:d.jsx(dl,{size:14}),color:"#30d158"},support:{nameKey:"facilities.categories.support",icon:d.jsx(zT,{size:14}),color:"#bf5af2"}};function GJe(){const{t:a}=Sa(),{state:e,dispatch:n}=Va(),[i,s]=ge.useState(null),[r,o]=ge.useState(null),l=e.facilities||{},c=e.facilitySpecs||{},u=e.facilityStats||{},h=e.pendingEvent,f=ge.useMemo(()=>VJe(a),[a]),m=ge.useMemo(()=>{const Q=TF(e.leagueId);e.leagueId&&OAe(e.leagueId);const Y=ue=>ue>=1e6?`${(ue/1e6).toFixed(1)}M`:ue>=1e3?`${Math.round(ue/1e3)}K`:`${ue}`;return f.map(ue=>{const pe={...ue,upgradeCost:ue.upgradeCost.map(Ee=>Math.round(Ee*Q))};if(ue.id==="sponsorship"){const Ee=[25e3,7e4,14e4,235e3];pe.benefits=Ee.map(oe=>{const Ae=Math.round(oe*38);return`${Y(Ae)}/temporada`})}return pe})},[e.leagueId,f]),A=l.medical||0,x=e.medicalSlots||[],T=iZ(A),E=pye(A,x),M=fye(A,e.leagueId),N=hye(A),I=e.team?.players?.filter(Q=>Q.injured&&Q.injuryWeeksLeft>0)||[];I.filter(Q=>!x.includes(Q.name));const F=Q=>Q>=1e6?`${(Q/1e6).toFixed(1)}M`:`${(Q/1e3).toFixed(0)}K`,G=()=>{const Q=l.sponsorship||0;return m[1].levels[Q].income},O=Q=>{const Y=l[Q.id]||0,ue=Q.levels.length-1;if(Y>=ue)return;const pe=Q.upgradeCost[Y];e.money<pe||(n({type:"UPGRADE_FACILITY",payload:{facilityId:Q.id,cost:pe}}),Q.id==="stadium"&&n({type:"UPDATE_STADIUM",payload:{...e.stadium||{},level:Y+1}}),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"facility",title:`${Q.name} ${a("facilities.upgraded")}`,content:`${a("facilities.level")}: ${Q.levels[Y+1].name}. ${Q.benefits[Y+1]}`,date:`${a("common.week")} ${e.currentWeek}`}}))},D=(Q,Y)=>{n({type:"SET_FACILITY_SPEC",payload:{facility:Q,spec:Y}}),s(null)},j=Q=>{n({type:"HANDLE_EVENT_CHOICE",payload:Q})},L=()=>{n({type:"DISMISS_EVENT"})},U=Q=>{E<=0||e.money<M||n({type:"APPLY_MEDICAL_TREATMENT",payload:{playerName:Q,healingWeeks:N,cost:M}})},q=e.facilitySpecsLocked||{},K=Q=>{const Y=a_[Q];if(!Y)return null;const ue=c[Q];return ue&&Y.options.find(pe=>pe.id===ue)||null},H=G(),X=u.youth?.playersGenerated>0?Math.round(u.youth.totalOvr/u.youth.playersGenerated):0,ne=m.reduce((Q,Y)=>(Q[Y.category]||(Q[Y.category]=[]),Q[Y.category].push(Y),Q),{});return d.jsxs("div",{className:"facilities-v2",children:[h&&d.jsx("div",{className:"facilities-v2__modal-overlay",children:d.jsxs("div",{className:"facilities-v2__modal",children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("span",{className:"modal-icon",children:d.jsx(ru,{size:22})}),d.jsx("h3",{children:h.title})]}),d.jsx("p",{className:"modal-message",children:h.message}),d.jsx("div",{className:"modal-choices",children:h.choices.map(Q=>d.jsxs("button",{className:"modal-choice",onClick:()=>j(Q.id),children:[Q.text,Q.cost&&d.jsxs("span",{className:"choice-cost",children:["(",F(Q.cost),")"]})]},Q.id))}),d.jsx("button",{className:"modal-dismiss",onClick:L,children:a("facilities.ignore")})]})}),i&&a_[i]&&!q[i]&&d.jsx("div",{className:"facilities-v2__modal-overlay",onClick:()=>s(null),children:d.jsxs("div",{className:"facilities-v2__modal facilities-v2__modal--spec",onClick:Q=>Q.stopPropagation(),children:[d.jsxs("h3",{children:[d.jsx(Fs,{size:14})," ",a_[i].name]}),d.jsx("p",{className:"modal-subtitle",children:a("facilities.chooseSpecDesc")}),d.jsx("div",{className:"spec-grid",children:a_[i].options.map(Q=>{const Y=c[i]===Q.id;return d.jsxs("button",{className:`spec-card ${Y?"selected":""}`,onClick:()=>D(i,Q.id),children:[d.jsx("span",{className:"spec-card__icon",children:Q.icon}),d.jsx("span",{className:"spec-card__name",children:Q.name}),d.jsx("span",{className:"spec-card__desc",children:Q.description}),Y&&d.jsx("span",{className:"spec-card__check",children:d.jsx(uo,{size:12})})]},Q.id)})}),d.jsx("button",{className:"modal-close",onClick:()=>s(null),children:a("common.close")})]})}),d.jsxs("div",{className:"facilities-v2__header",children:[d.jsxs("div",{className:"header-title",children:[d.jsxs("h2",{children:[d.jsx(zT,{size:16})," ",a("facilities.title")]}),d.jsx("p",{children:a("facilities.subtitle")})]}),d.jsxs("div",{className:"header-stats",children:[d.jsxs("div",{className:"stat-box stat-box--income",children:[d.jsx("span",{className:"stat-icon",children:d.jsx(ju,{size:14})}),d.jsxs("div",{className:"stat-content",children:[d.jsx("span",{className:"stat-value",children:F(H*43)}),d.jsx("span",{className:"stat-label",children:a("facilities.incomePerSeason")})]})]}),d.jsxs("div",{className:"stat-box stat-box--budget",children:[d.jsx("span",{className:"stat-icon",children:d.jsx(Ol,{size:14})}),d.jsxs("div",{className:"stat-content",children:[d.jsx("span",{className:"stat-value",children:F(e.money)}),d.jsx("span",{className:"stat-label",children:a("common.budget")})]})]})]})]}),A>=2&&d.jsxs("div",{className:"facilities-v2__medical-bay",children:[d.jsxs("div",{className:"medical-header",children:[d.jsxs("div",{className:"medical-title",children:[d.jsx("span",{className:"medical-icon",children:d.jsx(su,{size:16})}),d.jsx("h3",{children:a("facilities.medical.infirmary")})]}),d.jsxs("div",{className:"medical-treatments",children:[d.jsxs("span",{className:"treatment-badge",children:[d.jsx(Pq,{size:12})," ",a("facilities.medical.doctors"),": ",E,"/",T," ",a("facilities.medical.available")]}),A>0&&d.jsxs("span",{className:"treatment-info",children:[a("facilities.medical.heals"),": -",N," ",a("facilities.medical.weeks")," | ",a("facilities.medical.cost"),": ",F(M)]})]})]}),I.length===0?d.jsxs("div",{className:"medical-empty",children:[d.jsx("span",{children:d.jsx(uo,{size:14})})," ",a("facilities.medical.noInjured")]}):d.jsx("div",{className:"medical-list",children:I.map(Q=>{const Y=x.includes(Q.name),ue=E>0&&!Y&&A>0,pe=Math.max(0,Q.injuryWeeksLeft-N);return d.jsxs("div",{className:`medical-player ${Y?"treated":""}`,children:[d.jsx("div",{className:"player-avatar",children:d.jsx("span",{children:ds(Q.position)})}),d.jsxs("div",{className:"player-details",children:[d.jsx("span",{className:"player-name",children:Q.name}),d.jsxs("span",{className:"player-injury",children:[d.jsx(su,{size:12})," ",Q.injuryWeeksLeft," ",a("facilities.medical.weeksShort"),Q.injuryWeeksLeft>1?a("facilities.medical.weeksPlural"):a("facilities.medical.weeksSingular")]})]}),Y?d.jsxs("span",{className:"player-badge treated",children:[d.jsx(Pq,{size:12})," ",a("facilities.medical.inTreatment")]}):A===0?d.jsx("span",{className:"player-badge minor",children:a("facilities.medical.noMedicalCenter")}):d.jsxs("button",{className:"treat-button",onClick:()=>ue&&U(Q.name),disabled:!ue,title:ue?`${a("facilities.medical.reduceTo")} ${pe} ${a("facilities.medical.weeks")}`:a("facilities.medical.noDoctorsAvailable"),children:[d.jsx(Iq,{size:12}),"  ",pe," ",a("facilities.medical.weeksShort")," (",F(M),")"]})]},Q.name)})})]}),Object.entries(ne).map(([Q,Y])=>{const ue=zJe[Q];return d.jsxs("div",{className:"facilities-v2__category",children:[d.jsxs("div",{className:"category-header",style:{"--cat-color":ue.color},children:[d.jsx("span",{className:"category-icon",children:ue.icon}),d.jsx("h3",{children:a(ue.nameKey)})]}),d.jsx("div",{className:"category-grid",children:Y.map(pe=>{const Ee=l[pe.id]||0,oe=pe.levels.length-1,Ae=Ee<oe,be=Ae?pe.upgradeCost[Ee]:null,Ce=be&&e.money>=be,ce=K(pe.id),te=r===pe.id;return d.jsxs("div",{className:`facility-card ${te?"expanded":""}`,style:{"--facility-color":pe.color},children:[d.jsxs("div",{className:"facility-card__main",onClick:()=>o(te?null:pe.id),children:[d.jsxs("div",{className:"facility-card__icon-wrap",children:[d.jsx("span",{className:"facility-card__icon",children:pe.icon}),d.jsx("div",{className:"facility-card__level-badge",children:Ee+1})]}),d.jsxs("div",{className:"facility-card__info",children:[d.jsx("h4",{children:pe.name}),d.jsx("p",{className:"facility-card__desc",children:pe.description}),d.jsx("div",{className:"facility-card__level-bar",children:pe.levels.map((fe,Le)=>d.jsx("div",{className:`level-segment ${Le<=Ee?"filled":""}`},Le))}),d.jsx("div",{className:"facility-card__benefit",children:pe.benefits[Ee]})]}),d.jsx("div",{className:"facility-card__arrow",children:te?"":""})]}),te&&d.jsxs("div",{className:"facility-card__expanded",children:[pe.hasSpec&&d.jsxs("div",{className:`facility-card__spec ${q[pe.id]?"locked":""} ${ce?"":"pending"}`,onClick:()=>!q[pe.id]&&s(pe.id),children:[d.jsxs("span",{className:"spec-label",children:[a("facilities.specialization"),":"]}),ce?d.jsxs(d.Fragment,{children:[d.jsxs("span",{className:"spec-value spec-value--active",children:[ce.icon," ",ce.name]}),d.jsx("span",{className:"spec-locked",children:""})]}):d.jsxs(d.Fragment,{children:[d.jsxs("span",{className:"spec-value spec-value--none",children:[d.jsx("span",{className:"spec-sparkle",children:""})," ",a("facilities.notChosen")]}),d.jsxs("span",{className:"spec-edit",children:[a("facilities.choose")," "]})]})]}),Ae?d.jsxs("div",{className:"facility-card__upgrade",children:[d.jsxs("div",{className:"upgrade-info",children:[d.jsxs("span",{className:"upgrade-label",children:[a("facilities.nextLevel"),":"]}),d.jsx("span",{className:"upgrade-name",children:pe.levels[Ee+1].name}),d.jsx("span",{className:"upgrade-benefit",children:pe.benefits[Ee+1]})]}),d.jsxs("button",{className:`upgrade-button ${Ce?"":"disabled"}`,onClick:fe=>{fe.stopPropagation(),O(pe)},disabled:!Ce,children:[d.jsx("span",{className:"upgrade-text",children:a("facilities.upgrade")}),d.jsx("span",{className:"upgrade-cost",children:F(be)})]})]}):d.jsx("div",{className:"facility-card__maxed",children:a("facilities.maxLevel")}),d.jsx("div",{className:"facility-card__levels",children:pe.levels.map((fe,Le)=>d.jsxs("div",{className:`level-item ${Le<=Ee?"unlocked":""} ${Le===Ee?"current":""}`,children:[d.jsx("span",{className:"level-num",children:Le+1}),d.jsx("span",{className:"level-name",children:fe.name}),d.jsx("span",{className:"level-benefit",children:pe.benefits[Le]})]},Le))})]})]},pe.id)})})]},Q)}),(u.youth?.playersGenerated>0||u.medical?.weeksSaved>0||u.medical?.treatmentsApplied>0)&&d.jsxs("div",{className:"facilities-v2__impact",children:[d.jsxs("h3",{children:[d.jsx(v_,{size:14})," ",a("facilities.impact.title")]}),d.jsxs("div",{className:"impact-grid",children:[u.youth?.playersGenerated>0&&d.jsxs("div",{className:"impact-item",children:[d.jsx("span",{className:"impact-icon",children:d.jsx(GF,{size:14})}),d.jsx("span",{className:"impact-value",children:u.youth.playersGenerated}),d.jsxs("span",{className:"impact-label",children:[a("facilities.impact.youth")," (",X," OVR)"]})]}),u.medical?.treatmentsApplied>0&&d.jsxs("div",{className:"impact-item",children:[d.jsx("span",{className:"impact-icon",children:d.jsx(Iq,{size:12})}),d.jsx("span",{className:"impact-value",children:u.medical.treatmentsApplied}),d.jsx("span",{className:"impact-label",children:a("facilities.impact.treatments")})]}),u.medical?.weeksSaved>0&&d.jsxs("div",{className:"impact-item",children:[d.jsx("span",{className:"impact-icon",children:d.jsx(or,{size:16})}),d.jsx("span",{className:"impact-value",children:u.medical.weeksSaved}),d.jsx("span",{className:"impact-label",children:a("facilities.impact.weeksSaved")})]})]})]})]})}const NC={match_result:d.jsx(Lo,{size:16}),transfer:d.jsx(gu,{size:16}),transfer_offer:d.jsx(_y,{size:16}),injury:d.jsx(su,{size:16}),contract:d.jsx(FF,{size:16}),news:d.jsx(bN,{size:16}),board:d.jsx(UF,{size:16}),default:d.jsx(_y,{size:16})};function qJe(){const{t:a}=Sa(),{state:e,dispatch:n}=Va(),[i,s]=ge.useState(null),r=e.messages||[],o=f=>{if(f.titleKey){const m={...f.titleParams};return m&&Object.keys(m).forEach(A=>{if(A.endsWith("Key")&&typeof m[A]=="string"&&!A.endsWith("KeyParams")){const x=A.slice(0,-3);m[x]=a(m[A],m[`${A}Params`])}}),a(f.titleKey,m)}return f.title},l=f=>{if(f.contentKey){const m={...f.contentParams};return m&&Object.keys(m).forEach(A=>{if(A.endsWith("Key")&&typeof m[A]=="string"&&!A.endsWith("KeyParams")){const x=A.slice(0,-3);m[x]=a(m[A],m[`${A}Params`])}}),a(f.contentKey,m)}return f.content},c=f=>f.dateKey?a(f.dateKey,f.dateParams):f.date,u=f=>{n({type:"DELETE_MESSAGE",payload:f}),i?.id===f&&s(null)},h=()=>{window.confirm(a("messages.deleteAllConfirm"))&&(n({type:"CLEAR_MESSAGES"}),s(null))};return d.jsxs("div",{className:"messages",children:[d.jsxs("div",{className:"messages__header",children:[d.jsxs("h2",{children:[a("messages.inbox")," (",r.length,")"]}),r.length>0&&d.jsxs("button",{className:"messages__clear",onClick:h,children:[d.jsx(UT,{size:14})," ",a("messages.deleteAll")]})]}),r.length===0?d.jsxs("div",{className:"messages__empty",children:[d.jsx("span",{className:"icon",children:d.jsx(zSe,{size:22})}),d.jsx("p",{children:a("messages.noMessages")})]}):d.jsxs("div",{className:"messages__content",children:[d.jsx("div",{className:"messages__list",children:r.map(f=>d.jsxs("div",{className:`messages__item ${i?.id===f.id?"selected":""}`,onClick:()=>s(f),children:[d.jsx("span",{className:"messages__icon",children:NC[f.type]||NC.default}),d.jsxs("div",{className:"messages__item-content",children:[d.jsx("span",{className:"title",children:o(f)}),d.jsx("span",{className:"date",children:c(f)})]}),d.jsx("button",{className:"messages__delete",onClick:m=>{m.stopPropagation(),u(f.id)},children:d.jsx(zr,{size:14})})]},f.id))}),i&&d.jsxs("div",{className:"messages__detail",children:[d.jsxs("button",{className:"messages__detail-close",onClick:()=>s(null),children:[" ",a("messages.backToMessages")]}),d.jsxs("div",{className:"messages__detail-header",children:[d.jsx("span",{className:"icon",children:NC[i.type]||NC.default}),d.jsxs("div",{className:"info",children:[d.jsx("h3",{children:o(i)}),d.jsx("span",{className:"date",children:c(i)})]})]}),d.jsx("div",{className:"messages__detail-body",children:d.jsx("p",{children:l(i)})}),d.jsx("button",{className:"messages__detail-delete",onClick:()=>u(i.id),children:a("messages.deleteMessage")})]})]})]})}const HJe=52,QY=[{name:"Municipal",capacity:8e3,maintenance:5e5},{name:"Moderno",capacity:18e3,maintenance:12e5},{name:"Grande",capacity:35e3,maintenance:25e5},{name:"lite",capacity:55e3,maintenance:4e6},{name:"Legendario",capacity:8e4,maintenance:6e6}];function WJe(){const{state:a}=Va(),{t:e}=Sa(),n=o=>{if(o===0)return"0";const l=Math.abs(o),c=o>0?"+":o<0?"-":"";return l>=1e6?`${c}${(l/1e6).toFixed(1)}M`:l>=1e3?`${c}${(l/1e3).toFixed(0)}K`:`${c}${l}`},i=o=>{const l=Math.abs(o);return l>=1e6?`${(l/1e6).toFixed(1)}M`:l>=1e3?`${(l/1e3).toFixed(0)}K`:`${l}`},s=ge.useMemo(()=>{const o=a.stadium||{},l=a.team?.players||[],c=a.facilities?.stadium??o.level??0,u=Math.max(0,Math.min(QY.length-1,c)),h=QY[u],f=o.seasonTicketsFinal??0,m=o.seasonTicketPriceFinal??o.seasonTicketPrice??400,A=f*m,x=o.accumulatedTicketIncome??0,T=o.naming?.yearlyIncome??0,E=a.transfersEarned??0,M=a.prizeIncome??0,N=A+x+T+E+M,I=l.reduce((q,K)=>q+(K.salary||0),0),F=a.currentWeek||1,G=I*HJe,O=0,D=h?.maintenance||5e5,j=a.transfersSpent??0,L=G+D+j,U=N-L;return{currentBudget:a.money||0,weeklySalaries:I,annualSalaries:G,weeksPlayed:F,salariesPaid:O,seasonTickets:f,seasonTicketPrice:m,seasonTicketIncome:A,accumulatedTicketIncome:x,namingIncome:T,maintenanceCost:D,transferSpent:j,transferEarned:E,prizeIncome:M,totalIncome:N,totalExpenses:L,balance:U,level:h?.name||"Municipal"}},[a]),r=({label:o,amount:l,detail:c})=>d.jsxs("div",{className:"finance-row",children:[d.jsxs("div",{className:"finance-row__label",children:[d.jsx("span",{children:o}),c&&d.jsx("span",{className:"detail",children:c})]}),d.jsx("span",{className:`finance-row__amount ${l>0?"positive":l<0?"negative":""}`,children:n(l)})]});return d.jsxs("div",{className:"finance",children:[d.jsxs("div",{className:"finance__header",children:[d.jsx("h2",{children:e("finance.bank")}),d.jsxs("div",{className:"finance__budget",children:[d.jsx("span",{className:"label",children:e("finance.currentBudget")}),d.jsx("span",{className:"amount",children:i(s.currentBudget)})]})]}),d.jsxs("div",{className:"finance__section",children:[d.jsx("h3",{children:e("finance.currentSeason")}),d.jsxs("div",{className:"finance__group",children:[d.jsx("div",{className:"finance__group-title income",children:e("finance.income")}),d.jsx(r,{label:e("finance.seasonTickets"),amount:s.seasonTicketIncome,detail:s.seasonTickets>0?`${s.seasonTickets.toLocaleString()}  ${s.seasonTicketPrice}  ${e("finance.pending")}`:e("finance.noCampaignClosed")}),d.jsx(r,{label:e("finance.ticketsSold"),amount:s.accumulatedTicketIncome,detail:e("finance.accumulatedMatches")}),s.namingIncome>0&&d.jsx(r,{label:e("finance.stadiumNaming"),amount:s.namingIncome}),s.transferEarned>0&&d.jsx(r,{label:e("finance.playerSales"),amount:s.transferEarned}),s.prizeIncome>0&&d.jsx(r,{label:e("finance.prizesRewards"),amount:s.prizeIncome})]}),d.jsxs("div",{className:"finance__group",children:[d.jsx("div",{className:"finance__group-title expense",children:e("finance.expenses")}),d.jsx(r,{label:e("finance.squadSalaries"),amount:-s.annualSalaries,detail:`${i(s.weeklySalaries)}/sem  52 sem  ${e("finance.pending")}`}),d.jsx(r,{label:e("finance.stadiumMaintenance"),amount:-s.maintenanceCost,detail:s.level}),s.transferSpent>0&&d.jsx(r,{label:e("finance.signings"),amount:-s.transferSpent})]}),d.jsxs("div",{className:"finance__total",children:[d.jsx("span",{children:e("finance.seasonBalance")}),d.jsx("span",{className:s.balance>=0?"positive":"negative",children:n(s.balance)})]})]})]})}const v6=()=>[...hu(),...fu(),...pu(),...mu(),...pf(),...mf(),...gf(),...Af(),...yf(),...vf(),..._f(),...xf(),...bf(),...Sf(),...Tf(),...wf(),...Ef(),...Mf(),...Cf(),...Nf(),...Rf(),...Pf(),...If(),...Lf(),...Df(),...kf(),...Of(),...Ff(),...jf(),...Bf(),...Uf(),...Vf(),...zf()];function $Je({onComplete:a}){const{t:e}=Sa(),{state:n,dispatch:i}=Va(),[s,r]=ge.useState("preview"),[o,l]=ge.useState(null),[c,u]=ge.useState(0),[h,f]=ge.useState(0),m=ge.useRef(null),A=Y=>typeof Y=="object"?Y?.name||e("common.unknown"):Y||e("common.unknown");ge.useEffect(()=>{m.current&&(m.current.scrollTop=m.current.scrollHeight)},[c]);let x,T=!1,E=!1,M=!1,N=null,I=null;if(n.pendingCupMatch)I=n.pendingCupMatch,M=!0,x={homeTeam:I.homeTeam?.teamId,awayTeam:I.awayTeam?.teamId,week:n.currentWeek,isCup:!0};else if(n.pendingEuropeanMatch){N=n.pendingEuropeanMatch,E=!0;const Y=n.pendingEuropeanMatch;x={homeTeam:Y.homeTeamId||Y.homeTeam?.teamId||Y.team1?.teamId,awayTeam:Y.awayTeamId||Y.awayTeam?.teamId||Y.team2?.teamId,week:n.currentWeek,isEuropean:!0,competitionId:Y.competitionId,competitionName:Y.competitionName,matchday:Y.matchday,phase:Y.phase}}else if(n.pendingSAMatch){N=n.pendingSAMatch,E=!0;const Y=n.pendingSAMatch;x={homeTeam:Y.homeTeamId||Y.homeTeam?.teamId||Y.team1?.teamId,awayTeam:Y.awayTeamId||Y.awayTeam?.teamId||Y.team2?.teamId,week:n.currentWeek,isEuropean:!0,isSouthAmerican:!0,competitionId:Y.competitionId,competitionName:Y.competitionName,matchday:Y.matchday,phase:Y.phase}}else if(n.preseasonPhase&&n.preseasonMatches?.length>0){const Y=(n.preseasonWeek||1)-1;x=n.preseasonMatches[Y],T=!0}else x=n.fixtures.find(Y=>Y.week===n.currentWeek&&!Y.played&&(Y.homeTeam===n.teamId||Y.awayTeam===n.teamId));const F=M?I.homeTeam?.teamId===n.teamId:E?N.isHome??x?.homeTeam===n.teamId:x?.homeTeam===n.teamId,G=F?x?.awayTeam:x?.homeTeam;let O;if(M){const Y=F?I.awayTeam:I.homeTeam;O={...Y,id:Y?.teamId,name:Y?.teamName,shortName:Y?.shortName||Y?.teamName?.substring(0,3)?.toUpperCase(),players:Y?.players||[],reputation:Y?.reputation||70}}else if(E){const Y=N;F?O=Y.awayTeam||Y.team2||{teamId:G,name:e("common.unknown"),reputation:70}:O=Y.homeTeam||Y.team1||{teamId:G,name:e("common.unknown"),reputation:70},!O.id&&O.teamId&&(O={...O,id:O.teamId}),!O.name&&O.teamName&&(O={...O,name:O.teamName})}else T&&x?.opponent?O=x.opponent:O=v6().find(Y=>Y.id===G);if(!x||!O){const Y={teamId:n.teamId,currentWeek:n.currentWeek,fixturesCount:n.fixtures?.length||0,weekFixtures:n.fixtures?.filter(ue=>ue.week===n.currentWeek)||[],allTeamsCount:v6().length,playerMatchFound:!!x,opponentFound:!!O,opponentId:G};return console.error("MatchDay Debug (early guard):",Y),d.jsx("div",{className:"match-day",children:d.jsxs("div",{className:"match-day__no-match",children:[d.jsx("p",{children:e("matchday.noMatchThisWeek")}),d.jsx("button",{onClick:a,children:e("common.continue")})]})})}const D=B3(n.team,n.formation,n.tactic,70,n.lineup),j=O?.players?.length>0?B3(O,"4-3-3","balanced"):{overall:O?.reputation||70,attack:(O?.reputation||70)*.9,defense:(O?.reputation||70)*.85},L=n.leagueTable.find(Y=>Y.teamId===n.teamId),U=n.leagueTable.find(Y=>Y.teamId===G),q=()=>{try{console.log(" simulateAndPlay started"),r("playing");const Y=O?.players?.length>0?O:{...O,id:O?.id||G,name:O?.name||"Rival",shortName:O?.shortName||O?.name?.slice(0,3)?.toUpperCase()||"RIV",players:Array.from({length:18},(fe,Le)=>({name:`Jugador ${Le+1}`,position:["GK","CB","CB","CB","RB","LB","CM","CM","CDM","CAM","RM","LM","RW","LW","ST","ST","CF","GK"][Le],overall:Math.round((O?.reputation||70)+(Math.random()*10-5)),age:22+Math.floor(Math.random()*10),stamina:80+Math.floor(Math.random()*15)}))},ue=F?n.team:Y,pe=F?Y:n.team;console.log(" Teams:",{homeTeamData:ue?.name,awayTeamData:pe?.name});let Ee=.7,oe=null;if(F&&n.stadium){const fe=n.stadium,Le=[8e3,18e3,35e3,55e3,8e4][fe.level||0],Fe=fe.realCapacity||Le,Ie=fe.seasonTicketsFinal??fe.seasonTickets??Math.floor(Fe*.3),at=(fe.ticketPrice??30)+(fe.matchPriceAdjust||0),je=n.leagueTable.findIndex(ve=>ve.teamId===G)+1||10,Ve=n.leagueTable.findIndex(ve=>ve.teamId===n.teamId)+1||10,Me=n.leagueId||"laliga",ze=["segunda","segundaRFEF","primeraRFEF"].includes(Me)?2:1,Je=n.team?.players||[],rt=Je.length>0?Math.round(Je.reduce((ve,Ue)=>ve+(Ue.overall||70),0)/Je.length):70;oe=FR({stadiumCapacity:Fe,seasonTickets:Ie,ticketPrice:at,rivalTeam:O,rivalPosition:je,teamPosition:Ve,totalTeams:n.leagueTable.length||20,streak:L?.streak||0,morale:L?.morale||70,leagueId:Me,homeTeamId:n.teamId,awayTeamId:G,teamOverall:rt,teamReputation:n.team?.reputation||70,division:ze}),Ee=oe.fillRate}const Ae=F?n.stadium?.grassCondition??100:100;console.log(" About to simulateMatch...");const be=jl(x.homeTeam,x.awayTeam,ue,pe,{homeFormation:F?n.formation:"4-3-3",awayFormation:F?"4-3-3":n.formation,homeTactic:F?n.tactic:"balanced",awayTactic:F?"balanced":n.tactic,homeMorale:F?L?.morale||70:U?.morale||70,awayMorale:F?U?.morale||70:L?.morale||70,isDerby:!1,importance:"normal",attendanceFillRate:F?Ee:.7,grassCondition:Ae,homeLineup:F?n.lineup:null,awayLineup:F?null:n.lineup,playerIsHome:F,medicalPrevention:n.facilitySpecs?.medical==="prevention"?.3:0},n.playerForm||{},n.teamId);console.log(" simulateMatch done, result:",be?"OK":"NULL",be?.homeScore,"-",be?.awayScore),oe&&(be.attendance=oe),console.log(" Setting matchResult..."),l(be),console.log(" matchResult set, starting animation...");let Ce=0,ce=0;const te=setInterval(()=>{for(Ce+=3,f(Math.min(90,Ce));ce<be.events.length&&be.events[ce].minute<=Ce;)u(ce+1),ce++;Ce>=95&&(clearInterval(te),u(be.events.length),setTimeout(()=>r("result"),500))},150)}catch(Y){console.error(" Error in simulateAndPlay:",Y),console.error(" Stack:",Y.stack),r("preview"),alert("Error al simular el partido: "+Y.message)}},K=()=>{o&&(f(90),u(o.events.length),r("result"))},H=()=>{if(M&&I){i({type:"COMPLETE_CUP_MATCH",payload:{roundIdx:I.roundIdx,matchIdx:I.matchIdx,homeScore:o.homeScore,awayScore:o.awayScore}});const Ae=F?"home":"away";o.events.filter(fe=>fe.type==="injury"&&fe.team===Ae).forEach(fe=>{i({type:"INJURE_PLAYER",payload:{playerName:A(fe.player),weeksOut:fe.weeksOut,severity:fe.severity}})});const Ce=F?o.awayScore:o.homeScore;i({type:"UPDATE_PLAYER_SEASON_STATS",payload:{events:o.events,playerTeamSide:F?"home":"away",cleanSheet:Ce===0}}),i({type:"SERVE_SUSPENSIONS"});const ce=o.events.filter(fe=>fe.type==="yellow_card"&&fe.team===(F?"home":"away"));ce.length>0&&i({type:"ADD_YELLOW_CARDS",payload:{cards:ce.map(fe=>({playerName:A(fe.player)}))}});const te=o.events.filter(fe=>fe.type==="red_card"&&fe.team===(F?"home":"away"));te.length>0&&i({type:"ADD_RED_CARDS",payload:{cards:te.map(fe=>({playerName:A(fe.player),reason:fe.reason||"Roja directa"}))}}),a("cup");return}if(E&&N){const Ae=!!x.isSouthAmerican,be={homeTeamId:x.homeTeam,awayTeamId:x.awayTeam,homeScore:o.homeScore,awayScore:o.awayScore,events:o.events||[]};i({type:Ae?"COMPLETE_SA_MATCH":"COMPLETE_EUROPEAN_MATCH",payload:{competitionId:N.competitionId,matchResult:be,matchday:N.matchday,phase:N.phase}});const Ce=F?o.homeScore:o.awayScore,ce=F?o.awayScore:o.homeScore,te=Ce>ce?"Victoria!":Ce<ce?"Derrota":"Empate";i({type:"ADD_MESSAGE",payload:{id:Date.now(),type:Ae?"southamerican":"european",title:`${N.competitionName||(Ae?"Sudamericana":"Europa")}: ${n.team.name} ${Ce} - ${ce} ${O?.name||"Rival"}`,content:te,date:`Semana ${n.currentWeek}`}});const fe=F?"home":"away";o.events.filter(at=>at.type==="injury"&&at.team===fe).forEach(at=>{i({type:"INJURE_PLAYER",payload:{playerName:A(at.player),weeksOut:at.weeksOut,severity:at.severity}})}),i({type:"SERVE_SUSPENSIONS"});const Fe=o.events.filter(at=>at.type==="yellow_card"&&at.team===fe);Fe.length>0&&i({type:"ADD_YELLOW_CARDS",payload:{cards:Fe.map(at=>({playerName:A(at.player)}))}});const Ie=o.events.filter(at=>at.type==="red_card"&&at.team===fe);Ie.length>0&&i({type:"ADD_RED_CARDS",payload:{cards:Ie.map(at=>({playerName:A(at.player),reason:at.reason||"Roja directa"}))}}),a(Ae?"southamerican":"european");return}if(!T){let Ae=(Array.isArray(n.fixtures)?n.fixtures:[]).map(te=>te.id===x.id?{...te,played:!0,homeScore:o.homeScore,awayScore:o.awayScore,events:o.events,stats:o.stats}:te),be=V_(n.leagueTable,x.homeTeam,x.awayTeam,o.homeScore,o.awayScore);const Ce=v6().map(te=>te.id===n.teamId?n.team:te),ce=W6(Ae,be,n.currentWeek,n.teamId,Ce);i({type:"SET_FIXTURES",payload:ce.fixtures}),i({type:"SET_LEAGUE_TABLE",payload:ce.table}),i({type:"ADD_RESULT",payload:{week:n.currentWeek,homeTeam:x.homeTeam,awayTeam:x.awayTeam,homeScore:o.homeScore,awayScore:o.awayScore}})}const Y=F?"home":"away",ue=F?o.awayScore:o.homeScore;i({type:"UPDATE_PLAYER_SEASON_STATS",payload:{events:o.events,playerTeamSide:Y,cleanSheet:ue===0}});const pe=F?o.homeScore:o.awayScore,Ee=F?o.awayScore:o.homeScore;if(n.gameMode==="promanager"&&n.proManagerData&&!T){const Ae=pe>Ee?"win":pe<Ee?"loss":"draw",be=n.proManagerData,Ce=n.leagueTable?.findIndex(Fe=>Fe.teamId===n.teamId)+1||10,ce=n.leagueTable?.length||20,te=Ae==="win"?(be.winStreak||0)+1:0,fe=Ae==="loss"?(be.lossStreak||0)+1:0,Le=nye(be.boardConfidence??60,{matchResult:Ae,leaguePosition:Ce,objective:be.objective,totalTeams:ce,winStreak:te,lossStreak:fe});if(i({type:"UPDATE_PROMANAGER_CONFIDENCE",payload:{boardConfidence:Le,winStreak:te,lossStreak:fe,totalMatches:(be.totalMatches||0)+1,totalWins:(be.totalWins||0)+(Ae==="win"?1:0),totalDraws:(be.totalDraws||0)+(Ae==="draw"?1:0),totalLosses:(be.totalLosses||0)+(Ae==="loss"?1:0)}}),Le<=0){i({type:"SET_PROMANAGER_DATA",payload:{...be,fired:!0,boardConfidence:0}}),i({type:"SET_SCREEN",payload:"promanager_season_end"});return}}if(o.events.filter(Ae=>Ae.type==="injury"&&Ae.team===Y).forEach(Ae=>{const be=A(Ae.player);i({type:"INJURE_PLAYER",payload:{playerName:be,weeksOut:Ae.weeksOut,severity:Ae.severity}}),i({type:"ADD_MESSAGE",payload:{id:Date.now()+Math.random(),type:"injury",title:`Lesin: ${be}`,content:`${be} estar ${Ae.weeksOut} semanas de baja (${X(Ae.severity)})`,date:T?`Pretemporada ${n.preseasonWeek}`:`Semana ${n.currentWeek}`}})}),!T){i({type:"SERVE_SUSPENSIONS"});const Ae=o.events.filter(Ce=>Ce.type==="yellow_card"&&Ce.team===Y);Ae.length>0&&i({type:"ADD_YELLOW_CARDS",payload:{cards:Ae.map(Ce=>({playerName:A(Ce.player)}))}});const be=o.events.filter(Ce=>Ce.type==="red_card"&&Ce.team===Y);be.length>0&&i({type:"ADD_RED_CARDS",payload:{cards:be.map(Ce=>({playerName:A(Ce.player),reason:Ce.reason||"Roja directa"}))}})}if(F&&o.attendance){const Ae=o.attendance,be=n.stadium||{},Ce=(be.ticketPrice??30)+(be.matchPriceAdjust||0),te=8+(be.level??0)*2,fe=Ae.ticketSales*Ce,Le=Ae.attendance*te,Fe=fe+Le,Ie=be.accumulatedTicketIncome??0;i({type:"UPDATE_STADIUM",payload:{...be,lastMatchTicketSales:Ae.ticketSales,lastMatchAttendance:Ae.attendance,lastMatchIncome:Fe,accumulatedTicketIncome:Ie+Fe,ticketPriceLocked:!0}});const at=Math.round(Ae.fillRate*100);i({type:"ADD_MESSAGE",payload:{id:Date.now()+.1,type:"stadium",title:`Taquilla: ${Ae.ticketSales.toLocaleString()} entradas vendidas (${at}% aforo)`,content:`Taquilla: ${(fe/1e3).toFixed(0)}K + Consumiciones: ${(Le/1e3).toFixed(0)}K | Acumulado temp.: ${((Ie+Fe)/1e3).toFixed(0)}K`,date:`Semana ${n.currentWeek}`}})}a("league")},X=Y=>{switch(Y){case"minor":return"Lesin leve";case"moderate":return"Lesin moderada";case"serious":return"Lesin grave";default:return"Lesin"}},ne=Y=>{switch(Y){case"golazo":return d.jsxs(d.Fragment,{children:[d.jsx(vN,{size:14})," ",e("matchday.golazo")]});case"great_strike":return d.jsxs(d.Fragment,{children:[d.jsx(Br,{size:14})," Gran disparo"]});case"penalty":return"(Penalti)";case"header":return"(Cabezazo)";case"tap_in":return"(A placer)";case"corner":return"(Crner)";case"late":return d.jsxs(d.Fragment,{children:[d.jsx(vN,{size:14})," ",e("matchday.lateGoal")]});default:return""}},Q=Y=>!Y||Y.length===0?"Sin datos":Y.map((ue,pe)=>d.jsx("span",{className:`form-item ${ue.toLowerCase()}`,children:ue},pe));return d.jsxs("div",{className:"match-day",children:[d.jsxs("div",{className:"match-day__content",children:[s==="preview"&&d.jsxs("div",{className:"match-day__preview",children:[d.jsx("h2",{children:M?`${I.cupIcon||""} ${I.cupShortName||"Copa"}  ${I.roundName||"Ronda"}`:E?`${N.competitionName||"Europa"}  ${N.phase==="league"?`Jornada ${N.matchday}`:N.phase}`:T?`Amistoso ${n.preseasonWeek}/5`:`Jornada ${n.currentWeek}`}),d.jsxs("div",{className:"match-day__teams",children:[d.jsxs("div",{className:`match-day__team ${F?"player":""}`,children:[F?d.jsx("span",{className:"home-tag",children:"LOCAL"}):d.jsx("span",{className:"tag-spacer"}),d.jsx("div",{className:"badge",children:F?n.team.shortName:O.shortName}),d.jsx("h3",{children:F?n.team.name:O.name}),d.jsx("div",{className:"team-form",children:Q(F?L?.form:U?.form)})]}),d.jsx("div",{className:"match-day__vs",children:"VS"}),d.jsxs("div",{className:`match-day__team ${F?"":"player"}`,children:[F?d.jsx("span",{className:"tag-spacer"}):d.jsx("span",{className:"away-tag",children:"VISITANTE"}),d.jsx("div",{className:"badge",children:F?O.shortName:n.team.shortName}),d.jsx("h3",{children:F?O.name:n.team.name}),d.jsx("div",{className:"team-form",children:Q(F?U?.form:L?.form)})]})]}),d.jsxs("div",{className:"match-day__comparison",children:[d.jsxs("div",{className:"comparison-row",children:[d.jsx("span",{className:"home-val",children:Math.round(D.overall)}),d.jsx("span",{className:"label",children:"Fuerza Global"}),d.jsx("span",{className:"away-val",children:Math.round(j.overall)})]}),d.jsxs("div",{className:"comparison-row",children:[d.jsx("span",{className:"home-val",children:Math.round(F?D.attack:j.attack)}),d.jsx("span",{className:"label",children:"Ataque"}),d.jsx("span",{className:"away-val",children:Math.round(F?j.attack:D.attack)})]}),d.jsxs("div",{className:"comparison-row",children:[d.jsx("span",{className:"home-val",children:Math.round(F?D.defense:j.defense)}),d.jsx("span",{className:"label",children:"Defensa"}),d.jsx("span",{className:"away-val",children:Math.round(F?j.defense:D.defense)})]})]}),d.jsxs("div",{className:"match-day__tactics",children:[d.jsxs("div",{className:"tactic-info",children:[d.jsx("span",{className:"label",children:"Tu formacin:"}),d.jsx("span",{className:"value",children:n.formation})]}),d.jsxs("div",{className:"tactic-info",children:[d.jsx("span",{className:"label",children:"Tu tctica:"}),d.jsx("span",{className:"value",children:Dd[n.tactic]?.name||"Equilibrado"})]})]})]}),s==="playing"&&o&&d.jsxs("div",{className:"match-day__playing",children:[d.jsxs("div",{className:"match-day__minute",children:[h,"'"]}),d.jsx("div",{className:"match-day__score",children:(()=>{const Y=o.events.slice(0,c),ue=Y.filter(Ee=>Ee.type==="goal"&&Ee.team==="home").length,pe=Y.filter(Ee=>Ee.type==="goal"&&Ee.team==="away").length;return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"team",children:[d.jsx("span",{className:"name",children:F?n.team.shortName:O.shortName}),d.jsx("span",{className:"score",children:ue})]}),d.jsx("span",{className:"separator",children:"-"}),d.jsxs("div",{className:"team",children:[d.jsx("span",{className:"score",children:pe}),d.jsx("span",{className:"name",children:F?O.shortName:n.team.shortName})]})]})})()}),d.jsx("div",{className:"match-day__live-stats",children:d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"bar home",style:{width:`${o.stats.possession.home}%`}}),d.jsx("span",{className:"label",children:"Posesin"}),d.jsx("div",{className:"bar away",style:{width:`${o.stats.possession.away}%`}})]})}),d.jsx("div",{className:"match-day__events",ref:m,children:o.events.slice(0,c).map((Y,ue)=>d.jsxs("div",{className:`match-day__event ${Y.team} ${Y.type} ${Y.goalType||""}`,children:[d.jsxs("span",{className:"minute",children:[Y.minute,"'"]}),d.jsxs("span",{className:"icon",children:[Y.type==="goal"&&d.jsx(Yp,{size:16,className:"icon-goal"}),Y.type==="yellow_card"&&d.jsx("span",{className:"icon-card icon-card--yellow"}),Y.type==="red_card"&&d.jsx("span",{className:"icon-card icon-card--red"}),Y.type==="injury"&&d.jsx(su,{size:16,className:"icon-injury"})]}),d.jsxs("span",{className:"player",children:[typeof Y.player=="object"?Y.player?.name||e("common.unknown"):Y.player,Y.assist&&d.jsxs("span",{className:"assist",children:[" (asist. ",typeof Y.assist=="object"?Y.assist?.name:Y.assist,")"]}),Y.type==="goal"&&Y.goalType&&d.jsxs("span",{className:"goal-type",children:[" ",ne(Y.goalType)]}),Y.type==="injury"&&d.jsxs("span",{className:"injury-info",children:[" (",Y.weeksOut," sem.)"]})]})]},ue))})]}),s==="result"&&o&&(()=>{const Y=F?n.team.name:O.name,ue=F?n.team.shortName:O.shortName,pe=F?O.name:n.team.name,Ee=F?O.shortName:n.team.shortName,oe=F,Ae=oe?o.homeScore>o.awayScore:o.awayScore>o.homeScore,be=o.homeScore===o.awayScore,Ce=Ae?"V":be?"E":"D",ce=Ae?"win":be?"draw":"loss",te=o.events.filter(Ie=>Ie.type==="goal"&&Ie.team==="home"),fe=o.events.filter(Ie=>Ie.type==="goal"&&Ie.team==="away"),Le=o.stats,Fe=[{label:"Posesin",home:Le.possession.home,away:Le.possession.away,suffix:"%",isPercent:!0},{label:"Tiros",home:Le.shots.home,away:Le.shots.away},{label:"A puerta",home:Le.shotsOnTarget.home,away:Le.shotsOnTarget.away},{label:"Crners",home:Le.corners.home,away:Le.corners.away},{label:"Faltas",home:Le.fouls?.home??0,away:Le.fouls?.away??0},{label:"Amarillas",home:Le.yellowCards.home,away:Le.yellowCards.away,icon:d.jsx(sc,{size:14,className:"card-yellow"})},...Le.redCards.home>0||Le.redCards.away>0?[{label:"Rojas",home:Le.redCards.home,away:Le.redCards.away,icon:d.jsx(sc,{size:14,className:"card-red"})}]:[]];return d.jsxs("div",{className:`match-day__result ${ce}`,children:[d.jsxs("div",{className:"result-header",children:[d.jsx("span",{className:"result-label",children:e("matchday.finalResult")}),d.jsx("span",{className:`result-badge ${ce}`,children:Ce})]}),d.jsxs("div",{className:"result-scoreboard",children:[d.jsxs("div",{className:`result-team ${oe?"is-player":""}`,children:[d.jsx("div",{className:"team-badge",children:ue}),d.jsx("span",{className:"team-name",children:Y}),d.jsx("div",{className:"team-scorers",children:te.map((Ie,at)=>d.jsxs("span",{className:"scorer",children:[d.jsx(Lo,{size:12})," ",typeof Ie.player=="object"?Ie.player?.name:Ie.player," ",Ie.minute,"'"]},at))})]}),d.jsxs("div",{className:"result-score",children:[d.jsx("span",{className:"score-num",children:o.homeScore}),d.jsx("span",{className:"score-sep",children:""}),d.jsx("span",{className:"score-num",children:o.awayScore})]}),d.jsxs("div",{className:`result-team away ${oe?"":"is-player"}`,children:[d.jsx("div",{className:"team-badge",children:Ee}),d.jsx("span",{className:"team-name",children:pe}),d.jsx("div",{className:"team-scorers",children:fe.map((Ie,at)=>d.jsxs("span",{className:"scorer",children:[d.jsx(Lo,{size:12})," ",typeof Ie.player=="object"?Ie.player?.name:Ie.player," ",Ie.minute,"'"]},at))})]})]}),d.jsxs("div",{className:"result-stats",children:[d.jsx("h4",{children:"Estadsticas"}),Fe.map((Ie,at)=>{const je=Ie.home+Ie.away||1,Ve=Ie.isPercent?Ie.home:Ie.home/je*100,Me=Ie.isPercent?Ie.away:Ie.away/je*100,ze=Ie.home>Ie.away,Je=Ie.away>Ie.home;return d.jsxs("div",{className:"stat-row",children:[d.jsxs("span",{className:`stat-val home ${ze?"leading":""}`,children:[Ie.home,Ie.suffix||""]}),d.jsxs("div",{className:"stat-center",children:[d.jsxs("div",{className:"stat-bars",children:[d.jsx("div",{className:`bar home ${ze?"leading":""}`,style:{width:`${Ve}%`}}),d.jsx("div",{className:`bar away ${Je?"leading":""}`,style:{width:`${Me}%`}})]}),d.jsxs("span",{className:"stat-label",children:[Ie.icon||""," ",Ie.label]})]}),d.jsxs("span",{className:`stat-val away ${Je?"leading":""}`,children:[Ie.away,Ie.suffix||""]})]},at)})]}),o.events.length>0&&d.jsxs("div",{className:"result-events",children:[d.jsx("h4",{children:"Cronologa"}),d.jsx("div",{className:"events-timeline",children:o.events.map((Ie,at)=>{const je=Ie.team==="home",Ve=typeof Ie.player=="object"?Ie.player?.name||"?":Ie.player,Me=Ie.type==="goal"?d.jsx(Yp,{size:16,className:"icon-goal"}):Ie.type==="yellow_card"?d.jsx("span",{className:"icon-card icon-card--yellow"}):Ie.type==="red_card"?d.jsx("span",{className:"icon-card icon-card--red"}):d.jsx(su,{size:16,className:"icon-injury"});return d.jsxs("div",{className:`timeline-event ${je?"home":"away"} ${Ie.type}`,children:[d.jsxs("div",{className:"event-minute",children:[Ie.minute,"'"]}),d.jsx("div",{className:"event-line",children:d.jsx("div",{className:"event-dot",children:Me})}),d.jsxs("div",{className:"event-detail",children:[d.jsx("span",{className:"event-player",children:Ve}),Ie.type==="goal"&&Ie.assist&&d.jsxs("span",{className:"event-assist",children:["Asist. ",typeof Ie.assist=="object"?Ie.assist?.name:Ie.assist]}),Ie.type==="goal"&&Ie.goalType&&d.jsx("span",{className:"event-extra",children:ne(Ie.goalType)}),Ie.type==="injury"&&d.jsxs("span",{className:"event-extra",children:[d.jsx(su,{size:12})," ",Ie.weeksOut," sem."]}),d.jsx("span",{className:"event-team-tag",children:je?ue:Ee})]})]},at)})})]}),o.events.length===0&&d.jsx("div",{className:"result-events empty",children:d.jsx("p",{children:"Partido sin incidencias destacadas"})})]})})()]}),s==="preview"&&d.jsxs("button",{className:"match-day__play-btn",onClick:q,children:[d.jsx(Lo,{size:14})," Jugar Partido"]}),s==="playing"&&o&&d.jsxs("button",{className:"match-day__skip-btn",onClick:K,children:[d.jsx(zF,{size:14})," ",e("matchday.skipToEnd")]}),s==="result"&&o&&d.jsx("button",{className:"match-day__continue-btn",onClick:H,children:"Continuar"})]})}const KJe={light:d.jsx(Yp,{size:16,className:"intensity-icon intensity-icon--green"}),normal:d.jsx(Yp,{size:16,className:"intensity-icon intensity-icon--yellow"}),intense:d.jsx(Yp,{size:16,className:"intensity-icon intensity-icon--red"})},RC={light:{id:"light",nameKey:"training.intensities.light.name",statBonus:"+0.6%",injuryRisk:"5%",descKey:"training.intensities.light.description",color:"#30d158"},normal:{id:"normal",nameKey:"training.intensities.normal.name",statBonus:"+1.1%",injuryRisk:"15%",descKey:"training.intensities.normal.description",color:"#ffd60a"},intense:{id:"intense",nameKey:"training.intensities.intense.name",statBonus:"+1.7%",injuryRisk:"30%",descKey:"training.intensities.intense.description",color:"#ff453a"}};function YJe(){const{t:a}=Sa(),{state:e,dispatch:n}=Va(),i=e.training?.intensity||null,s=i!==null,r=e.facilities?.training||0,o=[0,.1,.2,.35][r]||0,l=c=>{s||(n({type:"SET_TRAINING",payload:{intensity:c,lockedUntilPreseason:!0}}),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"training",title:a("training.intensitySet"),content:a("training.intensitySetDesc",{intensity:a(RC[c].nameKey)}),date:`Semana ${e.currentWeek}`}}))};return d.jsxs("div",{className:"training-simple",children:[d.jsxs("div",{className:"training-simple__header",children:[d.jsxs("h2",{children:[d.jsx(wSe,{size:16})," ",a("training.title")]}),s?d.jsxs("span",{className:"locked-badge",children:[d.jsx(vy,{size:12})," ",a("training.lockedUntil")]}):d.jsx("p",{className:"subtitle",children:a("training.selectIntensity")})]}),d.jsx("div",{className:"training-simple__options",children:Object.values(RC).map(c=>{const u=i===c.id;return d.jsxs("div",{className:`intensity-card ${u?"selected":""} ${s&&!u?"disabled":""}`,onClick:()=>!s&&l(c.id),style:{"--intensity-color":c.color},children:[d.jsxs("div",{className:"card-header",children:[d.jsx("span",{className:"icon",children:KJe[c.id]}),d.jsx("h3",{children:a(c.nameKey)}),u&&d.jsx("span",{className:"check",children:d.jsx(uo,{size:14})})]}),d.jsx("p",{className:"description",children:a(c.descKey)}),d.jsxs("div",{className:"stats",children:[d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"label",children:a("training.statImprovement")}),d.jsx("span",{className:"value positive",children:c.statBonus})]}),d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"label",children:a("training.injuryRisk")}),d.jsx("span",{className:"value negative",children:c.injuryRisk})]})]})]},c.id)})}),d.jsxs("div",{className:"training-simple__info",children:[d.jsxs("div",{className:"info-box",children:[d.jsx("span",{className:"icon",children:d.jsx(Ol,{size:16})}),d.jsxs("div",{className:"text",children:[d.jsx("span",{className:"label",children:a("training.facilityLevel")}),d.jsxs("span",{className:"value",children:[r,"/3 (x",(1+o).toFixed(1)," ",a("training.bonus"),")"]})]})]}),s&&d.jsxs("div",{className:"info-box locked",children:[d.jsx("span",{className:"icon",children:d.jsx(_N,{size:16})}),d.jsxs("div",{className:"text",children:[d.jsxs("span",{className:"label",children:[a("training.currentIntensity"),": ",RC[i]?a(RC[i].nameKey):""]}),d.jsx("span",{className:"value",children:a("training.canChangeNext")})]})]})]})]})}function xg(a){return Wa[a]?.name||a}function XJe(){const{t:a}=Sa(),{state:e}=Va(),n=e.contrarrelojData;if(!n)return null;const i=n.seasonHistory||[],s=n.trophies||[],r=n.seasonsPlayed||1,o=xg(e.leagueId||e.playerLeagueId),l=e.leagueTable||[],c=l.findIndex(A=>A.teamId===e.teamId)+1,u=l.length,h=[];h.push({type:"start",season:1,icon:d.jsx(aTe,{size:16}),title:a("contrarrelojProgress.challengeStart"),detail:`${n.startTeam?.name}  ${xg(n.startLeague)}`,color:"blue"});for(const A of i){h.push({type:"season",season:A.season,icon:d.jsx(Lo,{size:16}),title:a("contrarrelojProgress.seasonPosition",{season:A.season,position:A.position,total:A.totalTeams}),detail:A.leagueName||xg(A.league),color:"neutral"}),A.promoted&&h.push({type:"promotion",season:A.season,icon:d.jsx(dl,{size:16}),title:a("contrarrelojProgress.promotion"),detail:a("contrarrelojProgress.promotionDetail",{from:xg(A.league),to:xg(A.promotedTo)}),color:"green"}),A.relegated&&h.push({type:"relegation",season:A.season,icon:d.jsx(VT,{size:16}),title:a("contrarrelojProgress.relegation"),detail:a("contrarrelojProgress.relegationDetail",{from:xg(A.league),to:xg(A.relegatedTo)}),color:"red"}),A.europeanPhase&&h.push({type:"european",season:A.season,icon:d.jsx(Br,{size:16}),title:A.europeanComp||a("contrarrelojProgress.continentalCompetition"),detail:a("contrarrelojProgress.phaseReached",{phase:A.europeanPhase}),color:"gold"});const x=s.filter(T=>T.season===A.season);for(const T of x)h.push({type:"trophy",season:T.season,icon:d.jsx(Ai,{size:16}),title:a("contrarrelojProgress.trophyWon",{trophy:T.name}),detail:a("contrarrelojProgress.seasonLabel",{season:T.season}),color:"gold"})}h.push({type:"current",season:r,icon:d.jsx(tf,{size:16}),title:a("contrarrelojProgress.currentSeason",{season:r}),detail:`${o}  ${c>0?a("contrarrelojProgress.currentPosition",{position:c,total:u}):a("contrarrelojProgress.noClassification")}`,color:"accent"});const f=["argentinaPrimera","brasileiraoA","colombiaPrimera","chilePrimera","uruguayPrimera","ecuadorLigaPro","paraguayPrimera","peruLiga1","boliviaPrimera","venezuelaPrimera"].includes(n.startLeague),m=a(f?"contrarrelojProgress.copaLibertadores":"contrarrelojProgress.championsLeague");return h.push({type:"goal",season:null,icon:d.jsx(FZ,{size:16}),title:a("contrarrelojProgress.winGoal",{competition:m}),detail:n.won?a("contrarrelojProgress.accomplished"):a("contrarrelojProgress.howManySeasonsQuestion"),color:n.won?"gold":"dimmed"}),d.jsxs("div",{className:"contrarreloj-progress",children:[d.jsxs("div",{className:"contrarreloj-progress__hero",children:[d.jsx("div",{className:"hero-icon",children:d.jsx(tf,{size:28})}),d.jsxs("div",{className:"hero-info",children:[d.jsx("h2",{children:a("contrarrelojProgress.roadToGlory")}),d.jsxs("span",{className:"hero-sub",children:[n.startTeam?.name,"  ",a("contrarrelojProgress.startingFrom")," ",xg(n.startLeague)]})]}),d.jsxs("div",{className:"hero-season",children:[d.jsx("div",{className:"season-num",children:r}),d.jsx("div",{className:"season-label",children:a("contrarrelojProgress.seasonLabel",{season:r})})]})]}),d.jsxs("div",{className:"contrarreloj-progress__stats",children:[d.jsxs("div",{className:"stat-card stat-card--league",children:[d.jsx("div",{className:`stat-value${o.length>12?" stat-value--long":""}`,title:o,children:o}),d.jsx("div",{className:"stat-label",children:a("contrarrelojProgress.currentLeague")})]}),d.jsxs("div",{className:"stat-card stat-card--position",children:[d.jsx("div",{className:"stat-value",children:c>0?`${c}`:""}),d.jsx("div",{className:"stat-label",children:u>0?a("contrarrelojProgress.positionOf",{total:u}):a("contrarrelojProgress.position")})]}),d.jsxs("div",{className:"stat-card stat-card--trophies",children:[d.jsx("div",{className:"stat-value",children:s.length}),d.jsx("div",{className:"stat-label",children:a("contrarrelojProgress.trophies")})]}),d.jsxs("div",{className:"stat-card stat-card--goal",children:[d.jsx("div",{className:"stat-value",children:f?"":""}),d.jsx("div",{className:"stat-label",children:m})]})]}),d.jsx("div",{className:"contrarreloj-progress__timeline-title",children:a("contrarrelojProgress.timeline")}),d.jsx("div",{className:"contrarreloj-progress__timeline",children:h.map((A,x)=>d.jsxs("div",{className:`timeline-event timeline-event--${A.color} ${A.type==="current"?"timeline-event--active":""}`,children:[d.jsxs("div",{className:"timeline-event__line",children:[d.jsx("div",{className:"timeline-event__dot",children:A.icon}),x<h.length-1&&d.jsx("div",{className:"timeline-event__connector"})]}),d.jsxs("div",{className:"timeline-event__content",children:[d.jsx("span",{className:"timeline-event__title",children:A.title}),d.jsx("span",{className:"timeline-event__detail",children:A.detail})]})]},x))})]})}function QJe(){const{state:a}=Va(),{t:e}=Sa();if(a.gameMode==="contrarreloj")return d.jsx(XJe,{});const n=a.seasonObjectives||[],[i,s]=ge.useState("all"),[r,o]=ge.useState(null),l=O=>O.nameKey?e(O.nameKey):O.name||"",c=O=>O.descKey?e(O.descKey):O.description||"",u=ge.useMemo(()=>{const O=a.leagueTable?.find(D=>D.teamId===a.teamId);return O?{position:a.leagueTable.findIndex(D=>D.teamId===a.teamId)+1,points:O.points,goalsFor:O.goalsFor,goalsAgainst:O.goalsAgainst,goalDifference:O.goalsFor-O.goalsAgainst,wins:O.won,draws:O.drawn,losses:O.lost}:null},[a.leagueTable,a.teamId]),h=O=>{if(!u)return 0;const D=O.type==="league_position"&&O.target>=17,j=a.currentWeek>=38;switch(O.type){case"league_position":if(D&&!j){if(u.position<=O.target)return 95;const U=a.leagueTable?.length||20;return Math.max(0,Math.round((1-(u.position-O.target)/(U-O.target))*90))}if(u.position<=O.target)return 100;const L=a.leagueTable?.length||20;return Math.max(0,Math.round((1-(u.position-O.target)/(L-O.target))*100));case"goal_difference":return u.goalDifference>=O.target?100:Math.max(0,Math.min(100,50+u.goalDifference*5));case"financial":return a.money>=0?100:Math.max(0,Math.round(100+a.money/1e7*100));default:return 50}},f=O=>{const D=h(O);return D>=100?"completed":D>=70?"on-track":D>=40?"warning":"danger"},m=O=>{switch(O){case"critical":return{icon:vN,label:e("objectives.critical"),color:"#ff453a"};case"high":return{icon:ru,label:e("objectives.high"),color:"#ff9f0a"};case"medium":return{icon:Fs,label:e("objectives.medium"),color:"#0a84ff"};case"low":return{icon:Lo,label:e("objectives.low"),color:"#8e8e93"};default:return{icon:Lo,label:e("objectives.objective"),color:"#8e8e93"}}},A=O=>{switch(O){case"league_position":return Ai;case"goal_difference":return dl;case"financial":return _k;default:return Fs}},x=O=>{switch(O){case"completed":return{icon:rS,label:e("objectives.completed"),color:"#30d158"};case"on-track":return{icon:or,label:e("objectives.onTrack"),color:"#0a84ff"};case"warning":return{icon:wr,label:e("objectives.atRisk"),color:"#ff9f0a"};case"danger":return{icon:kd,label:e("objectives.danger"),color:"#ff453a"};default:return{icon:or,label:e("objectives.pending"),color:"#8e8e93"}}},T=O=>O>=1e6?`${(O/1e6).toFixed(1)}M`:O<=-1e6?`-${(Math.abs(O)/1e6).toFixed(1)}M`:`${(O/1e3).toFixed(0)}K`,E=ge.useMemo(()=>{const O=n.filter(L=>h(L)>=100).length,D=n.filter(L=>f(L)==="on-track").length,j=n.filter(L=>{const U=f(L);return U==="warning"||U==="danger"}).length;return{completed:O,inProgress:D,atRisk:j,total:n.length}},[n,u]),M=ge.useMemo(()=>i==="all"?n:n.filter(O=>{const D=f(O);return i==="completed"?D==="completed":i==="in-progress"?D==="on-track":i==="at-risk"?D==="warning"||D==="danger":!0}),[n,i,u]),N=M.filter(O=>O.priority==="critical"),I=M.filter(O=>O.priority!=="critical"),F=O=>{o(r===O?null:O)},G=O=>{if(!u)return"Cargando datos...";switch(O.type){case"league_position":return`Posicin actual: ${u.position} | Objetivo: Top ${O.target}`;case"goal_difference":return`Diferencia actual: ${u.goalDifference>0?"+":""}${u.goalDifference} | Objetivo: ${O.target>0?"+":""}${O.target}`;case"financial":return`Presupuesto: ${T(a.money)} | Objetivo: Mantener saldo positivo`;default:return""}};return d.jsxs("div",{className:"objectives",children:[d.jsx("header",{className:"objectives__header",children:d.jsxs("div",{className:"header-title",children:[d.jsx(Fs,{size:28,className:"header-icon"}),d.jsxs("div",{children:[d.jsx("h1",{children:e("objectives.seasonObjectives")}),d.jsxs("p",{className:"subtitle",children:[e("office.seasonInfo",{season:a.currentSeason}),"  ",e("office.weekInfo",{week:a.currentWeek}),"/38"]})]})]})}),d.jsxs("div",{className:"objectives__stats",children:[d.jsxs("div",{className:"stat-card stat-card--completed",children:[d.jsx(rS,{size:24}),d.jsxs("div",{className:"stat-content",children:[d.jsxs("span",{className:"stat-value",children:[E.completed,"/",E.total]}),d.jsx("span",{className:"stat-label",children:e("objectives.completed")})]})]}),d.jsxs("div",{className:"stat-card stat-card--position",children:[d.jsx(Ai,{size:24}),d.jsxs("div",{className:"stat-content",children:[d.jsxs("span",{className:"stat-value",children:[u?.position||"-",""]}),d.jsx("span",{className:"stat-label",children:e("ranking.position")})]})]}),d.jsxs("div",{className:`stat-card ${u?.goalDifference>=0?"stat-card--positive":"stat-card--negative"}`,children:[u?.goalDifference>=0?d.jsx(dl,{size:24}):d.jsx(VT,{size:24}),d.jsxs("div",{className:"stat-content",children:[d.jsxs("span",{className:"stat-value",children:[u?.goalDifference>0?"+":"",u?.goalDifference||0]}),d.jsx("span",{className:"stat-label",children:e("objectives.goalDifference")})]})]}),d.jsxs("div",{className:`stat-card ${a.money>=0?"stat-card--positive":"stat-card--negative"}`,children:[d.jsx(_k,{size:24}),d.jsxs("div",{className:"stat-content",children:[d.jsx("span",{className:"stat-value",children:T(a.money)}),d.jsx("span",{className:"stat-label",children:e("objectives.budget")})]})]})]}),E.atRisk>0&&d.jsxs("div",{className:"objectives__alert",children:[d.jsx(wr,{size:20}),d.jsxs("span",{children:[d.jsxs("strong",{children:[E.atRisk," ",e("objectives.objectivesAtRisk",{count:E.atRisk})]})," ",e("objectives.atRiskWarning")]})]}),d.jsxs("div",{className:"objectives__filters",children:[d.jsx(Ak,{size:18}),d.jsxs("button",{className:`filter-btn ${i==="all"?"active":""}`,onClick:()=>s("all"),children:[e("objectives.all")," (",E.total,")"]}),d.jsxs("button",{className:`filter-btn ${i==="completed"?"active":""}`,onClick:()=>s("completed"),children:[d.jsx(rS,{size:14})," ",e("objectives.completed")," (",E.completed,")"]}),d.jsxs("button",{className:`filter-btn ${i==="in-progress"?"active":""}`,onClick:()=>s("in-progress"),children:[d.jsx(or,{size:14})," ",e("objectives.inProgress")," (",E.inProgress,")"]}),d.jsxs("button",{className:`filter-btn ${i==="at-risk"?"active":""}`,onClick:()=>s("at-risk"),children:[d.jsx(wr,{size:14})," ",e("objectives.atRisk")," (",E.atRisk,")"]})]}),N.length>0&&d.jsxs("section",{className:"objectives__section",children:[d.jsxs("h2",{className:"section-title",children:[d.jsx(vN,{size:20,className:"section-icon section-icon--critical"}),e("objectives.criticalObjectives")]}),d.jsx("div",{className:"objectives__list",children:N.map(O=>{const D=h(O),j=f(O),L=x(j),U=A(O.type),q=L.icon,K=r===O.id;return d.jsxs("div",{className:`objective-card objective-card--${j}`,onClick:()=>F(O.id),children:[d.jsxs("div",{className:"objective-main",children:[d.jsx("div",{className:"objective-icon",children:d.jsx(U,{size:24})}),d.jsxs("div",{className:"objective-content",children:[d.jsxs("div",{className:"objective-header",children:[d.jsx("h3",{className:"objective-name",children:l(O)}),d.jsxs("div",{className:"objective-status",style:{"--status-color":L.color},children:[d.jsx(q,{size:16}),d.jsx("span",{children:L.label})]})]}),d.jsx("p",{className:"objective-desc",children:c(O)}),d.jsxs("div",{className:"objective-progress",children:[d.jsx("div",{className:"progress-bar",children:d.jsx("div",{className:"progress-fill",style:{width:`${Math.min(100,D)}%`,background:L.color}})}),d.jsxs("span",{className:"progress-value",children:[D,"%"]})]})]}),d.jsx("div",{className:"objective-expand",children:K?d.jsx(jT,{size:20}):d.jsx(S0,{size:20})})]}),K&&d.jsxs("div",{className:"objective-details",children:[d.jsxs("div",{className:"detail-row",children:[d.jsx(_N,{size:16}),d.jsx("span",{children:G(O)})]}),d.jsxs("div",{className:"objective-rewards",children:[O.reward>0&&d.jsxs("div",{className:"reward reward--positive",children:[d.jsx(Ay,{size:16}),d.jsxs("span",{children:["Recompensa: ",T(O.reward)]})]}),O.penalty<0&&d.jsxs("div",{className:"reward reward--negative",children:[d.jsx(x_,{size:16}),d.jsxs("span",{children:["Penalizacin: ",T(O.penalty)]})]})]})]})]},O.id)})})]}),I.length>0&&d.jsxs("section",{className:"objectives__section",children:[d.jsxs("h2",{className:"section-title",children:[d.jsx(Fs,{size:20,className:"section-icon"}),"Objetivos Secundarios"]}),d.jsx("div",{className:"objectives__list objectives__list--compact",children:I.map(O=>{const D=h(O),j=f(O),L=x(j),U=A(O.type),q=m(O.priority),K=q.icon;return d.jsxs("div",{className:`objective-card objective-card--compact objective-card--${j}`,children:[d.jsx("div",{className:"objective-icon objective-icon--small",children:d.jsx(U,{size:18})}),d.jsxs("div",{className:"objective-content",children:[d.jsxs("div",{className:"objective-header",children:[d.jsx("h3",{className:"objective-name",children:l(O)}),d.jsxs("span",{className:"priority-badge",style:{"--priority-color":q.color},children:[d.jsx(K,{size:12}),q.label]})]}),d.jsxs("div",{className:"objective-progress",children:[d.jsx("div",{className:"progress-bar",children:d.jsx("div",{className:"progress-fill",style:{width:`${Math.min(100,D)}%`,background:L.color}})}),d.jsxs("span",{className:"progress-value",children:[D,"%"]})]})]})]},O.id)})})]}),n.length===0&&d.jsxs("div",{className:"objectives__empty",children:[d.jsx(Fs,{size:48}),d.jsx("h3",{children:e("objectives.noObjectives")}),d.jsx("p",{children:e("objectives.objectivesWillGenerate")})]}),n.length>0&&M.length===0&&d.jsxs("div",{className:"objectives__empty",children:[d.jsx(Ak,{size:48}),d.jsx("h3",{children:"Sin resultados"}),d.jsx("p",{children:"No hay objetivos que coincidan con el filtro seleccionado."})]}),d.jsxs("div",{className:"objectives__tip",children:[d.jsx(_N,{size:18}),d.jsxs("p",{children:[d.jsx("strong",{children:"Consejo:"})," Cumplir los objetivos crticos es esencial para mantener tu puesto. Un buen rendimiento puede atraer ofertas de equipos ms grandes."]})]})]})}function JJe({allTeams:a,onComplete:e}){const{t:n}=Sa(),{state:i,dispatch:s}=Va(),r=i.playerLeagueId||"laliga",o=ge.useMemo(()=>r==="segunda"?i.leagueTable:i.otherLeagues?.segunda?.table||[],[i.leagueTable,i.otherLeagues,r]),l=ge.useMemo(()=>{if(r!=="segunda")return!1;const je=i.leagueTable.findIndex(Ve=>Ve.teamId===i.teamId)+1;return je>=3&&je<=6},[i.leagueTable,i.teamId,r]),c=ge.useMemo(()=>{if(r!=="primeraRFEF"&&r!=="segundaRFEF")return!1;const Ve=(i.leagueTable||[]).findIndex(Me=>Me.teamId===i.teamId)+1;return Ve>=2&&Ve<=5},[i.leagueTable,i.teamId,r]),u=l||c,h=i.pendingAperturaClausuraFinal,f=i.aperturaClausuraFinal,m=!!h,A=()=>m?"apcl_final":u?"playoff":"summary",[x,T]=ge.useState(A),[E,M]=ge.useState(null),[N,I]=ge.useState(null),[F,G]=ge.useState(null),[O,D]=ge.useState(!1),[j,L]=ge.useState(1),[U,q]=ge.useState(null),[K,H]=ge.useState(null),[X,ne]=ge.useState(f||null),[Q,Y]=ge.useState(null);ge.useEffect(()=>{if(o.length>0&&!N){const je=[...hu(),...fu(),...a],Ve=[],Me=new Set;if(je.forEach(ze=>{Me.has(ze.id)||(Me.add(ze.id),Ve.push(ze))}),l){const ze=$J(o,Ve);I(ze)}else{const ze=KJ(o,Ve);I(ze)}}},[o,l]),ge.useEffect(()=>{if(r!=="primeraRFEF"&&r!=="segundaRFEF"||Q)return;const je=i.leagueGroupData||i.otherLeagues?.[r];if(!je?.groups)return;const Ve=r==="primeraRFEF"?pu():mu(),{brackets:Me,playerGroupId:ze}=$6(je,Ve,i.teamId);if(c&&ze){const{brackets:Je,playerBracket:rt}=U3(Me,i.teamId);Y(Je),rt&&I(rt)}else{const{brackets:Je}=U3(Me,null);Y(Je)}},[r,i.leagueGroupData,i.otherLeagues,c,Q]);const ue=ge.useMemo(()=>xwe(i.leagueTable,i.teamId,r),[i.leagueTable,i.teamId,r]),pe=ge.useMemo(()=>Swe(i.seasonObjectives||[],ue),[i.seasonObjectives,ue]),Ee=ge.useMemo(()=>SP(a,i.team),[a,i.team,r]),oe=Ewe(ue.qualification),Ae=wwe(ue.qualification),be=ge.useMemo(()=>(i.team?.players||[]).reduce((Ve,Me)=>Ve+(Me.salary||0),0)*52,[i.team?.players]),Ce=N?.winner===i.teamId;Ce&&(ue.promotion=!0,ue.playoff=!1);const ce=je=>Math.abs(je)>=1e6?`${(je/1e6).toFixed(1)}M`:`${(je/1e3).toFixed(0)}K`,te=je=>{M(je)},fe=()=>{if(!N)return;const je=LG(i.teamId,N);if(!je)return;const Ve=Qg(je.homeTeam,je.awayTeam),Me=r==="primeraRFEF"||r==="segundaRFEF",ze=Me?aS(N,je.id,Ve):nS(N,je.id,Ve);if(G(Ve),I(ze),Me&&Q&&N.groupId&&Y(Je=>({...Je,[N.groupId]:ze})),Ve.winnerId!==i.teamId&&(D(!0),ze.phase==="final")){const Je=Qg(ze.final.homeTeam,ze.final.awayTeam),rt=Me?aS(ze,ze.final.id,Je):nS(ze,"final",Je);I(rt),Me&&Q&&N.groupId&&Y(ve=>({...ve,[N.groupId]:rt}))}},Le=()=>{G(null),(N.phase==="completed"||O)&&T("summary")},Fe=()=>{if(!h)return;const je=Wa[h.leagueId||r];if(!je)return;const Ve=je.getTeams();if(!Ve||Ve.length===0)return;const Me=Ve.find(Je=>Je.id===h.aperturaChampion),ze=Ve.find(Je=>Je.id===h.clausuraChampion);if(!(!Me||!ze)){if(j===1){const Je=jl(h.aperturaChampion,h.clausuraChampion,Me,ze,{importance:"final",homeMorale:85,awayMorale:85});q({homeScore:Je.homeScore,awayScore:Je.awayScore,events:Je.events}),L(2)}else if(j===2){const Je=jl(h.clausuraChampion,h.aperturaChampion,ze,Me,{importance:"final",homeMorale:85,awayMorale:85});H({homeScore:Je.homeScore,awayScore:Je.awayScore,events:Je.events});const rt=U,ve={homeScore:Je.homeScore,awayScore:Je.awayScore},Ue=rt.homeScore+ve.awayScore,it=rt.awayScore+ve.homeScore,wt=ve.awayScore,Mt=rt.awayScore;let _e,le;Ue>it?(_e=h.aperturaChampion,le="aggregate"):it>Ue?(_e=h.clausuraChampion,le="aggregate"):wt>Mt?(_e=h.aperturaChampion,le="awayGoals"):Mt>wt?(_e=h.clausuraChampion,le="awayGoals"):(_e=h.clausuraChampion,le="clausuraAdvantage");const Ge={aperturaChampion:h.aperturaChampion,aperturaChampionName:h.aperturaChampionName,clausuraChampion:h.clausuraChampion,clausuraChampionName:h.clausuraChampionName,leg1:{home:h.aperturaChampion,away:h.clausuraChampion,homeScore:rt.homeScore,awayScore:rt.awayScore},leg2:{home:h.clausuraChampion,away:h.aperturaChampion,homeScore:ve.homeScore,awayScore:ve.awayScore},aggregate:{apertura:Ue,clausura:it},awayGoals:{apertura:wt,clausura:Mt},winner:_e,winnerName:_e===h.aperturaChampion?h.aperturaChampionName:h.clausuraChampionName,winReason:le,hadFinal:!0};ne(Ge),L(3),s({type:"COMPLETE_APCL_FINAL",payload:Ge})}}},Ie=()=>{(j===3||X)&&T(u?"playoff":"summary")},at=()=>{if(!E)return;const je=pe.netResult+oe-be,Ve={};Q&&((r==="primeraRFEF"||i.otherLeagues?.primeraRFEF)&&r==="primeraRFEF"&&(Ve.primeraRFEFPlayoffBrackets=Q),(r==="segundaRFEF"||i.otherLeagues?.segundaRFEF)&&r==="segundaRFEF"&&(Ve.segundaRFEFPlayoffBrackets=Q));const Me=JAe(i,i.teamId,N,Ve),ze=Me.newPlayerLeagueId||i.playerLeagueId||"laliga",Je=HF(i.team,ze,Me.playerLeague.table);if((Me.changes.relegated.length>0||Me.changes.promoted.length>0||Me.changes.playoffWinner)&&(Me.changes.relegated.length>0&&s({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"relegation",title:"Descensos a Segunda",content:`Descienden: ${Me.changes.relegated.join(", ")}`,date:`Fin Temporada ${i.currentSeason}`}}),Me.changes.promoted.length>0&&s({type:"ADD_MESSAGE",payload:{id:Date.now()+1,type:"promotion",title:"Ascensos directos a La Liga",content:`Ascienden: ${Me.changes.promoted.join(", ")}`,date:`Fin Temporada ${i.currentSeason}`}}),Me.changes.playoffWinner&&s({type:"ADD_MESSAGE",payload:{id:Date.now()+2,type:"promotion",title:"Ascenso por Playoff",content:`${Me.changes.playoffWinner} gana el playoff y asciende a La Liga`,date:`Fin Temporada ${i.currentSeason}`}}),Me.newPlayerLeagueId!==(i.playerLeagueId||"laliga"))){const _e=Me.newPlayerLeagueId==="laliga";s({type:"ADD_MESSAGE",payload:{id:Date.now()+2,type:_e?"promotion":"relegation",title:_e?"ASCENSO!":"Descenso",content:_e?`${i.team.name} jugar en La Liga la prxima temporada!`:`${i.team.name} jugar en Segunda Divisin la prxima temporada.`,date:`Fin Temporada ${i.currentSeason}`}})}let rt=null,ve=0;try{const _e=OT(ze,i.team,Me.otherLeagues||i.otherLeagues,Me.playerLeague?.table||i.leagueTable);_e&&_e.teams.length>=2&&(rt=FT(_e.teams,i.teamId),rt&&(ve=rt.rounds.length))}catch(_e){console.warn("Error initializing cup competition:",_e)}let Ue=Me.playerLeague.fixtures,it=null;const wt=!!ue.qualification;{const _e=Ue.length>0?Math.max(...Ue.map(le=>le.week)):38;it=RF(_e,{hasEuropean:wt,cupRounds:ve}),Ue=IF(Ue,it.leagueWeekMap)}i.gameMode==="contrarreloj"&&i.leagueTable?.findIndex(le=>le.teamId===i.teamId)+1===1&&s({type:"CONTRARRELOJ_ADD_TROPHY",payload:{type:"league",season:i.currentSeason,name:$Ae(r)||r}}),s({type:"START_NEW_SEASON",payload:{seasonResult:ue,objectiveRewards:pe,europeanBonus:oe,preseasonMatches:E.matches,moneyChange:je,newFixtures:Ue,newTable:Me.playerLeague.table,newObjectives:Je,newPlayerLeagueId:Me.newPlayerLeagueId,europeanCalendar:it}}),s({type:"SET_OTHER_LEAGUES",payload:Me.otherLeagues}),Me.newPlayerLeagueId!==(i.playerLeagueId||"laliga")&&s({type:"SET_PLAYER_LEAGUE",payload:Me.newPlayerLeagueId}),Me.playerLeague?.playerGroup?s({type:"SET_PLAYER_GROUP",payload:Me.playerLeague.playerGroup}):Me.playerLeague&&!Me.playerLeague.isGroupLeague&&s({type:"SET_PLAYER_GROUP",payload:null}),rt&&s({type:"INIT_CUP_COMPETITION",payload:rt});const Mt=fm(Me.newPlayerLeagueId||r);try{const _e={},le={},Ge=Me.playerLeague?.table||i.leagueTable||[],tt=Me.newPlayerLeagueId||r;Ge.length>0&&(_e[tt]=Ge);const pt=Me.otherLeagues||i.otherLeagues||{};for(const[Te,st]of Object.entries(pt))st?.table?.length>0&&Te!==tt&&(_e[Te]=st.table);if(a.forEach(Te=>{le[Te.id||Te.teamId]=Te}),Mt){const Te=AP(_e,le);if(Te.copaLibertadores.length+Te.copaSudamericana.length>=8){const mt=new Set;Object.values(Te).forEach(ct=>ct.forEach(Tt=>mt.add(Tt.teamId)));const ht=a.filter(ct=>!mt.has(ct.id||ct.teamId)&&fm(ct.league||ct.leagueId||"")).sort((ct,Tt)=>(Tt.reputation||0)-(ct.reputation||0));for(const ct of["copaLibertadores","copaSudamericana"]){const Tt=32-Te[ct].length;if(Tt>0){const kt=ht.splice(0,Tt);Te[ct].push(...kt.map(vt=>({teamId:vt.id||vt.teamId,teamName:vt.name||vt.teamName,shortName:vt.shortName||"",league:vt.league||"unknown",leaguePosition:0,reputation:vt.reputation||60,overall:vt.overall||65,players:vt.players||[],...vt})))}}const Qe=yP(Te);s({type:"INIT_SA_COMPETITIONS",payload:Qe});const Xe=["copaLibertadores","copaSudamericana"].find(ct=>Te[ct].some(Tt=>(Tt.teamId||Tt.id)===i.teamId));if(Xe){const ct={copaLibertadores:"South American Champions Cup",copaSudamericana:"Copa Sudamericana"};s({type:"ADD_MESSAGE",payload:{id:Date.now()+100,type:"southamerican",title:"Competicin Continental!",content:`Tu equipo jugar la ${ct[Xe]} la prxima temporada.`,date:`Inicio Temporada ${i.currentSeason+1}`}})}}}else{const Te=fP(_e,le);if(Te.championsLeague.length+Te.europaLeague.length+Te.conferenceleague.length>=12){const mt=new Set;Object.values(Te).forEach(ct=>ct.forEach(Tt=>mt.add(Tt.teamId)));const ht=a.filter(ct=>!mt.has(ct.id||ct.teamId)).sort((ct,Tt)=>(Tt.reputation||0)-(ct.reputation||0));for(const ct of["championsLeague","europaLeague","conferenceleague"]){const Tt=32-Te[ct].length;if(Tt>0){const kt=ht.splice(0,Tt);Te[ct].push(...kt.map(vt=>({teamId:vt.id||vt.teamId,teamName:vt.name||vt.teamName,shortName:vt.shortName||"",league:vt.league||"unknown",leaguePosition:0,reputation:vt.reputation||60,overall:vt.overall||65,players:vt.players||[],...vt})))}}const Qe=mP(Te);s({type:"INIT_EUROPEAN_COMPETITIONS",payload:Qe});const Xe=["championsLeague","europaLeague","conferenceleague"].find(ct=>Te[ct].some(Tt=>(Tt.teamId||Tt.id)===i.teamId));if(Xe){const ct={championsLeague:"Continental Champions Cup",europaLeague:"Continental Shield",conferenceleague:"Continental Trophy"};s({type:"ADD_MESSAGE",payload:{id:Date.now()+100,type:"european",title:"Competicin Europea!",content:`Tu equipo jugar la ${ct[Xe]} la prxima temporada.`,date:`Inicio Temporada ${i.currentSeason+1}`}})}}}}catch(_e){console.error("Error initializing continental competitions:",_e)}e()};if(x==="apcl_final"&&h){const je=ze=>ze==="aggregate"?n("seasonEnd.byAggregate"):ze==="awayGoals"?n("seasonEnd.byAwayGoals"):ze==="clausuraAdvantage"?n("seasonEnd.byClausuraAdvantage"):ze==="sameChampion"?n("seasonEnd.sameChampion"):"",Ve=i.teamId===h.aperturaChampion,Me=i.teamId===h.clausuraChampion;return d.jsx("div",{className:"season-end",children:d.jsxs("div",{className:"season-end__modal",children:[d.jsxs("div",{className:"modal-header",children:[d.jsx(Ai,{size:32,className:"header-icon playoff-icon"}),d.jsxs("div",{children:[d.jsxs("h1",{children:[n("seasonEnd.finalTitle")," ",h.leagueName||n("seasonEnd.league")]}),d.jsxs("p",{children:[n("seasonEnd.aperturaVsClausura"),"  ",j<=2?n(j===1?"seasonEnd.firstLeg":"seasonEnd.secondLeg"):n("seasonEnd.result")]})]})]}),d.jsxs("div",{className:"playoff-bracket",children:[d.jsxs("h3",{children:[d.jsx(yy,{size:14})," Campen Apertura vs Campen Clausura"]}),d.jsxs("div",{className:"bracket-matches",children:[d.jsxs("div",{className:`bracket-match ${U?"played":""}`,children:[d.jsx("span",{className:"bracket-label",children:"Ida"}),d.jsxs("div",{className:"bracket-teams",children:[d.jsxs("span",{className:`team ${Ve?"player-team":""}`,children:[h.aperturaChampionName," ",d.jsx("small",{children:"(Apertura)"})]}),U&&d.jsxs("span",{className:"score",children:[U.homeScore," - ",U.awayScore]}),d.jsxs("span",{className:`team ${Me?"player-team":""}`,children:[h.clausuraChampionName," ",d.jsx("small",{children:"(Clausura)"})]})]})]}),d.jsxs("div",{className:`bracket-match ${K?"played":""}`,children:[d.jsx("span",{className:"bracket-label",children:"Vuelta"}),d.jsxs("div",{className:"bracket-teams",children:[d.jsxs("span",{className:`team ${Me?"player-team":""}`,children:[h.clausuraChampionName," ",d.jsx("small",{children:"(Clausura)"})]}),K&&d.jsxs("span",{className:"score",children:[K.homeScore," - ",K.awayScore]}),d.jsxs("span",{className:`team ${Ve?"player-team":""}`,children:[h.aperturaChampionName," ",d.jsx("small",{children:"(Apertura)"})]})]})]})]})]}),X&&d.jsxs("div",{className:`playoff-result ${X.winner===i.teamId?"victory":"defeat"}`,children:[d.jsx("h3",{children:X.winner===i.teamId?d.jsxs(d.Fragment,{children:[d.jsx(jg,{size:14})," CAMPEN!"]}):"Subcampen"}),d.jsxs("p",{className:"result-score",children:["Global: ",X.aperturaChampionName," ",X.aggregate.apertura," - ",X.aggregate.clausura," ",X.clausuraChampionName]}),d.jsx("p",{className:"result-extra",children:je(X.winReason)}),X.winner===i.teamId&&d.jsxs("p",{className:"promotion-msg",children:[d.jsx(Ai,{size:14})," ",i.team?.name," es CAMPEN de la ",h.leagueName,"!"]}),d.jsxs("button",{className:"btn-continue",onClick:Ie,children:["Continuar ",d.jsx(_r,{size:20})]})]}),!X&&d.jsxs("div",{className:"playoff-next-match",children:[d.jsxs("h3",{children:[d.jsx(ru,{size:14})," ",j===1?"Partido de ida":"Partido de vuelta"]}),d.jsx("p",{className:"next-match-info",children:j===1?d.jsxs(d.Fragment,{children:[d.jsx("strong",{children:h.aperturaChampionName})," ",d.jsx("small",{children:"(Local)"})," vs ",d.jsx("strong",{children:h.clausuraChampionName})]}):d.jsxs(d.Fragment,{children:[d.jsx("strong",{children:h.clausuraChampionName})," ",d.jsx("small",{children:"(Local)"})," vs ",d.jsx("strong",{children:h.aperturaChampionName})]})}),d.jsx("p",{className:"next-match-venue",children:j===1&&Ve||j===2&&Me?d.jsxs(d.Fragment,{children:[d.jsx(qh,{size:12})," Jugamos en casa"]}):d.jsxs(d.Fragment,{children:[d.jsx(k2,{size:12})," Jugamos fuera"]})}),d.jsxs("button",{className:"btn-continue btn-play-match",onClick:Fe,children:[d.jsx(Lo,{size:14})," Jugar partido ",d.jsx(_r,{size:20})]})]})]})})}if(x==="playoff"&&N){const je=LG(i.teamId,N),Ve=je?.homeTeam?.teamId===i.teamId;return je&&(Ve?je.awayTeam:je.homeTeam),d.jsx("div",{className:"season-end",children:d.jsxs("div",{className:"season-end__modal",children:[d.jsxs("div",{className:"modal-header",children:[d.jsx(ru,{size:32,className:"header-icon playoff-icon"}),d.jsxs("div",{children:[d.jsx("h1",{children:"Playoff de Ascenso"}),d.jsx("p",{children:N.phase==="semifinals"?"Semifinales":"FINAL!"})]})]}),d.jsxs("div",{className:"playoff-bracket",children:[d.jsxs("h3",{children:[d.jsx(yy,{size:14})," Cuadro de Playoff"]}),d.jsxs("div",{className:"bracket-matches",children:[N.semifinals.map((Me,ze)=>d.jsxs("div",{className:`bracket-match ${Me.played?"played":""}`,children:[d.jsx("span",{className:"bracket-label",children:Me.label}),d.jsxs("div",{className:"bracket-teams",children:[d.jsxs("span",{className:`team ${Me.result?.winnerId===Me.homeTeam.teamId?"winner":""} ${Me.homeTeam.teamId===i.teamId?"player-team":""}`,children:[Me.homeTeam.teamName," (",Me.homeTeam.seed,")"]}),Me.played&&d.jsxs("span",{className:"score",children:[Me.result.homeScore," - ",Me.result.awayScore,Me.result.extraTime&&!Me.result.penalties&&" (Prr.)",Me.result.penalties&&` (Pen: ${Me.result.penalties.homeGoals}-${Me.result.penalties.awayGoals})`]}),d.jsxs("span",{className:`team ${Me.result?.winnerId===Me.awayTeam.teamId?"winner":""} ${Me.awayTeam.teamId===i.teamId?"player-team":""}`,children:[Me.awayTeam.teamName," (",Me.awayTeam.seed,")"]})]})]},ze)),N.final.homeTeam&&d.jsxs("div",{className:`bracket-match final-match ${N.final.played?"played":""}`,children:[d.jsxs("span",{className:"bracket-label",children:[d.jsx(Ai,{size:14})," Final"]}),d.jsxs("div",{className:"bracket-teams",children:[d.jsx("span",{className:`team ${N.final.result?.winnerId===N.final.homeTeam.teamId?"winner":""} ${N.final.homeTeam.teamId===i.teamId?"player-team":""}`,children:N.final.homeTeam.teamName}),N.final.played&&d.jsxs("span",{className:"score",children:[N.final.result.homeScore," - ",N.final.result.awayScore,N.final.result.extraTime&&!N.final.result.penalties&&" (Prr.)",N.final.result.penalties&&` (Pen: ${N.final.result.homeGoals}-${N.final.result.awayGoals})`]}),d.jsx("span",{className:`team ${N.final.result?.winnerId===N.final.awayTeam?.teamId?"winner":""} ${N.final.awayTeam?.teamId===i.teamId?"player-team":""}`,children:N.final.awayTeam?.teamName||"?"})]})]})]})]}),F&&d.jsxs("div",{className:`playoff-result ${F.winnerId===i.teamId?"victory":"defeat"}`,children:[d.jsx("h3",{children:F.winnerId===i.teamId?d.jsxs(d.Fragment,{children:[d.jsx(jg,{size:14})," Victoria!"]}):"Derrota"}),d.jsxs("p",{className:"result-score",children:[F.homeTeamName," ",F.homeScore," - ",F.awayScore," ",F.awayTeamName]}),F.extraTime&&!F.penalties&&d.jsxs("p",{className:"result-extra",children:["Prrroga: ",F.finalHomeScore," - ",F.finalAwayScore]}),F.penalties&&d.jsxs("p",{className:"result-extra",children:["Penaltis: ",F.penalties.homeGoals," - ",F.penalties.awayGoals]}),F.winnerId===i.teamId&&N.phase==="completed"&&d.jsxs("p",{className:"promotion-msg",children:[d.jsx(Ai,{size:14})," ",i.team?.name," ASCIENDE A LA LIGA!"]}),O&&d.jsx("p",{className:"elimination-msg",children:"El equipo ha sido eliminado del playoff"}),d.jsxs("button",{className:"btn-continue",onClick:Le,children:["Continuar ",d.jsx(_r,{size:20})]})]}),!F&&je&&!O&&d.jsxs("div",{className:"playoff-next-match",children:[d.jsxs("h3",{children:[d.jsx(ru,{size:14})," Prximo partido"]}),d.jsxs("p",{className:"next-match-info",children:[je.label,": ",d.jsx("strong",{children:je.homeTeam.teamName})," vs ",d.jsx("strong",{children:je.awayTeam.teamName})]}),d.jsx("p",{className:"next-match-venue",children:Ve?d.jsxs(d.Fragment,{children:[d.jsx(qh,{size:12})," Jugamos en casa"]}):d.jsxs(d.Fragment,{children:[d.jsx(k2,{size:12})," Jugamos fuera"]})}),d.jsxs("button",{className:"btn-continue btn-play-match",onClick:fe,children:[d.jsx(Lo,{size:14})," Jugar partido ",d.jsx(_r,{size:20})]})]}),!F&&!je&&d.jsxs("div",{className:"playoff-completed",children:[N.phase==="completed"&&d.jsxs(d.Fragment,{children:[d.jsxs("h3",{children:[d.jsx(Ai,{size:14})," Playoff completado"]}),N.winner===i.teamId?d.jsxs("p",{className:"promotion-msg",children:["",i.team?.name," ASCIENDE A LA LIGA!"]}):d.jsxs("p",{children:["Ganador del playoff: ",N.final?.result?.winnerName]})]}),d.jsxs("button",{className:"btn-continue",onClick:()=>T("summary"),children:["Ver resumen de temporada ",d.jsx(_r,{size:20})]})]})]})})}return x==="summary"?d.jsx("div",{className:"season-end",children:d.jsxs("div",{className:"season-end__modal",children:[d.jsxs("div",{className:"modal-header",children:[d.jsx(Ai,{size:32,className:"header-icon"}),d.jsxs("div",{children:[d.jsxs("h1",{children:["Fin de Temporada ",i.currentSeason]}),d.jsx("p",{children:i.team?.name})]})]}),d.jsxs("div",{className:"final-position",children:[d.jsxs("div",{className:"position-badge",children:[d.jsxs("span",{className:"position-number",children:[ue.position,""]}),d.jsx("span",{className:"position-label",children:"Posicin Final"})]}),d.jsxs("div",{className:"season-stats",children:[d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"value",children:ue.points}),d.jsx("span",{className:"label",children:"Puntos"})]}),d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"value",children:ue.wins}),d.jsx("span",{className:"label",children:"Victorias"})]}),d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"value",children:ue.draws}),d.jsx("span",{className:"label",children:"Empates"})]}),d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"value",children:ue.losses}),d.jsx("span",{className:"label",children:"Derrotas"})]}),d.jsxs("div",{className:"stat",children:[d.jsxs("span",{className:`value ${ue.goalDifference>=0?"positive":"negative"}`,children:[ue.goalDifference>0?"+":"",ue.goalDifference]}),d.jsx("span",{className:"label",children:"Dif. Goles"})]})]})]}),i.cupCompetition&&(()=>{const je=i.cupCompetition,Ve=je.config?.name||"Copa",Me=je.config?.icon||"";let ze=null,Je=!1;if(je.winner===i.teamId)ze="Campen",Je=!0;else if(je.playerEliminated){for(let rt=0;rt<je.rounds.length;rt++){const ve=je.rounds[rt];for(const Ue of ve.matches)if(Ue.played&&!Ue.bye&&(Ue.homeTeam?.teamId===i.teamId||Ue.awayTeam?.teamId===i.teamId)&&Ue.winnerId&&Ue.winnerId!==i.teamId){ze=ve.name;break}if(ze)break}ze||(ze="Eliminado")}else{let rt=null;for(let ve=je.rounds.length-1;ve>=0;ve--){const Ue=je.rounds[ve],it=Ue.matches.find(wt=>wt.homeTeam?.teamId===i.teamId||wt.awayTeam?.teamId===i.teamId);if(it&&(it.played||it.bye)){rt=Ue.name;break}}rt?ze=rt:ze=je.rounds[0]?.name||"Participante"}return d.jsxs("div",{className:`competition-result ${Je?"competition-result--champion":""}`,children:[d.jsx(BZ,{size:24,className:"result-icon"}),d.jsxs("div",{className:"result-info",children:[d.jsxs("h3",{children:[Me," ",Ve]}),d.jsx("p",{children:Je?" Campen!":je.playerEliminated?`Eliminado en ${ze}`:`Alcanz: ${ze}`})]})]})})(),i.europeanCompetitions?.competitions&&(()=>{const je=i.europeanCompetitions.competitions;for(const[Ve,Me]of Object.entries(je)){if(!Me||!Me.teams?.some(Ue=>Ue.teamId===i.teamId))continue;const ze=Me.config?.shortName||Me.config?.name||Ve,Je=Me.config?.icon||"";let rt=null,ve=!1;if(Me.finalResult?.winner?.teamId===i.teamId)rt="Campen",ve=!0;else{if(Me.finalResult?.winner&&Me.finalResult.winner.teamId!==i.teamId){const Ue=Me.finalMatchup;Ue&&(Ue.team1?.teamId===i.teamId||Ue.team2?.teamId===i.teamId)&&(rt="Final (Subcampen)")}if(!rt){const Ue=[{key:"sfResults",name:"Semifinales"},{key:"qfResults",name:"Cuartos de Final"},{key:"r16Results",name:"Octavos de Final"},{key:"playoffResults",name:"Playoff"}];for(const{key:it,name:wt}of Ue){const Mt=Me[it];if(!Mt||Mt.length===0)continue;const _e=Mt.find(le=>le.team1?.teamId===i.teamId||le.team2?.teamId===i.teamId);if(_e){if(_e.winner&&_e.winner.teamId!==i.teamId)rt=wt;else if(_e.winner&&_e.winner.teamId===i.teamId)continue;break}}}if(!rt&&Me.qualification?.eliminated?.some(it=>it.teamId===i.teamId)){const it=Me.standings?.find(Mt=>Mt.teamId===i.teamId),wt=it?Me.standings.indexOf(it)+1:null;rt=wt?`Fase de Liga (${wt})`:"Fase de Liga"}if(!rt)if(Me.standings?.find(it=>it.teamId===i.teamId)){const it=Me.standings.sort((wt,Mt)=>Mt.points-wt.points||Mt.goalDifference-wt.goalDifference).findIndex(wt=>wt.teamId===i.teamId)+1;Me.phase==="league"||Me.currentMatchday<8?rt=`Fase de Liga (${it}, J${Me.currentMatchday||0}/8)`:rt=`${it} en Fase de Liga`}else rt="Participante"}return d.jsxs("div",{className:`competition-result ${ve?"competition-result--champion":""}`,children:[d.jsx(dc,{size:24,className:"result-icon"}),d.jsxs("div",{className:"result-info",children:[d.jsxs("h3",{children:[Je," ",ze]}),d.jsx("p",{children:ve?" Campen!":rt})]})]})}return null})(),i.saCompetitions?.competitions&&(()=>{const je=i.saCompetitions.competitions;for(const[Ve,Me]of Object.entries(je)){if(!Me||!Me.teams?.some(Ue=>Ue.teamId===i.teamId))continue;const ze=Me.config?.shortName||Me.config?.name||Ve,Je=Me.config?.icon||"";let rt=null,ve=!1;if(Me.finalResult?.winner?.teamId===i.teamId)rt="Campen",ve=!0;else{if(Me.finalResult?.winner&&Me.finalResult.winner.teamId!==i.teamId){const Ue=Me.finalMatchup;Ue&&(Ue.team1?.teamId===i.teamId||Ue.team2?.teamId===i.teamId)&&(rt="Final (Subcampen)")}if(!rt){const Ue=[{key:"sfResults",name:"Semifinales"},{key:"qfResults",name:"Cuartos de Final"},{key:"r16Results",name:"Octavos de Final"},{key:"playoffResults",name:"Playoff"}];for(const{key:it,name:wt}of Ue){const Mt=Me[it];if(!Mt||Mt.length===0)continue;const _e=Mt.find(le=>le.team1?.teamId===i.teamId||le.team2?.teamId===i.teamId);if(_e){if(_e.winner&&_e.winner.teamId!==i.teamId)rt=wt;else if(_e.winner&&_e.winner.teamId===i.teamId)continue;break}}}if(!rt&&Me.qualification?.eliminated?.some(it=>it.teamId===i.teamId)){const it=Me.standings?.find(Mt=>Mt.teamId===i.teamId),wt=it?Me.standings.indexOf(it)+1:null;rt=wt?`Fase de Liga (${wt})`:"Fase de Liga"}if(!rt)if(Me.standings?.find(it=>it.teamId===i.teamId)){const it=Me.standings.sort((wt,Mt)=>Mt.points-wt.points||Mt.goalDifference-wt.goalDifference).findIndex(wt=>wt.teamId===i.teamId)+1;Me.phase==="league"||Me.currentMatchday<8?rt=`Fase de Liga (${it}, J${Me.currentMatchday||0}/8)`:rt=`${it} en Fase de Liga`}else rt="Participante"}return d.jsxs("div",{className:`competition-result ${ve?"competition-result--champion":""}`,children:[d.jsx(dc,{size:24,className:"result-icon"}),d.jsxs("div",{className:"result-info",children:[d.jsxs("h3",{children:[Je," ",ze]}),d.jsx("p",{children:ve?" Campen!":rt})]})]})}return null})(),Ae&&d.jsxs("div",{className:"european-qualification",children:[d.jsx(Br,{size:24,className:"star-icon"}),d.jsxs("div",{className:"qualification-info",children:[d.jsxs("h3",{children:["Clasificado para ",Ae,"!"]}),d.jsxs("p",{children:["Bonus de clasificacin: ",d.jsx("strong",{children:ce(oe)})]})]})]}),i.europeanCompetitions?.competitions&&(()=>{let je=0,Ve=null;for(const[Me,ze]of Object.entries(i.europeanCompetitions.competitions)){if(!ze)continue;const Je=ze.prizesMoney?.[i.teamId]||0;Je>0&&(je+=Je,Ve=ze.config?.shortName||Me)}return je>0?d.jsxs("div",{className:"european-qualification",style:{borderColor:"rgba(46,125,50,0.3)"},children:[d.jsx(dc,{size:24,className:"star-icon",style:{color:"#66bb6a"}}),d.jsxs("div",{className:"qualification-info",children:[d.jsxs("h3",{children:["Premios ",Ve]}),d.jsxs("p",{children:["Ingresos por competicin europea: ",d.jsx("strong",{children:ce(je)})]})]})]}):null})(),i.saCompetitions?.competitions&&(()=>{let je=0,Ve=null;for(const[Me,ze]of Object.entries(i.saCompetitions.competitions)){if(!ze)continue;const Je=ze.prizesMoney?.[i.teamId]||0;Je>0&&(je+=Je,Ve=ze.config?.shortName||Me)}return je>0?d.jsxs("div",{className:"european-qualification",style:{borderColor:"rgba(46,125,50,0.3)"},children:[d.jsx(dc,{size:24,className:"star-icon",style:{color:"#66bb6a"}}),d.jsxs("div",{className:"qualification-info",children:[d.jsxs("h3",{children:["Premios ",Ve]}),d.jsxs("p",{children:["Ingresos por competicin sudamericana: ",d.jsx("strong",{children:ce(je)})]})]})]}):null})(),(X||f)&&(()=>{const je=X||f,Ve=je.winner===i.teamId,Me=je.winReason==="aggregate"?"por resultado global":je.winReason==="awayGoals"?"por goles de visitante":je.winReason==="clausuraAdvantage"?"por ventaja deportiva":je.winReason==="sameChampion"?"(campen de ambos torneos)":"";return d.jsxs("div",{className:`competition-result ${Ve?"competition-result--champion":""}`,children:[d.jsx(Ai,{size:24,className:"result-icon"}),d.jsxs("div",{className:"result-info",children:[d.jsxs("h3",{children:[" Final ",Wa[r]?.name||"Liga"]}),je.hadFinal?d.jsxs(d.Fragment,{children:[d.jsxs("p",{children:[je.aperturaChampionName," ",d.jsx("small",{children:"(Apertura)"})," vs ",je.clausuraChampionName," ",d.jsx("small",{children:"(Clausura)"})]}),d.jsxs("p",{children:["Ida: ",je.leg1?.homeScore,"-",je.leg1?.awayScore," | Vuelta: ",je.leg2?.homeScore,"-",je.leg2?.awayScore]}),d.jsxs("p",{children:[d.jsxs("strong",{children:["Campen: ",je.winnerName]})," ",Me]})]}):d.jsxs("p",{children:[d.jsx("strong",{children:je.winnerName})," gana Apertura y Clausura  campen directo"]}),Ve&&d.jsx("p",{children:" Tu equipo es CAMPEN!"})]})]})})(),Ce&&d.jsxs("div",{className:"european-qualification promotion-celebration",children:[d.jsx(Ai,{size:24,className:"star-icon"}),d.jsxs("div",{className:"qualification-info",children:[d.jsxs("h3",{children:[d.jsx(jg,{size:16})," ASCENSO POR PLAYOFF!"]}),d.jsxs("p",{children:[i.team?.name," jugar en La Liga la prxima temporada"]})]})]}),N&&N.phase==="completed"&&!l&&r==="segunda"&&d.jsxs("div",{className:"playoff-summary-box",children:[d.jsxs("h3",{children:[d.jsx(Ai,{size:14})," Playoff de Ascenso (Segunda)"]}),d.jsxs("div",{className:"playoff-summary-results",children:[N.semifinals.map((je,Ve)=>d.jsx("p",{children:DG(je)},Ve)),d.jsx("p",{className:"final-result",children:d.jsx("strong",{children:DG(N.final)})}),d.jsxs("p",{className:"playoff-winner",children:["Asciende: ",d.jsx("strong",{children:N.final.result?.winnerName})]})]})]}),ue.relegation&&d.jsxs("div",{className:"relegation-warning",children:[d.jsx(VT,{size:24}),d.jsxs("div",{children:[d.jsx("h3",{children:"Descenso de categora"}),d.jsx("p",{children:"El equipo ha descendido a la divisin inferior"})]})]}),d.jsxs("div",{className:"objectives-summary",children:[d.jsxs("h3",{children:[d.jsx(Fs,{size:18})," Objetivos de Temporada"]}),d.jsx("div",{className:"objectives-list",children:pe.objectiveResults.map((je,Ve)=>d.jsxs("div",{className:`objective-item objective-item--${je.status}`,children:[je.status==="completed"?d.jsx(rS,{size:18,className:"icon-completed"}):d.jsx(kd,{size:18,className:"icon-failed"}),d.jsx("span",{className:"name",children:je.nameKey?n(je.nameKey):je.name}),d.jsxs("span",{className:`amount ${je.status==="completed"?"positive":"negative"}`,children:[je.status==="completed"?"+":"",ce(je.amount||0)]})]},Ve))}),d.jsxs("div",{className:"objectives-total",children:[d.jsx("span",{children:"Balance de objetivos:"}),d.jsxs("span",{className:pe.netResult>=0?"positive":"negative",children:[pe.netResult>=0?"+":"",ce(pe.netResult)]})]})]}),d.jsxs("div",{className:"season-total",children:[d.jsxs("div",{className:"total-row",children:[d.jsx("span",{children:"Objetivos"}),d.jsxs("span",{className:pe.netResult>=0?"positive":"negative",children:[pe.netResult>=0?"+":"",ce(pe.netResult)]})]}),oe>0&&d.jsxs("div",{className:"total-row",children:[d.jsx("span",{children:"Bonus europeo"}),d.jsxs("span",{className:"positive",children:["+",ce(oe)]})]}),(i.stadium?.accumulatedTicketIncome??0)>0&&d.jsxs("div",{className:"total-row",children:[d.jsxs("span",{children:[d.jsx(WC,{size:12})," Entradas (acumulado)"]}),d.jsxs("span",{className:"positive",children:["+",ce(i.stadium?.accumulatedTicketIncome??0)]})]}),d.jsxs("div",{className:"total-row",children:[d.jsx("span",{children:"Masa salarial"}),d.jsxs("span",{className:"negative",children:["-",ce(be)]})]}),d.jsxs("div",{className:"total-row total-row--final",children:[d.jsx("span",{children:"Balance final"}),d.jsxs("span",{className:pe.netResult+oe+(i.stadium?.accumulatedTicketIncome??0)-be>=0?"positive":"negative",children:[pe.netResult+oe+(i.stadium?.accumulatedTicketIncome??0)-be>=0?"+":"",ce(pe.netResult+oe+(i.stadium?.accumulatedTicketIncome??0)-be)]})]})]}),d.jsxs("button",{className:"btn-continue",onClick:()=>T("preseason"),children:["Continuar a Pretemporada",d.jsx(_r,{size:20})]})]})}):d.jsx("div",{className:"season-end",children:d.jsxs("div",{className:"season-end__modal season-end__modal--preseason",children:[d.jsxs("div",{className:"modal-header",children:[d.jsx(pm,{size:32,className:"header-icon"}),d.jsxs("div",{children:[d.jsxs("h1",{children:["Pretemporada ",i.currentSeason+1]}),d.jsx("p",{children:"Elige tu plan de preparacin"})]})]}),d.jsx("p",{className:"preseason-intro",children:"Selecciona uno de los siguientes paquetes de amistosos. El ltimo partido siempre ser en casa como presentacin del equipo."}),d.jsx("div",{className:"preseason-options",children:Ee.map(je=>d.jsxs("div",{className:`preseason-card ${E?.id===je.id?"selected":""}`,onClick:()=>te(je),children:[d.jsxs("div",{className:"card-header",children:[je.id==="prestige"&&d.jsx(k2,{size:24}),je.id==="balanced"&&d.jsx(ef,{size:24}),je.id==="regional"&&d.jsx(qh,{size:24}),d.jsx("h3",{children:je.name})]}),d.jsx("p",{className:"card-description",children:je.description}),d.jsxs("div",{className:"card-details",children:[d.jsxs("span",{className:`difficulty difficulty--${je.difficulty}`,children:["Dificultad: ",je.difficulty==="high"?"Alta":je.difficulty==="medium"?"Media":"Baja"]}),d.jsxs("span",{className:"earnings",children:["Ingresos potenciales: ",je.potentialEarnings]})]}),d.jsxs("div",{className:"matches-preview",children:[d.jsx("h4",{children:"Rivales:"}),d.jsx("ul",{children:je.matches.map((Ve,Me)=>d.jsxs("li",{children:[d.jsx("span",{className:"match-location",children:Ve.isHome?d.jsx(qh,{size:14}):d.jsx(k2,{size:14})}),d.jsx("span",{className:"opponent-name",children:Ve.opponent.name}),d.jsxs("span",{className:"opponent-ovr",children:[Ve.opponent.reputation," OVR"]}),Ve.isPresentationMatch&&d.jsxs("span",{className:"presentation-badge",children:[d.jsx(jg,{size:12})," Presentacin"]})]},Me))})]})]},je.id))}),d.jsxs("div",{className:"preseason-actions",children:[d.jsx("button",{className:"btn-back",onClick:()=>T("summary"),children:"Volver"}),d.jsxs("button",{className:"btn-confirm",onClick:at,disabled:!E,children:["Comenzar Pretemporada",d.jsx(_r,{size:20})]})]})]})})}function ZJe(){const{state:a,dispatch:e}=Va(),{t:n}=Sa();if(a.gameMode==="contrarreloj")return a.contrarrelojData?.finished?e({type:"SET_SCREEN",payload:"contrarreloj_end"}):e({type:"CONTRARRELOJ_LOSE",payload:{reason:"fired"}}),null;if(a.gameMode==="promanager")return a.proManagerData&&e({type:"SET_PROMANAGER_DATA",payload:{...a.proManagerData,fired:!0,boardConfidence:0}}),e({type:"SET_SCREEN",payload:"promanager_season_end"}),null;const i=()=>{e({type:"RESET_GAME"}),e({type:"SET_SCREEN",payload:"main_menu"})},s=a.leagueTable?.findIndex(o=>o.teamId===a.teamId)+1||"?",r=a.leagueTable?.find(o=>o.teamId===a.teamId);return d.jsxs("div",{className:"manager-fired",children:[d.jsx("div",{className:"manager-fired__overlay"}),d.jsxs("div",{className:"manager-fired__modal",children:[d.jsx("div",{className:"manager-fired__icon",children:d.jsx(vk,{size:64,strokeWidth:1.5})}),d.jsx("h1",{children:n("managerFired.title")}),d.jsx("h2",{children:a.team?.name}),d.jsx("p",{className:"manager-fired__reason",children:a.managerFiredReason?a.managerFiredReason.startsWith("managerFired.")?n(a.managerFiredReason):a.managerFiredReason:n("managerFired.defaultReason")}),d.jsxs("div",{className:"manager-fired__stats",children:[d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"label",children:n("ranking.position")}),d.jsxs("span",{className:"value",children:[s,""]})]}),d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"label",children:n("common.week")}),d.jsx("span",{className:"value",children:a.currentWeek})]}),d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"label",children:n("leagueTable.points")}),d.jsx("span",{className:"value",children:r?.points||0})]}),d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"label",children:n("managerFired.balance")}),d.jsxs("span",{className:"value",children:[r?.won||0,"V ",r?.drawn||0,"E ",r?.lost||0,"D"]})]})]}),d.jsxs("div",{className:"manager-fired__confidence",children:[d.jsx("span",{className:"label",children:n("managerFired.confidence")}),d.jsx("div",{className:"bar",children:d.jsx("div",{className:"fill",style:{width:`${a.managerConfidence||0}%`}})}),d.jsxs("span",{className:"value",children:[a.managerConfidence||0,"%"]})]}),d.jsxs("button",{className:"manager-fired__btn",onClick:i,children:[d.jsx(qh,{size:20}),d.jsx("span",{children:n("managerFired.backToMenu")})]})]})]})}function Cle(){const{t:a}=Sa(),{state:e}=Va(),[n,i]=ge.useState(null),[s,r]=ge.useState("points"),[o,l]=ge.useState("desc"),c=fm(e.playerLeagueId),u=c?e.saCompetitions:e.europeanCompetitions,h=ge.useMemo(()=>u?.competitions?c?vP(u,e.teamId):gP(u,e.teamId):null,[u,e.teamId,c]),f=n||h?.competitionId||(u?.competitions?Object.keys(u.competitions).find(O=>u.competitions[O]):null),m=u?.competitions?.[f];if(!u||!u.initialized)return d.jsx("div",{className:"europe",children:d.jsxs("div",{className:"europe__empty",children:[d.jsx(dc,{size:48,strokeWidth:1.5}),d.jsx("h2",{children:a("europe.title")}),d.jsx("p",{children:a("europe.notQualified")}),d.jsx("p",{className:"europe__hint",children:a("europe.qualificationHint")})]})});const A=m?.teams?.some(O=>O.teamId===e.teamId),x=m?uZ(m,e.teamId):!1,T=m?.prizesMoney?.[e.teamId]||0,E=ge.useMemo(()=>{if(!m?.standings)return[];const O=[...m.standings];return O.sort((D,j)=>{let L,U;switch(s){case"name":L=D.teamName,U=j.teamName;break;case"played":L=D.played,U=j.played;break;case"won":L=D.won,U=j.won;break;case"drawn":L=D.drawn,U=j.drawn;break;case"lost":L=D.lost,U=j.lost;break;case"gf":L=D.goalsFor,U=j.goalsFor;break;case"ga":L=D.goalsAgainst,U=j.goalsAgainst;break;case"gd":L=D.goalDifference,U=j.goalDifference;break;default:L=D.points,U=j.points;break}return s==="name"?o==="asc"?L.localeCompare(U):U.localeCompare(L):o==="desc"?U-L:L-U}),O},[m?.standings,s,o]),M=O=>{s===O?l(D=>D==="desc"?"asc":"desc"):(r(O),l("desc"))},N=({column:O})=>s!==O?null:o==="desc"?d.jsx(S0,{size:12}):d.jsx(jT,{size:12}),I=O=>O>=1e6?`${(O/1e6).toFixed(1)}M`:O>=1e3?`${(O/1e3).toFixed(0)}K`:`${O}`,F=O=>O<=8?"direct":O<=24?"playoff":"eliminated",G=O=>({league:a("europe.phases.league"),playoff:a("europe.phases.playoff"),r16:a("europe.phases.r16"),qf:a("europe.phases.qf"),sf:a("europe.phases.sf"),final:a("europe.phases.final"),completed:a("europe.phases.completed")})[O]||O;return d.jsxs("div",{className:"europe",children:[d.jsx("div",{className:"europe__tabs",children:Object.entries(sZ).map(([O,D])=>{if(!u.competitions[O])return null;const L=f===O,U=h?.competitionId===O;return d.jsxs("button",{className:`europe__tab ${L?"active":""} ${U?"player":""}`,onClick:()=>i(O),children:[d.jsx("span",{className:"europe__tab-icon",children:D.icon}),d.jsx("span",{className:"europe__tab-name",children:D.shortName}),U&&d.jsx(Br,{size:12,className:"europe__tab-star"})]},O)})}),!m&&d.jsx("div",{className:"europe__empty",children:d.jsx("p",{children:a("europe.selectCompetition")})}),m&&d.jsxs("div",{className:"europe__content",children:[d.jsxs("div",{className:"europe__header",children:[d.jsxs("div",{className:"europe__header-info",children:[d.jsxs("h2",{children:[d.jsx("span",{className:"europe__comp-icon",children:m.config.icon}),m.config.name]}),d.jsxs("div",{className:"europe__phase-badge",children:[G(m.phase),m.phase==="league"&&m.currentMatchday>0&&d.jsxs("span",{children:["  ",a("europe.matchday",{current:m.currentMatchday,total:8})]})]})]}),A&&d.jsxs("div",{className:"europe__player-info",children:[d.jsxs("div",{className:"europe__prize",children:[d.jsx(Ay,{size:16}),d.jsx("span",{children:a("europe.prizes",{amount:I(T)})})]}),!x&&m.phase!=="league"&&d.jsxs("div",{className:"europe__eliminated-badge",children:[d.jsx(ru,{size:14}),d.jsx("span",{children:a("europe.eliminated")})]})]})]}),(m.phase==="league"||E.length>0)&&d.jsxs("div",{className:"europe__standings",children:[d.jsx("h3",{children:a("europe.standings")}),d.jsx("div",{className:"europe__table-wrapper",children:d.jsxs("table",{className:"europe__table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{className:"pos",children:"#"}),d.jsxs("th",{className:"team",onClick:()=>M("name"),children:[a("common.team")," ",d.jsx(N,{column:"name"})]}),d.jsx("th",{className:"league-flag",children:a("common.league")}),d.jsxs("th",{className:"num",onClick:()=>M("played"),children:[a("leagueTable.played")," ",d.jsx(N,{column:"played"})]}),d.jsxs("th",{className:"num",onClick:()=>M("won"),children:[a("leagueTable.won")," ",d.jsx(N,{column:"won"})]}),d.jsxs("th",{className:"num",onClick:()=>M("drawn"),children:[a("leagueTable.drawn")," ",d.jsx(N,{column:"drawn"})]}),d.jsxs("th",{className:"num",onClick:()=>M("lost"),children:[a("leagueTable.lost")," ",d.jsx(N,{column:"lost"})]}),d.jsxs("th",{className:"num",onClick:()=>M("gf"),children:[a("leagueTable.goalsFor")," ",d.jsx(N,{column:"gf"})]}),d.jsxs("th",{className:"num",onClick:()=>M("ga"),children:[a("leagueTable.goalsAgainst")," ",d.jsx(N,{column:"ga"})]}),d.jsxs("th",{className:"num",onClick:()=>M("gd"),children:[a("leagueTable.goalDifference")," ",d.jsx(N,{column:"gd"})]}),d.jsxs("th",{className:"num pts",onClick:()=>M("points"),children:[a("leagueTable.points")," ",d.jsx(N,{column:"points"})]})]})}),d.jsx("tbody",{children:E.map((O,D)=>{const j=D+1,L=F(j),U=O.teamId===e.teamId,q={laliga:"",segunda:"",premierLeague:"",serieA:"",bundesliga:"",ligue1:"",eredivisie:"",primeiraLiga:"",belgianPro:"",superLig:"",scottishPrem:"",austrianBundesliga:"",greekSuperLeague:"",swissSuperLeague:"",danishSuperliga:"",croatianLeague:"",czechLeague:""};return d.jsxs("tr",{className:`${L} ${U?"is-player":""}`,children:[d.jsx("td",{className:"pos",children:d.jsx("span",{className:`pos-badge ${L}`,children:j})}),d.jsxs("td",{className:"team",children:[O.teamName||O.shortName,U&&d.jsx(Br,{size:10,className:"player-star"})]}),d.jsx("td",{className:"league-flag",children:q[O.league]||d.jsx(dc,{size:14})}),d.jsx("td",{className:"num",children:O.played}),d.jsx("td",{className:"num",children:O.won}),d.jsx("td",{className:"num",children:O.drawn}),d.jsx("td",{className:"num",children:O.lost}),d.jsx("td",{className:"num",children:O.goalsFor}),d.jsx("td",{className:"num",children:O.goalsAgainst}),d.jsx("td",{className:"num",children:O.goalDifference>0?`+${O.goalDifference}`:O.goalDifference}),d.jsx("td",{className:"num pts",children:O.points})]},O.teamId)})})]})}),d.jsxs("div",{className:"europe__legend",children:[d.jsxs("span",{className:"legend-item direct",children:[d.jsx("span",{className:"dot"})," ",a("europe.legend.directQualification")]}),d.jsxs("span",{className:"legend-item playoff",children:[d.jsx("span",{className:"dot"})," ",a("europe.legend.playoff")]}),d.jsxs("span",{className:"legend-item eliminated",children:[d.jsx("span",{className:"dot"})," ",a("europe.legend.eliminated")]})]})]}),m.phase!=="league"&&m.phase!=="completed"&&d.jsxs("div",{className:"europe__knockout",children:[d.jsx("h3",{children:a("europe.knockoutPhase",{phase:G(m.phase)})}),eZe(m,e.teamId)]}),m.phase==="completed"&&m.finalResult&&d.jsxs("div",{className:"europe__final-result",children:[d.jsx(Ai,{size:32}),d.jsx("h3",{children:a("europe.championTitle",{competition:m.config.name})}),d.jsx("p",{className:"europe__winner-name",children:m.finalResult.winner?.teamName||a("common.unknown")}),d.jsx("p",{className:"europe__final-score",children:a("europe.finalScore",{score:m.finalResult.aggregate})})]}),m.results.length>0&&d.jsxs("div",{className:"europe__results",children:[d.jsx("h3",{children:a("europe.recentResults")}),d.jsx("div",{className:"europe__results-list",children:m.results.slice(-12).reverse().map((O,D)=>{const j=m.teams.find(q=>q.teamId===O.homeTeamId),L=m.teams.find(q=>q.teamId===O.awayTeamId),U=O.homeTeamId===e.teamId||O.awayTeamId===e.teamId;return d.jsxs("div",{className:`europe__result-item ${U?"player-match":""}`,children:[d.jsxs("span",{className:"matchday",children:["J",O.matchday]}),d.jsx("span",{className:"home-team",children:j?.teamName||j?.shortName||O.homeTeamId}),d.jsxs("span",{className:"score",children:[O.homeScore," - ",O.awayScore]}),d.jsx("span",{className:"away-team",children:L?.teamName||L?.shortName||O.awayTeamId})]},D)})})]})]})]})}function eZe(a,e){const n={playoff:a.playoffResults||a.playoffMatchups||[],r16:a.r16Results||a.r16Matchups||[],qf:a.qfResults||a.qfMatchups||[],sf:a.sfResults||a.sfMatchups||[],final:a.finalResult?[a.finalResult]:a.finalMatchup?[a.finalMatchup]:[]};a.phase;const i=["playoff","r16","qf","sf","final"].filter(s=>n[s].length>0);return i.length===0?d.jsx("p",{className:"europe__no-data",children:t("europe.pendingDraw")}):d.jsx("div",{className:"europe__bracket",children:i.map(s=>d.jsxs("div",{className:"europe__bracket-round",children:[d.jsx("h4",{className:"europe__bracket-title",children:s==="playoff"?t("europe.phases.playoff"):s==="r16"?t("europe.phases.r16Short"):s==="qf"?t("europe.phases.qfShort"):s==="sf"?t("europe.phases.sfShort"):t("europe.phases.final")}),d.jsx("div",{className:"europe__bracket-matchups",children:n[s].map((r,o)=>{const l=r.team1,c=r.team2,u=r.winner!=null,h=l?.teamId===e||c?.teamId===e;return d.jsxs("div",{className:`europe__matchup ${h?"player":""} ${u?"completed":"pending"}`,children:[d.jsxs("div",{className:`europe__matchup-team ${r.winner?.teamId===l?.teamId?"winner":""}`,children:[d.jsx("span",{className:"team-name",children:l?.teamName||l?.shortName||"?"}),r.leg1&&d.jsxs("span",{className:"leg-score",children:[r.leg1.homeScore,"-",r.leg1.awayScore]})]}),d.jsxs("div",{className:`europe__matchup-team ${r.winner?.teamId===c?.teamId?"winner":""}`,children:[d.jsx("span",{className:"team-name",children:c?.teamName||c?.shortName||"?"}),r.leg2&&d.jsxs("span",{className:"leg-score",children:[r.leg2.homeScore,"-",r.leg2.awayScore]})]}),u&&d.jsx("div",{className:"europe__matchup-agg",children:t("europe.aggregate",{score:r.aggregate})})]},o)})})]},s))})}function Nle(){const{t:a}=Sa(),{state:e}=Va(),n=e.cupCompetition,[i,s]=ge.useState(null);if(!n)return d.jsx("div",{className:"cup",children:d.jsxs("div",{className:"cup__empty",children:[d.jsx(Ay,{size:48}),d.jsx("p",{children:a("cup.noCupActive")})]})});const{config:r,rounds:o,currentRound:l,playerTeamId:c,playerEliminated:u,winner:h}=n;o.length;let f=null;if(u){for(let T=0;T<o.length;T++)if(o[T].matches.find(M=>(M.homeTeam?.teamId===c||M.awayTeam?.teamId===c)&&M.played&&M.winnerId!==c&&!M.bye)){f=T;break}}const m=T=>{s(i===T?null:T)},A=T=>T?T.shortName||T.teamName||"???":"",x=T=>T?.teamId===c;return d.jsxs("div",{className:"cup",children:[d.jsxs("div",{className:"cup__header",children:[d.jsxs("div",{className:"cup__title",children:[d.jsx("span",{className:"cup__icon",children:r?.icon||""}),d.jsxs("div",{children:[d.jsx("h2",{children:r?.name||a("cup.cup")}),d.jsxs("span",{className:"cup__subtitle",children:[a("cup.season")," ",e.currentSeason||1]})]})]}),h&&h===c&&d.jsxs("div",{className:"cup__status cup__status--champion",children:[d.jsx(Ai,{size:16}),d.jsx("span",{children:a("cup.champion")})]}),h&&h!==c&&d.jsxs("div",{className:"cup__status cup__status--finished",children:[d.jsx(x_,{size:16}),d.jsx("span",{children:a("cup.cupFinished")})]}),u&&!h&&f!==null&&d.jsxs("div",{className:"cup__status cup__status--eliminated",children:[d.jsx(wr,{size:16}),d.jsxs("span",{children:[a("cup.eliminatedIn")," ",o[f]?.name||`${a("cup.round")} ${f+1}`]})]}),!u&&!h&&d.jsxs("div",{className:"cup__status cup__status--active",children:[d.jsx(Ay,{size:16}),d.jsxs("span",{children:[a("cup.inCompetition"),"  ",o[l]?.name||a("cup.nextRound")]})]})]}),d.jsx("div",{className:"cup__bracket",children:o.map((T,E)=>{const M=E===l&&!h,N=E>l&&!h,I=T.matches.some(D=>D.homeTeam||D.awayTeam),F=T.matches.every(D=>D.played||D.bye),O=i===E||M&&i===null;return d.jsxs("div",{className:`cup__round ${M?"cup__round--current":""} ${F?"cup__round--played":""} ${N?"cup__round--future":""}`,children:[d.jsxs("button",{className:"cup__round-header",onClick:()=>m(E),children:[d.jsxs("div",{className:"cup__round-info",children:[d.jsx("span",{className:"cup__round-name",children:T.name}),d.jsxs("span",{className:"cup__round-count",children:[T.matches.filter(D=>!D.bye).length," ",a("cup.matches"),T.matches.filter(D=>D.bye).length>0&&`  ${T.matches.filter(D=>D.bye).length} ${a("cup.exempt")}`]})]}),M&&d.jsx("span",{className:"cup__round-badge",children:a("cup.current")}),O?d.jsx(jT,{size:18}):d.jsx(S0,{size:18})]}),O&&I&&d.jsx("div",{className:"cup__matches",children:T.matches.map((D,j)=>{if(D.bye)return d.jsxs("div",{className:`cup__match cup__match--bye ${x(D.homeTeam)?"cup__match--player":""}`,children:[d.jsx("div",{className:"cup__match-team cup__match-team--home",children:d.jsx("span",{className:`team-name ${x(D.homeTeam)?"is-player":""}`,children:A(D.homeTeam)})}),d.jsx("div",{className:"cup__match-result",children:d.jsx("span",{className:"bye-tag",children:a("cup.exempt")})}),d.jsx("div",{className:"cup__match-team cup__match-team--away",children:d.jsx("span",{className:"team-name",children:""})})]},j);if(!D.homeTeam&&!D.awayTeam)return d.jsxs("div",{className:"cup__match cup__match--empty",children:[d.jsx("div",{className:"cup__match-team",children:d.jsx("span",{className:"team-name",children:"???"})}),d.jsx("div",{className:"cup__match-result",children:d.jsx("span",{className:"vs",children:"vs"})}),d.jsx("div",{className:"cup__match-team",children:d.jsx("span",{className:"team-name",children:"???"})})]},j);const L=x(D.homeTeam),U=x(D.awayTeam),q=L||U,K=D.winnerId===c,H=D.winnerId===D.homeTeam?.teamId,X=D.winnerId===D.awayTeam?.teamId;return d.jsxs("div",{className:`cup__match ${q?"cup__match--player":""} ${D.played?"cup__match--played":""}`,children:[d.jsx("div",{className:`cup__match-team cup__match-team--home ${H?"winner":""}`,children:d.jsx("span",{className:`team-name ${L?"is-player":""}`,children:A(D.homeTeam)})}),d.jsx("div",{className:"cup__match-result",children:D.played?d.jsxs("span",{className:`score ${q?K?"win":"loss":""}`,children:[D.homeScore," - ",D.awayScore,D.penalties&&d.jsx("span",{className:"pen",children:"(P)"})]}):d.jsx("span",{className:"vs",children:"vs"})}),d.jsx("div",{className:`cup__match-team cup__match-team--away ${X?"winner":""}`,children:d.jsx("span",{className:`team-name ${U?"is-player":""}`,children:A(D.awayTeam)})})]},j)})})]},E)})}),h&&d.jsxs("div",{className:"cup__winner",children:[d.jsx(Ai,{size:32}),d.jsxs("div",{className:"cup__winner-info",children:[d.jsx("span",{className:"cup__winner-label",children:a("cup.champion")}),d.jsx("span",{className:"cup__winner-name",children:o[o.length-1]?.matches[0]?.homeTeam?.teamId===h?o[o.length-1]?.matches[0]?.homeTeam?.teamName:o[o.length-1]?.matches[0]?.awayTeam?.teamName||"???"})]})]})]})}function tZe(){const{t:a}=Sa(),{state:e}=Va(),[n,i]=ge.useState(null),[s,r]=ge.useState("points"),[o,l]=ge.useState("desc"),c=e.saCompetitions,u=ge.useMemo(()=>c?.competitions?vP(c,e.teamId):null,[c,e.teamId]),h=n||u?.competitionId||(c?.competitions?Object.keys(c.competitions).find(O=>c.competitions[O]):null),f=c?.competitions?.[h];if(!c||!c.initialized)return d.jsx("div",{className:"europe sa-comps",children:d.jsxs("div",{className:"europe__empty",children:[d.jsx(dc,{size:48,strokeWidth:1.5}),d.jsx("h2",{children:a("southAmerica.title")}),d.jsx("p",{children:a("southAmerica.notQualified")}),d.jsx("p",{className:"europe__hint",children:a("southAmerica.qualificationHint")})]})});const m=f?.teams?.some(O=>O.teamId===e.teamId),A=f?Gye(f,e.teamId):!1,x=f?.prizesMoney?.[e.teamId]||0,T=ge.useMemo(()=>{if(!f?.standings)return[];const O=[...f.standings];return O.sort((D,j)=>{let L,U;switch(s){case"name":L=D.teamName,U=j.teamName;break;case"played":L=D.played,U=j.played;break;case"won":L=D.won,U=j.won;break;case"drawn":L=D.drawn,U=j.drawn;break;case"lost":L=D.lost,U=j.lost;break;case"gf":L=D.goalsFor,U=j.goalsFor;break;case"ga":L=D.goalsAgainst,U=j.goalsAgainst;break;case"gd":L=D.goalDifference,U=j.goalDifference;break;default:L=D.points,U=j.points;break}return s==="name"?o==="asc"?L.localeCompare(U):U.localeCompare(L):o==="desc"?U-L:L-U}),O},[f?.standings,s,o]),E=O=>{s===O?l(D=>D==="desc"?"asc":"desc"):(r(O),l("desc"))},M=({column:O})=>s!==O?null:o==="desc"?d.jsx(S0,{size:12}):d.jsx(jT,{size:12}),N=O=>O>=1e6?`$${(O/1e6).toFixed(1)}M`:O>=1e3?`$${(O/1e3).toFixed(0)}K`:`$${O}`,I=O=>O<=8?"direct":O<=24?"playoff":"eliminated",F=O=>({league:a("europe.phases.league"),playoff:a("europe.phases.playoff"),r16:a("europe.phases.r16"),qf:a("europe.phases.qf"),sf:a("europe.phases.sf"),final:a("europe.phases.final"),completed:a("europe.phases.completed")})[O]||O,G={argentinaPrimera:"",brasileiraoA:"",colombiaPrimera:"",chilePrimera:"",uruguayPrimera:"",ecuadorLigaPro:"",paraguayPrimera:"",peruLiga1:"",boliviaPrimera:"",venezuelaPrimera:""};return d.jsxs("div",{className:"europe sa-comps",children:[d.jsx("div",{className:"europe__tabs",children:Object.entries(dZ).map(([O,D])=>{if(!c.competitions[O])return null;const L=h===O,U=u?.competitionId===O;return d.jsxs("button",{className:`europe__tab ${L?"active":""} ${U?"player":""}`,onClick:()=>i(O),children:[d.jsx("span",{className:"europe__tab-icon",children:D.icon}),d.jsx("span",{className:"europe__tab-name",children:D.shortName}),U&&d.jsx(Br,{size:12,className:"europe__tab-star"})]},O)})}),!f&&d.jsx("div",{className:"europe__empty",children:d.jsx("p",{children:a("europe.selectCompetition")})}),f&&d.jsxs("div",{className:"europe__content",children:[d.jsxs("div",{className:"europe__header",children:[d.jsxs("div",{className:"europe__header-info",children:[d.jsxs("h2",{children:[d.jsx("span",{className:"europe__comp-icon",children:f.config.icon}),f.config.name]}),d.jsxs("div",{className:"europe__phase-badge",children:[F(f.phase),f.phase==="league"&&f.currentMatchday>0&&d.jsxs("span",{children:["  ",a("europe.matchday",{current:f.currentMatchday,total:8})]})]})]}),m&&d.jsxs("div",{className:"europe__player-info",children:[d.jsxs("div",{className:"europe__prize",children:[d.jsx(Ay,{size:16}),d.jsx("span",{children:a("europe.prizes",{amount:N(x)})})]}),!A&&f.phase!=="league"&&d.jsxs("div",{className:"europe__eliminated-badge",children:[d.jsx(ru,{size:14}),d.jsx("span",{children:a("europe.eliminated")})]})]})]}),(f.phase==="league"||T.length>0)&&d.jsxs("div",{className:"europe__standings",children:[d.jsx("h3",{children:a("europe.standings")}),d.jsx("div",{className:"europe__table-wrapper",children:d.jsxs("table",{className:"europe__table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{className:"pos",children:"#"}),d.jsxs("th",{className:"team",onClick:()=>E("name"),children:[a("common.team")," ",d.jsx(M,{column:"name"})]}),d.jsx("th",{className:"league-flag",children:a("common.league")}),d.jsxs("th",{className:"num",onClick:()=>E("played"),children:[a("leagueTable.played")," ",d.jsx(M,{column:"played"})]}),d.jsxs("th",{className:"num",onClick:()=>E("won"),children:[a("leagueTable.won")," ",d.jsx(M,{column:"won"})]}),d.jsxs("th",{className:"num",onClick:()=>E("drawn"),children:[a("leagueTable.drawn")," ",d.jsx(M,{column:"drawn"})]}),d.jsxs("th",{className:"num",onClick:()=>E("lost"),children:[a("leagueTable.lost")," ",d.jsx(M,{column:"lost"})]}),d.jsxs("th",{className:"num",onClick:()=>E("gf"),children:[a("leagueTable.goalsFor")," ",d.jsx(M,{column:"gf"})]}),d.jsxs("th",{className:"num",onClick:()=>E("ga"),children:[a("leagueTable.goalsAgainst")," ",d.jsx(M,{column:"ga"})]}),d.jsxs("th",{className:"num",onClick:()=>E("gd"),children:[a("leagueTable.goalDifference")," ",d.jsx(M,{column:"gd"})]}),d.jsxs("th",{className:"num pts",onClick:()=>E("points"),children:[a("leagueTable.points")," ",d.jsx(M,{column:"points"})]})]})}),d.jsx("tbody",{children:T.map((O,D)=>{const j=D+1,L=I(j),U=O.teamId===e.teamId;return d.jsxs("tr",{className:`${L} ${U?"is-player":""}`,children:[d.jsx("td",{className:"pos",children:d.jsx("span",{className:`pos-badge ${L}`,children:j})}),d.jsxs("td",{className:"team",children:[O.teamName||O.shortName,U&&d.jsx(Br,{size:10,className:"player-star"})]}),d.jsx("td",{className:"league-flag",children:G[O.league]||d.jsx(dc,{size:14})}),d.jsx("td",{className:"num",children:O.played}),d.jsx("td",{className:"num",children:O.won}),d.jsx("td",{className:"num",children:O.drawn}),d.jsx("td",{className:"num",children:O.lost}),d.jsx("td",{className:"num",children:O.goalsFor}),d.jsx("td",{className:"num",children:O.goalsAgainst}),d.jsx("td",{className:"num",children:O.goalDifference>0?`+${O.goalDifference}`:O.goalDifference}),d.jsx("td",{className:"num pts",children:O.points})]},O.teamId)})})]})}),d.jsxs("div",{className:"europe__legend",children:[d.jsxs("span",{className:"legend-item direct",children:[d.jsx("span",{className:"dot"})," ",a("europe.legend.directQualification")]}),d.jsxs("span",{className:"legend-item playoff",children:[d.jsx("span",{className:"dot"})," ",a("europe.legend.playoff")]}),d.jsxs("span",{className:"legend-item eliminated",children:[d.jsx("span",{className:"dot"})," ",a("europe.legend.eliminated")]})]})]}),f.phase!=="league"&&f.phase!=="completed"&&d.jsxs("div",{className:"europe__knockout",children:[d.jsx("h3",{children:a("europe.knockoutPhase",{phase:F(f.phase)})}),nZe(f,e.teamId)]}),f.phase==="completed"&&f.finalResult&&d.jsxs("div",{className:"europe__final-result",children:[d.jsx(Ai,{size:32}),d.jsx("h3",{children:a("europe.championTitle",{competition:f.config.name})}),d.jsx("p",{className:"europe__winner-name",children:f.finalResult.winner?.teamName||a("common.unknown")}),d.jsx("p",{className:"europe__final-score",children:a("europe.finalScore",{score:f.finalResult.aggregate})})]}),f.results.length>0&&d.jsxs("div",{className:"europe__results",children:[d.jsx("h3",{children:a("europe.recentResults")}),d.jsx("div",{className:"europe__results-list",children:f.results.slice(-12).reverse().map((O,D)=>{const j=f.teams.find(q=>q.teamId===O.homeTeamId),L=f.teams.find(q=>q.teamId===O.awayTeamId),U=O.homeTeamId===e.teamId||O.awayTeamId===e.teamId;return d.jsxs("div",{className:`europe__result-item ${U?"player-match":""}`,children:[d.jsxs("span",{className:"matchday",children:["J",O.matchday]}),d.jsx("span",{className:"home-team",children:j?.teamName||j?.shortName||O.homeTeamId}),d.jsxs("span",{className:"score",children:[O.homeScore," - ",O.awayScore]}),d.jsx("span",{className:"away-team",children:L?.teamName||L?.shortName||O.awayTeamId})]},D)})})]})]})]})}function nZe(a,e){const n={playoff:a.playoffResults||a.playoffMatchups||[],r16:a.r16Results||a.r16Matchups||[],qf:a.qfResults||a.qfMatchups||[],sf:a.sfResults||a.sfMatchups||[],final:a.finalResult?[a.finalResult]:a.finalMatchup?[a.finalMatchup]:[]},i=["playoff","r16","qf","sf","final"].filter(s=>n[s].length>0);return i.length===0?d.jsx("p",{className:"europe__no-data",children:t("europe.pendingDraw")}):d.jsx("div",{className:"europe__bracket",children:i.map(s=>d.jsxs("div",{className:"europe__bracket-round",children:[d.jsx("h4",{className:"europe__bracket-title",children:s==="playoff"?t("europe.phases.playoff"):s==="r16"?t("europe.phases.r16Short"):s==="qf"?t("europe.phases.qfShort"):s==="sf"?t("europe.phases.sfShort"):t("europe.phases.final")}),d.jsx("div",{className:"europe__bracket-matchups",children:n[s].map((r,o)=>{const l=r.team1,c=r.team2,u=r.winner!=null,h=l?.teamId===e||c?.teamId===e;return d.jsxs("div",{className:`europe__matchup ${h?"player":""} ${u?"completed":"pending"}`,children:[d.jsxs("div",{className:`europe__matchup-team ${r.winner?.teamId===l?.teamId?"winner":""}`,children:[d.jsx("span",{className:"team-name",children:l?.teamName||l?.shortName||"?"}),r.leg1&&d.jsxs("span",{className:"leg-score",children:[r.leg1.homeScore,"-",r.leg1.awayScore]})]}),d.jsxs("div",{className:`europe__matchup-team ${r.winner?.teamId===c?.teamId?"winner":""}`,children:[d.jsx("span",{className:"team-name",children:c?.teamName||c?.shortName||"?"}),r.leg2&&d.jsxs("span",{className:"leg-score",children:[r.leg2.homeScore,"-",r.leg2.awayScore]})]}),u&&d.jsx("div",{className:"europe__matchup-agg",children:t("europe.aggregate",{score:r.aggregate})})]},o)})})]},s))})}function JY(){const{t:a}=Sa(),{state:e}=Va(),n=!!e.cupCompetition,i=!!e.europeanCompetitions?.initialized,s=!!e.saCompetitions?.initialized,r=fm(e.playerLeagueId),o=ge.useMemo(()=>e.europeanCompetitions?gP(e.europeanCompetitions,e.teamId):null,[e.europeanCompetitions,e.teamId]),l=ge.useMemo(()=>e.saCompetitions?vP(e.saCompetitions,e.teamId):null,[e.saCompetitions,e.teamId]),c=ge.useMemo(()=>{const A=[];if(A.push({id:"liga",label:a("competitions.league"),icon:""}),A.push({id:"cup",label:e.cupCompetition?.config?.shortName||a("competitions.cup"),icon:e.cupCompetition?.config?.icon||""}),r){const x=l?.state?.config?.shortName||a("competitions.continental"),T=l?.state?.config?.icon||"";A.push({id:"continental",label:x,icon:T})}else{const x=o?.state?.config?.shortName||a("competitions.europe"),T=o?.state?.config?.icon||"";A.push({id:"continental",label:x,icon:T})}return A},[e.cupCompetition,o,l,r,a]),[u,h]=ge.useState("liga"),f=r?s:i,m=a(r?"competitions.qualifyForSouthAmerican":"competitions.qualifyForEuropean");return d.jsxs("div",{className:"competitions",children:[d.jsx("div",{className:"competitions__tabs",children:c.map(A=>d.jsxs("button",{className:`competitions__tab ${u===A.id?"active":""}`,onClick:()=>h(A.id),children:[d.jsx("span",{className:"tab-icon",children:A.icon}),d.jsx("span",{className:"tab-label",children:A.label})]},A.id))}),d.jsxs("div",{className:"competitions__content",children:[u==="liga"&&d.jsx(pJe,{}),u==="cup"&&(n?d.jsx(Nle,{}):d.jsxs("div",{className:"competitions__placeholder",children:[d.jsx(Ai,{size:48,strokeWidth:1.5}),d.jsx("p",{children:a("competitions.cupWillStart")})]})),u==="continental"&&(f?r?d.jsx(tZe,{}):d.jsx(Cle,{}):d.jsxs("div",{className:"competitions__placeholder",children:[d.jsx(dc,{size:48,strokeWidth:1.5}),d.jsx("p",{children:m})]}))]})]})}function aZe(){const{t:a}=Sa(),{state:e}=Va(),n=e.proManagerData;if(!n||e.gameMode!=="promanager")return null;const i=n.boardConfidence??60,s=n.prestige??10,r=n.objective,o=aye(i),l=i>=70?"#4ade80":i>=40?"#f59e0b":"#ef4444",c=s>=60?"#6495ed":s>=30?"#a78bfa":"#8899aa";return d.jsxs("div",{className:"pm-dashboard",children:[d.jsxs("div",{className:"pm-dashboard__header",children:[d.jsx(gu,{size:16}),d.jsx("span",{children:a("proManager.dashboard")})]}),d.jsxs("div",{className:"pm-dashboard__section",children:[d.jsxs("div",{className:"pm-dashboard__label",children:[d.jsx(V2e,{size:13}),d.jsx("span",{children:a("proManager.boardConfidence")}),d.jsxs("span",{className:"value",style:{color:l},children:[i,"%"]})]}),d.jsx("div",{className:"pm-dashboard__bar",children:d.jsx("div",{className:"pm-dashboard__bar-fill",style:{width:`${i}%`,background:l}})}),d.jsxs("p",{className:`pm-dashboard__msg pm-dashboard__msg--${o.type}`,children:[o.type==="warning"&&d.jsx(wr,{size:12}),a(o.key)]})]}),r&&d.jsxs("div",{className:"pm-dashboard__section",children:[d.jsxs("div",{className:"pm-dashboard__label",children:[d.jsx(Fs,{size:13}),d.jsx("span",{children:a("proManager.objective")})]}),d.jsx("p",{className:"pm-dashboard__objective-text",children:a(r.label,r.labelParams)})]}),d.jsxs("div",{className:"pm-dashboard__section",children:[d.jsxs("div",{className:"pm-dashboard__label",children:[d.jsx(dl,{size:13}),d.jsx("span",{children:a("proManager.prestige")}),d.jsx("span",{className:"value",style:{color:c},children:s})]}),d.jsx("div",{className:"pm-dashboard__bar pm-dashboard__bar--prestige",children:d.jsx("div",{className:"pm-dashboard__bar-fill",style:{width:`${s}%`,background:c}})})]}),d.jsxs("div",{className:"pm-dashboard__stats",children:[d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"num",children:n.totalMatches||0}),d.jsx("span",{className:"lbl",children:a("proManager.matches")})]}),d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"num",children:n.totalWins||0}),d.jsx("span",{className:"lbl",children:a("proManager.wins")})]}),d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"num",children:n.titles||0}),d.jsxs("span",{className:"lbl",children:[d.jsx(Ai,{size:11})," ",a("proManager.titles")]})]})]})]})}const ZY=[{id:"bronze_iii",name:"Bronce III",division:1,color:"#cd7f32",icon:""},{id:"bronze_ii",name:"Bronce II",division:2,color:"#cd7f32",icon:""},{id:"bronze_i",name:"Bronce I",division:3,color:"#cd7f32",icon:""},{id:"silver_iii",name:"Plata III",division:4,color:"#c0c0c0",icon:""},{id:"silver_ii",name:"Plata II",division:5,color:"#c0c0c0",icon:""},{id:"silver_i",name:"Plata I",division:6,color:"#c0c0c0",icon:""},{id:"gold_iii",name:"Oro III",division:7,color:"#ffd700",icon:""},{id:"gold_ii",name:"Oro II",division:8,color:"#ffd700",icon:""},{id:"gold_i",name:"Oro I",division:9,color:"#ffd700",icon:""},{id:"platinum_iii",name:"Platino III",division:10,color:"#00d4aa",icon:""},{id:"platinum_ii",name:"Platino II",division:11,color:"#00d4aa",icon:""},{id:"platinum_i",name:"Platino I",division:12,color:"#00d4aa",icon:""},{id:"diamond_iii",name:"Diamante III",division:13,color:"#b9f2ff",icon:""},{id:"diamond_ii",name:"Diamante II",division:14,color:"#b9f2ff",icon:""},{id:"diamond_i",name:"Diamante I",division:15,color:"#b9f2ff",icon:""},{id:"challenger",name:"Challenger",division:16,color:"#ff4500",icon:""}],J7=100;function xx(a){const e=Math.min(Math.floor(a/J7),ZY.length-1);return ZY[Math.max(0,e)]}function c8(a){return a%J7}function u8(a,e,n=!1){const i=e-a,s=n?5:25,r=Math.round(i/100)*3;return Math.max(5,Math.min(45,s+r))}const bg={champions_league:10,liga:6,europa_league:5,libertadores:5,conference:3,sudamericana:3,copa:3,supercopa:1};function eX(a){let e=0;return a.championsLeague&&(e+=bg.champions_league),a.liga&&(e+=bg.liga),a.europaLeague&&(e+=bg.europa_league),a.libertadores&&(e+=bg.libertadores),a.conference&&(e+=bg.conference),a.sudamericana&&(e+=bg.sudamericana),a.copa&&(e+=bg.copa),a.supercopa&&(e+=bg.supercopa),a.finishedAboveRival&&(e+=2),e+=Math.min(2,a.h2hWins||0),e}const iZe={tier:"bronze_iii",lp:0,wins:0,losses:0,draws:0,matchHistory:[]},bx="ranked_queue",Bl="ranked_matches",yT="ranked_players",Sx={laliga:()=>V3,segunda:()=>z3,premierLeague:()=>G3,serieA:()=>W3,bundesliga:()=>H3,ligue1:()=>q3,eredivisie:()=>$3,primeiraLiga:()=>K3,championship:()=>Y3,belgianPro:()=>X3,superLig:()=>Q3,scottishPrem:()=>J3,serieB:()=>Z3,bundesliga2:()=>eN,ligue2:()=>tN,argentinaPrimera:()=>aN,brasileiraoA:()=>iN,colombiaPrimera:()=>sN,chilePrimera:()=>rN,uruguayPrimera:()=>oN,ecuadorLigaPro:()=>lN,ligaMX:()=>nN},sZe=["laliga","segunda","premierLeague","serieA","bundesliga","ligue1","eredivisie","primeiraLiga","championship","belgianPro","argentinaPrimera","brasileiraoA","colombiaPrimera","chilePrimera","uruguayPrimera","ligaMX"];async function Rle(a,e){const n=Ra(Kn,yT,a),i=await go(n);if(i.exists())return e&&i.data().displayName!==e&&await wl(n,{displayName:e,updatedAt:Hi()}),{id:i.id,...i.data()};const s={...iZe,displayName:e||"Jugador",totalLP:0,createdAt:Hi(),updatedAt:Hi()};return await Kf(n,s),{id:a,...s}}function Ple(a,e){return sP(Ra(Kn,yT,a),n=>{e(n.exists()?{id:n.id,...n.data()}:null)})}async function Ile(a,e,n){const i=Ra(Kn,bx,a);return await Kf(i,{uid:a,displayName:e,totalLP:n||0,joinedAt:Hi(),status:"waiting"}),i}async function Lle(a){try{await cy(Ra(Kn,bx,a))}catch{}}function Dle(a,e){return sP(Ra(Kn,bx,a),n=>{e(n.exists()?{id:n.id,...n.data()}:null)})}async function kle(a,e){const n=hf(du(Kn,bx),u0("status","==","waiting")),i=await ff(n);let s=null,r=1/0;return i.forEach(o=>{if(o.id===a)return;const l=Math.abs((o.data().totalLP||0)-e);l<r&&(r=l,s={id:o.id,...o.data()})}),s}async function rZe(a){const e=hf(du(Kn,Bl),u0("player1.uid","==",a)),n=await ff(e);for(const r of n.docs){const o=r.data();if(o.phase&&o.phase!=="results"&&o.phase!=="finished")return{id:r.id,...o}}const i=hf(du(Kn,Bl),u0("player2.uid","==",a)),s=await ff(i);for(const r of s.docs){const o=r.data();if(o.phase&&o.phase!=="results"&&o.phase!=="finished")return{id:r.id,...o}}return null}function oZe(){if(!cN())return console.warn("Team data not loaded yet for ranked"),null;const a=sZe.filter(f=>{const m=Sx[f]?.();return m&&m.length>=6});if(a.length===0)return null;const e=a[Math.floor(Math.random()*a.length)],n=Sx[e](),i=qAe[e]||{name:e},s=n.map(f=>{const m=f.players?f.players.reduce((A,x)=>A+(x.overall||65),0)/Math.max(1,f.players.length):65;return{...f,avgOverall:m}}),r=s[Math.floor(Math.random()*s.length)],l=s.filter(f=>f.id!==r.id&&Math.abs(f.avgOverall-r.avgOverall)<=5).sort(()=>Math.random()-.5),c=[r,...l.slice(0,2)];if(c.length<3){const f=s.filter(m=>!c.find(A=>A.id===m.id)&&Math.abs(m.avgOverall-r.avgOverall)<=10).sort(()=>Math.random()-.5);for(;c.length<3&&f.length>0;)c.push(f.shift())}const u=bk[e]||{},h=_we[e]||38;return{leagueId:e,leagueName:i.name,leagueCountry:i.country,matchdays:h,europeanSpots:u,teams:c.map(f=>({id:f.id,name:f.name,shortName:f.shortName||f.name,avgOverall:Math.round(f.avgOverall),reputation:f.reputation||3,playerCount:f.players?.length||0,stadium:f.stadium||f.stadiumName||"Estadio",budget:f.transferBudget||f.budget||5e6}))}}async function Ole(a,e){const n=oZe();if(!n)throw new Error("No se pudieron cargar equipos. Intenta de nuevo.");const i=Ra(du(Kn,Bl)),s={id:i.id,player1:{uid:a.uid||a.id,displayName:a.displayName,totalLP:a.totalLP||0,team:null,config:null},player2:{uid:e.uid||e.id,displayName:e.displayName,totalLP:e.totalLP||0,team:null,config:null},leagueId:n.leagueId,leagueName:n.leagueName,leagueCountry:n.leagueCountry,matchdays:n.matchdays,europeanSpots:n.europeanSpots,teams:n.teams,phase:"team_selection",phaseDeadline:bi.fromDate(new Date(Date.now()+60*1e3)),round1Data:{},round2Data:{},simulation1:null,simulation2:null,transfers:{player1:[],player2:[]},blockedTransfers:{player1:[],player2:[]},results:null,winner:null,createdAt:Hi(),updatedAt:Hi(),disconnectCheck:{player1Last:Hi(),player2Last:Hi()}};return await Kf(i,s),await Promise.all([cy(Ra(Kn,bx,a.uid||a.id)).catch(()=>{}),cy(Ra(Kn,bx,e.uid||e.id)).catch(()=>{})]),{id:i.id,...s}}function Z7(a,e){return sP(Ra(Kn,Bl,a),n=>{e(n.exists()?{id:n.id,...n.data()}:null)})}async function Fle(a,e,n){const i=Ra(Kn,Bl,a);await Cme(Kn,async s=>{const r=await s.get(i);if(!r.exists())throw new Error("Partida no encontrada");const o=r.data();if(o.phase!=="team_selection")throw new Error("Ya no se puede elegir equipo");const l=o.player1.uid===e?"player2":"player1";if(o[l].team===n)throw new Error("Equipo ya elegido por el rival");const c=o.player1.uid===e?"player1":"player2";if(o[c].team)throw new Error("Ya has elegido equipo");const u={[`${c}.team`]:n,updatedAt:Hi()};o[l].team&&(u.phase="round1",u.phaseDeadline=bi.fromDate(new Date(Date.now()+180*1e3))),s.update(i,u)})}async function d8(a,e,n){const i=Ra(Kn,Bl,a),r=(await go(i)).data(),o=r.player1.uid===e?"player1":"player2",l=r.phase==="round1"?"round1Data":"round2Data";await wl(i,{[`${o}.config`]:n,[`${l}.${o}`]:{...n,ready:!0,timestamp:Date.now()},updatedAt:Hi()})}async function jle(a,e,n,i){const s=Ra(Kn,Bl,a),o=(await go(s)).data(),l=o.player1.uid===e?"player1":"player2";if((o.blockedTransfers?.[l]||[]).includes(n))return{success:!1,reason:"Fichaje bloqueado hasta la siguiente ronda"};const u=Sx[o.leagueId]?.();if(!u)return{success:!1,reason:"Error cargando equipos"};const h=o[l].team,f=u.find(M=>M.id===h),m=u.find(M=>M.id===i);if(!f||!m)return{success:!1,reason:"Equipo no encontrado"};const A=m.players?.find(M=>M.name===n||M.id===n);if(!A)return{success:!1,reason:"Jugador no encontrado"};const{attemptTransfer:x,executeTransfer:T}=await Yh(async()=>{const{attemptTransfer:M,executeTransfer:N}=await import("./rankedSimulation-Do-ELc_5.js");return{attemptTransfer:M,executeTransfer:N}},[]),E=x(f,m,A,u);return E.success?(T(f,m,A),await wl(s,{[`transfers.${l}`]:Qz({player:A.name,from:m.name,to:f.name,value:E.value,timestamp:Date.now()}),updatedAt:Hi()})):await wl(s,{[`blockedTransfers.${l}`]:Qz(n),updatedAt:Hi()}),E}async function I_(a){const e=Ra(Kn,Bl,a),n=await go(e);if(!n.exists())return;const i=n.data(),r={team_selection:"round1",round1:"simulating1",simulating1:"round2",round2:"simulating2",simulating2:"results"}[i.phase];if(!r)return;const o={phase:r,updatedAt:Hi()};if(r==="round1")o.phaseDeadline=bi.fromDate(new Date(Date.now()+180*1e3)),o.ready={player1:!1,player2:!1};else if(r==="simulating1")try{const l=await lZe(i);o.simulation1=l,o.phaseDeadline=bi.fromDate(new Date(Date.now()+8e3))}catch(l){console.error("Half season simulation error:",l),o.simulation1=tX(i),o.phaseDeadline=bi.fromDate(new Date(Date.now()+5e3))}else if(r==="round2")o.phaseDeadline=bi.fromDate(new Date(Date.now()+180*1e3)),o.ready={player1:!1,player2:!1},o.blockedTransfers={player1:[],player2:[]};else if(r==="simulating2")try{const l=await cZe(i);o.simulation2=l,o.phaseDeadline=bi.fromDate(new Date(Date.now()+8e3))}catch(l){console.error("Full season simulation error:",l),o.simulation2=tX(i),o.phaseDeadline=bi.fromDate(new Date(Date.now()+5e3))}else if(r==="results"){const l=i.simulation2||o.simulation2;if(l){const c=l.player1,u=l.player2,h=eX(c),f=eX(u);let m=null;h>f?m=i.player1.uid:f>h?m=i.player2.uid:c.leaguePosition<u.leaguePosition?m=i.player1.uid:u.leaguePosition<c.leaguePosition&&(m=i.player2.uid),o.results={player1Points:h,player2Points:f,simulation:l},o.winner=m}}if(await wl(e,o),r==="results"&&o.results){const l=uZe(i,o.results.simulation);await Ble(i.player1.uid,i.player2.uid,o.winner,i.player1.totalLP||0,i.player2.totalLP||0,l)}}async function lZe(a){const{simulateHalfSeason:e}=await Yh(async()=>{const{simulateHalfSeason:r}=await import("./rankedSimulation-Do-ELc_5.js");return{simulateHalfSeason:r}},[]),n=Sx[a.leagueId]?.();if(!n||n.length<4)throw new Error("Not enough teams");const i=JSON.parse(JSON.stringify(n)),s=e(i,a.player1.team,a.player2.team,a.player1.config||{},a.player2.config||{},a.leagueId);return{table:s.table.slice(0,10).map(r=>({teamId:r.teamId,teamName:r.teamName,played:r.played,won:r.won,drawn:r.drawn,lost:r.lost,goalsFor:r.goalsFor,goalsAgainst:r.goalsAgainst,points:r.points})),player1Position:s.table.findIndex(r=>r.teamId===a.player1.team)+1,player2Position:s.table.findIndex(r=>r.teamId===a.player2.team)+1,h2h:s.h2h,_fullState:null}}async function cZe(a){const{simulateHalfSeason:e,simulateFullSeason:n}=await Yh(async()=>{const{simulateHalfSeason:l,simulateFullSeason:c}=await import("./rankedSimulation-Do-ELc_5.js");return{simulateHalfSeason:l,simulateFullSeason:c}},[]),i=Sx[a.leagueId]?.();if(!i||i.length<4)throw new Error("Not enough teams");const s=JSON.parse(JSON.stringify(i)),r=e(s,a.player1.team,a.player2.team,a.player1.config||{},a.player2.config||{},a.leagueId),o=n(r,s,a.player1.team,a.player2.team,a.player1.config||{},a.player2.config||{});return{player1:o.player1,player2:o.player2,table:o.table.slice(0,10).map(l=>({teamId:l.teamId,teamName:l.teamName,played:l.played,won:l.won,drawn:l.drawn,lost:l.lost,goalsFor:l.goalsFor,goalsAgainst:l.goalsAgainst,goalDifference:l.goalDifference,points:l.points}))}}function tX(a){const e=()=>Math.floor(Math.random()*4),n=Math.floor(Math.random()*20)+1,i=Math.floor(Math.random()*20)+1;return{player1:{teamId:a.player1.team,teamName:a.teams?.find(s=>s.id===a.player1.team)?.name||"Equipo 1",leaguePosition:n,leaguePoints:90-n*3,liga:n===1,copa:Math.random()<.12,championsLeague:!1,europaLeague:!1,conference:!1,libertadores:!1,sudamericana:!1,supercopa:!1,h2hResults:[{goalsFor:e(),goalsAgainst:e()}],h2hWins:0,finishedAboveRival:n<i},player2:{teamId:a.player2.team,teamName:a.teams?.find(s=>s.id===a.player2.team)?.name||"Equipo 2",leaguePosition:i,leaguePoints:90-i*3,liga:i===1,copa:Math.random()<.12,championsLeague:!1,europaLeague:!1,conference:!1,libertadores:!1,sudamericana:!1,supercopa:!1,h2hResults:[{goalsFor:e(),goalsAgainst:e()}],h2hWins:0,finishedAboveRival:i<n},table:[]}}function uZe(a,e){if(!e)return{player1Advantage:0,player2Advantage:0};const n=e.player1?.europeanCompetition,i=e.player2?.europeanCompetition,s=l=>l==="champions"||l==="libertadores"?3:l==="europaLeague"||l==="sudamericana"?2:l==="conference"?1:0,r=s(n),o=s(i);return{player1Advantage:r-o,player2Advantage:o-r}}async function Ble(a,e,n,i,s,r){const o=!n;let l=u8(n===a?i:s,n===a?s:i,o);const c=r||{player1Advantage:0,player2Advantage:0},u=Ra(Kn,yT,a),h=Ra(Kn,yT,e);if(o){await Promise.all([wl(u,{draws:Lu(1),totalLP:Lu(5),updatedAt:Hi()}),wl(h,{draws:Lu(1),totalLP:Lu(5),updatedAt:Hi()})]);return}const f=n===a,m=f?c.player1Advantage:c.player2Advantage;let A=l,x=Math.ceil(l*.7);m>0?(A=Math.max(8,l-m*4),x=Math.max(5,x-m*3)):m<0&&(A=Math.min(45,l+Math.abs(m)*5),x=Math.max(3,x-Math.abs(m)*2)),f?await Promise.all([wl(u,{wins:Lu(1),totalLP:Lu(A),updatedAt:Hi()}),wl(h,{losses:Lu(1),totalLP:Lu(-Math.min(x,s)),updatedAt:Hi()})]):await Promise.all([wl(h,{wins:Lu(1),totalLP:Lu(A),updatedAt:Hi()}),wl(u,{losses:Lu(1),totalLP:Lu(-Math.min(x,i)),updatedAt:Hi()})])}async function Ule(a,e){try{const n=Ra(Kn,Bl,a),i=await go(n);if(!i.exists())return;const r=i.data().player1.uid===e?"player1Last":"player2Last";await wl(n,{[`disconnectCheck.${r}`]:Hi()})}catch{}}async function Vle(a,e){try{const n=Ra(Kn,Bl,a),i=await go(n);if(!i.exists())return!1;const s=i.data(),r=s.player1.uid===e?"player2Last":"player1Last",o=s.disconnectCheck?.[r]?.toDate?.();return o?Date.now()-o.getTime()>3e4:!1}catch{return!1}}async function zle(a,e){const n=Ra(Kn,Bl,a),i=await go(n);if(!i.exists())return;const s=i.data();if(s.phase==="results")return;await wl(n,{phase:"results",winner:e,results:{disconnection:!0,player1Points:0,player2Points:0},updatedAt:Hi()});const r=s.player1.uid===e?s.player2.uid:s.player1.uid;await Ble(e,r,e,s.player1.totalLP||0,s.player2.totalLP||0,null)}async function Gle(a=100){try{const e=hf(du(Kn,yT),ZQ("totalLP","desc"),R3(a));return(await ff(e)).docs.map((i,s)=>({id:i.id,rank:s+1,...i.data()}))}catch(e){return console.error("Error loading leaderboard:",e),[]}}async function qle(a,e=20){try{const n=hf(du(Kn,Bl),u0("player1.uid","==",a),R3(50)),i=hf(du(Kn,Bl),u0("player2.uid","==",a),R3(50)),[s,r]=await Promise.all([ff(n),ff(i)]),o=[...s.docs.map(l=>({id:l.id,...l.data()})),...r.docs.map(l=>({id:l.id,...l.data()}))].filter(l=>l.phase==="results");return o.sort((l,c)=>(c.createdAt?.seconds||0)-(l.createdAt?.seconds||0)),o.slice(0,e)}catch(n){return console.error("Error loading match history:",n),[]}}function h8(a){return cN()?Sx[a]?.()||[]:[]}async function Hle(a,e){const n=Ra(Kn,Bl,a);await wl(n,{[`ready.${e===1?"player1":"player2"}`]:!0,updatedAt:Hi()})}function Wle(a,e){return sP(Ra(Kn,Bl,a),n=>{n.exists()&&e(n.data().ready||{player1:!1,player2:!1})})}const dZe=Object.freeze(Object.defineProperty({__proto__:null,advancePhase:I_,attemptRankedTransfer:jle,checkDisconnect:Vle,claimDisconnectWin:zle,createMatch:Ole,findMyActiveMatch:rZe,findOpponent:kle,getLeaderboard:Gle,getLeagueTeamsForMatch:h8,getMatchHistory:qle,getOrCreatePlayer:Rle,joinQueue:Ile,leaveQueue:Lle,onMatchChange:Z7,onPlayerChange:Ple,onQueueChange:Dle,onReadyChange:Wle,selectTeam:Fle,sendHeartbeat:Ule,setReady:Hle,submitRoundActions:d8,submitRoundConfig:d8},Symbol.toStringTag,{value:"Module"}));function hZe(){const{t:a}=Sa(),{user:e}=Mc(),{state:n}=Va(),[i,s]=ge.useState(null),[r,o]=ge.useState(0),[l,c]=ge.useState({player1:!1,player2:!1}),[u,h]=ge.useState(!1),f=n.rankedMatchId;ge.useEffect(()=>{if(f)return Z7(f,s)},[f]),ge.useEffect(()=>{if(f)return Wle(f,D=>{c(D||{player1:!1,player2:!1})})},[f]),ge.useEffect(()=>{if(!i?.phaseDeadline)return;const D=()=>{const L=i.phaseDeadline.toDate?i.phaseDeadline.toDate():new Date(i.phaseDeadline),U=Math.max(0,Math.floor((L.getTime()-Date.now())/1e3));o(U),U===0&&m()&&["round1","round2"].includes(i.phase)&&I_(f).catch(console.error)};D();const j=setInterval(D,1e3);return()=>clearInterval(j)},[i?.phaseDeadline,i?.phase]),ge.useEffect(()=>{!i||!f||l.player1&&l.player2&&m()&&["round1","round2"].includes(i.phase)&&I_(f).catch(console.error)},[l.player1,l.player2,i?.phase]);const m=ge.useCallback(()=>i?.player1?.uid===e?.uid,[i,e]),A=ge.useCallback(()=>m()?"player1":"player2",[i,e]),x=ge.useCallback(()=>m()?i?.player2:i?.player1,[i,e]),T=async()=>{if(!(!f||!e?.uid||u)){h(!0);try{const D=m()?1:2;await Hle(f,D)}catch(D){console.error("Error setting ready:",D)}h(!1)}};if(!i||!["round1","round2"].includes(i.phase))return null;const E=A(),M=l[E],N=(l.player1?1:0)+(l.player2?1:0),I=x(),F=i.phase==="round1"?a("ranked.round1"):a("ranked.round2"),G=D=>`${Math.floor(D/60)}:${(D%60).toString().padStart(2,"0")}`;let O="green";return r<=10?O="red-pulse":r<=30?O="red":r<=60&&(O="yellow"),d.jsxs("div",{className:`ranked-timer ranked-timer--${O}`,children:[d.jsxs("div",{className:"ranked-timer__info",children:[d.jsxs("div",{className:"ranked-timer__clock",children:[d.jsx(or,{size:16}),d.jsx("span",{className:"ranked-timer__time",children:G(r)})]}),d.jsxs("div",{className:"ranked-timer__match-info",children:[d.jsx("span",{className:"ranked-timer__round",children:F}),d.jsxs("span",{className:"ranked-timer__vs",children:["vs ",I?.displayName||"..."]})]})]}),d.jsxs("div",{className:"ranked-timer__actions",children:[d.jsxs("span",{className:"ranked-timer__ready-status",children:[N,"/2 ","".repeat(N)]}),d.jsx("button",{className:`ranked-timer__ready-btn ${M?"ready":""}`,onClick:T,disabled:M||u,children:M?d.jsxs(d.Fragment,{children:[d.jsx(uo,{size:16})," ",a("ranked.ready")]}):d.jsxs(d.Fragment,{children:[d.jsx(ru,{size:16})," ",a("ranked.setReady")]})})]})]})}const PC=()=>[...hu(),...fu(),...pu(),...mu(),...pf(),...Af(),...gf(),...mf(),...yf(),...vf(),..._f(),...xf(),...bf(),...Sf(),...Tf(),...wf(),...Ef(),...Mf(),...Cf(),...Nf(),...Rf(),...Pf(),...If(),...Lf(),...Df(),...kf(),...Of(),...Ff(),...jf(),...Bf(),...Uf(),...Vf(),...zf()];function fZe(){const{t:a}=Sa(),{state:e,dispatch:n,saveGame:i}=Va(),[s,r]=ge.useState("overview"),[o,l]=ge.useState(!1),[c,u]=ge.useState(!1),[h,f]=ge.useState(!1),[m,A]=ge.useState([]),[x,T]=ge.useState(!1),[E,M]=ge.useState(!1),[N,I]=ge.useState(!1),F=e.gameMode==="ranked"&&!!e.rankedMatchId,G=e.playerLeagueId||"laliga";let D=!e.preseasonPhase&&e.fixtures?.length>0&&Oq(e.fixtures,G);if(D&&e.europeanCalendar&&e.europeanCompetitions){const oe=gP(e.europeanCompetitions,e.teamId),Ae=oe&&uZ(oe.state,e.teamId),be=e.currentWeek<e.europeanCalendar.totalWeeks;(Ae&&be||e.pendingEuropeanMatch)&&(D=!1)}D&&e.europeanCalendar&&e.saCompetitions&&(e.currentWeek<e.europeanCalendar.totalWeeks||e.pendingSAMatch)&&(D=!1);const j=e.fixtures?.length>0?Math.max(...e.fixtures.map(oe=>oe.week)):38,L=Math.ceil(j/2),U=!e.preseasonPhase&&e.currentWeek>=L,q=oe=>oe>=1e6?`${(oe/1e6).toFixed(1)}M`:`${(oe/1e3).toFixed(0)}K`,K=()=>{const oe=e.lineup||{},Ae=Object.values(oe).filter(Ce=>Ce).map(Ce=>Ce.name);return(e.team?.players||[]).filter(Ce=>Ae.includes(Ce.name)&&Ce.injured&&Ce.injuryWeeksLeft>0)},H=()=>{const oe=e.lineup||{},Ae=Object.values(oe).filter(Ce=>Ce).map(Ce=>Ce.name);return(e.team?.players||[]).filter(Ce=>Ae.includes(Ce.name)&&Ce.suspended&&Ce.suspensionMatches>0)},X=()=>{if((e.team?.players||[]).length<11){if(E){e.gameMode==="contrarreloj"?n({type:"CONTRARRELOJ_LOSE",payload:{reason:"no_players"}}):n({type:"SET_MANAGER_FIRED",payload:{reason:a("office.notEnoughPlayers")}});return}M(!0),I(!0);return}if(M(!1),D){T(!0);return}const Ae=K();if(Ae.length>0){A(Ae),f(!0);return}const be=H();if(be.length>0){const Ce={...e.lineup||{}},ce=new Set(be.map(te=>te.name));Object.keys(Ce).forEach(te=>{Ce[te]&&ce.has(Ce[te].name)&&delete Ce[te]}),n({type:"SET_LINEUP",payload:Ce})}ne()},ne=()=>{if(D){T(!0);return}if(e.preseasonPhase)if(e.preseasonMatches?.[e.preseasonWeek-1]){l(!0);return}else{n({type:"END_PRESEASON"});return}const oe=e.fixtures.filter(be=>be.week===e.currentWeek&&!be.played),Ae=oe.find(be=>be.homeTeam===e.teamId||be.awayTeam===e.teamId);if(console.log("handleAdvanceWeek DEBUG:",{teamId:e.teamId,currentWeek:e.currentWeek,totalFixtures:e.fixtures?.length,weekFixturesCount:oe.length,weekFixtures:oe.slice(0,3),playerMatch:Ae,allTeamsCount:PC().length,seasonOver:D,pendingEuropeanMatch:e.pendingEuropeanMatch?"yes":"no"}),e.pendingCupMatch)l(!0);else if(e.pendingEuropeanMatch)l(!0);else if(e.pendingSAMatch)l(!0);else if(Ae)l(!0);else{const be=Y();n({type:"SET_FIXTURES",payload:be.fixtures}),n({type:"SET_LEAGUE_TABLE",payload:be.table}),n({type:"ADVANCE_WEEK"})}},Q=oe=>{if(l(!1),e.settings?.autoSave!==!1&&setTimeout(()=>i(),500),e.preseasonPhase)(e.preseasonWeek||1)+1>(e.preseasonMatches?.length||5)?n({type:"END_PRESEASON"}):n({type:"ADVANCE_PRESEASON_WEEK"});else if(oe==="league")n({type:"ADVANCE_WEEK"});else{if(e.fixtures.filter(Ce=>Ce.week===e.currentWeek&&!Ce.played).find(Ce=>Ce.homeTeam===e.teamId||Ce.awayTeam===e.teamId))return;n({type:"ADVANCE_WEEK"})}},Y=(oe=e.fixtures,Ae=e.leagueTable,be=e.currentWeek)=>{const Ce=PC().map(te=>te.id===e.teamId?e.team:te);return W6(oe,Ae,be,e.teamId,Ce)},ue=async oe=>{if(e.preseasonPhase||e.pendingCupMatch||e.pendingEuropeanMatch||e.pendingSAMatch)return;u(!0);let Ae=[...e.fixtures],be=[...e.leagueTable],Ce=e.currentWeek;const ce=PC();let te=0,fe=!1,Le=e.stadium?.accumulatedTicketIncome??0,Fe=e.cupCompetition?{...e.cupCompetition}:null,Ie=!1;const at=Ae.length>0?Math.max(...Ae.map(Ve=>Ve.week)):38,je=Math.max(oe,at-Ce+2);for(let Ve=0;Ve<je;Ve++){if(Ce>at||Oq(Ae,G)){fe=!0;break}Ve%5===0&&await new Promise(ve=>setTimeout(ve,0)),te++;const ze=Ae.filter(ve=>ve.week===Ce&&!ve.played).find(ve=>ve.homeTeam===e.teamId||ve.awayTeam===e.teamId);if(ze){const ve=ze.homeTeam===e.teamId,Ue=ve?ze.awayTeam:ze.homeTeam,it=ce.find(wt=>wt.id===Ue);if(it){const wt=ve?e.team:it,Mt=ve?it:e.team;let _e=.7;if(ve&&e.stadium){const pt=e.stadium,Te=[8e3,18e3,35e3,55e3,8e4][pt.level||0],st=pt.realCapacity||Te,mt=pt.seasonTicketsFinal??pt.seasonTickets??Math.floor(st*.3),ht=(pt.ticketPrice??30)+(pt.matchPriceAdjust||0),Qe=be.findIndex(Xt=>Xt.teamId===Ue)+1||10,Xe=be.findIndex(Xt=>Xt.teamId===e.teamId)+1||10,ct=be.find(Xt=>Xt.teamId===e.teamId),Tt=e.leagueId||"laliga",kt=["segunda","segundaRFEF","primeraRFEF"].includes(Tt)?2:1,vt=e.team?.players||[],Tn=vt.length>0?Math.round(vt.reduce((Xt,Ht)=>Xt+(Ht.overall||70),0)/vt.length):70;_e=FR({stadiumCapacity:st,seasonTickets:mt,ticketPrice:ht,rivalTeam:it,rivalPosition:Qe,teamPosition:Xe,totalTeams:be.length||20,streak:ct?.streak||0,morale:ct?.morale||70,leagueId:Tt,homeTeamId:e.teamId,awayTeamId:Ue,teamOverall:Tn,teamReputation:e.team?.reputation||70,division:kt}).fillRate}const le=jl(ze.homeTeam,ze.awayTeam,wt,Mt,{attendanceFillRate:ve?_e:.7},e.playerForm||{},e.teamId);if(ve&&e.stadium){const pt=e.stadium,Te=[8e3,18e3,35e3,55e3,8e4][pt.level||0],st=pt.realCapacity||Te,mt=pt.seasonTicketsFinal??pt.seasonTickets??Math.floor(st*.3),ht=(pt.ticketPrice??30)+(pt.matchPriceAdjust||0),Qe=pt.level??0,Xe=e.leagueId||"laliga",ct=["segunda","segundaRFEF","primeraRFEF"].includes(Xe)?2:1,Tt=e.team?.players||[],kt=Tt.length>0?Math.round(Tt.reduce(($t,zt)=>$t+(zt.overall||70),0)/Tt.length):70,vt=FR({stadiumCapacity:st,seasonTickets:mt,ticketPrice:ht,rivalTeam:it,rivalPosition:be.findIndex($t=>$t.teamId===Ue)+1||10,teamPosition:be.findIndex($t=>$t.teamId===e.teamId)+1||10,totalTeams:be.length||20,streak:be.find($t=>$t.teamId===e.teamId)?.streak||0,morale:be.find($t=>$t.teamId===e.teamId)?.morale||70,leagueId:Xe,homeTeamId:e.teamId,awayTeamId:Ue,teamOverall:kt,teamReputation:e.team?.reputation||70,division:ct}),Tn=vt.ticketSales*ht,Ne=8+Qe*2,Xt=vt.attendance*Ne,Ht=Tn+Xt;Le+=Ht}const Ge=ve?"home":"away";(le.events?.filter(pt=>pt.type==="injury"&&pt.team===Ge)||[]).forEach(pt=>{n({type:"INJURE_PLAYER",payload:{playerName:pt.player,weeksOut:pt.weeksOut,severity:pt.severity}})}),Ae=Ae.map(pt=>pt.id===ze.id?{...pt,played:!0,homeScore:le.homeScore,awayScore:le.awayScore,events:le.events}:pt),be=V_(be,ze.homeTeam,ze.awayTeam,le.homeScore,le.awayScore)}}const Je=ce.map(ve=>ve.id===e.teamId?e.team:ve),rt=W6(Ae,be,Ce,e.teamId,Je);if(Ae=rt.fixtures,be=rt.table,Fe&&!Fe.winner&&rZ(Ce,e.europeanCalendar)){const ve=PF(Ce,e.europeanCalendar);if(ve!==null&&ve===Fe.currentRound){const Ue={};e.leagueTeams&&e.leagueTeams.forEach(Mt=>{Ue[Mt.id]=Mt}),e.team&&(Ue[e.teamId]=e.team);const{updatedBracket:it,playerMatch:wt}=fZ(Fe,ve,e.teamId,Ue);if(Fe=it,wt&&!Fe.playerEliminated){const Mt=wt.homeTeam,_e=wt.awayTeam,le=Ue[Mt.teamId]||{id:Mt.teamId,name:Mt.teamName,players:Mt.players||[],reputation:Mt.reputation||70},Ge=Ue[_e.teamId]||{id:_e.teamId,name:_e.teamName,players:_e.players||[],reputation:_e.reputation||70},tt=jl(Mt.teamId,_e.teamId,le,Ge,{homeMorale:70,awayMorale:70},e.playerForm||{},e.teamId);Fe=pZ(Fe,ve,wt.matchIdx,tt.homeScore,tt.awayScore,e.teamId)}Ie=!0}}Ce++}n({type:"SET_FIXTURES",payload:Ae}),n({type:"SET_LEAGUE_TABLE",payload:be}),Ie&&Fe&&n({type:"INIT_CUP_COMPETITION",payload:Fe}),Le>(e.stadium?.accumulatedTicketIncome??0)&&n({type:"UPDATE_STADIUM",payload:{accumulatedTicketIncome:Le,ticketPriceLocked:!0}}),n({type:"ADVANCE_WEEKS_BATCH",payload:{count:te}}),u(!1),e.settings?.autoSave!==!1&&setTimeout(()=>i(),500),fe?(T(!0),n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"season",title:a("office.seasonEnd"),content:a("office.seasonEndedAfterWeeks",{weeks:te}),date:`${a("common.week")} ${e.currentWeek+te}`}})):n({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"simulation",title:a("office.simulatedWeeks",{weeks:te}),content:a("office.advancedToWeek",{week:e.currentWeek+te}),date:`${a("common.week")} ${e.currentWeek+te}`}})},pe=()=>{switch(s){case"plantilla":return d.jsx(oJe,{});case"formation":return d.jsx(lJe,{});case"training":return d.jsx(YJe,{});case"objectives":return d.jsx(QJe,{});case"calendar":return d.jsx(fJe,{});case"table":return d.jsx(JY,{});case"transfers":return d.jsx(SJe,{});case"stadium":return d.jsx(UJe,{});case"finance":return d.jsx(WJe,{});case"facilities":return d.jsx(GJe,{});case"competitions":return d.jsx(JY,{});case"europe":return d.jsx(Cle,{});case"cup":return d.jsx(Nle,{});case"messages":return d.jsx(qJe,{});default:return Ee()}},Ee=()=>{const oe=e.leagueTable.findIndex(Ce=>Ce.teamId===e.teamId)+1,Ae=e.leagueTable.find(Ce=>Ce.teamId===e.teamId);let be=null;if(e.preseasonPhase&&e.preseasonMatches?.length>0){const Ce=(e.preseasonWeek||1)-1,ce=e.preseasonMatches[Ce];ce&&!ce.played&&(be={...ce,isPreseason:!0,week:e.preseasonWeek})}else be=e.fixtures.find(Ce=>Ce.week>=e.currentWeek&&!Ce.played&&(Ce.homeTeam===e.teamId||Ce.awayTeam===e.teamId));return d.jsxs("div",{className:"office__overview",children:[e.gameMode==="promanager"&&d.jsx(aZe,{}),d.jsxs("div",{className:"office__welcome",children:[d.jsx("h2",{children:a("office.welcome")}),d.jsxs("p",{children:[a("office.seasonInfo",{season:e.currentSeason}),"  ",e.preseasonPhase?a("office.preseason",{week:e.preseasonWeek,total:e.preseasonMatches?.length||5}):a("office.weekInfo",{week:e.currentWeek})]})]}),d.jsxs("div",{className:"office__cards",children:[d.jsxs("div",{className:"office__card office__card--position",children:[d.jsx("div",{className:"office__card-icon",children:d.jsx(Ai,{size:28,strokeWidth:2})}),d.jsxs("div",{className:"office__card-content",children:[d.jsx("span",{className:"label",children:a("leagueTable.position")}),d.jsxs("span",{className:"value",children:[oe,""]})]})]}),d.jsxs("div",{className:"office__card office__card--points",children:[d.jsx("div",{className:"office__card-icon",children:d.jsx(dl,{size:28,strokeWidth:2})}),d.jsxs("div",{className:"office__card-content",children:[d.jsx("span",{className:"label",children:a("leagueTable.points")}),d.jsx("span",{className:"value",children:Ae?.points||0})]})]}),d.jsxs("div",{className:"office__card office__card--budget",children:[d.jsx("div",{className:"office__card-icon",children:d.jsx(_k,{size:28,strokeWidth:2})}),d.jsxs("div",{className:"office__card-content",children:[d.jsx("span",{className:"label",children:a("office.budget")}),d.jsx("span",{className:"value",children:q(e.money)})]})]}),d.jsxs("div",{className:"office__card office__card--squad",children:[d.jsx("div",{className:"office__card-icon",children:d.jsx(Hu,{size:28,strokeWidth:2})}),d.jsxs("div",{className:"office__card-content",children:[d.jsx("span",{className:"label",children:a("plantilla.title")}),d.jsx("span",{className:"value",children:e.team?.players?.length||0}),d.jsx("span",{className:"sublabel",children:a("office.players")})]})]})]}),!e.preseasonPhase&&e.currentWeek>5&&!F&&d.jsxs("div",{className:"office__confidence",style:{margin:"0 0 1.5rem",padding:"0.75rem 1rem",background:e.managerConfidence<=25?"rgba(231,76,60,0.12)":"rgba(255,255,255,0.03)",borderRadius:"8px",border:e.managerConfidence<=25?"1px solid rgba(231,76,60,0.3)":"1px solid rgba(255,255,255,0.06)"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.4rem"},children:[d.jsxs("span",{style:{fontSize:"0.75rem",color:"#8899aa",textTransform:"uppercase",letterSpacing:"1px"},children:[e.managerConfidence<=25?d.jsxs(d.Fragment,{children:[d.jsx(wr,{size:12})," "]}):"",a("office.boardConfidence")]}),d.jsxs("span",{style:{fontSize:"0.85rem",fontWeight:700,color:e.managerConfidence>60?"#2ecc71":e.managerConfidence>40?"#f39c12":e.managerConfidence>25?"#e67e22":"#e74c3c"},children:[e.managerConfidence,"%"]})]}),d.jsx("div",{style:{height:"6px",background:"rgba(255,255,255,0.08)",borderRadius:"3px",overflow:"hidden"},children:d.jsx("div",{style:{height:"100%",borderRadius:"3px",transition:"width 0.5s, background 0.5s",width:`${e.managerConfidence}%`,background:e.managerConfidence>60?"#2ecc71":e.managerConfidence>40?"#f39c12":e.managerConfidence>25?"#e67e22":"#e74c3c"}})})]}),d.jsxs("div",{className:"office__grid",children:[d.jsxs("div",{className:"office__grid-left",children:[be&&d.jsxs("div",{className:"office__next-match",children:[d.jsx("h3",{children:a("office.nextMatch")}),d.jsx("span",{className:"office__match-week",children:be.isPreseason?a("office.friendlyMatch",{week:be.week}):a("office.matchday",{week:be.week})}),d.jsxs("div",{className:"office__match-preview",children:[d.jsx("div",{className:"team home",children:d.jsx("span",{className:"name",children:be.isPreseason?be.homeTeamName||be.homeTeam:be.homeTeam===e.teamId?e.team.name:e.leagueTable.find(Ce=>Ce.teamId===be.homeTeam)?.teamName})}),d.jsx("div",{className:"vs",children:a("office.vs")}),d.jsx("div",{className:"team away",children:d.jsx("span",{className:"name",children:be.isPreseason?be.awayTeamName||be.awayTeam:be.awayTeam===e.teamId?e.team.name:e.leagueTable.find(Ce=>Ce.teamId===be.awayTeam)?.teamName})})]})]}),d.jsxs("div",{className:"office__form",children:[d.jsx("h3",{children:a("office.lastResults")}),d.jsx("div",{className:"office__form-badges",children:Ae?.form&&Ae.form.length>0?Ae.form.map((Ce,ce)=>d.jsx("span",{className:`form-badge ${Ce.toLowerCase()}`,children:a(`office.form_${Ce}`)},ce)):d.jsx("span",{className:"no-results",children:a("office.noMatches")})})]})]}),d.jsxs("div",{className:"office__grid-right",children:[e.seasonObjectives?.length>0&&e.gameMode!=="contrarreloj"&&!F&&d.jsxs("div",{className:"office__objective-preview",onClick:()=>r("objectives"),children:[d.jsxs("h3",{children:[d.jsx(Fs,{size:18,strokeWidth:2}),d.jsx("span",{children:a("office.mainObjective")})]}),(()=>{const Ce=e.seasonObjectives.find(fe=>fe.priority==="critical");if(!Ce)return null;let ce=0;Ce.type==="league_position"&&(oe<=Ce.target?ce=100:ce=Math.max(0,Math.round((1-(oe-Ce.target)/(20-Ce.target))*100)));const te=ce>=100?"completed":ce>=70?"on-track":ce>=40?"warning":"danger";return d.jsxs("div",{className:`objective-item objective-item--${te}`,children:[d.jsxs("div",{className:"objective-info",children:[d.jsx("span",{className:"objective-name",children:Ce.nameKey?a(Ce.nameKey):Ce.name}),d.jsx("span",{className:"objective-desc",children:Ce.descKey?a(Ce.descKey):Ce.description})]}),d.jsxs("div",{className:"objective-progress",children:[d.jsx("div",{className:"progress-bar",children:d.jsx("div",{className:"progress-fill",style:{width:`${ce}%`}})}),d.jsxs("span",{className:"progress-text",children:[ce,"%"]})]})]})})(),d.jsxs("span",{className:"view-all",children:[d.jsx("span",{children:a("office.viewAllObjectives")}),d.jsx(_r,{size:16})]})]}),e.messages.length>0&&!F&&d.jsxs("div",{className:"office__recent-messages",onClick:()=>r("messages"),children:[d.jsx("h3",{children:a("office.recentMessages")}),e.messages.slice(0,3).map(Ce=>d.jsxs("div",{className:"office__message-preview",children:[d.jsx("span",{className:"title",children:Ce.title}),d.jsx("span",{className:"date",children:Ce.date})]},Ce.id))]})]})]})]})};if(o)return d.jsx($Je,{onComplete:Q});if(N){const oe=(e.team?.players||[]).length;return d.jsx("div",{className:"office",children:d.jsx("div",{className:"injured-warning-modal",children:d.jsxs("div",{className:"injured-warning-content",children:[d.jsxs("h2",{children:[d.jsx(wr,{size:16})," ",a("office.insufficientSquad")]}),d.jsx("p",{children:a("office.onlyHavePlayers",{count:oe})}),d.jsx("p",{className:"warning-hint",children:a("office.goToTransfersWarning")}),d.jsx("div",{className:"warning-buttons",children:d.jsxs("button",{className:"btn-primary",onClick:()=>{I(!1),r("transfers")},children:[d.jsx(Hu,{size:16})," ",a("office.goToTransfers")]})})]})})})}return h?d.jsx("div",{className:"office",children:d.jsx("div",{className:"injured-warning-modal",children:d.jsxs("div",{className:"injured-warning-content",children:[d.jsxs("h2",{children:[d.jsx(wr,{size:16})," ",a("office.injuredWarning")]}),d.jsxs("p",{children:[a("office.playersInjured",{count:m.length}),":"]}),d.jsx("ul",{className:"injured-list",children:m.map(oe=>d.jsxs("li",{children:[d.jsx("span",{className:"pos",children:ds(oe.position)}),d.jsx("span",{className:"name",children:oe.name}),d.jsxs("span",{className:"weeks",children:[d.jsx(su,{size:14})," ",a("office.weeksOut",{weeks:oe.injuryWeeksLeft})]})]},oe.name))}),d.jsx("p",{className:"warning-hint",children:a("office.checkFormation")}),d.jsx("div",{className:"warning-buttons",children:d.jsx("button",{className:"btn-primary",onClick:()=>{f(!1),r("formation")},children:a("office.goToFormation")})})]})})}):e.managerFired?d.jsx(ZJe,{}):x?d.jsx(JJe,{allTeams:PC(),onComplete:()=>{T(!1),e.gameMode==="promanager"&&n({type:"SET_SCREEN",payload:"promanager_season_end"})}}):d.jsxs("div",{className:`office ${F?"office--ranked":""}`,children:[F&&d.jsx(hZe,{}),d.jsx(rJe,{activeTab:s,onTabChange:r,isRanked:F}),!F&&d.jsx(WY,{activeTab:s,onTabChange:r,onAdvanceWeek:X,onSimulate:ue,simulating:c}),F&&d.jsx(WY,{activeTab:s,onTabChange:r,onAdvanceWeek:()=>{},onSimulate:()=>{},simulating:!1,isRanked:!0}),d.jsxs("main",{className:"office__main",children:[d.jsxs("header",{className:"office__header",children:[d.jsxs("div",{className:"office__team-info",children:[d.jsx("h1",{children:e.team?.name}),d.jsxs("span",{className:"office__manager-name",onClick:()=>{const oe=window.prompt(a("office.changeManagerName"),e.managerName||"Gaffer");oe&&oe.trim()&&n({type:"SET_MANAGER_NAME",payload:oe.trim().slice(0,20)})},title:a("office.clickToChangeName"),children:[" ",e.managerName||"Gaffer"]}),d.jsxs("span",{className:"office__season",children:[a("office.seasonInfo",{season:e.currentSeason}),"  ",e.preseasonPhase?a("office.preseason",{week:e.preseasonWeek,total:e.preseasonMatches?.length||5}):a("office.weekInfo",{week:e.currentWeek})]})]}),!F&&d.jsxs("div",{className:"office__actions",children:[d.jsxs("div",{className:"office__money",children:[d.jsx("span",{className:"label",children:a("office.budget")}),d.jsx("span",{className:"value",children:q(e.money)})]}),d.jsxs("button",{className:"office__advance-btn",onClick:X,disabled:c,children:[d.jsx(zF,{size:18,strokeWidth:2}),d.jsx("span",{children:a("office.simulateWeek")})]}),d.jsxs("div",{className:"office__sim-dropdown",children:[d.jsxs("button",{className:"office__sim-btn",disabled:c||e.preseasonPhase||!!e.pendingEuropeanMatch||!!e.pendingSAMatch||!!e.pendingCupMatch,children:[d.jsx(jZ,{size:18,strokeWidth:2}),d.jsx("span",{children:a(c?"office.simulating":"office.simulate")})]}),!c&&!e.preseasonPhase&&!e.pendingEuropeanMatch&&!e.pendingSAMatch&&!e.pendingCupMatch&&d.jsxs("div",{className:"office__sim-options",children:[d.jsx("button",{onClick:()=>ue(3),children:a("office.threeMatches")}),U?d.jsx("button",{onClick:()=>ue(j-e.currentWeek+2),children:a("office.endOfSeason")}):d.jsx("button",{onClick:()=>ue(L-e.currentWeek+1),children:a("office.halfSeason")})]})]})]}),F&&d.jsx("div",{className:"office__actions",children:d.jsxs("div",{className:"office__money",children:[d.jsx("span",{className:"label",children:a("office.budget")}),d.jsx("span",{className:"value",children:q(e.money)})]})})]}),d.jsx("div",{className:"office__content",children:pe()})]})]})}const IC=[{id:"laliga",getter:hu},{id:"segunda",getter:fu},{id:"primeraRFEF",getter:pu},{id:"segundaRFEF",getter:mu},{id:"premierLeague",getter:pf},{id:"serieA",getter:mf},{id:"bundesliga",getter:gf},{id:"ligue1",getter:Af},{id:"eredivisie",getter:yf},{id:"primeiraLiga",getter:vf},{id:"championship",getter:_f},{id:"belgianPro",getter:xf},{id:"superLig",getter:bf},{id:"scottishPrem",getter:Sf},{id:"serieB",getter:Tf},{id:"bundesliga2",getter:wf},{id:"ligue2",getter:Ef},{id:"swissSuperLeague",getter:Mf},{id:"austrianBundesliga",getter:Cf},{id:"greekSuperLeague",getter:Nf},{id:"danishSuperliga",getter:Rf},{id:"croatianLeague",getter:Pf},{id:"czechLeague",getter:If},{id:"argentinaPrimera",getter:Lf},{id:"brasileiraoA",getter:Df},{id:"colombiaPrimera",getter:kf},{id:"chilePrimera",getter:Of},{id:"uruguayPrimera",getter:Ff},{id:"ecuadorLigaPro",getter:jf},{id:"paraguayPrimera",getter:Bf},{id:"peruLiga1",getter:Uf},{id:"boliviaPrimera",getter:Vf},{id:"venezuelaPrimera",getter:zf},{id:"mls",getter:hy},{id:"saudiPro",getter:fy},{id:"ligaMX",getter:py},{id:"jLeague",getter:my}].map(a=>({...a,name:Wa[a.id]?.name||a.id})),pZe=["primeraRFEF"];function mZe(a){return a?.players?.length?Math.round(a.players.reduce((e,n)=>e+(n.overall||0),0)/a.players.length):0}function gZe(a){return a?a>=1e6?`${(a/1e6).toFixed(1)}M`:`${(a/1e3).toFixed(0)}K`:"0"}function AZe(a,e){const n={1:{pct:.12,min:15e6,max:5e8},2:{pct:.1,min:5e6,max:12e7},3:{pct:.07,min:15e5,max:3e7},4:{pct:.05,min:3e5,max:5e6},5:{pct:.03,min:1e5,max:15e5}},i=Pl(e),s=n[i]||n[3],r=a.players?.length?a.players.reduce((l,c)=>l+(c.overall||0),0)/a.players.length:70,o=(a.players||[]).reduce((l,c)=>l+(c.value||0),0);if(a.reputation||(r>=82?a.reputation=5:r>=78?a.reputation=4:r>=73?a.reputation=3:r>=68?a.reputation=2:a.reputation=1),!a.budget){const l=Math.max(o*s.pct,s.min),c=[.5,.7,1,1.5,2.5][a.reputation-1]||1;a.budget=Math.round(Math.min(l*c,s.max))}return a}function yZe(){const{t:a}=Sa(),{dispatch:e}=Va(),{user:n,isAuthenticated:i}=Mc(),[s,r]=ge.useState(null),[o,l]=ge.useState(null),[c,u]=ge.useState(!1),[h,f]=ge.useState(0),m=new Set(["argentinaPrimera","brasileiraoA","colombiaPrimera","chilePrimera","uruguayPrimera","ecuadorLigaPro","paraguayPrimera","peruLiga1","boliviaPrimera","venezuelaPrimera"]),A=ge.useMemo(()=>{const M=[],N=[],I=new Set(["mls","saudiPro","ligaMX","jLeague"]);for(const D of IC)if(!pZe.includes(D.id)&&!I.has(D.id))try{const j=D.getter();if(!j||j.length===0)continue;for(const L of j){if(L.name&&/\sB$/i.test(L.name.trim()))continue;const U={...L};AZe(U,D.id);const q=Pl(D.id);if(U.reputation<=2||q>=3){const K={team:U,leagueId:D.id,leagueName:D.name,tier:q};m.has(D.id)?N.push(K):M.push(K)}}}catch{}const F=D=>D.sort(()=>Math.random()-.5);F(M),F(N);const G=[];M.length>0&&G.push(M.shift()),N.length>0&&G.push(N.shift());const O=F([...M,...N]);for(;G.length<5&&O.length>0;)G.push(O.shift());return F(G)},[h]),x=()=>{r(null),l(null),f(M=>M+1)},T=M=>{r(M.team),l(M.leagueId)},E=async()=>{if(!s||!o||c)return;u(!0);const M=o,N=s,I=IC.find(pe=>pe.id===M);if(!I)return;const F={segundaRFEF:EF,primeraRFEF:wF};let G,O=null;if(F[M]){const pe=F[M]();for(const[Ee,oe]of Object.entries(pe)){const Ae=oe?.teams||oe||[];if(Ae.some(be=>be.id===N.id)){G=Ae,O=Ee;break}}G||(G=I.getter())}else G=I.getter();const D=zh(G,N.id),j=DT(N.id,N.reputation),L=dP(j.capacity),U=[];for(const pe of IC)try{U.push(...pe.getter())}catch{}const K=SP(U,N)[0];e({type:"NEW_GAME",payload:{teamId:N.id,team:{...N},leagueId:M,group:O,stadiumInfo:j,stadiumLevel:L,preseasonMatches:K?.matches||[],preseasonPhase:!0,gameMode:"contrarreloj",_contrarrelojUserId:n?.uid||null}}),e({type:"SET_LEAGUE_TABLE",payload:D.table}),e({type:"SET_FIXTURES",payload:D.fixtures}),e({type:"SET_PLAYER_LEAGUE",payload:M}),O&&e({type:"SET_PLAYER_GROUP",payload:O});const H=[];for(const pe of IC)try{const Ee=pe.getter();for(const oe of Ee)H.push({...oe,id:oe.id,name:oe.name,players:oe.players||[],budget:oe.budget||(oe.reputation>4?1e8:oe.reputation>3?5e7:2e7),leagueId:pe.id})}catch{}e({type:"UPDATE_LEAGUE_TEAMS",payload:H});const X=kx(M,O);e({type:"SET_OTHER_LEAGUES",payload:X});const ne=fm(M);if(ne)try{const pe={},Ee={};for(const[Ce,ce]of Object.entries(kT)){const te=Wa[Ce];if(!te?.getTeams)continue;const fe=te.getTeams();if(!fe?.length)continue;const Le=[...fe].sort((Fe,Ie)=>(Ie.reputation||70)-(Fe.reputation||70));pe[Ce]=Le.map((Fe,Ie)=>({teamId:Fe.id||Fe.teamId,teamName:Fe.name||Fe.teamName,shortName:Fe.shortName||"",reputation:Fe.reputation||70,overall:Fe.overall||70,leaguePosition:Ie+1})),fe.forEach(Fe=>{Ee[Fe.id||Fe.teamId]=Fe})}const oe=AP(pe,Ee),Ae=new Set;Object.values(oe).forEach(Ce=>Ce.forEach(ce=>Ae.add(ce.teamId)));const be=Object.values(Ee).filter(Ce=>!Ae.has(Ce.id||Ce.teamId)).sort((Ce,ce)=>(ce.reputation||0)-(Ce.reputation||0));for(const Ce of["copaLibertadores","copaSudamericana"]){const ce=32-oe[Ce].length;if(ce>0){const te=be.splice(0,ce);oe[Ce].push(...te.map(fe=>({teamId:fe.id||fe.teamId,teamName:fe.name||fe.teamName,shortName:fe.shortName||"",league:fe.league||"unknown",leaguePosition:0,reputation:fe.reputation||60,overall:fe.overall||65,players:fe.players||[],...fe}))),te.forEach(fe=>Ae.add(fe.id||fe.teamId))}}e({type:"INIT_SA_COMPETITIONS",payload:yP(oe)})}catch(pe){console.error("Error bootstrapping SA comps:",pe)}else try{const pe={},Ee={};for(const[Ce,ce]of Object.entries(hP)){const te=Wa[Ce];if(!te?.getTeams)continue;const fe=te.getTeams();if(!fe?.length)continue;const Le=[...fe].sort((Fe,Ie)=>(Ie.reputation||70)-(Fe.reputation||70));pe[Ce]=Le.map((Fe,Ie)=>({teamId:Fe.id||Fe.teamId,teamName:Fe.name||Fe.teamName,shortName:Fe.shortName||"",reputation:Fe.reputation||70,overall:Fe.overall||70,leaguePosition:Ie+1})),fe.forEach(Fe=>{Ee[Fe.id||Fe.teamId]=Fe})}const oe=fP(pe,Ee),Ae=new Set;Object.values(oe).forEach(Ce=>Ce.forEach(ce=>Ae.add(ce.teamId)));const be=Object.values(Ee).filter(Ce=>!Ae.has(Ce.id||Ce.teamId)).sort((Ce,ce)=>(ce.reputation||0)-(Ce.reputation||0));for(const Ce of["championsLeague","europaLeague","conferenceleague"]){const ce=32-oe[Ce].length;if(ce>0){const te=be.splice(0,ce);oe[Ce].push(...te.map(fe=>({teamId:fe.id||fe.teamId,teamName:fe.name||fe.teamName,shortName:fe.shortName||"",league:fe.league||"unknown",leaguePosition:0,reputation:fe.reputation||60,overall:fe.overall||65,players:fe.players||[],...fe}))),te.forEach(fe=>Ae.add(fe.id||fe.teamId))}}e({type:"INIT_EUROPEAN_COMPETITIONS",payload:mP(oe)})}catch(pe){console.error("Error bootstrapping European comps:",pe)}let Q=null,Y=0;try{const pe=OT(M,N,{},D.table);pe?.teams.length>=2&&(Q=FT(pe.teams,N.id),Q&&(Y=Q.rounds.length))}catch{}Q&&e({type:"INIT_CUP_COMPETITION",payload:Q});try{const pe=D.fixtures.length>0?Math.max(...D.fixtures.map(Ae=>Ae.week)):38,Ee=RF(pe,{hasEuropean:!0,cupRounds:Y}),oe=IF(D.fixtures,Ee.leagueWeekMap);e({type:"SET_FIXTURES",payload:oe}),e({type:"SET_EUROPEAN_CALENDAR",payload:Ee})}catch{}const ue=HF(N,M,D.table);e({type:"SET_SEASON_OBJECTIVES",payload:ue}),e({type:"ADD_MESSAGE",payload:{id:Date.now(),type:"contrarreloj",title:` ${a("contrarreloj.activated")}`,content:a("contrarreloj.objectiveMessage",{competition:a(ne?"contrarreloj.southAmericanCup":"contrarreloj.continentalCup"),team:N.name}),date:`${a("common.week")} 1`}})};return d.jsxs("div",{className:"contrarreloj-setup",children:[d.jsxs("div",{className:"contrarreloj-setup__bg",children:[d.jsx("div",{className:"contrarreloj-setup__gradient"}),d.jsx("div",{className:"contrarreloj-setup__particles",children:[...Array(8)].map((M,N)=>d.jsx("div",{className:`particle particle--${N}`},N))})]}),d.jsxs("div",{className:"contrarreloj-setup__content",children:[d.jsxs("div",{className:"contrarreloj-setup__header",children:[d.jsxs("button",{className:"btn-back",onClick:()=>e({type:"SET_SCREEN",payload:"main_menu"}),children:[d.jsx(s1,{size:20})," ",a("contrarrelojSetup.menu")]}),d.jsxs("div",{className:"header-title",children:[d.jsx(tf,{size:32,className:"timer-icon"}),d.jsxs("div",{children:[d.jsx("h1",{children:a("contrarrelojSetup.title")}),d.jsx("p",{className:"subtitle",children:a("contrarrelojSetup.subtitle")})]})]})]}),d.jsxs("div",{className:"contrarreloj-setup__challenge",children:[d.jsxs("div",{className:"challenge-card",children:[d.jsx(Ai,{size:20,className:"icon gold"}),d.jsxs("div",{children:[d.jsx("strong",{children:a("contrarrelojSetup.objective")}),d.jsx("span",{children:a("contrarrelojSetup.winChampions")})]})]}),d.jsxs("div",{className:"challenge-card",children:[d.jsx(wr,{size:20,className:"icon red"}),d.jsxs("div",{children:[d.jsx("strong",{children:a("contrarrelojSetup.losesIf")}),d.jsx("span",{children:a("contrarrelojSetup.fired")})]})]}),d.jsxs("div",{className:"challenge-card",children:[d.jsx(ru,{size:20,className:"icon amber"}),d.jsxs("div",{children:[d.jsx("strong",{children:a("contrarrelojSetup.ranking")}),d.jsx("span",{children:a("contrarrelojSetup.fewestSeasons")})]})]})]}),d.jsxs("div",{className:"contrarreloj-setup__teams",children:[d.jsxs("div",{className:"teams-header",children:[d.jsx("h2",{children:a("contrarrelojSetup.chooseChallenge")}),d.jsxs("button",{className:"btn-reroll",onClick:x,children:[d.jsx(__,{size:16})," ",a("contrarrelojSetup.newTeams")]})]}),d.jsx("div",{className:"teams-grid",children:A.map((M,N)=>{const I=mZe(M.team),F=s?.id===M.team.id;return d.jsxs("button",{className:`team-card ${F?"selected":""}`,onClick:()=>T(M),children:[d.jsx("div",{className:"team-card__badge",style:{background:M.team.colors?.primary||"#1a3a5a",color:M.team.colors?.secondary||"#fff"},children:M.team.shortName?.slice(0,3)||M.team.name?.slice(0,3)}),d.jsxs("div",{className:"team-card__info",children:[d.jsx("span",{className:"name",children:M.team.name}),d.jsx("span",{className:"league",children:M.leagueName})]}),d.jsxs("div",{className:"team-card__stats",children:[d.jsxs("div",{className:"stat",children:[d.jsx(Hu,{size:12}),d.jsxs("span",{children:[I," ",a("contrarrelojSetup.ovr")]})]}),d.jsxs("div",{className:"stat",children:[d.jsx(mm,{size:12}),d.jsx("span",{children:gZe(M.team.budget)})]}),d.jsxs("div",{className:"stat",children:[d.jsx(Br,{size:12}),d.jsxs("span",{children:[M.team.reputation,""]})]})]}),F&&d.jsx("div",{className:"selected-indicator",children:d.jsx(_r,{size:20})})]},M.team.id||N)})})]}),s&&d.jsx("div",{className:"contrarreloj-setup__confirm-overlay",onClick:()=>r(null),children:d.jsxs("div",{className:"contrarreloj-setup__confirm",onClick:M=>M.stopPropagation(),children:[d.jsx("button",{className:"confirm-close",onClick:()=>r(null),children:""}),d.jsxs("div",{className:"confirm-team",children:[d.jsx("div",{className:"badge-large",style:{background:s.colors?.primary||"#1a3a5a",color:s.colors?.secondary||"#fff"},children:s.shortName||s.name?.slice(0,3)}),d.jsxs("div",{className:"confirm-info",children:[d.jsx("h3",{children:s.name}),d.jsx("p",{children:A.find(M=>M.team.id===s.id)?.leagueName}),d.jsxs("p",{className:"target",children:[a("contrarrelojSetup.goal")," ",fm(o)?a("contrarrelojSetup.libertadores"):a("contrarrelojSetup.championsLeague")]})]})]}),d.jsxs("button",{className:"btn-start",onClick:E,disabled:c,children:[d.jsx(tf,{size:20}),a(c?"contrarrelojSetup.starting":"contrarrelojSetup.acceptChallenge")]})]})})]})]})}const vT="contrarreloj_ranking";async function vZe(a){try{const e=await Nme(du(Kn,vT),{...a,createdAt:Hi()});return console.log(" Ranking entry saved:",e.id),e.id}catch(e){console.error("Error saving ranking entry:",e);try{const n=localStorage.getItem("pcfutbol_contrarreloj_ranking"),i=n?JSON.parse(n):[];i.push({...a,id:Date.now().toString()}),localStorage.setItem("pcfutbol_contrarreloj_ranking",JSON.stringify(i))}catch{}return null}}async function _Ze(a=50){try{const e=hf(du(Kn,vT),ZQ("seasonsPlayed","asc"),R3(a)),i=(await ff(e)).docs.map(s=>({id:s.id,...s.data()}));return i.sort((s,r)=>{const o=(s.seasonsPlayed||0)-(s.difficultyBonus||0),l=(r.seasonsPlayed||0)-(r.difficultyBonus||0);if(o!==l)return o-l;const c=(r.trophies?.length||0)-(s.trophies?.length||0);if(c!==0)return c;const u=(s.totalMatches||0)>0?(s.totalWins||0)/s.totalMatches:0,h=(r.totalMatches||0)>0?(r.totalWins||0)/r.totalMatches:0;return Math.abs(h-u)>.001?h-u:(s.totalMatches||0)-(r.totalMatches||0)}),i}catch(e){console.error("Error loading ranking:",e);try{const n=localStorage.getItem("pcfutbol_contrarreloj_ranking");return n?JSON.parse(n):[]}catch{return[]}}}async function xZe(a){try{const e=du(Kn,vT),n=hf(e,u0("seasonsPlayed","<",a)),s=(await nD(n)).data().count,r=hf(e,u0("seasonsPlayed","==",a)),l=(await nD(r)).data().count,u=(await nD(e)).data().count,h=s+Math.ceil(l/2);return{position:Math.max(1,h),total:u}}catch(e){console.error("Error getting ranking position:",e);try{const n=localStorage.getItem("pcfutbol_contrarreloj_ranking"),s=(n?JSON.parse(n):[]).sort((o,l)=>o.seasonsPlayed-l.seasonsPlayed),r=s.findIndex(o=>o.seasonsPlayed>=a);return{position:r>=0?r+1:s.length+1,total:s.length}}catch{return{position:1,total:1}}}}async function bZe(){try{const e=(await ff(du(Kn,vT))).docs.map(n=>cy(Ra(Kn,vT,n.id)));await Promise.all(e),localStorage.removeItem("pcfutbol_contrarreloj_ranking"),console.log(" Ranking cleared")}catch(a){console.error("Error clearing ranking:",a),localStorage.removeItem("pcfutbol_contrarreloj_ranking")}}function SZe(){const{t:a}=Sa(),{state:e,dispatch:n}=Va(),{user:i}=Mc(),[s,r]=ge.useState(!1),[o,l]=ge.useState(!1),[c,u]=ge.useState(null),h=e.contrarrelojData,f=h?.won||!1,m=h?.loseReason||"unknown",x=(e.leagueTable||[]).find(H=>H.teamId===e.teamId),T=x?.won||0,E=x?.drawn||0,M=x?.lost||0,N=(h?.totalWins||0)+T,I=(h?.totalDraws||0)+E,F=(h?.totalLosses||0)+M,G=N+I+F,O=G>0?Math.round(N/G*100):0,D=(e.team?.players||[]).slice().sort((H,X)=>(X.overall||0)-(H.overall||0))[0],j=h?.wonCompetition==="libertadores"?a("contrarrelojEnd.copaLibertadores"):a("contrarrelojEnd.championsLeague"),L=kAe(h?.startLeague||""),U=(h?.seasonsPlayed||1)-L;ge.useEffect(()=>{if(f&&!s&&h){const H={playerName:e.managerName||"Gaffer",teamName:e.team?.name||h.startTeam?.name||a("common.unknown"),leagueName:h.startLeague||"",seasonsPlayed:h.seasonsPlayed||1,trophies:h.trophies||[],wonCompetition:h.wonCompetition||"champions",totalWins:N,totalDraws:I,totalLosses:F,totalMatches:G,bestPlayer:D?{name:D.name,overall:D.overall,position:D.position}:null,difficultyBonus:L,weightedScore:U,date:new Date().toISOString()};vZe(H).then(()=>{r(!0),xZe(h.seasonsPlayed||1).then(X=>{u(X)})})}},[f,s,h,e.team,i]),ge.useEffect(()=>{setTimeout(()=>l(!0),100)},[]);const q=()=>{n({type:"RESET_GAME"}),n({type:"SET_SCREEN",payload:"main_menu"})},K=()=>{n({type:"RESET_GAME"}),n({type:"SET_SCREEN",payload:"ranking"})};return d.jsxs("div",{className:`contrarreloj-end ${f?"victory":"defeat"} ${o?"animate-in":""}`,children:[d.jsx("div",{className:"contrarreloj-end__overlay"}),d.jsxs("div",{className:"contrarreloj-end__modal",children:[f?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"contrarreloj-end__icon victory-icon",children:[d.jsx(Ai,{size:64}),d.jsx("div",{className:"sparkles",children:[...Array(6)].map((H,X)=>d.jsx(jg,{size:16,className:`sparkle sparkle--${X}`},X))})]}),d.jsx("h1",{className:"victory-title",children:a("contrarrelojEnd.champion")}),d.jsx("h2",{children:e.team?.name}),d.jsxs("p",{className:"contrarreloj-end__subtitle",children:[" ",a("contrarrelojEnd.conquered",{competition:j})]})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"contrarreloj-end__icon defeat-icon",children:m==="bankrupt"?d.jsx(mm,{size:64}):m==="no_players"?d.jsx(vk,{size:64}):d.jsx(vk,{size:64})}),d.jsx("h1",{className:"defeat-title",children:a("contrarrelojEnd.gameOver")}),d.jsx("h2",{children:e.team?.name}),d.jsx("p",{className:"contrarreloj-end__subtitle",children:a(m==="bankrupt"?"contrarrelojEnd.bankrupt":m==="no_players"?"contrarrelojEnd.noPlayers":"contrarrelojEnd.fired")})]}),D&&d.jsxs("div",{className:"contrarreloj-end__best-player",children:[d.jsx(Br,{size:16,className:"star-icon"}),d.jsxs("div",{className:"player-info",children:[d.jsx("span",{className:"player-label",children:a("contrarrelojEnd.bestPlayer")}),d.jsx("span",{className:"player-name",children:D.name}),d.jsxs("span",{className:"player-detail",children:[ds(D.position),"  ",D.overall," OVR  ",D.age," ",a("contrarrelojEnd.years")]})]})]}),d.jsxs("div",{className:"contrarreloj-end__match-stats",children:[d.jsxs("h3",{children:[d.jsx(ef,{size:14})," ",a("contrarrelojEnd.runStats")]}),d.jsxs("div",{className:"stats-grid",children:[d.jsxs("div",{className:"stat-item",children:[d.jsx("span",{className:"stat-value",children:G}),d.jsx("span",{className:"stat-label",children:a("contrarrelojEnd.matches")})]}),d.jsxs("div",{className:"stat-item win",children:[d.jsx("span",{className:"stat-value",children:N}),d.jsx("span",{className:"stat-label",children:a("contrarrelojEnd.victories")})]}),d.jsxs("div",{className:"stat-item draw",children:[d.jsx("span",{className:"stat-value",children:I}),d.jsx("span",{className:"stat-label",children:a("contrarrelojEnd.draws")})]}),d.jsxs("div",{className:"stat-item loss",children:[d.jsx("span",{className:"stat-value",children:F}),d.jsx("span",{className:"stat-label",children:a("contrarrelojEnd.defeats")})]}),d.jsxs("div",{className:"stat-item rate",children:[d.jsxs("span",{className:"stat-value",children:[O,"%"]}),d.jsx("span",{className:"stat-label",children:a("contrarrelojEnd.winRate")})]})]})]}),h?.trophies?.length>0&&d.jsxs("div",{className:"contrarreloj-end__trophies",children:[d.jsxs("h3",{children:[d.jsx(Ai,{size:14})," ",a("contrarrelojEnd.trophies")," (",h.trophies.length,")"]}),d.jsx("div",{className:"trophies-list",children:h.trophies.map((H,X)=>d.jsxs("div",{className:"trophy-item",children:[d.jsx("span",{className:"trophy-icon",children:H.type==="champions"||H.type==="libertadores"?"":H.type==="league"?"":H.type==="cup"?"":""}),d.jsx("span",{className:"trophy-name",children:H.name}),d.jsxs("span",{className:"trophy-season",children:["T",H.season]})]},X))})]}),d.jsxs("div",{className:"contrarreloj-end__time",children:[d.jsx(tf,{size:28,className:"time-icon"}),d.jsxs("div",{className:"time-content",children:[d.jsx("span",{className:"time-label",children:a(f?"contrarrelojEnd.achievedIn":"contrarrelojEnd.lasted")}),d.jsx("span",{className:"time-value",children:h?.seasonsPlayed||1}),d.jsx("span",{className:"time-unit",children:a("contrarrelojEnd.seasons",{count:h?.seasonsPlayed||1})})]})]}),f&&L>0&&d.jsxs("div",{className:"contrarreloj-end__weighted",children:[d.jsxs("span",{className:"weighted-formula",children:[h?.seasonsPlayed," temp.  ",L," ascenso",L!==1?"s":""," de ventaja"]}),d.jsxs("span",{className:"weighted-score",children:["Score: ",d.jsx("strong",{children:U})]})]}),f&&c&&c.total>0&&d.jsxs("div",{className:"contrarreloj-end__ranking-pos",children:[d.jsx(xN,{size:20,className:"medal-icon"}),c.total>=1e4?d.jsxs("span",{className:"ranking-text",children:["Posicin global: ",d.jsxs("strong",{children:["#",c.position]})," de ",c.total.toLocaleString()]}):d.jsxs("span",{className:"ranking-text",children:[(()=>{const H=Math.max(1,Math.round(c.position/c.total*100));return H<=1?"Ests en el TOP 1%! ":H<=5?`Ests en el TOP ${H}%! `:H<=20?`Ests entre el ${H}% mejor! `:H<=50?`Ests en el top ${H}%  Puedes mejorar!`:`Top ${H}%  Intentas otra run?`})(),d.jsxs("span",{className:"ranking-detail",children:[" (",c.position," de ",c.total,")"]})]})]}),d.jsxs("div",{className:"contrarreloj-end__actions",children:[d.jsxs("button",{className:"btn-ranking",onClick:K,children:[d.jsx(sSe,{size:18}),d.jsx("span",{children:a("contrarrelojEnd.seeRanking")})]}),d.jsxs("button",{className:"btn-menu",onClick:q,children:[d.jsx(qh,{size:18}),d.jsx("span",{children:a("sidebar.mainMenu")})]})]})]})]})}function TZe(){const{dispatch:a}=Va(),{t:e}=Sa(),[n,i]=ge.useState([]),[s,r]=ge.useState(!0);ge.useEffect(()=>{o()},[]);const o=async()=>{r(!0);const h=await _Ze(50);i(h),r(!1)},l=async()=>{window.confirm(e("ranking.confirmClear"))&&(await bZe(),i([]))},c=h=>h===1?"#FFD700":h===2?"#C0C0C0":h===3?"#CD7F32":"#556677",u=h=>{if(!h)return"-";try{return new Date(h).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"})}catch{return h}};return d.jsxs("div",{className:"ranking",children:[d.jsx("div",{className:"ranking__bg",children:d.jsx("div",{className:"ranking__gradient"})}),d.jsxs("div",{className:"ranking__content",children:[d.jsxs("div",{className:"ranking__header",children:[d.jsxs("button",{className:"btn-back",onClick:()=>a({type:"SET_SCREEN",payload:"main_menu"}),children:[d.jsx(s1,{size:20})," ",e("common.back")]}),d.jsxs("div",{className:"header-title",children:[d.jsx(Ai,{size:28,className:"trophy-icon"}),d.jsxs("div",{children:[d.jsx("h1",{children:e("ranking.records")}),d.jsx("p",{children:e("ranking.subtitle")})]})]}),n.length>0&&d.jsxs("button",{className:"btn-clear",onClick:l,children:[d.jsx(UT,{size:14})," ",e("ranking.clear")]})]}),s?d.jsxs("div",{className:"ranking__empty",children:[d.jsx(XSe,{size:48,className:"empty-icon spinning"}),d.jsx("h2",{children:e("ranking.loading")})]}):n.length===0?d.jsxs("div",{className:"ranking__empty",children:[d.jsx(tf,{size:48,className:"empty-icon"}),d.jsx("h2",{children:e("ranking.noRecords")}),d.jsx("p",{children:e("ranking.noRecordsDesc")}),d.jsxs("button",{className:"btn-play",onClick:()=>a({type:"SET_SCREEN",payload:"contrarreloj_setup"}),children:[d.jsx(tf,{size:18})," ",e("ranking.playContrarreloj")]})]}):d.jsx("div",{className:"ranking__table-wrapper",children:d.jsxs("table",{className:"ranking__table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{className:"col-pos",children:"#"}),d.jsx("th",{className:"col-player",children:e("ranking.player")}),d.jsx("th",{className:"col-team",children:e("ranking.team")}),d.jsx("th",{className:"col-score",children:e("ranking.score")}),d.jsxs("th",{className:"col-seasons",children:[d.jsx(tf,{size:14})," ",e("ranking.seasons")]}),d.jsxs("th",{className:"col-trophies",children:[d.jsx(Ai,{size:14})," ",e("ranking.trophies")]}),d.jsx("th",{className:"col-comp",children:e("ranking.competition")}),d.jsxs("th",{className:"col-date",children:[d.jsx(pm,{size:14})," ",e("ranking.date")]})]})}),d.jsx("tbody",{children:n.map((h,f)=>d.jsxs("tr",{className:f<3?`top-${f+1}`:"",children:[d.jsxs("td",{className:"col-pos",children:[d.jsx(xN,{size:16,style:{color:c(f+1)}}),d.jsx("span",{children:f+1})]}),d.jsx("td",{className:"col-player",children:h.playerName||e("seasonEnd.anonymous")}),d.jsxs("td",{className:"col-team",children:[d.jsx("span",{className:"team-name",children:h.teamName}),d.jsx("span",{className:"league-name",children:h.leagueName||""})]}),d.jsxs("td",{className:"col-score",children:[d.jsx("span",{className:"score-value",children:(h.seasonsPlayed||0)-(h.difficultyBonus||0)}),(h.difficultyBonus||0)>0&&d.jsxs("span",{className:"score-bonus",children:["-",h.difficultyBonus]})]}),d.jsx("td",{className:"col-seasons",children:d.jsx("span",{className:"seasons-value",children:h.seasonsPlayed})}),d.jsxs("td",{className:"col-trophies",children:[d.jsx("span",{className:"trophies-value",children:h.trophies?.length||0}),h.trophies?.length>0&&d.jsx("span",{className:"trophies-detail",children:h.trophies.map((m,A)=>d.jsx("span",{className:"trophy-tag",title:`${m.name} (T${m.season})`,children:m.type==="champions"||m.type==="libertadores"?"":m.type==="league"?"":m.type==="cup"?"":""},A))})]}),d.jsx("td",{className:"col-comp",children:d.jsx("span",{className:`comp-badge ${h.wonCompetition==="champions"?"champions":"libertadores"}`,children:h.wonCompetition==="champions"?" Champions":h.wonCompetition==="libertadores"?" Libertadores":""})}),d.jsx("td",{className:"col-date",children:u(h.date)})]},h.id||f))})]})})]})]})}function wZe(){const{user:a}=Mc(),{dispatch:e}=Va(),[n,i]=ge.useState(null),[s,r]=ge.useState(!1),[o,l]=ge.useState(null),[c,u]=ge.useState([]),[h,f]=ge.useState(0),[m,A]=ge.useState(!0);ge.useEffect(()=>{if(!a?.uid)return;let N;return(async()=>(await Rle(a.uid,a.displayName||a.email?.split("@")[0]),N=Ple(a.uid,I=>{i(I),A(!1)})))(),()=>N?.()},[a?.uid]),ge.useEffect(()=>{a?.uid&&qle(a.uid,10).then(u).catch(()=>{})},[a?.uid]),ge.useEffect(()=>{if(!s){f(0);return}const N=setInterval(()=>f(I=>I+1),1e3);return()=>clearInterval(N)},[s]),ge.useEffect(()=>{if(!s||!a?.uid)return;let N=!1,I;I=Dle(a.uid,async G=>{if(!G&&s&&!o&&!N)try{const{findMyActiveMatch:O}=await Yh(async()=>{const{findMyActiveMatch:j}=await Promise.resolve().then(()=>dZe);return{findMyActiveMatch:j}},void 0),D=await O(a.uid);D&&!N&&(l(D.id),r(!1))}catch(O){console.error("Error checking active match:",O)}});const F=setInterval(async()=>{if(!N)try{const G=await kle(a.uid,n?.totalLP||0);if(G&&!N){const O=await Ole({uid:a.uid,displayName:n?.displayName,totalLP:n?.totalLP||0},G);l(O.id),r(!1)}}catch(G){console.error("Matchmaking error:",G)}},3e3);return()=>{N=!0,clearInterval(F),I?.()}},[s,a?.uid,n?.totalLP,o]),ge.useEffect(()=>{o&&(e({type:"SET_SCREEN",payload:"ranked_match"}),e({type:"SET_RANKED_MATCH_ID",payload:o}))},[o,e]);const x=async()=>{if(!(!a?.uid||!n)){r(!0);try{await Ile(a.uid,n.displayName,n.totalLP||0)}catch(N){console.error("Error joining queue:",N),r(!1)}}},T=async()=>{if(r(!1),a?.uid)try{await Lle(a.uid)}catch{}},E=n?xx(n.totalLP||0):null,M=n?c8(n.totalLP||0):0;return a?.uid?m?d.jsx("div",{className:"ranked-lobby",children:d.jsxs("div",{className:"ranked-lobby__loading",children:[d.jsx(ef,{size:32,className:"spin"}),d.jsx("p",{children:"Cargando perfil..."})]})}):d.jsxs("div",{className:"ranked-lobby",children:[d.jsxs("div",{className:"ranked-lobby__header",children:[d.jsx("button",{className:"ranked-lobby__back",onClick:()=>e({type:"SET_SCREEN",payload:"menu"}),children:d.jsx(s1,{size:20})}),d.jsxs("h1",{children:[d.jsx(ef,{size:24})," Ranked 1v1"]})]}),d.jsxs("div",{className:"ranked-lobby__rank-card",style:{"--tier-color":E?.color},children:[d.jsx("div",{className:"rank-icon",children:E?.icon}),d.jsxs("div",{className:"rank-info",children:[d.jsx("span",{className:"rank-name",children:E?.name}),d.jsxs("div",{className:"rank-lp",children:[d.jsx("div",{className:"lp-bar",children:d.jsx("div",{className:"lp-fill",style:{width:`${M}%`}})}),d.jsxs("span",{className:"lp-text",children:[M," LP"]})]})]}),d.jsxs("div",{className:"rank-stats",children:[d.jsxs("span",{className:"wins",children:[n?.wins||0,"V"]}),d.jsx("span",{className:"sep",children:"/"}),d.jsxs("span",{className:"losses",children:[n?.losses||0,"D"]})]})]}),d.jsx("div",{className:"ranked-lobby__matchmaking",children:s?d.jsxs("div",{className:"ranked-lobby__searching",children:[d.jsx("div",{className:"searching-animation",children:d.jsx(ef,{size:28,className:"pulse"})}),d.jsxs("p",{children:["Buscando rival... ",d.jsxs("span",{className:"time",children:[Math.floor(h/60),":",(h%60).toString().padStart(2,"0")]})]}),d.jsx("button",{className:"cancel-btn",onClick:T,children:"Cancelar"})]}):d.jsxs("button",{className:"ranked-lobby__find-btn",onClick:x,children:[d.jsx(T0,{size:22}),d.jsx("span",{children:"Buscar Partida"})]})}),d.jsxs("button",{className:"ranked-lobby__leaderboard-btn",onClick:()=>e({type:"SET_SCREEN",payload:"ranked_leaderboard"}),children:[d.jsx(Ai,{size:18}),d.jsx("span",{children:"Clasificacin Global"}),d.jsx(_r,{size:16})]}),d.jsxs("div",{className:"ranked-lobby__history",children:[d.jsxs("h3",{children:[d.jsx(or,{size:16})," Historial Reciente"]}),c.length===0?d.jsx("p",{className:"empty",children:"An no has jugado partidas ranked."}):d.jsx("div",{className:"history-list",children:c.map(N=>{const I=N.player1?.uid===a.uid,F=N.winner===a.uid,G=!N.winner,O=I?N.player2:N.player1,D=I?N.results?.player1Points:N.results?.player2Points,j=I?N.results?.player2Points:N.results?.player1Points;return d.jsxs("div",{className:`history-item ${F?"win":G?"draw":"loss"}`,children:[d.jsx("span",{className:"result",children:F?"V":G?"E":"D"}),d.jsx("span",{className:"rival",children:O?.displayName}),d.jsxs("span",{className:"score",children:[D??"?"," - ",j??"?"]}),N.results?.disconnection&&d.jsx(ewe,{size:12,className:"dc-icon"})]},N.id)})})]})]}):(e({type:"SET_SCREEN",payload:"menu"}),null)}function EZe({match:a,onBackToLobby:e}){const{t:n}=Sa(),{user:i}=Mc(),[s,r]=ge.useState("idle"),[o,l]=ge.useState(!1),[c,u]=ge.useState([]),h=a?.player1?.uid===i?.uid,f=h?a?.player1:a?.player2,m=h?a?.player2:a?.player1,A=h?"player1":"player2",x=h?"player2":"player1",T=a?.results?.disconnection,E=a?.winner===i?.uid,M=!a?.winner&&!T,N=ge.useMemo(()=>{const j=f?.totalLP||0,L=m?.totalLP||0;let U=0;if(T)U=E?20:-15;else if(M)U=5;else if(E)U=u8(j,L,!1);else{const Ee=u8(L,j,!1);U=-Math.ceil(Ee*.7)}const q=j,K=Math.max(0,j+U),H=xx(q),X=xx(K),ne=c8(q),Q=c8(K),Y=H.id!==X.id,ue=Y&&X.division>H.division,pe=Y&&X.division<H.division;return{lpChange:U,oldTotalLP:q,newTotalLP:K,oldTier:H,newTier:X,oldLPInDiv:ne,newLPInDiv:Q,tierChanged:Y,isPromotion:ue,isDemotion:pe}},[f,m,E,M,T]),I=a?.results?.simulation?.[A],F=a?.results?.simulation?.[x],G=h?a?.results?.player1Points:a?.results?.player2Points,O=h?a?.results?.player2Points:a?.results?.player1Points;ge.useEffect(()=>{const j=setTimeout(()=>r("filling"),800),L=setTimeout(()=>{if(r("done"),N.tierChanged&&(l(!0),N.isPromotion)){const U=Array.from({length:24},(q,K)=>({id:K,x:Math.random()*100,delay:Math.random()*.6,duration:1.5+Math.random()*1.5,color:["#ffd700","#10b981","#3b82f6","#f59e0b","#ec4899"][K%5],size:4+Math.random()*6}));u(U)}},3e3);return()=>{clearTimeout(j),clearTimeout(L)}},[N.tierChanged,N.isPromotion]);const D=E?"win":M?"draw":"loss";return d.jsx("div",{className:"ranked-results-overlay",children:d.jsxs("div",{className:"ranked-results-card",children:[c.length>0&&d.jsx("div",{className:"confetti-container",children:c.map(j=>d.jsx("div",{className:"confetti-particle",style:{left:`${j.x}%`,animationDelay:`${j.delay}s`,animationDuration:`${j.duration}s`,backgroundColor:j.color,width:`${j.size}px`,height:`${j.size}px`}},j.id))}),d.jsxs("div",{className:`result-header result-header--${D}`,children:[d.jsx("span",{className:"result-emoji",children:T?E?"":"":E?"":M?"":""}),d.jsx("h1",{className:"result-title",children:n(T?E?"rankedResults.disconnectWin":"rankedResults.disconnectLoss":E?"rankedResults.victory":M?"rankedResults.draw":"rankedResults.defeat")})]}),!T&&d.jsxs("div",{className:"score-summary",children:[d.jsxs("div",{className:`score-team ${h?"me":"rival"}`,children:[d.jsx("span",{className:"score-team-name",children:I?.teamName||n("rankedResults.myTeam")}),d.jsxs("span",{className:"score-pts",children:[G??"?"," pts"]})]}),d.jsx("span",{className:"score-vs",children:"VS"}),d.jsxs("div",{className:`score-team ${h?"rival":"me"}`,children:[d.jsx("span",{className:"score-team-name",children:F?.teamName||n("rankedResults.rivalTeam")}),d.jsxs("span",{className:"score-pts",children:[O??"?"," pts"]})]})]}),d.jsxs("div",{className:"lp-section",children:[d.jsxs("div",{className:`tier-badge ${o?N.isPromotion?"promotion":"demotion":""}`,children:[d.jsx("span",{className:"tier-icon",children:o?N.newTier.icon:N.oldTier.icon}),d.jsx("span",{className:"tier-name",style:{color:o?N.newTier.color:N.oldTier.color},children:o?N.newTier.name:N.oldTier.name})]}),N.tierChanged&&o&&d.jsxs("div",{className:`tier-change ${N.isPromotion?"promo":"demo"}`,children:[d.jsxs("span",{children:[N.oldTier.icon," ",N.oldTier.name]}),d.jsx("span",{className:"arrow",children:""}),d.jsxs("span",{children:[N.newTier.icon," ",N.newTier.name]})]}),d.jsxs("div",{className:"lp-bar-container",children:[d.jsx("div",{className:"lp-bar-bg",children:d.jsx("div",{className:`lp-bar-fill lp-bar-fill--${D}`,style:{width:s==="idle"?`${N.oldLPInDiv}%`:`${N.tierChanged?N.isPromotion?100:0:N.newLPInDiv}%`,transition:s==="idle"?"none":"width 2s cubic-bezier(0.4, 0, 0.2, 1)"}})}),d.jsxs("div",{className:"lp-bar-labels",children:[d.jsx("span",{children:"0 LP"}),d.jsxs("span",{children:[J7," LP"]})]})]}),d.jsxs("div",{className:`lp-change lp-change--${D}`,children:[N.lpChange>0?d.jsx(dl,{size:18}):N.lpChange<0?d.jsx(VT,{size:18}):d.jsx(fTe,{size:18}),d.jsxs("span",{className:"lp-change-value",children:[N.lpChange>0?"+":"",N.lpChange," LP"]})]})]}),!T&&I&&d.jsxs("div",{className:"stats-breakdown",children:[d.jsx("h3",{children:n("rankedResults.breakdown")}),d.jsxs("div",{className:"stats-columns",children:[d.jsxs("div",{className:"stats-col",children:[d.jsx("h4",{children:n("rankedResults.you")}),d.jsx(nX,{sim:I,t:n})]}),d.jsxs("div",{className:"stats-col",children:[d.jsx("h4",{children:n("rankedResults.rival")}),d.jsx(nX,{sim:F,t:n})]})]})]}),!T&&I?.h2hResults?.length>0&&d.jsxs("div",{className:"h2h-section",children:[d.jsxs("h3",{children:[" ",n("rankedResults.h2h")]}),I.h2hResults.map((j,L)=>d.jsxs("div",{className:"h2h-row",children:[d.jsx("span",{children:j.home?"":""}),d.jsxs("span",{className:"h2h-score",children:[j.goalsFor," - ",j.goalsAgainst]}),d.jsx("span",{className:`h2h-result ${j.goalsFor>j.goalsAgainst?"win":j.goalsFor<j.goalsAgainst?"loss":"draw"}`,children:j.goalsFor>j.goalsAgainst?"V":j.goalsFor<j.goalsAgainst?"D":"E"})]},L))]}),d.jsxs("button",{className:"lobby-btn",onClick:e,children:[d.jsx(s1,{size:18}),d.jsx("span",{children:n("rankedResults.backToLobby")})]})]})})}function nX({sim:a,t:e}){if(!a)return null;const n=[];a.liga&&n.push({label:` ${e("rankedResults.leagueChampion")}`,pts:6}),a.championsLeague&&n.push({label:" Champions League",pts:10}),a.europaLeague&&n.push({label:" Europa League",pts:5}),a.libertadores&&n.push({label:" Libertadores",pts:5}),a.conference&&n.push({label:" Conference League",pts:3}),a.sudamericana&&n.push({label:" Sudamericana",pts:3}),a.copa&&n.push({label:` ${e("rankedResults.cup")}`,pts:3}),a.supercopa&&n.push({label:` ${e("rankedResults.superCup")}`,pts:1}),a.finishedAboveRival&&n.push({label:` ${e("rankedResults.aboveRival")}`,pts:2}),a.h2hWins>0&&n.push({label:` ${e("rankedResults.h2hWins",{count:a.h2hWins})}`,pts:a.h2hWins}),n.push({label:` ${e("rankedResults.leaguePos",{pos:a.leaguePosition,pts:a.leaguePoints})}`,pts:null}),a.europeanCompetition&&n.push({label:` ${a.europeanCompetition}: ${a.europeanRound||"-"}`,pts:null}),a.cupRound&&n.push({label:` ${e("rankedResults.cupRound",{round:a.cupRound})}`,pts:null});const i=n.reduce((s,r)=>s+(r.pts||0),0);return d.jsxs("div",{className:"bd-list",children:[n.map((s,r)=>d.jsxs("div",{className:"bd-item",children:[d.jsx("span",{className:"bd-label",children:s.label}),s.pts!==null&&d.jsxs("span",{className:"bd-pts",children:["+",s.pts]})]},r)),d.jsxs("div",{className:"bd-total",children:[d.jsx("span",{children:"TOTAL"}),d.jsx("span",{className:"bd-pts",children:i})]})]})}const MZe=["4-3-3","4-4-2","3-5-2","4-2-3-1","5-3-2","3-4-3","4-5-1","4-1-4-1"],CZe=[{id:"attacking",name:"Ofensiva",icon:""},{id:"balanced",name:"Equilibrada",icon:""},{id:"defensive",name:"Defensiva",icon:""},{id:"counter",name:"Contraataque",icon:""},{id:"possession",name:"Posesin",icon:""},{id:"pressing",name:"Presin alta",icon:""}];function NZe(){const{user:a}=Mc(),{state:e,dispatch:n}=Va(),[i,s]=ge.useState(null),[r,o]=ge.useState(0),[l,c]=ge.useState(null),[u,h]=ge.useState(!0),[f,m]=ge.useState("4-3-3"),[A,x]=ge.useState("balanced"),[T,E]=ge.useState(!1),[M,N]=ge.useState(!1),[I,F]=ge.useState(""),[G,O]=ge.useState(null),[D,j]=ge.useState(!1),[L,U]=ge.useState([]),q=e.rankedMatchId;ge.useEffect(()=>{a?.uid||n({type:"SET_SCREEN",payload:"menu"})},[a?.uid]),ge.useEffect(()=>{if(!q)return;const te=Z7(q,fe=>{if(s(fe),h(!1),fe?.leagueId){const Le=h8(fe.leagueId);U(Le)}});return()=>te()},[q]),ge.useEffect(()=>{(i?.phase==="round1"||i?.phase==="round2")&&(E(!1),N(!1),O(null))},[i?.phase]),ge.useEffect(()=>{if(!(!i||!a?.uid)&&(i.phase==="round1"||i.phase==="round2")){const te=i.player1?.uid===a.uid?i.player1.team:i.player2.team;if(!te)return;const fe=h8(i.leagueId),Le=fe.find(at=>at.id===te);if(!Le)return;const Fe=fe.map((at,je)=>({teamId:at.id,teamName:at.name,played:0,won:0,drawn:0,lost:0,goalsFor:0,goalsAgainst:0,goalDifference:0,points:0})),Ie=i.phase==="round2"&&i.simulation1?.table?i.simulation1.table:Fe;n({type:"LOAD_RANKED_TEAM",payload:{team:JSON.parse(JSON.stringify(Le)),leagueId:i.leagueId,leagueTable:Ie,money:Le.transferBudget||Le.budget||5e6,gameMode:"ranked"}}),n({type:"SET_SCREEN",payload:"office"})}},[i?.phase,a?.uid]),ge.useEffect(()=>{if(!i?.phaseDeadline)return;const te=()=>{const Le=i.phaseDeadline.toDate?i.phaseDeadline.toDate():new Date(i.phaseDeadline),Fe=Math.max(0,Math.floor((Le.getTime()-Date.now())/1e3));o(Fe),Fe===0&&K()&&["team_selection","round1","round2"].includes(i.phase)&&I_(q).catch(console.error)};te();const fe=setInterval(te,1e3);return()=>clearInterval(fe)},[i?.phaseDeadline,i?.phase]),ge.useEffect(()=>{i&&["simulating1","simulating2","results","team_selection"].includes(i.phase)&&e.currentScreen==="office"&&e.gameMode==="ranked"&&n({type:"SET_SCREEN",payload:"ranked_match"})},[i?.phase]),ge.useEffect(()=>{if(!(!i||!q)&&(i.phase==="simulating1"||i.phase==="simulating2")&&K()){const te=setTimeout(()=>{I_(q).catch(console.error)},8e3);return()=>clearTimeout(te)}},[i?.phase,q]),ge.useEffect(()=>{if(!q||!a?.uid||!i||i.phase==="results")return;const te=setInterval(()=>{Ule(q,a.uid).catch(()=>{})},1e4);return()=>clearInterval(te)},[q,a?.uid,i?.phase]),ge.useEffect(()=>{if(!q||!a?.uid||!i||i.phase==="results")return;const te=setInterval(async()=>{await Vle(q,a.uid)&&await zle(q,a.uid)},15e3);return()=>clearInterval(te)},[q,a?.uid,i?.phase]);const K=ge.useCallback(()=>i?.player1?.uid===a?.uid,[i,a]),H=()=>K()?i?.player1:i?.player2,X=()=>K()?i?.player2:i?.player1,ne=()=>K()?"player1":"player2",Q=async te=>{if(!(!q||!a?.uid)){c(te);try{await Fle(q,a.uid,te)}catch(fe){c(null),alert(fe.message)}}},Y=async()=>{if(!(!q||!a?.uid))try{const te={formation:f,tactic:A,morale:75};await d8(q,a.uid,te),E(!0),K()&&setTimeout(()=>I_(q).catch(console.error),2e3)}catch(te){console.error("Error submitting config:",te),alert("Error al enviar configuracin. Intntalo de nuevo.")}},ue=async(te,fe)=>{if(!(!q||!a?.uid)){j(!0);try{const Le=await jle(q,a.uid,te,fe);O(Le),setTimeout(()=>O(null),3e3)}catch(Le){O({success:!1,reason:Le.message})}j(!1)}},pe=()=>{n({type:"SET_RANKED_MATCH_ID",payload:null}),n({type:"SET_SCREEN",payload:"ranked_lobby"})},Ee=te=>`${Math.floor(te/60)}:${(te%60).toString().padStart(2,"0")}`,oe=ge.useMemo(()=>{if(!L.length||!i)return[];const te=H()?.team,fe=X()?.team,Le=i.blockedTransfers?.[ne()]||[];return L.filter(Fe=>Fe.id!==te).flatMap(Fe=>(Fe.players||[]).map(Ie=>({...Ie,teamName:Fe.name,teamId:Fe.id,isBlocked:Le.includes(Ie.name||Ie.id),isRivalTeam:Fe.id===fe}))).filter(Fe=>{if(!I)return!1;const Ie=I.toLowerCase();return(Fe.name||"").toLowerCase().includes(Ie)||(Fe.teamName||"").toLowerCase().includes(Ie)||(Fe.position||"").toLowerCase().includes(Ie)}).slice(0,30)},[L,i,I]);if(u||!i)return d.jsx("div",{className:"ranked-match",children:d.jsxs("div",{className:"ranked-match__loading",children:[d.jsx(ef,{size:32,className:"spin"}),d.jsx("p",{children:"Conectando a la partida..."})]})});const Ae=H(),be=X(),Ce=i.teams?.find(te=>te.id===Ae?.team),ce=i.teams?.find(te=>te.id===be?.team);return d.jsxs("div",{className:"ranked-match",children:[d.jsxs("div",{className:"ranked-match__header",children:[d.jsxs("div",{className:"player-badge me",children:[d.jsx("span",{className:"name",children:Ae?.displayName}),d.jsx("span",{className:"tier",children:xx(Ae?.totalLP||0)?.icon})]}),d.jsxs("div",{className:"vs",children:[d.jsx(ef,{size:20}),d.jsx("span",{className:"phase-label",children:RZe(i.phase)})]}),d.jsxs("div",{className:"player-badge rival",children:[d.jsx("span",{className:"tier",children:xx(be?.totalLP||0)?.icon}),d.jsx("span",{className:"name",children:be?.displayName})]})]}),!["results","simulating1","simulating2"].includes(i.phase)&&d.jsxs("div",{className:`ranked-match__timer ${r<=30?"urgent":""}`,children:[d.jsx(or,{size:16}),d.jsx("span",{children:Ee(r)})]}),d.jsxs("div",{className:"ranked-match__content",children:[i.phase==="team_selection"&&d.jsxs("div",{className:"phase-team-selection",children:[d.jsxs("h2",{children:[" ",i.leagueName]}),d.jsxs("p",{className:"subtitle",children:[i.leagueCountry,"  ",i.matchdays," jornadas"]}),d.jsxs("p",{className:"hint",children:["Elige tu equipo (",i.teams?.length," opciones)"]}),d.jsx("div",{className:"team-grid",children:i.teams?.map(te=>{const fe=be?.team===te.id,Le=Ae?.team===te.id||l===te.id;return d.jsxs("button",{className:`team-card ${Le?"selected":""} ${fe?"taken":""}`,onClick:()=>!fe&&!Ae?.team&&Q(te.id),disabled:fe||!!Ae?.team,children:[d.jsx(x_,{size:28}),d.jsx("span",{className:"team-name",children:te.name}),d.jsxs("div",{className:"team-details",children:[d.jsxs("span",{className:"team-stat",children:[" ",te.avgOverall]}),d.jsxs("span",{className:"team-stat",children:[" ",te.playerCount]}),d.jsxs("span",{className:"team-stat",children:[" ",(te.budget/1e6).toFixed(1),"M"]})]}),fe&&d.jsx("span",{className:"taken-label",children:" Elegido por rival"}),Le&&d.jsx(uo,{size:18,className:"check-icon"})]},te.id)})}),Ae?.team&&!be?.team&&d.jsx("p",{className:"waiting",children:" Esperando a que el rival elija..."})]}),(i.phase==="round1"||i.phase==="round2")&&d.jsxs("div",{className:"phase-round",children:[d.jsx("h2",{children:i.phase==="round1"?" Primera Vuelta":" Segunda Vuelta"}),d.jsxs("div",{className:"round-teams",children:[d.jsxs("div",{className:"my-team-card",children:[d.jsx(x_,{size:18}),d.jsx("span",{children:Ce?.name||"Mi equipo"})]}),d.jsx("span",{className:"vs-label",children:"vs"}),d.jsxs("div",{className:"rival-team-card",children:[d.jsx(x_,{size:18}),d.jsx("span",{children:ce?.name||"Rival"})]})]}),i.phase==="round2"&&i.simulation1&&d.jsxs("div",{className:"midseason-box",children:[d.jsx("h3",{children:" Clasificacin a media temporada"}),d.jsx("div",{className:"mini-table",children:i.simulation1.table?.slice(0,6).map((te,fe)=>d.jsxs("div",{className:`table-row ${te.teamId===Ae?.team?"me":te.teamId===be?.team?"rival":""}`,children:[d.jsx("span",{className:"pos",children:fe+1}),d.jsx("span",{className:"name",children:te.teamName}),d.jsxs("span",{className:"pts",children:[te.points,"pts"]}),d.jsxs("span",{className:"record",children:[te.won,"V ",te.drawn,"E ",te.lost,"D"]})]},te.teamId))})]}),T?d.jsxs("div",{className:"config-submitted",children:[d.jsx(uo,{size:24}),d.jsx("p",{children:"Configuracin enviada. Esperando al rival..."})]}):d.jsxs("div",{className:"config-section",children:[d.jsx("h3",{children:" Configuracin"}),d.jsxs("div",{className:"config-row",children:[d.jsx("label",{children:"Formacin"}),d.jsx("div",{className:"formation-grid",children:MZe.map(te=>d.jsx("button",{className:`formation-btn ${f===te?"active":""}`,onClick:()=>m(te),children:te},te))})]}),d.jsxs("div",{className:"config-row",children:[d.jsx("label",{children:"Tctica"}),d.jsx("div",{className:"tactic-grid",children:CZe.map(te=>d.jsxs("button",{className:`tactic-btn ${A===te.id?"active":""}`,onClick:()=>x(te.id),children:[d.jsx("span",{className:"tactic-icon",children:te.icon}),d.jsx("span",{className:"tactic-name",children:te.name})]},te.id))})]}),d.jsxs("button",{className:"transfer-toggle",onClick:()=>N(!M),children:[d.jsx(Hu,{size:18}),d.jsx("span",{children:"Fichajes"}),d.jsx(S0,{size:16,className:M?"rotated":""})]}),M&&d.jsxs("div",{className:"transfer-panel",children:[d.jsxs("div",{className:"transfer-search",children:[d.jsx(T0,{size:16}),d.jsx("input",{type:"text",placeholder:"Buscar jugador o equipo...",value:I,onChange:te=>F(te.target.value)})]}),G&&d.jsxs("div",{className:`transfer-result ${G.success?"success":"fail"}`,children:[G.success?d.jsx(uo,{size:16}):d.jsx(zr,{size:16}),d.jsx("span",{children:G.reason}),G.value&&d.jsxs("span",{className:"value",children:[(G.value/1e6).toFixed(1),"M"]})]}),d.jsxs("div",{className:"transfer-list",children:[oe.map((te,fe)=>d.jsxs("div",{className:`transfer-player ${te.isBlocked?"blocked":""}`,children:[d.jsxs("div",{className:"player-info",children:[d.jsx("span",{className:"player-name",children:te.name}),d.jsxs("span",{className:"player-meta",children:[te.position,"  ",te.overall||"?","  ",te.age,"a  ",te.teamName]})]}),te.isBlocked?d.jsxs("span",{className:"blocked-badge",children:[d.jsx(vy,{size:14})," Bloqueado"]}):d.jsx("button",{className:"sign-btn",onClick:()=>ue(te.name,te.teamId),disabled:D,children:"Fichar"})]},`${te.name}-${fe}`)),I&&oe.length===0&&d.jsx("p",{className:"no-results",children:"No se encontraron jugadores"}),!I&&d.jsx("p",{className:"no-results",children:"Escribe para buscar jugadores"})]})]}),d.jsxs("button",{className:"ready-btn",onClick:Y,children:[d.jsx(ru,{size:18}),d.jsx("span",{children:"Confirmar y simular"})]})]})]}),(i.phase==="simulating1"||i.phase==="simulating2")&&d.jsxs("div",{className:"phase-simulating",children:[d.jsx("div",{className:"sim-animation",children:d.jsx("div",{className:"sim-ball",children:""})}),d.jsx("h2",{children:i.phase==="simulating1"?"Simulando primera vuelta...":"Simulando temporada completa..."}),i.phase==="simulating1"&&i.simulation1?.table&&d.jsxs("div",{className:"sim-standings",children:[d.jsx("h3",{children:"Clasificacin provisional"}),d.jsx("div",{className:"mini-table",children:i.simulation1.table.slice(0,8).map((te,fe)=>d.jsxs("div",{className:`table-row ${te.teamId===Ae?.team?"me":te.teamId===be?.team?"rival":""}`,children:[d.jsx("span",{className:"pos",children:fe+1}),d.jsx("span",{className:"name",children:te.teamName}),d.jsx("span",{className:"pts",children:te.points})]},te.teamId))})]}),i.phase==="simulating2"&&i.simulation2?.table&&d.jsxs("div",{className:"sim-standings",children:[d.jsx("h3",{children:"Clasificacin final"}),d.jsx("div",{className:"mini-table",children:i.simulation2.table.slice(0,10).map((te,fe)=>d.jsxs("div",{className:`table-row ${te.teamId===Ae?.team?"me":te.teamId===be?.team?"rival":""}`,children:[d.jsx("span",{className:"pos",children:fe+1}),d.jsx("span",{className:"name",children:te.teamName}),d.jsx("span",{className:"pts",children:te.points}),d.jsxs("span",{className:"gd",children:[te.goalDifference>0?"+":"",te.goalDifference]})]},te.teamId))})]}),d.jsx("p",{className:"sim-wait",children:"Los partidos se estn disputando..."})]}),i.phase==="results"&&d.jsx(EZe,{match:i,onBackToLobby:pe})]})]})}function RZe(a){return{team_selection:"Seleccin de equipo",round1:"Ronda 1  Primera vuelta",simulating1:"Simulando...",round2:"Ronda 2  Segunda vuelta",simulating2:"Simulando...",results:"Resultados"}[a]||a}function PZe(){const{user:a}=Mc(),{dispatch:e}=Va(),[n,i]=ge.useState([]),[s,r]=ge.useState(!0),[o,l]=ge.useState(null);return ge.useEffect(()=>{Gle(100).then(i).catch(c=>{console.error(c),l("Error al cargar la clasificacin")}).finally(()=>r(!1))},[]),d.jsxs("div",{className:"ranked-leaderboard",children:[d.jsxs("div",{className:"ranked-leaderboard__header",children:[d.jsx("button",{className:"back-btn",onClick:()=>e({type:"SET_SCREEN",payload:"ranked_lobby"}),children:d.jsx(s1,{size:20})}),d.jsxs("h1",{children:[d.jsx(Ai,{size:22})," Clasificacin Global"]})]}),s?d.jsx("div",{className:"ranked-leaderboard__loading",children:"Cargando..."}):o?d.jsx("div",{className:"ranked-leaderboard__empty",children:o}):n.length===0?d.jsx("div",{className:"ranked-leaderboard__empty",children:"No hay jugadores an."}):d.jsx("div",{className:"ranked-leaderboard__list",children:n.map((c,u)=>{const h=xx(c.totalLP||0),f=c.id===a?.uid;return d.jsxs("div",{className:`lb-row ${f?"me":""} ${u<3?`top-${u+1}`:""}`,children:[d.jsx("span",{className:"lb-rank",children:u===0?d.jsx(FZ,{size:16,className:"gold"}):u===1?d.jsx(xN,{size:16,className:"silver"}):u===2?d.jsx(xN,{size:16,className:"bronze"}):`#${u+1}`}),d.jsx("span",{className:"lb-tier",children:h.icon}),d.jsxs("div",{className:"lb-info",children:[d.jsx("span",{className:"lb-name",children:c.displayName}),d.jsx("span",{className:"lb-tier-name",style:{color:h.color},children:h.name})]}),d.jsxs("div",{className:"lb-stats",children:[d.jsxs("span",{className:"lb-lp",children:[c.totalLP||0," LP"]}),d.jsxs("span",{className:"lb-record",children:[c.wins||0,"V ",c.losses||0,"D"]})]})]},c.id)})})]})}const p3={laliga:hu,segunda:fu,primeraRFEF:pu,segundaRFEF:mu,premierLeague:pf,serieA:mf,bundesliga:gf,ligue1:Af,eredivisie:yf,primeiraLiga:vf,championship:_f,belgianPro:xf,superLig:bf,scottishPrem:Sf,serieB:Tf,bundesliga2:wf,ligue2:Ef,swissSuperLeague:Mf,austrianBundesliga:Cf,greekSuperLeague:Nf,danishSuperliga:Rf,croatianLeague:Pf,czechLeague:If,argentinaPrimera:Lf,brasileiraoA:Df,colombiaPrimera:kf,chilePrimera:Of,uruguayPrimera:Ff,ecuadorLigaPro:jf,paraguayPrimera:Bf,peruLiga1:Uf,boliviaPrimera:Vf,venezuelaPrimera:zf,mls:hy,saudiPro:fy,ligaMX:py,jLeague:my},_6=Object.entries(Wa).map(([a,e])=>({id:a,name:e.name,getter:p3[a]||e.getTeams})).filter(a=>a.getter);function IZe(a){return a?.players?.length?Math.round(a.players.reduce((e,n)=>e+(n.overall||0),0)/a.players.length):0}function LZe(a){return a?a>=1e6?`${(a/1e6).toFixed(1)}M`:`${(a/1e3).toFixed(0)}K`:"0"}function DZe(a,e){const n={1:{pct:.12,min:15e6,max:5e8},2:{pct:.1,min:5e6,max:12e7},3:{pct:.07,min:15e5,max:3e7},4:{pct:.05,min:3e5,max:5e6},5:{pct:.03,min:1e5,max:15e5}},i=a.players?.length?a.players.reduce((l,c)=>l+(c.overall||0),0)/a.players.length:70,s=(a.players||[]).reduce((l,c)=>l+(c.value||0),0),r=Pl(e),o=n[r]||n[3];if(a.reputation||(i>=82?a.reputation=5:i>=78?a.reputation=4:i>=73?a.reputation=3:i>=68?a.reputation=2:a.reputation=1),!a.budget){const l=Math.max(s*o.pct,o.min),c=[.5,.7,1,1.5,2.5][a.reputation-1]||1;a.budget=Math.round(Math.min(l*c,o.max))}return a}function kZe(){const{t:a}=Sa(),{dispatch:e}=Va(),{user:n}=Mc(),[i,s]=ge.useState(null),[r,o]=ge.useState(!1),l=ge.useMemo(()=>tye(null,10,p3),[]),c=()=>{e({type:"SET_SCREEN",payload:"main_menu"})},u=async()=>{if(!i||r)return;o(!0);const{team:h,leagueId:f,objective:m}=i;DZe(h,f);const A=_6.find(j=>j.id===f);if(!A)return;let x;try{x=A.getter()}catch{return}const T=zh(x,h.id),E=DT(h.id,h.reputation),M=dP(E.capacity),N=[];for(const j of _6)try{N.push(...j.getter())}catch{}const F=SP(N,h)[0];e({type:"NEW_GAME",payload:{teamId:h.id,team:{...h},leagueId:f,stadiumInfo:E,stadiumLevel:M,preseasonMatches:F?.matches||[],preseasonPhase:!0,gameMode:"promanager",_proManagerUserId:n?.uid||null}}),e({type:"SET_PROMANAGER_DATA",payload:{prestige:10,boardConfidence:60,objective:m,seasonsManaged:1,totalWins:0,totalDraws:0,totalLosses:0,totalMatches:0,titles:0,careerHistory:[],winStreak:0,lossStreak:0,fired:!1}}),e({type:"SET_LEAGUE_TABLE",payload:T.table}),e({type:"SET_FIXTURES",payload:T.fixtures}),e({type:"SET_PLAYER_LEAGUE",payload:f});const G=[];for(const j of _6)try{const L=j.getter();for(const U of L)G.push({...U,id:U.id,name:U.name,players:U.players||[],budget:U.budget||(U.reputation>4?1e8:U.reputation>3?5e7:2e7),leagueId:j.id})}catch{}e({type:"UPDATE_LEAGUE_TEAMS",payload:G});const O=kx(f,null);if(e({type:"SET_OTHER_LEAGUES",payload:O}),fm(f))try{const j={};for(const[q,K]of Object.entries(kT)){const H=Wa[q];if(!H)continue;const X=H.getTeams?H.getTeams():p3[q]?.();X?.length&&(j[q]=X.map((ne,Q)=>({teamId:ne.id,teamName:ne.name,points:100-Q,reputation:ne.reputation||3,leagueId:q})))}const L=AP(j),U=yP(L,h.id,f);U&&e({type:"INIT_SA_COMPETITIONS",payload:U})}catch(j){console.warn("SA comps init error:",j)}else try{const j={};for(const[q,K]of Object.entries(hP)){const H=Wa[q];if(!H)continue;const X=H.getTeams?H.getTeams():p3[q]?.();X?.length&&(j[q]=X.map((ne,Q)=>({teamId:ne.id,teamName:ne.name,points:100-Q,reputation:ne.reputation||3,leagueId:q})))}const L=fP(j),U=mP(L,h.id,f);U&&e({type:"INIT_EUROPEAN_COMPETITIONS",payload:U})}catch(j){console.warn("Euro comps init error:",j)}try{const j=OT(f,null,x);if(j?.length>=4){const L=FT(j,h.id);e({type:"INIT_CUP",payload:L})}}catch{}};return d.jsxs("div",{className:"promanager-setup",children:[d.jsxs("div",{className:"promanager-setup__bg",children:[d.jsx("div",{className:"promanager-setup__gradient"}),d.jsx("div",{className:"promanager-setup__particles",children:[...Array(6)].map((h,f)=>d.jsx("div",{className:`particle particle--${f}`},f))})]}),d.jsxs("div",{className:"promanager-setup__content",children:[d.jsxs("div",{className:"promanager-setup__header",children:[d.jsxs("button",{className:"btn-back",onClick:c,children:[d.jsx(s1,{size:18}),d.jsx("span",{children:a("common.back")})]}),d.jsxs("div",{className:"header-info",children:[d.jsxs("h1",{children:[d.jsx(gu,{size:24}),a("proManager.title")]}),d.jsx("p",{children:a("proManager.chooseTeam")})]})]}),d.jsxs("div",{className:"promanager-setup__offers",children:[l.length===0&&d.jsx("p",{className:"no-offers",children:a("proManager.noOffers")}),d.jsx("div",{className:"offers-grid",children:l.map((h,f)=>{const m=IZe(h.team),A=i?.team?.id===h.team.id;return d.jsxs("button",{className:`offer-card ${A?"offer-card--selected":""}`,onClick:()=>s(h),children:[d.jsxs("div",{className:"offer-card__header",children:[d.jsx("h3",{children:h.team.name}),d.jsx("span",{className:"league-name",children:h.leagueName})]}),d.jsxs("div",{className:"offer-card__stats",children:[d.jsxs("div",{className:"stat",children:[d.jsx(Br,{size:14}),d.jsxs("span",{children:[m," OVR"]})]}),d.jsxs("div",{className:"stat",children:[d.jsx(Hu,{size:14}),d.jsx("span",{children:h.team.players?.length||0})]}),d.jsx("div",{className:"stat",children:d.jsx("span",{className:"money",children:LZe(h.team.budget)})})]}),d.jsxs("div",{className:"offer-card__objective",children:[d.jsx(Fs,{size:14}),d.jsx("span",{children:a(h.objective.label,h.objective.labelParams)})]})]},h.team.id+f)})}),i&&d.jsxs("button",{className:"btn-start",onClick:u,disabled:r,children:[d.jsx(gu,{size:20}),a(r?"common.loading":"proManager.startCareer")]})]})]})]})}const aX={laliga:hu,segunda:fu,primeraRFEF:pu,segundaRFEF:mu,premierLeague:pf,serieA:mf,bundesliga:gf,ligue1:Af,eredivisie:yf,primeiraLiga:vf,championship:_f,belgianPro:xf,superLig:bf,scottishPrem:Sf,serieB:Tf,bundesliga2:wf,ligue2:Ef,swissSuperLeague:Mf,austrianBundesliga:Cf,greekSuperLeague:Nf,danishSuperliga:Rf,croatianLeague:Pf,czechLeague:If,argentinaPrimera:Lf,brasileiraoA:Df,colombiaPrimera:kf,chilePrimera:Of,uruguayPrimera:Ff,ecuadorLigaPro:jf,paraguayPrimera:Bf,peruLiga1:Uf,boliviaPrimera:Vf,venezuelaPrimera:zf,mls:hy,saudiPro:fy,ligaMX:py,jLeague:my};function OZe(a){return a?.players?.length?Math.round(a.players.reduce((e,n)=>e+(n.overall||0),0)/a.players.length):65}function FZe(a){return a?a>=1e6?`${(a/1e6).toFixed(1)}M`:`${(a/1e3).toFixed(0)}K`:"0"}function jZe(){const{t:a}=Sa(),{state:e,dispatch:n}=Va(),{user:i}=Mc(),s=e.proManagerData,[r,o]=ge.useState("summary"),[l,c]=ge.useState(null),[u,h]=ge.useState(s?.prestige||10),f=e.leagueTable?.findIndex(D=>D.teamId===e.teamId)+1||1,m=e.leagueTable?.find(D=>D.teamId===e.teamId),A=ge.useMemo(()=>iye(f,s?.objective,e.cupResult),[f,s?.objective,e.cupResult]),x=ge.useMemo(()=>sye(s?.prestige||10,A,s?.fired),[s?.prestige,A,s?.fired]),T=ge.useMemo(()=>oye(A.result),[A.result]),E=ge.useMemo(()=>rye(x,e.playerLeagueId||e.leagueId,e.teamId,aX),[x,e.playerLeagueId,e.leagueId,e.teamId]);ge.useEffect(()=>{const D=setTimeout(()=>h(x),500);return()=>clearTimeout(D)},[x]);const M=A.result!=="failed"&&!s?.fired,N=()=>{const D=e.playerLeagueId||e.leagueId,j=MF(OZe(e.team),D,e.team);n({type:"SET_PROMANAGER_DATA",payload:{...s,prestige:x,boardConfidence:T,objective:j,seasonsManaged:(s.seasonsManaged||1)+1,fired:!1,winStreak:0,lossStreak:0,careerHistory:[...s.careerHistory||[],{season:s.seasonsManaged||1,teamName:e.team?.name,leagueId:D,position:f,result:A.result}]}}),n({type:"SET_SCREEN",payload:"office"})},I=D=>{const{team:j,leagueId:L,objective:U}=D,q=Object.entries(Wa).find(([ue])=>ue===L);if(!q)return;const[,K]=q,H=aX[L]||K.getTeams;if(!H)return;let X;try{X=H()}catch{return}const ne=zh(X,j.id),Q=DT(j.id,j.reputation);dP(Q.capacity),n({type:"PROMANAGER_SWITCH_TEAM",payload:{team:j,leagueId:L,_proManagerUserId:i?.uid||null}}),n({type:"SET_PROMANAGER_DATA",payload:{...s,prestige:x,boardConfidence:60,objective:U,seasonsManaged:(s.seasonsManaged||1)+1,fired:!1,winStreak:0,lossStreak:0,currentTeamId:j.id,currentLeagueId:L,careerHistory:[...s.careerHistory||[],{season:s.seasonsManaged||1,teamName:e.team?.name,leagueId:e.playerLeagueId||e.leagueId,position:f,result:A.result}]}}),n({type:"SET_LEAGUE_TABLE",payload:ne.table}),n({type:"SET_FIXTURES",payload:ne.fixtures}),n({type:"SET_PLAYER_LEAGUE",payload:L});const Y=kx(L,null);n({type:"SET_OTHER_LEAGUES",payload:Y});try{const ue=OT(L,null,X);if(ue?.length>=4){const pe=FT(ue,j.id);n({type:"INIT_CUP",payload:pe})}}catch{}},F=()=>{n({type:"RESET_GAME"}),n({type:"SET_SCREEN",payload:"main_menu"})},G={champion:"",exceeded:"",met:"",close:"",failed:""}[A.result]||"",O={champion:"#ffd700",exceeded:"#4ade80",met:"#4ade80",close:"#f59e0b",failed:"#ef4444"}[A.result]||"#8899aa";return d.jsxs("div",{className:"pm-season-end",children:[d.jsx("div",{className:"pm-season-end__bg",children:d.jsx("div",{className:"pm-season-end__gradient"})}),d.jsxs("div",{className:"pm-season-end__content",children:[r==="summary"&&d.jsxs("div",{className:"pm-season-end__summary",children:[d.jsxs("div",{className:"pm-season-end__title",children:[d.jsx(gu,{size:24}),d.jsx("h1",{children:a("proManager.seasonEnd.title")}),d.jsxs("span",{className:"season-num",children:[a("common.season")," ",s?.seasonsManaged||1]})]}),d.jsxs("div",{className:"pm-season-end__card",children:[d.jsx("h2",{children:e.team?.name}),d.jsxs("div",{className:"stats-row",children:[d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"label",children:a("ranking.position")}),d.jsxs("span",{className:"value",children:[f,""]})]}),d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"label",children:a("leagueTable.points")}),d.jsx("span",{className:"value",children:m?.points||0})]}),d.jsxs("div",{className:"stat",children:[d.jsx("span",{className:"label",children:a("managerFired.balance")}),d.jsxs("span",{className:"value",children:[m?.won||0,"W ",m?.drawn||0,"D ",m?.lost||0,"L"]})]})]})]}),d.jsxs("div",{className:"pm-season-end__eval",style:{borderColor:O},children:[d.jsxs("div",{className:"eval-header",children:[d.jsx("span",{className:"emoji",children:G}),d.jsx("h3",{children:a(`proManager.seasonEnd.${A.result}`)})]}),s?.objective&&d.jsxs("p",{className:"objective-reminder",children:[d.jsx(Fs,{size:14}),a(s.objective.label,s.objective.labelParams)]})]}),d.jsxs("div",{className:"pm-season-end__prestige",children:[d.jsxs("div",{className:"prestige-label",children:[A.prestigeChange>=0?d.jsx(dl,{size:16}):d.jsx(VT,{size:16}),d.jsx("span",{children:a("proManager.prestige")})]}),d.jsxs("div",{className:"prestige-change",children:[d.jsx("span",{className:"old",children:s?.prestige||10}),d.jsx(jS,{size:14}),d.jsx("span",{className:`new ${A.prestigeChange>=0?"positive":"negative"}`,children:u}),d.jsxs("span",{className:`delta ${A.prestigeChange>=0?"positive":"negative"}`,children:["(",A.prestigeChange>=0?"+":"",A.prestigeChange,")"]})]}),d.jsx("div",{className:"prestige-bar",children:d.jsx("div",{className:"prestige-bar__fill",style:{width:`${u}%`}})})]}),d.jsxs("button",{className:"btn-next",onClick:()=>o("offers"),children:[a("proManager.seasonEnd.viewOffers"),d.jsx(_r,{size:18})]})]}),r==="offers"&&d.jsxs("div",{className:"pm-season-end__offers",children:[d.jsx("h2",{children:a("proManager.seasonEnd.jobOffers")}),M&&d.jsxs("div",{className:"pm-season-end__renewal",children:[d.jsx("h3",{children:a("proManager.seasonEnd.renewWith",{team:e.team?.name})}),d.jsx("button",{className:"btn-renew",onClick:N,children:a("proManager.seasonEnd.renew")})]}),E.length>0?d.jsx("div",{className:"offers-list",children:E.map((D,j)=>d.jsxs("div",{className:"offer-item",children:[d.jsxs("div",{className:"offer-info",children:[d.jsx("h4",{children:D.team.name}),d.jsxs("span",{className:"league",children:[D.leagueName,"  ",D.country]}),d.jsxs("div",{className:"offer-objective",children:[d.jsx(Fs,{size:12}),a(D.objective.label,D.objective.labelParams)]}),d.jsx("span",{className:"budget",children:FZe(D.team.budget)})]}),d.jsx("button",{className:"btn-accept",onClick:()=>I(D),children:a("common.accept")})]},D.team.id+j))}):d.jsx("p",{className:"no-offers",children:a("proManager.seasonEnd.noExternalOffers")}),d.jsxs("button",{className:"btn-retire",onClick:F,children:[d.jsx(qh,{size:16}),a("proManager.seasonEnd.retire")]})]})]})]})}const x6={menu:"/pcfutbol-web/audio/synthwave-calm.mp3",matchDay:"/pcfutbol-web/audio/energetic.ogg",default:"/pcfutbol-web/audio/chill-fever.mp3"},BZe=["menu","teamSelection","contrarrelojSetup","settings","saves"];function UZe(a,e){return BZe.includes(a)?x6.menu:a==="matchDay"?x6.matchDay:x6.default}function VZe(a,e,n){const i=ge.useRef(null),s=ge.useRef(null),r=ge.useRef(null),o=e?.soundEnabled??!0,l=(e?.musicVolume??70)/100,c=ge.useCallback((u,h=500)=>new Promise(f=>{if(!u||u.paused){f();return}const m=u.volume,A=20,x=h/A,T=m/A;let E=0;r.current&&clearInterval(r.current),r.current=setInterval(()=>{E++,u.volume=Math.max(0,m-T*E),E>=A&&(clearInterval(r.current),r.current=null,u.pause(),u.volume=m,f())},x)}),[]);ge.useEffect(()=>{const u=UZe(a);if(!o||l===0){i.current&&!i.current.paused&&c(i.current,300).then(()=>{s.current=null});return}return s.current===u&&i.current&&!i.current.paused?void 0:((async()=>{i.current&&!i.current.paused&&await c(i.current,400);const f=new Audio(u);f.loop=!0,f.volume=l;try{await f.play(),i.current=f,s.current=u}catch{const A=()=>{f.play().then(()=>{i.current=f,s.current=u}).catch(()=>{}),document.removeEventListener("click",A),document.removeEventListener("keydown",A)};document.addEventListener("click",A,{once:!0}),document.addEventListener("keydown",A,{once:!0})}})(),()=>{r.current&&clearInterval(r.current)})},[a,o,l,n,c]),ge.useEffect(()=>{if(i.current){const u=o?l:0;i.current.volume=u,u===0&&!i.current.paused&&(i.current.pause(),s.current=null)}},[l,o]),ge.useEffect(()=>()=>{r.current&&clearInterval(r.current),i.current&&(i.current.pause(),i.current=null)},[])}const iX={click:"/pcfutbol-web/audio/click.ogg",select:"/pcfutbol-web/audio/select.ogg",toggle:"/pcfutbol-web/audio/toggle.ogg"},LC={};function zZe(a){LC[a]||(LC[a]=[]);let e=LC[a].find(n=>n.paused||n.ended);return e||(e=new Audio(a),LC[a].push(e)),e}function GZe(a){const e=a?.soundEnabled??!0,n=(a?.sfxVolume??a?.effectsVolume??80)/100,i=ge.useRef(0),s=ge.useCallback((c="click")=>{if(!e||n===0)return;const u=Date.now();if(u-i.current<50)return;i.current=u;const h=iX[c]||iX.click;try{const f=zZe(h);f.volume=n,f.currentTime=0,f.play().catch(()=>{})}catch{}},[e,n]),r=ge.useCallback(()=>s("click"),[s]),o=ge.useCallback(()=>s("select"),[s]),l=ge.useCallback(()=>s("toggle"),[s]);return{play:s,playClick:r,playSelect:o,playToggle:l}}function qZe(){const{state:a}=Va(),{loading:e}=Mc(),i=a.playingMatch||a.pendingMatch?"matchDay":a.currentScreen==="team_selection"?"teamSelection":a.currentScreen==="contrarreloj_setup"?"contrarrelojSetup":a.currentScreen==="office"?"default":"menu";VZe(i,a.settings,a.preseasonPhase?"preseason":"season");const{playClick:s,playToggle:r}=GZe(a.settings);if(ge.useEffect(()=>{const l=c=>{const u=c.target.closest('button, a, [role="button"], .clickable');u&&(u.classList.contains("settings__toggle")||u.querySelector(".toggle-knob")?r():s())};return document.addEventListener("click",l,!0),()=>document.removeEventListener("click",l,!0)},[s,r]),!a.loaded||e)return d.jsx("div",{className:"loading-screen",children:d.jsxs("div",{className:"loading-content",children:[d.jsx("h1",{children:""}),d.jsx("p",{children:"Cargando..."})]})});const o=a.gameStarted&&a.currentScreen==="office";return d.jsxs(d.Fragment,{children:[o&&d.jsx(dwe,{}),(()=>{switch(a.currentScreen){case"team_selection":return d.jsx(ZQe,{});case"office":return d.jsx(fZe,{});case"contrarreloj_setup":return d.jsx(yZe,{});case"contrarreloj_end":return d.jsx(SZe,{});case"ranking":return d.jsx(TZe,{});case"ranked_lobby":return d.jsx(wZe,{});case"ranked_match":return d.jsx(NZe,{});case"ranked_leaderboard":return d.jsx(PZe,{});case"promanager_setup":return d.jsx(kZe,{});case"promanager_season_end":return d.jsx(jZe,{});default:return d.jsx(ywe,{})}})()]})}function HZe(){return d.jsx(rwe,{children:d.jsx(swe,{children:d.jsx(I2e,{children:d.jsx(D2e,{children:d.jsx(Jye,{children:d.jsx(qZe,{})})})})})})}fue.createRoot(document.getElementById("root")).render(d.jsx(ge.StrictMode,{children:d.jsx(HZe,{})}));export{r1 as $,FP as A,WZ as B,OS as C,er as D,bk as E,UA as F,c1 as G,Nd as H,o4 as I,nCe as J,cs as K,_we as L,Na as M,lo as N,P0 as O,Zs as P,Er as Q,p8 as R,Vx as S,net as T,os as U,Hh as V,kF as W,ls as X,GEe as Y,di as Z,Yh as _,BR as a,wj as a0,Tj as a1,Xwe as a2,XT as a3,_a as a4,oo as a5,_n as a6,jj as a7,Cr as a8,Mr as a9,_c as aa,_s as ab,ga as ac,qn as ad,h1 as ae,Ec as af,Ur as ag,vc as ah,GT as ai,cu as aj,jr as ak,t0 as al,e0 as am,Ei as an,Nc as ao,Pj as ap,ZZ as aq,xm as ar,hl as as,xc as at,d0 as au,tCe as av,QP as aw,Q1e as b,lue as c,ge as d,lte as e,Jee as f,f8 as g,$Z as h,zh as i,d as j,b_ as k,Vn as l,_m as m,Fr as n,KP as o,on as p,fs as q,DF as r,jl as s,Nt as t,ye as u,_4 as v,w0 as w,mo as x,Dk as y,ou as z};
//# sourceMappingURL=index-D5P5878y.js.map
