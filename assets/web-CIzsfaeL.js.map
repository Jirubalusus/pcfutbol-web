{"version":3,"file":"web-CIzsfaeL.js","sources":["../../node_modules/@capgo/capacitor-social-login/dist/esm/base.js","../../node_modules/@capgo/capacitor-social-login/dist/esm/apple-provider.js","../../node_modules/@capgo/capacitor-social-login/dist/esm/facebook-provider.js","../../node_modules/@capgo/capacitor-social-login/dist/esm/google-provider.js","../../node_modules/@capgo/capacitor-social-login/dist/esm/oauth2-provider.js","../../node_modules/@capgo/capacitor-social-login/dist/esm/twitter-provider.js","../../node_modules/@capgo/capacitor-social-login/dist/esm/web.js"],"sourcesContent":["import { WebPlugin } from '@capacitor/core';\nexport class BaseSocialLogin extends WebPlugin {\n    constructor() {\n        super();\n    }\n    parseJwt(token) {\n        const base64Url = token.split('.')[1];\n        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n        const jsonPayload = decodeURIComponent(atob(base64)\n            .split('')\n            .map((c) => {\n            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n        })\n            .join(''));\n        return JSON.parse(jsonPayload);\n    }\n    async loadScript(src) {\n        return new Promise((resolve, reject) => {\n            const script = document.createElement('script');\n            script.src = src;\n            script.async = true;\n            script.onload = () => {\n                resolve();\n            };\n            script.onerror = reject;\n            document.body.appendChild(script);\n        });\n    }\n}\nBaseSocialLogin.OAUTH_STATE_KEY = 'social_login_oauth_pending';\n//# sourceMappingURL=base.js.map","import { BaseSocialLogin } from './base';\nexport class AppleSocialLogin extends BaseSocialLogin {\n    constructor() {\n        super(...arguments);\n        this.clientId = null;\n        this.redirectUrl = null;\n        this.scriptLoaded = false;\n        this.scriptUrl = 'https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js';\n        this.useProperTokenExchange = false;\n    }\n    async initialize(clientId, redirectUrl, useProperTokenExchange = false) {\n        this.clientId = clientId;\n        this.redirectUrl = redirectUrl || null;\n        this.useProperTokenExchange = useProperTokenExchange;\n        if (clientId) {\n            await this.loadAppleScript();\n        }\n    }\n    async login(options) {\n        if (!this.clientId) {\n            throw new Error('Apple Client ID not set. Call initialize() first.');\n        }\n        if (!this.scriptLoaded) {\n            throw new Error('Apple Sign-In script not loaded.');\n        }\n        return new Promise((resolve, reject) => {\n            var _a, _b;\n            AppleID.auth.init({\n                clientId: (_a = this.clientId) !== null && _a !== void 0 ? _a : '',\n                scope: ((_b = options.scopes) === null || _b === void 0 ? void 0 : _b.join(' ')) || 'name email',\n                redirectURI: this.redirectUrl || window.location.href,\n                state: options.state,\n                nonce: options.nonce,\n                usePopup: true,\n            });\n            AppleID.auth\n                .signIn()\n                .then((res) => {\n                var _a, _b, _c, _d, _e;\n                let accessToken = null;\n                if (this.useProperTokenExchange) {\n                    // When using proper token exchange, the authorization code should be exchanged\n                    // for a proper access token on the backend. For now, we set accessToken to null\n                    // and provide the authorization code in a separate field for backend processing.\n                    accessToken = null;\n                }\n                else {\n                    // Legacy behavior: use authorization code as access token for backward compatibility\n                    accessToken = {\n                        token: res.authorization.code || '',\n                    };\n                }\n                const result = Object.assign({ profile: {\n                        user: res.user || '',\n                        email: ((_a = res.user) === null || _a === void 0 ? void 0 : _a.email) || null,\n                        givenName: ((_c = (_b = res.user) === null || _b === void 0 ? void 0 : _b.name) === null || _c === void 0 ? void 0 : _c.firstName) || null,\n                        familyName: ((_e = (_d = res.user) === null || _d === void 0 ? void 0 : _d.name) === null || _e === void 0 ? void 0 : _e.lastName) || null,\n                    }, accessToken: accessToken, idToken: res.authorization.id_token || null }, (this.useProperTokenExchange && { authorizationCode: res.authorization.code }));\n                resolve({ provider: 'apple', result });\n            })\n                .catch((error) => {\n                reject(error);\n            });\n        });\n    }\n    async logout() {\n        // Apple doesn't provide a logout method for web\n        console.log('Apple logout: Session should be managed on the client side');\n    }\n    async isLoggedIn() {\n        // Apple doesn't provide a method to check login status on web\n        console.log('Apple login status should be managed on the client side');\n        return { isLoggedIn: false };\n    }\n    async getAuthorizationCode() {\n        // Apple authorization code should be obtained during login\n        console.log('Apple authorization code should be stored during login');\n        throw new Error('Apple authorization code not available');\n    }\n    async refresh() {\n        // Apple doesn't provide a refresh method for web\n        console.log('Apple refresh not available on web');\n    }\n    async loadAppleScript() {\n        if (this.scriptLoaded)\n            return;\n        return this.loadScript(this.scriptUrl).then(() => {\n            this.scriptLoaded = true;\n        });\n    }\n}\n//# sourceMappingURL=apple-provider.js.map","import { BaseSocialLogin } from './base';\nexport class FacebookSocialLogin extends BaseSocialLogin {\n    constructor() {\n        super(...arguments);\n        this.appId = null;\n        this.scriptLoaded = false;\n        this.locale = 'en_US';\n    }\n    async initialize(appId, locale) {\n        this.appId = appId;\n        if (locale) {\n            this.locale = locale;\n        }\n        if (appId) {\n            // Load with the specified locale or default\n            await this.loadFacebookScript(this.locale);\n            FB.init({\n                appId: this.appId,\n                version: 'v17.0',\n                xfbml: true,\n                cookie: true,\n            });\n        }\n    }\n    async login(options) {\n        if (!this.appId) {\n            throw new Error('Facebook App ID not set. Call initialize() first.');\n        }\n        return new Promise((resolve, reject) => {\n            FB.login((response) => {\n                if (response.status === 'connected') {\n                    FB.api('/me', { fields: 'id,name,email,picture' }, (userInfo) => {\n                        var _a, _b;\n                        const result = {\n                            accessToken: {\n                                token: response.authResponse.accessToken,\n                                userId: response.authResponse.userID,\n                            },\n                            profile: {\n                                userID: userInfo.id,\n                                name: userInfo.name,\n                                email: userInfo.email || null,\n                                imageURL: ((_b = (_a = userInfo.picture) === null || _a === void 0 ? void 0 : _a.data) === null || _b === void 0 ? void 0 : _b.url) || null,\n                                friendIDs: [],\n                                birthday: null,\n                                ageRange: null,\n                                gender: null,\n                                location: null,\n                                hometown: null,\n                                profileURL: null,\n                            },\n                            idToken: null,\n                        };\n                        resolve({ provider: 'facebook', result });\n                    });\n                }\n                else {\n                    reject(new Error('Facebook login failed'));\n                }\n            }, { scope: options.permissions.join(',') });\n        });\n    }\n    async logout() {\n        return new Promise((resolve) => {\n            FB.logout(() => resolve());\n        });\n    }\n    async isLoggedIn() {\n        return new Promise((resolve) => {\n            FB.getLoginStatus((response) => {\n                resolve({ isLoggedIn: response.status === 'connected' });\n            });\n        });\n    }\n    async getAuthorizationCode() {\n        return new Promise((resolve, reject) => {\n            FB.getLoginStatus((response) => {\n                var _a;\n                if (response.status === 'connected') {\n                    resolve({ accessToken: ((_a = response.authResponse) === null || _a === void 0 ? void 0 : _a.accessToken) || '' });\n                }\n                else {\n                    reject(new Error('No Facebook authorization code available'));\n                }\n            });\n        });\n    }\n    async refresh(options) {\n        await this.login(options);\n    }\n    async loadFacebookScript(locale) {\n        if (this.scriptLoaded)\n            return;\n        // Remove any existing Facebook SDK script\n        const existingScript = document.querySelector('script[src*=\"connect.facebook.net\"]');\n        if (existingScript) {\n            existingScript.remove();\n        }\n        return this.loadScript(`https://connect.facebook.net/${locale}/sdk.js`).then(() => {\n            this.scriptLoaded = true;\n        });\n    }\n}\n//# sourceMappingURL=facebook-provider.js.map","import { BaseSocialLogin } from './base';\nexport class GoogleSocialLogin extends BaseSocialLogin {\n    constructor() {\n        super(...arguments);\n        this.clientId = null;\n        this.loginType = 'online';\n        this.GOOGLE_TOKEN_REQUEST_URL = 'https://www.googleapis.com/oauth2/v3/tokeninfo';\n        this.GOOGLE_STATE_KEY = 'capgo_social_login_google_state';\n    }\n    async initialize(clientId, mode, hostedDomain, redirectUrl) {\n        this.clientId = clientId;\n        if (mode) {\n            this.loginType = mode;\n        }\n        this.hostedDomain = hostedDomain;\n        this.redirectUrl = redirectUrl;\n    }\n    async login(options) {\n        if (!this.clientId) {\n            throw new Error('Google Client ID not set. Call initialize() first.');\n        }\n        let scopes = options.scopes || [];\n        if (scopes.length > 0) {\n            // If scopes are provided, directly use the traditional OAuth flow\n            if (!scopes.includes('https://www.googleapis.com/auth/userinfo.email')) {\n                scopes.push('https://www.googleapis.com/auth/userinfo.email');\n            }\n            if (!scopes.includes('https://www.googleapis.com/auth/userinfo.profile')) {\n                scopes.push('https://www.googleapis.com/auth/userinfo.profile');\n            }\n            if (!scopes.includes('openid')) {\n                scopes.push('openid');\n            }\n        }\n        else {\n            scopes = [\n                'https://www.googleapis.com/auth/userinfo.email',\n                'https://www.googleapis.com/auth/userinfo.profile',\n                'openid',\n            ];\n        }\n        const nonce = options.nonce || Math.random().toString(36).substring(2);\n        // If scopes are provided, directly use the traditional OAuth flow\n        return this.traditionalOAuth({\n            scopes,\n            nonce,\n            hostedDomain: this.hostedDomain,\n            prompt: options.prompt,\n        });\n    }\n    async logout() {\n        if (this.loginType === 'offline') {\n            return Promise.reject(\"Offline login doesn't store tokens. logout is not available\");\n        }\n        // eslint-disable-next-line\n        const state = this.getGoogleState();\n        if (!state)\n            return;\n        await this.rawLogoutGoogle(state.accessToken);\n    }\n    async isLoggedIn() {\n        if (this.loginType === 'offline') {\n            return Promise.reject(\"Offline login doesn't store tokens. isLoggedIn is not available\");\n        }\n        // eslint-disable-next-line\n        const state = this.getGoogleState();\n        if (!state)\n            return { isLoggedIn: false };\n        try {\n            const isValidAccessToken = await this.accessTokenIsValid(state.accessToken);\n            const isValidIdToken = this.idTokenValid(state.idToken);\n            if (isValidAccessToken && isValidIdToken) {\n                return { isLoggedIn: true };\n            }\n            else {\n                try {\n                    await this.rawLogoutGoogle(state.accessToken, false);\n                }\n                catch (e) {\n                    console.error('Access token is not valid, but cannot logout', e);\n                }\n                return { isLoggedIn: false };\n            }\n        }\n        catch (e) {\n            return Promise.reject(e);\n        }\n    }\n    async getAuthorizationCode() {\n        if (this.loginType === 'offline') {\n            return Promise.reject(\"Offline login doesn't store tokens. getAuthorizationCode is not available\");\n        }\n        // eslint-disable-next-line\n        const state = this.getGoogleState();\n        if (!state)\n            throw new Error('No Google authorization code available');\n        try {\n            const isValidAccessToken = await this.accessTokenIsValid(state.accessToken);\n            const isValidIdToken = this.idTokenValid(state.idToken);\n            if (isValidAccessToken && isValidIdToken) {\n                return { accessToken: state.accessToken, jwt: state.idToken };\n            }\n            else {\n                try {\n                    await this.rawLogoutGoogle(state.accessToken, false);\n                }\n                catch (e) {\n                    console.error('Access token is not valid, but cannot logout', e);\n                }\n                throw new Error('No Google authorization code available');\n            }\n        }\n        catch (e) {\n            return Promise.reject(e);\n        }\n    }\n    async refresh() {\n        // For Google, we can prompt for re-authentication\n        return Promise.reject('Not implemented');\n    }\n    handleOAuthRedirect(url) {\n        const paramsRaw = url.searchParams;\n        // Check for errors in search params first (for offline mode)\n        const errorInParams = paramsRaw.get('error');\n        if (errorInParams) {\n            localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n            const errorDescription = paramsRaw.get('error_description') || errorInParams;\n            return { error: errorDescription };\n        }\n        const code = paramsRaw.get('code');\n        if (code && paramsRaw.has('scope')) {\n            return {\n                provider: 'google',\n                result: {\n                    serverAuthCode: code,\n                    responseType: 'offline',\n                },\n            };\n        }\n        const hash = url.hash.substring(1);\n        console.log('handleOAuthRedirect', url.hash);\n        if (!hash)\n            return null;\n        const params = new URLSearchParams(hash);\n        // Check for error cases in hash (e.g., user cancelled)\n        const error = params.get('error');\n        if (error) {\n            localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n            const errorDescription = params.get('error_description') || error;\n            return { error: errorDescription };\n        }\n        console.log('handleOAuthRedirect ok');\n        const accessToken = params.get('access_token');\n        const idToken = params.get('id_token');\n        if (accessToken && idToken) {\n            localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n            const profile = this.parseJwt(idToken);\n            return {\n                provider: 'google',\n                result: {\n                    accessToken: {\n                        token: accessToken,\n                    },\n                    idToken,\n                    profile: {\n                        email: profile.email || null,\n                        familyName: profile.family_name || null,\n                        givenName: profile.given_name || null,\n                        id: profile.sub || null,\n                        name: profile.name || null,\n                        imageUrl: profile.picture || null,\n                    },\n                    responseType: 'online',\n                },\n            };\n        }\n        return null;\n    }\n    async accessTokenIsValid(accessToken) {\n        const url = `${this.GOOGLE_TOKEN_REQUEST_URL}?access_token=${encodeURIComponent(accessToken)}`;\n        try {\n            // Make the GET request using fetch\n            const response = await fetch(url);\n            // Check if the response is successful\n            if (!response.ok) {\n                console.log(`Invalid response from ${this.GOOGLE_TOKEN_REQUEST_URL}. Response not successful. Status code: ${response.status}. Assuming that the token is not valid`);\n                return false;\n            }\n            // Get the response body as text\n            const responseBody = await response.text();\n            if (!responseBody) {\n                console.error(`Invalid response from ${this.GOOGLE_TOKEN_REQUEST_URL}. Response body is null`);\n                throw new Error(`Invalid response from ${this.GOOGLE_TOKEN_REQUEST_URL}. Response body is null`);\n            }\n            // Parse the response body as JSON\n            let jsonObject;\n            try {\n                jsonObject = JSON.parse(responseBody);\n            }\n            catch (e) {\n                console.error(`Invalid response from ${this.GOOGLE_TOKEN_REQUEST_URL}. Response body is not valid JSON. Error: ${e}`);\n                throw new Error(`Invalid response from ${this.GOOGLE_TOKEN_REQUEST_URL}. Response body is not valid JSON. Error: ${e}`);\n            }\n            // Extract the 'expires_in' field\n            const expiresInStr = jsonObject['expires_in'];\n            if (expiresInStr === undefined || expiresInStr === null) {\n                console.error(`Invalid response from ${this.GOOGLE_TOKEN_REQUEST_URL}. Response JSON does not include 'expires_in'.`);\n                throw new Error(`Invalid response from ${this.GOOGLE_TOKEN_REQUEST_URL}. Response JSON does not include 'expires_in'.`);\n            }\n            // Parse 'expires_in' as an integer\n            let expiresInInt;\n            try {\n                expiresInInt = parseInt(expiresInStr, 10);\n                if (isNaN(expiresInInt)) {\n                    throw new Error(`'expires_in' is not a valid integer`);\n                }\n            }\n            catch (e) {\n                console.error(`Invalid response from ${this.GOOGLE_TOKEN_REQUEST_URL}. 'expires_in': ${expiresInStr} is not a valid integer. Error: ${e}`);\n                throw new Error(`Invalid response from ${this.GOOGLE_TOKEN_REQUEST_URL}. 'expires_in': ${expiresInStr} is not a valid integer. Error: ${e}`);\n            }\n            // Determine if the access token is valid based on 'expires_in'\n            return expiresInInt > 5;\n        }\n        catch (error) {\n            console.error(error);\n            throw error;\n        }\n    }\n    idTokenValid(idToken) {\n        try {\n            const parsed = this.parseJwt(idToken);\n            const currentTime = Math.ceil(Date.now() / 1000) + 5; // Convert current time to seconds since epoch\n            return parsed.exp && currentTime < parsed.exp;\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    async rawLogoutGoogle(accessToken, tokenValid = null) {\n        if (tokenValid === null) {\n            tokenValid = await this.accessTokenIsValid(accessToken);\n        }\n        if (tokenValid === true) {\n            try {\n                await fetch(`https://accounts.google.com/o/oauth2/revoke?token=${encodeURIComponent(accessToken)}`);\n                this.clearStateGoogle();\n            }\n            catch (e) {\n                // ignore\n            }\n            return;\n        }\n        else {\n            this.clearStateGoogle();\n            return;\n        }\n    }\n    persistStateGoogle(accessToken, idToken) {\n        try {\n            window.localStorage.setItem(this.GOOGLE_STATE_KEY, JSON.stringify({ accessToken, idToken }));\n        }\n        catch (e) {\n            console.error('Cannot persist state google', e);\n        }\n    }\n    clearStateGoogle() {\n        try {\n            window.localStorage.removeItem(this.GOOGLE_STATE_KEY);\n        }\n        catch (e) {\n            console.error('Cannot clear state google', e);\n        }\n    }\n    getGoogleState() {\n        try {\n            const state = window.localStorage.getItem(this.GOOGLE_STATE_KEY);\n            if (!state)\n                return null;\n            const { accessToken, idToken } = JSON.parse(state);\n            return { accessToken, idToken };\n        }\n        catch (e) {\n            console.error('Cannot get state google', e);\n            return null;\n        }\n    }\n    async traditionalOAuth({ scopes, hostedDomain, nonce, prompt, }) {\n        var _a;\n        const uniqueScopes = [...new Set([...(scopes || []), 'openid'])];\n        const params = new URLSearchParams(Object.assign(Object.assign({ client_id: (_a = this.clientId) !== null && _a !== void 0 ? _a : '', redirect_uri: this.redirectUrl || window.location.origin + window.location.pathname, response_type: this.loginType === 'offline' ? 'code' : 'token id_token', scope: uniqueScopes.join(' ') }, (nonce && { nonce })), { include_granted_scopes: 'true', state: 'popup' }));\n        if (hostedDomain !== undefined) {\n            params.append('hd', hostedDomain);\n        }\n        if (prompt !== undefined) {\n            params.append('prompt', prompt);\n        }\n        const url = `https://accounts.google.com/o/oauth2/v2/auth?${params.toString()}`;\n        const width = 500;\n        const height = 600;\n        const left = window.screenX + (window.outerWidth - width) / 2;\n        const top = window.screenY + (window.outerHeight - height) / 2;\n        localStorage.setItem(BaseSocialLogin.OAUTH_STATE_KEY, JSON.stringify({ provider: 'google', loginType: this.loginType, nonce }));\n        const popup = window.open(url, 'Google Sign In', `width=${width},height=${height},left=${left},top=${top},popup=1`);\n        let popupClosedInterval;\n        let timeoutHandle;\n        // Use BroadcastChannel for cross-origin communication (works when postMessage doesn't)\n        const channelName = `google_oauth_${nonce || Date.now()}`;\n        let broadcastChannel = null;\n        try {\n            broadcastChannel = new BroadcastChannel(channelName);\n        }\n        catch (_b) {\n            // BroadcastChannel not supported, fall back to postMessage only\n        }\n        // This may never return...\n        return new Promise((resolve, reject) => {\n            if (!popup) {\n                reject(new Error('Failed to open popup'));\n                return;\n            }\n            const cleanup = () => {\n                window.removeEventListener('message', handleMessage);\n                clearInterval(popupClosedInterval);\n                clearTimeout(timeoutHandle);\n                if (broadcastChannel) {\n                    broadcastChannel.close();\n                }\n            };\n            const processOAuthResponse = (data) => {\n                if (this.loginType === 'online') {\n                    const { accessToken, idToken } = data;\n                    if (accessToken && idToken) {\n                        const profile = this.parseJwt(idToken);\n                        this.persistStateGoogle(accessToken.token, idToken);\n                        resolve({\n                            provider: 'google',\n                            result: {\n                                accessToken: {\n                                    token: accessToken.token,\n                                },\n                                idToken,\n                                profile: {\n                                    email: profile.email || null,\n                                    familyName: profile.family_name || null,\n                                    givenName: profile.given_name || null,\n                                    id: profile.sub || null,\n                                    name: profile.name || null,\n                                    imageUrl: profile.picture || null,\n                                },\n                                responseType: 'online',\n                            },\n                        });\n                    }\n                    else {\n                        reject(new Error('Invalid OAuth response: missing accessToken or idToken'));\n                    }\n                }\n                else {\n                    const { serverAuthCode } = data;\n                    if (!serverAuthCode) {\n                        reject(new Error('Invalid OAuth response: missing serverAuthCode'));\n                        return;\n                    }\n                    resolve({\n                        provider: 'google',\n                        result: {\n                            responseType: 'offline',\n                            serverAuthCode,\n                        },\n                    });\n                }\n            };\n            const handleMessage = (event) => {\n                var _a, _b, _c, _d;\n                if (event.origin !== window.location.origin || ((_b = (_a = event.data) === null || _a === void 0 ? void 0 : _a.source) === null || _b === void 0 ? void 0 : _b.startsWith('angular')))\n                    return;\n                if (((_c = event.data) === null || _c === void 0 ? void 0 : _c.type) === 'oauth-response') {\n                    cleanup();\n                    processOAuthResponse(event.data);\n                }\n                else if (((_d = event.data) === null || _d === void 0 ? void 0 : _d.type) === 'oauth-error') {\n                    cleanup();\n                    const errorMessage = event.data.error || 'User cancelled the OAuth flow';\n                    reject(new Error(errorMessage));\n                }\n                // Don't reject for non-OAuth messages, just ignore them\n            };\n            // Listen for BroadcastChannel messages\n            if (broadcastChannel) {\n                broadcastChannel.onmessage = (event) => {\n                    var _a;\n                    const data = event.data;\n                    if ((_a = data === null || data === void 0 ? void 0 : data.source) === null || _a === void 0 ? void 0 : _a.toString().startsWith('angular'))\n                        return;\n                    if ((data === null || data === void 0 ? void 0 : data.type) === 'oauth-response') {\n                        cleanup();\n                        processOAuthResponse(data);\n                    }\n                    else if ((data === null || data === void 0 ? void 0 : data.type) === 'oauth-error') {\n                        cleanup();\n                        const errorMessage = data.error || 'User cancelled the OAuth flow';\n                        reject(new Error(errorMessage));\n                    }\n                };\n            }\n            window.addEventListener('message', handleMessage);\n            // Timeout after 5 minutes\n            timeoutHandle = setTimeout(() => {\n                cleanup();\n                try {\n                    popup.close();\n                }\n                catch (_a) {\n                    // Ignore cross-origin errors when closing\n                }\n                reject(new Error('OAuth timeout'));\n            }, 300000);\n            popupClosedInterval = setInterval(() => {\n                try {\n                    // Check if popup is closed - this may throw cross-origin errors for some providers\n                    if (popup.closed) {\n                        cleanup();\n                        reject(new Error('Popup closed'));\n                    }\n                }\n                catch (_a) {\n                    // Cross-origin error when checking popup.closed - this happens when the popup\n                    // navigates to a third-party OAuth provider with strict security settings.\n                    // We can't detect if the window was closed, so we rely on timeout and message handlers.\n                    clearInterval(popupClosedInterval);\n                }\n            }, 1000);\n        });\n    }\n}\n//# sourceMappingURL=google-provider.js.map","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { BaseSocialLogin } from './base';\n/**\n * OAuth2 Social Login Manager\n * Supports multiple OAuth2 provider configurations\n */\nexport class OAuth2SocialLogin extends BaseSocialLogin {\n    constructor() {\n        super(...arguments);\n        this.providers = new Map();\n        this.TOKENS_KEY_PREFIX = 'capgo_social_login_oauth2_tokens_';\n        this.STATE_PREFIX = 'capgo_social_login_oauth2_state_';\n    }\n    /**\n     * Initialize multiple OAuth2 providers\n     */\n    async initializeProviders(configs) {\n        var _a, _b, _c, _d;\n        for (const [providerId, config] of Object.entries(configs)) {\n            if (!config.appId || !config.authorizationBaseUrl || !config.redirectUrl) {\n                throw new Error(`OAuth2 provider '${providerId}' requires appId, authorizationBaseUrl, and redirectUrl`);\n            }\n            const internalConfig = Object.assign(Object.assign({}, config), { responseType: (_a = config.responseType) !== null && _a !== void 0 ? _a : 'code', pkceEnabled: (_b = config.pkceEnabled) !== null && _b !== void 0 ? _b : true, scope: (_c = config.scope) !== null && _c !== void 0 ? _c : '', logsEnabled: (_d = config.logsEnabled) !== null && _d !== void 0 ? _d : false });\n            this.providers.set(providerId, internalConfig);\n            if (internalConfig.logsEnabled) {\n                console.log(`[OAuth2:${providerId}] Initialized with config:`, {\n                    appId: config.appId,\n                    authorizationBaseUrl: config.authorizationBaseUrl,\n                    redirectUrl: config.redirectUrl,\n                    responseType: internalConfig.responseType,\n                    pkceEnabled: internalConfig.pkceEnabled,\n                });\n            }\n        }\n    }\n    getProvider(providerId) {\n        const config = this.providers.get(providerId);\n        if (!config) {\n            throw new Error(`OAuth2 provider '${providerId}' not configured. Call initialize() first.`);\n        }\n        return config;\n    }\n    getTokensKey(providerId) {\n        return `${this.TOKENS_KEY_PREFIX}${providerId}`;\n    }\n    async login(options) {\n        var _a, _b, _c, _d;\n        const { providerId } = options;\n        const config = this.getProvider(providerId);\n        const redirectUri = (_a = options.redirectUrl) !== null && _a !== void 0 ? _a : config.redirectUrl;\n        const scope = (_b = options.scope) !== null && _b !== void 0 ? _b : config.scope;\n        const state = (_c = options.state) !== null && _c !== void 0 ? _c : this.generateState();\n        const codeVerifier = (_d = options.codeVerifier) !== null && _d !== void 0 ? _d : this.generateCodeVerifier();\n        // Build authorization URL\n        const params = new URLSearchParams({\n            response_type: config.responseType,\n            client_id: config.appId,\n            redirect_uri: redirectUri,\n            state,\n        });\n        if (scope) {\n            params.set('scope', scope);\n        }\n        // Add PKCE for code flow\n        if (config.responseType === 'code' && config.pkceEnabled) {\n            const codeChallenge = await this.generateCodeChallenge(codeVerifier);\n            params.set('code_challenge', codeChallenge);\n            params.set('code_challenge_method', 'S256');\n        }\n        // Add additional parameters from config\n        if (config.additionalParameters) {\n            for (const [key, value] of Object.entries(config.additionalParameters)) {\n                params.set(key, value);\n            }\n        }\n        // Add additional parameters from login options\n        if (options.additionalParameters) {\n            for (const [key, value] of Object.entries(options.additionalParameters)) {\n                params.set(key, value);\n            }\n        }\n        // Store pending login state\n        this.persistPendingLogin(state, {\n            providerId,\n            codeVerifier,\n            redirectUri,\n            scope,\n        });\n        localStorage.setItem(BaseSocialLogin.OAUTH_STATE_KEY, JSON.stringify({ provider: 'oauth2', providerId, state }));\n        const authUrl = `${config.authorizationBaseUrl}?${params.toString()}`;\n        if (config.logsEnabled) {\n            console.log(`[OAuth2:${providerId}] Opening authorization URL:`, authUrl);\n        }\n        // Open popup window\n        const width = 500;\n        const height = 650;\n        const left = window.screenX + (window.outerWidth - width) / 2;\n        const top = window.screenY + (window.outerHeight - height) / 2;\n        const popup = window.open(authUrl, 'OAuth2Login', `width=${width},height=${height},left=${left},top=${top},popup=1`);\n        return new Promise((resolve, reject) => {\n            if (!popup) {\n                reject(new Error('Unable to open login window. Please allow popups.'));\n                return;\n            }\n            // Use BroadcastChannel for cross-origin communication (works when postMessage doesn't)\n            const channelName = `oauth2_${state}`;\n            let broadcastChannel = null;\n            try {\n                broadcastChannel = new BroadcastChannel(channelName);\n            }\n            catch (_a) {\n                // BroadcastChannel not supported, fall back to postMessage only\n                if (config.logsEnabled) {\n                    console.log(`[OAuth2:${providerId}] BroadcastChannel not supported, using postMessage only`);\n                }\n            }\n            const cleanup = (messageHandler, timeoutHandle, intervalHandle) => {\n                window.removeEventListener('message', messageHandler);\n                clearTimeout(timeoutHandle);\n                clearInterval(intervalHandle);\n                if (broadcastChannel) {\n                    broadcastChannel.close();\n                }\n            };\n            const handleOAuthMessage = (data) => {\n                if ((data === null || data === void 0 ? void 0 : data.type) === 'oauth-response') {\n                    if ((data === null || data === void 0 ? void 0 : data.provider) && data.provider !== 'oauth2') {\n                        return false;\n                    }\n                    // Check providerId matches if present\n                    if ((data === null || data === void 0 ? void 0 : data.providerId) && data.providerId !== providerId) {\n                        return false;\n                    }\n                    cleanup(messageHandler, timeoutHandle, popupClosedInterval);\n                    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                    const _a = data, { provider: _ignoredProvider, type: _ignoredType } = _a, payload = __rest(_a, [\"provider\", \"type\"]);\n                    resolve({\n                        provider: 'oauth2',\n                        result: payload,\n                    });\n                    return true;\n                }\n                else if ((data === null || data === void 0 ? void 0 : data.type) === 'oauth-error') {\n                    if ((data === null || data === void 0 ? void 0 : data.provider) && data.provider !== 'oauth2') {\n                        return false;\n                    }\n                    cleanup(messageHandler, timeoutHandle, popupClosedInterval);\n                    reject(new Error(data.error || 'OAuth2 login was cancelled.'));\n                    return true;\n                }\n                return false;\n            };\n            // Listen for BroadcastChannel messages\n            if (broadcastChannel) {\n                broadcastChannel.onmessage = (event) => {\n                    handleOAuthMessage(event.data);\n                };\n            }\n            const messageHandler = (event) => {\n                if (event.origin !== window.location.origin) {\n                    return;\n                }\n                handleOAuthMessage(event.data);\n            };\n            window.addEventListener('message', messageHandler);\n            const timeoutHandle = window.setTimeout(() => {\n                cleanup(messageHandler, timeoutHandle, popupClosedInterval);\n                try {\n                    popup.close();\n                }\n                catch (_a) {\n                    // Ignore cross-origin errors when closing\n                }\n                reject(new Error('OAuth2 login timed out.'));\n            }, 300000);\n            const popupClosedInterval = window.setInterval(() => {\n                try {\n                    // Check if popup is closed - this may throw cross-origin errors for some providers\n                    if (popup.closed) {\n                        cleanup(messageHandler, timeoutHandle, popupClosedInterval);\n                        reject(new Error('OAuth2 login window was closed.'));\n                    }\n                }\n                catch (_a) {\n                    // Cross-origin error when checking popup.closed - this happens when the popup\n                    // navigates to a third-party OAuth provider with strict security settings.\n                    // We can't detect if the window was closed, so we just rely on the timeout\n                    // and message handlers. Clear the interval to avoid repeated errors.\n                    clearInterval(popupClosedInterval);\n                    if (config.logsEnabled) {\n                        console.log(`[OAuth2:${providerId}] Cannot check popup.closed due to cross-origin restrictions. ` +\n                            'Relying on message handlers and timeout.');\n                    }\n                }\n            }, 1000);\n        });\n    }\n    async logout(providerId) {\n        const config = this.providers.get(providerId);\n        localStorage.removeItem(this.getTokensKey(providerId));\n        // If logout URL is configured, redirect to it\n        if (config === null || config === void 0 ? void 0 : config.logoutUrl) {\n            window.open(config.logoutUrl, '_blank');\n        }\n    }\n    async isLoggedIn(providerId) {\n        const tokens = this.getStoredTokens(providerId);\n        if (!tokens) {\n            return { isLoggedIn: false };\n        }\n        const isValid = tokens.expiresAt > Date.now();\n        if (!isValid) {\n            localStorage.removeItem(this.getTokensKey(providerId));\n        }\n        return { isLoggedIn: isValid };\n    }\n    async getAuthorizationCode(providerId) {\n        const tokens = this.getStoredTokens(providerId);\n        if (!tokens) {\n            throw new Error(`OAuth2 access token is not available for provider '${providerId}'.`);\n        }\n        return {\n            accessToken: tokens.accessToken,\n            jwt: tokens.idToken,\n        };\n    }\n    async refresh(providerId) {\n        const tokens = this.getStoredTokens(providerId);\n        if (!(tokens === null || tokens === void 0 ? void 0 : tokens.refreshToken)) {\n            throw new Error(`No OAuth2 refresh token is available for provider '${providerId}'. Include offline_access scope to receive one.`);\n        }\n        const config = this.getProvider(providerId);\n        if (!config.accessTokenEndpoint) {\n            throw new Error(`No accessTokenEndpoint configured for provider '${providerId}'.`);\n        }\n        await this.refreshWithRefreshToken(providerId, tokens.refreshToken);\n    }\n    async handleOAuthRedirect(url, expectedState) {\n        var _a, _b, _c, _d, _e;\n        // Check both query params and hash fragment\n        const params = new URLSearchParams(url.search);\n        const hashParams = new URLSearchParams(url.hash.slice(1));\n        // Merge params, hash takes priority (for implicit flow)\n        hashParams.forEach((value, key) => {\n            params.set(key, value);\n        });\n        const stateFromUrl = expectedState !== null && expectedState !== void 0 ? expectedState : params.get('state');\n        if (!stateFromUrl) {\n            return null;\n        }\n        const pending = this.consumePendingLogin(stateFromUrl);\n        if (!pending) {\n            localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n            return { error: 'OAuth2 login session expired or state mismatch.' };\n        }\n        const { providerId } = pending;\n        const config = this.providers.get(providerId);\n        if (!config) {\n            localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n            return { error: `OAuth2 provider '${providerId}' configuration not found.` };\n        }\n        const error = params.get('error');\n        if (error) {\n            localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n            return { error: params.get('error_description') || error };\n        }\n        try {\n            let tokenResponse;\n            // Check response type\n            if (params.has('code')) {\n                // Authorization code flow\n                const code = params.get('code');\n                if (!code) {\n                    localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n                    return { error: 'OAuth2 authorization code missing from redirect.' };\n                }\n                tokenResponse = await this.exchangeAuthorizationCode(providerId, code, pending);\n            }\n            else if (params.has('access_token')) {\n                // Implicit flow\n                tokenResponse = {\n                    access_token: params.get('access_token'),\n                    token_type: params.get('token_type') || 'bearer',\n                    expires_in: params.has('expires_in') ? parseInt(params.get('expires_in'), 10) : undefined,\n                    scope: params.get('scope') || undefined,\n                    id_token: params.get('id_token') || undefined,\n                };\n            }\n            else {\n                localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n                return { error: 'No authorization code or access token in redirect.' };\n            }\n            const expiresAt = tokenResponse.expires_in ? Date.now() + tokenResponse.expires_in * 1000 : Date.now() + 3600000;\n            const scopeArray = (_b = (_a = tokenResponse.scope) === null || _a === void 0 ? void 0 : _a.split(' ').filter(Boolean)) !== null && _b !== void 0 ? _b : [];\n            // Fetch resource data if configured\n            let resourceData = null;\n            if (config.resourceUrl) {\n                resourceData = await this.fetchResource(providerId, tokenResponse.access_token);\n            }\n            this.persistTokens(providerId, {\n                accessToken: tokenResponse.access_token,\n                refreshToken: tokenResponse.refresh_token,\n                idToken: tokenResponse.id_token,\n                expiresAt,\n                scope: scopeArray,\n                tokenType: tokenResponse.token_type,\n            });\n            return {\n                provider: 'oauth2',\n                result: {\n                    providerId,\n                    accessToken: {\n                        token: tokenResponse.access_token,\n                        tokenType: tokenResponse.token_type,\n                        expires: new Date(expiresAt).toISOString(),\n                        refreshToken: tokenResponse.refresh_token,\n                    },\n                    idToken: (_c = tokenResponse.id_token) !== null && _c !== void 0 ? _c : null,\n                    refreshToken: (_d = tokenResponse.refresh_token) !== null && _d !== void 0 ? _d : null,\n                    resourceData,\n                    scope: scopeArray,\n                    tokenType: tokenResponse.token_type,\n                    expiresIn: (_e = tokenResponse.expires_in) !== null && _e !== void 0 ? _e : null,\n                },\n            };\n        }\n        catch (err) {\n            if (err instanceof Error) {\n                return { error: err.message };\n            }\n            return { error: 'OAuth2 login failed unexpectedly.' };\n        }\n        finally {\n            localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n        }\n    }\n    async exchangeAuthorizationCode(providerId, code, pending) {\n        const config = this.getProvider(providerId);\n        if (!config.accessTokenEndpoint) {\n            throw new Error(`No accessTokenEndpoint configured for provider '${providerId}'.`);\n        }\n        const params = new URLSearchParams({\n            grant_type: 'authorization_code',\n            client_id: config.appId,\n            code,\n            redirect_uri: pending.redirectUri,\n        });\n        if (config.pkceEnabled) {\n            params.set('code_verifier', pending.codeVerifier);\n        }\n        if (config.logsEnabled) {\n            console.log(`[OAuth2:${providerId}] Exchanging code at:`, config.accessTokenEndpoint);\n        }\n        const response = await fetch(config.accessTokenEndpoint, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n            },\n            body: params.toString(),\n        });\n        if (!response.ok) {\n            const text = await response.text();\n            throw new Error(`OAuth2 token exchange failed (${response.status}): ${text}`);\n        }\n        return (await response.json());\n    }\n    async refreshWithRefreshToken(providerId, refreshToken) {\n        var _a, _b, _c;\n        const config = this.getProvider(providerId);\n        if (!config.accessTokenEndpoint) {\n            throw new Error(`No accessTokenEndpoint configured for provider '${providerId}'.`);\n        }\n        const params = new URLSearchParams({\n            grant_type: 'refresh_token',\n            refresh_token: refreshToken,\n            client_id: config.appId,\n        });\n        const response = await fetch(config.accessTokenEndpoint, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n            },\n            body: params.toString(),\n        });\n        if (!response.ok) {\n            const text = await response.text();\n            throw new Error(`OAuth2 refresh failed (${response.status}): ${text}`);\n        }\n        const tokens = (await response.json());\n        const expiresAt = tokens.expires_in ? Date.now() + tokens.expires_in * 1000 : Date.now() + 3600000;\n        const scopeArray = (_b = (_a = tokens.scope) === null || _a === void 0 ? void 0 : _a.split(' ').filter(Boolean)) !== null && _b !== void 0 ? _b : [];\n        this.persistTokens(providerId, {\n            accessToken: tokens.access_token,\n            refreshToken: (_c = tokens.refresh_token) !== null && _c !== void 0 ? _c : refreshToken,\n            idToken: tokens.id_token,\n            expiresAt,\n            scope: scopeArray,\n            tokenType: tokens.token_type,\n        });\n    }\n    async fetchResource(providerId, accessToken) {\n        const config = this.getProvider(providerId);\n        if (!config.resourceUrl) {\n            throw new Error(`No resourceUrl configured for provider '${providerId}'.`);\n        }\n        const headers = {\n            Authorization: `Bearer ${accessToken}`,\n        };\n        if (config.additionalResourceHeaders) {\n            Object.assign(headers, config.additionalResourceHeaders);\n        }\n        const response = await fetch(config.resourceUrl, {\n            headers,\n        });\n        if (!response.ok) {\n            const text = await response.text();\n            throw new Error(`Unable to fetch OAuth2 resource (${response.status}): ${text}`);\n        }\n        return (await response.json());\n    }\n    persistTokens(providerId, tokens) {\n        localStorage.setItem(this.getTokensKey(providerId), JSON.stringify(tokens));\n    }\n    getStoredTokens(providerId) {\n        const raw = localStorage.getItem(this.getTokensKey(providerId));\n        if (!raw) {\n            return null;\n        }\n        try {\n            return JSON.parse(raw);\n        }\n        catch (err) {\n            console.warn(`Failed to parse stored OAuth2 tokens for provider '${providerId}'`, err);\n            return null;\n        }\n    }\n    persistPendingLogin(state, payload) {\n        localStorage.setItem(`${this.STATE_PREFIX}${state}`, JSON.stringify(payload));\n    }\n    consumePendingLogin(state) {\n        const key = `${this.STATE_PREFIX}${state}`;\n        const raw = localStorage.getItem(key);\n        localStorage.removeItem(key);\n        if (!raw) {\n            return null;\n        }\n        try {\n            return JSON.parse(raw);\n        }\n        catch (err) {\n            console.warn('Failed to parse pending OAuth2 login payload', err);\n            return null;\n        }\n    }\n    generateState() {\n        return [...crypto.getRandomValues(new Uint8Array(16))].map((b) => b.toString(16).padStart(2, '0')).join('');\n    }\n    generateCodeVerifier() {\n        const array = new Uint8Array(64);\n        crypto.getRandomValues(array);\n        return Array.from(array)\n            .map((b) => 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~'[b % 66])\n            .join('');\n    }\n    async generateCodeChallenge(codeVerifier) {\n        const encoder = new TextEncoder();\n        const data = encoder.encode(codeVerifier);\n        const digest = await crypto.subtle.digest('SHA-256', data);\n        return this.base64UrlEncode(new Uint8Array(digest));\n    }\n    base64UrlEncode(buffer) {\n        let binary = '';\n        buffer.forEach((b) => (binary += String.fromCharCode(b)));\n        return btoa(binary).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n    }\n}\n//# sourceMappingURL=oauth2-provider.js.map","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { BaseSocialLogin } from './base';\nexport class TwitterSocialLogin extends BaseSocialLogin {\n    constructor() {\n        super(...arguments);\n        this.clientId = null;\n        this.redirectUrl = null;\n        this.defaultScopes = ['tweet.read', 'users.read'];\n        this.forceLogin = false;\n        this.TOKENS_KEY = 'capgo_social_login_twitter_tokens_v1';\n        this.STATE_PREFIX = 'capgo_social_login_twitter_state_';\n    }\n    async initialize(clientId, redirectUrl, defaultScopes, forceLogin, audience) {\n        this.clientId = clientId;\n        this.redirectUrl = redirectUrl !== null && redirectUrl !== void 0 ? redirectUrl : null;\n        if (defaultScopes === null || defaultScopes === void 0 ? void 0 : defaultScopes.length) {\n            this.defaultScopes = defaultScopes;\n        }\n        this.forceLogin = forceLogin !== null && forceLogin !== void 0 ? forceLogin : false;\n        this.audience = audience !== null && audience !== void 0 ? audience : undefined;\n    }\n    async login(options) {\n        var _a, _b, _c, _d, _e, _f;\n        if (!this.clientId) {\n            throw new Error('Twitter Client ID not configured. Call initialize() first.');\n        }\n        const redirectUri = (_b = (_a = options.redirectUrl) !== null && _a !== void 0 ? _a : this.redirectUrl) !== null && _b !== void 0 ? _b : window.location.origin + window.location.pathname;\n        const scopes = ((_c = options.scopes) === null || _c === void 0 ? void 0 : _c.length) ? options.scopes : this.defaultScopes;\n        const state = (_d = options.state) !== null && _d !== void 0 ? _d : this.generateState();\n        const codeVerifier = (_e = options.codeVerifier) !== null && _e !== void 0 ? _e : this.generateCodeVerifier();\n        const codeChallenge = await this.generateCodeChallenge(codeVerifier);\n        this.persistPendingLogin(state, {\n            codeVerifier,\n            redirectUri,\n            scopes,\n        });\n        localStorage.setItem(BaseSocialLogin.OAUTH_STATE_KEY, JSON.stringify({ provider: 'twitter', state }));\n        const params = new URLSearchParams({\n            response_type: 'code',\n            client_id: this.clientId,\n            redirect_uri: redirectUri,\n            scope: scopes.join(' '),\n            state,\n            code_challenge: codeChallenge,\n            code_challenge_method: 'S256',\n        });\n        if (((_f = options.forceLogin) !== null && _f !== void 0 ? _f : this.forceLogin) === true) {\n            params.set('force_login', 'true');\n        }\n        if (this.audience) {\n            params.set('audience', this.audience);\n        }\n        const authUrl = `https://x.com/i/oauth2/authorize?${params.toString()}`;\n        const width = 500;\n        const height = 650;\n        const left = window.screenX + (window.outerWidth - width) / 2;\n        const top = window.screenY + (window.outerHeight - height) / 2;\n        const popup = window.open(authUrl, 'XLogin', `width=${width},height=${height},left=${left},top=${top},popup=1`);\n        return new Promise((resolve, reject) => {\n            if (!popup) {\n                reject(new Error('Unable to open login window. Please allow popups.'));\n                return;\n            }\n            // Use BroadcastChannel for cross-origin communication (works when postMessage doesn't)\n            const channelName = `twitter_oauth_${state}`;\n            let broadcastChannel = null;\n            try {\n                broadcastChannel = new BroadcastChannel(channelName);\n            }\n            catch (_a) {\n                // BroadcastChannel not supported, fall back to postMessage only\n            }\n            const cleanup = (messageHandler, timeoutHandle, intervalHandle) => {\n                window.removeEventListener('message', messageHandler);\n                clearTimeout(timeoutHandle);\n                clearInterval(intervalHandle);\n                if (broadcastChannel) {\n                    broadcastChannel.close();\n                }\n            };\n            const handleOAuthMessage = (data) => {\n                if ((data === null || data === void 0 ? void 0 : data.type) === 'oauth-response') {\n                    if ((data === null || data === void 0 ? void 0 : data.provider) && data.provider !== 'twitter') {\n                        return false;\n                    }\n                    cleanup(messageHandler, timeoutHandle, popupClosedInterval);\n                    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                    const _a = data, { provider: _ignoredProvider, type: _ignoredType } = _a, payload = __rest(_a, [\"provider\", \"type\"]);\n                    resolve({\n                        provider: 'twitter',\n                        result: payload,\n                    });\n                    return true;\n                }\n                else if ((data === null || data === void 0 ? void 0 : data.type) === 'oauth-error') {\n                    if ((data === null || data === void 0 ? void 0 : data.provider) && data.provider !== 'twitter') {\n                        return false;\n                    }\n                    cleanup(messageHandler, timeoutHandle, popupClosedInterval);\n                    reject(new Error(data.error || 'Twitter login was cancelled.'));\n                    return true;\n                }\n                return false;\n            };\n            // Listen for BroadcastChannel messages\n            if (broadcastChannel) {\n                broadcastChannel.onmessage = (event) => {\n                    handleOAuthMessage(event.data);\n                };\n            }\n            const messageHandler = (event) => {\n                if (event.origin !== window.location.origin) {\n                    return;\n                }\n                handleOAuthMessage(event.data);\n            };\n            window.addEventListener('message', messageHandler);\n            const timeoutHandle = window.setTimeout(() => {\n                cleanup(messageHandler, timeoutHandle, popupClosedInterval);\n                try {\n                    popup.close();\n                }\n                catch (_a) {\n                    // Ignore cross-origin errors when closing\n                }\n                reject(new Error('Twitter login timed out.'));\n            }, 300000);\n            const popupClosedInterval = window.setInterval(() => {\n                try {\n                    // Check if popup is closed - this may throw cross-origin errors for some providers\n                    if (popup.closed) {\n                        cleanup(messageHandler, timeoutHandle, popupClosedInterval);\n                        reject(new Error('Twitter login window was closed.'));\n                    }\n                }\n                catch (_a) {\n                    // Cross-origin error when checking popup.closed - this happens when the popup\n                    // navigates to a third-party OAuth provider with strict security settings.\n                    // We can't detect if the window was closed, so we rely on timeout and message handlers.\n                    clearInterval(popupClosedInterval);\n                }\n            }, 1000);\n        });\n    }\n    async logout() {\n        localStorage.removeItem(this.TOKENS_KEY);\n    }\n    async isLoggedIn() {\n        const tokens = this.getStoredTokens();\n        if (!tokens) {\n            return { isLoggedIn: false };\n        }\n        const isValid = tokens.expiresAt > Date.now();\n        if (!isValid) {\n            localStorage.removeItem(this.TOKENS_KEY);\n        }\n        return { isLoggedIn: isValid };\n    }\n    async getAuthorizationCode() {\n        const tokens = this.getStoredTokens();\n        if (!tokens) {\n            throw new Error('Twitter access token is not available.');\n        }\n        return {\n            accessToken: tokens.accessToken,\n        };\n    }\n    async refresh() {\n        const tokens = this.getStoredTokens();\n        if (!(tokens === null || tokens === void 0 ? void 0 : tokens.refreshToken)) {\n            throw new Error('No Twitter refresh token is available. Include offline.access scope to receive one.');\n        }\n        await this.refreshWithRefreshToken(tokens.refreshToken);\n    }\n    async handleOAuthRedirect(url, expectedState) {\n        const params = url.searchParams;\n        const stateFromUrl = expectedState !== null && expectedState !== void 0 ? expectedState : params.get('state');\n        if (!stateFromUrl) {\n            return null;\n        }\n        const pending = this.consumePendingLogin(stateFromUrl);\n        if (!pending) {\n            localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n            return { error: 'Twitter login session expired or state mismatch.' };\n        }\n        const error = params.get('error');\n        if (error) {\n            localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n            return { error: params.get('error_description') || error };\n        }\n        const code = params.get('code');\n        if (!code) {\n            localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n            return { error: 'Twitter authorization code missing from redirect.' };\n        }\n        try {\n            const tokens = await this.exchangeAuthorizationCode(code, pending);\n            const profile = await this.fetchProfile(tokens.access_token);\n            const expiresAt = Date.now() + tokens.expires_in * 1000;\n            const scopeArray = tokens.scope.split(' ').filter(Boolean);\n            this.persistTokens({\n                accessToken: tokens.access_token,\n                refreshToken: tokens.refresh_token,\n                expiresAt,\n                scope: scopeArray,\n                tokenType: tokens.token_type,\n                userId: profile.id,\n                profile,\n            });\n            return {\n                provider: 'twitter',\n                result: {\n                    accessToken: {\n                        token: tokens.access_token,\n                        tokenType: tokens.token_type,\n                        expires: new Date(expiresAt).toISOString(),\n                        userId: profile.id,\n                    },\n                    refreshToken: tokens.refresh_token,\n                    scope: scopeArray,\n                    tokenType: tokens.token_type,\n                    expiresIn: tokens.expires_in,\n                    profile,\n                },\n            };\n        }\n        catch (err) {\n            if (err instanceof Error) {\n                return { error: err.message };\n            }\n            return { error: 'Twitter login failed unexpectedly.' };\n        }\n        finally {\n            localStorage.removeItem(BaseSocialLogin.OAUTH_STATE_KEY);\n        }\n    }\n    async exchangeAuthorizationCode(code, pending) {\n        var _a;\n        const params = new URLSearchParams({\n            grant_type: 'authorization_code',\n            client_id: (_a = this.clientId) !== null && _a !== void 0 ? _a : '',\n            code,\n            redirect_uri: pending.redirectUri,\n            code_verifier: pending.codeVerifier,\n        });\n        const response = await fetch('https://api.x.com/2/oauth2/token', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n            },\n            body: params.toString(),\n        });\n        if (!response.ok) {\n            const text = await response.text();\n            throw new Error(`Twitter token exchange failed (${response.status}): ${text}`);\n        }\n        return (await response.json());\n    }\n    async refreshWithRefreshToken(refreshToken) {\n        var _a, _b;\n        const params = new URLSearchParams({\n            grant_type: 'refresh_token',\n            refresh_token: refreshToken,\n            client_id: (_a = this.clientId) !== null && _a !== void 0 ? _a : '',\n        });\n        const response = await fetch('https://api.x.com/2/oauth2/token', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n            },\n            body: params.toString(),\n        });\n        if (!response.ok) {\n            const text = await response.text();\n            throw new Error(`Twitter refresh failed (${response.status}): ${text}`);\n        }\n        const tokens = (await response.json());\n        const profile = await this.fetchProfile(tokens.access_token);\n        const expiresAt = Date.now() + tokens.expires_in * 1000;\n        const scopeArray = tokens.scope.split(' ').filter(Boolean);\n        this.persistTokens({\n            accessToken: tokens.access_token,\n            refreshToken: (_b = tokens.refresh_token) !== null && _b !== void 0 ? _b : refreshToken,\n            expiresAt,\n            scope: scopeArray,\n            tokenType: tokens.token_type,\n            userId: profile.id,\n            profile,\n        });\n    }\n    async fetchProfile(accessToken) {\n        var _a, _b, _c, _d;\n        const fields = ['profile_image_url', 'verified', 'name', 'username'];\n        const response = await fetch(`https://api.x.com/2/users/me?user.fields=${fields.join(',')}`, {\n            headers: {\n                Authorization: `Bearer ${accessToken}`,\n            },\n        });\n        if (!response.ok) {\n            const text = await response.text();\n            throw new Error(`Unable to fetch Twitter profile (${response.status}): ${text}`);\n        }\n        const payload = (await response.json());\n        if (!payload.data) {\n            throw new Error('Twitter profile payload is missing data.');\n        }\n        return {\n            id: payload.data.id,\n            username: payload.data.username,\n            name: (_a = payload.data.name) !== null && _a !== void 0 ? _a : null,\n            profileImageUrl: (_b = payload.data.profile_image_url) !== null && _b !== void 0 ? _b : null,\n            verified: (_c = payload.data.verified) !== null && _c !== void 0 ? _c : false,\n            email: (_d = payload.data.email) !== null && _d !== void 0 ? _d : null,\n        };\n    }\n    persistTokens(tokens) {\n        localStorage.setItem(this.TOKENS_KEY, JSON.stringify(tokens));\n    }\n    getStoredTokens() {\n        const raw = localStorage.getItem(this.TOKENS_KEY);\n        if (!raw) {\n            return null;\n        }\n        try {\n            return JSON.parse(raw);\n        }\n        catch (err) {\n            console.warn('Failed to parse stored Twitter tokens', err);\n            return null;\n        }\n    }\n    persistPendingLogin(state, payload) {\n        localStorage.setItem(`${this.STATE_PREFIX}${state}`, JSON.stringify(payload));\n    }\n    consumePendingLogin(state) {\n        const key = `${this.STATE_PREFIX}${state}`;\n        const raw = localStorage.getItem(key);\n        localStorage.removeItem(key);\n        if (!raw) {\n            return null;\n        }\n        try {\n            return JSON.parse(raw);\n        }\n        catch (err) {\n            console.warn('Failed to parse pending Twitter login payload', err);\n            return null;\n        }\n    }\n    generateState() {\n        return [...crypto.getRandomValues(new Uint8Array(16))].map((b) => b.toString(16).padStart(2, '0')).join('');\n    }\n    generateCodeVerifier() {\n        const array = new Uint8Array(64);\n        crypto.getRandomValues(array);\n        return Array.from(array)\n            .map((b) => 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~'[b % 66])\n            .join('');\n    }\n    async generateCodeChallenge(codeVerifier) {\n        const encoder = new TextEncoder();\n        const data = encoder.encode(codeVerifier);\n        const digest = await crypto.subtle.digest('SHA-256', data);\n        return this.base64UrlEncode(new Uint8Array(digest));\n    }\n    base64UrlEncode(buffer) {\n        let binary = '';\n        buffer.forEach((b) => (binary += String.fromCharCode(b)));\n        return btoa(binary).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n    }\n}\n//# sourceMappingURL=twitter-provider.js.map","import { WebPlugin } from '@capacitor/core';\nimport { AppleSocialLogin } from './apple-provider';\nimport { FacebookSocialLogin } from './facebook-provider';\nimport { GoogleSocialLogin } from './google-provider';\nimport { OAuth2SocialLogin } from './oauth2-provider';\nimport { TwitterSocialLogin } from './twitter-provider';\nexport class SocialLoginWeb extends WebPlugin {\n    constructor() {\n        super();\n        this.googleProvider = new GoogleSocialLogin();\n        this.appleProvider = new AppleSocialLogin();\n        this.facebookProvider = new FacebookSocialLogin();\n        this.twitterProvider = new TwitterSocialLogin();\n        this.oauth2Provider = new OAuth2SocialLogin();\n        // Set up listener for OAuth redirects if we have a pending OAuth flow\n        if (localStorage.getItem(SocialLoginWeb.OAUTH_STATE_KEY)) {\n            console.log('OAUTH_STATE_KEY found');\n            this.handleOAuthRedirect().catch((error) => {\n                console.error('Failed to finish OAuth redirect', error);\n                window.close();\n            });\n        }\n    }\n    async handleOAuthRedirect() {\n        var _a;\n        const url = new URL(window.location.href);\n        const stateRaw = localStorage.getItem(SocialLoginWeb.OAUTH_STATE_KEY);\n        let provider = null;\n        let state;\n        let nonce;\n        if (stateRaw) {\n            try {\n                const parsed = JSON.parse(stateRaw);\n                provider = (_a = parsed.provider) !== null && _a !== void 0 ? _a : null;\n                state = parsed.state;\n                nonce = parsed.nonce;\n            }\n            catch (_b) {\n                provider = stateRaw === 'true' ? 'google' : null;\n            }\n        }\n        let result = null;\n        switch (provider) {\n            case 'twitter':\n                result = await this.twitterProvider.handleOAuthRedirect(url, state);\n                break;\n            case 'oauth2':\n                result = await this.oauth2Provider.handleOAuthRedirect(url, state);\n                break;\n            case 'google':\n            default:\n                result = this.googleProvider.handleOAuthRedirect(url);\n                break;\n        }\n        if (!result) {\n            return;\n        }\n        // Build the message to send\n        let message;\n        if ('error' in result) {\n            const resolvedProvider = provider !== null && provider !== void 0 ? provider : null;\n            message = {\n                type: 'oauth-error',\n                provider: resolvedProvider,\n                error: result.error,\n            };\n        }\n        else {\n            message = Object.assign({ type: 'oauth-response', provider: result.provider }, result.result);\n        }\n        // Try postMessage first (works when window.opener is accessible)\n        try {\n            if (window.opener) {\n                window.opener.postMessage(message, window.location.origin);\n            }\n        }\n        catch (_c) {\n            // Cross-origin error - window.opener may not be accessible\n            console.log('postMessage to opener failed, using BroadcastChannel');\n        }\n        // Also use BroadcastChannel as a fallback (works across same-origin windows\n        // even when window.opener is not accessible due to cross-origin navigation)\n        try {\n            // Determine the channel name based on provider and state/nonce\n            let channelName = null;\n            if (provider === 'oauth2' && state) {\n                channelName = `oauth2_${state}`;\n            }\n            else if (provider === 'twitter' && state) {\n                channelName = `twitter_oauth_${state}`;\n            }\n            else if (provider === 'google' && nonce) {\n                channelName = `google_oauth_${nonce}`;\n            }\n            if (channelName) {\n                const channel = new BroadcastChannel(channelName);\n                channel.postMessage(message);\n                channel.close();\n            }\n        }\n        catch (_d) {\n            // BroadcastChannel not supported or other error\n            console.log('BroadcastChannel not available');\n        }\n        window.close();\n    }\n    async initialize(options) {\n        var _a, _b, _c, _d;\n        const initPromises = [];\n        if ((_a = options.google) === null || _a === void 0 ? void 0 : _a.webClientId) {\n            initPromises.push(this.googleProvider.initialize(options.google.webClientId, options.google.mode, options.google.hostedDomain, options.google.redirectUrl));\n        }\n        if ((_b = options.apple) === null || _b === void 0 ? void 0 : _b.clientId) {\n            initPromises.push(this.appleProvider.initialize(options.apple.clientId, options.apple.redirectUrl, options.apple.useProperTokenExchange));\n        }\n        if ((_c = options.facebook) === null || _c === void 0 ? void 0 : _c.appId) {\n            initPromises.push(this.facebookProvider.initialize(options.facebook.appId, options.facebook.locale));\n        }\n        if ((_d = options.twitter) === null || _d === void 0 ? void 0 : _d.clientId) {\n            initPromises.push(this.twitterProvider.initialize(options.twitter.clientId, options.twitter.redirectUrl, options.twitter.defaultScopes, options.twitter.forceLogin, options.twitter.audience));\n        }\n        if (options.oauth2 && Object.keys(options.oauth2).length > 0) {\n            initPromises.push(this.oauth2Provider.initializeProviders(options.oauth2));\n        }\n        await Promise.all(initPromises);\n    }\n    async login(options) {\n        switch (options.provider) {\n            case 'google':\n                return this.googleProvider.login(options.options);\n            case 'apple':\n                return this.appleProvider.login(options.options);\n            case 'facebook':\n                return this.facebookProvider.login(options.options);\n            case 'twitter':\n                return this.twitterProvider.login(options.options);\n            case 'oauth2':\n                return this.oauth2Provider.login(options.options);\n            default:\n                throw new Error(`Login for ${options.provider} is not implemented on web`);\n        }\n    }\n    async logout(options) {\n        switch (options.provider) {\n            case 'google':\n                return this.googleProvider.logout();\n            case 'apple':\n                return this.appleProvider.logout();\n            case 'facebook':\n                return this.facebookProvider.logout();\n            case 'twitter':\n                return this.twitterProvider.logout();\n            case 'oauth2':\n                if (!options.providerId) {\n                    throw new Error('providerId is required for oauth2 logout');\n                }\n                return this.oauth2Provider.logout(options.providerId);\n            default:\n                throw new Error(`Logout for ${options.provider} is not implemented`);\n        }\n    }\n    async isLoggedIn(options) {\n        switch (options.provider) {\n            case 'google':\n                return this.googleProvider.isLoggedIn();\n            case 'apple':\n                return this.appleProvider.isLoggedIn();\n            case 'facebook':\n                return this.facebookProvider.isLoggedIn();\n            case 'twitter':\n                return this.twitterProvider.isLoggedIn();\n            case 'oauth2':\n                if (!options.providerId) {\n                    throw new Error('providerId is required for oauth2 isLoggedIn');\n                }\n                return this.oauth2Provider.isLoggedIn(options.providerId);\n            default:\n                throw new Error(`isLoggedIn for ${options.provider} is not implemented`);\n        }\n    }\n    async getAuthorizationCode(options) {\n        switch (options.provider) {\n            case 'google':\n                return this.googleProvider.getAuthorizationCode();\n            case 'apple':\n                return this.appleProvider.getAuthorizationCode();\n            case 'facebook':\n                return this.facebookProvider.getAuthorizationCode();\n            case 'twitter':\n                return this.twitterProvider.getAuthorizationCode();\n            case 'oauth2':\n                if (!options.providerId) {\n                    throw new Error('providerId is required for oauth2 getAuthorizationCode');\n                }\n                return this.oauth2Provider.getAuthorizationCode(options.providerId);\n            default:\n                throw new Error(`getAuthorizationCode for ${options.provider} is not implemented`);\n        }\n    }\n    async refresh(options) {\n        switch (options.provider) {\n            case 'google':\n                return this.googleProvider.refresh();\n            case 'apple':\n                return this.appleProvider.refresh();\n            case 'facebook':\n                return this.facebookProvider.refresh(options.options);\n            case 'twitter':\n                return this.twitterProvider.refresh();\n            case 'oauth2': {\n                const oauth2Options = options.options;\n                if (!(oauth2Options === null || oauth2Options === void 0 ? void 0 : oauth2Options.providerId)) {\n                    throw new Error('providerId is required for oauth2 refresh');\n                }\n                return this.oauth2Provider.refresh(oauth2Options.providerId);\n            }\n            default:\n                throw new Error(`Refresh for ${options.provider} is not implemented`);\n        }\n    }\n    async providerSpecificCall(options) {\n        throw new Error(`Provider specific call for ${options.call} is not implemented`);\n    }\n    async getPluginVersion() {\n        return { version: 'web' };\n    }\n    async openSecureWindow(options) {\n        const w = 600;\n        const h = 550;\n        const settings = [\n            ['width', w],\n            ['height', h],\n            ['left', screen.width / 2 - w / 2],\n            ['top', screen.height / 2 - h / 2],\n        ]\n            .map((x) => x.join('='))\n            .join(',');\n        const popup = window.open(options.authEndpoint, 'Authorization', settings);\n        if (typeof popup.focus === 'function') {\n            popup.focus();\n        }\n        return new Promise((resolve, reject) => {\n            const bc = new BroadcastChannel(options.broadcastChannelName || 'oauth-channel');\n            bc.addEventListener('message', (event) => {\n                if (event.data.startsWith(options.redirectUri)) {\n                    bc.close();\n                    resolve({ redirectedUri: event.data });\n                }\n                else {\n                    bc.close();\n                    reject(new Error('Redirect URI does not match, expected ' + options.redirectUri + ' but got ' + event.data));\n                }\n            });\n            setTimeout(() => {\n                bc.close();\n                reject(new Error('The sign-in flow timed out'));\n            }, 5 * 60000);\n        });\n    }\n}\nSocialLoginWeb.OAUTH_STATE_KEY = 'social_login_oauth_pending';\n//# sourceMappingURL=web.js.map"],"names":["BaseSocialLogin","WebPlugin","token","base64","jsonPayload","c","src","resolve","reject","script","AppleSocialLogin","clientId","redirectUrl","useProperTokenExchange","options","_a","_b","res","_c","_d","_e","accessToken","result","error","FacebookSocialLogin","appId","locale","response","userInfo","existingScript","GoogleSocialLogin","mode","hostedDomain","scopes","nonce","state","isValidAccessToken","isValidIdToken","e","url","paramsRaw","errorInParams","code","hash","params","idToken","profile","responseBody","jsonObject","expiresInStr","expiresInInt","parsed","currentTime","tokenValid","prompt","uniqueScopes","width","height","left","top","popup","popupClosedInterval","timeoutHandle","channelName","broadcastChannel","cleanup","handleMessage","processOAuthResponse","data","serverAuthCode","event","errorMessage","__rest","s","t","p","i","OAuth2SocialLogin","configs","providerId","config","internalConfig","redirectUri","scope","codeVerifier","codeChallenge","key","value","authUrl","messageHandler","intervalHandle","handleOAuthMessage","_ignoredProvider","_ignoredType","payload","tokens","isValid","expectedState","stateFromUrl","pending","tokenResponse","expiresAt","scopeArray","resourceData","err","text","refreshToken","headers","raw","b","array","digest","buffer","binary","TwitterSocialLogin","defaultScopes","forceLogin","audience","_f","SocialLoginWeb","stateRaw","provider","message","channel","initPromises","oauth2Options","settings","x","bc"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6]}